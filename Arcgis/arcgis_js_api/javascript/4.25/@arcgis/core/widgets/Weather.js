/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{i as s}from"../chunks/maybe.js";import{m as o}from"../chunks/memoize.js";import{property as r}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"../chunks/ensureType.js";import{subclass as t}from"../core/accessorSupport/decorators/subclass.js";import{b as i}from"../chunks/weather.js";import n from"./Widget.js";import{H as a}from"../chunks/Heading.js";import{c as l}from"../chunks/widgetUtils.js";import{m as c}from"../chunks/messageBundle.js";import{t as d,a as p}from"../chunks/jsxFactory.js";import h,{W as u,a as m}from"./Weather/WeatherViewModel.js";import g from"../core/Accessor.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../core/Error.js";import"../chunks/tracking.js";import"../views/3d/environment/CloudyWeather.js";import"../core/JSONSupport.js";import"../core/Handles.js";import"../chunks/ArrayPool.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../core/promiseUtils.js";import"../chunks/enumeration.js";import"../chunks/jsonMap.js";import"../views/3d/environment/FoggyWeather.js";import"../views/3d/environment/RainyWeather.js";import"../views/3d/environment/SnowyWeather.js";import"../views/3d/environment/SunnyWeather.js";import"../intl.js";import"../chunks/number.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";const v="esri-weather",b={base:v,esriWidget:"esri-widget",esriWidgetDisabled:"esri-widget--disabled",widgetIcon:"esri-icon-partly-cloudy",content:`${v}__content`,hasError:`${v}__content--has-error`,selector:`${v}__selector`,options:`${v}__options`,error:`${v}__error`,warning:`${v}__warning`},y={base:`${v}__labeled-slider`};let w=class extends n{constructor(e){super(e),this._onChange=e=>{const s=e.target.value;this.onChange(s)}}render(){const{label:e,disabled:s}=this;return d("div",{class:y.base},d("calcite-label",{scale:"s",disabled:s},e,d("calcite-slider",{"aria-label":e,disabled:this.disabled,max:1,min:0,step:.01,value:this.value,onCalciteSliderInput:this._onChange,onCalciteSliderChange:this._onChange})))}loadDependencies(){return Promise.all([import("../chunks/calcite-label.js"),import("../chunks/calcite-slider.js")])}};e([r()],w.prototype,"value",void 0),e([r()],w.prototype,"onChange",void 0),e([r()],w.prototype,"disabled",void 0),w=e([t("esri.widgets.Weather.LabeledSlider")],w);let j=class extends g{constructor(){super(...arguments),this.header=!0}};e([r({type:Boolean,nonNullable:!0})],j.prototype,"header",void 0),j=e([t("esri.widgets.Weather.VisibleElements")],j);const k=j,C={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let _=class extends n{constructor(e){super(e),this.viewModel=new h,this.headingLevel=4,this.visibleElements=new k,this.iconClass=b.widgetIcon,this._renderWeatherTypeButton=e=>{const s=this.viewModel,o=this.messages[e].label,r=s.state===u.Disabled,t=!r&&s.current.type===e;return d("calcite-button",{appearance:t?"solid":"outline","aria-checked":t?"true":"false",color:t?"blue":"neutral",disabled:r,"icon-start":C[e],key:`${e}-type-button`,label:o,role:"radio",scale:"l",title:o,onclick:()=>{t||s.setWeatherByType(e)}})},this._memoizedCallbacks=o((e=>({onCloudCoverChange:s=>{"cloudCover"in e&&(e.cloudCover=s)},onPrecipitationChange:s=>{"precipitation"in e&&(e.precipitation=s)},onFogStrengthChange:s=>{"fogStrength"in e&&(e.fogStrength=s)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.target.checked)}})))}render(){const e=this.viewModel.state===u.Disabled;return d("div",{class:this.classes(b.base,b.esriWidget,e&&b.esriWidgetDisabled),role:"region","aria-label":this.messages.widgetLabelAccessible},this._renderContent())}loadDependencies(){return Promise.all([import("../chunks/calcite-button.js"),import("../chunks/calcite-checkbox.js"),import("../chunks/calcite-icon.js"),import("../chunks/calcite-label.js")])}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case m.LocalScene:return e.localScene;case m.NoAtmosphere:return e.noAtmosphere;case m.UnsupportedView:return e.unsupported;default:return null}}get _warningMessage(){return this.viewModel.error===m.NotVisible&&s(this.view)&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const e=this.messages,o=this._warningMessage,r=this.viewModel.state===u.Error;return d(p,null,this.visibleElements.header&&d(a,{level:this.headingLevel},e.widgetLabel),r&&d("div",{key:"error",class:b.error},this._errorMessage),d("div",{key:"content",class:l({[b.content]:!0,[b.hasError]:r})},d("div",{class:b.selector,role:"radiogroup","aria-label":e.weatherType},i.map(this._renderWeatherTypeButton)),d("div",{class:b.options},this._renderOptions()),s(o)&&this._renderWarning(o)))}_renderOptions(){const{viewModel:e,messages:s}=this,o=e.state===u.Disabled,r=e.current,t=this._memoizedCallbacks(r);switch(r.type){case"sunny":return d(w,{key:"sunny-cover",disabled:o,label:s.sunny.cloudCover,value:r.cloudCover,onChange:t.onCloudCoverChange});case"cloudy":return d(w,{key:"cloudy-cover",disabled:o,label:s.cloudy.cloudCover,value:r.cloudCover,onChange:t.onCloudCoverChange});case"rainy":return d(p,null,d(w,{key:"rainy-cover",disabled:o,label:s.rainy.cloudCover,value:r.cloudCover,onChange:t.onCloudCoverChange}),d(w,{key:"rainy-precipitation",disabled:o,label:s.rainy.precipitation,value:r.precipitation,onChange:t.onPrecipitationChange}));case"snowy":return d(p,null,d(w,{key:"snowy-cloud-cover",disabled:o,label:s.snowy.cloudCover,value:r.cloudCover,onChange:t.onCloudCoverChange}),d(w,{key:"snowy-precipitation",disabled:o,label:s.snowy.precipitation,value:r.precipitation,onChange:t.onPrecipitationChange}),d("calcite-label",{key:"snow-cover",scale:"s",disabled:o,layout:"inline",title:s.snowy.snowCoverTooltip},d("calcite-checkbox",{checked:"enabled"===r.snowCover,onCalciteCheckboxChange:t.onSnowCoverChange}),s.snowy.snowCover));case"foggy":return d(w,{key:"foggy-cover",disabled:o,label:s.foggy.fogStrength,value:r.fogStrength,onChange:t.onFogStrengthChange})}}_renderWarning(e){return d("div",{key:"warning",class:b.warning},d("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};e([r()],_.prototype,"viewModel",void 0),e([r()],_.prototype,"view",null),e([r()],_.prototype,"headingLevel",void 0),e([r({type:k,nonNullable:!0})],_.prototype,"visibleElements",void 0),e([r()],_.prototype,"iconClass",void 0),e([r()],_.prototype,"label",null),e([r(),c("esri/widgets/Weather/t9n/Weather")],_.prototype,"messages",void 0),e([r()],_.prototype,"_errorMessage",null),e([r()],_.prototype,"_warningMessage",null),_=e([t("esri.widgets.Weather")],_);const f=_;export{f as default};
