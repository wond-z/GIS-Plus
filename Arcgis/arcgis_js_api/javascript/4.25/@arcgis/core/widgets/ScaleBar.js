/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{watch as s}from"../core/reactiveUtils.js";import{c as t}from"../chunks/screenUtils.js";import{property as r}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{cast as i}from"../core/accessorSupport/decorators/cast.js";import{subclass as o}from"../core/accessorSupport/decorators/subclass.js";import l from"./Widget.js";import n from"./ScaleBar/ScaleBarViewModel.js";import"../chunks/widgetUtils.js";import{m as a}from"../chunks/messageBundle.js";import{t as c}from"../chunks/jsxFactory.js";import"../core/promiseUtils.js";import"../chunks/object.js";import"../core/Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/maybe.js";import"../chunks/string.js";import"../chunks/handleUtils.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/ensureType.js";import"../chunks/metadata.js";import"../intl.js";import"../chunks/number.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Accessor.js";import"../core/Handles.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/Ellipsoid.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../geometry/support/geodesicUtils.js";import"../chunks/unitUtils.js";import"../chunks/projectionEllipsoid.js";import"../chunks/geodesicConstants.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils4.js";import"../chunks/utils5.js";const p="esri-scale-bar__label",m="esri-scale-bar__ruler-block";function u(e){return 2*e}let d=class extends l{constructor(e,s){super(e,s),this.messages=null,this.unit="non-metric",this.viewModel=new n}initialize(){this.addHandles([s((()=>{const{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]}),(([e])=>{e&&this.scheduleRender()}))])}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set style(e){const s="dual"===this.unit?"line":e;this._set("style",s)}castStyle(e){return"line"===e?e:"ruler"}castUnit(e){return"metric"===e||"dual"===e?e:"non-metric"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="disabled"===this.get("viewModel.state"),s={"esri-disabled":e};let t,r;if(!e){const{unit:e,style:s}=this,i="metric"===e||"dual"===e,o=50;if("non-metric"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(o,"non-metric");e&&(r="ruler"===s?this._renderRuler(e):this._renderLine(e,"bottom"))}if(i){const e=this.viewModel.getScaleBarProperties(o,"metric");e&&(t="ruler"===s?this._renderRuler(e):this._renderLine(e,"top"))}}return c("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes("esri-scale-bar esri-widget",s)},t,r)}_renderRuler(e){const s=u(Math.round(e.length)),{messages:t}=this,r=t[e.unit]||t.unknownUnit,i=`${u(e.value)} ${r}`;return c("div",{class:this.classes("esri-scale-bar__bar-container","esri-scale-bar__bar-container--ruler"),key:"esri-scale-bar__ruler"},c("div",{class:"esri-scale-bar__ruler",styles:{width:`${s}px`}},c("div",{class:m}),c("div",{class:m}),c("div",{class:m}),c("div",{class:m})),c("div",{class:this.classes("esri-scale-bar__label-container","esri-scale-bar__label-container--ruler")},c("div",{class:p},"0"),c("div",{class:p},i)))}_renderLine(e,s){const{messages:t}=this,r=t[e.unit]||t.unknownUnit,i=`${u(e.value)} ${r}`,o={"esri-scale-bar__label-container--top":"top"===s,"esri-scale-bar__label-container--bottom":"bottom"===s},l=c("div",{class:this.classes("esri-scale-bar__label-container","esri-scale-bar__label-container--line",o),key:"esri-scale-bar__label"},c("div",{class:p},i)),n={"esri-scale-bar__line--top":"top"===s,"esri-scale-bar__line--bottom":"bottom"===s},a=u(Math.round(e.length)),m=c("div",{class:this.classes("esri-scale-bar__line",n),key:"esri-scale-bar__line",styles:{width:`${a}px`}});return c("div",{class:this.classes("esri-scale-bar__bar-container","esri-scale-bar__bar-container--line"),key:"esri-scale-bar__line-container"},[m,l])}_handleRootCreateOrUpdate(e){const s=this.viewModel;if(!s)return;const r=e.getBoundingClientRect(),i=r.left+window.pageXOffset,o=r.top+window.pageYOffset,l=t(i,o);(l.x!==s.scaleComputedFrom.x||l.y!==s.scaleComputedFrom.y)&&(s.scaleComputedFrom=l)}};e([r()],d.prototype,"label",null),e([r(),a("esri/widgets/ScaleBar/t9n/ScaleBar")],d.prototype,"messages",void 0),e([r()],d.prototype,"style",null),e([i("style")],d.prototype,"castStyle",null),e([r()],d.prototype,"unit",void 0),e([i("unit")],d.prototype,"castUnit",null),e([r()],d.prototype,"view",null),e([r()],d.prototype,"viewModel",void 0),d=e([o("esri.widgets.ScaleBar")],d);const h=d;export{h as default};
