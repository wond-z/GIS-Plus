/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{e}from"../core/promiseUtils.js";import o from"../core/Handles.js";import{i as s,a as i}from"../chunks/maybe.js";import{watch as r,initial as a,on as n}from"../core/reactiveUtils.js";import{property as d}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{cast as l}from"../core/accessorSupport/decorators/cast.js";import{subclass as m}from"../core/accessorSupport/decorators/subclass.js";import{f as k,c as u}from"../chunks/number.js";import{S as h}from"../chunks/SlideThumbnail.js";import c from"./Widget.js";import p from"../core/Accessor.js";import"../chunks/ensureType.js";import b from"./Bookmarks/BookmarksViewModel.js";import _ from"./FeatureTable/Grid/support/ButtonMenu.js";import g from"./FeatureTable/Grid/support/ButtonMenuItem.js";import{H as B}from"../chunks/Heading.js";import{m as v}from"../chunks/widgetUtils.js";import{m as f}from"../chunks/messageBundle.js";import{v as y}from"../chunks/vmEvent.js";import{t as E}from"../chunks/jsxFactory.js";import{S as j}from"../chunks/sortable.esm.js";import"../chunks/object.js";import"../core/Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/string.js";import"../chunks/handleUtils.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/metadata.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../core/JSONSupport.js";import"../intl.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../Viewpoint.js";import"../Camera.js";import"../core/Clonable.js";import"../chunks/Cyclical.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/Geometry.js";import"../geometry/SpatialReference.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/Ellipsoid.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../webmap/Bookmark.js";import"../TimeExtent.js";import"../chunks/timeUtils.js";import"../core/Identifiable.js";import"./support/GoTo.js";import"../core/HandleOwner.js";import"../chunks/WatchUpdatingTracking.js";import"./FeatureTable/Grid/support/ButtonMenuViewModel.js";import"../chunks/Popover.js";let I=class extends p{constructor(t){super(t)}get editedBookmark(){const{bookmark:t}=this;return t?this._get("editedBookmark")||t.clone():null}get state(){return this._get("state")}set state(t){this.validationState=void 0,this.loading=void 0,this._set("state",t)}};t([d()],I.prototype,"bookmark",void 0),t([d({readOnly:!0})],I.prototype,"editedBookmark",null),t([d()],I.prototype,"state",null),t([d()],I.prototype,"validationState",void 0),t([d()],I.prototype,"loading",void 0),I=t([m("esri.widgets.Bookmarks.UserState")],I);const w=I,S={addBookmark:!0,thumbnail:!0,time:!0},U=/^https:\/\/.*/i;let x=class extends c{constructor(t,e){super(t,e),this._handles=new o,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.iconClass="esri-icon-bookmark",this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.viewModel=new b,this.visibleElements={...S}}initialize(){this.addHandles([r((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),a),r((()=>this.editingEnabled),(()=>this._toggleSorting()),a)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([import("../chunks/calcite-label.js"),import("../chunks/calcite-switch.js")])}get _editMenuItems(){const{messages:t,_userState:e}=this,o=e?.editedBookmark?.thumbnail?.url;return[new g({label:t?.menu.refreshThumbnail,iconClass:"esri-icon-refresh",clickFunction:()=>this._refreshThumbnail()}),new g({label:U.test(o)?t?.menu.editImageUrl:t?.menu.useImageUrl,iconClass:"esri-icon-link",clickFunction:()=>this._startUseImageUrl()}),o?new g({label:t?.menu.removeThumbnail,iconClass:"esri-icon-erase",clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:t,messages:e,disabled:o}=this,s=this._get("_editMenu");s&&s.destroy();const i=new _({disabled:o,iconClass:"esri-icon-handle-horizontal",label:e?.menu.label});return i.items=t,i}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...S,...t}}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){const{state:t}=this.viewModel,e="loading"===t?this.renderLoading():this.renderBookmarks();return E("div",{class:this.classes("esri-bookmarks esri-widget--panel","esri-widget",{"esri-widget--disabled":this.disabled})},e)}startAddBookmark(){this._userState=new w({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return E("div",{class:"esri-bookmarks__loader-container",key:"loader",tabIndex:this.disabled?-1:null},E("div",{class:"esri-bookmarks__loader"}))}renderNoBookmarksContainer(){const{messages:t,disabled:e}=this;return E("div",{class:"esri-widget__content--empty",key:"no-bookmarks",tabIndex:e?-1:null},E("span",{"aria-hidden":"true",class:this.classes("esri-widget__no-bookmark-icon","esri-icon-bookmark")}),E(B,{level:this.headingLevel,class:this.classes("esri-widget__heading","esri-bookmarks__no-bookmarks-heading")},t?.noBookmarksHeading),E("p",{class:"esri-bookmarks__no-bookmarks-description"},t?.noBookmarksDescription))}renderAddBookmarkLoading(){return E("div",{key:"adding-bookmark",class:"esri-bookmarks__adding-bookmark"},E("span",{"aria-hidden":"true",class:this.classes("esri-icon-loading-indicator","esri-rotating")}),this.messages?.addingBookmark)}renderBookmarkItems(t){if(!t)return null;const{_userState:e,editingEnabled:o}=this;return t.map((t=>o&&t&&e&&("edit"===e.state||"edit-thumbnail"===e.state)&&e.bookmark===t?"edit-thumbnail"===e.state?this.renderEditingBookmarkUrl(e.editedBookmark):this.renderEditingBookmark(e.editedBookmark):this.renderBookmark(t))).toArray()}renderBookmarksContainer(t){const{_userState:e,editingEnabled:o,disabled:s}=this,i="add"===e?.state,r=o&&!i?this.renderAddBookmarkButton():null,a=o?i&&e.loading?this.renderAddBookmarkLoading():"add"===e?.state?this.renderAddingBookmark():null:null;return[E("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes("esri-bookmarks__list",{"esri-bookmarks__list--sortable":this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:s?-1:null},this.renderBookmarkItems(t)),r,a]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?E("div",{key:"add-bookmark-item",class:"esri-bookmarks__add-bookmark"},E("button",{class:this.classes("esri-button","esri-button--tertiary","esri-bookmarks__add-bookmark-button"),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},E("span",{"aria-hidden":"true",class:this.classes("esri-bookmarks__add-bookmark-icon","esri-icon-plus")}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:t}=this.viewModel,e=t&&t.filter(Boolean),o=e&&e.length,s=o||this.editingEnabled?this.renderBookmarksContainer(e):null;return[o?null:this.renderNoBookmarksContainer(),s]}renderEditContainer(t){const{messagesCommon:e,disabled:o}=this,s=this._getBookmarkTitle(t);return E("div",{class:"esri-bookmarks__bookmark-edit-button-container",key:"edit-container"},E("button",{disabled:o,title:`${e?.edit} ${s}`,"aria-label":`${e?.edit} ${s}`,"data-bookmark":t,onclick:this._showEditBookmarkForm,bind:this,class:"esri-bookmarks__bookmark-edit-button",type:"button"},E("span",{"aria-hidden":"true",class:"esri-icon-edit"})))}renderDragHandle(t){const{messagesCommon:e,disabled:o}=this,s=this._getBookmarkTitle(t),i={"data-bookmark-uid":t.uid};return E("div",{role:"button",tabIndex:o?-1:0,key:"drag-handle",bind:this,class:"esri-bookmarks_bookmark-drag-handle",onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===t.uid?"true":"false","aria-label":`${e?.dragHandleTitle} ${s}`,title:`${e?.dragHandleTitle} ${s}`,...i},E("span",{"aria-hidden":"true",class:this.classes("esri-bookmarks_bookmark-drag-handle-icon","esri-icon-handle-vertical")}))}renderBookmarkImageIcon(){return E("span",{"aria-hidden":"true",class:this.classes("esri-bookmarks__bookmark-icon","esri-icon-bookmark")})}renderBookmarkImage(t){const{visibleElements:e}=this,{thumbnail:o}=t,s=o&&o.url||"";return e.thumbnail&&s?E("img",{src:s,alt:"",class:"esri-bookmarks__image"}):null}renderBookmarkTimeSwitch(t){const{messages:e,disabled:o}=this,{timeExtent:s}=t,{view:i}=this.viewModel;return i.timeExtent||s?E("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},e.includeTimeExtent,E("calcite-switch",{scale:"s",disabled:o,checked:!!s,onCalciteSwitchChange:t=>this._editIncludeTimeExtent=!!t.detail.switched})):null}renderBookmarkTimeExtent(t){const{visibleElements:e}=this,{timeExtent:o}=t;return o?E("span",{class:"esri-bookmarks__time-extent"},[s(o.start)&&E("span",{key:"start-date-group",class:"esri-bookmarks__time-extent-group"},E("span",{key:"start-date",class:"esri-bookmarks__time-extent-date"},this._formatDate(o.start)),e.time&&E("span",{key:"start-time",class:"esri-bookmarks__time-extent-time"},this._formatTime(o.start))),s(o.end)&&(i(o.start)||o.start.getTime()!==o.end.getTime())&&E("span",{key:"end-date-group",class:"esri-bookmarks__time-extent-group"},E("span",{key:"end-date",class:"esri-bookmarks__time-extent-date"},this._formatDate(o.end)),e.time&&E("span",{key:"end-time",class:"esri-bookmarks__time-extent-time"},this._formatTime(o.end)))]):null}renderBookmarkButton(t){const{disabled:e}=this,{timeExtent:o}=t,{abilities:s}=this.viewModel,i=this._getBookmarkTitle(t),r=E("div",{class:"esri-bookmarks__bookmark-image-container"},this.renderBookmarkImage(t)||this.renderBookmarkImageIcon()),a=s.time&&o?E("span",{key:"time-extent",class:"esri-bookmarks__bookmark-time-extent"},this.renderBookmarkTimeExtent(t)):null;return E("button",{disabled:e,key:"bookmark-button",class:"esri-bookmarks__bookmark-button",bind:this,"data-bookmark":t,onclick:this._goToBookmark,type:"button"},r,E("div",{class:"esri-bookmarks__bookmark-label"},E("span",{key:"bookmark-title",class:"esri-bookmarks__bookmark-name"},i),a))}renderBookmark(t){const{activeBookmark:e}=this.viewModel,o={"esri-bookmarks__bookmark--active":e===t},s=this.editingEnabled?this.renderEditContainer(t):null,i={"data-bookmark-uid":t.uid},r=this.editingEnabled?this.renderDragHandle(t):null;return E("li",{key:t,class:this.classes("esri-bookmarks__bookmark",o),...i},r,this.renderBookmarkButton(t),s)}renderEditingBookmarkName(t){const{messages:e,_userState:o,disabled:s}=this,i="name-required"===o.validationState;return E("label",{class:"esri-bookmarks__authoring-label"},e?.title,i?E("strong",null,e?.invalidTitle):null,E("input",{required:!0,disabled:s,bind:this,class:this.classes("esri-input",i?"esri-bookmarks__authoring-input--invalid":null),type:"text",value:t.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":t,"data-node-ref":"_editInputNode",placeholder:e?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:t,disabled:e}=this;return E("div",{class:"esri-bookmarks__authoring-actions"},E("input",{type:"button",disabled:e,value:t?.back,class:this.classes("esri-button","esri-button--tertiary"),onclick:this._closeUrlEditBookmarkForm,bind:this}),E("input",{class:"esri-button",disabled:e,type:"submit",value:t?.add}))}renderEditingBookmarkActions(){const{messagesCommon:t,disabled:e}=this,{bookmark:o}=this._userState;return E("div",{class:"esri-bookmarks__authoring-actions"},E("input",{type:"button",disabled:e,value:t?.delete,class:this.classes("esri-button","esri-button--tertiary","esri-bookmarks__authoring-delete-button"),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),E("input",{disabled:e,type:"button",value:t?.cancel,class:this.classes("esri-button","esri-button--tertiary"),onclick:this._closeEditBookmarkForm,bind:this}),E("input",{class:"esri-button",disabled:e,type:"submit",value:t?.save}))}renderEditingBookmarkUrlInput(t){const{messages:e,_userState:o,disabled:s}=this,i=t.thumbnail?.url,r=U.test(i)?i:null,a="absolute-url-required"===o.validationState;return E("label",{class:"esri-bookmarks__authoring-label"},a?E("strong",null,e?.invalidImageUrl):null,E("input",{required:!0,disabled:s,bind:this,class:this.classes("esri-input",a?"esri-bookmarks__authoring-input--invalid":null),type:"text",value:r,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":t,"data-node-ref":"_urlEditInputNode",title:e?.imageUrlTooltip,placeholder:e&&`https://<${e.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(t){const e={"data-bookmark-uid":t.uid};return E("li",{key:"edit-bookmark-url-form",class:"esri-bookmarks__authoring-card",...e},E("form",{class:"esri-bookmarks__authoring-form",disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(t),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(t){const e={"data-bookmark-uid":t.uid},{abilities:o}=this.viewModel,s=o.time?E("div",{key:"edit-bookmark-time-container",class:"esri-bookmarks__time-extent-container"},this.renderBookmarkTimeSwitch(t),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(t)):null;return E("li",{key:"edit-bookmark-form",class:"esri-bookmarks__authoring-card",...e},E("form",{class:"esri-bookmarks__authoring-form",disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},E("div",{class:"esri-bookmarks__authoring-container"},E("div",{class:"esri-bookmarks__bookmark-image-container"},this.renderBookmarkImage(t),this._editMenu.render()),this.renderEditingBookmarkName(t)),s,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:t,messages:e,disabled:o}=this,s="name-required"===t.validationState;return E("label",{class:"esri-bookmarks__authoring-label"},e?.title,s?E("strong",null,e?.invalidTitle):null,E("input",{required:!0,disabled:o,bind:this,class:this.classes("esri-input",s?"esri-bookmarks__authoring-input--invalid":null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:e?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:t,disabled:e}=this;return E("div",{class:this.classes("esri-bookmarks__authoring-actions")},E("input",{type:"button",disabled:e,value:t?.cancel,class:this.classes("esri-button","esri-button--tertiary","esri-bookmarks__authoring-cancel-button"),onclick:this._endAddBookmark.bind(this),bind:this}),E("input",{class:"esri-button",disabled:e,type:"submit",value:t?.add}))}renderAddingBookmark(){return E("div",{key:"add-bookmark-form",class:"esri-bookmarks__authoring-card"},E("form",{class:"esri-bookmarks__authoring-form",onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_getBookmarkTitle(t){return t.name||this.messagesCommon?.untitled}_formatDate(t){return t?k(t,u("short-date")):null}_formatTime(t){return t?k(t,u("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(t){const{_sortableSavedItems:o}=this,s=e(t);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(s))return;const{_sortable:i,_selectedSortUid:r}=this,a=i.toArray(),n=t.target.getAttribute("data-bookmark-uid"),d=a.indexOf(n);if(v(s)){const t=r&&r===n;return this._selectedSortUid=t?null:n,this._sortableSavedItems=t?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===s)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===s&&o)return t.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(o,i,n),void this.scheduleRender();if(-1===d||!r)return;const l="ArrowUp"===s?d-1:d+1;var m,k,u;l>=a.length||l<=-1||(k=d,u=l,(m=a).splice(u,0,m.splice(k,1)[0]),this._updateSortItems(a,i,n))}_updateSortItems(t,e,o){e.sort(t),this._sortBookmarks(e),this._focusSortUid=o,this._selectedSortUid=o}_focusDragHandle(t){const{_focusSortUid:e}=this;t&&e&&t.getAttribute("data-bookmark-uid")===e&&(t.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:t,_sortableNode:e,editingEnabled:o,disabled:s}=this;if(e)if(t)t.option("disabled",s||!o);else{const t=j.create(e,{dataIdAttr:"data-bookmark-uid",handle:".esri-bookmarks_bookmark-drag-handle",group:"bookmarks",disabled:s||!o,onSort:()=>this._sortBookmarks(t)});this._sortable=t}}_sortNodeCreated(t){this._sortableNode=t,this._toggleSorting()}_sortBookmarks(t){const{bookmarks:e}=this.viewModel;if(!e)return;const o=t.toArray();e.sort(((t,e)=>{const s=o.indexOf(t.uid),i=o.indexOf(e.uid);return s>i?1:s<i?-1:0}))}_destroySortable(){const{_sortable:t}=this;t&&t.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const t="bookmarks-init",{_handles:e}=this;e.remove(t),e.add(n((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),t)}_bookmarksChanged(){const t="bookmarks-change",{bookmarks:e}=this.viewModel,{_handles:o}=this;o.remove(t);const s=e.map((t=>r((()=>[t?.name,t?.thumbnail?.url]),(()=>this.scheduleRender()))));o.add(s,t),this.scheduleRender()}_showEditBookmarkForm(t){const e=t.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!e.timeExtent,this._focusEditInputBox=!0,this._userState=new w({bookmark:e,state:"edit"}),this.viewModel.goTo(e),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(t){t.preventDefault();const{_addInputNode:e,_userState:o}=this,s=e&&e.value.trim();s?(o.loading=!0,this.viewModel.createBookmark().then((t=>{t.name=s,this.viewModel.bookmarks.add(t),this._endAddBookmark()}))):o.validationState="name-required"}async _editBookmarkAndClose(t,e){const{viewModel:o}=this;await o.editBookmark(t,{...o.defaultEditOptions,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:o,_editIncludeTimeExtent:s}=this,i=e&&e.value.trim();i?(o.bookmark.name=i,o.bookmark.thumbnail=o.editedBookmark.thumbnail,s||(o.bookmark.timeExtent=null),this._editBookmarkAndClose(o.bookmark,{takeScreenshot:!1,captureTimeExtent:s})):o.validationState="name-required"}_storeAddBookmarkButton(t){this._addBookmarkButtonNode=t,this._focusAddBookmark()}_storeEditInput(t){this._editInputNode=t,this._focusEditInput()}_storeAddInput(t){this._addInputNode=t,this._focusAddInput()}_storeUrlEditInput(t){this._urlEditInputNode=t,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(t){const e=t.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(e)}_goToBookmark(t){const e=t.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(e)}async _refreshThumbnail(){const{_userState:t,_editMenu:e,viewModel:o}=this;t.validationState=void 0,await o.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),e.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:t,_editMenu:e}=this;t.editedBookmark.thumbnail=null,t.validationState=void 0,e.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(t){t.preventDefault();const{_urlEditInputNode:e,_userState:o}=this,s=e.value;U.test(s)?(s&&(o.editedBookmark.thumbnail=new h({url:s})),this._closeUrlEditBookmarkForm()):o.validationState="absolute-url-required"}};t([d()],x.prototype,"_editIncludeTimeExtent",void 0),t([d({type:w})],x.prototype,"_userState",void 0),t([d({readOnly:!0})],x.prototype,"_editMenuItems",null),t([d({readOnly:!0})],x.prototype,"_editMenu",null),t([d()],x.prototype,"defaultCreateOptions",null),t([d()],x.prototype,"defaultEditOptions",null),t([d()],x.prototype,"bookmarks",null),t([d()],x.prototype,"disabled",void 0),t([d()],x.prototype,"editingEnabled",void 0),t([d()],x.prototype,"headingLevel",void 0),t([d()],x.prototype,"goToOverride",null),t([d()],x.prototype,"iconClass",void 0),t([d()],x.prototype,"label",null),t([d(),f("esri/widgets/Bookmarks/t9n/Bookmarks")],x.prototype,"messages",void 0),t([d(),f("esri/t9n/common")],x.prototype,"messagesCommon",void 0),t([d(),f("esri/core/t9n/Units")],x.prototype,"messagesUnits",void 0),t([d()],x.prototype,"uiStrings",void 0),t([d()],x.prototype,"view",null),t([d({type:b}),y(["select-bookmark","bookmark-edit","bookmark-select"])],x.prototype,"viewModel",void 0),t([d()],x.prototype,"visibleElements",void 0),t([l("visibleElements")],x.prototype,"castVisibleElements",null),t([d()],x.prototype,"endAddBookmark",null),t([d()],x.prototype,"startAddBookmark",null),x=t([m("esri.widgets.Bookmarks")],x);const T=x;export{T as default};
