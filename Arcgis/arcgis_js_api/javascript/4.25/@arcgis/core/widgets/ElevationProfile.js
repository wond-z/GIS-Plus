/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{c as e}from"../chunks/asyncUtils.js";import{g as i,i as s,d as o,r as n,u as r,a,e as l,f as c}from"../chunks/maybe.js";import{m as p}from"../chunks/memoize.js";import{o as d,throwIfAborted as h,createAbortError as m}from"../core/promiseUtils.js";import{watch as u,initial as g}from"../core/reactiveUtils.js";import{property as b}from"../core/accessorSupport/decorators/property.js";import{B as f}from"../core/lang.js";import"../chunks/ensureType.js";import{subclass as _}from"../core/accessorSupport/decorators/subclass.js";import v from"./Widget.js";import y from"./ElevationProfile/ElevationProfileViewModel.js";import k from"../core/Accessor.js";import j from"../core/Collection.js";import{substitute as C}from"../intl.js";import{t as x}from"../chunks/throttle.js";import{f as S,e as w,u as P}from"../chunks/unitFormatUtils.js";import{N as M,g as E,E as L,a as U}from"./ElevationProfile/ElevationProfileLine.js";import{e as T,i as B,o as I}from"../chunks/widgetUtils.js";import{m as A}from"../chunks/messageBundle.js";import{t as z}from"../chunks/jsxFactory.js";import{t as D,c as F}from"../chunks/unitUtils.js";import{P as O}from"../chunks/Popover.js";import{h as $,m as V}from"../chunks/handleUtils.js";import{l as R}from"../chunks/chartUtils.js";import{i as W}from"../chunks/themeUtils.js";import{a as H}from"../chunks/number.js";import"../chunks/object.js";import"../core/Error.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/string.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/metadata.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Handles.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/assets.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../chunks/jsonMap.js";import"../Graphic.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/Ellipsoid.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../layers/support/fieldUtils.js";import"../chunks/arcadeOnDemand.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../chunks/date.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../Color.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils2.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils3.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../chunks/aaBoundingRect.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../portal/PortalGroup.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../chunks/byteSizeEstimations.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/ElevationQueryTileCache.js";import"../chunks/defaultUnit.js";import"../chunks/elevationInfoUtils.js";import"../chunks/unitConversionUtils.js";import"../chunks/lengthUtils.js";import"../chunks/vec2.js";import"../geometry/projection.js";import"../chunks/mat4.js";import"../chunks/pe.js";import"../chunks/projectionEllipsoid.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../chunks/zscale.js";import"../geometry/support/geodesicUtils.js";import"../chunks/QueueProcessor.js";import"../chunks/Queue.js";import"../chunks/Scheduler.js";import"../chunks/ObservableValue.js";import"../chunks/debugFlags2.js";import"../chunks/traversalUtils.js";import"./ElevationProfile/ElevationProfileLineGround.js";import"../chunks/elevationQuerySourceUtils.js";import"../Ground.js";import"../chunks/compilerUtils.js";import"../chunks/loadAll.js";import"../chunks/debugFlags.js";import"./ElevationProfile/ElevationProfileLineInput.js";import"../chunks/ElevationQuery2.js";import"../layers/support/ElevationSampler.js";import"../chunks/ElevationSamplerData.js";import"../chunks/TileKey.js";import"./ElevationProfile/ElevationProfileLineQuery.js";import"./ElevationProfile/ElevationProfileLineView.js";import"../chunks/vec4f64.js";import"../chunks/ray.js";import"../chunks/mat3f64.js";import"../chunks/mat4f64.js";import"../chunks/quatf64.js";import"../chunks/vec2f64.js";import"../chunks/Intersector.js";import"../chunks/ViewingMode.js";import"../chunks/boundedPlane.js";import"../chunks/vector.js";import"../chunks/lineSegment.js";import"../chunks/plane.js";import"../chunks/mathUtils2.js";import"../chunks/verticalOffsetUtils.js";import"../chunks/mat3.js";import"../chunks/quat.js";import"../chunks/vec3f32.js";import"../chunks/sphere.js";import"../chunks/utils20.js";import"../chunks/Util2.js";import"../chunks/doublePrecisionUtils.js";import"../chunks/intersectorUtilsConversions.js";import"../layers/GraphicsLayer.js";import"../chunks/GraphicsCollection.js";import"../core/HandleOwner.js";import"../chunks/WatchUpdatingTracking.js";import"../layers/Layer.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser.js";import"../chunks/mat4f32.js";import"../chunks/_commonjsHelpers.js";import"../layers/mixins/ScaleRangeLayer.js";import"../chunks/ElevationInfo.js";import"./Sketch/SketchViewModel.js";import"../geometry/Circle.js";import"../chunks/InputManager.js";import"../chunks/keybindings.js";import"../views/interactive/sketch/SketchLabelOptions.js";import"../views/interactive/sketch/SketchTooltipOptions.js";import"../chunks/SnappingManager.js";import"../chunks/RightAngleSnappingHint.js";import"../chunks/QueryEngineResult.js";import"../chunks/quantizationUtils.js";import"../chunks/ItemCache.js";import"../core/sql/WhereClause.js";import"../chunks/utils13.js";import"../chunks/generateRendererUtils.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../chunks/projectionSupport.js";import"../chunks/json.js";import"../chunks/SnappingCandidate.js";import"../chunks/utils21.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils4.js";import"../chunks/utils5.js";import"../chunks/featureConversionUtils.js";import"../chunks/OptimizedFeature.js";import"../chunks/OptimizedFeatureSet.js";import"../chunks/Settings2.js";import"../chunks/geometry2dUtils.js";import"../chunks/viewUtils.js";import"../views/interactive/snapping/SnappingOptions.js";import"../views/interactive/snapping/FeatureSnappingLayerSource.js";import"../chunks/hitTestSelectUtils.js";import"../chunks/screenUtils2.js";import"../chunks/Cyclical.js";import"../chunks/Material.js";import"../chunks/VertexAttribute.js";import"../chunks/basicInterfaces.js";const G="esri-elevation-profile",Y={esriWidget:"esri-widget--panel esri-widget",esriWidgetDisabled:"esri-widget--disabled",buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-elevation-profile",base:`${G}`,portrait:`${G}--portrait`,refined:`${G}--refined`,mainContainer:`${G}__main-container`,promptContainer:`${G}__prompt-container`,header:`${G}__header`,zoomOutButton:`${G}__zoom-out-button esri-icon-zoom-out-magnifying-glass`,clearButton:`${G}__clear-button esri-icon-trash`,actionButton:`${G}__action-button esri-button`,sketchButton:`${G}__sketch-button esri-button--primary`,sketchCancelButton:`${G}__sketch-cancel-button esri-button--secondary`,sketchDoneButton:`${G}__sketch-done-button esri-button--primary`,selectButton:`${G}__select-button esri-button--secondary`,selectCancelButton:`${G}__select-cancel-button esri-button--secondary`,chartContainer:`${G}__chart-container`,chartSpinner:`${G}__chart-spinner esri-icon-loading-indicator esri-rotating`,chartSpinnerVisible:`${G}__chart-spinner--visible`,chartSpinnerSmall:`${G}__chart-spinner--small`,footer:`${G}__footer`},X="esri-elevation-profile-legend-item",N={base:X,disabled:`${X}--disabled`,expanded:`${X}--expanded`,colorIndicator:`${X}__color-indicator`,header:`${X}__header`,content:`${X}__content`,collapseToggle:`${X}__collapse-toggle esri-button esri-button--tertiary`,collapseToggleIcon:`${X}__collapse-toggle__icon esri-icon-down`,label:`${X}__label`,labelDisabled:`${X}__label--disabled`,checkbox:`${X}__checkbox`},q="esri-elevation-profile-statistics",Q={base:q,statistic:`${q}__statistic`,statisticLabel:`${q}__statistic__label`,statisticValue:`${q}__statistic__value`,slopeValue:`${q}__slope-value`,slopeUpIcon:"esri-icon-arrow-up",slopeDownIcon:"esri-icon-arrow-down"},Z="esri-elevation-profile-settings",J={base:`${Z} esri-icon-handle-vertical`,popoverContent:`${Z}__popover-content`,select:`${Z}__select esri-select`,selectLabel:`${Z}__select-label`,checkboxLabel:`${Z}__checkbox-label`,checkbox:`${Z}__checkbox`,uniformChartScalingCheckbox:`${Z}__uniform-chart-scaling-checkbox`};let K=class extends k{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};t([b()],K.prototype,"legend",void 0),t([b()],K.prototype,"chart",void 0),t([b()],K.prototype,"clearButton",void 0),t([b()],K.prototype,"settingsButton",void 0),t([b()],K.prototype,"sketchButton",void 0),t([b()],K.prototype,"selectButton",void 0),t([b()],K.prototype,"unitSelector",void 0),t([b()],K.prototype,"uniformChartScalingToggle",void 0),K=t([_("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],K);const tt=K;let et=class extends v{constructor(t,e){super(t,e),this._messagesUnits=null,this._updateLayout=t=>{const e=t.parentElement,i=t.style.display;e.removeChild(t),document.body.appendChild(t),t.style.display="block";let s=80;for(const e of t.childNodes)e instanceof HTMLElement&&(s=Math.max(s,e.offsetWidth));document.body.removeChild(t),e.appendChild(t),t.style.display=i,t.style.setProperty("--max-width",`${s}px`)},this._updateLayoutThrottled=x(this._updateLayout,100)}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return z("div",{bind:this,class:Q.base,afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled},this._renderStatistics())}_renderStatistics(){const t=this._messages?.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(t,e){const i=E().formatPrecision,s=this._renderValue(t,(t=>{const e=this.effectiveUnits.distance;return S(this._messagesUnits,t,e,i)}));return this._renderStatistic(e,s)}_renderElevationStatistic(t,e){const i=E().formatPrecision,s=this._renderValue(t,(t=>{const e=this.effectiveUnits.elevation;return S(this._messagesUnits,t,e,i)}));return this._renderStatistic(e,s)}_renderSlopeStatistic(t,e,i){const s=E().formatPrecision,o=z("div",{key:"slope-up",class:Q.slopeValue},z("div",{class:Q.slopeUpIcon}),this._renderValue(t,(t=>w(t,"degrees","geographic","geographic",s))),z("div",{class:Q.slopeDownIcon}),this._renderValue(e,(t=>w(t,"degrees","geographic","geographic",s))));return this._renderStatistic(i,o)}_renderStatistic(t,e){return z("div",{class:Q.statistic},z("label",{class:Q.statisticLabel},t),z("div",{class:Q.statisticValue},e))}_renderValue(t,e){const o=this.line,n=1===o.progress?o.statistics:null,r=i(n,(e=>e[t]));return s(r)?e(r):M}};function it(t,{profiles:e}){const i=t.title;if(s(i))return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}t([b()],et.prototype,"effectiveUnits",void 0),t([b()],et.prototype,"line",void 0),t([b(),A("esri/widgets/ElevationProfile/t9n/ElevationProfile")],et.prototype,"_messages",void 0),t([b(),A("esri/core/t9n/Units")],et.prototype,"_messagesUnits",void 0),et=t([_("esri.widgets.ElevationProfile.Statistics")],et);let st=class extends v{constructor(t,e){super(t,e),this.expanded=!1,this.checkboxVisible=!0,this._messages=null}initialize(){this._statistics=new et(this._statisticsProps),this.addHandles(u((()=>this._statisticsProps),(t=>this._statistics.set(t))))}destroy(){this._statistics=o(this._statistics)}render(){const t=this.expanded;return z("div",{key:this,class:this.classes(N.base,{[N.disabled]:this.disabled,[N.expanded]:t})},this._renderColorIndicator(),z("div",{key:"header",class:N.header},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),t&&z("div",{key:"content",class:N.content},this._statistics.render()))}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return z("div",{key:"color-indicator",class:N.colorIndicator,styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const t=this._messages,e=this.expanded?t.hideDetails:t.showDetails;return z("button",{key:"collapse-toggle",bind:this,class:N.collapseToggle,onclick:this._onCollapseToggleClick,title:e,"aria-label":e,type:"button"},z("span",{class:N.collapseToggleIcon}))}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:t,checkboxVisible:e,disabled:i}=this,s=`${N.base}__check-${t.id}`;return z("label",{key:"id",for:s,class:this.classes(N.label,{[N.labelDisabled]:i||!e})},e&&this._renderCheckbox(s),z("span",null,it(t,this._messages)))}_renderCheckbox(t){const e=this.line,i=e.visible,s=this.disabled,o=this._messages,n=i?o.hideProfile:o.showProfile,r=it(e,this._messages),a=C(n,{name:r});return z("input",{key:"checkbox",id:t,type:"checkbox",class:N.checkbox,title:a,checked:i,disabled:s,"aria-label":a,bind:this,onchange:t=>this._onCheckboxToggle(t,e)})}_onCheckboxToggle(t,e){t.stopPropagation(),e.toggleVisibility()}};t([b({nonNullable:!0})],st.prototype,"effectiveUnits",void 0),t([b({nonNullable:!0})],st.prototype,"line",void 0),t([b()],st.prototype,"expanded",void 0),t([b()],st.prototype,"disabled",null),t([b()],st.prototype,"checkboxVisible",void 0),t([b()],st.prototype,"onExpandedToggle",void 0),t([b()],st.prototype,"_statistics",void 0),t([b(),A("esri/widgets/ElevationProfile/t9n/ElevationProfile")],st.prototype,"_messages",void 0),st=t([_("esri.widgets.ElevationProfile.LegendItem")],st);let ot=class extends v{constructor(t,e){super(t,e),this._items=new j,this._expandedLine=null}initialize(){this.addHandles([u((()=>this.profiles),(t=>{this._destroyItems(),this._items.addMany(t.map((t=>this._createItemForLine(t))))}),g),u((()=>this.effectiveUnits),(t=>{this._items.forEach((e=>{e.effectiveUnits=t}))}),g)])}destroy(){this._destroyItems()}render(){return z("div",{class:"esri-elevation-profile-legend"},this._items.toArray().map((t=>t.render())))}_onExpandedToggle(t){this._expandedLine=t===this._expandedLine?null:t,this._items.forEach((t=>t.expanded=t.line===this._expandedLine))}_createItemForLine(t){return new st({line:t,effectiveUnits:this.effectiveUnits,expanded:t===this._expandedLine,checkboxVisible:this.profiles.length>1,onExpandedToggle:()=>this._onExpandedToggle(t)})}_destroyItems(){this._items.drain((t=>t.destroy()))}};t([b()],ot.prototype,"profiles",void 0),t([b()],ot.prototype,"effectiveUnits",void 0),t([b()],ot.prototype,"_items",void 0),t([b()],ot.prototype,"_expandedLine",void 0),ot=t([_("esri.widgets.ElevationProfile.Legend")],ot);let nt=class extends v{constructor(t,e){super(t,e),this._messagesUnits=null,this._popover=null,this._buttonElement=null,this._focusOutElement=null,this._requestFocusOnCreate=!1}destroy(){this._destroyPopover()}render(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;if(!t&&!e)return z("div",{key:`${this.id}-empty`});const i=s(this._popover)&&this._popover.open?this._messages.hideSettings:this._messages.showSettings;return z("button",{class:J.base,title:i,bind:this,afterCreate:this._initializePopover,onclick:this._togglePopover,"aria-label":i,type:"button"})}_initializePopover(t){this._destroyPopover(),this._buttonElement=t,this._popover=new O({owner:this,placement:"bottom-end",offset:[0,0],anchorElement:t,renderContentFunction:()=>this._renderPopoverContent()})}_destroyPopover(){this._focusOutElement=n(this._focusOutElement),this._popover=o(this._popover)}_renderPopoverContent(){const{unitSelector:t,uniformChartScalingToggle:e}=this.visibleElements;return z("div",{class:J.popoverContent,dir:T(r(this._buttonElement)),bind:this,afterCreate:this._onPopoverContentAfterCreate},t&&this._renderUnitSelector(),e&&this._renderUniformChartScalingToggle())}_renderUnitSelector(){const{unit:t,unitOptions:e}=this.viewModel,i=this._messagesUnits;return z("label",{key:"unit-selector-label",class:J.selectLabel},this._messages.unitSelectLabel,z("select",{class:J.select,value:t,bind:this,onchange:this._onUnitChange,afterCreate:this._onUnitSelectAfterCreate},e.map((t=>z("option",{key:t,value:t},D(t)?i.systems[t]:i.units[t].pluralCapitalized)))))}_onUnitChange(t){this.viewModel.unit=t.target.value}_onUnitSelectAfterCreate(t){this._requestFocusOnCreate&&(this._requestFocusOnCreate=!1,t.focus())}_renderUniformChartScalingToggle(){const t=this._messages,e=this.viewModel.uniformChartScaling,i=e?t.uniformChartScalingDisable:t.uniformChartScalingEnable;return z("label",{key:"uniform-chart-scaling-label",class:J.checkboxLabel,onmousedown:rt},z("input",{class:this.classes(J.checkbox,J.uniformChartScalingCheckbox),type:"checkbox",checked:e,title:i,"aria-label":i,bind:this,onchange:this._onUniformChartScalingChange}),t.uniformChartScalingLabel)}_onUniformChartScalingChange(t){this.viewModel.uniformChartScaling=t.target.checked}_togglePopover(t){s(this._popover)&&this._popover.open?this._closePopover():this._openPopover()}_openPopover(){i(this._popover,(t=>t.open=!0)),this._requestFocusOnCreate=!0}_closePopover({focusOnButton:t=!0}={}){i(this._popover,(t=>t.open=!1)),t&&i(this._buttonElement,(t=>t.focus()))}_onPopoverContentAfterCreate(t){n(this._focusOutElement),this._focusOutElement=d(t,"focusout",(({relatedTarget:e})=>{const i=t.contains(e),s=e===this._buttonElement;i||s||this._closePopover({focusOnButton:!1})}))}};function rt(t){t.preventDefault()}function at(t,e){const i=Math.floor(Math.log10(t)),s=t/10**i;let o;return o=e?s<1.5?1:s<3?2:s<5?2.5:s<7?5:10:s<=1?1:s<=2?2:s<=3?2.5:s<=5?5:10,o*10**i}t([b()],nt.prototype,"viewModel",void 0),t([b()],nt.prototype,"visibleElements",void 0),t([b(),A("esri/widgets/ElevationProfile/t9n/ElevationProfile")],nt.prototype,"_messages",void 0),t([b(),A("esri/core/t9n/Units")],nt.prototype,"_messagesUnits",void 0),nt=t([_("esri.widgets.ElevationProfile.SettingsButton")],nt);const lt={sideSpacing:15,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,axisFontSize:9,axisFontWeight:"400",axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:"#a9a9a9",axisTooltipFontSize:12,axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",axisTooltipPaddingTop:Math.round(3),axisTooltipPaddingBottom:Math.round(3),axisTooltipPaddingHorizontal:Math.round(3.75),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(6),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(3.75),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:"#f8f8f8",seriesTooltipLabelColor:"#323232",seriesFillLighten:.9,seriesTooltipSpacing:6,seriesTooltipPaddingVertical:Math.round(3.75),seriesTooltipPaddingHorizontal:Math.round(3.75),tooltipBorderRadius:0},ct={...lt,axisGridStroke:"#323232",axisLabelsColor:"#a9a9a9",axisTooltipBackgroundColor:"#323232",axisTooltipLabelColor:"#f8f8f8",seriesTooltipBackgroundColor:"#323232",seriesTooltipLabelColor:"#f8f8f8",seriesFillLighten:-.75},pt={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};function dt({data:t,bounds:e,pixelWidth:i,pixelHeight:s,centered:o}){if(a(t))return e;let{minX:n,maxX:r,minY:l,maxY:c}=e;const p=r-n,d=c-l,h=t.effectiveUnits,m=F(d,h.elevation,h.distance)/s/(p/i);return m>=1?[n,r]=ht([n,r],m,o):[l,c]=ht([l,c],1/m,o),{minX:n,maxX:r,minY:l,maxY:c}}function ht([t,e],i,s){const o=(e-t)*i;if(s){const i=(t+e)/2-o/2;return[i,i+o]}return[t,t+o]}function mt(t,{line:e,fill:o},n){const{theme:r}=t,{am4core:a}=t.amCharts4Index,{r:c,g:p,b:d,a:h}=n.color,m=a.color({r:c,g:p,b:d,a:h}),u=l(n.samples,new Array),g=u.length>0;e.stroke=m,e.visible=g,i(o,(t=>{t.visible=g,t.fill=m.lighten(r.seriesFillLighten)}));const b=u.length,f=e.data;if(f.length===b){let t=!1;for(let e=0;e<b;++e){const i=f[e],o=u[e];t=t||s(i.elevation)!==s(o.elevation),v=o,(_=i).x=v.x,_.y=v.y,_.z=v.z,_.distance=v.distance,_.elevation=v.elevation}t?(e.invalidateData(),i(o,(t=>t.invalidateData()))):(e.invalidateRawData(),i(o,(t=>t.invalidateRawData())))}else e.data=u,i(o,(t=>t.data=u));var _,v}function ut(t,e){const{id:i}=e,s=gt(t,`line-${i}`);s.strokeWidth=e.chartStrokeWidth,s.dy=e.chartStrokeOffsetY;let o=null;return e.chartFillEnabled&&(o=gt(t,`fill-${i}`),o.fillOpacity=1),{id:i,line:s,fill:o}}function gt(t,e){const i=new t.amCharts4Index.am4charts.LineSeries;return i.id=e,i.showOnInit=!1,i.simplifiedProcessing=!0,i.minDistance=.5,i.excludeFromTotal=!0,i.clickable=!1,i.contextMenuDisabled=!0,i.cursorHoverEnabled=!1,i.cursorTooltipEnabled=!1,i.connect=!1,i.fill=null,i.stroke=null,i.dataFields.valueX="distance",i.dataFields.valueY="elevation",i}function bt(t,e){const{amChart:i,xAxis:s,yAxis:o}=t;let n=!1;const r=()=>{const{data:e}=t;if(!n||a(e)||!e.uniformScaling)return;n=!1;const{minX:r,maxX:l,minY:c,maxY:p}=dt({data:t.data,bounds:{minX:s.minZoomed,maxX:s.maxZoomed,minY:o.minZoomed,maxY:o.maxZoomed},pixelWidth:s.pixelWidth,pixelHeight:o.pixelHeight,centered:!0});s.zoomToValues(r,l,!0),o.zoomToValues(c,p,!0),i.validate(),vt(t)},l=()=>{e(t.xAxis.zoomFactor,t.yAxis.zoomFactor)},c=e=>{t.zooming=e,vt(t)},p=[i.events.on("down",(()=>c(!0))),i.events.on("up",(()=>c(!1))),i.cursor.events.on("zoomended",(()=>{n=!0})),s.events.on("startendchanged",r),o.events.on("startendchanged",r),s.events.on("rangechangeended",l),o.events.on("rangechangeended",l)];return V((()=>{p.forEach((t=>t.dispose()))}))}function ft({xAxis:t,yAxis:e}){const i=t=>()=>{t.renderer.grid.each((t=>{t.visible="none"!==t.dataItem.label.dom.getAttribute("display")}))},s=[t.events.on("rangechangeended",i(t)),t.events.on("validated",i(t)),e.events.on("rangechangeended",i(e)),e.events.on("validated",i(e))];return V((()=>{s.forEach((t=>t.dispose()))}))}function _t(t,e){const{amChart:i,xAxis:s,yAxis:o}=t,{cursor:n,events:r}=i,a=e=>{t.pointerIsOver=e,vt(t)},l=()=>{a(!1),e(null,null)},c=[n.events.on("cursorpositionchanged",(()=>{if(!t.pointerIsOver)return;vt(t);const i=s.toAxisPosition(n.xPosition),r=o.toAxisPosition(n.yPosition);e(i,r)})),r.on("over",(()=>a(!0))),r.on("out",l),r.on("blur",l)];return V((()=>{c.forEach((t=>t.dispose()))}))}function vt(t){const{amChart:e,xAxis:o,data:n,theme:r,zooming:l,pointerIsOver:c}=t;if(t.amChart.tooltip.hide(),t.xAxis.hideTooltip(),!c)return;if(l)return;if(a(n)||!n.refined)return;const p=function(t){const{amChart:e,yAxis:o,data:n}=t;if(a(n))return null;const r=n.lines.map((e=>({line:e,y:i(jt(t,e),(t=>t.elevation))}))).sort(yt),l=r.length?r[0].y:null;if(a(l))return null;const c=e.cursor,p=o.measuredHeight,d=p+e.pixelPaddingTop;return{text:r.map((({y:e,line:i})=>function(t,e,i){const{data:o,messages:n}=t;if(a(o)||a(n))return"";const r=E().formatPrecision,l=C(n.chartTooltip,{name:it(e,n),elevation:s(i)?S(n,i,o.effectiveUnits.elevation,r):M});return`[${e.color.toHex()}]‚óè[/] ${l}`}(t,i,e))).join("\n"),x:c.point.x+c.parent.pixelX+e.pixelPaddingLeft,y:d-o.valueToPosition(l)*p}}(t);if(s(p)){const{cursor:i,tooltip:n}=e;i.show(0),i.validate(),n.text=p.text,n.show(0),n.validate();const l=p.y-n.contentHeight-r.seriesTooltipSpacing;n.pointerOrientation=l<30?"up":"down",n.pointTo(p,!0),n.validate();const c=o.tooltip;c.text=function(t){const{data:e,messages:i}=t;if(a(e)||a(i))return"";const o=e.lines[0],n=o?jt(t,o):null,r=E().formatPrecision;return s(n)?S(i,n.distance,e.effectiveUnits.distance,r):"-"}(t),c.show(0),c.validate()}}function yt({y:t},{y:e}){return a(t)?1:a(e)?-1:e-t}function kt(t,e){const i=t.xAxis.numberFormatter.clone();return i.format=(i,s,o)=>{const{messages:n,data:r}=t;return a(n)||a(r)||"string"==typeof i?"":`${H(i,{maximumFractionDigits:o})} ${P(n,r.effectiveUnits[e],"abbr")}`},i}function jt({amChart:t,xAxis:e},i){const s=l(i.samples,[]);if(0===s.length)return null;const o=e.toAxisPosition(t.cursor.xPosition),n=e.positionToValue(o);return f(s,n,(t=>t.distance))}var Ct;!function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"}(Ct||(Ct={}));const xt=[{type:Ct.Select},{type:Ct.Sketch}],St={[L.None]:null,[L.NoValidInput]:"noProfile",[L.NoVisibleProfiles]:"noProfile",[L.RefinedButNoChartData]:"noProfile",[L.TooComplex]:"tooComplex",[L.UnknownError]:"unknown",[L.InvalidGeometry]:"invalidGeometry",[L.InvalidElevationInfo]:"invalidElevationInfo"};let wt=class extends v{constructor(t,e){super(t,e),this.viewModel=null,this.visibleElements=new tt,this.iconClass=Y.widgetIcon,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=p(((t,e,i,s)=>({chart:t,data:e,stationary:i,messages:s}))),this._getDetailsPropsMemoized=p(((t,e)=>({effectiveUnits:t,profiles:e}))),t?.viewModel||(this._defaultViewModel=new y({view:t?.view}),this.viewModel=this._defaultViewModel)}initialize(){this._legend=new ot(this._legendProps),this._settingsButton=new nt(this._settingsButtonProps),this.addHandles([u((()=>this._legendProps),(t=>this._legend.set(t))),u((()=>this._settingsButtonProps),(t=>this._settingsButton.set(t)))])}postInitialize(){this.addHandles([u((()=>({container:this._chartContainer,width:this._width})),(({container:t,width:e})=>{this._destroyChart(),s(t)&&e>0&&this._initializeChart(t)}),g),u((()=>this._chartUpdateParams),(()=>this._updateChart(this._chartUpdateParams)),g)])}destroy(){this._destroyChart(),s(this._defaultViewModel)&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy(),this._legend=o(this._legend),this._settingsButton=o(this._settingsButton)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get input(){return this.viewModel.input}set input(t){this.viewModel.input=t}get profiles(){return this.viewModel.profiles}set profiles(t){this.viewModel.profiles=t}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(t){this.viewModel.unitOptions=t}get unit(){return this.viewModel.unit}set unit(t){this.viewModel.unit=t}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(t){this.viewModel.geodesicDistanceThreshold=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get visible(){return this.viewModel.visible}set visible(t){this.viewModel.visible=t}get _portrait(){return this._width<E().portraitModePixelBreakpoint}get _chartUpdateParams(){const t=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,!s(t)||t.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _legendProps(){return this._getDetailsPropsMemoized(this.viewModel.effectiveUnits,this._profilesArray)}get _profilesArray(){return this.profiles.toArray()}get _settingsButtonProps(){return{viewModel:this.viewModel,visibleElements:this.visibleElements}}render(){const{viewModel:t,visible:e}=this;return z("div",{key:this,class:this.classes({[Y.base]:e,[Y.esriWidget]:e,[Y.esriWidgetDisabled]:e&&"disabled"===t.state,[Y.portrait]:this._portrait,[Y.refined]:1===t.progress}),"aria-label":this.messages.widgetLabel,afterCreate:t=>{this.addHandles(I(t,(t=>{this._width=t.contentRect.width})))}},e&&this._renderContentForState())}_renderContentForState(){switch(this.viewModel.state){case U.Ready:return this._renderContentForReadyState();case U.Selecting:return this._renderContentForSelectingState();case U.Creating:return this._renderContentForCreatingState();case U.Selected:return this._renderContentForSelectedState();case U.Created:return this._renderContentForCreatedState();case U.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){const{sketchButton:t,selectButton:e}=this.visibleElements,i=this.messages;let s;return s=t&&e?i.readyPrompt:t?i.readyPromptCreateOnly:e?i.readyPromptSelectOnly:i.errors?.noProfile,this._renderContent({prompt:s,chart:!1,actions:xt})}_renderContentForSelectingState(){const t=this.view;if(a(t))return null;const e=this.messages[`selectingPrompt-${t.type}`];return this._renderContent({prompt:e,chart:!1,actions:[{type:Ct.SelectCancel}]})}_renderContentForCreatingState(){const{view:t,viewModel:e}=this;if(a(t))return null;const i=e.hasVertices?[{type:Ct.SketchCancel},{type:Ct.SketchDone,disabled:!e.tool.interaction.canStopCreating}]:[{type:Ct.Select},{type:Ct.Sketch,disabled:!0}];if(e.errorState===L.NoValidInput){const e=this.messages[`creatingPrompt-${t.type}`];return this._renderContent({chart:!1,actions:i,prompt:e})}const s=this._getErrorMessage();return s?this._renderContent({chart:!1,actions:i,prompt:s}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:xt,prompt:t}):this._renderContent({chart:!0,actions:xt})}_renderContentForCreatedState(){const t=this._getErrorMessage();return t?this._renderContent({chart:!1,actions:xt,prompt:t}):this._renderContent({chart:!0,actions:xt})}_getErrorMessage(){const t=St[this.viewModel.errorState];return this.messages?.errors?.[t]}_renderContent(t){const e=s(t.prompt)?this._renderPrompt(t.prompt):t.chart&&this._renderChart(),i=s(this.viewModel.input);return[z("header",{key:"header",class:Y.header},this._zoomOutButtonVisible&&this._renderZoomOutButton(),this.visibleElements.clearButton&&i&&this._renderClearButton(),this.visibleElements.settingsButton&&this._settingsButton.render()),z("div",{class:Y.mainContainer},e),this.visibleElements.legend&&this._legend.render(),this._renderActions(t)]}_renderZoomOutButton(){return z("button",{key:"zoom-out",class:Y.zoomOutButton,bind:this,onclick:this._onZoomOutButtonClick,title:this.messages.zoomOut,type:"button"})}_onZoomOutButtonClick(){i(this._chart,(t=>t.zoomOut()))}_renderClearButton(){return z("button",{key:"clear-profile",class:Y.clearButton,bind:this,onclick:this._onClearButtonClick,title:this.messages.clearProfile,type:"button"})}_onClearButtonClick(){this.viewModel.clear()}_renderPrompt(t){return[z("div",{key:"prompt-container",bind:this,class:Y.promptContainer},z("p",null,t))]}_renderChart(){if(!this.visibleElements.chart)return[z("div",{key:"empty-chart-container",class:Y.chartContainer})];const t=this._chartIsRefined||this._canRenderChart();if(!t)return[this._renderSpinner({size:"large"}),z("div",{key:"chart-container-empty",class:Y.chartContainer})];const{chartData:e,progress:i}=this.viewModel;return[s(e)&&i>0&&i<1&&this._renderSpinner({size:t?"small":"large"}),z("div",{key:"chart-container",bind:this,class:Y.chartContainer,afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved})]}_renderSpinner(t){return z("div",{key:"spinner",class:this.classes(Y.chartSpinner,{[Y.chartSpinnerSmall]:"small"===t.size}),afterCreate:this._onSpinnerAfterCreate,exitAnimation:this._onSpinnerExit})}_onSpinnerAfterCreate(t){requestAnimationFrame((()=>t.classList.add(Y.chartSpinnerVisible)))}_onSpinnerExit(t,e){t.classList.remove(Y.chartSpinnerVisible),setTimeout(e,200)}_canRenderChart(){const t=this.viewModel.chartData;if(a(t))return!1;if(!this.viewModel.inputIsSketched)return t.refined;let e=0;for(const{samples:i}of t.lines)e+=s(i)?i.length:0;return t.refined||e<=E().largeChartSamples}_renderActions({actions:t}){const e=t.map((t=>{switch(t.type){case Ct.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onSketchButtonClick,className:Y.sketchButton,label:this.messages.sketchButtonLabel});case Ct.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onCancelButtonClick,className:Y.sketchCancelButton,label:this.messagesCommon.cancel});case Ct.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:t,onClick:this._onDoneButtonClick,className:Y.sketchDoneButton,label:this.messagesCommon.done});case Ct.Select:return this.visibleElements.selectButton&&this._renderAction({action:t,onClick:this._onSelectButtonClick,className:Y.selectButton,label:this.messages.selectButtonLabel});case Ct.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:t,onClick:this._onCancelButtonClick,className:Y.selectCancelButton,label:this.messagesCommon.cancel})}})).filter(Boolean);return e.length?z("footer",{key:"footer",class:Y.footer},e):null}_renderAction({action:t,onClick:e,className:i,label:s}){return z("button",{key:`action-${t.type}`,class:this.classes(Y.actionButton,i,{[Y.buttonDisabled]:t.disabled}),bind:this,disabled:t.disabled,onclick:e,type:"button"},s)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_updateChart(t){const{data:e,chart:i,messages:o,stationary:n}=t;!a(i)&&!a(o)&&n&&this._canRenderChart()&&(i.update(t),this._chartIsRefined=s(e)&&e.refined)}_onChartContainerAfterCreate(t){this._chartContainer=t}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(t){c(this._chartInitTask),this._chartInitTask=e((async e=>{const n=await async function(t){const e=await R(),{am4core:o,am4charts:n}=e;h(t.abortOptions);const{options:r}=o;r.minPolylineStep=.5,r.autoSetClassName=!0,r.animationsEnabled=!1;const l=W(),c=l?ct:lt;l&&o.useTheme(e.am4themes_dark);const p=o.create(t.container,n.XYChart);p.arrangeTooltips=!1,p.preloader.disabled=!0,p.zoomOutButton.disabled=!0;const d=B(t.container);p.rtl=d,p.padding(c.paddingTop,d?c.paddingLeft:c.paddingRight,c.paddingBottom,d?c.paddingRight:c.paddingLeft);const m=p.plotContainer.background;m.strokeWidth=0,m.strokeOpacity=0,m.stroke=null;const u=p.xAxes.push(new n.ValueAxis),g=p.yAxes.push(new n.ValueAxis),b={params:t,amCharts4Index:e,amChart:p,xAxis:u,yAxis:g,series:new Map,data:null,messages:null,theme:c,zooming:!1,pointerIsOver:!1};p.cursor=function(t){const e=new t.amCharts4Index.am4charts.XYCursor;return e.trackable=!0,e.lineY.disabled=!0,e.behavior="zoomXY",e}(b),function(t){const e=t.theme,i=t.amChart.tooltip,{am4core:s}=t.amCharts4Index;i.id="series-tooltip",i.fitPointerToBounds=!0,i.pointerOrientation="vertical",i.zIndex=-1,i.getFillFromObject=!1,i.label.fontSize=e.seriesTooltipFontSize,i.label.fill=s.color(e.seriesTooltipLabelColor),i.label.padding(e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal,e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal),i.background.cornerRadius=e.tooltipBorderRadius,i.background.stroke=null,i.background.fill=s.color(e.seriesTooltipBackgroundColor),i.background.padding(0,0,0,0),i.adapter.add("dy",(()=>e.seriesTooltipSpacing*(i.background.pointerY<=0?1:-1))),B(t.params.container)&&(i.label.textAlign="middle")}(b),function(t){const{xAxis:e,theme:i}=t,{am4core:s}=t.amCharts4Index;e.numberFormatter=kt(t,"distance"),e.strictMinMax=!0,e.cursorTooltipEnabled=!1,e.title.visible=!1;const o=e.renderer;o.line.visible=!1,o.minGridDistance=i.xAxisMinGridDistance,o.minLabelPosition=i.xAxisMinLabelPosition,o.maxLabelPosition=i.xAxisMaxLabelPosition,o.fontWeight=i.axisFontWeight,o.fontSize=i.axisFontSize,o.baseGrid.disabled=!0;const n=o.labels.template;n.fontSize=i.axisLabelsFontSize,n.fontWeight=i.axisLabelsFontWeight,n.fill=s.color(i.axisLabelsColor),n.paddingTop=i.xAxisLabelsSpacing,n.horizontalCenter="left",n.paddingLeft=0;const r=e.tooltip;r.id="axis-tooltip",r.background.fill=s.color(i.axisTooltipBackgroundColor),r.background.stroke=null,r.background.padding(0,0,0,0),r.label.fontSize=i.axisTooltipFontSize,r.label.fill=s.color(i.axisTooltipLabelColor),r.label.padding(i.axisTooltipPaddingTop,i.axisTooltipPaddingHorizontal,i.axisTooltipPaddingBottom,i.axisTooltipPaddingHorizontal);const a=o.grid.template;a.strokeOpacity=1,a.stroke=s.color(i.axisGridStroke)}(b),function(t){const{yAxis:e,theme:i}=t,{am4core:s}=t.amCharts4Index;e.numberFormatter=kt(t,"elevation"),e.title.visible=!1,e.cursorTooltipEnabled=!1,e.strictMinMax=!0,e.baseValue=E().noDataValue;const o=e.renderer;o.inside=!0,o.line.opacity=0,o.line.visible=!1,o.minGridDistance=i.yAxisMinGridDistance,o.minLabelPosition=i.yAxisMinLabelPosition,o.maxLabelPosition=i.yAxisMaxLabelPosition,o.fontWeight=i.axisFontWeight,o.fontSize=i.axisFontSize,o.baseGrid.disabled=!0;const n=o.labels.template;n.fontSize=i.axisLabelsFontSize,n.fontWeight=i.axisLabelsFontWeight,n.fill=s.color(i.axisLabelsColor),n.verticalCenter="bottom",n.paddingLeft=i.yAxisLabelSpacing,n.paddingBottom=0;const r=o.grid.template;r.strokeOpacity=1,r.stroke=s.color(i.axisGridStroke),B(t.params.container)&&(o.opposite=!0,n.textAlign="middle",n.paddingLeft=0,n.paddingRight=i.yAxisLabelSpacing)}(b);const f=[bt(b,t.onRangeChange),_t(b,t.onCursorPositionChange),ft(b)];let _=null,v=!1;const y=()=>{a(_)||("undefined"!=typeof window&&"cancelIdleCallback"in window?window.cancelIdleCallback(_):clearTimeout(_),_=null)};return{...b,destroy(){v=!0,y(),$(f).remove(),p.dispose()},update(t){if(t.data===b.data&&t.messages===b.messages)return;if(y(),v)return;const e=()=>{v||(_=null,function(t,{data:e,messages:o}){const{htmlContainer:n}=t.amChart;if(!n)return;const r=s(e)&&e.refined;t.amChart.cursor.disabled=!r,n.classList.toggle("amcharts-cursor--enabled",r);const l=t.data!==e,c=i(t.data,(t=>t.effectiveUnits))!==i(e,(t=>t.effectiveUnits));t.data=e,t.messages=o,l&&(function(t){const{xAxis:e,yAxis:s}=t,{minX:o,maxX:n,minY:r,maxY:l}=function({data:t,pixelWidth:e,pixelHeight:s}){if(a(t))return pt;const o=t.statistics,n=i(o,(t=>t.maxDistance));let r=i(o,(t=>t.minElevation)),l=i(o,(t=>t.maxElevation));if(a(n)||a(r)||a(l))return pt;const c=Math.max(n-0,.001);let p=Math.max(l-r,.001);const d=t.effectiveUnits;if(t.dynamicElevationRange){const t=F(c,d.distance,d.elevation);p=Math.max(p,t/E().maxChartRatio)}return r-=.02*p,l=r+p+.02*p,[r,l]=function(t,e,i=10){const s=at(e-t,!1);if(0===s)return[t,e];const o=at(s/(i-1),!0);return[Math.floor(t/o)*o,Math.ceil(e/o)*o]}(r,l,10),p=l-r,t.uniformScaling?dt({data:t,bounds:{minX:0,maxX:n,minY:r,maxY:l},pixelWidth:e,pixelHeight:s,centered:!0}):{minX:0,maxX:0+c,minY:r,maxY:r+p}}({data:t.data,pixelWidth:e.pixelWidth,pixelHeight:s.pixelHeight});e.min=o,e.max=n,s.min=r,s.max=l}(t),function(t){const{amChart:e,data:s}=t;if(a(s)||0===s.lines.length)return void e.series.clear();const o=new Map,n=new Set(e.series.values),r=s.lines.length;for(let a=0;a<r;a++){const l=s.lines[a];let c=t.series.get(l.id);c?(i(c.fill,(t=>n.delete(t))),n.delete(c.line)):(c=ut(t,l),i(c.fill,(t=>e.series.push(t))),e.series.push(c.line)),o.set(c.id,c);const p=r-a-1;i(c.fill,(t=>t.zIndex=p)),c.line.zIndex=r+p,mt(t,c,l)}t.series=o;for(const t of n)e.series.removeValue(t)}(t)),c&&(t.yAxis.invalidateLabels(),t.xAxis.invalidateLabels()),vt(t)}(b,t))};_="undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(e,{timeout:30}):setTimeout(e,30)},zoomOut(){v||(b.yAxis.zoom({start:0,end:1},!1,!0),b.xAxis.zoom({start:0,end:1},!1,!0))}}}({container:t,abortOptions:{signal:e},onRangeChange:(t,e)=>{this._zoomOutButtonVisible=1!==t||1!==e},onCursorPositionChange:t=>{this.viewModel.hoveredChartPosition=t}});if(e.aborted)throw o(n),m();this._chart=n,this._updateChart(this._chartUpdateParams)}))}_destroyChart(){this._chartInitTask=c(this._chartInitTask),this._chart=o(this._chart),this._chartIsRefined=!1}get test(){return{projector:this._projector,chart:this._chart}}};t([b({type:y})],wt.prototype,"viewModel",void 0),t([b()],wt.prototype,"view",null),t([b()],wt.prototype,"input",null),t([b()],wt.prototype,"profiles",null),t([b()],wt.prototype,"unitOptions",null),t([b()],wt.prototype,"unit",null),t([b()],wt.prototype,"geodesicDistanceThreshold",null),t([b({type:tt,nonNullable:!0})],wt.prototype,"visibleElements",void 0),t([b()],wt.prototype,"iconClass",void 0),t([b()],wt.prototype,"label",null),t([b()],wt.prototype,"visible",null),t([b(),A("esri/widgets/ElevationProfile/t9n/ElevationProfile")],wt.prototype,"messages",void 0),t([b(),A("esri/t9n/common")],wt.prototype,"messagesCommon",void 0),t([b(),A("esri/core/t9n/Units")],wt.prototype,"messagesUnits",void 0),t([b()],wt.prototype,"_chartContainer",void 0),t([b()],wt.prototype,"_chart",void 0),t([b()],wt.prototype,"_chartInitTask",void 0),t([b()],wt.prototype,"_chartIsRefined",void 0),t([b()],wt.prototype,"_settingsButton",void 0),t([b()],wt.prototype,"_legend",void 0),t([b()],wt.prototype,"_width",void 0),t([b()],wt.prototype,"_portrait",null),t([b()],wt.prototype,"_zoomOutButtonVisible",void 0),t([b()],wt.prototype,"_chartUpdateParams",null),t([b()],wt.prototype,"_chartMessages",null),t([b()],wt.prototype,"_legendProps",null),t([b()],wt.prototype,"_profilesArray",null),t([b()],wt.prototype,"_settingsButtonProps",null),wt=t([_("esri.widgets.ElevationProfile")],wt);const Pt=wt;export{Pt as default};
