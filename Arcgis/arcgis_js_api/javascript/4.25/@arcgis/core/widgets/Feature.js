/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{substitute as t}from"../intl.js";import{watch as s,initial as r,on as i}from"../core/reactiveUtils.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{cast as n}from"../core/accessorSupport/decorators/cast.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import a from"./Widget.js";import"../chunks/ensureType.js";import p from"./Attachments.js";import d,{F as u,a as m,b as c,c as h,d as y,e as f}from"./Feature/FeatureViewModel.js";import{H as v}from"../chunks/Heading.js";import{i as j}from"../chunks/widgetUtils.js";import{t as g}from"../chunks/jsxFactory.js";import{s as b}from"./Attachments/AttachmentsViewModel.js";import{isWidget as w,hasDomNode as M}from"./support/widget.js";import{a as _}from"../chunks/uriUtils.js";import{m as k}from"../chunks/messageBundle.js";import{e as I,after as C}from"../core/promiseUtils.js";import{d as F}from"../chunks/utils15.js";import{l as x,g as E}from"../chunks/chartUtils.js";import{i as L}from"../chunks/themeUtils.js";import{d as S}from"../chunks/maybe.js";import"../chunks/Logger.js";import"../core/Error.js";import"../chunks/object.js";import"../chunks/number.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/string.js";import"../chunks/messages.js";import"../request.js";import"../config.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/handleUtils.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/metadata.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Accessor.js";import"../core/Handles.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/unitFormatUtils.js";import"../chunks/byteSizeEstimations.js";import"../chunks/Cyclical.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";import"../chunks/unitUtils.js";import"../chunks/projectionEllipsoid.js";import"../geometry/SpatialReference.js";import"../core/JSONSupport.js";import"../chunks/writer.js";import"../chunks/Ellipsoid.js";import"../Graphic.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../chunks/reader.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../layers/support/fieldUtils.js";import"../chunks/arcadeOnDemand.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../chunks/date.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../Color.js";import"../chunks/colorUtils.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils2.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils3.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../chunks/aaBoundingRect.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../portal/PortalGroup.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../chunks/throttle.js";import"../core/HandleOwner.js";import"../chunks/WatchUpdatingTracking.js";import"../chunks/DataLayerSource.js";import"../layers/support/Field.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../chunks/fieldType.js";import"../chunks/executeQueryJSON.js";import"../chunks/utils4.js";import"../chunks/query.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils5.js";import"../chunks/pbfQueryUtils.js";import"../chunks/pbf.js";import"../chunks/OptimizedFeature.js";import"../chunks/OptimizedFeatureSet.js";import"../chunks/queryZScale.js";import"../chunks/zscale.js";import"../rest/support/FeatureSet.js";import"../rest/support/Query.js";import"../TimeExtent.js";import"../chunks/timeUtils.js";import"../chunks/FullTextSearch.js";import"../rest/support/StatisticDefinition.js";import"../chunks/featureConversionUtils.js";import"../rest/query/support/AttachmentInfo.js";import"../rest/support/AttachmentQuery.js";import"../rest/support/RelationshipQuery.js";import"../rest/support/TopFeaturesQuery.js";import"../rest/support/TopFilter.js";import"../layers/FeatureLayer.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../chunks/LegendOptions.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/sizeVariableUtils.js";import"../chunks/visualVariableUtils.js";import"../chunks/compilerUtils.js";import"../chunks/lengthUtils.js";import"../renderers/support/ClassBreakInfo.js";import"../chunks/commonProperties2.js";import"../symbols/support/jsonUtils.js";import"../chunks/symbolConversion.js";import"../renderers/DictionaryRenderer.js";import"../chunks/DictionaryLoader.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../chunks/vec4f64.js";import"../renderers/PieChartRenderer.js";import"../renderers/SimpleRenderer.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../renderers/support/UniqueValue.js";import"../renderers/support/UniqueValueClass.js";import"../renderers/support/UniqueValueGroup.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils2.js";import"../renderers/support/jsonUtils.js";import"../chunks/MultiOriginJSONSupport.js";import"../core/sql.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../form/elements/Element.js";import"../form/support/elements.js";import"../form/elements/FieldElement.js";import"../form/elements/support/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../layers/Layer.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../chunks/Queue.js";import"../core/workers/RemoteClient.js";import"../chunks/editsZScale.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../chunks/arcgisLayerUrl.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser.js";import"../chunks/mat4f32.js";import"../chunks/mat4.js";import"../chunks/_commonjsHelpers.js";import"../layers/mixins/CustomParametersMixin.js";import"../chunks/EditBusLayer.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../layers/mixins/FeatureLayerBase.js";import"../geometry/HeightModelInfo.js";import"../chunks/commonProperties.js";import"../support/timeUtils.js";import"../chunks/ElevationInfo.js";import"../chunks/unitConversionUtils.js";import"../layers/support/GeometryFieldsInfo.js";import"../layers/support/LayerFloorInfo.js";import"../layers/support/Relationship.js";import"../layers/mixins/FeatureReductionLayer.js";import"../layers/support/AggregateField.js";import"../layers/support/ExpressionInfo.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../chunks/defaults.js";import"../chunks/defaultsJSON.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../chunks/clusterUtils.js";import"../chunks/OperationalLayer.js";import"../layers/mixins/OrderedLayer.js";import"../layers/mixins/PortalLayer.js";import"../chunks/asyncUtils.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../layers/mixins/PublishableLayer.js";import"../layers/support/PublishingInfo.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/ScaleRangeLayer.js";import"../layers/mixins/TemporalLayer.js";import"../TimeInterval.js";import"../layers/support/TimeInfo.js";import"../layers/support/TimeReference.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../layers/support/FieldsIndex.js";import"../chunks/labelingInfo.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils.js";import"../support/popupUtils.js";import"../chunks/accessibleHandler.js";import"../chunks/vmEvent.js";import"../chunks/numberUtils.js";import"../chunks/utils6.js";import"../chunks/ItemCache.js";import"../symbols/support/cimSymbolUtils.js";import"../chunks/utils7.js";let T=class extends a{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return g("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?g(v,{level:this.headingLevel,class:"esri-feature-element-info__title"},e):null}renderDescription(){const{description:e}=this;return e?g("div",{key:"description",class:"esri-feature-element-info__description"},e):null}};e([o()],T.prototype,"description",void 0),e([o()],T.prototype,"headingLevel",void 0),e([o()],T.prototype,"title",void 0),T=e([l("esri.widgets.Feature.support.FeatureElementInfo")],T);const R=T;let U=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new p,this.headingLevel=2,this.viewModel=new u}initialize(){this._featureElementInfo=new R,this.addHandles([s((()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),r),s((()=>this.viewModel?.graphic),(e=>this.attachmentsWidget.graphic=e),r)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){const{attachmentsWidget:e}=this;return g("div",{class:"esri-feature-attachments"},this._featureElementInfo?.render(),e?.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:s}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:s})}};e([o({readOnly:!0})],U.prototype,"attachmentsWidget",void 0),e([o()],U.prototype,"description",null),e([o()],U.prototype,"displayType",null),e([o()],U.prototype,"graphic",null),e([o()],U.prototype,"headingLevel",void 0),e([o()],U.prototype,"title",null),e([o({type:u})],U.prototype,"viewModel",void 0),U=e([l("esri.widgets.Feature.FeatureAttachments")],U);const A=U;let P=class extends a{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{b(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return g("div",{class:"esri-feature-content__loader-container",key:"loader"},g("div",{class:"esri-feature-content__loader"}))}renderCreated(){const e=this.viewModel?.created;return e?e instanceof HTMLElement?g("div",{key:e,bind:e,afterCreate:this._attachToNode}):w(e)?g("div",{key:e},!e.destroyed&&e.render()):g("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){const e=this.viewModel?.state;return g("div",{class:"esri-feature-content"},"loading"===e?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this)}};e([o()],P.prototype,"creator",null),e([o()],P.prototype,"graphic",null),e([o({type:m})],P.prototype,"viewModel",void 0),P=e([l("esri.widgets.Feature.FeatureContent")],P);const D=P;let V=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new c,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new R,this.addHandles(s((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),r))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",n=!(!e.format||!e.format.dateFormat),l="number"!=typeof o||n?_(this.messagesURIUtils,o):this._forceLTR(o),a={"esri-feature-fields__field-data--date":n};return g("tr",{key:`fields-element-info-row-${r}-${t}`},g("th",{key:`fields-element-info-row-header-${r}-${t}`,class:"esri-feature-fields__field-header",innerHTML:i}),g("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes("esri-feature-fields__field-data",a),innerHTML:l}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e?.length?g("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},g("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){return g("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};e([o()],V.prototype,"attributes",null),e([o()],V.prototype,"description",null),e([o()],V.prototype,"expressionInfos",null),e([o()],V.prototype,"fieldInfos",null),e([o()],V.prototype,"title",null),e([o({type:c,nonNullable:!0})],V.prototype,"viewModel",void 0),e([o(),k("esri/widgets/Feature/t9n/Feature")],V.prototype,"messages",void 0),e([o(),k("esri/widgets/support/t9n/uriUtils")],V.prototype,"messagesURIUtils",void 0),V=e([l("esri.widgets.Feature.FeatureFields")],V);const W=V,O="esri-feature-media__icon";let N=class extends a{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new h,this.messages=null,this._getChartDependencies=async e=>{const t=await x(),{destroyed:s,viewModel:r}=this;if(s||!r||!e)return;const{activeMediaInfo:i}=r,o=await this._getRendererColors(t);this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t,colorMap:o})}}initialize(){this._featureElementInfo=new R,this.addHandles([s((()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex]),(()=>this._setupMediaRefreshTimer()),r),s((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),r)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return g("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?g("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:s,formattedMediaInfoCount:r}=this.viewModel,{value:i,refreshInterval:o,altText:n,title:l,type:a}=e,{sourceURL:p,linkURL:d}=i,u=b(d)?"_blank":"_self",m="_blank"===u?"noreferrer":"",c=o?t:null,h=c?c.timestamp:0,y=c?c.sourceURL:p,f=g("img",{alt:n||l,key:`media-${a}-${s}-${r}-${h}`,src:y});return(d?g("a",{title:l,href:d,rel:m,target:u},f):null)||f}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:s}=this.viewModel;return g("div",{key:`media-${e.type}-${t}-${s}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?g("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:e.title}):null,s=e.caption?g("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:e.caption}):null;return g("div",{key:"media-container",class:"esri-feature-media__item-container"},g("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),t,s)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,s=t?this.messages.previous:this.messages.next,r=t?this.classes("esri-feature-media__button","esri-feature-media__previous"):this.classes("esri-feature-media__button","esri-feature-media__next"),i=t?this.classes(O,"esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):this.classes(O,"esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),o=t?this.classes(O,"esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes(O,"esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow"),n=t?"media-previous":"media-next",l=t?this._previous:this._next;return g("button",{type:"button",key:n,title:s,"aria-label":s,tabIndex:0,class:r,bind:this,onclick:l},g("span",{"aria-hidden":"true",class:i}),g("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){const{am4core:t}=e,s=new Map,r=this.viewModel?.layer?.renderer;if(!r)return s;const i=await F(r);return i.delete("default"),Array.from(i.values()).every((e=>1===e?.length))?(s.set("default-line-value",t.color({r:50,g:50,b:50,a:1})),Array.from(i.keys()).forEach((e=>{e&&s.set(e,t.color(i.get(e)[0].toCss(!0)))})),s):s}_handleMediaKeyup(e){const t=I(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:s,chartDiv:r,mediaInfo:i,colorMap:o}=e,{value:n,type:l}=i,{am4core:a}=s,p=E(a);L()&&a.useTheme(s.am4themes_dark);const d=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!d.matches?a.useTheme(s.am4themes_animated):a.unuseTheme(s.am4themes_animated),a.useTheme((function(e){e instanceof a.ColorSet&&p&&(e.list=p)}));const u="pie-chart"===l?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",i.altText||i.title),u.data=n.series.map((e=>({tooltip:e.tooltip,value:e.value,color:o.get(e.fieldName)}))).filter((e=>"pie-chart"!==l||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:s}=e,{am4core:r,am4charts:i}=s,o=r.create(t,i.PieChart);o.rtl=j(this.container);const n=o.series.push(new i.PieSeries);return n.labels.template.disabled=!0,n.ticks.template.disabled=!0,n.dataFields.value="value",n.dataFields.category="tooltip",this._customizeChartTooltip(n.tooltip,r),n.slices.template.propertyFields.fill="color",n.slices.template.propertyFields.stroke="color",o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:s,mediaInfo:r}=t,{value:i}=r,{am4core:o,am4charts:n}=s,l=e.xAxes.push(new n.CategoryAxis);l.dataFields.category="tooltip",l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,o),l.tooltip.events.on("sizechanged",(()=>{l.tooltip.dy=-l.tooltip.contentHeight}));const a=e.yAxes.push(new n.ValueAxis),p=a.renderer.labels.template;a.renderer.minLabelPosition=.05,a.renderer.maxLabelPosition=.95,a.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(a.tooltip,o),p.wrap=!0;const d=e.series.push(new n.ColumnSeries);d.dataFields.valueY="value",d.dataFields.categoryX="tooltip",d.columns.template.propertyFields.fill="color",d.columns.template.propertyFields.stroke="color",e.cursor=new n.XYCursor,i.series.length>15&&(e.scrollbarX=new o.Scrollbar)}_createBarChart(e,t){const{chartsModule:s,mediaInfo:r}=t,{value:i}=r,{am4core:o,am4charts:n}=s,l=e.yAxes.push(new n.CategoryAxis);l.dataFields.category="tooltip",l.renderer.inversed=!0,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,o),l.tooltip.events.on("sizechanged",(()=>{l.tooltip.dx=l.tooltip.contentWidth}));const a=e.xAxes.push(new n.ValueAxis),p=a.renderer.labels.template;a.renderer.minLabelPosition=.05,a.renderer.maxLabelPosition=.95,a.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(a.tooltip,o),p.wrap=!0;const d=e.series.push(new n.ColumnSeries);d.dataFields.valueX="value",d.dataFields.categoryY="tooltip",d.columns.template.propertyFields.fill="color",d.columns.template.propertyFields.stroke="color",e.cursor=new n.XYCursor,i.series.length>15&&(e.scrollbarY=new o.Scrollbar)}_createLineChart(e,t){const{chartsModule:s,mediaInfo:r,colorMap:i}=t,{value:o}=r,{am4core:n,am4charts:l}=s,a=e.xAxes.push(new l.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,n),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const p=e.yAxes.push(new l.ValueAxis),d=p.renderer.labels.template;p.renderer.minLabelPosition=.05,p.renderer.maxLabelPosition=.95,p.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(p.tooltip,n),d.wrap=!0;const u=e.series.push(new l.LineSeries);u.dataFields.categoryX="tooltip",u.dataFields.valueY="value",u.strokeWidth=1;const m=i.get("default-line-value");m&&(u.stroke=m);const c=u.bullets.push(new l.CircleBullet);c.propertyFields.fill="color",c.propertyFields.stroke="color",e.cursor=new l.XYCursor,o.series.length>15&&(e.scrollbarX=new n.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:s,mediaInfo:r}=e,{type:i}=r,{am4core:o,am4charts:n}=s,l=o.create(t,n.XYChart);return l.rtl=j(this.container),"column-chart"===i&&this._createColumnChart(l,e),"bar-chart"===i&&this._createBarChart(l,e),"line-chart"===i&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:s}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(s.sourceURL);const i=setInterval((()=>{this._updateMediaInfoTimestamp(s.sourceURL)}),r);this._refreshTimer=i}_getImageSource(e,t){const s=e.includes("?")?"&":"?",[r,i=""]=e.split("#");return`${r}${s}timestamp=${t}${i?"#":""}${i}`}};e([o()],N.prototype,"attributes",null),e([o()],N.prototype,"activeMediaInfoIndex",null),e([o()],N.prototype,"description",null),e([o()],N.prototype,"fieldInfoMap",null),e([o()],N.prototype,"layer",null),e([o()],N.prototype,"mediaInfos",null),e([o()],N.prototype,"popupTemplate",null),e([o()],N.prototype,"relatedInfos",null),e([o()],N.prototype,"title",null),e([o({type:h})],N.prototype,"viewModel",void 0),e([o(),k("esri/widgets/Feature/t9n/Feature")],N.prototype,"messages",void 0),N=e([l("esri.widgets.Feature.FeatureMedia")],N);const H=N;let B=class extends a{constructor(e,t){super(e,t),this.viewModel=new y}initialize(){this.addHandles(s((()=>this.viewModel?.contentElementViewModel),(()=>this._setupExpressionWidget()),r))}destroy(){this._destroyContentWidget()}renderLoading(){return g("div",{key:"loading-container",class:"esri-feature__loading-container"},g("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))}render(){const{state:e}=this.viewModel;return g("div",{class:"esri-feature-expression"},"loading"===e?this.renderLoading():"disabled"===e?null:this._contentWidget?.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,s=t?.type;this._destroyContentWidget();const r=e?"fields"===s?new W({viewModel:e}):"media"===s?new H({viewModel:e}):"text"===s?new D({viewModel:e}):null:null;this._contentWidget=r,this.scheduleRender()}};e([o({type:y})],B.prototype,"viewModel",void 0),B=e([l("esri.widgets.Feature.FeatureExpression")],B);const z=B,$={title:!0,description:!0};let q=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver((([e])=>{e?.isIntersecting&&this._increaseFeaturePage()}),{root:window.document}),this.headingLevel=2,this.viewModel=new f,this.messages=null,this.messagesCommon=null,this.visibleElements={...$},this._increaseFeaturePage=()=>{const{state:e,showAllEnabled:t,relatedFeatures:s,featuresPerPage:r,featurePage:i}=this.viewModel;"ready"===e&&t&&s.length>=r*i&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new R,this.addHandles([s((()=>[this.viewModel.description,this.viewModel.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),r),s((()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode]),(()=>this._handleRelatedFeatureObserverChange())),i((()=>this.viewModel.relatedFeatureViewModels),"change",(()=>this._setupRelatedFeatureViewModels()))])}loadDependencies(){return Promise.all([import("../chunks/calcite-list.js"),import("../chunks/calcite-list-item.js"),import("../chunks/calcite-icon.js"),import("../chunks/calcite-notice.js")])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=S(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:s}=this.viewModel;return!e&&(t>s||0===s)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:s}=this.viewModel;return t(1===s?e?.numberRecord:e?.numberRecords,{number:s})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...$,...e}}renderStickyLoading(){return"querying"===this.viewModel.state?g("div",{key:"sticky-loader",class:"esri-feature__sticky-loading-container"},this.renderLoadingIcon()):null}renderLoadingIcon(){return g("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")})}renderLoading(){return g("div",{key:"loading-container",class:"esri-feature__loading-container"},this.renderLoadingIcon())}renderShowAllIconNode(){return g("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=j(this.container)?"chevron-left":"chevron-right";return g("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){const{itemDescriptionFieldName:t}=this.viewModel,s=e.title;e.description=t&&e.formattedAttributes?.global[t];const r="loading"===e.state;return g("calcite-list-item",{key:e.uid,label:r?`${this.messagesCommon?.loading}…`:s,description:r?"…":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){return this.displayShowAllButton?g("calcite-list-item",{key:"show-all-item",label:this.messages?.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){return g("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},g("div",{slot:"message"},this.messages?.noRelatedFeatures))}renderFeatureObserver(){return g("div",{key:"feature-observer",class:"esri-feature__feature-observer",bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return g("calcite-list",null,e.toArray().map((e=>this.renderRelatedFeature(e))),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return g("div",{key:"list-container",class:this.classes("esri-feature-relationship__list",{"esri-feature-relationship__list--querying":"querying"===t})},e?this.renderList():"ready"===t?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){return g("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},g("div",{slot:"message"},this.messages?.relationshipNotFound))}render(){const{state:e}=this.viewModel;return g("div",{class:this.classes("esri-feature-relationship","esri-widget")},this._featureElementInfo?.render(),"loading"===e?this.renderLoading():"disabled"===e?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e?.forEach((e=>{this.addHandles(s((()=>[e.title,e.state]),(()=>this.scheduleRender()),r),t)})),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,s=t.description&&this.description,r=t.title&&this.title;this._featureElementInfo.set({description:s,title:r,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await C(0),this._relatedFeatureIntersectionObserverNode&&"ready"===e&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};e([o()],q.prototype,"_relatedFeatureIntersectionObserverNode",void 0),e([o({readOnly:!0})],q.prototype,"displayShowAllButton",null),e([o({readOnly:!0})],q.prototype,"displayListItems",null),e([o()],q.prototype,"description",null),e([o({readOnly:!0})],q.prototype,"featureCountDescription",null),e([o()],q.prototype,"headingLevel",void 0),e([o()],q.prototype,"title",null),e([o({type:f})],q.prototype,"viewModel",void 0),e([o(),k("esri/widgets/Feature/t9n/Feature")],q.prototype,"messages",void 0),e([o(),k("esri/t9n/common")],q.prototype,"messagesCommon",void 0),e([o()],q.prototype,"visibleElements",void 0),e([n("visibleElements")],q.prototype,"castVisibleElements",null),q=e([l("esri.widgets.Feature.FeatureRelationship")],q);const K=q,X={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},Y=t=>{let s=class extends t{constructor(){super(...arguments),this.renderNodeContent=e=>w(e)&&!e.destroyed?g("div",{class:X.contentNode,key:e},e.render()):e instanceof HTMLElement?g("div",{class:X.contentNode,key:e,bind:e,afterCreate:this._attachToNode}):M(e)?g("div",{class:X.contentNode,key:e,bind:e.domNode,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};return s=e([l("esri.widgets.Feature.ContentMixin")],s),s};var Q;const G={title:!0,content:!0,lastEditedInfo:!0};let J=Q=class extends(Y(a)){constructor(e,t){super(e,t),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...G},this.viewModel=new d}initialize(){this.addHandles(s((()=>this.viewModel?.contentViewModels),(()=>this._setupContentWidgets()),r))}loadDependencies(){return import("../chunks/calcite-notice.js")}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get title(){return this.viewModel.title}castVisibleElements(e){return{...G,...e}}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{state:e}=this.viewModel,t=g("div",{class:X.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return g("div",{class:this.classes(X.base,X.esriWidget)},t)}setActiveMedia(e,t){return this.viewModel.setActiveMedia(e,t)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}renderError(){const{messagesCommon:e,messages:t,visibleElements:s}=this;return g("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},s.title?g("div",{key:"error-title",slot:"title"},e.errorMessage):null,g("div",{key:"error-message",slot:"message"},t.loadingError))}renderLoading(){return g("div",{key:"loading-container",class:X.loadingSpinnerContainer},g("span",{class:this.classes(X.iconLoading,X.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?g("div",{class:X.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?g(v,{level:this.headingLevel,class:X.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content;if(!e)return null;if(Array.isArray(e))return e.length?g("div",{class:X.contentNode,key:"content-content-elements"},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:g("div",{class:X.contentNode,key:"content-content"},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:s}=this;if("boolean"!=typeof s.content&&!s.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);case"relationship":return this.renderRelationship(t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:s,attachmentInfos:r}=t.viewModel;return"loading"===s||r.length>0?g("div",{key:this._buildKey("attachments-element",e),class:this.classes(X.contentElement)},t.render()):null}renderRelationship(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?g("div",{key:this._buildKey("relationship-element",e),class:X.contentElement},t.render()):null}renderExpression(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:g("div",{key:this._buildKey("expression-element",e),class:X.contentElement},t.render())}renderCustom(e,t){const{creator:s}=e,r=this._contentWidgets[t];return!r||r.destroyed?null:s?g("div",{key:this._buildKey("custom-element",t),class:X.contentElement},r.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:g("div",{key:this._buildKey("fields-element",e),class:X.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:g("div",{key:this._buildKey("media-element",e),class:X.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:s}=this,{lastEditInfo:r}=this.viewModel;if(!r||!e.lastEditedInfo)return null;const{date:i,user:o}=r,n="edit"===r.type?o?s.lastEditedByUser:s.lastEdited:o?s.lastCreatedByUser:s.lastCreated,l=t(n,{date:i,user:o});return g("div",{key:"edit-info-element",class:this.classes(X.lastEditedInfo,X.contentElement)},l)}renderText(e,t){const s=e.text,r=this._contentWidgets[t];return!r||r.destroyed?null:s?g("div",{key:this._buildKey("text-element",t),class:this.classes(X.contentElement,X.text)},r.render()):null}_buildKey(e,...t){return`${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles"),this._contentWidgets.forEach((e=>this._destroyContentWidget(e))),this._contentWidgets=[]}_addFeatureRelationshipHandles(e){const{flowItems:t,visibleElements:s}=this;this.addHandles([i((()=>e),"select-record",(({featureViewModel:e})=>{t&&(e.abilities={relationshipContent:!0},t.push(new Q({flowItems:t,viewModel:e,visibleElements:s})))})),i((()=>e),"show-all-records",(()=>{if(!t)return;const{viewModel:s}=e;s.showAllEnabled=!0;const r=new K({visibleElements:{title:!1,description:!1},viewModel:s});this._addFeatureRelationshipHandles(r),t.push(r)}))],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,s=this.get("viewModel.content"),{contentViewModels:r}=this.viewModel;if(Array.isArray(s))s.forEach(((s,i)=>{if("attachments"===s.type&&(this._contentWidgets[i]=new A({displayType:s.displayType,headingLevel:t.title?e+1:e,viewModel:r[i]})),"fields"===s.type&&(this._contentWidgets[i]=new W({viewModel:r[i]})),"media"===s.type&&(this._contentWidgets[i]=new H({viewModel:r[i]})),"text"===s.type&&(this._contentWidgets[i]=new D({viewModel:r[i]})),"custom"===s.type&&(this._contentWidgets[i]=new D({viewModel:r[i]})),"expression"===s.type&&(this._contentWidgets[i]=new z({viewModel:r[i]})),"relationship"===s.type){const e=new K({viewModel:r[i]});this._addFeatureRelationshipHandles(e),this._contentWidgets[i]=e}}),this);else{const e=r[0];e&&!e.destroyed&&(this._contentWidgets[0]=new D({viewModel:e}))}this.scheduleRender()}};e([o()],J.prototype,"graphic",null),e([o()],J.prototype,"defaultPopupTemplateEnabled",null),e([o()],J.prototype,"flowItems",void 0),e([o()],J.prototype,"headingLevel",void 0),e([o()],J.prototype,"label",null),e([o(),k("esri/widgets/Feature/t9n/Feature")],J.prototype,"messages",void 0),e([o(),k("esri/t9n/common")],J.prototype,"messagesCommon",void 0),e([o(),k("esri/widgets/support/t9n/uriUtils")],J.prototype,"messagesURIUtils",void 0),e([o()],J.prototype,"spatialReference",null),e([o({readOnly:!0})],J.prototype,"title",null),e([o()],J.prototype,"visibleElements",void 0),e([n("visibleElements")],J.prototype,"castVisibleElements",null),e([o()],J.prototype,"map",null),e([o()],J.prototype,"view",null),e([o({type:d})],J.prototype,"viewModel",void 0),J=Q=e([l("esri.widgets.Feature")],J);const Z=J;export{X as C,Y as F,Z as default};
