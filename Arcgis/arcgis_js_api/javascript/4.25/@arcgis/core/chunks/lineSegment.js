/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{O as r,s as n}from"./ray.js";import{k as i,d as o,c as e,b as s,m as c,g as a,a as g,G as u,H as f}from"./vec3.js";function v(t){return t?{origin:i(t.origin),vector:i(t.vector)}:{origin:o(),vector:o()}}function p(t,r=v()){return b(t.origin,t.vector,r)}function b(t,r,n=v()){return e(n.origin,t),e(n.vector,r),n}function h(t,r,n=v()){return e(n.origin,t),s(n.vector,r,t),n}function m(r,i){const o=s(n.get(),i,r.origin),e=c(r.vector,o),g=c(r.vector,r.vector),u=t(e/g,0,1),f=s(n.get(),a(n.get(),r.vector,u),o);return c(f,f)}function M(t,r,n){return A(t,r,0,1,n)}function d(t,r,n){return g(n,t.origin,a(n,t.vector,r))}function A(r,i,o,e,u){const{vector:v,origin:p}=r,b=s(n.get(),i,p),h=c(v,b)/f(v);return a(u,v,t(h,o,e)),g(u,u,r.origin)}function B(t,r){if(j(t,function(t,r){const n=w.get();return n.origin=t,n.vector=r,n}(r.origin,r.direction),!1,k)){const{tA:r,pB:i,distance2:o}=k;if(r>=0&&r<=1)return o;if(r<0)return u(t.origin,i);if(r>1)return u(g(n.get(),t.origin,t.vector),i)}return null}function l(t,r,n){return!!j(t,r,!0,k)&&(e(n,k.pA),!0)}function j(r,i,o,e){const s=1e-6,c=r.origin,a=g(n.get(),c,r.vector),f=i.origin,v=g(n.get(),f,i.vector),p=n.get(),b=n.get();if(p[0]=c[0]-f[0],p[1]=c[1]-f[1],p[2]=c[2]-f[2],b[0]=v[0]-f[0],b[1]=v[1]-f[1],b[2]=v[2]-f[2],Math.abs(b[0])<s&&Math.abs(b[1])<s&&Math.abs(b[2])<s)return!1;const h=n.get();if(h[0]=a[0]-c[0],h[1]=a[1]-c[1],h[2]=a[2]-c[2],Math.abs(h[0])<s&&Math.abs(h[1])<s&&Math.abs(h[2])<s)return!1;const m=p[0]*b[0]+p[1]*b[1]+p[2]*b[2],M=b[0]*h[0]+b[1]*h[1]+b[2]*h[2],d=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],A=b[0]*b[0]+b[1]*b[1]+b[2]*b[2],B=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*A-M*M;if(Math.abs(B)<s)return!1;let l=(m*M-d*A)/B,j=(m+M*l)/A;o&&(l=t(l,0,1),j=t(j,0,1));const k=n.get(),w=n.get();return k[0]=c[0]+l*h[0],k[1]=c[1]+l*h[1],k[2]=c[2]+l*h[2],w[0]=f[0]+j*b[0],w[1]=f[1]+j*b[1],w[2]=f[2]+j*b[2],e.tA=l,e.tB=j,e.pA=k,e.pB=w,e.distance2=u(k,w),!0}const k={tA:0,tB:0,pA:o(),pB:o(),distance2:0},w=new r((()=>v()));export{l as a,p as b,v as c,m as d,b as e,h as f,B as g,A as h,M as i,d as p};
