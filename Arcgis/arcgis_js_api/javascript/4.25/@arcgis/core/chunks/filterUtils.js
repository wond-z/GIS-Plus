/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{i as t,a as n}from"./maybe.js";import{g as e}from"./uuid.js";import{B as o,a as i,b as r}from"./BuildingFilterBlock.js";const s=t=>n=>{const e=t.toLowerCase();return n.sublayers.find((t=>t.modelName?.toLowerCase()===e))??null},l=s("fullmodel"),f=s("overview");function u(n){const e=l(n);t(e)&&(e.visible=!0);const o=f(n);t(o)&&(o.visible=!1)}function c(e,o){const i=function(t,n){const e=t.summaryStatistics?.fields??[],o=n.toLowerCase();return e.find((t=>t.modelName?.toLowerCase()===o))??null}(e,o);if(n(i))return null;const r=i.fieldName;if(n(r)||!r)return null;const s=function(t,n){for(const e of t.allSublayers.items){const t="building-component"===e.type?e.getFieldDomain(n):null;if(t&&"coded-value"===t.type)return t}return null}(e,r),l=new Map;for(const n of i.mostFrequentValues??[])"number"==typeof n&&l.set(n,t(s)?s.getName(n):String(n));return{fieldName:r,fieldValueMap:l}}function a(){return`${e()}__BUILDING_EXPLORER_FILTER__`}function m(t){const n="string"==typeof t?t:t.id;return!!n&&n.includes("__BUILDING_EXPLORER_FILTER__")}function d(n,e){for(const o of n.items)for(const n of o.filters.items){if(!m(n))continue;const o=e(n);if(t(o))return o}return null}function p(e,o){e.forEach((e=>{const i=e.filters.filter((t=>!m(t)));t(o)&&i.push(o),function(t,e){const o=e.length;if(n(t)||t.length!==o)return!1;for(let n=0;n<o;++n){const o=e.getItemAt(n).toJSON(),i=t.getItemAt(n).toJSON();if(o.id="",i.id="",JSON.stringify(o)!==JSON.stringify(i))return!1}return!0}(e.filters,i)||(e.filters=i);const r=e.filters.find((t=>m(t)));e.activeFilterId=t(r)?r.id:null}))}function g(t){const n=_(t);return n?new o({filterExpression:n,filterMode:new i}):null}function N(t){const n=_(t);return n?new o({filterExpression:n,filterMode:new r}):null}function _(t){return t.filter((t=>!!t)).map((t=>`(${t})`)).join(" AND ")}export{g as a,a as b,u as c,c as d,d as e,l as f,N as g,p as s};
