/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{n as e}from"./key.js";import{c as t}from"./observers.js";import{m as n,j as i}from"../widgets/Widget.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.97
 */
class r{constructor(e){if(e instanceof r)return e;const[t,n]=String(e).split(".").concat("");this.value=BigInt(t+n.padEnd(r.DECIMALS,"0").slice(0,r.DECIMALS))+BigInt(r.ROUNDED&&n[r.DECIMALS]>="5"),this.isNegative="-"===e.charAt(0)}static _divRound(e,t){return r.fromBigInt(e/t+(r.ROUNDED?e*BigInt(2)/t%BigInt(2):BigInt(0)))}static fromBigInt(e){return Object.assign(Object.create(r.prototype),{value:e})}toString(){const e=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),t=e.slice(0,-r.DECIMALS),n=e.slice(-r.DECIMALS).replace(/\.?0+$/,""),i=t.concat(n.length?"."+n:"");return`${this.isNegative?"-":""}${i}`}formatToParts(e){const t=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),n=t.slice(0,-r.DECIMALS),i=t.slice(-r.DECIMALS).replace(/\.?0+$/,""),a=e.formatToParts(BigInt(n));return this.isNegative&&a.unshift({type:"minusSign",value:w.minusSign}),i.length&&(a.push({type:"decimal",value:w.decimal}),i.split("").forEach((e=>a.push({type:"fraction",value:e})))),a}format(e){const t=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),n=t.slice(0,-r.DECIMALS),i=t.slice(-r.DECIMALS).replace(/\.?0+$/,"");return`${this.isNegative?w.minusSign:""}${e.format(BigInt(n))}${i.length?`${w.decimal}${e.format(BigInt(i))}`:""}`}add(e){return r.fromBigInt(this.value+new r(e).value)}subtract(e){return r.fromBigInt(this.value-new r(e).value)}multiply(e){return r._divRound(this.value*new r(e).value,r.SHIFT)}divide(e){return r._divRound(this.value*r.SHIFT,new r(e).value)}}function a(e){return!(!e||isNaN(Number(e)))}function s(t){return t&&(n=t,e.some((e=>n.includes(e))))?g(t,(t=>{let n=!1;const i=t.split("").filter(((t,i)=>t.match(/\./g)&&!n?(n=!0,!0):!(!t.match(/\-/g)||0!==i)||e.includes(t))).reduce(((e,t)=>e+t));return a(i)?new r(i).toString():""})):"";var n}r.DECIMALS=100,r.ROUNDED=!0,r.SHIFT=BigInt("1"+"0".repeat(r.DECIMALS));const o=/^([-0])0+(?=\d)/,l=/(?!^\.)\.$/,u=/(?!^-)-/g,c=/^-\b0\b\.?0*$/,m=e=>g(e,(e=>{const t=e.replace(u,"").replace(l,"").replace(o,"$1");return a(t)?c.test(t)?t:new r(t).toString():e}));function g(e,t){if(!e)return e;const n=e.toLowerCase().indexOf("e")+1;return n?e.replace(/[eE]*$/g,"").substring(0,n).concat(e.slice(n).replace(/[eE]/g,"")).split(/[eE]/).map(((e,n)=>t(1===n?e.replace(/\./g,""):e))).join("e").replace(/^e/,"1e"):t(e)}const p=["ar","bg","bs","ca","cs","da","de","de-CH","el","en","en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","nb","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],h=["arab","arabext","bali","beng","deva","fullwide","gujr","guru","hanidec","khmr","knda","laoo","latn","limb","mlym","mong","mymr","orya","tamldec","telu","thai","tibt"],d=e=>h.includes(e),b=(new Intl.NumberFormat).resolvedOptions().numberingSystem,f="arab"!==b&&d(b)?b:"latn",v=new Set;function S(e){_(e),0===v.size&&E.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"],subtree:!0}),v.add(e)}function _(e){e.effectiveLocale=function(e){var t;return e.el.lang||e.locale||(null===(t=i(e.el,"[lang]"))||void 0===t?void 0:t.lang)||document.documentElement.lang||"en"}(e)}function I(e){v.delete(e),0===v.size&&E.disconnect()}const E=t("mutation",(e=>{e.forEach((e=>{const t=e.target;v.forEach((e=>{const r=!(!e.locale||e.el.lang),a=!n(t,e.el);if(r||a)return;const s=i(e.el,"[lang]");if(!s)return void(e.effectiveLocale="en");const o=s.lang;e.effectiveLocale=s.hasAttribute("lang")&&""===o?"en":o}))}))})),w=new class{constructor(){this.delocalize=e=>this._numberFormatOptions?g(e,(e=>e.trim().replace(new RegExp(`[${this._minusSign}]`,"g"),"-").replace(new RegExp(`[${this._group}]`,"g"),"").replace(new RegExp(`[${this._decimal}]`,"g"),".").replace(new RegExp(`[${this._digits.join("")}]`,"g"),this._getDigitIndex))):e,this.localize=e=>this._numberFormatOptions?g(e,(e=>a(e.trim())?new r(e.trim()).format(this._numberFormatter).replace(new RegExp(`[${this._actualGroup}]`,"g"),this._group):e)):e}get group(){return this._group}get decimal(){return this._decimal}get minusSign(){return this._minusSign}get digits(){return this._digits}get numberFormatter(){return this._numberFormatter}get numberFormatOptions(){return this._numberFormatOptions}set numberFormatOptions(e){var t,n;if(e.locale=(t=null==e?void 0:e.locale,p.indexOf(t)>-1?t:t?"nb"===(t=t.toLowerCase())?"no":(t.includes("-")&&(t=t.replace(/(\w+)-(\w+)/,((e,t,n)=>`${t}-${n.toUpperCase()}`)),p.includes(t)||(t=t.split("-")[0])),p.includes(t)?t:"en"):"en"),e.numberingSystem=(n=null==e?void 0:e.numberingSystem,d(n)?n:f),!this._numberFormatOptions&&"en"===e.locale&&e.numberingSystem===f&&2===Object.keys(e).length||JSON.stringify(this._numberFormatOptions)===JSON.stringify(e))return;this._numberFormatOptions=e,this._numberFormatter=new Intl.NumberFormat(this._numberFormatOptions.locale,this._numberFormatOptions),this._digits=[...new Intl.NumberFormat(this._numberFormatOptions.locale,{useGrouping:!1,numberingSystem:this._numberFormatOptions.numberingSystem}).format(9876543210)].reverse();const i=new Map(this._digits.map(((e,t)=>[e,t]))),r=new Intl.NumberFormat(this._numberFormatOptions.locale).formatToParts(-12345678.9);this._actualGroup=r.find((e=>"group"===e.type)).value,this._group=0===this._actualGroup.trim().length?" ":this._actualGroup,this._decimal=r.find((e=>"decimal"===e.type)).value,this._minusSign=r.find((e=>"minusSign"===e.type)).value,this._getDigitIndex=e=>i.get(e)}},F=(e,t,n)=>Math.max(t,Math.min(e,n)),O=e=>{const t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0};export{I as a,O as b,S as c,f as d,F as e,a as i,w as n,s as p,m as s,_ as u};
