/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import o from"../core/Collection.js";import{i as e,a as r}from"./maybe.js";import"./object.js";import"../core/Error.js";import"./Logger.js";import{a as s}from"./watch.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"./ensureType.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";let c=class extends o{constructor(t){super(t),this.getCollections=null}initialize(){this.own(s((()=>this._refresh())))}destroy(){this.getCollections=null}_refresh(){const t=e(this.getCollections)?this.getCollections():null;if(r(t))return void this.removeAll();let o=0;for(const r of t)e(r)&&(o=this._processCollection(o,r));this.splice(o,this.length)}_createNewInstance(t){return new o(t)}_processCollection(t,o){if(!o)return t;const e=this.itemFilterFunction?this.itemFilterFunction:t=>!!t;for(const r of o)if(r){if(e(r)){const o=this.indexOf(r,t);o>=0?o!==t&&this.reorder(r,t):this.add(r,t),++t}if(this.getChildrenFunction){const o=this.getChildrenFunction(r);if(Array.isArray(o))for(const e of o)t=this._processCollection(t,e);else t=this._processCollection(t,o)}}return t}};t([i()],c.prototype,"getCollections",void 0),t([i()],c.prototype,"getChildrenFunction",void 0),t([i()],c.prototype,"itemFilterFunction",void 0),c=t([n("esri.core.CollectionFlattener")],c);const l=c;export{l as C};
