/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as s}from"../chunks/tslib.es6.js";import o from"./Error.js";import{EsriPromise as t}from"./Promise.js";import{onAbortOrThrow as r,onAbort as e}from"./promiseUtils.js";import{W as l,subclass as a}from"./accessorSupport/decorators/subclass.js";import{property as i}from"./accessorSupport/decorators/property.js";import"./lang.js";import"../chunks/maybe.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"./Accessor.js";import"./Handles.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../chunks/ArrayPool.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"./scheduling.js";import"../chunks/nextTick.js";import"../chunks/ensureType.js";const n=t=>{let n=class extends t{constructor(...s){super(...s),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((s=>{const t=this.load.bind(this);this.load=l=>{const a=new Promise(((s,t)=>{const e=r(l,t);this.destroyed&&t(new o("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(s,t).finally((()=>{e&&e.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const s=this._loadController=new AbortController;t({signal:s.signal}),e(s.signal,(()=>{this._promiseProps.abort()}))}return s(),a}}))),this.when((()=>{this._set("loadStatus","loaded"),this._loadController=null}),(s=>{this._set("loadStatus","failed"),this._set("loadError",s),this._loadController=null}))}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new o("load:cancelled","Cancelled")),this._loadController?.abort()),this}};return s([i({readOnly:!0})],n.prototype,"loaded",null),s([i({readOnly:!0})],n.prototype,"loadError",void 0),s([i({clonable:!1})],n.prototype,"loadStatus",void 0),s([i({type:[l],readOnly:!0})],n.prototype,"loadWarnings",null),n=s([a("esri.core.Loadable")],n),n};let d=class extends(n(t)){};d=s([a("esri.core.Loadable")],d),function(s){s.LoadableMixin=n,s.isLoadable=function(s){return!(!s||!s.load)}}(d||(d={}));const c=d;export{c as default};
