/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import{b as o,e,i}from"../../chunks/domUtils.js";import n from"../../core/Evented.js";import s from"../../core/Handles.js";import{watch as r,initial as d}from"../../core/reactiveUtils.js";import{property as a}from"../../core/accessorSupport/decorators/property.js";import"../../core/lang.js";import{cast as p}from"../../core/accessorSupport/decorators/cast.js";import{subclass as c}from"../../core/accessorSupport/decorators/subclass.js";import{s as l}from"../../chunks/themeUtils.js";import h from"../../core/Accessor.js";import{i as m}from"../../chunks/widgetUtils.js";import"../../chunks/handleUtils.js";import"../../chunks/maybe.js";import"../../chunks/get.js";import"../../chunks/utils.js";import"../../chunks/metadata.js";import"../../chunks/object.js";import"../../chunks/Logger.js";import"../../config.js";import"../../chunks/string.js";import"../../chunks/ArrayPool.js";import"../../chunks/tracking.js";import"../../chunks/ensureType.js";import"../../core/Error.js";import"../../chunks/watch.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../core/promiseUtils.js";let u=class extends h{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const o=this._get("node");t!==o&&(t&&t.classList.add("esri-component"),o&&o.classList.remove("esri-component"),this._set("node",t))}castNode(t){return t?"string"==typeof t||function(t){return t&&"nodeType"in t}(t)?(this._set("widget",null),o(t)):(function(t){return t&&"function"==typeof t.render}(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};t([a({dependsOn:[]})],u.prototype,"id",null),t([a()],u.prototype,"node",null),t([p("node")],u.prototype,"castNode",null),t([a({readOnly:!0})],u.prototype,"widget",void 0),u=t([c("esri.views.ui.Component")],u);const g=u,_={left:0,top:0,bottom:0,right:0},f={bottom:30,top:15,right:15,left:15},y="esri-ui-corner";function C(t){const o=t,e="object"==typeof o&&null!==o&&Object.getPrototypeOf(o);return null!==e&&e!==Object.prototype||!("component"in o||"index"in o||"position"in o)?null:t}function v(t,{top:o,bottom:e,left:i,right:n}){t.style.top=o,t.style.bottom=e,t.style.left=i,t.style.right=n}let j=class extends n.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new s,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&v(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&v(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([r((()=>[this.view?.padding,this.container]),this._applyViewPadding,d),r((()=>this.padding),this._applyUIPadding,d)])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const o=this._get("container");t!==o&&(t&&(t.classList.add("esri-ui"),l(t),this._attachContainers(t)),o&&(o.classList.remove("esri-ui"),v(o,{top:"",bottom:"",left:"",right:""}),e(o)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const o=this._getViewPadding(),e=o.top+o.bottom;return Math.max(t-e,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...f,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const o=this._getViewPadding(),e=o.left+o.right;return Math.max(t-e,0)}add(t,o){let e,i;if(Array.isArray(t))return void t.forEach((t=>this.add(t,o)));const n=C(t);n&&({index:e,position:o,component:t,key:i}=n),o&&"object"==typeof o&&({index:e,key:i,position:o}=o),!t||o&&!this._isValidPosition(o)||this._add(t,o,e,i)}remove(t,o){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,o)));const e=this._find(t);if(e){const i=this._componentToKey;if(i.has(t)&&i.get(t)!==o)return;const n=this._components.indexOf(e);return e.node.parentNode&&e.node.parentNode.removeChild(e.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){return Array.isArray(t)?t.map((t=>this.empty(t))).reduce(((t,o)=>t.concat(o))):"manual"===(t=t||"manual")?Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(y))).map((t=>this.remove(t))):this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,o){if(Array.isArray(t)&&t.forEach((t=>this.move(t,o))),!t)return;let e;const i=C(t)||C(o);if(i&&(e=i.index,o=i.position,t=i.component||t),o&&!this._isValidPosition(o))return;const n=this.remove(t);n&&this.add(n,{position:o,index:e})}find(t){if(!t)return null;const o=this._findById(t);return o&&(o.widget||o.node)}getPosition(t){for(const o in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[o].contains(t))return o;return null}_add(t,o,e,i){t instanceof g||(t=new g({node:t})),this._place({component:t,position:o,index:e}),this._components.push(t),i&&this._componentToKey.set(t,i)}_find(t){return t?t instanceof g?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||_}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add("esri-ui-inner-container"),t.classList.add("esri-ui-corner-container");const o=document.createElement("div");o.classList.add("esri-ui-inner-container"),o.classList.add("esri-ui-manual-container");const e=document.createElement("div");e.classList.add("esri-ui-top-left"),e.classList.add(y),t.appendChild(e);const i=document.createElement("div");i.classList.add("esri-ui-top-right"),i.classList.add(y),t.appendChild(i);const n=document.createElement("div");n.classList.add("esri-ui-bottom-left"),n.classList.add(y),t.appendChild(n);const s=document.createElement("div");s.classList.add("esri-ui-bottom-right"),s.classList.add(y),t.appendChild(s),this._innerContainer=t,this._manualContainer=o;const r=m();this._cornerNameToContainerLookup={"top-left":e,"top-right":i,"bottom-left":n,"bottom-right":s,"top-leading":r?i:e,"top-trailing":r?e:i,"bottom-leading":r?s:n,"bottom-trailing":r?n:s},this._positionNameToContainerLookup={manual:o,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const o=t.component,e=t.position||"manual",n=t.index,s=this._positionNameToContainerLookup[e],r=n>-1;var d;if((d=o.widget)&&!d._started&&"function"==typeof d.postMixInProperties&&"function"==typeof d.buildRendering&&"function"==typeof d.postCreate&&"function"==typeof d.startup&&o.widget.startup(),!r)return void s.appendChild(o.node);const a=Array.prototype.slice.call(s.children);0!==n?n>=a.length?s.appendChild(o.node):i(o.node,a[n]):s.firstChild?i(o.node,s.firstChild):s.appendChild(o.node)}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let o,e=null;return this._components.some((i=>(o=i===t,o&&(e=i),o))),e}_findById(t){let o,e=null;return this._components.some((i=>(o=i.id===t,o&&(e=i),o))),e}_findByNode(t){let o,e=null;return this._components.some((i=>(o=i.node===t,o&&(e=i),o))),e}};t([a()],j.prototype,"container",null),t([a()],j.prototype,"height",null),t([a({value:f})],j.prototype,"padding",null),t([p("padding")],j.prototype,"castPadding",null),t([a()],j.prototype,"view",void 0),t([a()],j.prototype,"width",null),j=t([c("esri.views.ui.UI")],j);const w=j;export{g as C,w as default};
