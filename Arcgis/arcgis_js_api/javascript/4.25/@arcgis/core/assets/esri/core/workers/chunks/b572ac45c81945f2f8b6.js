"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[5181],{65181:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(82058),i=n(41864),r=n(60991),o=n(92143),a=n(71252),l=n(50406),u=n(32422),c=n(60947),p=n(40267),d=n(56761),f=n(24251),h=n(50815),y=n(90995),g=n(4571),m=n(77358),_=n(1709),b=n(54732),F=n(14249);n(31450),n(71552),n(76506),n(88762),n(32101),n(40642),n(21972),n(60474),n(66396),n(86656),n(91055),n(17533),n(6540),n(91306),n(34250),n(19657),n(6906),n(21801),n(73796),n(12047),n(97714),n(2906),n(91597),n(86787),n(35132),n(89623),n(84069),n(44567),n(98380),n(92896),n(75067),n(53326),n(92482),n(82426),n(72836),n(29794),n(74395),n(88994),n(98576),n(44722),n(1623),n(53785),n(57251),n(95587),n(89914),n(65775),n(12381),n(73173),n(92624),n(92847),n(77314),n(91700),n(95533),n(94751),n(95307),n(74569),n(22781),n(94216),n(81731),n(77849),n(71435),n(30831),n(72274),n(5777),n(59565),n(66774),n(63683),n(94479),n(48027),n(54174),n(59465),n(45702),n(51127),n(30776),n(3039),n(60217),n(89219),n(92653),n(85056),n(58085),n(76360),n(8288),n(6941);const S={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class w{constructor(){this._queryEngine=null,this._snapshotFeatures=async e=>{const t=await this._fetch(e);return this._createFeatures(t)}}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._fieldsIndex=this._createDefaultAttributes=null}async load(e,t={}){this._loadOptions={url:e.url,customParameters:e.customParameters};const n=[];await this._checkProjection(e.spatialReference);let s=null;e.url&&(s=await this._fetch(t?.signal));const i=(0,y.i)(s,{geometryType:e.geometryType}),o=e.fields||i.fields||[],a=null!=e.hasZ?e.hasZ:i.hasZ,l=i.geometryType;let u=e.objectIdField||i.objectIdFieldName||"__OBJECTID";const p=e.spatialReference||c.W;let f=e.timeInfo;o===i.fields&&i.unknownFields.length>0&&n.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:i.unknownFields}});let m=new _.Z(o).get(u);m?("esriFieldTypeString"!==m.type&&(m.type="esriFieldTypeOID"),m.editable=!1,m.nullable=!1,u=m.name):(m={alias:u,name:u,type:"string"===i.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},o.unshift(m));const w={};for(const e of o){if(null==e.name&&(e.name=e.alias),null==e.alias&&(e.alias=e.name),!e.name)throw new r.Z("geojson-layer:invalid-field-name","field name is missing",{field:e});if(!b.k.jsonValues.includes(e.type))throw new r.Z("geojson-layer:invalid-field-type",`invalid type for field "${e.name}"`,{field:e});if(e.name!==m.name){const t=(0,F.os)(e);void 0!==t&&(w[e.name]=t)}}this._fieldsIndex=new _.Z(o);const I=this._fieldsIndex.requiredFields.indexOf(m);if(I>-1&&this._fieldsIndex.requiredFields.splice(I,1),f){if(f.startTimeField){const e=this._fieldsIndex.get(f.startTimeField);e?(f.startTimeField=e.name,e.type="esriFieldTypeDate"):f.startTimeField=null}if(f.endTimeField){const e=this._fieldsIndex.get(f.endTimeField);e?(f.endTimeField=e.name,e.type="esriFieldTypeDate"):f.endTimeField=null}if(f.trackIdField){const e=this._fieldsIndex.get(f.trackIdField);e?f.trackIdField=e.name:(f.trackIdField=null,n.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:f}}))}f.startTimeField||f.endTimeField||(n.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:f}}),f=null)}const T=l?(0,g.a)(l):null,q={warnings:n,featureErrors:[],layerDefinition:{...S,drawingInfo:T,templates:(0,g.d)(w),extent:null,geometryType:l,objectIdField:u,fields:o,hasZ:!!a,timeInfo:f}};this._queryEngine=new h.Q({fields:o,geometryType:l,hasM:!1,hasZ:a,objectIdField:u,spatialReference:p,timeInfo:f,featureStore:new d.F({geometryType:l,hasM:!1,hasZ:a}),cacheSpatialQueries:!0}),this._createDefaultAttributes=(0,g.b)(w,u);const x=await this._createFeatures(s);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,x);const E=this._normalizeFeatures(x,q.warnings,q.featureErrors);if(this._queryEngine.featureStore.addMany(E),q.layerDefinition.extent=this._queryEngine.fullExtent,q.layerDefinition.timeInfo){const{start:e,end:t}=this._queryEngine.timeExtent;q.layerDefinition.timeInfo.timeExtent=[e,t]}return q}async applyEdits(e){const{spatialReference:t,geometryType:n}=this._queryEngine;return await Promise.all([(0,m.l)(t,n),(0,f.c)(e.adds,t),(0,f.c)(e.updates,t)]),await this._waitSnapshotComplete(),this._applyEdits(e)}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(e){return this._loadOptions.customParameters=e,this._snapshotTask?.abort(),this._snapshotTask=(0,i.c)(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,e);const t=this._normalizeFeatures(e);t&&this._queryEngine.featureStore.addMany(t)}),(e=>{this._queryEngine.featureStore.clear(),(0,l.D_)(e)||o.L.getLogger("esri.layers.GeoJSONLayer").error(new r.Z("geojson-layer:refresh","An error occurred during refresh",{error:e}))})),await this._waitSnapshotComplete(),{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent}}async _createFeatures(e){const{geometryType:t,hasZ:n,objectIdField:s}=this._queryEngine,i=(0,y.c)(e,{geometryType:t,hasZ:n,objectIdField:s});if(!(0,c.e)(this._queryEngine.spatialReference,c.W))for(const e of i)(0,a.i)(e.geometry)&&(e.geometry=(0,p.b)((0,f.p)((0,p.a)(e.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),c.W,this._queryEngine.spatialReference)));return i}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(e){const{url:t,customParameters:n}=this._loadOptions,i=(await(0,s.default)(t,{responseType:"json",query:{...n},signal:e})).data;return await(0,y.v)(i),i}_normalizeFeatures(e,t,n){const{objectIdField:s}=this._queryEngine,i=[];for(const r of e){const e=this._createDefaultAttributes(),o=(0,m.m)(this._fieldsIndex,e,r.attributes,!0,t);o?n?.push(o):(this._assignObjectId(e,r.attributes,!0),r.attributes=e,r.objectId=e[s],i.push(r))}return i}_applyEdits(e){const{adds:t,updates:n,deletes:s}=e,i={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(i,t),n&&n.length&&this._applyUpdateEdits(i,n),s&&s.length){for(const e of s)i.deleteResults.push((0,m.c)(e));this._queryEngine.featureStore.removeManyById(s)}return{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:i}}_applyAddEdits(e,t){const{addResults:n}=e,{geometryType:s,hasM:i,hasZ:r,objectIdField:o,spatialReference:l,featureStore:c}=this._queryEngine,d=[];for(const i of t){if(i.geometry&&s!==(0,u.Ji)(i.geometry)){n.push((0,m.a)("Incorrect geometry type."));continue}const t=this._createDefaultAttributes(),r=(0,m.m)(this._fieldsIndex,t,i.attributes);if(r)n.push(r);else{if(this._assignObjectId(t,i.attributes),i.attributes=t,null!=i.uid){const t=i.attributes[o];e.uidToObjectId[i.uid]=t}if((0,a.i)(i.geometry)){const e=i.geometry.spatialReference??l;i.geometry=(0,f.p)((0,m.s)(i.geometry,e),e,l)}d.push(i),n.push((0,m.c)(i.attributes[o]))}}c.addMany((0,p.n)([],d,s,r,i,o))}_applyUpdateEdits({updateResults:e},t){const{geometryType:n,hasM:s,hasZ:i,objectIdField:r,spatialReference:o,featureStore:l}=this._queryEngine;for(const c of t){const{attributes:t,geometry:d}=c,h=t&&t[r];if(null==h){e.push((0,m.a)(`Identifier field ${r} missing`));continue}if(!l.has(h)){e.push((0,m.a)(`Feature with object id ${h} missing`));continue}const y=(0,p.o)(l.getFeature(h),n,i,s);if((0,a.i)(d)){if(n!==(0,u.Ji)(d)){e.push((0,m.a)("Incorrect geometry type."));continue}const t=d.spatialReference??o;y.geometry=(0,f.p)((0,m.s)(d,t),t,o)}if(t){const n=(0,m.m)(this._fieldsIndex,y.attributes,t);if(n){e.push(n);continue}}l.add((0,p.p)(y,n,i,s,r)),e.push((0,m.c)(h))}}_createObjectIdGenerator(e,t){const n=e.fieldsIndex.get(e.objectIdField);if("esriFieldTypeString"===n.type)return()=>n.name+"-"+Date.now().toString(16);let s=Number.NEGATIVE_INFINITY;for(const e of t)e.objectId&&(s=Math.max(s,e.objectId));return s=Math.max(0,s)+1,()=>s++}_assignObjectId(e,t,n=!1){const s=this._queryEngine.objectIdField;e[s]=n&&s in t?t[s]:this._objectIdGenerator()}async _checkProjection(e){try{await(0,f.c)(c.W,e)}catch{throw new r.Z("geojson-layer","Projection not supported")}}}},41864:(e,t,n)=>{n.d(t,{a:()=>h,c:()=>y,f:()=>u,m:()=>c,r:()=>f});var s=n(29768),i=n(21972),r=n(71252),o=n(50406),a=n(34250),l=(n(76506),n(91306),n(17533));function u(e,t,n){return(0,o.as)(e.map(((e,s)=>t.apply(n,[e,s]))))}async function c(e,t,n){return(await(0,o.as)(e.map(((e,s)=>t.apply(n,[e,s]))))).map((e=>e.value))}function p(e){return{ok:!0,value:e}}function d(e){return{ok:!1,error:e}}async function f(e){if((0,r.a)(e))return{ok:!1,error:new Error("no promise provided")};try{return p(await e)}catch(e){return d(e)}}async function h(e){try{return p(await e)}catch(e){return(0,o.r9)(e),d(e)}}function y(e,t){return new g(e,t)}let g=class extends i.Z{constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=(0,r.f)(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:n}=this._abortController;this.promise=e(n),this.promise.then((e=>{this._result=p(e),this._cleanup()}),(e=>{this._result=d(e),this._cleanup()})),this._abortHandle=(0,o.fu)(t,this.abort)}get value(){return e=this._result,(0,r.i)(e)&&!0===e.ok?e.value:null;var e}get error(){return e=this._result,(0,r.i)(e)&&!1===e.ok?e.error:null;var e}get finished(){return(0,r.i)(this._result)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=(0,r.r)(this._abortHandle),this._abortController=null}};(0,s._)([(0,a.Cb)()],g.prototype,"value",null),(0,s._)([(0,a.Cb)()],g.prototype,"error",null),(0,s._)([(0,a.Cb)()],g.prototype,"finished",null),(0,s._)([(0,a.Cb)()],g.prototype,"promise",void 0),(0,s._)([(0,a.Cb)()],g.prototype,"_result",void 0),g=(0,s._)([(0,l.j)("esri.core.asyncUtils.ReactiveTask")],g)},4571:(e,t,n)=>{n.d(t,{a:()=>a,b:()=>c,c:()=>d,d:()=>p});var s=n(71552),i=n(76506),r=n(89219),o=n(6941);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.d:"esriGeometryPolyline"===e?o.a:o.b}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function c(e,t){if((0,s.h)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this.${t} = null;`;for(const t in e)n+=`this${l.test(t)?`.${t}`:`["${t}"]`} = ${JSON.stringify(e[t])};`;const s=new Function(`\n      return class AttributesClass$${u++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new s}catch(n){return()=>({[t]:null,...e})}}function p(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.d9)(e)}}]}function d(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:r.q,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},6941:(e,t,n)=>{n.d(t,{a:()=>r,b:()=>o,c:()=>a,d:()=>i,e:()=>l,f:()=>u,g:()=>c});const s=[252,146,31,255],i={type:"esriSMS",style:"esriSMSCircle",size:6,color:s,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},r={type:"esriSLS",style:"esriSLSSolid",width:.75,color:s},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},54732:(e,t,n)=>{n.d(t,{k:()=>s});const s=new(n(57251).J)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},90995:(e,t,n)=>{n.d(t,{c:()=>w,g:()=>a,i:()=>S,v:()=>F});var s=n(60991),i=n(85674),r=n(14249);const o={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function a(e){return o[e]}function*l(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*u(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function c(e){for(const t of e)if(t.length>2)return!0;return!1}function p(e){let t=0;for(let n=0;n<e.length;n++){const s=e[n],i=e[(n+1)%e.length];t+=s[0]*i[1]-i[0]*s[1]}return t<=0}function d(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function f(e,t,n){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,n){return g(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function(e,t,n){for(const s of t.coordinates)g(e,s,n);return e}(e,t,n);case"MultiPolygon":return function(e,t,n){for(const s of t.coordinates){h(e,s[0],n);for(let t=1;t<s.length;t++)y(e,s[t],n)}return e}(e,t,n);case"Point":return function(e,t,n){return _(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function(e,t,n){const s=t.coordinates;h(e,s[0],n);for(let t=1;t<s.length;t++)y(e,s[t],n);return e}(e,t,n)}}function h(e,t,n){const s=d(t);p(s)?g(e,s,n):m(e,s,n)}function y(e,t,n){const s=d(t);p(s)?m(e,s,n):g(e,s,n)}function g(e,t,n){for(const s of t)_(e,s,n);e.lengths.push(t.length)}function m(e,t,n){for(let s=t.length-1;s>=0;s--)_(e,t[s],n);e.lengths.push(t.length)}function _(e,t,n){const[s,i,r]=t;e.coords.push(s,i),n.hasZ&&e.coords.push(r||0)}function b(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function F(e){if(!e)throw new s.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new s.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:t}=e;if(!t)return;const n="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,i=new RegExp(".*(CRS84H?|4326)$","i");if(!n||!i.test(n))throw new s.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}function S(e,t={}){const n=[],s=new Set,i=new Set;let o,p=!1,d=null,f=!1,{geometryType:h=null}=t,y=!1;for(const t of l(e)){const{geometry:e,properties:l,id:g}=t;if((!e||(h||(h=a(e.type)),a(e.type)===h))&&(p||(p=c(u(e))),f||(f=null!=g,f&&(o=typeof g,d=Object.keys(l).filter((e=>l[e]===g)))),f&&null!=g&&(d.length>1?d=d.filter((e=>l[e]===g)):1===d.length&&(d=l[d[0]]===g?d:[])),!y&&l)){let e=!0;for(const t in l){if(s.has(t))continue;const o=l[t];if(null==o){e=!1,i.add(t);continue}const a=b(o);"unknown"!==a?(i.delete(t),s.add(t),n.push({name:(0,r.q6)(t),alias:t,type:a})):i.add(t)}y=e}}const g=(0,r.q6)(1===d?.length&&d[0]||null);if(g)for(const e of n)if(e.name===g&&(0,r.H7)(e)){e.type="esriFieldTypeOID";break}return{fields:n,geometryType:h,hasZ:p,objectIdFieldName:g,objectIdFieldType:o,unknownFields:Array.from(i)}}function w(e,t){return Array.from(function*(e,t={}){const{geometryType:n,objectIdField:s}=t;for(const r of e){const{geometry:e,properties:o,id:l}=r;if(e&&a(e.type)!==n)continue;const u=o||{};let c=u[s]??null;s&&null!=l&&!u[s]&&(u[s]=c=l);const p=new i.O(e?f(new i.a,e,t):null,u,null,c);yield p}}(l(e),t))}},94751:(e,t,n)=>{n.d(t,{c:()=>o,g:()=>u,o:()=>a,u:()=>l});var s=n(92896),i=n(60947),r=n(32422);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator}),minus180Line:new s.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s.Z({paths:[[[180,-180],[180,180]]],spatialReference:i.Z.WGS84}),minus180Line:new s.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:i.Z.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const n=u(e);for(const e of n)for(const n of e)n[0]+=t;return e}function u(e){return(0,r.oU)(e)?e.rings:e.paths}},95307:(e,t,n)=>{n.d(t,{c:()=>l,s:()=>u}),n(74569);var s=n(82058),i=n(32422),r=n(94216),o=n(32101),a=n(81731);async function l(e,t,n,o){const a=(0,r.p)(e),l=t[0].spatialReference,u={...o,query:{...a.query,f:"json",sr:JSON.stringify(l),target:JSON.stringify({geometryType:(0,i.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},c=await(0,s.default)(a.path+"/cut",u),{cutIndexes:p,geometries:d=[]}=c.data;return{cutIndexes:p,geometries:d.map((e=>{const t=(0,i.im)(e);return t.spatialReference=l,t}))}}async function u(e,t,n){const r="string"==typeof e?(0,o.mN)(e):e,l=t[0].spatialReference,u=(0,i.Ji)(t[0]),c={...n,query:{...r.query,f:"json",sr:l.wkid?l.wkid:JSON.stringify(l),geometries:JSON.stringify((0,a.e)(t))}},{data:p}=await(0,s.default)(r.path+"/simplify",c);return(0,a.d)(p.geometries,u,l)}},77358:(e,t,n)=>{n.d(t,{a:()=>l,c:()=>c,l:()=>g,m:()=>d,s:()=>y});var s=n(71252),i=n(60947),r=n(14249);class o{constructor(){this.code=null,this.description=null}}class a{constructor(e){this.error=new o,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function l(e){return new a(e)}class u{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function c(e){return new u(e)}const p=new Set;function d(e,t,n,s=!1,i){p.clear();for(const o in n){const a=e.get(o);if(!a)continue;const u=n[o],c=f(a,u);if(c!==u&&i&&i.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:a,originalValue:u,sanitizedValue:c}}),p.add(a.name),a&&(s||a.editable)){const e=(0,r.Qc)(a,c);if(e)return l((0,r.vP)(e,a,c));t[a.name]=c}}for(const t of e?.requiredFields??[])if(!p.has(t.name))return l(`missing required field "${t.name}"`);return null}function f(e,t){let n=t;return"string"==typeof t&&(0,r.H7)(e)?n=parseFloat(t):null!=t&&(0,r.qN)(e)&&"string"!=typeof t&&(n=String(t)),(0,r.Pz)(n)}let h;function y(e,t){if(!e||!(0,i.j)(t))return e;if("rings"in e||"paths"in e){if((0,s.a)(h))throw new TypeError("geometry engine not loaded");return h.simplify(t,e)}return e}async function g(e,t){!(0,i.j)(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await async function(){return(0,s.a)(h)&&(h=await Promise.all([n.e(3361),n.e(3981)]).then(n.bind(n,43981)).then((e=>e.g))),h}()}},94216:(e,t,n)=>{n.d(t,{a:()=>r,e:()=>a,p:()=>o}),n(31450),n(88762);var s=n(76506),i=n(32101);function r(e,t){return t?{...t,query:{...e,...t.query}}:{query:e}}function o(e){return"string"==typeof e?(0,i.mN)(e):(0,s.d9)(e)}function a(e,t,n){const s={};for(const i in e){if("declaredClass"===i)continue;const r=e[i];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){s[i]=[];for(let e=0;e<r.length;e++)s[i][e]=a(r[e])}else if("object"==typeof r)if(r.toJSON){const e=r.toJSON(n&&n[i]);s[i]=t?e:JSON.stringify(e)}else s[i]=t?r:JSON.stringify(r);else s[i]=r}return s}n(82058)},81731:(e,t,n)=>{n.d(t,{d:()=>r,e:()=>i});var s=n(32422);function i(e){return{geometryType:(0,s.Ji)(e[0]),geometries:e.map((e=>e.toJSON()))}}function r(e,t,n){const i=(0,s.q9)(t);return e.map((e=>{const t=i.fromJSON(e);return t.spatialReference=n,t}))}},95533:(e,t,n)=>{n.d(t,{aX:()=>g});var s=n(31450),i=n(60991),r=n(92143),o=n(71252),a=n(44567),l=n(92896),u=n(94751),c=n(60947),p=n(35132),d=n(95307);n(71552),n(76506),n(40642),n(34250),n(91306),n(60474),n(66396),n(86656),n(17533),n(6540),n(2906),n(21801),n(73796),n(12047),n(21972),n(91055),n(19657),n(6906),n(50406),n(97714),n(91597),n(86787),n(89623),n(98380),n(32422),n(84069),n(74569),n(22781),n(57251),n(82058),n(88762),n(32101),n(94216),n(81731);const f=r.L.getLogger("esri.geometry.support.normalizeUtils");function h(e,t,n){if(t){const t=function(e,t){if(!(e instanceof l.Z||e instanceof a.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw f.error(e),new i.Z(e)}const n=(0,u.g)(e),s=[];for(const e of n){const n=[];s.push(n),n.push([e[0][0],e[0][1]]);for(let s=0;s<e.length-1;s++){const i=e[s][0],r=e[s][1],o=e[s+1][0],a=e[s+1][1],l=Math.sqrt((o-i)*(o-i)+(a-r)*(a-r)),u=(a-r)/l,c=(o-i)/l,p=l/t;if(p>1){for(let e=1;e<=p-1;e++){const s=e*t,o=c*s+i,a=u*s+r;n.push([o,a])}const e=(l+Math.floor(p-1)*t)/2,s=c*e+i,o=u*e+r;n.push([s,o])}n.push([o,a])}}return function(e){return"polygon"===e.type}(e)?new a.Z({rings:s,spatialReference:e.spatialReference}):new l.Z({paths:s,spatialReference:e.spatialReference})}(e,1e6);e=(0,p.Sx)(t,!0)}return n&&(e=(0,u.u)(e,n)),e}function y(e,t,n){if(Array.isArray(e)){const s=e[0];if(s>t){const n=(0,u.o)(s,t);e[0]=s+n*(-2*t)}else if(s<n){const t=(0,u.o)(s,n);e[0]=s+t*(-2*n)}}else{const s=e.x;if(s>t){const n=(0,u.o)(s,t);e=e.clone().offset(n*(-2*t),0)}else if(s<n){const t=(0,u.o)(s,n);e=e.clone().offset(t*(-2*n),0)}}return e}async function g(e,t,n){if(!Array.isArray(e))return g([e],t);t&&"string"!=typeof t&&f.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i="string"==typeof t?t:t?.url??s.Z.geometryServiceUrl;let r,m,_,b,F,S,w,I,T=0;const q=[],x=[];for(const t of e)if((0,o.a)(t))x.push(t);else if(r||(r=t.spatialReference,m=(0,c.g)(r),_=r.isWebMercator,S=_?102100:4326,b=u.c[S].maxX,F=u.c[S].minX,w=u.c[S].plus180Line,I=u.c[S].minus180Line),m)if("mesh"===t.type)x.push(t);else if("point"===t.type)x.push(y(t.clone(),b,F));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>y(e,b,F))),x.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,m);x.push(e.rings?new a.Z(e):e)}else if(t.extent){const e=t.extent,n=(0,u.o)(e.xmin,F)*(2*b);let s=0===n?t.clone():(0,u.u)(t.clone(),n);e.offset(n,0),e.intersects(w)&&e.xmax!==b?(T=e.xmax>T?e.xmax:T,s=h(s,_),q.push(s),x.push("cut")):e.intersects(I)&&e.xmin!==F?(T=e.xmax*(2*b)>T?e.xmax*(2*b):T,s=h(s,_,360),q.push(s),x.push("cut")):x.push(s)}else x.push(t.clone());else x.push(t);let E=(0,u.o)(T,b),j=-90;const C=E,R=new l.Z;for(;E>0;){const e=360*E-180;R.addPath([[e,j],[e,-1*j]]),j*=-1,E--}if(q.length>0&&C>0){const t=function(e,t){let n=-1;for(let s=0;s<t.cutIndexes.length;s++){const i=t.cutIndexes[s],r=t.geometries[s],o=(0,u.g)(r);for(let e=0;e<o.length;e++){const t=o[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const s=t[e][0];n=s>n?s:n}n=Number(n.toFixed(9));const s=-360*(0,u.o)(n,180);for(let n=0;n<t.length;n++){const t=r.getPoint(e,n);r.setPoint(e,n,t.clone().offset(s,0))}return!0}}))}if(i===n){if("polygon"===e[0].type)for(const t of(0,u.g)(r))e[i]=e[i].addRing(t);else if("polyline"===e[0].type)for(const t of(0,u.g)(r))e[i]=e[i].addPath(t)}else n=i,e[i]=r}return e}(q,await(0,d.c)(i,q,R,n)),s=[],r=[];for(let n=0;n<x.length;n++){const i=x[n];if("cut"!==i)r.push(i);else{const i=t.shift(),a=e[n];(0,o.i)(a)&&"polygon"===a.type&&a.rings&&a.rings.length>1&&i.rings.length>=a.rings.length?(s.push(i),r.push("simplify")):r.push(_?(0,p.$)(i):i)}}if(!s.length)return r;const a=await(0,d.s)(i,s,n),l=[];for(let e=0;e<r.length;e++){const t=r[e];"simplify"!==t?l.push(t):l.push(_?(0,p.$)(a.shift()):a.shift())}return l}const M=[];for(let e=0;e<x.length;e++){const t=x[e];if("cut"!==t)M.push(t);else{const e=q.shift();M.push(!0===_?(0,p.$)(e):e)}}return M}},1709:(e,t,n)=>{n.d(t,{Z:()=>o});var s=n(14249);function i(e){return"oid"===e.type||"esriFieldTypeOID"===e.type}function r(e){return"global-id"===e.type||"esriFieldTypeGlobalID"===e.type}n(60991),n(76506),n(92143),n(31450),n(71552),n(40642),n(60217),n(74569),n(91306),n(21801),n(34250),n(60474),n(66396),n(86656),n(17533),n(6540),n(73796),n(12047),n(21972),n(91055),n(19657),n(6906),n(50406),n(97714),n(60947),n(2906),n(91597),n(86787),n(35132),n(89623),n(84069),n(44567),n(98380),n(92896),n(22781),n(57251),n(32422);class o{constructor(e=[]){if(this.fields=[],this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!e)return;this.fields=e;const t=[];for(const o of e){const e=o&&o.name;if(e){const u=a(e),c=l(e);this._fieldsMap.set(e,o),this._fieldsMap.set(u,o),this._normalizedFieldsMap.set(c,o),t.push(u),"date"===(n=o).type||"esriFieldTypeDate"===n.type?(this.dateFields.push(o),this._dateFieldsSet.add(o)):(0,s.H7)(o)&&(this._numericFieldsSet.add(o),this.numericFields.push(o)),i(o)||r(o)||(o.editable=null==o.editable||!!o.editable,o.nullable=null==o.nullable||!!o.nullable)}}var n;t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)i(e)||r(e)||e.nullable||void 0!==(0,s.os)(e)||this._requiredFields.push(e)}return this._requiredFields}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(a(e))??this._normalizedFieldsMap.get(l(e)),t&&this._fieldsMap.set(e,t),t)}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name??void 0}}function a(e){return e.trim().toLowerCase()}function l(e){return(0,s.q6)(e).toLowerCase()}}}]);