"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[7694],{97853:(e,t,n)=>{n.d(t,{B:()=>c});var r=n(29768),o=n(95873),s=n(34250),i=(n(76506),n(91306),n(17533));let a=class extends o.r{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}};(0,r._)([(0,s.Cb)({readOnly:!0})],a.prototype,"supportsTileUpdates",null),(0,r._)([(0,s.Cb)({constructOnly:!0})],a.prototype,"remoteClient",void 0),(0,r._)([(0,s.Cb)({constructOnly:!0})],a.prototype,"service",void 0),(0,r._)([(0,s.Cb)()],a.prototype,"spatialReference",null),(0,r._)([(0,s.Cb)({constructOnly:!0})],a.prototype,"tileInfo",void 0),(0,r._)([(0,s.Cb)({constructOnly:!0})],a.prototype,"tileStore",void 0),a=(0,r._)([(0,i.j)("esri.views.2d.layers.features.processors.BaseProcessor")],a);const c=a},57694:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var r=n(29768),o=(n(71552),n(71252)),s=(n(92143),n(91306),n(76506),n(60991),n(17533)),i=n(93939),a=n(60045),c=n(82356),l=n(97853),d=n(22233);n(31450),n(40642),n(86656),n(66396),n(6540),n(21972),n(60474),n(91055),n(34250),n(19657),n(6906),n(50406),n(15324),n(75067),n(89914),n(82426),n(72836),n(29794),n(68681),n(95873),n(23771),n(58085),n(21801),n(73796),n(12047),n(97714),n(60947),n(2906),n(91597),n(86787),n(35132),n(89623),n(31292),n(74569),n(84069),n(44567),n(98380),n(92896),n(22781),n(57251),n(32422),n(93314),n(35197),n(59465),n(69218),n(97546),n(9801),n(53523),n(42911),n(46826),n(45433),n(54732),n(32925),n(66122),n(27207),n(29704);class u{constructor(e,t){this.offset=e,this.extent=t}}let f=class extends l.B{constructor(){super(...arguments),this.type="heatmap",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}async update(e,t){const n=t.schema.processors[0];"heatmap"===n.type&&(0,i.d)(this._schema,n)&&(e.mesh=!0,this._schema=n)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(e){return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}async onTileMessage(e,t,n){this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map);const r=this._tileKeyToFeatureSets.get(e.key.id);if((0,o.i)(t.addOrUpdate)&&t.addOrUpdate.hasFeatures&&r.set(t.addOrUpdate.instance,t),t.end){const t=[],r=function(e){const t=e.key,n=new Map,r=256,o=c.k,s=e.tileInfoView.tileInfo.isWrappable;return n.set((0,d.g)(t,-1,-1,s).id,new u([-o,-o],[o-r,o-r,o,o])),n.set((0,d.g)(t,0,-1,s).id,new u([0,-o],[0,o-r,o,o])),n.set((0,d.g)(t,1,-1,s).id,new u([o,-o],[0,o-r,r,o])),n.set((0,d.g)(t,-1,0,s).id,new u([-o,0],[o-r,0,o,o])),n.set((0,d.g)(t,1,0,s).id,new u([o,0],[0,0,r,o])),n.set((0,d.g)(t,-1,1,s).id,new u([-o,o],[o-r,0,o,r])),n.set((0,d.g)(t,0,1,s).id,new u([0,o],[0,0,o,r])),n.set((0,d.g)(t,1,1,s).id,new u([o,o],[0,0,r,r])),n}(e);this._tileKeyToFeatureSets.forEach(((n,s)=>{if(s===e.key.id)n.forEach((e=>(0,o.g)(e.addOrUpdate,(e=>t.push(e)))));else if(r.has(s)){const e=r.get(s),[i,a]=e.offset;n.forEach((e=>(0,o.g)(e.addOrUpdate,(e=>{const n=e.transform(i,a,1,1);t.push(n)}))))}}));const s=(0,a.b)(t,this._schema.mesh,512,512),i={tileKey:e.key.id,intensityInfo:s},l=[s.matrix];return this.remoteClient.invoke("tileRenderer.onTileData",i,{...n,transferList:l})}}onTileError(e,t,n){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:e.id,error:t},n)}};f=(0,r._)([(0,s.j)("esri.views.2d.layers.features.processors.HeatmapProcessor")],f);const p=f},60045:(e,t,n)=>{n.d(t,{M:()=>o,b:()=>a,c:()=>l,e:()=>c,g:()=>s,k:()=>i}),n(82426);var r=n(99403);n(68681);const o=2.4;function s(e){return(0,r.p)(2.4*e)}function i(e){return(0,r.a)(e)/2.4}function a(e,t,n,o){const{radius:s,fieldOffset:i,field:a}=t,l=Math.round((0,r.a)(s)),d=new Float64Array(n*o);let u,f=Number.NEGATIVE_INFINITY;const p=function(e,t){return null!=e?"string"==typeof t?t=>-1*+t.readAttribute(e):n=>+n.readAttribute(e)+t:e=>1}(a,i),h=new Set;for(const t of e){const e=t.getCursor();for(;e.next();){const t=e.getObjectId();if(h.has(t))continue;h.add(t);const r=e.readLegacyPointGeometry(),s=128;if(r.x<-s||r.x>=n+s||r.y<-s||r.y>o+s)continue;const i=+p(e),a=Math.max(0,Math.round(r.x)-l),y=Math.max(0,Math.round(r.y)-l),m=Math.min(o,Math.round(r.y)+l),g=Math.min(n,Math.round(r.x)+l);for(let e=y;e<m;e++)for(let t=a;t<g;t++){const o=e*n+t,s=c(r.x-t,r.y-e,l);u=d[o]+=s*i,u>f&&(f=u)}}}return{matrix:d.buffer,max:f}}function c(e,t,n){const r=Math.sqrt(e**2+t**2)/n;return r>1?0:3/(Math.PI*n**2)*(1-r**2)**2}function l(e,t){return"function"==typeof e?e:e?"string"==typeof t?t=>-1*+t[e]:n=>+n[e]+t:()=>1}},99403:(e,t,n)=>{n.d(t,{a:()=>o,p:()=>s,t:()=>i});const r=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function o(e){return e?e/72*96:0}function s(e){return e?72*e/96:0}function i(e){if("string"==typeof e){const t=e.match(r);if(t){const n=Number(t[1]),r=t[3]&&t[3].toLowerCase(),o="-"===e.charAt(0),i="px"===r?s(n):n;return o?-i:i}return console.warn("screenUtils.toPt: input not recognized!"),null}return e}},22233:(e,t,n)=>{function r(e,t,n,r){const o=e.clone(),s=1<<o.level,i=o.col+t,a=o.row+n;return r&&i<0?(o.col=i+s,o.world-=1):i>=s?(o.col=i-s,o.world+=1):o.col=i,o.row=a,o}n.d(t,{g:()=>r}),n(91055),n(21801),n(71552),n(82426),n(31292),n(29704)},68681:(e,t,n)=>{function r(){return[0,0,0,0]}function o(e,t,n,r){return[e,t,n,r]}function s(e,t){return new Float64Array(e,t,4)}n.d(t,{b:()=>s,c:()=>r,f:()=>o}),o(1,1,1,1)}}]);