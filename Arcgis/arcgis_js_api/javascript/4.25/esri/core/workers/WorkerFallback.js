// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["require","../../chunks/_rollupPluginBabelHelpers","../nextTick","./RemoteClient","./utils"],function(l,g,h,k,f){function m(c){if(c&&c.__esModule)return c;const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(c)for(const a in c)if("default"!==a){const b=Object.getOwnPropertyDescriptor(c,a);Object.defineProperty(d,a,b.get?b:{enumerable:!0,get:()=>c[a]})}d.default=c;return Object.freeze(d)}let n=function(){const c=document.createDocumentFragment();["addEventListener","dispatchEvent",
"removeEventListener"].forEach(d=>{this[d]=(...a)=>c[d](...a)})};return function(){function c(){this._dispatcher=new n;this._workerPostMessage({type:f.MessageType.HANDSHAKE})}var d=c.prototype;d.terminate=function(){};d.postMessage=function(a){h.nextTick(()=>{this._workerMessageHandler(new MessageEvent("message",{data:a}))})};d.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)};d.addEventListener=function(a,b,e){this._dispatcher.addEventListener(a,b,e)};d.removeEventListener=function(a,
b,e){this._dispatcher.removeEventListener(a,b,e)};d._workerPostMessage=function(a){h.nextTick(()=>{this.dispatchEvent(new MessageEvent("message",{data:a}))})};d._workerMessageHandler=function(){var a=g._asyncToGenerator(function*(b){if((b=f.receiveMessage(b))&&b.type===f.MessageType.OPEN){const {modulePath:e,jobId:p}=b;(b=yield k.loadWorker(e))||(b=yield new Promise((q,r)=>l([e],t=>q(m(t)),r)));b=k.connect(b);this._workerPostMessage({type:f.MessageType.OPENED,jobId:p,data:b})}});return function(b){return a.apply(this,
arguments)}}();g._createClass(c,[{key:"onmessage",get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)}},{key:"onmessageerror",get:function(){return this._onmessageerrorHandler},set:function(a){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler);(this._onmessageerrorHandler=a)&&this.addEventListener("messageerror",
a)}},{key:"onerror",get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=a)&&this.addEventListener("error",a)}}]);return c}()});