// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../Accessor","../Collection","../maybe","./utils"],function(h,t,u,g,y){function v(a){return a instanceof u?Object.keys(a.items):a instanceof t?y.getProperties(a).keys():a?Object.keys(a):[]}function q(a,b){return a instanceof u?a.items[b]:a[b]}function z(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function k(a){return a?a.declaredClass:null}function w(a,b){const e=a.diff;if(e&&"function"===typeof e)return e(a,b);const l=v(a),m=v(b);if(0!==l.length||0!==
m.length){if(!l.length||!m.length||z(a,b))return{type:"complete",oldValue:a,newValue:b};var n=m.filter(d=>!l.includes(d)),c=l.filter(d=>!m.includes(d));c=l.filter(d=>m.includes(d)&&q(a,d)!==q(b,d)).concat(n,c).sort();if((n=k(a))&&A.includes(n)&&c.length)return{type:"complete",oldValue:a,newValue:b};var r;n=a instanceof t&&b instanceof t;for(const d of c){c=q(a,d);const f=q(b,d);if((n||"function"!==typeof c&&"function"!==typeof f)&&c!==f&&(null!=c||null!=f)){if(e&&e[d]&&"function"===typeof e[d])c=
e[d](c,f);else if(c instanceof Date&&f instanceof Date){if(c.getTime()===f.getTime())continue;c={type:"complete",oldValue:c,newValue:f}}else c="object"===typeof c&&"object"===typeof f&&k(c)===k(f)?w(c,f):{type:"complete",oldValue:c,newValue:f};g.isSome(c)&&(g.isSome(r)?r.diff[d]=c:r={type:"partial",diff:{[d]:c}})}}return r}}function x(a,b){if(g.isNone(a))return!1;b=b.split(".");for(const e of b){if("complete"===a.type)break;if("partial"===a.type){if(a=a.diff[e],!a)return!1}else return!1}return!0}
function p(a){if(g.isNone(a))return!0;switch(a.type){case "complete":return!1;case "collection":for(const b of a.added)if(!p(b))return!1;for(const b of a.removed)if(!p(b))return!1;for(const b of a.changed)if(!p(b))return!1;return!0;case "partial":for(const b in a.diff)if(!p(a.diff[b]))return!1;return!0}}const A=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];h.diff=function(a,b){if(!("function"===typeof a||"function"===
typeof b||g.isNone(a)&&g.isNone(b)))return g.isNone(a)||g.isNone(b)||"object"===typeof a&&"object"===typeof b&&k(a)!==k(b)?{type:"complete",oldValue:a,newValue:b}:w(a,b)};h.hasDiff=x;h.hasDiffAny=function(a,b){for(const e of b)if(x(a,e))return!0;return!1};h.isEmpty=p;Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});