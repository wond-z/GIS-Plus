// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","./PropertyOrigin","./tracking","./tracking/Flags","./tracking/ObservationHandle"],function(h,m,f,c,n){let p=function(){function k(a,b,d){this.properties=a;this.propertyName=b;this.metadata=d;this._handles=this._accessed=this._observers=null;this.flags=c.Flags.Dirty|(d.nonNullable?c.Flags.NonNullable:0)|(d.hasOwnProperty("value")?c.Flags.HasDefaultValue:0)|(void 0===d.get?c.Flags.DepTrackingInitialized:0)|(void 0===d.dependsOn?c.Flags.AutoTracked:0)}var e=k.prototype;e.destroy=function(){if(this.flags&
c.Flags.Dirty&&this._observers){const a=this._observers.slice();for(const b of a)b.onCommitted()}this._observers=this._accessed=null;this._clearObservationHandles()};e.getComputed=function(){f.trackAccess(this);var a=this.properties.store;const b=this.propertyName;var d=this.flags;const l=a.get(b);if(d&c.Flags.Computing||~d&c.Flags.Dirty&&a.has(b))return l;this.flags|=c.Flags.Computing;const g=this.properties.host;d&c.Flags.AutoTracked?d=f.runTracked(this,this.metadata.get,g):(f.trackExplicitDependencies(g,
this),d=this.metadata.get.call(g));a.set(b,d,m.OriginId.COMPUTED);a=a.get(b);a===l?this.flags&=~c.Flags.Dirty:f.runUntracked(this.commit,this);this.flags&=~c.Flags.Computing;return a};e.onObservableAccessed=function(a){a!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(a)||this._accessed.push(a))};e.onTrackingEnd=function(){this._clearObservationHandles();this.flags|=c.Flags.DepTrackingInitialized;const a=this._accessed;if(null!==a){var b=this._handles;null===b&&(b=this._handles=
[]);for(let d=0;d<a.length;++d)b.push(a[d].observe(this));a.length=0}};e.observe=function(a){null===this._observers&&(this._observers=[]);this._observers.includes(a)||this._observers.push(a);return new n.ObservationHandle(this._observers,a)};e.notifyChange=function(){this.onInvalidated();this.onCommitted()};e.invalidate=function(){this.onInvalidated()};e.onInvalidated=function(){~this.flags&c.Flags.Overriden&&(this.flags|=c.Flags.Dirty);const a=this._observers;if(null!==a)for(let b=0;b<a.length;++b)a[b].onInvalidated()};
e.commit=function(){this.flags&=~c.Flags.Dirty;this.onCommitted()};e.onCommitted=function(){if(null!==this._observers){var a=this._observers.slice();for(let b=0;b<a.length;++b)a[b].onCommitted()}};e._clearObservationHandles=function(){const a=this._handles;if(null!==a){for(let b=0;b<a.length;++b)a[b].remove();a.length=0}};return k}();h.Property=p;Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});