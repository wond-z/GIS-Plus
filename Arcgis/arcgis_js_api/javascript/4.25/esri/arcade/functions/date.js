// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/languageUtils","../executionError","../../intl/locale","../../chunks/datetime"],function(q,c,r,u,m){function t(g){g=new Date(g.getTime());const h=g.getFullYear();var d=new Date(0);d.setFullYear(h+1,0,4);d.setHours(0,0,0,0);d=n(d);var e=new Date(0);e.setFullYear(h,0,4);e.setHours(0,0,0,0);e=n(e);return g.getTime()>=d.getTime()?h+1:g.getTime()>=e.getTime()?h:h-1}function n(g){g=new Date(g.getTime());var h=g.getDay();h=(1>h?7:0)+h-1;g.setDate(g.getDate()-h);g.setHours(0,
0,0,0);return g}function l(g){return null===g?g:isNaN(g.getTime())?null:g}const v=[0,31,59,90,120,151,181,212,243,273,304,334],w=[0,31,60,91,121,152,182,213,244,274,305,335];q.registerFunctions=function(g,h){g.today=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,0,0,d,e);a=new Date;a.setHours(0,0,0,0);return a})};g.now=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,0,0,d,e);return new Date})};g.timestamp=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,0,0,d,e);a=new Date;return a=new Date(a.getUTCFullYear(),
a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};g.toutc=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?null:new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};g.tolocal=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?null:m.DateTime.utc(a.getFullYear(),a.getMonth()+
1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()).toJSDate()})};g.day=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getDate()})};g.month=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getMonth()})};g.year=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getFullYear()})};g.hour=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,
1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getHours()})};g.second=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getSeconds()})};g.millisecond=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getMilliseconds()})};g.minute=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getMinutes()})};g.week=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,2,d,e);
a=c.toDate(b[0]);if(null===a)return NaN;b=c.toNumber(c.defaultUndefined(b[1],0));if(0>b||6<b)throw new r.ArcadeExecutionError(d,r.ExecutionErrorCodes.InvalidParameter,e);f=a.getDate();var k=a.getMonth();const p=a.getFullYear();a=a.getDay();f=f+(0!==p%4||0===p%100&&0!==p%400?v:w)[k]-1;k=Math.floor(f/7);return a-b+(0>a-b?7:0)<f-7*k?k+1:k})};g.weekday=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getDay()})};g.isoweekday=function(d,e){return h(d,e,(a,
f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);if(null===a)return NaN;a=a.getDay();0===a&&(a=7);return a})};g.isomonth=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:a.getMonth()+1})};g.isoweek=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);f=c.toDate(b[0]);if(null===f)return NaN;a=n(f).getTime();f=t(f);b=new Date(0);b.setFullYear(f,0,4);b.setHours(0,0,0,0);f=n(b);a-=f.getTime();return Math.round(a/6048E5)+1})};g.isoyear=function(d,e){return h(d,
e,(a,f,b)=>{c.pcCheck(b,1,1,d,e);a=c.toDate(b[0]);return null===a?NaN:t(a)})};g.date=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,0,7,d,e);if(3===b.length)return l(new Date(c.toNumber(b[0]),c.toNumber(b[1]),c.toNumber(b[2]),0,0,0,0));if(4===b.length)return l(new Date(c.toNumber(b[0]),c.toNumber(b[1]),c.toNumber(b[2]),c.toNumber(b[3]),0,0,0));if(5===b.length)return l(new Date(c.toNumber(b[0]),c.toNumber(b[1]),c.toNumber(b[2]),c.toNumber(b[3]),c.toNumber(b[4]),0,0));if(6===b.length)return l(new Date(c.toNumber(b[0]),
c.toNumber(b[1]),c.toNumber(b[2]),c.toNumber(b[3]),c.toNumber(b[4]),c.toNumber(b[5]),0));if(7===b.length)return l(new Date(c.toNumber(b[0]),c.toNumber(b[1]),c.toNumber(b[2]),c.toNumber(b[3]),c.toNumber(b[4]),c.toNumber(b[5]),c.toNumber(b[6])));if(2===b.length){a=c.toString(b[1]);if(""===a)return null;a=c.standardiseDateFormat(a);b="X"===a?m.DateTime.fromSeconds(c.toNumber(b[0])):"x"===a?m.DateTime.fromMillis(c.toNumber(b[0])):m.DateTime.fromFormat(c.toString(b[0]),a,{locale:u.getLocale(),numberingSystem:"latn"});
return b.isValid?b.toJSDate():null}if(1===b.length){if(c.isString(b[0])){if(""===b[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;if(!0===/^[0-9][0-9][0-9][0-9]$/.test(b[0]))return c.toDate(b[0]+"-01-01")}a=c.toNumber(b[0]);return!1===isNaN(a)?l(new Date(a)):c.toDate(b[0])}if(0===b.length)return new Date})};g.datediff=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,2,3,d,e);a=c.toDateTime(b[0]);f=c.toDateTime(b[1]);if(null===a||null===f)return NaN;switch(c.toString(b[2]).toLowerCase()){case "days":case "day":case "d":return a.diff(f,
"days").days;case "months":case "month":return a.diff(f,"months").months;case "minutes":case "minute":case "m":return"M"===b[2]?a.diff(f,"months").months:a.diff(f,"minutes").minutes;case "seconds":case "second":case "s":return a.diff(f,"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return a.diff(f).milliseconds;case "hours":case "hour":case "h":return a.diff(f,"hours").hours;case "years":case "year":case "y":return a.diff(f,"years").years;default:return a.diff(f).milliseconds}})};
g.dateadd=function(d,e){return h(d,e,(a,f,b)=>{c.pcCheck(b,2,3,d,e);a=c.toDateTime(b[0]);if(null===a)return null;f=c.toNumber(b[1]);if(isNaN(f))return a.toJSDate();let k="milliseconds";switch(c.toString(b[2]).toLowerCase()){case "days":case "day":case "d":k="days";f=c.absRound(f);break;case "months":case "month":k="months";f=c.absRound(f);break;case "minutes":case "minute":case "m":k="M"===b[2]?"months":"minutes";break;case "seconds":case "second":case "s":k="seconds";break;case "milliseconds":case "millisecond":case "ms":k=
"milliseconds";break;case "hours":case "hour":case "h":k="hours";break;case "years":case "year":case "y":k="years"}return a.plus({[k]:f}).toJSDate()})}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});