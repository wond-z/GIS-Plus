// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../Dictionary ../Feature ../ImmutablePointArray ../../chunks/languageUtils ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ./centroid ../../geometry/support/jsonUtils ../executionError ../ImmutablePathArray ../../geometry/support/coordsUtils".split(" "),function(B,n,p,D,f,E,v,x,r,y,z,w,t,e,F,G){function A(g){return g&&"esri.arcade.Feature"===g.arcadeDeclaredClass}function C(g,h,c,d,b=1){h=h.toLowerCase();
switch(h){case "hasz":return g=g.hasZ,void 0===g?!1:g;case "hasm":return g=g.hasM,void 0===g?!1:g;case "spatialreference":return h=g.spatialReference._arcadeCacheId,void 0===h&&(c=!0,Object.freeze&&Object.isFrozen(g.spatialReference)&&(c=!1),c&&(u++,h=g.spatialReference._arcadeCacheId=u)),g=new n({wkt:g.spatialReference.wkt,wkid:g.spatialReference.wkid}),void 0!==h&&(g._arcadeCacheId="SPREF"+h.toString()),g}switch(g.type){case "extent":switch(h){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return g=
g[h],void 0!==g?g:null;case "type":return"Extent"}break;case "polygon":switch(h){case "rings":return h=g.cache._arcadeCacheId,void 0===h&&(u++,h=u,g.cache._arcadeCacheId=h),new F(g.rings,g.spatialReference,!0===g.hasZ,!0===g.hasM,h);case "type":return"Polygon"}break;case "point":switch(h){case "x":case "y":case "z":case "m":return void 0!==g[h]?g[h]:null;case "type":return"Point"}break;case "polyline":switch(h){case "paths":return h=g.cache._arcadeCacheId,void 0===h&&(u++,h=u,g.cache._arcadeCacheId=
h),new F(g.paths,g.spatialReference,!0===g.hasZ,!0===g.hasM,h);case "type":return"Polyline"}break;case "multipoint":switch(h){case "points":return h=g.cache._arcadeCacheId,void 0===h&&(u++,h=u,g.cache._arcadeCacheId=h),new D(g.points,g.spatialReference,!0===g.hasZ,!0===g.hasM,h,1);case "type":return"Multipoint"}}if(1===b)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidIdentifier,d);return 2===b?{keystate:"notfound"}:null}let u=0;B.geometryMember=C;B.registerFunctions=function(g,h){g.ringisclockwise=
function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=[];let m=l=!1;if(null===a[0])return!1;if(f.isArray(a[0])){for(const k of a[0])if(k instanceof r)b.push(k.hasZ?k.hasM?[k.x,k.y,k.z,k.m]:[k.x,k.y,k.z]:[k.x,k.y]);else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);0<b.length&&(l=a[0][0].hasZ,m=a[0][0].hasM)}else if(a[0]instanceof D)b=a[0]._elements,0<b.length&&(l=a[0]._hasZ,m=a[0]._hasM);else if(f.isImmutableArray(a[0])){for(const k of a[0].toArray())if(k instanceof
r)b.push(k.hasZ?k.hasM?[k.x,k.y,k.z,k.m]:[k.x,k.y,k.z]:[k.x,k.y]);else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);0<b.length&&(l=a[0].get(0).hasZ,m=a[0].get(0).hasM)}else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);return 3>b.length?!1:G.isClockwise(b,m,l)})};g.polygon=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=null;if(a[0]instanceof n){if(b=f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),c.spatialReference),
!1===b instanceof y)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}else b=a[0]instanceof y?t.fromJSON(a[0].toJSON()):f.fixSpatialReference(new y(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,d);return f.fixNullGeometry(b)})};g.polyline=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=null;if(a[0]instanceof n){if(b=f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),
c.spatialReference),!1===b instanceof z)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}else b=a[0]instanceof z?t.fromJSON(a[0].toJSON()):f.fixSpatialReference(new z(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,d);return f.fixNullGeometry(b)})};g.point=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=null;if(a[0]instanceof
n){if(b=f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),c.spatialReference),!1===b instanceof r)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}else b=a[0]instanceof r?t.fromJSON(a[0].toJSON()):f.fixSpatialReference(new r(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,d);return f.fixNullGeometry(b)})};g.multipoint=function(c,
d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=null;if(a[0]instanceof n){if(b=f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),c.spatialReference),!1===b instanceof x)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}else b=a[0]instanceof x?t.fromJSON(a[0].toJSON()):f.fixSpatialReference(new x(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,
d);return f.fixNullGeometry(b)})};g.extent=function(c,d){return h(c,d,(b,l,a)=>{a=f.autoCastFeatureToGeometry(a);f.pcCheck(a,1,1,c,d);b=null;a[0]instanceof n?b=f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),c.spatialReference):a[0]instanceof r?(b={xmin:a[0].x,ymin:a[0].y,xmax:a[0].x,ymax:a[0].y,spatialReference:a[0].spatialReference.toJSON()},a=a[0],a.hasZ?(b.zmin=a.z,b.zmax=a.z):a.hasM&&(b.mmin=a.m,b.mmax=a.m),b=t.fromJSON(b)):b=a[0]instanceof y?t.fromJSON(a[0].extent?.toJSON()):a[0]instanceof
z?t.fromJSON(a[0].extent?.toJSON()):a[0]instanceof x?t.fromJSON(a[0].extent?.toJSON()):a[0]instanceof E?t.fromJSON(a[0].toJSON()):f.fixSpatialReference(new E(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,d);return f.fixNullGeometry(b)})};g.geometry=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,1,1,c,d);b=null;if(null===a[0])return null;b=A(a[0])?f.fixSpatialReference(a[0].geometry(),
c.spatialReference):a[0]instanceof n?f.fixSpatialReference(p.parseGeometryFromDictionary(a[0]),c.spatialReference):f.fixSpatialReference(t.fromJSON(JSON.parse(a[0])),c.spatialReference);if(null!==b&&!1===b.spatialReference.equals(c.spatialReference))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongSpatialReference,d);return f.fixNullGeometry(b)})};g.setgeometry=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,2,2,c,d);if(A(a[0])){if(!0===a[0].immutable)throw new e.ArcadeExecutionError(c,
e.ExecutionErrorCodes.Immutable,d);if(a[1]instanceof v||null===a[1])a[0]._geometry=a[1];else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);return f.voidOperation})};g.feature=function(c,d){return h(c,d,(b,l,a)=>{if(0===a.length)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongNumberOfParameters,d);b=null;if(1===a.length)if(f.isString(a[0]))b=p.fromJson(JSON.parse(a[0]));else if(A(a[0]))b=
p.createFromArcadeFeature(a[0]);else if(a[0]instanceof v)b=p.createFromGraphicLikeObject(a[0],null,null);else if(a[0]instanceof n)b=a[0].hasField("geometry")?a[0].field("geometry"):null,a=a[0].hasField("attributes")?a[0].field("attributes"):null,null!==b&&b instanceof n&&(b=p.parseGeometryFromDictionary(b)),null!==a&&(a=p.parseAttributesFromDictionary(a)),b=p.createFromGraphicLikeObject(b,a,null);else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);else if(2===a.length){l=
b=null;if(null!==a[0])if(a[0]instanceof v)b=a[0];else if(b instanceof n)b=p.parseGeometryFromDictionary(a[0]);else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);if(null!==a[1])if(a[1]instanceof n)l=p.parseAttributesFromDictionary(a[1]);else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);b=p.createFromGraphicLikeObject(b,l,null)}else{b=null;l={};if(null!==a[0])if(a[0]instanceof v)b=a[0];else if(b instanceof n)b=p.parseGeometryFromDictionary(a[0]);
else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);for(let m=1;m<a.length;m+=2){const k=f.toString(a[m]),q=a[m+1];if(null===q||void 0===q||f.isString(q)||isNaN(q)||f.isDate(q)||f.isNumber(q)||f.isBoolean(q)){if(f.isFunctionParameter(q)||!1===f.isSimpleType(q))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);l[k]=q===f.voidOperation?null:q}else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}b=p.createFromGraphicLikeObject(b,
l,null)}b._geometry=f.fixSpatialReference(b.geometry(),c.spatialReference);b.immutable=!1;return b})};g.dictionary=function(c,d){return h(c,d,(b,l,a)=>{if(0===a.length)return a=new n,a.immutable=!1,a;if(1===a.length&&f.isString(a[0]))try{var m=JSON.parse(a[0]),k=n.convertObjectToArcadeDictionary(m,!1);k.immutable=!1;return k}catch(q){throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);}if(0!==a.length%2)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.WrongNumberOfParameters,
d);b={};for(l=0;l<a.length;l+=2)if(m=f.toString(a[l]),k=a[l+1],null===k||void 0===k||f.isString(k)||isNaN(k)||f.isDate(k)||f.isNumber(k)||f.isBoolean(k)||f.isArray(k)||f.isImmutableArray(k)){if(f.isFunctionParameter(k))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);b[m]=k===f.voidOperation?null:k}else throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);a=new n(b);a.immutable=!1;return a})};g.haskey=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,
2,2,c,d);b=f.toString(a[1]);if(A(a[0])||a[0]instanceof n)return a[0].hasField(b);if(a[0]instanceof v)return(a=C(a[0],b,null,null,2))&&"notfound"===a.keystate?!1:!0;throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);})};g.hasvalue=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,2,2,c,d);if(null===a[0]||null===a[1])return!1;b=f.toString(a[1]);return f.isFeature(a[0])||a[0]instanceof n?a[0].hasField(b)&&null!==a[0].field(b)?!0:!1:a[0]instanceof v?null===C(a[0],b,null,null,
0)?!1:!0:!1})};g.indexof=function(c,d){return h(c,d,(b,l,a)=>{f.pcCheck(a,2,2,c,d);b=a[1];if(f.isArray(a[0])){for(l=0;l<a[0].length;l++)if(f.equalityTest(b,a[0][l]))return l;return-1}if(f.isImmutableArray(a[0])){l=a[0].length();for(let m=0;m<l;m++)if(f.equalityTest(b,a[0].get(m)))return m;return-1}throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);})};g.angle=function(c,d){return h(c,d,(b,l,a)=>{a=f.autoCastFeatureToGeometry(a);f.pcCheck(a,2,3,c,d);if(!(a[0]instanceof r))throw new e.ArcadeExecutionError(c,
e.ExecutionErrorCodes.InvalidParameter,d);if(!(a[1]instanceof r))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);if(2<a.length&&!(a[2]instanceof r))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);return 2===a.length?w.angle2D(a[0],a[1]):w.angleBetween2D(a[0],a[1],a[2])})};g.bearing=function(c,d){return h(c,d,(b,l,a)=>{a=f.autoCastFeatureToGeometry(a);f.pcCheck(a,2,3,c,d);if(!(a[0]instanceof r))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,
d);if(!(a[1]instanceof r))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);if(2<a.length&&!(a[2]instanceof r))throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.InvalidParameter,d);return 2===a.length?w.bearing2D(a[0],a[1]):w.bearingBetween2D(a[0],a[1],a[2])})};g.isselfintersecting=function(c,d){return h(c,d,(b,l,a)=>{a=f.autoCastFeatureToGeometry(a);f.pcCheck(a,1,1,c,d);b=a[0];if(b instanceof y)return b.isSelfIntersecting;if(b instanceof z)return b=b.paths,w.pathsSelfIntersecting(b);
if(b instanceof x)for(l=b.points,a=0;a<l.length;a++)for(let m=0;m<l.length;m++)if(m!==a){let k=!0;for(let q=0;q<l[a].length;q++)if(l[a][q]!==l[m][q]){k=!1;break}if(!0===k)return!0}return f.isArray(b)||f.isImmutableArray(b)?(b=f.autoCastArrayOfPointsToPolyline(b,c.spatialReference),null!==b&&(b=b.paths),w.pathsSelfIntersecting(b)):!1})}};Object.defineProperties(B,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});