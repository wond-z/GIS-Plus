// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(M,D,H,I,n,R,P,J,L){function k(m,e){if(!m)return null;if("classBreaks"===m.type&&m.classificationMethod){var p=m.authoringInfo||{classificationMethod:""};p.classificationMethod=
m.classificationMethod;m.authoringInfo=p}"vectorField"===m.type&&m.visualVariables&&!Array.isArray(m.visualVariables)&&(m.visualVariables=[m.visualVariables]);p=m?f[m.type]||null:null;if(p)return p=new p,p.read(m,e),p;e&&e.messages&&m&&e.messages.push(new D("renderer:unsupported","Renderers of type '"+(m.type||"unknown")+"' are not supported",{definition:m,context:e}));return null}const l={key:"type",base:null,typeMap:{"unique-value":J,"class-breaks":H,"raster-colormap":n,"raster-stretch":P,"vector-field":L,
"raster-shaded-relief":R,flow:I}},a={...l,typeMap:{...l.typeMap}};delete a.typeMap["vector-field"];delete a.typeMap.flow;const f={uniqueValue:J,classBreaks:H,rasterStretch:P,rasterColormap:n,vectorField:L,rasterShadedRelief:R,flowRenderer:I};M.ClassBreaksRenderer=H;M.FlowRenderer=I;M.RasterColormapRenderer=n;M.RasterShadedReliefRenderer=R;M.RasterStretchRenderer=P;M.UniqueValueRenderer=J;M.VectorFieldRenderer=L;M.fromJSON=function(m,e){return k(m,e)};M.rasterRendererTypes=l;M.read=k;M.websceneRasterRendererTypes=
a;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/FlowRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m){var e;I=new I.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});n=e=function(p){function y(F){F=p.call(this,F)||this;F.density=.8;F.color=new H([255,255,255,1]);F.maxPathLength=200;F.trailWidth=1.5;F.flowSpeed=10;F.trailLength=100;F.smoothing=0;F.flowRepresentation="flow-from";F.type="flow";F.authoringInfo=null;F.legendOptions=null;F.trailCap="butt";F.background="none";return F}M._inheritsLoose(y,p);var K=y.prototype;K.clone=function(){const {density:F,maxPathLength:g,
trailWidth:w,flowSpeed:u,trailLength:C,smoothing:d,flowRepresentation:b,trailCap:c,background:h}=this,q=this.color.clone(),z=(this.visualVariables||[]).map(x=>x.clone()),B=this.authoringInfo?.clone(),r=this.legendOptions?.clone();return new e({density:F,color:q,maxPathLength:g,trailWidth:w,flowSpeed:u,trailLength:C,trailCap:c,background:h,smoothing:d,flowRepresentation:b,visualVariables:z,authoringInfo:B,legendOptions:r})};K.getSymbol=function(F,g){};K.getSymbolAsync=function(){var F=M._asyncToGenerator(function*(g,
w){});return function(g,w){return F.apply(this,arguments)}}();K.getSymbols=function(){return[]};return y}(a.VisualVariablesMixin(n.JSONSupport));D.__decorate([P.property({type:Number,json:{write:!0}})],n.prototype,"density",void 0);D.__decorate([P.property({type:H,json:{write:{allowNull:!0}}})],n.prototype,"color",void 0);D.__decorate([P.property({type:Number,cast:R.toPt,json:{write:!0}})],n.prototype,"maxPathLength",void 0);D.__decorate([P.property({type:Number,cast:R.toPt,json:{write:!0}})],n.prototype,
"trailWidth",void 0);D.__decorate([P.property({type:Number,json:{write:!0}})],n.prototype,"flowSpeed",void 0);D.__decorate([P.property({type:Number,json:{write:!0}})],n.prototype,"trailLength",void 0);D.__decorate([P.property({type:Number,cast:R.toPt,json:{write:!1}})],n.prototype,"smoothing",void 0);D.__decorate([P.property({type:I.apiValues,json:{type:I.jsonValues,read:{reader:I.read},write:{writer:I.write}}})],n.prototype,"flowRepresentation",void 0);D.__decorate([k.enumeration({flowRenderer:"flow"})],
n.prototype,"type",void 0);D.__decorate([P.property({type:f,json:{write:!0}})],n.prototype,"authoringInfo",void 0);D.__decorate([P.property({type:m.LegendOptions,json:{write:!0}})],n.prototype,"legendOptions",void 0);D.__decorate([P.property({type:String,json:{write:!0}})],n.prototype,"trailCap",void 0);D.__decorate([P.property({type:String,json:{write:!0}})],n.prototype,"background",void 0);return n=e=D.__decorate([l.subclass("esri.renderers.FlowRenderer")],n)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k){var l;H=l=function(a){function f(e){e=a.call(this,e)||this;e.colormapInfos=null;e.type="raster-colormap";return e}M._inheritsLoose(f,a);f.createFromColormap=function(e,p){if(!e)return null;const y=5===e[0].length;e=[...e].sort(K=>K[0][0]-K[1][0]).map(K=>L.fromJSON({value:K[0],color:y?K.slice(1,5):K.slice(1,4).concat([255]),label:p?p[K[0]]??"":K[0]}));return new l({colormapInfos:e})};f.createFromColorramp=function(e){e=k.convertColorRampToColormap(e,256);return l.createFromColormap(e)};
var m=f.prototype;m.clone=function(){return new l({colormapInfos:this.colormapInfos.map(e=>e.toJSON())})};m.extractColormap=function(){return this.colormapInfos.map(({value:e,color:p})=>[e,p.r,p.g,p.b,1<p.a?p.a:255*p.a&255]).sort((e,p)=>e[0]-p[0])};return f}(H.JSONSupport);D.__decorate([I.property({type:[L],json:{write:!0}})],H.prototype,"colormapInfos",void 0);D.__decorate([P.enumeration({rasterColormap:"raster-colormap"})],H.prototype,"type",void 0);return H=l=D.__decorate([J.subclass("esri.renderers.RasterColormapRenderer")],
H)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(M,D,H,I,n,R,P,J){I=function(L){function k(){var l=L.apply(this,arguments)||this;l.value=null;l.label=null;l.color=null;return l}M._inheritsLoose(k,L);return k}(I.JSONSupport);
D.__decorate([n.property({type:Number,json:{write:!0}})],I.prototype,"value",void 0);D.__decorate([n.property({type:String,json:{write:!0}})],I.prototype,"label",void 0);D.__decorate([n.property({type:H,json:{type:[P.Integer],write:!0}})],I.prototype,"color",void 0);return I=D.__decorate([J.subclass("esri.renderers.support.ColormapInfo")],I)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils"],function(M,D,H){function I(e,p){if(!e||!p||e.length!==
p.length)return!1;for(let y=0;y<e.length;y++)if(e[y]>p[y]+2||e[y]<p[y]-2)return!1;return!0}function n(e,p){if(e){p=p?p:f;var y=null;"algorithmic"===e.type?p.some(K=>{if(I(e.fromColor.toRgb(),K.fromColor)&&I(e.toColor.toRgb(),K.toColor))return y=K.id,!0}):"multipart"===e.type&&p.some(K=>{const F=e.colorRamps,g=K.colorRamps;if(F&&g&&F.length===g.length&&!g.some((w,u)=>{if(!I(F[u].fromColor.toRgb(),(new D(w.fromColor)).toRgb())||!I(F[u].toColor.toRgb(),(new D(w.toColor)).toRgb()))return!0})){if(y)return!0;
y=K.id}});return y}}function R(e){return(e=n(e))?m[e]:null}function P(e){e=e||{};const p=e.numColors||256;return{...e,numColors:p,distanceOffset:e.distanceOffset||0,interpolateAlpha:!!e.interpolateAlpha,distanceInterval:e.distanceInterval||1/(p-1),isCustomInterval:null!=e.isCustomInterval?e.isCustomInterval:null!==e.distanceInterval&&e.distanceInterval!==1/(p-1),weights:e.weights}}function J(e,p){let {fromColor:y,toColor:K}=e;3===y.length&&(y=y.concat([255]));3===K.length&&(K=K.concat([255]));var F=
e.algorithm||"esriCIELabAlgorithm";const {numColors:g,distanceOffset:w,isCustomInterval:u,interpolateAlpha:C}=P(p);if(1===g&&0===w)return[y];if(2===g&&0===w&&!u)return[y,K];var d={r:y[0],g:y[1],b:y[2]};e={r:K[0],g:K[1],b:K[2]};if("esriCIELabAlgorithm"===F){F=H.toLAB(d);e=H.toLAB(e);const {numColors:q,distanceOffset:z,distanceInterval:B,isCustomInterval:r}=P(p);let {l:x,a:v,b:E}=F;F=(e.l-x)*B;d=(e.a-v)*B;p=(e.b-E)*B;var b=[];if(z){var c=z/B;x+=c*F;v+=c*d;E+=c*p}for(c=0;c<q-1;c++)b.push({l:x,a:v,b:E}),
x+=F,v+=d,E+=p;b.push(r?{l:x,a:v,b:E}:e);e=b}else if("esriHSVAlgorithm"===F){F=H.toHSV(d);e=H.toHSV(e);const {numColors:q,distanceOffset:z,distanceInterval:B,isCustomInterval:r}=P(p);b=0===F.s;c=0===e.s;d=F.h;p=e.h;b&&!c?d=p:c&&!b&&(e={...e,h:d},p=d);b=Math.abs(p-d);180>b?p=(p-d)*B:(b=360-b,p=d>p?b*B:-b*B);b=(e.s-F.s)*B;c=(e.v-F.v)*B;let {s:x,v}=F;F=d;z&&(d=z/B,F=(F+d*p+360)%360,x+=d*b,v+=d*c);d=[];for(var h=0;h<q-1;h++)d.push({h:F,s:x,v}),F=(F+p+360)%360,x+=b,v+=c;d.push(r?{h:F,s:x,v}:e);e=d}else{d=
H.toLCH(d);e=H.toLCH(e);const {numColors:q,distanceOffset:z,distanceInterval:B,isCustomInterval:r}=P(p);p=d.h;b=e.h;F=2*Math.PI;p<=b?(c=b-p,p=b-p-F,p=Math.abs(p)<Math.abs(c)?p:c):(c=b+F-p,p=b-p,p=Math.abs(p)<Math.abs(c)?p:c);p*=B;b=(e.l-d.l)*B;c=(e.c-d.c)*B;let {l:x,c:v,h:E}=d;z&&(d=z/B,x+=d*b,v+=d*c,E=(E+d*p+F)%F);d=[];for(h=0;h<q-1;h++)d.push({l:x,c:v,h:E}),x+=b,v+=c,E=(E+p+F)%F;d.push(r?{l:x,c:v,h:E}:e);e=d}F=[];d=y[3]??255;p=((K[3]??255)-d)/(g-1);for(b=0;b<g;b++){const {r:q,g:z,b:B}=H.toRGB(e[b]);
F.push([q,z,B,C?Math.round(d+p*b):255])}return F}function L(e,p){const {numColors:y,interpolateAlpha:K}=P(p);p=p?.weights;({colorRamps:e}=e);if(p){const b=p.reduce((c,h)=>c+h);p=p.map(c=>c/b)}else{p=[];for(var F=0;F<e.length;F++)p[F]=1/e.length}F=[];let g=0,w=0;const u=1/(y-1);let C=!1;for(let b=0;b<e.length;b++){var d=C?0:g*u-w;let c=b===e.length-1?y-1-g:(p[b]-d)/u;C=Math.ceil(c)===c;c=Math.ceil(c);0!==c&&(d/=p[b],d=J(e[b],{numColors:c,interpolateAlpha:K,distanceOffset:d,distanceInterval:u/p[b]}),
g+=d.length,F.push(...d),w+=p[b])}p=[...e[e.length-1].toColor];3===p.length&&p.push(255);F.push(p);return F}function k(e,p=256,y=!1){e="toJSON"in e?e.toJSON():e;p={numColors:p,interpolateAlpha:y};return"multipart"===e.type?L(e,p):J(e,p)}function l(e){if(e)return{Algorithm:e.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:a(e.fromColor),ToColor:a(e.toColor)}}function a(e){e=H.toHSV(e);return{type:"HsvColor",Hue:e.h,Saturation:e.s,Value:e.v,AlphaValue:255}}const f=[{id:"aspect_predefined",
type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},
{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",
colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",
colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,
128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,
102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},
{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,
63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},
{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],
toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",
fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,
53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",
type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},
{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",
colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,
167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],m={aspect_predefined:"Aspect",
blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",
conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",
partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",
redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",
yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"};M.PREDEFINED_COLOR_RAMP_NAME_MAP=m;M.PREDEFINED_JSON_COLOR_RAMPS=f;M.convertColorRampToColormap=function(e,p=256,y=!1){e=k(e,p,y);e.forEach((K,F)=>{K.unshift(F);y||K.pop()});return e};M.convertColorRampToColors=k;M.getColorRampId=n;M.getColorRampName=R;M.getRFxArgColorRampValue=function(e){const p=R(e);if(e){if("algorithmic"===e.type)return{...l(e),
Name:p};if(e.colorRamps)return e=e.colorRamps.map(l),{type:"MultiPartColorRamp",NumColorRamps:e.length,ArrayOfColorRamp:e,Name:p}}};M.rgbaConvertTo32Bit=function(e){e=e.reverse().map(p=>{p=p.toString(16);return 2>p.length?"0"+p:p});return 4294967295&Number.parseInt(e.join(""),16)};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/colorUtils":function(){define(["exports"],function(M){function D(k,l){const a=[];let f,m;if(k[0].length!==l.length)throw"dimensions do not match";
const e=k.length,p=k[0].length;let y=0;for(f=0;f<e;f++){for(m=y=0;m<p;m++)y+=k[f][m]*l[m];a.push(y)}return a}function H(k){k=[k.r/255,k.g/255,k.b/255].map(l=>.04045>=l?l/12.92:((l+.055)/1.055)**2.4);k=D(J,k);return{x:100*k[0],y:100*k[1],z:100*k[2]}}function I(k){k=D(L,[k.x/100,k.y/100,k.z/100]).map(l=>Math.min(1,Math.max(.0031308>=l?12.92*l:1.055*l**(1/2.4)-.055,0)));return{r:Math.round(255*k[0]),g:Math.round(255*k[1]),b:Math.round(255*k[2])}}function n(k){k=[k.x/95.047,k.y/100,k.z/108.883].map(l=>
l>(6/29)**3?l**(1/3):1/3*(29/6)**2*l+4/29);return{l:116*k[1]-16,a:500*(k[0]-k[1]),b:200*(k[1]-k[2])}}function R(k){const l=k.l;k=[(l+16)/116+k.a/500,(l+16)/116,(l+16)/116-k.b/200].map(a=>a>6/29?a**3:3*(6/29)**2*(a-4/29));return{x:95.047*k[0],y:100*k[1],z:108.883*k[2]}}function P(k){if("r"in k&&"g"in k&&"b"in k)return k;if("l"in k&&"c"in k&&"h"in k){var l=k.c,a=k.h;return I(R({l:k.l,a:l*Math.cos(a),b:l*Math.sin(a)}))}if("l"in k&&"a"in k&&"b"in k)return I(R(k));if("x"in k&&"y"in k&&"z"in k)return I(k);
if("h"in k&&"s"in k&&"v"in k){a=(k.h+360)%360/60;l=k.v/100*255;k=k.s/100*l;const f=k*(1-Math.abs(a%2-1));switch(Math.floor(a)){case 0:a={r:k,g:f,b:0};break;case 1:a={r:f,g:k,b:0};break;case 2:a={r:0,g:k,b:f};break;case 3:a={r:0,g:f,b:k};break;case 4:a={r:f,g:0,b:k};break;case 5:case 6:a={r:k,g:0,b:f};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+l-k);a.g=Math.round(a.g+l-k);a.b=Math.round(a.b+l-k);return a}return k}const J=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],L=[[3.2406,
-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];M.darken=function(k,l){k=n(H(k));k.l*=1-l;return I(R(k))};M.toHSV=function(k){if("h"in k&&"s"in k&&"v"in k)return k;var l=P(k);k=l.r;const a=l.g,f=l.b;l=Math.max(k,a,f);const m=l-Math.min(k,a,f);k=0===m?0:l===k?(a-f)/m%6:l===a?(f-k)/m+2:(k-a)/m+4;0>k&&(k+=6);return{h:60*k,s:100*(0===m?0:m/l),v:100/255*l}};M.toLAB=function(k){return"l"in k&&"a"in k&&"b"in k?k:n(H(P(k)))};M.toLCH=function(k){if(!("l"in k&&"c"in k&&"h"in k)){var l=n(H(P(k)));
k=l.l;var a=l.a;const f=l.b;l=Math.sqrt(a*a+f*f);a=Math.atan2(f,a);a=0<a?a:a+2*Math.PI;k={l:k,c:l,h:a}}return k};M.toRGB=P;M.toXYZ=function(k){return"x"in k&&"y"in k&&"z"in k?k:H(P(k))};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),
function(M,D,H,I,n,R,P,J,L,k){var l;H=l=function(a){function f(e){e=a.call(this,e)||this;e.altitude=45;e.azimuth=315;e.colorRamp=null;e.hillshadeType="traditional";e.pixelSizePower=.664;e.pixelSizeFactor=.024;e.scalingType="none";e.type="raster-shaded-relief";e.zFactor=1;return e}M._inheritsLoose(f,a);var m=f.prototype;m.readColorRamp=function(e){return k.fromJSON(e)};m.clone=function(){return new l({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,
scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:I.clone(this.colorRamp)})};return f}(H.JSONSupport);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"altitude",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"azimuth",void 0);D.__decorate([n.property({types:k.types,json:{write:!0}})],H.prototype,"colorRamp",void 0);D.__decorate([J.reader("colorRamp")],H.prototype,"readColorRamp",null);D.__decorate([n.property({type:["traditional",
"multi-directional"],json:{write:!0}})],H.prototype,"hillshadeType",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"pixelSizePower",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"pixelSizeFactor",void 0);D.__decorate([n.property({type:["none","adjusted"],json:{write:!0}})],H.prototype,"scalingType",void 0);D.__decorate([P.enumeration({rasterShadedRelief:"raster-shaded-relief"})],H.prototype,"type",void 0);D.__decorate([n.property({type:Number,
json:{write:!0}})],H.prototype,"zFactor",void 0);return H=l=D.__decorate([L.subclass("esri.renderers.RasterShadedReliefRenderer")],H)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a){var f;H=f=function(m){function e(y){y=m.call(this,y)||this;y.colorRamp=null;y.computeGamma=!1;y.dynamicRangeAdjustment=!1;y.gamma=[];y.maxPercent=null;y.minPercent=null;y.numberOfStandardDeviations=null;y.outputMax=null;y.outputMin=null;y.sigmoidStrengthLevel=null;y.statistics=[];y.histograms=null;y.useGamma=!1;y.stretchType="none";y.type="raster-stretch";return y}M._inheritsLoose(e,m);var p=e.prototype;p.readColorRamp=function(y){if(y)return a.fromJSON(y)};p.writeStatistics=
function(y,K,F){y?.length&&(Array.isArray(y[0])||(y=y.map(g=>[g.min,g.max,g.avg,g.stddev])),K[F]=y)};p.readStretchType=function(y,K){y=K.stretchType;"number"===typeof y&&(y=l.stretchTypeFunctionEnum[y]);return l.stretchTypeJSONDict.read(y)};p.clone=function(){return new f({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:I.clone(this.statistics),gamma:I.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,
numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:I.clone(this.colorRamp),histograms:I.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};return e}(H.JSONSupport);D.__decorate([n.property({types:a.types,json:{write:!0}})],H.prototype,"colorRamp",void 0);D.__decorate([J.reader("colorRamp")],H.prototype,"readColorRamp",null);D.__decorate([n.property({type:Boolean,json:{write:!0}})],H.prototype,"computeGamma",
void 0);D.__decorate([n.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],H.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([n.property({type:[Number],json:{write:!0}})],H.prototype,"gamma",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"maxPercent",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"minPercent",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"numberOfStandardDeviations",
void 0);D.__decorate([n.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],H.prototype,"outputMax",void 0);D.__decorate([n.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],H.prototype,"outputMin",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([n.property({json:{type:[[Number]],write:!0}})],H.prototype,"statistics",void 0);D.__decorate([n.property()],H.prototype,"histograms",void 0);
D.__decorate([k.writer("statistics")],H.prototype,"writeStatistics",null);D.__decorate([n.property({type:Boolean,json:{write:!0}})],H.prototype,"useGamma",void 0);D.__decorate([n.property({type:l.stretchTypeJSONDict.apiValues,json:{type:l.stretchTypeJSONDict.jsonValues,write:l.stretchTypeJSONDict.write}})],H.prototype,"stretchType",void 0);D.__decorate([J.reader("stretchType",["stretchType"])],H.prototype,"readStretchType",null);D.__decorate([P.enumeration({rasterStretch:"raster-stretch"})],H.prototype,
"type",void 0);return H=f=D.__decorate([L.subclass("esri.renderers.RasterStretchRenderer")],H)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(M,D){D=new D.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});M.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};
M.stretchTypeJSONDict=D;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../symbols/PictureMarkerSymbol ../geometry/Point".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u,C,d,b,c,h,q){var z;const B=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);I=new P.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
P=new P.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});J=z=function(r){function x(E){E=r.call(this,E)||this;E.attributeField="Magnitude";E.flowRepresentation="flow-from";E.rotationType="arithmetic";E.style="single-arrow";E.symbolTileSize=50;E.type="vector-field";return E}M._inheritsLoose(x,r);var v=x.prototype;v.readInputUnit=function(E,t){return B.has(E)?y.unitKebabDict.fromJSON(E):null};v.readOutputUnit=function(E,t){return B.has(E)?y.unitKebabDict.fromJSON(E):null};v.clone=function(){return new z({attributeField:this.attributeField,
flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:L.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})};v.getGraphicsFromPixelData=function(){var E=M._asyncToGenerator(function*(t,A=!1,O=[]){const N=[];var X=y.getUnitConversionFactor(this.inputUnit,this.outputUnit),V=this.rotationVariables[0]?.rotationType||this.rotationType;A=A?y.convertVectorFieldData(t.pixelBlock,"vector-uv",
V,X):y.convertVectorFieldUnit(t.pixelBlock,"vector-magdir",X);if(k.isNone(A))return N;t=t.extent;X=k.isSome(A.mask)&&0<A.mask.length;V=0;const W=(t.xmax-t.xmin)/A.width,G=(t.ymax-t.ymin)/A.height;for(let T=0;T<A.height;T++)for(let aa=0;aa<A.width;aa++,V++){let Z=new q({x:t.xmin+aa*W+W/2,y:t.ymax-T*G-G/2,spatialReference:t.spatialReference});Z=(yield p.normalizeCentralMeridian(Z))[0];var S=O.some(Q=>Q.intersects(Z));X&&!A.mask[V]||S||(S=new n({geometry:{type:"point",x:Z.x,y:Z.y,spatialReference:t.spatialReference},
attributes:{Magnitude:A.pixels[0][V],Direction:A.pixels[1][V]}}),S.symbol=this._getVisualVariablesAppliedSymbol(S),N.push(S))}return N});return function(t){return E.apply(this,arguments)}}();v.getSymbol=function(E,t){};v.getSymbolAsync=function(){var E=M._asyncToGenerator(function*(t,A){});return function(t,A){return E.apply(this,arguments)}}();v.getSymbols=function(){return[]};v.getClassBreakInfos=function(){return this.styleRenderer?.classBreakInfos};v.getDefaultSymbol=function(){return this.styleRenderer?.defaultSymbol};
v._getDefaultSymbol=function(E){return new b({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new d({width:0}),size:20,color:E||new H([0,92,230])})};v._getVisualVariablesAppliedSymbol=function(E){if(E){var t=this.styleRenderer?.getSymbol(E)?.clone(),A=this.sizeVariables,O=this.rotationVariables;A&&A.length&&this.sizeVariables.forEach(N=>c.applySizesToSymbol(t,C.getAllSizes([N],E)));O&&O.length&&(E.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||
"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(N=>c.applyRotationToSymbol(t,C.getRotationAngle(N,E),N.axis)));return t}};v._createStyleRenderer=function(E){let t={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(E){case "single-arrow":t=this._createSingleArrowRenderer();break;case "beaufort-kn":t=this._createBeaufortKnotsRenderer();break;case "beaufort-m":t=this._createBeaufortMeterRenderer();break;case "beaufort-ft":t=this._createBeaufortFeetRenderer();break;
case "beaufort-mi":t=this._createBeaufortMilesRenderer();break;case "beaufort-km":t=this._createBeaufortKilometersRenderer();break;case "ocean-current-m":t=this._createCurrentMeterRenderer();break;case "ocean-current-kn":t=this._createCurrentKnotsRenderer();break;case "simple-scalar":t=this._createSimpleScalarRenderer();break;case "wind-barb":t=this._createWindBarbsRenderer();break;case "classified-arrow":t=this._createClassifiedArrowRenderer()}return new K(t)};v._createSingleArrowRenderer=function(){return{defaultSymbol:this._getDefaultSymbol()}};
v._createBeaufortKnotsRenderer=function(){const E=this._getDefaultSymbol(new H([214,47,39])),t=this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:E,classBreakInfos:t}};v._createBeaufortMeterRenderer=function(){const E=this._getDefaultSymbol(new H([214,47,39])),t=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,
14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:E,classBreakInfos:t}};v._createBeaufortFeetRenderer=function(){const E=this._getDefaultSymbol(new H([214,47,39]));var t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];t=t.map(A=>3.28084*A);t=this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,
204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:E,classBreakInfos:t}};v._createBeaufortMilesRenderer=function(){const E=this._getDefaultSymbol(new H([214,47,39]));var t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];t=t.map(A=>2.23694*A);t=this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],
[232,21,21]]);return{defaultSymbol:E,classBreakInfos:t}};v._createBeaufortKilometersRenderer=function(){const E=this._getDefaultSymbol(new H([214,47,39]));var t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];t=t.map(A=>3.6*A);t=this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:E,classBreakInfos:t}};v._createCurrentMeterRenderer=function(){const E=
this._getDefaultSymbol(new H([177,177,177])),t=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:E,classBreakInfos:t}};v._createCurrentKnotsRenderer=function(){const E=this._getDefaultSymbol(new H([177,177,177])),t=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:E,classBreakInfos:t}};v._createClassifiedArrowRenderer=
function(){const E=this._getDefaultSymbol(new H([56,168,0]));var t=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const A=this.sizeVariables[0].minDataValue,O=this.sizeVariables[0].maxDataValue;if(A&&O){const N=(O-A)/5;t=Array.from(Array(6).keys()).map(X=>A+N*X)}}t=this._getClassBreaks(t,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:E,classBreakInfos:t}};v._createSimpleScalarRenderer=function(){return{defaultSymbol:h.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}};v._createWindBarbsRenderer=function(){const E=Array.from(Array(31).keys()).map(N=>5*N),t=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],A=h.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),O=E.map((N,X)=>{if(X!==E.length-1)if(0===X)var V={minValue:N,maxValue:E[X+1],symbol:A};else V=h.fromJSON({type:"esriPMS",imageData:t[X].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),V={minValue:N,maxValue:E[X+1],symbol:V};return new g(V)});return{defaultSymbol:A,classBreakInfos:O}};v._getClassBreaks=function(E,t){return t.map((A,O)=>new g({minValue:E[O],maxValue:E[O+1],symbol:this._getDefaultSymbol(new H(A))}))};M._createClass(x,[{key:"styleRenderer",
get:function(){const E=this.attributeField,t=this._createStyleRenderer(this.style);t.field=E;return t}},{key:"sizeVariables",get:function(){const E=[];if(this.visualVariables)for(var t of this.visualVariables)"size"===t.type&&E.push(t);0===E.length&&(t=new u({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(t):this._set("visualVariables",[t]),E.push(t));return E}},{key:"rotationVariables",get:function(){const E=[];if(this.visualVariables)for(var t of this.visualVariables)"rotation"===
t.type&&E.push(t);0===E.length&&(t=new w({field:"Direction",rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(t):this._set("visualVariables",[t]),E.push(t));return E}}]);return x}(F.VisualVariablesMixin(J.JSONSupport));D.__decorate([l.property({type:String,json:{write:!0}})],J.prototype,"attributeField",void 0);D.__decorate([l.property({type:P.apiValues,json:{type:P.jsonValues,read:{reader:P.read},write:{writer:P.write}}})],J.prototype,"flowRepresentation",void 0);D.__decorate([l.property({type:["geographic",
"arithmetic"],json:{write:!0}})],J.prototype,"rotationType",void 0);D.__decorate([l.property({type:I.apiValues,json:{type:I.jsonValues,read:{reader:I.read},write:{writer:I.write}}})],J.prototype,"style",void 0);D.__decorate([l.property({json:{write:!0}})],J.prototype,"symbolTileSize",void 0);D.__decorate([l.property({type:y.unitKebabDict.apiValues,json:{type:y.unitKebabDict.jsonValues,write:{writer:y.unitKebabDict.write}}})],J.prototype,"inputUnit",void 0);D.__decorate([m.reader("inputUnit")],J.prototype,
"readInputUnit",null);D.__decorate([l.property({type:y.unitKebabDict.apiValues,json:{type:y.unitKebabDict.jsonValues,read:{reader:y.unitKebabDict.read},write:{writer:y.unitKebabDict.write}}})],J.prototype,"outputUnit",void 0);D.__decorate([m.reader("outputUnit")],J.prototype,"readOutputUnit",null);D.__decorate([f.enumeration({vectorField:"vector-field"})],J.prototype,"type",void 0);D.__decorate([l.property({type:K})],J.prototype,"styleRenderer",null);D.__decorate([l.property({type:u})],J.prototype,
"sizeVariables",null);D.__decorate([l.property({type:w})],J.prototype,"rotationVariables",null);return J=z=D.__decorate([e.subclass("esri.renderers.VectorFieldRenderer")],J)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(M,D,H,I,n){function R(b,c){return y.get(b)/y.get(c)||1}function P(b,c="geographic"){const [h,q]=b;b=Math.sqrt(h*h+q*q);let z=Math.atan2(q,h)*K;z=(360+z)%
360;"geographic"===c&&(z=(450-z)%360);return[b,z]}function J(b,c="geographic"){let h=b[1];"geographic"===c&&(h=(450-h)%360);h%=360;b=b[0];return[b*Math.cos(h/K),b*Math.sin(h/K)]}function L(b,c,h="geographic",q=1){if(!n.isValidPixelBlock(b))return b;const {pixels:z,width:B,height:r}=b;var x=B*r;const v=z[0],E=z[1],t=b.pixelType.startsWith("f")?b.pixelType:"f32",A=I.createEmptyBand(t,x);x=I.createEmptyBand(t,x);let O=0;for(let N=0;N<r;N++)for(let X=0;X<B;X++)"vector-uv"===c?([A[O],x[O]]=P([v[O],E[O]],
h),A[O]*=q):([A[O],x[O]]=J([v[O],E[O]],h),A[O]*=q,x[O]*=q),O++;b=new I({pixelType:t,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:[A,x]});b.updateStatistics();return b}function k(b=0,c=0,h=Math.PI,q=!0){q&&(h=(2*Math.PI-h)%(2*Math.PI));q=q?-1:1;const z=-7*q,B=-2*q,r=-16*q,[x,v]=a(0,c+13*q,h,21.75),[E,t]=a(b-5.5,c+z,h,21.75),[A,O]=a(b+5.5,c+z,h,21.75),[N,X]=a(b-1.5,c+B,h,21.75),[V,W]=a(b+1.5,c+B,h,21.75),[G,S]=a(b-1.5,c+r,h,21.75),[T,aa]=
a(b+1.5,c+r,h,21.75);return[x,v,E,t,N,X,V,W,A,O,G,S,T,aa]}function l(b=0,c=Math.PI,h=!0){h&&(c=(2*Math.PI-c)%(2*Math.PI));var q=h?-1:1,z=5*q;const B=20*q,r=25*q;q*=2;const x=h?1:-1;h=5*x;let [v,E]=[0+h,0-B],[t,A]=[v+2*x,E],[O,N]=[t-0*x,A+q],[X,V]=[0-h,0-r],[W,G]=[X+0*x,V-q],S=Math.ceil(b/5),T=Math.floor(S/10);S-=8*T;b=[];const aa=[];for(let ma=0;ma<S/2;ma++,T--){0>=T&&1===S%2&&ma===(S-1)/2&&(X=0,W=X+0*x,V=(V+E)/2,G=V-q);const [na,ra]=a(X,V,c,45);if(0<T){const [ta,pa]=a(t,V,c,45),[qa,oa]=a(v,E,c,45);
b.push(ta);b.push(pa);b.push(na);b.push(ra);b.push(qa);b.push(oa)}else{const [ta,pa]=a(t,A,c,45),[qa,oa]=a(O,N,c,45),[U,ia]=a(W,G,c,45);aa.push(na);aa.push(ra);aa.push(U);aa.push(ia);aa.push(qa);aa.push(oa);aa.push(ta);aa.push(pa)}V+=z;E+=z;A+=z;N+=z;G+=z}const [Z,Q]=a(0+h,0+B,c,45);z=7*x;const [Y,ba]=a(0+z,0+B,c,45),[ca,fa]=a(0+h,0-r,c,45),[ha,ka]=a(0+z,0-r,c,45);return{pennants:b,barbs:aa,shaft:[Z,Q,Y,ba,ca,fa,ha,ka]}}function a(b,c,h,q=1){return[Math.sqrt(b*b+c*c)/q,(2*Math.PI+(2*Math.PI+Math.atan2(c,
b))%(2*Math.PI)-h)%(2*Math.PI)]}function f(b,c,h,q){h=R(q||"knots",h);for(q=1;q<c.length;q++)if(q===c.length-1){if(b<c[q]*h)break}else if(b<=c[q]*h)break;return Math.min(q-1,c.length-2)}function m(b,c,h,q,z){let B=0;switch(c){case "beaufort_kn":B=f(b,w,"knots",h);break;case "beaufort_km":B=f(b,w,"kilometer-per-hour",h);break;case "beaufort_ft":B=f(b,w,"feet-per-second",h);break;case "beaufort_m":B=f(b,w,"meter-per-second",h);break;case "classified_arrow":B=f(b,z??[],q,h);break;case "ocean_current_m":B=
f(b,u,"meter-per-second",h);break;case "ocean_current_kn":B=f(b,C,"knots",h)}return B}function e(b,c){const {style:h,inputUnit:q,outputUnit:z,breakValues:B}=c,r=F.fromJSON(q),x=F.fromJSON(z);let v=0,E=0;const {width:t,height:A,mask:O}=b,N=b.pixels[0];b=b.pixels[1];var X=H.isSome(O)?O.filter(G=>0<G).length:t*A;const V=new Float32Array(42*X);X=new Uint32Array(15*X);c=c.invertDirection?k(0,0,0,!1):g;for(let G=0;G<A;G++)for(let S=0;S<t;S++){var W=G*t+S;if(!O||O[G*t+S]){const T=(b[W]+360)%360/180*Math.PI,
aa=m(N[W],h,r,x,B);for(let Z=0;Z<c.length;Z+=2)V[v++]=(S+.5)/t,V[v++]=(G+.5)/A,V[v++]=c[Z],V[v++]=c[Z+1]+T,V[v++]=aa,V[v++]=N[W];W=7*(v/42-1);X[E++]=W;X[E++]=W+1;X[E++]=W+2;X[E++]=W+0;X[E++]=W+4;X[E++]=W+3;X[E++]=W+0;X[E++]=W+2;X[E++]=W+3;X[E++]=W+2;X[E++]=W+5;X[E++]=W+3;X[E++]=W+5;X[E++]=W+6;X[E++]=W+3}}return{vertexData:V,indexData:X}}function p(b,c){let h=0,q=0;const {width:z,height:B,mask:r}=b;b=b.pixels[0];const x=[],v=[];var E=F.fromJSON(c.inputUnit);E=R(E,"knots");c="wind_speed"===c.style?
5:Number.MAX_VALUE;for(let A=0;A<B;A++)for(let O=0;O<z;O++){var t=b[A*z+O]*E;if((!r||r[A*z+O])&&t<c){for(let N=0;4>N;N++)x[h++]=(O+.5)/z,x[h++]=(A+.5)/B,x[h++]=2>N?-.5:.5,x[h++]=0===N%2?-.5:.5,x[h++]=0,x[h++]=t;t=4*(h/24-1);v[q++]=t;v[q++]=t+1;v[q++]=t+2;v[q++]=t+1;v[q++]=t+2;v[q++]=t+3}}return{vertexData:new Float32Array(x),indexData:new Uint32Array(v)}}const y=new Map;y.set("meter-per-second",1);y.set("kilometer-per-hour",.277778);y.set("knots",.514444);y.set("feet-per-second",.3048);y.set("mile-per-hour",
.44704);const K=180/Math.PI,F=new D.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),g=k(0,0,0),w=[0,1,3,6,10,16,21,27,33,40,47,55,63],u=[0,.5,1,1.5,2],C=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],d=[];M.convertToLocalDirections=function(b,c,h,q="geographic"){if(!n.isValidPixelBlock(b)||H.isNone(h))return b;b="vector-magdir"===c?b.clone():H.unwrap(L(b,c));const z=b.pixels[1];for(let B=
0;B<z.length;B++)z[B]="geographic"===q?(z[B]+h[B]+270)%360:(z[B]+360-h[B])%360;return"vector-magdir"===c?b:L(b,"vector-magdir")};M.convertVectorFieldData=L;M.convertVectorFieldUnit=function(b,c,h=1){if(1===h||!n.isValidPixelBlock(b))return b;b=b.clone();const {pixels:q,width:z,height:B}=b,r=q[0],x=q[1];let v=0;for(let E=0;E<B;E++)for(let t=0;t<z;t++)"vector-uv"===c?(r[v]*=h,x[v]*=h):r[v]*=h,v++;b.updateStatistics();return b};M.createVFMesh=function(b,c){if("simple_scalar"===c.style)c=p(b,c);else if("wind_speed"===
c.style){if(0===d.length)for(var h=0;30>h;h++)d.push(l(5*h,0,!c.invertDirection));c=F.fromJSON(c.inputUnit);c=R(c,"knots");const {width:r,height:x,mask:v}=b;h=b.pixels[0];b=b.pixels[1];const E=[],t=[];let A=0,O=0;for(let N=0;N<x;N++)for(let X=0;X<r;X++){var q=N*r+X,z=h[q]*c;if((!v||v[N*r+X])&&5<=z){const V=(b[q]+360)%360/180*Math.PI,{pennants:W,barbs:G,shaft:S}=d[Math.min(Math.floor(z/5),29)];if(0===W.length+G.length)continue;q=E.length/6;const T=(X+.5)/r,aa=(N+.5)/x;for(var B=0;B<W.length;B+=2)E[A++]=
T,E[A++]=aa,E[A++]=W[B],E[A++]=W[B+1]+V,E[A++]=0,E[A++]=z;for(B=0;B<G.length;B+=2)E[A++]=T,E[A++]=aa,E[A++]=G[B],E[A++]=G[B+1]+V,E[A++]=0,E[A++]=z;for(B=0;B<S.length;B+=2)E[A++]=T,E[A++]=aa,E[A++]=S[B],E[A++]=S[B+1]+V,E[A++]=0,E[A++]=z;for(z=0;z<W.length/6;z++)t[O++]=q,t[O++]=q+1,t[O++]=q+2,q+=3;for(z=0;z<G.length/8;z++)t[O++]=q,t[O++]=q+1,t[O++]=q+2,t[O++]=q+1,t[O++]=q+2,t[O++]=q+3,q+=4;t[O++]=q+0;t[O++]=q+1;t[O++]=q+2;t[O++]=q+1;t[O++]=q+3;t[O++]=q+2;q+=4}}c={vertexData:new Float32Array(E),indexData:new Uint32Array(t)}}else c=
e(b,c);return c};M.createVFMeshScalar=p;M.getUnitConversionFactor=R;M.sampleVectorField=function(b,c,h,q=[0,0],z=.5){const {width:B,height:r,mask:x}=b,[v,E]=b.pixels,[t,A]=q;b=Math.round((B-t)/h);q=Math.round((r-A)/h);var O=b*q;const N=new Float32Array(O),X=new Float32Array(O);O=new Uint8Array(O);c="vector-uv"===c;for(let W=0;W<q;W++)for(let G=0;G<b;G++){let S=0;const T=W*b+G,aa=Math.max(0,W*h+A),Z=Math.max(0,G*h+t),Q=Math.min(r,aa+h),Y=Math.min(B,Z+h);for(let ba=aa;ba<Q;ba++)for(let ca=Z;ca<Y;ca++){var V=
ba*B+ca;if(!x||x[V]){S++;V=c?[v[V],E[V]]:[v[V],(360+E[V])%360];const [fa,ha]=c?V:J(V);N[T]+=fa;X[T]+=ha}}if(S>=(Q-aa)*(Y-Z)*(1-z)){O[T]=1;const [ba,ca]=P([N[T]/S,X[T]/S]);N[T]=ba;X[T]=ca}else O[T]=0,N[T]=0,X[T]=0}h=new I({width:b,height:q,pixels:[N,X],mask:O});h.updateStatistics();return h};M.snapImageToSymbolTile=function(b,c,h,q,z){if(H.isNone(z)||!z.spatialReference.equals(b.spatialReference))return{extent:b,width:Math.round(c/q),height:Math.round(h/q),resolution:b.width/c};const B=z.xmin;z=z.ymax;
c=(b.xmax-b.xmin)/c*q;h=(b.ymax-b.ymin)/h*q;b.xmin=B+Math.floor((b.xmin-B)/c)*c;b.xmax=B+Math.ceil((b.xmax-B)/c)*c;b.ymin=z+Math.floor((b.ymin-z)/h)*h;b.ymax=z+Math.ceil((b.ymax-z)/h)*h;return{extent:b,width:Math.round(b.width/c),height:Math.round(b.height/h),resolution:(c+h)/2}};M.unitKebabDict=F;M.uvComponentToVector=P;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l){var a;I=a=function(f){function m(p){p=f.call(this,p)||this;p.width=null;p.height=null;p.pixelType="f32";p.validPixelCount=null;p.mask=null;p.maskIsAlpha=!1;p.statistics=null;return p}M._inheritsLoose(m,f);m.createEmptyBand=function(p,y){return new (a.getPixelArrayConstructor(p))(y)};m.getPixelArrayConstructor=function(p){let y;switch(p){case "u1":case "u2":case "u4":case "u8":y=Uint8Array;break;case "u16":y=Uint16Array;break;case "u32":y=Uint32Array;break;case "s8":y=
Int8Array;break;case "s16":y=Int16Array;break;case "s32":y=Int32Array;break;case "f32":y=Float32Array;break;case "f64":y=Float64Array;break;case "c64":case "c128":case "unknown":y=Float32Array}return y};var e=m.prototype;e.castPixelType=function(p){if(!p)return"f32";p=p.toLowerCase();["u1","u2","u4"].includes(p)?p="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(p)||(p="f32");return p};e.getPlaneCount=function(){return this.pixels?.length};e.addData=function(p){if(!p.pixels||p.pixels.length!==
this.width*this.height)throw new H("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(p.pixels);this.statistics.push(p.statistics??new l.SimpleBandStatistics)};e.getAsRGBA=function(){const p=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(p);
break;default:this._fillFrom8Bit(p)}return new Uint8ClampedArray(p)};e.getAsRGBAFloat=function(){const p=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(p);return p};e.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(K=>this._calculateBandStatistics(K,this.mask));var p=this.mask,y=0;if(P.isSome(p))for(let K=0;K<p.length;K++)p[K]&&y++;else y=this.width*this.height;this.validPixelCount=y}};e.clamp=function(p){if(p&&"f64"!==p&&"f32"!==p&&this.pixels){switch(p){case "u8":var y=
[0,255];break;case "u16":y=[0,65535];break;case "u32":y=[0,4294967295];break;case "s8":y=[-128,127];break;case "s16":y=[-32768,32767];break;case "s32":y=[-2147483648,2147483647];break;default:y=[-3.4*1E39,3.4*1E39]}var [K,F]=y;y=this.pixels;var g=this.width*this.height,w=y.length,u=[];for(let c=0;c<w;c++){var C=a.createEmptyBand(p,g);var d=y[c];for(let h=0;h<g;h++){var b=d[h];C[h]=b>F?F:b<K?K:b}u.push(C)}this.pixels=u;this.pixelType=p}};e.extractBands=function(p){const {pixels:y,statistics:K}=this;
if(P.isNone(p)||0===p.length||!y||0===y.length)return this;var F=y.length;const g=p.some(w=>w>=y.length);F=F===p.length&&!p.some((w,u)=>w!==u);return g||F?this:new a({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:p.map(w=>y[w]),statistics:K&&p.map(w=>K[w])})};e.clone=function(){const p=new a({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
P.isSome(this.mask)&&(p.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let y;const K=a.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){p.pixels=[];const F=!!this.pixels[0].slice;for(y=0;y<this.pixels.length;y++)p.pixels[y]=F?this.pixels[y].slice(0,this.pixels[y].length):new K(this.pixels[y])}if(this.statistics)for(p.statistics=[],y=0;y<this.statistics.length;y++)p.statistics[y]=n.clone(this.statistics[y]);return p};e._fillFrom8Bit=
function(p){const {mask:y,maskIsAlpha:K,pixels:F}=this;if(p&&F&&F.length){var g,w;var u=g=w=F[0];3<=F.length?(g=F[1],w=F[2]):2===F.length&&(g=F[1]);var C=new Uint32Array(p),d=this.width*this.height;if(u.length!==d)R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(P.isSome(y)&&y.length===d)if(K)for(p=0;p<d;p++)y[p]&&(C[p]=y[p]<<24|w[p]<<16|g[p]<<8|u[p]);else for(p=0;p<d;p++)y[p]&&(C[p]=-16777216|w[p]<<16|g[p]<<8|u[p]);else for(p=0;p<
d;p++)C[p]=-16777216|w[p]<<16|g[p]<<8|u[p]}else R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};e._fillFromNon8Bit=function(p){const {pixels:y,mask:K,statistics:F}=this;if(p&&y&&y.length){var g=this.pixelType,w=1,u=0;w=1;if(F&&0<F.length){for(var C of F)null!=C.minValue&&(u=Math.min(u,C.minValue)),null!=C.maxValue&&null!=C.minValue&&(w=Math.max(w,C.maxValue-C.minValue));w=255/w}else w=255,"s8"===g?(u=-128,w=127):"u16"===g?w=65535:
"s16"===g?(u=-32768,w=32767):"u32"===g?w=4294967295:"s32"===g?(u=-2147483648,w=2147483647):"f32"===g?(u=-3.4*1E39,w=3.4*1E39):"f64"===g&&(u=-Number.MAX_VALUE,w=Number.MAX_VALUE),w=255/(w-u);p=new Uint32Array(p);g=this.width*this.height;var d,b,c;C=d=b=y[0];if(C.length!==g)return R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=y.length)if(d=y[1],3<=y.length&&(b=y[2]),P.isSome(K)&&K.length===g)for(c=0;c<g;c++)K[c]&&(p[c]=-16777216|(b[c]-
u)*w<<16|(d[c]-u)*w<<8|(C[c]-u)*w);else for(c=0;c<g;c++)p[c]=-16777216|(b[c]-u)*w<<16|(d[c]-u)*w<<8|(C[c]-u)*w;else if(P.isSome(K)&&K.length===g)for(c=0;c<g;c++)d=(C[c]-u)*w,K[c]&&(p[c]=-16777216|d<<16|d<<8|d);else for(c=0;c<g;c++)d=(C[c]-u)*w,p[c]=-16777216|d<<16|d<<8|d}else R.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};e._fillFrom32Bit=function(p){const {pixels:y,mask:K}=this;if(!p||!y||!y.length)return R.getLogger(this.declaredClass).error("getAsRGBAFloat()",
"Unable to convert to RGBA. The input pixel block is empty.");let F,g,w,u;F=g=w=y[0];3<=y.length?(g=y[1],w=y[2]):2===y.length&&(g=y[1]);const C=this.width*this.height;if(F.length!==C)return R.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let d=0;if(P.isSome(K)&&K.length===C)for(u=0;u<C;u++)p[d++]=F[u],p[d++]=g[u],p[d++]=w[u],p[d++]=K[u]&1;else for(u=0;u<C;u++)p[d++]=F[u],p[d++]=g[u],p[d++]=w[u],p[d++]=1};e._calculateBandStatistics=
function(p,y){let K=Infinity,F=-Infinity;const g=p.length;let w,u=0;if(P.isSome(y))for(w=0;w<g;w++)y[w]&&(u=p[w],K=u<K?u:K,F=u>F?u:F);else for(w=0;w<g;w++)u=p[w],K=u<K?u:K,F=u>F?u:F;return new l.SimpleBandStatistics(K,F)};return m}(I.JSONSupport);D.__decorate([J.property({json:{write:!0}})],I.prototype,"width",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"height",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"pixelType",void 0);D.__decorate([L.cast("pixelType")],
I.prototype,"castPixelType",null);D.__decorate([J.property({json:{write:!0}})],I.prototype,"validPixelCount",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"mask",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"maskIsAlpha",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"pixels",void 0);D.__decorate([J.property({json:{write:!0}})],I.prototype,"statistics",void 0);return I=a=D.__decorate([k.subclass("esri.layers.support.PixelBlock")],I)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],
function(M){M.SimpleBandStatistics=function(D=null,H=null,I=null){this.minValue=D;this.maxValue=H;this.noDataValue=I};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],function(M,D,H){function I(g){return D.isSome(g)&&"esri.layers.support.PixelBlock"===g.declaredClass&&g.pixels&&0<g.pixels.length}function n(g,w,u,C,d){const b=g.length;d=H.createEmptyBand(d,
b);if(w)for(let c=0;c<b;c++)w[c]&&(d[c]=u[g[c]-C]);else for(w=0;w<b;w++)d[w]=u[g[w]-C];return d}function R(g,w,u,C){const d=null!=u&&2<=u.length?new Set(u):null;u=1===u?.length?u[0]:null;const b=!!w?.length;for(let c=0;c<g.length;c++)if(C[c]){const h=g[c];if(b){let q=!1;for(let z=0;z<w.length;z+=2)if(h>=w[z]&&h<=w[z+1]){q=!0;break}q||(C[c]=0)}C[c]&&(h===u||d?.has(h))&&(C[c]=0)}}function P(g,w){const u=g[0].length;for(let C=0;C<u;C++)if(w[C]){let d=!1;for(let b=0;b<g.length;b++)if(g[b][C]){d=!0;break}d||
(w[C]=0)}}function J(g,w){const u=g[0].length;for(let C=0;C<u;C++)if(w[C]){let d=!1;for(let b=0;b<g.length;b++)if(0===g[b][C]){d=!0;break}d&&(w[C]=0)}}function L(g,w,u,C,d,b,c,h){return{xmin:d<=u*g?0:d<u*g+g?d-u*g:g,ymin:b<=C*w?0:b<C*w+w?b-C*w:w,xmax:d+c<=u*g?0:d+c<u*g+g?d+c-u*g:g,ymax:b+h<=C*w?0:b+h<C*w+w?b+h-C*w:w}}function k(g,w,u,C,d,b){const {width:c,height:h}=u.block,{x:q,y:z}=u.offset,{width:B,height:r}=u.mosaic;u=L(c,h,C,d,q,z,B,r);let x=0;var v=0;if(b){var E=b.hasGCSSShiftTransform?360:b.halfWorldWidth??
0,t=c*b.resolutionX;const A=b.startX+C*t;A<E&&A+t>E?v=b.rightPadding:A>=E&&(x=b.leftMargin-b.rightPadding,v=0)}u.xmax-=v;if("number"===typeof w)for(b=u.ymin;b<u.ymax;b++)for(v=(d*h+b-z)*B+(C*c-q)+x,E=u.xmin;E<u.xmax;E++)g[v+E]=w;else for(b=u.ymin;b<u.ymax;b++)for(v=(d*h+b-z)*B+(C*c-q)+x,E=b*c,t=u.xmin;t<u.xmax;t++)g[v+t]=w[E+t]}function l(g,w,u={}){const {clipOffset:C,clipSize:d,alignmentInfo:b,blockWidths:c}=u;if(c)return a(g,w,{blockWidths:c});var h=g.find(N=>I(N));if(D.isNone(h))return null;u=
d?d.width:w.width;const q=d?d.height:w.height;var z=h.width,B=h.height;const r=w.width/z,x=w.height/B;w={offset:C||{x:0,y:0},mosaic:d||w,block:{width:z,height:B}};z=h.pixelType;B=H.getPixelArrayConstructor(z);var v=h.pixels.length;h=[];for(var E=0;E<v;E++){var t=new B(u*q);for(let N=0;N<x;N++)for(let X=0;X<r;X++){var A=g[N*r+X];I(A)&&(A=A.pixels[E],k(t,A,w,X,N,b))}h.push(t)}let O;if(g.some(N=>D.isNone(N)||D.isSome(N.mask)&&0<N.mask.length))for(O=new Uint8Array(u*q),B=0;B<x;B++)for(v=0;v<r;v++)t=g[B*
r+v],E=D.isSome(t)?t.mask:null,D.isSome(E)?k(O,E,w,v,B,b):t?k(O,1,w,v,B,b):k(O,0,w,v,B,b);g=new H({width:u,height:q,pixels:h,pixelType:z,mask:O});g.updateStatistics();return g}function a(g,w,u){const C=g.find(v=>D.isSome(v));if(D.isNone(C))return null;var d=g.some(v=>D.isSome(v)?!!v.mask:!0);const {width:b,height:c}=w;w=d?new Uint8Array(b*c):null;({blockWidths:u}=u);const h=[],q=C.getPlaneCount(),z=H.getPixelArrayConstructor(C.pixelType);if(d)for(let v=0,E=0;v<g.length;E+=u[v],v++)if(d=g[v],I(d)){var B=
D.unwrap(d.mask);for(var r=0;r<c;r++)for(var x=0;x<u[v];x++)w[r*b+x+E]=null==B?255:B[r*d.width+x]}for(d=0;d<q;d++){B=new z(b*c);for(let v=0,E=0;v<g.length;E+=u[v],v++)if(r=g[v],I(r)&&(x=r.pixels[d],null!=x))for(let t=0;t<c;t++)for(let A=0;A<u[v];A++)B[t*b+A+E]=x[t*r.width+A];h.push(B)}g=new H({width:b,height:c,mask:w,pixels:h,pixelType:C.pixelType});g.updateStatistics();return g}function f(g){if(!I(g))return null;const w=g.clone(),{width:u,height:C,pixels:d}=g;var b=d[0];const c=w.pixels[0];g=D.unwrap(g.mask);
for(let z=2;z<C-1;z++){const B=new Map;for(var h=z-2;h<z+2;h++)for(var q=0;4>q;q++){const r=h*u+q;p(B,b[r],g?g[r]:1)}c[z*u]=m(B);c[z*u+1]=c[z*u+2]=c[z*u];for(h=3;h<u-1;h++)q=(z-2)*u+h+1,p(B,b[q],g?g[q]:1),q=(z-1)*u+h+1,p(B,b[q],g?g[q]:1),q=z*u+h+1,p(B,b[q],g?g[q]:1),q=(z+1)*u+h+1,p(B,b[q],g?g[q]:1),q=(z-2)*u+h-3,e(B,b[q],g?g[q]:1),q=(z-1)*u+h-3,e(B,b[q],g?g[q]:1),q=z*u+h-3,e(B,b[q],g?g[q]:1),q=(z+1)*u+h-3,e(B,b[q],g?g[q]:1),c[z*u+h]=m(B);c[z*u+h+1]=c[z*u+h]}for(b=0;b<u;b++)c[b]=c[u+b]=c[2*u+b],c[(C-
1)*u+b]=c[(C-2)*u+b];w.updateStatistics();return w}function m(g){if(0===g.size)return 0;let w=0,u=-1,C=0;const d=g.keys();let b=d.next();for(;!b.done;)C=g.get(b.value),C>w&&(u=b.value,w=C),b=d.next();return u}function e(g,w,u){0!==u&&(u=g.get(w),1===u?g.delete(w):g.set(w,u-1))}function p(g,w,u){0!==u&&g.set(w,g.has(w)?g.get(w)+1:1)}function y(g,w,u){let {x:C,y:d}=w;const {width:b,height:c}=u;if(0===C&&0===d&&c===g.height&&b===g.width)return g;const {width:h,height:q}=g;w=Math.max(0,d);const z=Math.max(0,
C),B=Math.min(C+b,h),r=Math.min(d+c,q);if(0>B||0>r||!I(g))return null;C=Math.max(0,-C);d=Math.max(0,-d);var {pixels:x}=g,v=b*c,E=x.length;const t=[];for(var A=0;A<E;A++){var O=x[A],N=H.createEmptyBand(g.pixelType,v);for(let X=w;X<r;X++){const V=X*h;let W=(X+d-w)*b+C;for(let G=z;G<B;G++)N[W++]=O[V+G]}t.push(N)}x=new Uint8Array(v);v=D.unwrap(g.mask);for(E=w;E<r;E++)for(A=E*h,O=(E+d-w)*b+C,N=z;N<B;N++)x[O++]=v?v[A+N]:1;g=new H({width:u.width,height:u.height,pixelType:g.pixelType,pixels:t,mask:x});g.updateStatistics();
return g}function K(g,w=!0){if(!I(g))return null;const {pixels:u,width:C,height:d,mask:b,pixelType:c}=g;g=[];const h=Math.round(C/2),q=Math.round(d/2),z=d-1,B=C-1;for(var r=0;r<u.length;r++){var x=u[r],v=H.createEmptyBand(c,h*q),E=0;for(var t=0;t<d;t+=2)for(var A=0;A<C;A+=2){var O=x[t*C+A];if(w){var N=A===B?O:x[t*C+A+1];const X=t===z?O:x[t*C+A+C],V=A===B?X:t===z?N:x[t*C+A+C+1];v[E++]=(O+N+X+V)/4}else v[E++]=O}g.push(v)}r=null;if(D.isSome(b))for(r=new Uint8Array(h*q),x=0,v=0;v<d;v+=2)for(E=0;E<C;E+=
2)t=b[v*C+E],w?(A=E===B?t:b[v*C+E+1],O=v===z?t:b[v*C+E+C],N=E===B?O:v===z?A:b[v*C+E+C+1],r[x++]=t*A*O*N?1:0):r[x++]=t;return new H({width:h,height:q,pixelType:c,pixels:g,mask:r})}function F(g,w,u,C,d=.5){const {width:b,height:c}=g,{width:h,height:q}=w;g=C.cols;C=C.rows;w=Math.ceil(h/g-.1/g);const z=Math.ceil(q/C-.1/C);let B,r,x,v,E;const t=w*g;var A=t*z*C;const O=new Float32Array(A),N=new Float32Array(A),X=new Uint32Array(A),V=new Uint32Array(A);let W=0,G,S;for(let Z=0;Z<z;Z++)for(let Q=0;Q<w;Q++){var T=
12*(Z*w+Q);A=u[T];B=u[T+1];r=u[T+2];x=u[T+3];v=u[T+4];E=u[T+5];for(var aa=0;aa<C;aa++){W=(Z*C+aa)*t+Q*g;S=(aa+.5)/C;for(let Y=0;Y<aa;Y++)G=(Y+.5)/g,O[W+Y]=(A*G+B*S+r)*b-d,N[W+Y]=(x*G+v*S+E)*c-d,X[W+Y]=Math.round(O[W+Y]),V[W+Y]=Math.round(N[W+Y])}T+=6;A=u[T];B=u[T+1];r=u[T+2];x=u[T+3];v=u[T+4];E=u[T+5];for(T=0;T<C;T++)for(W=(Z*C+T)*t+Q*g,S=(T+.5)/C,aa=T;aa<g;aa++)G=(aa+.5)/g,O[W+aa]=(A*G+B*S+r)*b-d,N[W+aa]=(x*G+v*S+E)*c-d,X[W+aa]=Math.round(O[W+aa]),V[W+aa]=Math.round(N[W+aa])}return{offsets_x:O,offsets_y:N,
offsets_xi:X,offsets_yi:V,gridWidth:t}}M.NoDataInterpretation=void 0;(function(g){g[g.matchAny=0]="matchAny";g[g.matchAll=1]="matchAll"})(M.NoDataInterpretation||(M.NoDataInterpretation={}));M.MissingBandAction=void 0;(function(g){g[g.bestMatch=0]="bestMatch";g[g.fail=1]="fail"})(M.MissingBandAction||(M.MissingBandAction={}));M.approximateTransform=function(g,w,u,C,d="nearest"){if(!I(g))return null;"majority"===d&&(g=f(g));const {pixels:b,mask:c,pixelType:h}=g,q=g.width;var z=g.height;const B=H.getPixelArrayConstructor(h),
r=b.length,{width:x,height:v}=w;g=!1;for(let V=0;V<u.length;V+=3)-1===u[V]&&-1===u[V+1]&&-1===u[V+2]&&(g=!0);const {offsets_x:E,offsets_y:t,offsets_xi:A,offsets_yi:O,gridWidth:N}=F({width:q,height:z},w,u,C,"majority"===d?0:.5);let X;w=(V,W,G)=>{const S=V instanceof Float32Array||V instanceof Float64Array?0:.5;for(let T=0;T<v;T++){X=T*N;for(let aa=0;aa<x;aa++){if(0>E[X]||0>t[X])V[T*x+aa]=0;else if(G)V[T*x+aa]=W[A[X]+O[X]*q];else{const Z=Math.floor(E[X]),Q=Math.floor(t[X]),Y=Math.ceil(E[X]),ba=Math.ceil(t[X]),
ca=E[X]-Z,fa=t[X]-Q;V[T*x+aa]=!c||c[Z+Q*q]&&c[Z+Q*q]&&c[Z+ba*q]&&c[Y+ba*q]?(1-fa)*((1-ca)*W[Z+Q*q]+ca*W[Y+Q*q])+fa*((1-ca)*W[Z+ba*q]+ca*W[Y+ba*q])+S:W[A[X]+O[X]*q]}X++}}};u=[];for(z=0;z<r;z++)C=new B(x*v),w(C,b[z],"nearest"===d||"majority"===d),u.push(C);d=new H({width:x,height:v,pixelType:h,pixels:u});if(D.isSome(c))d.mask=new Uint8Array(x*v),w(d.mask,c,!0);else if(g)for(d.mask=new Uint8Array(x*v),g=0;g<x*v;g++)d.mask[g]=0>E[g]||0>t[g]?0:1;d.updateStatistics();return d};M.clip=y;M.colorize=function(g,
w){if(!I(g)||!w||!w.indexedColormap&&!w.indexed2DColormap)return g;const u=g.clone();var C=u.pixels;let d=u.mask;const b=u.width*u.height;if(1!==C.length)return g;const {indexedColormap:c,indexed2DColormap:h,offset:q,alphaSpecified:z}=w;g=0;C=C[0];w=new Uint8Array(C.length);const B=new Uint8Array(C.length),r=new Uint8Array(C.length);var x=0;if(c){const v=c.length-1;if(D.isSome(d))for(g=0;g<b;g++)d[g]&&(x=4*(C[g]-q),x<q||x>v?d[g]=0:(w[g]=c[x],B[g]=c[x+1],r[g]=c[x+2],d[g]=c[x+3]));else{d=new Uint8Array(b);
for(g=0;g<b;g++)x=4*(C[g]-q),x<q||x>v?d[g]=0:(w[g]=c[x],B[g]=c[x+1],r[g]=c[x+2],d[g]=c[x+3]);u.mask=d}}else if(h)if(D.isSome(d))for(g=0;g<b;g++)d[g]&&(x=h[C[g]],w[g]=x[0],B[g]=x[1],r[g]=x[2],d[g]=x[3]);else{d=new Uint8Array(b);for(g=0;g<b;g++)x=h[C[g]],w[g]=x[0],B[g]=x[1],r[g]=x[2],d[g]=x[3];u.mask=d}u.pixels=[w,B,r];u.statistics=null;u.pixelType="u8";u.maskIsAlpha=z;return u};M.compositeBands=function(g){if(!g?.length||g.some(q=>!I(q)))return null;if(1===g.length)return D.isSome(g[0])?g[0].clone():
null;const {width:w,height:u,pixelType:C}=g[0];if(g.some(q=>q.width!==w||q.height!==u))return null;const d=g.map(({mask:q})=>q).filter(q=>null!=q);let b=null;d.length&&(b=new Uint8Array(w*u),b.set(d[0]),1<d.length&&J(d.slice(1),b));const c=[];g.forEach(({pixels:q})=>c.push(...q));const h=[];g.map(({statistics:q})=>q).filter(q=>q?.length).forEach(q=>h.push(...q));return new H({pixelType:C,width:w,height:u,mask:b,pixels:c,statistics:h.length?h:null})};M.createColormapLUT=function(g){if(g){var w=g.colormap;
if(w&&0!==w.length){w=w.sort((z,B)=>z[0]-B[0]);var u=0;0>w[0][0]&&(u=w[0][0]);var C=Math.max(256,w[w.length-1][0]-u+1),d=new Uint8Array(4*C),b=[],c=0,h=0,q=5===w[0].length;if(65536<C)return w.forEach(z=>{b[z[0]-u]=q?z.slice(1):z.slice(1).concat([255])}),{indexed2DColormap:b,offset:u,alphaSpecified:q};if(g.fillUnspecified)for(g=w[h],c=g[0]-u;c<C;c++)d[4*c]=g[1],d[4*c+1]=g[2],d[4*c+2]=g[3],d[4*c+3]=q?g[4]:255,c===g[0]-u&&(g=h===w.length-1?g:w[++h]);else for(c=0;c<w.length;c++)g=w[c],h=4*(g[0]-u),d[h]=
g[1],d[h+1]=g[2],d[h+2]=g[3],d[h+3]=q?g[4]:255;return{indexedColormap:d,offset:u,alphaSpecified:q}}}};M.createMaskLUT=function(g,w,u){if("u8"!==g&&"s8"!==g&&"u16"!==g&&"s16"!==g)return null;var C=g.includes("16")?65536:256;g=g.includes("s")?-C/2:0;C=new Uint8Array(C);if(w)for(let b=0;b<w.length;b++){var d=Math.ceil(w[2*b]-g);const c=Math.floor(w[2*b+1]-g);for(;d<=c;d++)C[d]=255}if(u)for(w=0;w<u.length;w++)C[u[w]-g]=0;return{lut:C,offset:g}};M.createRemapLUT=function(g,w,u){if("u8"!==g&&"s8"!==g&&
"u16"!==g&&"s16"!==g)return null;var C=g.includes("16")?65536:256;const d=g.includes("s")?-C/2:0;g=H.createEmptyBand(g,C);for(C=0;C<w.length;C++){const c=u[C];var b=Math.ceil(w[2*C]-d);const h=Math.floor(w[2*C+1]-d);for(;b<=h;b++)g[b]=c}return{lut:g,offset:d}};M.extractBands=function(g,w){if(!w?.length||!I(g))return g;const u=g.pixels.length;return w&&w.some(C=>C>=u)||1===u&&1===w.length&&0===w[0]||u===w.length&&!w.some((C,d)=>C!==d)?g:new H({pixelType:g.pixelType,width:g.width,height:g.height,mask:g.mask,
validPixelCount:g.validPixelCount,maskIsAlpha:g.maskIsAlpha,pixels:w.map(C=>g.pixels[C]),statistics:g.statistics&&w.map(C=>g.statistics[C])})};M.getClipBounds=L;M.getLocalArithmeticNorthRotations=function(g,w){const {coefficients:u,spacing:C}=w,{offsets_x:d,offsets_y:b,gridWidth:c}=F(g,g,u,{rows:C[0],cols:C[1]},.5),{width:h,height:q}=g;g=new Float32Array(h*q);w=180/Math.PI;for(let r=0;r<q;r++)for(let x=0;x<h;x++){var z=r*c+x,B=0===r?z:z-c;const v=r===q-1?z:z+c;z=d[B]-d[v];B=b[v]-b[B];isNaN(z)||isNaN(B)?
g[r*h+x]=90:(B=Math.atan2(B,z)*w,B=(360+B)%360,g[r*h+x]=B)}return g};M.isValidPixelBlock=I;M.lookupBandValues=n;M.lookupPixels=function(g,w){if(!I(g))return null;const {pixels:u,mask:C}=g,d=u.length;let b=w.lut;const {offset:c}=w;b&&1===b[0].length&&(b=u.map(()=>b));const h=[];w=w.outputPixelType||"u8";for(let q=0;q<d;q++){const z=n(u[q],C,b[q],c||0,w);h.push(z)}g=new H({width:g.width,height:g.height,pixels:h,mask:C,pixelType:w});g.updateStatistics();return g};M.mask=function(g,w){if(!I(g))return null;
const {width:u,height:C,pixels:d}=g;var b=u*C;const c=new Uint8Array(b);g.mask?c.set(g.mask):c.fill(255);g=d.length;const {includedRanges:h,noDataValues:q,outputPixelType:z,matchAll:B,lookup:r}=w;if(r){b=[];for(w=0;w<g;w++){var x=n(d[w],c,r.lut,r.offset||0,"u8");b.push(x)}1===b.length?c.set(b[0]):B?P(b,c):J(b,c)}else if(B){w=[];for(x=0;x<g;x++){const v=new Uint8Array(b);v.set(c);R(d[x],h,q,v);w.push(v)}1===w.length?c.set(w[0]):P(w,c)}else for(b=0;b<g;b++)R(d[b],h,q,c);return new H({width:u,height:C,
pixelType:z,pixels:d,mask:c})};M.mosaic=l;M.mosaicPixelData=function(g,w){if(!g||0===g.length)return null;var u=g.find(r=>r.pixelBlock);if(!u||D.isNone(u.pixelBlock))return null;var C=(u.extent.xmax-u.extent.xmin)/u.pixelBlock.width;const d=(u.extent.ymax-u.extent.ymin)/u.pixelBlock.height,b=.01*Math.min(C,d),c=g.sort((r,x)=>Math.abs(r.extent.ymax-x.extent.ymax)>b?x.extent.ymax-r.extent.ymax:Math.abs(r.extent.xmin-x.extent.xmin)>b?r.extent.xmin-x.extent.xmin:0);var h=Math.min.apply(null,c.map(r=>
r.extent.xmin));const q=Math.min.apply(null,c.map(r=>r.extent.ymin)),z=Math.max.apply(null,c.map(r=>r.extent.xmax)),B=Math.max.apply(null,c.map(r=>r.extent.ymax));g={x:Math.round((w.xmin-h)/C),y:Math.round((B-w.ymax)/d)};h={width:Math.round((z-h)/C),height:Math.round((B-q)/d)};C={width:Math.round((w.xmax-w.xmin)/C),height:Math.round((w.ymax-w.ymin)/d)};if(Math.round(h.width/u.pixelBlock.width)*Math.round(h.height/u.pixelBlock.height)!==c.length||0>g.x||0>g.y||h.width<C.width||h.height<C.height)return null;
u=c.map(r=>r.pixelBlock);u=l(u,h,{clipOffset:g,clipSize:C});return{extent:w,pixelBlock:u}};M.remap=function(g,w){if(!I(g))return null;const {width:u,height:C}=g,{inputRanges:d,outputValues:b,outputPixelType:c,noDataRanges:h,allowUnmatched:q}=w;w=g.pixels[0];const z=H.createEmptyBand(c,w.length);q&&z.set(w);g=g.mask;const B=d.length/2;for(var r=0;r<C;r++)for(var x=0;x<u;x++){var v=r*u+x;if(!g||g[v]){var E=w[v];for(var t=B-1;0<=t;t--)if(E>=d[2*t]&&E<=d[2*t+1]){z[v]=b[t];break}}}r=g;if(h?.length)for(r=
new Uint8Array(u*C),g&&r.set(g),x=0;x<C;x++)for(v=0;v<u;v++)if(E=x*u+v,!g||g[E]){t=w[E];for(let A=0;A<B;A+=2)if(t>=h[A]&&t<=h[A+1]){z[E]=0;r[E]=0;break}}return new H({width:u,height:C,pixelType:c,pixels:[z],mask:r})};M.remapColor=function(g,w){if(!I(g))return null;g=g.clone();var {pixels:u}=g;const C=g.width*g.height,d=w.length,b=Math.floor(d/2),c=w[Math.floor(b)];u=u[0];let h,q,z,B,r,x,v=!1;const E=new Uint8Array(C),t=new Uint8Array(C),A=new Uint8Array(C);let O=g.mask;const N=4===w[0].mappedColor.length;
O||(O=new Uint8Array(C),O.fill(N?255:1),g.mask=O);for(r=0;r<C;r++)if(O[r]){h=u[r];v=!1;x=b;q=c;z=0;for(B=d-1;1<B-z;){if(h===q.value){v=!0;break}h>q.value?z=x:B=x;x=Math.floor((z+B)/2);q=w[Math.floor(x)]}v||(h===w[z].value?(q=w[z],v=!0):h===w[B].value?(q=w[B],v=!0):h<w[z].value?(v=!1,q=null):h>w[z].value&&(h<w[B].value?(q=w[z],v=!0):B===d-1?(v=!1,q=null):(q=w[B],v=!0)));v?(E[r]=q.mappedColor[0],t[r]=q.mappedColor[1],A[r]=q.mappedColor[2],O[r]=q.mappedColor[3]):E[r]=t[r]=A[r]=O[r]=0}g.pixels=[E,t,A];
g.mask=O;g.pixelType="u8";g.maskIsAlpha=N;return g};M.resampleByMajority=f;M.setValidBoundary=function(g,w,u){if(!I(g))return null;const {width:C,height:d}=g,b=w.x;w=w.y;const c=u.width+b;u=u.height+w;if(0>b||0>w||c>C||u>d||0===b&&0===w&&c===C&&u===d)return g;g.mask||(g.mask=new Uint8Array(C*d));const h=g.mask;for(let q=0;q<d;q++){const z=q*C;for(let B=0;B<C;B++)h[z+B]=q<w||q>=u||B<b||B>=c?0:1}g.updateStatistics();return g};M.split=function(g,w,u){if(!I(g))return null;const {width:C,height:d}=w;let {width:b,
height:c}=g;const h=new Map,q={x:0,y:0};u=null==u?1:1+u;for(let z=0;z<u;z++){const B=Math.ceil(b/C),r=Math.ceil(c/d);for(let x=0;x<r;x++){q.y=x*d;for(let v=0;v<B;v++){q.x=v*C;const E=y(g,q,w);h.set(`${z}/${x}/${v}`,E)}}z<u-1&&(g=K(g));b=Math.round(b/2);c=Math.round(c/2)}return h};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f){function m(r){r=r.symbolLayers;if(!r)return null;let x=null;r.forEach(v=>{if("object"!==v.type||null==v.resource?.href)x="water"===v.type?J.unwrap(v.color):J.isSome(v.material)?J.unwrap(v.material.color):null});return x?new I(x):null}function e(r,x){if(null==x||null==r)return r;r=r.toRgba();r[3]*=x;return new I(r)}function p(r,x,v){if(r=r.symbolLayers){var E=t=>{t=J.isSome(t)?t:null;x=x??t??(null!=v?B:null);return e(x,v)};r.forEach(t=>{if("object"!==t.type||null==
t.resource?.href||x)if("water"===t.type)t.color=E(t.color);else{var A=J.isSome(t.material)?t.material.color:null;A=E(A);J.isNone(t.material)?t.material=new f.Symbol3DMaterial({color:A}):t.material.color=A;null!=v&&"outline"in t&&J.isSome(t.outline)&&J.isSome(t.outline.color)&&(t.outline.color=e(t.outline.color,v))}})}}function y(r,x){return K.apply(this,arguments)}function K(){K=H._asyncToGenerator(function*(r,x){(r=r.symbolLayers)&&(yield R.forEach(r,function(){var v=H._asyncToGenerator(function*(E){return F(E,
x)});return function(E){return v.apply(this,arguments)}}()))});return K.apply(this,arguments)}function F(r,x){return g.apply(this,arguments)}function g(){g=H._asyncToGenerator(function*(r,x){switch(r.type){case "extrude":r.size="number"===typeof x[2]?x[2]:0;break;case "icon":case "line":case "text":x=w(x);J.isSome(x)&&(r.size=x);break;case "path":const v=d(x,k.ONES,[r.width,void 0,r.height]);r.width=h(x[0],r.width,1,v);r.height=h(x[2],r.height,1,v);break;case "object":yield u(r,x)}});return g.apply(this,
arguments)}function w(r){for(const x of r)if("number"===typeof x)return x;return null}function u(r,x){return C.apply(this,arguments)}function C(){C=H._asyncToGenerator(function*(r,x){const {resourceSize:v,symbolSize:E}=yield b(r),t=d(x,v,E);r.width=h(x[0],E[0],v[0],t);r.depth=h(x[1],E[1],v[1],t);r.height=h(x[2],E[2],v[2],t)});return C.apply(this,arguments)}function d(r,x,v){for(let E=0;3>E;E++){const t=r[E];switch(t){case "symbol-value":return r=v[E],null!=r?r/x[E]:1;case "proportional":break;default:if(t&&
x[E])return t/x[E]}}return 1}function b(r){return c.apply(this,arguments)}function c(){c=H._asyncToGenerator(function*(r){const x=yield(yield new Promise((N,X)=>M(["./symbolLayerUtils"],N,X))).computeObjectLayerResourceSize(r,10),{width:v,height:E,depth:t}=r;r=[v,t,E];let A=1;for(var O=0;3>O;O++){const N=r[O];if(null!=N){A=N/x[O];break}}for(O=0;3>O;O++)null==r[O]&&(r[O]=x[O]*A);return{resourceSize:x,symbolSize:r}});return c.apply(this,arguments)}function h(r,x,v,E){switch(r){case "proportional":return v*
E;case "symbol-value":return null!=x?x:v;default:return r}}function q(){q=H._asyncToGenerator(function*(r,x){if(r&&x){if(n.isSymbol3D(r))return y(r,x);if(n.isSymbol2D(r)&&(x=w(x),!J.isNone(x)))switch(r.type){case "simple-marker":r.size=x;break;case "picture-marker":const v=r.width/r.height;1<v?(r.width=x,r.height=x*v):(r.width=x*v,r.height=x);break;case "simple-line":r.width=x;break;case "text":r.font.size=x}}});return q.apply(this,arguments)}const z=/\/resource\/(.*?)\.svg$/,B=new I("white");D.applyColorToSymbol=
function(r,x,v){if(r&&(x||null!=v))if(x&&(x=new I(x)),n.isSymbol3D(r))p(r,x,v);else if(n.isSymbol2D(r)){if(x=x??r.color)r.color=e(x,v);null!=v&&"outline"in r&&r.outline&&r.outline.color&&(r.outline.color=e(r.outline.color,v))}};D.applyOpacityToColor=e;D.applyRotationToSymbol=function(r,x,v){r&&null!=x&&(n.isSymbol3D(r)?(r=r.symbolLayers)&&r.forEach(E=>{if(E&&"object"===E.type)switch(v){case "tilt":E.tilt=x;break;case "roll":E.roll=x;break;default:E.heading=x}}):!n.isSymbol2D(r)||"simple-marker"!==
r.type&&"picture-marker"!==r.type&&"text"!==r.type||(r.angle=x))};D.applySizesToSymbol=function(r,x){return q.apply(this,arguments)};D.getCSSFilterFromEffectList=function(r){if(!r)return null;r=r.effects.filter(x=>"bloom"!==x.type).map(x=>x.toJSON());return l.effectFunctionsFromJSON(r)};D.getColorFromSymbol=function(r,x){if(!r)return null;let v=null;n.isSymbol3D(r)?v=m(r):n.isSymbol2D(r)&&(v=r.color?new I(r.color):null);return v?e(v,x):null};D.getIconHref=function(r,x){x=J.unwrapOrThrow(x.resource).href;
return!P("esri-canvas-svg-support")&&r.styleOrigin&&z.test(x)?x.replace(z,"/resource/png/$1.png"):x};D.getSymbolOutlineSize=function(r){if(!r)return 0;if(n.isSymbol3D(r)){{const x=r.symbolLayers&&r.symbolLayers.length;x?(r=r.symbolLayers.getItemAt(x-1),r="outline"in r?J.get(r,"outline","size"):void 0):r=void 0}return J.isSome(r)?r:0}return L.px2pt(a.getStroke(r)?.width)};D.isVolumetricSymbol=function(r){if(J.isNone(r)||!("symbolLayers"in r)||J.isNone(r.symbolLayers))return!1;switch(r.type){case "point-3d":return r.symbolLayers.some(x=>
"object"===x.type);case "line-3d":return r.symbolLayers.some(x=>"path"===x.type);case "polygon-3d":return r.symbolLayers.some(x=>"object"===x.type||"extrude"===x.type);default:return!1}};D.symbolHasExtrudeSymbolLayer=function(r){return J.isSome(r)&&"polygon-3d"===r.type&&r.symbolLayers.some(x=>"extrude"===x.type)};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(M,D,H,I,n,R,P){function J(l){if(!l)return null;let a=null;switch(l.type){case "simple-fill":case "picture-fill":case "simple-marker":a=J(l.outline);break;case "simple-line":const f=R.pt2px(l.width);null!=l.style&&"none"!==l.style&&0!==f&&(a={color:l.color,style:k(l.style),width:f,cap:l.cap,join:"miter"===l.join?R.pt2px(l.miterLimit):l.join});break;default:a=null}return a}const L=new n(1E3),k=(()=>{const l={};return a=>{if(l[a])return l[a];const f=a.replace(/-/g,"");return l[a]=f}})();H=new H([128,
128,128]);M.defaultThematicColor=H;M.dekebabifyLineStyle=k;M.getFill=function(l){const a=l.style;let f=null;if(l)switch(l.type){case "simple-marker":"cross"!==a&&"x"!==a&&(f=l.color);break;case "simple-fill":"solid"===a?f=l.color:"none"!==a&&(f={type:"pattern",x:0,y:0,src:D.getAssetUrl(`esri/symbols/patterns/${a}.png`),width:5,height:5});break;case "picture-fill":f={type:"pattern",src:l.url,width:R.pt2px(l.width)*l.xscale,height:R.pt2px(l.height)*l.yscale,x:R.pt2px(l.xoffset),y:R.pt2px(l.yoffset)};
break;case "text":f=l.color;break;case "cim":f=P.getCIMSymbolColor(l)}return f};M.getPatternUrlWithColor=function(l,a){const f=l+"-"+a;return void 0!==L.get(f)?Promise.resolve(L.get(f)):I(l,{responseType:"image"}).then(m=>{m=m.data;const e=m.naturalWidth,p=m.naturalHeight,y=document.createElement("canvas");y.width=e;y.height=p;const K=y.getContext("2d");K.fillStyle=a;K.fillRect(0,0,e,p);K.globalCompositeOperation="destination-in";K.drawImage(m,0,0);m=y.toDataURL();L.put(f,m);return m})};M.getStroke=
J;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(M){return function(){function D(I,n){this._storage=new M.MemCacheStorage;this._storage.maxSize=I;n&&this._storage.registerRemoveFunc("",n)}var H=D.prototype;H.put=function(I,n){this._storage.put(I,n,1,1)};H.pop=function(I){return this._storage.pop(I)};H.get=function(I){return this._storage.get(I)};H.clear=function(){this._storage.clearAll()};
H.destroy=function(){this._storage.destroy()};return D}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(M,D,H){function I(a){a=H.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let f=0;if(a?.symbolLayers)for(const m of a.symbolLayers)H.isCIMMarker(m)&&null!=m.size&&m.size>f?f=m.size:H.isCIMStroke(m)&&null!=m.width&&m.width>f?f=m.width:H.isCIMFill(m);return f}function n(a,f,m,e){if(a)if("CIMTextSymbol"===a.type)null!=
a.height&&(a.height*=f);else{if(m&&a.effects)for(const p of a.effects)J(p,f);if(a.symbolLayers)for(const p of a.symbolLayers)switch(p.type){case "CIMPictureMarker":case "CIMVectorMarker":R(p,f,e);break;case "CIMPictureStroke":case "CIMSolidStroke":!e?.preserveOutlineWidth&&p.width&&(p.width*=f);break;case "CIMPictureFill":p.height&&(p.height*=f);p.offsetX&&(p.offsetX*=f);p.offsetY&&(p.offsetY*=f);break;case "CIMHatchFill":n(p.lineSymbol,f,!0,{...e,preserveOutlineWidth:!1}),p.offsetX&&(p.offsetX*=
f),p.offsetY&&(p.offsetY*=f),p.separation&&(p.separation*=f)}}}function R(a,f,m){if(a&&(a.markerPlacement&&P(a.markerPlacement,f),a.offsetX&&(a.offsetX*=f),a.offsetY&&(a.offsetY*=f),a.anchorPoint&&"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*f,y:a.anchorPoint.y*f}),a.size=null!=a.size?a.size*f:0,"CIMVectorMarker"===a.type&&a.markerGraphics))for(const e of a.markerGraphics)a.scaleSymbolsProportionally||n(e.symbol,f,!0,m)}function P(a,f){H.isCIMMarkerStrokePlacement(a)&&a.offset&&
(a.offset*=f);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=f);a.offsetAlongLine&&(a.offsetAlongLine*=f);if(a.placementTemplate&&a.placementTemplate.length){var m=a.placementTemplate.map(e=>e*f);a.placementTemplate=m}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&(a.maxRandomOffset*=f);a.placementTemplate&&a.placementTemplate.length&&(m=a.placementTemplate.map(e=>e*f),a.placementTemplate=
m);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=f);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=f);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&(a.beginPosition*=f);a.endPosition&&(a.endPosition*=f);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=f);a.offsetY&&(a.offsetY*=f);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&(a.offsetX*=f),a.offsetY&&(a.offsetY*=f),a.stepX&&(a.stepX*=
f),a.stepY&&(a.stepY*=f)}}function J(a,f){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=f);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=f);break;case "CIMGeometricEffectCut":a.beginCut&&(a.beginCut*=f);a.endCut&&(a.endCut*=f);a.middleCut&&(a.middleCut*=f);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&(a.customEndingOffset*=f);a.offsetAlongLine&&(a.offsetAlongLine*=f);if(a.dashTemplate&&a.dashTemplate.length){const m=a.dashTemplate.map(e=>
e*f);a.dashTemplate=m}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=f);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=f);a.offsetY&&(a.offsetY*=f);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=f);break;case "CIMGeometricEffectRegularPolygon":a.radius&&(a.radius*=f);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&(a.fromWidth*=f);a.length&&(a.length*=
f);a.toWidth&&(a.toWidth*=f);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=f),a.period&&(a.period*=f)}}function L(a,f){if(a){var m="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(m?.symbolLayers)for(const e of m.symbolLayers)if(!(e.colorLocked||a&&(H.isCIMStroke(e)||H.isCIMMarker(e)&&e.markerPlacement&&H.isCIMMarkerStrokePlacement(e.markerPlacement))))switch(e.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":e.tintColor&&k(f,e.tintColor);
break;case "CIMVectorMarker":e.markerGraphics?.forEach(p=>{L(p.symbol,f)});break;case "CIMSolidStroke":case "CIMSolidFill":k(f,e.color);break;case "CIMHatchFill":L(e.lineSymbol,f)}}}function k(a,f){for(const m of a)if(m.join(".")===f.join("."))return;a.push(f)}function l(a,f,m){if(a){var e="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===e?.type;if(e?.symbolLayers)for(const p of e.symbolLayers)if(!p.colorLocked){if(a)if(m){if({layersToColor:e}=m,(H.isCIMStroke(p)||H.isCIMMarker(p)&&p.markerPlacement&&
H.isCIMMarkerStrokePlacement(p.markerPlacement))&&"fill"===e||H.isCIMFill(p)&&"outline"===e)continue}else if(H.isCIMStroke(p)||H.isCIMMarker(p)&&p.markerPlacement&&H.isCIMMarkerStrokePlacement(p.markerPlacement))continue;e=f.toArray();switch(p.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":p.tintColor=e;break;case "CIMVectorMarker":p.markerGraphics?.forEach(y=>{l(y.symbol,f,m)});break;case "CIMSolidStroke":case "CIMSolidFill":p.color=e;break;case "CIMHatchFill":l(p.lineSymbol,
f,m)}}}}M.applyCIMSymbolColor=function(a,f,m){f instanceof D||(f=new D(f));(a=H.toCIMSymbolJSON(a))&&l(a,f,m)};M.applyCIMSymbolRotation=function(a,f,m=!1){a=H.toCIMSymbolJSON(a);m&&0!==f&&(f=360-f);if("CIMTextSymbol"===a?.type)a.angle=f;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){m=f-(a.angle||0);for(const e of a.symbolLayers)if(H.isCIMMarker(e)){let p=e.rotation||0;p=e.rotateClockwise?p-m:p+m;e.rotation=p}a.angle=f}};M.getCIMSymbolColor=function(a){a=H.toCIMSymbolJSON(a);const f=[];L(a,f);
return f.length?new D(H.fromCIMColor(f[0])):null};M.getCIMSymbolRotation=function(a,f=!1){a=H.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&f?360-a:a??0):0};M.getCIMSymbolSize=I;M.getCIMSymbolType=function(a){a=H.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};M.scaleCIMMarker=R;M.scaleCIMSymbol=n;M.scaleCIMSymbolTo=function(a,f,m){if(a){var e=H.toCIMSymbolJSON(a);a=I(a);if(0===a){if(e)if("CIMTextSymbol"===e.type)e.height=f;else if(e.symbolLayers)for(const p of e.symbolLayers)switch(p.type){case "CIMPictureMarker":case "CIMVectorMarker":p.size=f;break;case "CIMPictureStroke":case "CIMSolidStroke":p.width=f}}else n(e,f/a,!1,m)}};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(M,D){function H(k){let l=k.length;for(;l--;)if(!" /-,\n".includes(k.charAt(l)))return!1;return!0}function I(k,l){const a=[];var f=0;let m=-1;do m=k.indexOf("[",f),m>=f&&(m>f&&(f=k.substr(f,m-f),a.push([f,null,H(f)])),f=m+1,m=k.indexOf("]",f),m>=f&&(m>f&&(f=k.substr(f,m-f),(f=l[f])&&a.push([null,f,!1])),f=m+1));while(-1!==m);f<k.length-1&&(k=k.substr(f),a.push([k,null,H(k)]));return a}function n(k,l,a){let f="",m=null;for(const e of l){const [p,
y,K]=e;if(p)K?m=p:(m&&(f+=m,m=null),f+=p);else if(l=k.attributes[y])m&&(f+=m,m=null),f+=l}return R(f,a)}function R(k,l){"string"!==typeof k&&(k=String(k));switch(l){case "LowerCase":return k.toLowerCase();case "Allcaps":return k.toUpperCase();default:return k}}function P(k){if(!k)return null;switch(k.type){case "CIMPolygonSymbol":if(k.symbolLayers)for(const l of k.symbolLayers)if(k=P(l),null!=k)return k;break;case "CIMTextSymbol":return P(k.symbol);case "CIMSolidFill":return k.color}}function J(k){if(k)switch(k.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(k.symbolLayers)for(const l of k.symbolLayers)if(k=
J(l),void 0!==k)return k;break;case "CIMTextSymbol":return J(k.symbol);case "CIMSolidStroke":case "CIMSolidFill":return k.color}}function L(k){if(k)switch(k.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(k.symbolLayers)for(const l of k.symbolLayers)if(k=L(l),void 0!==k)return k;break;case "CIMTextSymbol":return L(k.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return k.width}}D.adjustTextCase=R;D.analyzeTextParts=I;D.assignTextValuesFromFeature=n;D.attributesToFields=
function(k){return(k?Object.keys(k):[]).map(l=>({name:l,alias:l,type:"string"===typeof k[l]?"esriFieldTypeString":"esriFieldTypeDouble"}))};D.colorToArray=function(k){return[k.r,k.g,k.b,k.a]};D.createLabelOverrideFunction=function(k,l,a){const f=I(l,k);return m=>n(m,f,a)};D.evaluateValueOrFunction=function(k,l,a,f){return"function"===typeof k?k(l,a,f):k};D.fromCIMColor=function(k){return k?{r:k[0],g:k[1],b:k[2],a:k[3]/255}:{r:0,g:0,b:0,a:0}};D.fromCIMFontDecoration=function(k){return k.underline?
"underline":k.strikethrough?"line-through":"none"};D.fromCIMFontStyle=function(k){let l="",a="";k&&(k=k.toLowerCase(),k.includes("italic")?l="italic":k.includes("oblique")&&(l="oblique"),k.includes("bold")?a="bold":k.includes("light")&&(a="lighter"));return{style:l,weight:a}};D.fromCIMHorizontalAlignment=function(k){switch(k){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};D.fromCIMVerticalAlignment=function(k){switch(k){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};D.getFillColor=P;D.getFontStyle=function(k){if(!k)return"normal";switch(k.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};D.getFontWeight=function(k){if(!k)return"normal";switch(k.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};D.getStrokeColor=J;D.getStrokeWidth=L;D.getValue=(k,
l=0)=>isNaN(k)||null==k?l:k;D.importGeometryEngine=function(){return new Promise((k,l)=>M(["../../geometry/geometryEngineJSON"],k,l))};D.isCIMFill=function(k){return"CIMGradientFill"===k.type||"CIMHatchFill"===k.type||"CIMPictureFill"===k.type||"CIMSolidFill"===k.type||"CIMWaterFill"===k.type};D.isCIMMarker=function(k){return"CIMVectorMarker"===k.type||"CIMPictureMarker"===k.type||"CIMBarChartMarker"===k.type||"CIMCharacterMarker"===k.type||"CIMPieChartMarker"===k.type||"CIMStackedBarChartMarker"===
k.type};D.isCIMMarkerStrokePlacement=function(k){return"CIMMarkerPlacementAlongLineRandomSize"===k.type||"CIMMarkerPlacementAlongLineSameSize"===k.type||"CIMMarkerPlacementAlongLineVariableSize"===k.type||"CIMMarkerPlacementAtExtremities"===k.type||"CIMMarkerPlacementAtMeasuredUnits"===k.type||"CIMMarkerPlacementAtRatioPositions"===k.type||"CIMMarkerPlacementOnLine"===k.type||"CIMMarkerPlacementOnVertices"===k.type};D.isCIMStroke=function(k){return"CIMGradientStroke"===k.type||"CIMPictureStroke"===
k.type||"CIMSolidStroke"===k.type};D.isGeometryEngineRequired=k=>{if(!k)return!1;for(const l of k)switch(l.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};D.isSVGImage=k=>k.includes("data:image/svg+xml");D.mapCIMSymbolToGeometryType=function(k){if(!k)return null;switch(k.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};
D.resampleHermite=function(k,l,a,f,m,e,p=!0){const y=l/m;a/=e;const K=Math.ceil(y/2),F=Math.ceil(a/2);for(let u=0;u<e;u++)for(let C=0;C<m;C++){const d=4*(C+(p?e-u-1:u)*m);var g=0;let b=0,c=0,h=0,q=0,z=0,B=0;const r=(u+.5)*a;for(let x=Math.floor(u*a);x<(u+1)*a;x++){var w=Math.abs(r-(x+.5))/F;const v=(C+.5)*y;w*=w;for(let E=Math.floor(C*y);E<(C+1)*y;E++){let t=Math.abs(v-(E+.5))/K;g=Math.sqrt(w+t*t);-1<=g&&1>=g&&(g=2*g*g*g-3*g*g+1,0<g&&(t=4*(E+x*l),B+=g*k[t+3],c+=g,255>k[t+3]&&(g=g*k[t+3]/250),h+=g*
k[t],q+=g*k[t+1],z+=g*k[t+2],b+=g))}}f[d]=h/b;f[d+1]=q/b;f[d+2]=z/b;f[d+3]=B/c}};D.toCIMSymbolJSON=function(k){return k.data?.symbol??null};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u,C,d,b,c,h,q,z){const B=J.getLogger("esri.layers.mixins.ImageryTileMixin");M.ImageryTileMixin=r=>{function x(v){if(!v.raster||!v.rasterInfo)throw new P("imagery-tile","no raster");}r=function(v){function E(){var A=v.apply(this,arguments)||this;A._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};A.bandIds=null;A.copyright=null;A.interpolation="nearest";A.multidimensionalDefinition=null;A.multidimensionalSubset=null;A.raster=null;
A.rasterFunction=null;A.sourceJSON=null;A.symbolizer=null;return A}D._inheritsLoose(E,v);var t=E.prototype;t.convertVectorFieldData=function(){var A=D._asyncToGenerator(function*(O,N){if(L.isNone(O)||!this.rasterInfo)return null;const X=this._rasterJobHandler.instance,V=this.rasterInfo.dataType;return X?X.convertVectorFieldData({pixelBlock:O,dataType:V},N):b.convertVectorFieldData(O,V)});return function(O,N){return A.apply(this,arguments)}}();t.createFlowMesh=function(){var A=D._asyncToGenerator(function*(O,
N){const X=this._rasterJobHandler.instance;return X?X.createFlowMesh(O,N):q.createFlowMesh(O.meshType,O.simulationSettings,O.flowData,L.isSome(N.signal)?N.signal:(new AbortController).signal)});return function(O,N){return A.apply(this,arguments)}}();t.normalizeRasterFetchOptions=function(A){var {multidimensionalInfo:O}=this.rasterInfo??{};if(L.isNone(O))return A;let N=A.multidimensionalDefinition||this.multidimensionalDefinition;if(L.isNone(N)||!N.length)N=C.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,
{multidimensionalSubset:this.multidimensionalSubset});var X=A.timeExtent||this.timeExtent;if(L.isSome(N)&&L.isSome(X)&&(L.isSome(X.start)||L.isSome(X.end))){N=N.map(Z=>Z.clone());var V=O.variables.find(({name:Z})=>Z===N[0].variableName)?.dimensions?.find(({name:Z})=>"StdTime"===Z);O=N.find(({dimensionName:Z})=>"StdTime"===Z);if(!V||!O)return{...A,multidimensionalDefinition:null};const {start:W,end:G}=X;X=L.isNone(W)?null:W.getTime();const S=L.isNone(G)?null:G.getTime(),T=X??S,aa=S??X;if(L.isSome(V.values))V=
V.values.filter(Z=>{if(Array.isArray(Z)){if(T===aa)return Z[0]<=T&&Z[1]>=T;const Q=Z[0]>=T&&Z[1]<=aa||Z[0]<T&&Z[1]>aa;return Z[0]<=T&&Z[1]>T||Z[0]<aa&&Z[1]>=aa||Q}return T===aa?Z===T:Z>=T&&Z<=aa}),V.length?(V=V.sort((Z,Q)=>T===aa?(Z[0]??Z)-(Q[0]??Q):Math.abs((Z[1]??Z)-aa)-Math.abs((Q[1]??Q)-aa))[0],O.values=[V]):N=null;else if(V.hasRegularIntervals&&V.extent){const [Z,Q]=V.extent;T>Q||aa<Z?N=null:O.values=T===aa?[T]:[Math.max(Z,T),Math.min(Q,aa)]}}return L.isSome(N)&&C.hasExcludedVariableOrDimension(N,
this.multidimensionalSubset)?{...A,multidimensionalDefinition:null}:{...A,multidimensionalDefinition:N}};t.updateRenderer=function(){var A=D._asyncToGenerator(function*(){const {loaded:O,symbolizer:N}=this;if(O&&N&&JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer)){var X=this._rasterJobHandler.instance;X&&(N.rendererJSON=c.normalizeRendererJSON(this.renderer.toJSON()),N.bind(),yield X.updateSymbolizer(N),this._cachedRendererJson=this.renderer.toJSON())}});return function(){return A.apply(this,
arguments)}}();t.applyRenderer=function(){var A=D._asyncToGenerator(function*(O,N){var X=O&&O.pixelBlock;if(!(L.isSome(X)&&X.pixels&&0<X.pixels.length))return null;yield this.updateRenderer();X=this._rasterJobHandler.instance;const V=this.bandIds??[];return X?yield X.symbolize({...O,simpleStretchParams:N,bandIds:V}):this.symbolizer.symbolize({...O,simpleStretchParams:N,bandIds:V})});return function(O,N){return A.apply(this,arguments)}}();t.getTileUrl=function(A,O,N){return"RasterTileServer"===this.raster?.datasetFormat?
`${this.url}/tile/${A}/${O}/${N}`:""};t.getCompatibleTileInfo=function(A,O,N=!1){if(!this.loaded||L.isNone(O))return null;if(N&&A.equals(this.spatialReference))return this.tileInfo;N=m.getInfo(A);return w.create({size:256,spatialReference:A,origin:N?{x:N.origin[0],y:N.origin[1]}:{x:O.xmin,y:O.ymax}})};t.getCompatibleFullExtent=function(A){return this.loaded?this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(A)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(A):
null};t.fetchTile=function(){var A=D._asyncToGenerator(function*(O,N,X,V={}){x(this);if(V.requestAsImageElement)return O=this.getTileUrl(O,N,X),R(O,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:V.signal}).then(W=>W.data);if(L.isSome(this.rasterInfo.multidimensionalInfo)&&(V=this.normalizeRasterFetchOptions(V),L.isNone(V.multidimensionalDefinition)))return{extent:this.raster.getTileExtentFromTileInfo(O,N,X,V.tileInfo||this.rasterInfo.storageInfo.tileInfo),
pixelBlock:null};yield this._initJobHandler();yield this._updateRasterFunction();"raster-shaded-relief"===this.renderer.type&&(V={...V,buffer:{cols:1,rows:1}});return this.raster.fetchTile(O,N,X,V)});return function(O,N,X){return A.apply(this,arguments)}}();t.fetchPixels=function(){var A=D._asyncToGenerator(function*(O,N,X,V={}){if(L.isSome(this.rasterInfo.multidimensionalInfo)&&(V=this.normalizeRasterFetchOptions(V),L.isNone(V.multidimensionalDefinition)))return{extent:O,pixelBlock:null};yield this._initJobHandler();
yield this._updateRasterFunction();return this.raster.fetchPixels(O,N,X,V)});return function(O,N,X){return A.apply(this,arguments)}}();t.identify=function(){var A=D._asyncToGenerator(function*(O,N={}){x(this);return!L.isSome(this.rasterInfo.multidimensionalInfo)||this.rasterInfo.hasMultidimensionalTranspose&&(C.isMultiSliceOrRangeDefinition(N.multidimensionalDefinition)||N.transposedVariableName||N.timeExtent)||(N=this.normalizeRasterFetchOptions(N),!L.isNone(N.multidimensionalDefinition))?this.raster.identify(O,
N):{location:O,value:null}});return function(O){return A.apply(this,arguments)}}();t.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};t.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};t.hasStandardTime=function(){const A=this.rasterInfo?.multidimensionalInfo;if(L.isNone(A)||"standard-time"!==this.rasterInfo?.dataType)return!1;const O=this.multidimensionalDefinition,N=O?.[0]?.variableName;
return A.variables.some(X=>X.name===N&&(!O?.[0].dimensionName||X.dimensions.some(V=>"StdTime"===V.name)))};t.getStandardTimeValue=function(A){return(new Date(864E5*(A-25569))).toString()};t.getMultidimensionalSubsetVariables=function(A){return C.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,A??this.rasterInfo.multidimensionalInfo)};t._configDefaultSettings=function(){this._configDefaultInterpolation();this.multidimensionalDefinition||(this.multidimensionalDefinition=C.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,
{multidimensionalSubset:this.multidimensionalSubset}));this._configDefaultRenderer()};t._initJobHandler=function(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const A=new g;this._rasterJobHandler.connectionPromise=A.initialize().then(()=>{x(this);this._rasterJobHandler.instance=A;this.raster.rasterJobHandler=A;this.renderer&&this.updateRenderer();"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler()}).catch(()=>{});return this._rasterJobHandler.connectionPromise};
t._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null;this.raster&&(this.raster.rasterJobHandler=null)};t._configDefaultInterpolation=function(){if(null==this.interpolation){x(this);const A=c.getDefaultInterpolation(this.rasterInfo,this.raster.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",
A)}};t._configDefaultRenderer=function(){x(this);var A=this.raster.rasterInfo;this.bandIds||(this.bandIds=c.getDefaultBandCombination(A));if(!this.renderer){const O=c.createDefaultRenderer(A,{bandIds:this.bandIds,variableName:L.isSome(this.multidimensionalDefinition)?this.multidimensionalDefinition[0]?.variableName:null});"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===O.type&&(1E24<(A.statistics?.[0].max??0)||-1E24>(A.statistics?.[0].min??0))&&(O.dynamicRangeAdjustment=!0,O.statistics=
null,"none"===O.stretchType&&(O.stretchType="min-max"));this.renderer=O}this.symbolizer?(this.symbolizer.rendererJSON=c.normalizeRendererJSON(this.renderer.toJSON()),this.symbolizer.rasterInfo=A):this.symbolizer=new h({rendererJSON:this.renderer.toJSON(),rasterInfo:A});A=this.symbolizer.bind();A.success||B.warn("imagery-tile-mixin",A.error||"The given renderer is not supported by the layer.")};t._updateRasterFunction=function(){var A=D._asyncToGenerator(function*(){if("imagery-tile"===this.type&&
JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson)){var O=this.raster;"Function"===O?.datasetFormat&&(O=O.rasterFunction.getPrimaryRasters().rasters[0]);var {rasterFunction:N}=this;N?(O=d.create(N.toJSON(),{raster:O}),O=new u({rasterFunction:O}),O.rasterJobHandler=this._rasterJobHandler.instance,yield O.open(),this._cachedRasterFunctionJson=this.rasterFunction?.toJSON(),this.raster=O):this.raster=O}});return function(){return A.apply(this,arguments)}}();D._createClass(E,
[{key:"fullExtent",get:function(){return this.rasterInfo?.extent}},{key:"rasterInfo",get:function(){return this.raster?.rasterInfo}},{key:"spatialReference",get:function(){return this.rasterInfo?.spatialReference??z.WGS84}},{key:"tileInfo",get:function(){return this.rasterInfo?.storageInfo.tileInfo}},{key:"url",set:function(A){this._set("url",e.sanitizeUrl(A,B))}},{key:"renderer",set:function(A){this._set("renderer",A);this.updateRenderer()}}]);return E}(r);H.__decorate([k.property()],r.prototype,
"_cachedRendererJson",void 0);H.__decorate([k.property()],r.prototype,"_cachedRasterFunctionJson",void 0);H.__decorate([k.property()],r.prototype,"_compatibleFullExtent",void 0);H.__decorate([k.property()],r.prototype,"_rasterJobHandler",void 0);H.__decorate([k.property()],r.prototype,"bandIds",void 0);H.__decorate([k.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],r.prototype,"copyright",void 0);H.__decorate([k.property({json:{read:!1}})],r.prototype,"fullExtent",null);H.__decorate([k.property()],
r.prototype,"interpolation",void 0);H.__decorate([k.property()],r.prototype,"ioConfig",void 0);H.__decorate([k.property({type:[y]})],r.prototype,"multidimensionalDefinition",void 0);H.__decorate([k.property({type:K,json:{write:!0}})],r.prototype,"multidimensionalSubset",void 0);H.__decorate([k.property()],r.prototype,"raster",void 0);H.__decorate([k.property({type:F})],r.prototype,"rasterFunction",void 0);H.__decorate([k.property()],r.prototype,"rasterInfo",null);H.__decorate([k.property()],r.prototype,
"sourceJSON",void 0);H.__decorate([k.property({json:{read:!1}})],r.prototype,"spatialReference",null);H.__decorate([k.property({json:{read:!1}})],r.prototype,"tileInfo",null);H.__decorate([k.property(p.url)],r.prototype,"url",null);H.__decorate([k.property({types:n.rasterRendererTypes})],r.prototype,"renderer",null);H.__decorate([k.property()],r.prototype,"symbolizer",void 0);return r=H.__decorate([f.subclass("esri.layers.ImageryTileMixin")],r)};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(M,D,H,I,n,R,P){var J;H=J=function(L){function k(l){l=L.call(this,l)||this;l.variableName=null;l.dimensionName=null;l.values=[];l.isSlice=!1;return l}M._inheritsLoose(k,L);k.prototype.clone=
function(){return new J({variableName:this.variableName,dimensionName:this.dimensionName,values:I.clone(this.values),isSlice:this.isSlice})};return k}(H.JSONSupport);D.__decorate([n.property({type:String,json:{write:!0}})],H.prototype,"variableName",void 0);D.__decorate([n.property({type:String,json:{write:!0}})],H.prototype,"dimensionName",void 0);D.__decorate([n.property({type:R.types.array(R.types.oneOf([R.types.native(Number),R.types.array(R.types.native(Number))])),json:{write:!0}})],H.prototype,
"values",void 0);D.__decorate([n.property({type:Boolean,json:{write:!0}})],H.prototype,"isSlice",void 0);return H=J=D.__decorate([P.subclass("esri.layers.support.DimensionalDefinition")],H)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f){var m;H={base:f,key:"type",typeMap:{extent:L,polygon:k}};I=m=function(e){function p(y){y=e.call(this,y)||this;y.areaOfInterest=null;y.subsetDefinitions=null;return y}M._inheritsLoose(p,e);p.prototype.clone=function(){const y=this.subsetDefinitions?.map(F=>F.clone()),K=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new m({areaOfInterest:K,subsetDefinitions:y})};M._createClass(p,[{key:"dimensions",get:function(){var {subsetDefinitions:y}=
this;if(null==y||0===y.length)return[];const K=new Map;y.forEach(F=>{if(F.dimensionName){if(Array.isArray(F.values[0])){var g=F.values;var w=g[0][0];g=g[F.values.length-1][1]}else g=F.values,w=g[0],g=g[F.values.length-1];K.has(F.dimensionName)?(F=K.get(F.dimensionName),F[0]=Math.min(w,F[0]),F[1]=Math.max(g,F[1])):K.set(F.dimensionName,[w,g])}});y=[];for(const F of K)y.push({name:F[0],extent:F[1]});return y}},{key:"variables",get:function(){const {subsetDefinitions:y}=this;if(null==y||0===y.length)return[];
const K=new Set;y.forEach(F=>{F.variableName&&K.add(F.variableName)});return[...K]}}]);return p}(I.JSONSupport);D.__decorate([n.property({types:H,json:{read:l.fromJSON,write:!0}})],I.prototype,"areaOfInterest",void 0);D.__decorate([n.property({readOnly:!0})],I.prototype,"dimensions",null);D.__decorate([n.property({readOnly:!0})],I.prototype,"variables",null);D.__decorate([n.property({type:[a],json:{write:!0}})],I.prototype,"subsetDefinitions",void 0);return I=m=D.__decorate([J.subclass("esri.layers.support.MultidimensionalSubset")],
I)})},"esri/layers/support/RasterFunction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(M,D,H,I,n,R,P,J,L,k){var l;const a=new Set(["raster",
"raster2","dem","fillraster"]),f=new Set(["rasters"]),m=K=>K&&K.rasterFunction?y.fromJSON(K):K,e=K=>K&&K instanceof y?K.toJSON():K,p=K=>K?.functionName&&!K.declaredClass?new y(K):K;let y=l=function(K){function F(w){w=K.call(this,w)||this;w.functionName=null;w.outputPixelType="unknown";w.variableName=null;w.rasterFunctionDefinition=null;return w}M._inheritsLoose(F,K);var g=F.prototype;g.readFunctionArguments=function(w){if(null==w)var u=null;else{w=I.clone(w);var C={};for(u of Object.keys(w))a.has(u.toLowerCase())?
C[u]=m(w[u]):f.has(u.toLowerCase())&&Array.isArray(w[u])?C[u]=w[u].map(m):C[u]=w[u];u=C}return u};g.writeFunctionArguments=function(w,u,C){const d={};for(const b of Object.keys(w))a.has(b.toLowerCase())?d[b]=e(w[b]):f.has(b.toLowerCase())&&Array.isArray(w[b])?d[b]=w[b].map(e):d[b]=e(w[b]);u[C]=d};g.readFunctionName=function(w,u){w=u.rasterFunctionInfos;const C=u.name;return C?C:w&&w.length&&"None"!==w[0].name?w[0].name:u.rasterFunctionDefinition?u.rasterFunctionDefinition.name:u.rasterFunction};g.clone=
function(){return new l({functionName:this.functionName,functionArguments:I.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:I.clone(this.rasterFunctionDefinition)})};M._createClass(F,[{key:"functionArguments",set:function(w){if(w){const u=Object.keys(w);if(u.some(C=>{var d;if(d=a.has(C.toLowerCase()))C=w[C],d=C?.functionName&&!C.declaredClass;return d})||u.some(C=>f.has(C.toLowerCase())&&Array.isArray(w[C])&&w[C].some(d=>d?.functionName&&
!d.declaredClass))){w=I.clone(w);for(const C of u)a.has(C.toLowerCase())?w[C]=p(w[C]):f.has(C.toLowerCase())&&Array.isArray(w[C])&&(w[C]=w[C].map(d=>p(d)))}}this._set("functionArguments",w)}}]);return F}(H.JSONSupport);D.__decorate([n.property({json:{type:Object,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",null);D.__decorate([J.reader("functionArguments")],y.prototype,"readFunctionArguments",null);D.__decorate([k.writer("functionArguments")],y.prototype,"writeFunctionArguments",
null);D.__decorate([n.property({json:{type:String,write:{target:"rasterFunction"}}})],y.prototype,"functionName",void 0);D.__decorate([J.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],y.prototype,"readFunctionName",null);D.__decorate([P.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),n.property({json:{default:"unknown"}})],y.prototype,
"outputPixelType",void 0);D.__decorate([n.property({type:String,json:{read:!0,write:!0}})],y.prototype,"variableName",void 0);D.__decorate([n.property({type:Object,json:{name:"rasterFunctionDefinition"}})],y.prototype,"rasterFunctionDefinition",void 0);return y=l=D.__decorate([L.subclass("esri.layers.support.RasterFunction")],y)})},"esri/layers/support/RasterJobHandler":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/maybe","../../core/workers/workers","./PixelBlock"],
function(M,D,H,I,n){return function(){function R(){this._workerThread=null;this._destroyed=!1}var P=R.prototype;P.initialize=function(){var J=M._asyncToGenerator(function*(){const L=yield I.open("RasterWorker");this._destroyed?L.close():this._workerThread=L});return function(){return J.apply(this,arguments)}}();P.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};P.convertVectorFieldData=function(){var J=M._asyncToGenerator(function*(L,
k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=yield this._workerThread.invoke("convertVectorFieldData",{pixelBlock:L.pixelBlock.toJSON(),type:L.dataType},k))?new n(L):null});return function(L,k){return J.apply(this,arguments)}}();P.decode=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=yield this._workerThread.invoke("decode",
L,k))?new n(L):null});return function(L,k){return J.apply(this,arguments)}}();P.symbolize=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");L={extent:L.extent&&L.extent.toJSON(),pixelBlock:H.isSome(L.pixelBlock)&&L.pixelBlock.toJSON(),simpleStretchParams:L.simpleStretchParams,bandIds:L.bandIds};return(k=yield this._workerThread.invoke("symbolize",L,k))?new n(k):null});return function(L,k){return J.apply(this,
arguments)}}();P.updateSymbolizer=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");const l=L?.rendererJSON?.histograms;yield Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:L.toJSON(),histograms:l},k))});return function(L,k){return J.apply(this,arguments)}}();P.updateRasterFunction=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");yield Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:L.toJSON()},k))});return function(L,k){return J.apply(this,arguments)}}();P.process=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=yield this._workerThread.invoke("process",{extent:L.extent?.toJSON(),primaryPixelBlocks:L.primaryPixelBlocks.map(l=>H.isSome(l)?l.toJSON():
null),primaryRasterIds:L.primaryRasterIds},k))?new n(L):null});return function(L,k){return J.apply(this,arguments)}}();P.stretch=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;L={srcPixelBlock:L.pixelBlock.toJSON(),stretchParams:L.stretchParams};return(k=yield this._workerThread.invoke("stretch",L,k))?new n(k):null});return function(L,k){return J.apply(this,arguments)}}();
P.split=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;L={srcPixelBlock:L.pixelBlock.toJSON(),tileSize:L.tileSize,maximumPyramidLevel:L.maximumPyramidLevel};const l=yield this._workerThread.invoke("split",L,k);l&&l.forEach((a,f)=>{l.set(f,a?n.fromJSON(a):null)});return l});return function(L,k){return J.apply(this,arguments)}}();P.estimateStatisticsHistograms=function(){var J=
M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;L={srcPixelBlock:L.pixelBlock.toJSON()};return yield this._workerThread.invoke("estimateStatisticsHistograms",L,k)});return function(L,k){return J.apply(this,arguments)}}();P.mosaicAndTransform=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");
if(!L?.srcPixelBlocks?.length)return{pixelBlock:null};L={...L,srcPixelBlocks:L.srcPixelBlocks.map(l=>H.isSome(l)?l.toJSON():null)};k=yield this._workerThread.invoke("mosaicAndTransform",L,k);return{pixelBlock:k.pixelBlock?new n(k.pixelBlock):null,localNorthDirections:k.localNorthDirections}});return function(L,k){return J.apply(this,arguments)}}();P.createFlowMesh=function(){var J=M._asyncToGenerator(function*(L,k){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");
const l={buffer:L.flowData.data.buffer,maskBuffer:L.flowData.mask.buffer,width:L.flowData.width,height:L.flowData.height},{meshType:a,simulationSettings:f}=L;L=yield this._workerThread.invoke("createFlowMesh",{meshType:a,flowData:l,simulationSettings:f},{...k,transferList:[l.buffer,l.maskBuffer]});return{vertexData:new Float32Array(L.vertexBuffer),indexData:new Uint32Array(L.indexBuffer)}});return function(L,k){return J.apply(this,arguments)}}();P.getProjectionOffsetGrid=function(J,L){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");const k=H.isSome(J.datumTransformation)?J.datumTransformation.steps.map(a=>({wkid:a.wkid,wkt:a.wkt,isInverse:a.isInverse})):null,l=H.isSome(J.rasterTransform)?J.rasterTransform.toJSON():null;J={projectedExtent:J.projectedExtent.toJSON(),srcBufferExtent:J.srcBufferExtent.toJSON(),pixelSize:J.pixelSize,hasWrapAround:J.hasWrapAround,spacing:J.spacing,datumTransformationSteps:k,rasterTransform:l,isAdaptive:J.isAdaptive,includeGCSGrid:J.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",
J,L)};return R}()})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F){var g;H=new H.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});I=g=function(w){function u(d){d=w.call(this,d)||this;d.dpi=96;d.format=null;d.origin=null;d.minScale=0;d.maxScale=0;d.size=null;d.spatialReference=null;return d}M._inheritsLoose(u,w);u.create=function(d=
{}){const {resolutionFactor:b=1,scales:c,size:h=256,spatialReference:q=m.WebMercator,numLODs:z=24}=d;if(!p.isValid(q)){d=[];if(c)for(var B=0;B<c.length;B++){var r=c[B];d.push({level:B,scale:r,resolution:r})}else for(B=5E-4,r=z-1;0<=r;r--)d.unshift({level:r,scale:B,resolution:B}),B*=2;return new g({dpi:96,lods:d,origin:new f(0,0,q),size:[h,h],spatialReference:q})}B=p.getInfo(q);d=d.origin?new f({x:d.origin.x,y:d.origin.y,spatialReference:q}):B?new f({x:B.origin[0],y:B.origin[1],spatialReference:q}):
new f({x:0,y:0,spatialReference:q});B=1/(39.37*R.getMetersPerUnitForSR(q)*96);r=[];if(c)for(var x=0;x<c.length;x++){var v=c[x];r.push({level:x,scale:v,resolution:v*B})}else{var E=p.isGeographic(q)?512/h*5.916575275917094E8:256/h*5.91657527591555E8;x=Math.ceil(z/b);r.push({level:0,scale:E,resolution:E*B});for(v=1;v<x;v++)E/=2**b,r.push({level:v,scale:E,resolution:E*B})}return new g({dpi:96,lods:r,origin:d,size:[h,h],spatialReference:q})};var C=u.prototype;C.readOrigin=function(d,b){return f.fromJSON({spatialReference:b.spatialReference,
...d})};C.readSize=function(d,b){return[b.cols,b.rows]};C.writeSize=function(d,b){b.cols=d[0];b.rows=d[1]};C.zoomToScale=function(d){const b=this.scales;if(0>=d)return b[0];if(d>=b.length-1)return b[b.length-1];const c=Math.floor(d);return b[c]/(b[c]/b[c+1])**(d-c)};C.scaleToZoom=function(d){const b=this.scales,c=b.length-1;let h=0;for(;h<c;h++){const q=b[h],z=b[h+1];if(q<=d)break;if(z===d)return h+1;if(q>d&&z<d)return h+Math.log(q/d)/Math.log(q/z)}return h};C.snapScale=function(d,b=.95){d=this.scaleToZoom(d);
return d%Math.floor(d)>=b?this.zoomToScale(Math.ceil(d)):this.zoomToScale(Math.floor(d))};C.tileAt=function(d,b,c,h){var q=this.lodAt(d);if(!q)return null;let z;if("number"===typeof b)z=b,b=c;else{if(p.equals(b.spatialReference,this.spatialReference))z=b.x,b=b.y;else{h=y.project(b,this.spatialReference);if(n.isNone(h))return null;z=h.x;b=h.y}h=c}c=q.resolution*this.size[0];q=q.resolution*this.size[1];h||(h=new F.TileKey(null,0,0,0,e.create()));h.level=d;h.row=Math.floor((this.origin.y-b)/q+.001);
h.col=Math.floor((z-this.origin.x)/c+.001);this.updateTileInfo(h);return h};C.updateTileInfo=function(d,b=g.ExtrapolateOptions.NONE){var c=this.lodAt(d.level);c||b!==g.ExtrapolateOptions.POWER_OF_TWO||(b=this.lods[this.lods.length-1],b.level<d.level&&(c=b));if(c){var h=d.level-c.level;b=c.resolution*this.size[0]/2**h;c=c.resolution*this.size[1]/2**h;d.id=`${d.level}/${d.row}/${d.col}`;d.extent||(d.extent=e.create());d.extent[0]=this.origin.x+d.col*b;d.extent[1]=this.origin.y-(d.row+1)*c;d.extent[2]=
d.extent[0]+b;d.extent[3]=d.extent[1]+c}};C.upsampleTile=function(d){const b=this._upsampleLevels[d.level];if(!b||-1===b.parentLevel)return!1;d.level=b.parentLevel;d.row=Math.floor(d.row/b.factor+.001);d.col=Math.floor(d.col/b.factor+.001);this.updateTileInfo(d);return!0};C.getTileBounds=function(d,b){var c=this.lodAt(b.level);if(null==c)return null;var {resolution:h}=c;c=h*this.size[0];h*=this.size[1];d[0]=this.origin.x+b.col*c;d[1]=this.origin.y-(b.row+1)*h;d[2]=d[0]+c;d[3]=d[1]+h;return d};C.lodAt=
function(d){return this._levelToLOD?.[d]??null};C.clone=function(){return g.fromJSON(this.write({}))};C.getOrCreateCompatible=function(d,b){if(256===this.size[0]&&256===this.size[1])return 256===d?this:null;const c=[],h=this.lods.length;for(let q=0;q<h;q++){const z=this.lods[q];c.push(new K({level:z.level,scale:z.scale,resolution:z.resolution*b}))}return new g({size:[d,d],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,
lods:c})};C._initializeUpsampleLevels=function(){const d=this.lods;this._upsampleLevels=[];let b=null;for(let c=0;c<d.length;c++){const h=d[c];this._upsampleLevels[h.level]={parentLevel:b?b.level:-1,factor:b?b.resolution/h.resolution:0};b=h}};M._createClass(u,[{key:"isWrappable",get:function(){const {spatialReference:d,origin:b}=this;if(d&&b){const c=p.getInfo(d);return d.isWrappable&&!!c&&Math.abs(c.origin[0]-b.x)<=c.dx}return!1}},{key:"lods",set:function(d){let b=0,c=0;const h=[],q=this._levelToLOD=
{};d&&(b=-Infinity,c=Infinity,d.forEach(z=>{h.push(z.scale);b=z.scale>b?z.scale:b;c=z.scale<c?z.scale:c;q[z.level]=z}));this._set("scales",h);this._set("minScale",b);this._set("maxScale",c);this._set("lods",d);this._initializeUpsampleLevels()}}]);return u}(I.JSONSupport);D.__decorate([P.property({type:Number,json:{write:!0}})],I.prototype,"compressionQuality",void 0);D.__decorate([P.property({type:Number,json:{write:!0}})],I.prototype,"dpi",void 0);D.__decorate([P.property({type:String,json:{read:H.read,
write:H.write,origins:{"web-scene":{read:!1,write:!1}}}})],I.prototype,"format",void 0);D.__decorate([P.property({readOnly:!0})],I.prototype,"isWrappable",null);D.__decorate([P.property({type:f,json:{write:!0}})],I.prototype,"origin",void 0);D.__decorate([k.reader("origin")],I.prototype,"readOrigin",null);D.__decorate([P.property({type:[K],value:null,json:{write:!0}})],I.prototype,"lods",null);D.__decorate([P.property({readOnly:!0})],I.prototype,"minScale",void 0);D.__decorate([P.property({readOnly:!0})],
I.prototype,"maxScale",void 0);D.__decorate([P.property({readOnly:!0})],I.prototype,"scales",void 0);D.__decorate([P.property({cast:w=>Array.isArray(w)?w:"number"===typeof w?[w,w]:[256,256]})],I.prototype,"size",void 0);D.__decorate([k.reader("size",["rows","cols"])],I.prototype,"readSize",null);D.__decorate([a.writer("size",{cols:{type:L.Integer},rows:{type:L.Integer}})],I.prototype,"writeSize",null);D.__decorate([P.property({type:m,json:{write:!0}})],I.prototype,"spatialReference",void 0);I=g=D.__decorate([l.subclass("esri.layers.support.TileInfo")],
I);(function(w){w=w.ExtrapolateOptions||(w.ExtrapolateOptions={});w[w.NONE=0]="NONE";w[w.POWER_OF_TWO=1]="POWER_OF_TWO"})(I||(I={}));return I})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(M,D,H,I,n,R,P){var J;H=J=function(L){function k(l){l=
L.call(this,l)||this;l.cols=null;l.level=0;l.levelValue=null;l.origin=null;l.resolution=0;l.rows=null;l.scale=0;return l}M._inheritsLoose(k,L);k.prototype.clone=function(){return new J({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return k}(H.JSONSupport);D.__decorate([I.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"cols",void 0);D.__decorate([I.property({type:R.Integer,
json:{write:!0}})],H.prototype,"level",void 0);D.__decorate([I.property({type:String,json:{write:!0}})],H.prototype,"levelValue",void 0);D.__decorate([I.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,"origin",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],H.prototype,"resolution",void 0);D.__decorate([I.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],H.prototype,
"rows",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],H.prototype,"scale",void 0);return H=J=D.__decorate([P.subclass("esri.layers.support.LOD")],H)})},"esri/layers/support/TileKey":function(){define(["exports"],function(M){M.TileKey=function(D,H,I,n,R){this.id=D;this.level=H;this.row=I;this.col=n;this.extent=R};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRaster".split(" "),
function(M,D,H,I,n,R,P,J,L){R=function(k){function l(){var f=k.apply(this,arguments)||this;f.datasetFormat="Function";f.tileType="Raster";f.rasterFunction=null;f._primaryRasters=null;return f}M._inheritsLoose(l,k);var a=l.prototype;a.open=function(){var f=M._asyncToGenerator(function*(m){yield this.init();const {rasterFunction:e}=this,{rasters:p,rasterIds:y}=e.getPrimaryRasters();var K=p.map(F=>F.rasterInfo?void 0:F.open(m));yield Promise.all(K);K=p.map(({rasterInfo:F})=>F);K=e.bind({rasterInfos:K,
rasterIds:y});if(!K.success)throw new H("raster-function:open",`cannot bind the function: ${K.error??""}`);yield this.syncJobHandler();this.set("sourceJSON",p[0].sourceJSON);this.set("rasterInfo",e.rasterInfo)});return function(m){return f.apply(this,arguments)}}();a.syncJobHandler=function(){var f=M._asyncToGenerator(function*(){const {rasterFunction:m}=this;this._primaryRasters=m.getPrimaryRasters();if(this.rasterJobHandler)return this.rasterJobHandler.updateRasterFunction(m)});return function(){return f.apply(this,
arguments)}}();a.fetchPixels=function(){var f=M._asyncToGenerator(function*(m,e,p,y={}){const {rasters:K,rasterIds:F}=this._primaryRasters;var g=K.map(C=>C.fetchPixels(m,e,p,y));g=yield Promise.all(g);var w=g.map(C=>C.pixelBlock);if(w.every(C=>I.isNone(C)))return g[0];const u=g.find(C=>I.isSome(C.pixelBlock))?.extent??m;w=this.rasterJobHandler?yield this.rasterJobHandler.process({extent:u,primaryPixelBlocks:w,primaryRasterIds:F}):this.rasterFunction.process({extent:u,primaryPixelBlocks:w,primaryRasterIds:F});
return{...g[0],pixelBlock:w}});return function(m,e,p){return f.apply(this,arguments)}}();return l}(L);D.__decorate([n.property({type:String,json:{write:!0}})],R.prototype,"datasetFormat",void 0);D.__decorate([n.property()],R.prototype,"tileType",void 0);D.__decorate([n.property()],R.prototype,"rasterFunction",void 0);return R=D.__decorate([J.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],R)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u,C,d,b,c,h){H=function(q){function z(){var r=q.apply(this,arguments)||this;r.rasterJobHandler=null;r.datasetName=null;r.datasetFormat=null;r.rasterInfo=null;r.ioConfig={sampling:"closest"};return r}M._inheritsLoose(z,q);var B=z.prototype;B.init=function(){var r=M._asyncToGenerator(function*(){const x=d.load();this.addResolvingPromise(x);yield this.when()});return function(){return r.apply(this,arguments)}}();B.normalizeCtorArgs=function(r){r&&r.ioConfig&&
(r={...r,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:F.create(),...r.ioConfig}});return r};B.open=function(){var r=M._asyncToGenerator(function*(x){throw new n("BaseRaster:open-not-implemented","open() is not implemented");});return function(x){return r.apply(this,arguments)}}();B.fetchTile=function(){var r=M._asyncToGenerator(function*(x,v,E,t={}){const A=t.tileInfo||this.rasterInfo.storageInfo.tileInfo;x=this.getTileExtentFromTileInfo(x,v,E,A);return this.fetchPixels(x,A.size[0],
A.size[1],t)});return function(x,v,E){return r.apply(this,arguments)}}();B.identify=function(){var r=M._asyncToGenerator(function*(x,v={}){x=f.ensureClass(c,x).clone().normalize();const {multidimensionalDefinition:E,timeExtent:t}=v,{hasMultidimensionalTranspose:A,multidimensionalInfo:O}=this.rasterInfo;var {transposedVariableName:N}=v;const X=J.isSome(O)&&A&&(null!=t||g.isMultiSliceOrRangeDefinition(E));X&&!N&&(N=J.isSome(E)&&0<E.length?E[0].variableName??void 0:O.variables[0].name,v={...v,transposedVariableName:N});
v=this._getRequestOptionsWithSliceId(v);const {spatialReference:V,extent:W}=this.rasterInfo;var {datumTransformation:G}=v;G=d.projectPoint(x,V,G);if(!W.intersects(G)||J.isSome(this.rasterInfo.transform)&&(G=this.rasterInfo.transform.inverseTransform(G),!this.rasterInfo.nativeExtent.intersects(G)))return{location:G,value:null};let S=0;const T=J.isSome(N)&&J.isSome(O)&&this.rasterInfo.hasMultidimensionalTranspose;if(!T)if(v.srcResolution)S=d.snapPyramid(v.srcResolution,this.rasterInfo,this.ioConfig.sampling).pyramidLevel;
else if(S=yield this.computeBestPyramidLevelForLocation(x,v),null==S)return{location:G,value:null};x=this.identifyPixelLocation(G,S,null,T);if(null===x)return{location:G,value:null};const {row:aa,col:Z,rowOffset:Q,colOffset:Y,blockWidth:ba}=x;N=N??J.unwrap(v.sliceId);N=w.getRasterId(this.url,N);x=`${S}/${aa}/${Z}`;let ca=w.getBlock(N,null,x);J.isNone(ca)&&(ca=this.fetchRawTile(S,aa,Z,v),w.putBlock(N,null,x,ca));N=yield ca;return J.isNone(N)||!N.pixels?.length?{location:G,value:null}:this._processIdentifyResult(N,
{srcLocation:G,position:Q*ba+Y,pyramidLevel:S,useTransposedTile:!!T,requestSomeSlices:X,identifyOptions:v})});return function(x){return r.apply(this,arguments)}}();B.fetchPixels=function(){var r=M._asyncToGenerator(function*(x,v,E,t={}){x=d.snapExtent(x);t=this._getRequestOptionsWithSliceId(t);if(t.requestRawData)return this._fetchPixels(x,v,E,t);var A=d.getWorldWidth(x.spatialReference),O=d.getWorldWrapCount(x);if(J.isNone(A)||0===O||1===O&&this._isGlobalWrappableSource)return this._fetchPixels(x,
v,E,t);if(3<=O)return{extent:x,pixelBlock:null};const N=[],{xmin:X,xmax:V}=x,W=Math.round(A/(V-X)*v),G=W-Math.round((A/2-X)/(V-X)*v);let S=0;const T=[];for(let Z=0;Z<=O;Z++){var aa=new h({xmin:0===Z?X:-A/2,xmax:Z===O?V-A*Z:A/2,ymin:x.ymin,ymax:x.ymax,spatialReference:x.spatialReference});const Q=0===Z?W-G:Z===O?v-S:W;S+=Q;T.push(Q);aa=t.disableWrapAround&&0<Z?null:this._fetchPixels(aa,Q,E,t);N.push(aa)}A=(yield Promise.all(N)).map(Z=>Z?.pixelBlock);O=null;v={width:v,height:E};O=this.rasterJobHandler?
(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:A,srcMosaicSize:v,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:T},t)).pixelBlock:C.mosaic(A,v,{blockWidths:T});t=d.projectExtent(x,this.rasterInfo.spatialReference,t.datumTransformation);return{extent:x,srcExtent:t,pixelBlock:O}});return function(x,v,E){return r.apply(this,arguments)}}();B.fetchRawPixels=function(){var r=M._asyncToGenerator(function*(x,v,E,t={}){v={x:Math.floor(v.x),
y:Math.floor(v.y)};const A=yield this._fetchRawTiles(x,v,E,t),{nativeExtent:O,nativePixelSize:N,storageInfo:X}=this.rasterInfo;var V=2**x,W=N.x*V;V*=N.y;W=new h({xmin:O.xmin+W*v.x,xmax:O.xmin+W*(v.x+E.width-1),ymin:O.ymax-V*(v.y+E.height-1),ymax:O.ymax-V*v.y,spatialReference:O.spatialReference});if(!A)return{extent:W,srcExtent:W,pixelBlock:null};const {pixelBlocks:G,mosaicSize:S}=A;if(1===G.length&&J.isSome(G[0])&&G[0].width===E.width&&G[0].height===E.height)return{extent:W,srcExtent:W,pixelBlock:A.pixelBlocks[0]};
x={x:v.x%(0<x?X.pyramidBlockWidth:X.blockWidth),y:v.y%(0<x?X.pyramidBlockHeight:X.blockHeight)};E=this.rasterJobHandler?(yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:G,srcMosaicSize:S,destDimension:E,clipOffset:x,clipSize:E,coefs:null,sampleSpacing:null,interpolation:t.interpolation,alignmentInfo:null,blockWidths:null},t)).pixelBlock:C.mosaic(G,S,{clipOffset:x,clipSize:E});return{extent:W,srcExtent:W,pixelBlock:E}});return function(x,v,E){return r.apply(this,arguments)}}();B.fetchRawTile=
function(r,x,v,E){throw new n("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");};B.computeExtent=function(r){return d.projectExtent(this.rasterInfo.extent,r)};B.decodePixelBlock=function(r,x){return!this.rasterJobHandler||x.useCanvas?u.decode(r,x):this.rasterJobHandler.decode({data:r,options:x})};B.request=function(){var r=M._asyncToGenerator(function*(x,v,E=0){const {customFetchParameters:t}=this.ioConfig,{range:A,query:O,headers:N}=v;E=E??v.retryCount??this.ioConfig.retryCount;
const X=A?{Range:`bytes=${A.from}-${A.to}`}:null;try{return yield I(x,{...v,query:{...O,...t},headers:{...N,...X}})}catch(V){if(0<E)return E--,this.request(x,v,E);throw V;}});return function(x,v){return r.apply(this,arguments)}}();B.getSliceIndex=function(r){const {multidimensionalInfo:x}=this.rasterInfo;return J.isNone(x)||J.isNone(r)||0===r.length?null:g.getSliceIndex(r,x)};B.getTileExtentFromTileInfo=function(r,x,v,E){r=J.unwrapOrThrow(E.lodAt(r));return this.getTileExtent({x:r.resolution,y:r.resolution},
x,v,E.origin,E.spatialReference,E.size)};B.updateTileInfo=function(){const {storageInfo:r,spatialReference:x,extent:v,pixelSize:E}=this.rasterInfo;if(!r.tileInfo){const A=[];var t=r.maximumPyramidLevel||0;let O=Math.max(E.x,E.y),N=1/.0254*96*O;for(let X=0;X<=t;X++)A.push({level:t-X,resolution:O,scale:N}),O*=2,N*=2;t=new c({x:v.xmin,y:v.ymax,spatialReference:x});r.tileInfo=new F({origin:t,size:[r.blockWidth,r.blockHeight],spatialReference:x,lods:A});r.isVirtualTileInfo=!0}};B.createRemoteDatasetStorageInfo=
function(r,x=512,v=512,E){const {width:t,height:A,nativeExtent:O,pixelSize:N,spatialReference:X}=r,V=new c({x:O.xmin,y:O.ymax,spatialReference:X});null==E&&(E=Math.max(0,Math.round(Math.log(Math.max(t,A))/Math.LN2-8)));const W=this.computeBlockBoundary(O,512,512,{x:O.xmin,y:O.ymax},[N],E);r.storageInfo=new K({blockWidth:x,blockHeight:v,pyramidBlockWidth:x,pyramidBlockHeight:v,origin:V,firstPyramidLevel:1,maximumPyramidLevel:E,blockBoundary:W})};B.computeBestPyramidLevelForLocation=function(){var r=
M._asyncToGenerator(function*(x,v){return 0});return function(x){return r.apply(this,arguments)}}();B.computeBlockBoundary=function(r,x,v,E,t,A=0,O=2){if(1===t.length&&0<A){t=[...t];let {x:V,y:W}=t[0];for(let G=0;G<A;G++)V*=O,W*=O,t.push({x:V,y:W})}A=[];const {x:N,y:X}=E;for(E=0;E<t.length;E++){const {x:V,y:W}=t[E];A.push({minCol:Math.floor((r.xmin-N+.1*V)/x/V),maxCol:Math.floor((r.xmax-N-.1*V)/x/V),minRow:Math.floor((X-r.ymax+.1*W)/v/W),maxRow:Math.floor((X-r.ymin-.1*W)/v/W)})}return A};B.getPyramidPixelSize=
function(r){const {nativePixelSize:x}=this.rasterInfo,{pyramidResolutions:v,pyramidScalingFactor:E}=this.rasterInfo.storageInfo;if(0===r)return x;if(J.isSome(v)&&v.length)return v[r-1];r=E**r;return{x:x.x*r,y:x.y*r}};B.identifyPixelLocation=function(r,x,v,E){const {spatialReference:t,nativeExtent:A,storageInfo:O}=this.rasterInfo,{maximumPyramidLevel:N,origin:X,transposeInfo:V}=O,W=E&&J.isSome(V)?V.tileSize[0]:O.blockWidth;E=E&&J.isSome(V)?V.tileSize[1]:O.blockHeight;r=d.projectPoint(r,t,v);if(!A.intersects(r)||
0>x||x>N)return null;v=this.getPyramidPixelSize(x);const {x:G,y:S}=v;v=(X.y-r.y)/S/E;const T=(r.x-X.x)/G/W;return{pyramidLevel:x,row:Math.floor(v),col:Math.floor(T),rowOffset:Math.min(E-1,Math.floor((v-Math.floor(v))*E)),colOffset:Math.min(W-1,Math.floor((T-Math.floor(T))*W)),blockWidth:W,srcLocation:r}};B.getTileExtent=function(r,x,v,E,t,A){const [O,N]=A;v=E.x+v*O*r.x;x=E.y-x*N*r.y;return new h({xmin:v,xmax:v+O*r.x,ymin:x-N*r.y,ymax:x,spatialReference:t})};B.getBlockWidthHeight=function(r){return{blockWidth:0<
r?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<r?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}};B.isBlockOutside=function(r,x,v){r=this.rasterInfo.storageInfo.blockBoundary[r];return!r||r.maxRow<x||r.maxCol<v||r.minRow>x||r.minCol>v};B._fetchPixels=function(){var r=M._asyncToGenerator(function*(x,v,E,t={}){var A=d.getWorldWrapCount(x);if(2<=A)return{extent:x,pixelBlock:null};var O=this._getSourceDataInfo(x,
v,E,t);const {pyramidLevel:N,pyramidResolution:X,srcResolution:V,srcExtent:W,srcWidth:G,srcHeight:S}=O;if(0===G||0===S)return{extent:x,srcExtent:W,pixelBlock:null};var T=J.unwrap(this.rasterInfo.transform),aa="gcs-shift"===T?.type,Z=J.isSome(d.getWorldWidth(x.spatialReference));if(aa||!Z)A=d.getWorldWrapCount(O.srcExtent,aa);var Q=this.rasterInfo.storageInfo,Y={x:Math.floor((W.xmin-Q.origin.x)/X.x+.1),y:Math.floor((Q.origin.y-W.ymax)/X.y+.1)};O=yield this._fetchRawTiles(N,Y,{width:G,height:S,wrapCount:A},
t);if(!O)return{extent:x,srcExtent:W,pixelBlock:null};aa=0<N?Q.pyramidBlockWidth:Q.blockWidth;const ba=0<N?Q.pyramidBlockHeight:Q.blockHeight,ca=aa===G&&ba===S&&0===Y.x%aa&&0===Y.y%ba;Y=new c({x:(x.xmax-x.xmin)/v,y:(x.ymax-x.ymin)/E,spatialReference:x.spatialReference});const fa=!x.spatialReference.equals(this.rasterInfo.spatialReference);({datumTransformation:Q}=t);if(!fa&&ca&&1===O.pixelBlocks.length&&aa===v&&ba===E&&V.x===Y.x&&V.y===Y.y)return{extent:x,srcExtent:W,pixelBlock:O.pixelBlocks[0]};
aa=Z&&J.isSome(d.getWorldWidth(W.spatialReference));(Z=t.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&(yield d.load());A=this.rasterJobHandler?yield this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:x,srcBufferExtent:O.extent,pixelSize:Y.toJSON(),datumTransformation:Q,rasterTransform:T,hasWrapAround:0<A||aa,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:Z},t):d.getProjectionOffsetGrid({projectedExtent:x,
srcBufferExtent:O.extent,pixelSize:Y,datumTransformation:Q,rasterTransform:T,hasWrapAround:0<A||aa,isAdaptive:!1,includeGCSGrid:Z});T=!t.requestRawData;aa={rows:A.spacing[0],cols:A.spacing[1]};Y=J.unwrap(this._getRasterTileAlignmentInfo(N,O.extent.xmin));const {pixelBlocks:ha,mosaicSize:ka,isPartiallyFilled:ma}=O;O=null;this.rasterJobHandler?(v=yield this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:ha,srcMosaicSize:ka,destDimension:T?{width:v,height:E}:null,coefs:T?A.coefficients:null,sampleSpacing:T?
aa:null,projectDirections:Z,gcsGrid:Z?A.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:t.interpolation,alignmentInfo:Y,blockWidths:null},t),{pixelBlock:T,localNorthDirections:O}=v):(Y=C.mosaic(ha,ka,{alignmentInfo:Y}),T=T?C.approximateTransform(Y,{width:v,height:E},A.coefficients,aa,t.interpolation):Y,Z&&A.gcsGrid&&(O=C.getLocalArithmeticNorthRotations({width:v,height:E},A.gcsGrid),T=b.convertToLocalDirections(T,this.rasterInfo.dataType,O)));return t.requestRawData||Z?{srcExtent:W,
pixelBlock:T,transformGrid:A,localNorthDirections:O,extent:x,isPartiallyFilled:ma}:{srcExtent:W,extent:x,pixelBlock:T}});return function(x,v,E){return r.apply(this,arguments)}}();B._fetchRawTiles=function(){var r=M._asyncToGenerator(function*(x,v,E,t){const {origin:A,blockBoundary:O}=this.rasterInfo.storageInfo,{blockWidth:N,blockHeight:X}=this.getBlockWidthHeight(x);let {x:V,y:W}=v,{width:G,height:S,wrapCount:T}=E;var aa=this._getRasterTileAlignmentInfo(x,0);t.buffer&&(V-=t.buffer.cols,W-=t.buffer.rows,
G+=2*t.buffer.cols,S+=2*t.buffer.rows);var Z=0,Q=0;let Y=0;T&&J.isSome(aa)&&({worldColumnCountFromOrigin:Q,originColumnOffset:Y,rightPadding:Z}=aa,Q*aa.blockWidth-Z>=V+G&&(Z=0));v=Math.floor(V/N);E=Math.floor(W/X);const ba=Math.floor((V+G+Z-1)/N);Z=Math.floor((W+S+Z-1)/X);var ca=O[x];if(!ca)return null;const {minRow:fa,minCol:ha,maxCol:ka,maxRow:ma}=ca;if(0===T&&(Z<fa||ba<ha||E>ma||v>ka))return null;ca=[];let na=!1;const ra=null==this.ioConfig.allowPartialFill?t.allowPartialFill:this.ioConfig.allowPartialFill;
for(let qa=E;qa<=Z;qa++)for(let oa=v;oa<=ba;oa++){let U=oa;!t.disableWrapAround&&T&&J.isSome(aa)&&Q<=oa&&(U=oa-Q-Y);if(qa>=fa&&U>=ha&&ma>=qa&&ka>=U){const ia=this._fetchRawTile(x,qa,U,t);ra?ca.push(new Promise(da=>{ia.then(la=>da(la)).catch(()=>{na=!0;da(null)})})):ca.push(ia)}else ca.push(Promise.resolve(null))}if(0===ca.length)return null;t=yield Promise.all(ca);aa={height:(Z-E+1)*X,width:(ba-v+1)*N};({spatialReference:Q}=this.rasterInfo);x=this.getPyramidPixelSize(x);const {x:ta,y:pa}=x;return{extent:new h({xmin:A.x+
v*N*ta,xmax:A.x+(ba+1)*N*ta,ymin:A.y-(Z+1)*X*pa,ymax:A.y-E*X*pa,spatialReference:Q}),pixelBlocks:t,mosaicSize:aa,isPartiallyFilled:na}});return function(x,v,E,t){return r.apply(this,arguments)}}();B._fetchRawTile=function(r,x,v,E){var t=this.rasterInfo.storageInfo.blockBoundary[r];if(!t)return Promise.resolve(null);const {minRow:A,minCol:O,maxCol:N,maxRow:X}=t;if(x<A||v<O||x>X||v>N)return Promise.resolve(null);const V=w.getRasterId(this.url,E.sliceId),W=`${r}/${x}/${v}`;t=w.getBlock(V,E.registryId,
W);if(J.isNone(t)){const G=new AbortController;t=this.fetchRawTile(r,x,v,{...E,signal:G.signal});w.putBlock(V,E.registryId,W,t,G);t.catch(()=>w.deleteBlock(V,E.registryId,W))}if(E.signal)k.onAbort(E,()=>{w.decreaseRefCount(V,E.registryId,W)});return t};B._computeMagDirValues=function(r){const {bandCount:x,dataType:v}=this.rasterInfo;if((2!==x||"vector-magdir"!==v)&&"vector-uv"!==v||2!==r?.length||!r[0]?.length)return null;var E=r[0].length;if("vector-magdir"===v)return E=r[1].map(N=>(N+360)%360),
[r[0],E];const [t,A]=r;r=[];const O=[];for(let N=0;N<E;N++){const [X,V]=b.uvComponentToVector([t[N],A[N]]);r.push(X);O.push(V)}return[r,O]};B._getRasterTileAlignmentInfo=function(r,x){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=d.getRasterDatasetAlignmentInfo(this.rasterInfo));return J.isNone(this._rasterTileAlighmentInfo.pyramidsInfo)?null:{startX:x,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,
...this._rasterTileAlighmentInfo.pyramidsInfo[r]}};B._getSourceDataInfo=function(r,x,v,E={}){const t={datumTransformation:E.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0};E.srcResolution&&(t.srcResolution=E.srcResolution,this._updateSourceDataInfo(r,t));var A=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:O,srcHeight:N,pyramidLevel:X}=t;var V=O/x;const W=N/v,G=X<A&&16<=V*W;if(G||X===A&&(8<V||8<W)||0===O||0===
N){var S=new c({x:(r.xmax-r.xmin)/x,y:(r.ymax-r.ymin)/v,spatialReference:r.spatialReference});S=d.projectResolution(S,this.rasterInfo.spatialReference,r,t.datumTransformation);const T=!S||E.srcResolution&&S.x+S.y<E.srcResolution.x+E.srcResolution.y;G&&E.srcResolution&&T&&(V=Math.round(Math.log(Math.max(V,W))/Math.LN2)-1,A-X+3>=V&&(A=2**V,S={x:E.srcResolution.x*A,y:E.srcResolution.y*A}));S&&(t.srcResolution=S,this._updateSourceDataInfo(r,t))}if(8<t.srcWidth/x||8<t.srcHeight/v)t.srcWidth=0,t.srcHeight=
0;return t};B._updateSourceDataInfo=function(r,x){x.srcWidth=0;x.srcHeight=0;var v=this.rasterInfo.spatialReference;const {srcResolution:E,datumTransformation:t}=x,{pyramidLevel:A,pyramidResolution:O,excessiveReading:N}=d.snapPyramid(E,this.rasterInfo,this.ioConfig.sampling);N||(r=x.srcExtent||d.projectExtent(r,v,t),null!=r&&((v=J.unwrap(this.rasterInfo.transform))&&(r=v.inverseTransform(r)),x.srcExtent=r,v=Math.ceil((r.xmax-r.xmin)/O.x-.1),r=Math.ceil((r.ymax-r.ymin)/O.y-.1),x.pyramidLevel=A,x.pyramidResolution=
O,x.srcWidth=v,x.srcHeight=r))};B._getRequestOptionsWithSliceId=function(r){J.isSome(this.rasterInfo.multidimensionalInfo)&&null==r.sliceId&&(r={...r,sliceId:this.getSliceIndex(r.multidimensionalDefinition)});return r};B._processIdentifyResult=function(r,x){const {srcLocation:v,position:E,pyramidLevel:t,useTransposedTile:A}=x,O=r.pixels[0].length/r.width/r.height;if(r.mask&&!r.mask[E])return{location:v,value:null};const {multidimensionalInfo:N}=this.rasterInfo;if(J.isNone(N)||!A)return x=r.pixels.map(T=>
T[E]),r={location:v,value:x,pyramidLevel:t},x=this._computeMagDirValues(x.map(T=>[T])),x?.length&&(r.magdirValue=x.map(T=>T[0])),r;let X=r.pixels.map(T=>Array.prototype.slice.call(T,E*O,E*O+O)),V=this._computeMagDirValues(X);const {requestSomeSlices:W,identifyOptions:G}=x;let S=g.createSlices(N,G.transposedVariableName);if(W){const T=g.getSliceIds(S,J.unwrap(G.multidimensionalDefinition),J.unwrap(G.timeExtent));X=X.map(aa=>T.map(Z=>aa[Z]));V=V?.map(aa=>T.map(Z=>aa[Z]));S=T.map(aa=>S[aa])}r=S.map((T,
aa)=>{T={value:X.map(Z=>Z[aa]),multidimensionalDefinition:T.multidimensionalDefinition.map(Z=>new y({...Z,isSlice:!0}))};V?.length&&(T.magdirValue=[V[0][aa],V[1][aa]]);return T});return{location:v,value:null,dataSeries:r,pyramidLevel:t}};M._createClass(z,[{key:"_isGlobalWrappableSource",get:function(){const {rasterInfo:r}=this,x=d.getWorldWidth(r.spatialReference);return J.isSome(x)&&r.extent.width>=x/2}},{key:"url",set:function(r){this._set("url",e.sanitizeUrl(r,P.getLogger(this.declaredClass)))}}]);
return z}(L.EsriPromiseMixin(R.JSONSupport));D.__decorate([l.property()],H.prototype,"_rasterTileAlighmentInfo",void 0);D.__decorate([l.property({readOnly:!0})],H.prototype,"_isGlobalWrappableSource",null);D.__decorate([l.property(p.url)],H.prototype,"url",null);D.__decorate([l.property({type:String,json:{write:!0}})],H.prototype,"datasetName",void 0);D.__decorate([l.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);D.__decorate([l.property()],H.prototype,"rasterInfo",void 0);
D.__decorate([l.property()],H.prototype,"ioConfig",void 0);D.__decorate([l.property()],H.prototype,"sourceJSON",void 0);return H=D.__decorate([m.subclass("esri.layers.support.rasterDatasets.BaseRaster")],H)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),
function(M,D,H,I,n,R,P,J){var L;H=L=function(k){function l(){var a=k.apply(this,arguments)||this;a.blockWidth=void 0;a.blockHeight=void 0;a.compression=null;a.origin=null;a.firstPyramidLevel=null;a.maximumPyramidLevel=null;a.pyramidScalingFactor=2;a.pyramidBlockWidth=null;a.pyramidBlockHeight=null;a.isVirtualTileInfo=!1;a.tileInfo=null;a.transposeInfo=null;a.blockBoundary=null;return a}M._inheritsLoose(l,k);l.prototype.clone=function(){return new L({blockWidth:this.blockWidth,blockHeight:this.blockHeight,
compression:this.compression,origin:I.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:I.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:I.clone(this.tileInfo),transposeInfo:I.clone(this.transposeInfo),blockBoundary:I.clone(this.blockBoundary)})};return l}(H.JSONSupport);
D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"blockWidth",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"blockHeight",void 0);D.__decorate([n.property({type:String,json:{write:!0}})],H.prototype,"compression",void 0);D.__decorate([n.property({type:J,json:{write:!0}})],H.prototype,"origin",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"firstPyramidLevel",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],
H.prototype,"maximumPyramidLevel",void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"pyramidResolutions",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"pyramidScalingFactor",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"pyramidBlockWidth",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],H.prototype,"pyramidBlockHeight",void 0);D.__decorate([n.property({type:Boolean,json:{write:!0}})],H.prototype,"isVirtualTileInfo",
void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"tileInfo",void 0);D.__decorate([n.property()],H.prototype,"transposeInfo",void 0);D.__decorate([n.property()],H.prototype,"blockBoundary",void 0);return H=L=D.__decorate([P.subclass("esri.layers.support.RasterStorageInfo")],H)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/maybe","../DimensionalDefinition"],function(M,D,H){function I(l,a,f){const m=a.shift();0===f.length&&f.push({sliceId:-1,
multidimensionalDefinition:[]});const e=f.length;for(let p=0;p<e;p++){const y=f.shift().multidimensionalDefinition;m.values?.forEach(K=>{f.push({sliceId:-1,multidimensionalDefinition:[...y,{variableName:l,dimensionName:m.name,values:[K]}]})})}a.length&&I(l,a,f)}function n(l,a){return Array.isArray(l)?a[0]===a[1]?l[0]===a[0]||l[1]===a[0]:l[0]>=a[0]&&l[0]<=a[1]&&l[1]>=a[0]&&l[1]<=a[1]:l>=a[0]&&l<=a[1]}function R(l,a){return l[0]<=a[0]&&l[1]>=a[0]||l[0]<=a[1]&&l[1]>=a[1]||l[0]>=a[0]&&l[1]<=a[1]}function P(l){return 1===
l.length?[l[0],l[0]]:[l[0],l[l.length-1]]}function J(l,a,f){if(!a?.subsetDefinitions?.length)return l;if(f){const {variables:e}=a;if(e.length&&!e.includes(f))return null;a=a.subsetDefinitions.find(p=>p.dimensionName===l.name&&p.variableName===f);if(!a?.values?.length)return l;a=P(a.values)}else a=a.dimensions.find(({name:e})=>e===l.name)?.extent;const m=a;if(!m||!m?.length)return l;a=l.values.filter(e=>n(e,m));return{...l,extent:[...m],values:a}}function L(l,a){var {values:f}=a;if(f?.length)return Array.isArray(f[0])!==
Array.isArray(l)?-1:Array.isArray(f[0])?f.findIndex(p=>p[0]===l[0]&&p[1]===l[1]):f.indexOf(l);var {extent:m}=a;if(Array.isArray(l)||l<m[0]||l>m[1])return-1;f=a.interval||1;if("ISO8601"!==a.unit)return Math.round((l-m[0])/f);m=m[0];let e=-1;switch(a.intervalUnit?.toLowerCase()||"seconds"){case "seconds":e=Math.round((l-m)/1E3/f);break;case "minutes":e=Math.round((l-m)/6E4/f);break;case "hours":e=Math.round((l-m)/36E5/f);break;case "days":e=Math.round((l-m)/864E5/f);break;case "months":a=(new Date(l)).getUTCFullYear()-
(new Date(m)).getUTCFullYear();f=(new Date(m)).getUTCMonth();m=(new Date(l)).getUTCMonth();e=0===a?m-f:m+11-f+12*(a-1);break;case "years":e=Math.round(((new Date(l)).getUTCFullYear()-(new Date(m)).getUTCFullYear())/f);break;case "decades":e=Math.round(((new Date(l)).getUTCFullYear()-(new Date(m)).getUTCFullYear())/10/f)}return e}function k(l){var a=l.values?.length;if(a)return a;const {extent:f,unit:m}=l;a=l.interval||1;var e=f?f[1]-f[0]:0;if("ISO8601"!==m)return Math.round(e/a);switch(l.intervalUnit?.toLowerCase()??
"seconds"){case "seconds":a=Math.round(e/1E3/a);break;case "minutes":a=Math.round(e/6E4/a);break;case "hours":a=Math.round(e/36E5/a);break;case "days":a=Math.round(e/864E5/a);break;case "months":l=(new Date(f[1])).getUTCFullYear()-(new Date(f[0])).getUTCFullYear();a=(new Date(f[1][0])).getUTCMonth();e=(new Date(f[1][1])).getUTCMonth();a=0===l?e-a+1:e+11-a+12*(l-1)+1;break;case "years":a=Math.round(((new Date(f[1])).getUTCFullYear()-(new Date(f[0])).getUTCFullYear())/a);break;case "decades":a=Math.round(((new Date(f[1])).getUTCFullYear()-
(new Date(f[0])).getUTCFullYear())/10/a);break;default:a=0}return a}M.createSlices=function(l,a){const f=[];let m=0;(a?l.variables.filter(e=>e.name.toLowerCase()===a.toLowerCase()):[...l.variables].sort((e,p)=>e.name>p.name?1:-1)).forEach(e=>{const p=[],y=[...e.dimensions].sort((K,F)=>K.name>F.name?-1:1);I(e.name,y,p);p.forEach(K=>{f.push({...K,sliceId:m++})})});return f};M.getDefaultMultidimensionalDefinition=function(l,a={}){const {multidimensionalInfo:f,keyProperties:m}=l;if(D.isNone(f))return null;
const e=a.variableName||m?.DefaultVariable;({variables:l}=f);const {multidimensionalSubset:p}=a;p?.variables?.length&&(l=l.filter(({name:g})=>p.variables.includes(g)));var y=e?l.find(({name:g})=>g===e)??l[0]:l[0];if(!y)return null;l=[];const {dimensions:K,name:F}=y;if(0===K.length)return[new H({variableName:F,dimensionName:"",values:[],isSlice:!0})];for(y=0;y<K.length;y++){const g=J(K[y],p,F);if(!g)return null;const {values:w,extent:u}=g;let C=w?.[0]??u[0];"stdz"===g.name.toLowerCase()&&!g.hasRanges&&
Math.abs(u[1])<=Math.abs(u[0])&&(C=w?.length?w[w.length-1]:u[1]);l.push(new H({variableName:F,dimensionName:g.name,values:[C],isSlice:a.useRangeForRangedDimensionInfo?!!g.hasRanges:!0}))}return l};M.getSliceIds=function(l,a,f){let m=l;a&&(a=[...a].sort((e,p)=>e.dimensionName<p.dimensionName?-1:1),a.forEach(({dimensionName:e,values:p,isSlice:y})=>{p.length&&(m=m.filter(K=>{K=K.multidimensionalDefinition.find(g=>g.dimensionName===e);if(null==K)return!1;const F=K.values[0];return"number"===typeof F?
"number"===typeof p[0]?p.includes(F):p.some(g=>g[0]<=F&&g[1]>=F):"number"===typeof p[0]?p.some(g=>F[0]<=g&&F[1]>=g):y?p.some(g=>g[0]===F[0]&&g[0]===F[1]):p.some(g=>g[0]>=F[0]&&g[0]<=F[1]||g[1]>=F[0]&&g[1]<=F[1]||g[0]<F[0]&&g[1]>F[1])}))}));if(m.length&&f&&D.isSome(f.start)&&D.isSome(f.end)){const e=f.start.getTime(),p=f.end.getTime(),y=m[0].multidimensionalDefinition.findIndex(K=>"StdTime"===K.dimensionName);-1<y&&(m=m.filter(K=>{K=K.multidimensionalDefinition[y].values[0];return e<=K&&p>=K}))}return m.map(e=>
e.sliceId)};M.getSliceIndex=function(l,a){let f=0;var m=l[0].variableName;a=[...a.variables].sort((p,y)=>p.name>y.name?1:-1);for(var e=0;e<a.length;e++){const p=a[e],y=[...p.dimensions].sort((K,F)=>K.name>F.name?-1:1);if(p.name!==m)f+=y.map(K=>k(K)).reduce((K,F)=>K*F);else{m=y.map(K=>k(K));a=y.length;for(let K=0;K<a;K++){e=l.find(F=>F.dimensionName===y[K].name);if(null==e)return null;e=L(e.values[0],y[K]);if(-1===e)return null;m.shift();f=K===a-1?f+e:f+e*m.reduce((F,g)=>F*g)}break}}return f};M.getSubsetVariablesFromMdInfo=
function(l,a){if(D.isNone(a)||D.isNone(l))return null;a=a.variables.map(f=>({...f}));l?.variables?.length&&(a=a.filter(({name:f})=>l.variables.includes(f)),a.forEach(f=>{f.dimensions=f.dimensions.map(m=>J(m,l,f.name))}));return a};M.hasExcludedVariableOrDimension=function(l,a,f){if(!a?.subsetDefinitions?.length)return!1;const {variables:m}=a;if(m.length&&l.some(({variableName:e})=>e&&!m.includes(e)))return!0;for(let e=0;e<l.length;e++){const p=l[e],y=a.subsetDefinitions.find(K=>(""===p.variableName||
K.variableName===p.variableName)&&K.dimensionName===p.dimensionName);if(y?.values.length){const K=P(y.values);if(!p.isSlice&&2===p.values.length&&!Array.isArray(p.values[0])&&p.values[0]!==p.values[1]&&f){if(!R(p.values,K))return!0}else if(p.values.some(F=>!n(F,K)))return!0}}return!1};M.isMultiSliceOrRangeDefinition=function(l){return D.isNone(l)||!l.length?!1:l.some(a=>{if(null==a.values)return!0;const f=a.values.length;return 0===f||1<f||!a.isSlice&&Array.isArray(a.values[0])})};Object.defineProperties(M,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define("exports ../../../geometry ../../../core/maybe ./EphemeralBlockCache ../rasterFunctions/rasterProjectionHelper ../../../geometry/Point".split(" "),function(M,D,H,I,n,R){function P(k,l){return(k=J.get(k))?k[l]??null:null}const J=new Map,L=new I;M.decreaseRefCount=function(k,l,a){const f=J.get(k);if(!f)return null==l?L.decreaseRefCount(k,a):0;if(null==l||null==f[l])return L.decreaseRefCount(k,
a);l=f[l]?.cache;k=l?.get(a);if(l&&k){k.refCount--;if(0===k.refCount){l.delete(a);for(l=0;l<f.length;l++)f[l]?.cache.delete(a);k.controller&&k.controller.abort()}return k.refCount}return 0};M.deleteBlock=function(k,l,a){const f=J.get(k);f?null==l||null==f[l]?L.deleteBlock(k,a):f[l]?.cache.delete(a):null==l&&L.deleteBlock(k,a)};M.deleteRaster=function(k){J.delete(k)};M.getBlock=function(k,l,a){const f=J.get(k);if(!f)return null==l?L.getBlock(k,a):null;if(null==l||null==f[l]){for(l=0;l<f.length;l++){var m=
f[l]?.cache.get(a);if(m)return m.refCount++,m.block}return L.getBlock(k,a)}if(k=f[l]?.cache.get(a))return k.refCount++,k.block;for(k=0;k<f.length;k++){if(k===l||!f[k])continue;m=f[k]?.cache;const e=m?.get(a);if(m&&e)return e.refCount++,m.set(a,e),e.block}return null};M.getRasterId=function(k,l){return null==l?k:`${k}?sliceId=${l}`};M.putBlock=function(k,l,a,f,m=null){const e=J.get(k);if(e)if(null==l||null==e[l])L.putBlock(k,a,f,m);else{var p={refCount:1,block:f,isResolved:!1,isRejected:!1,controller:m};
f.then(()=>p.isResolved=!0).catch(()=>p.isRejected=!0);e[l]?.cache.set(a,p)}else null==l&&L.putBlock(k,a,f,m)};M.register=function(k,l){l={extent:null,rasterInfo:l,cache:new Map};const a=J.get(k);if(a)return a.push(l),a.length-1;J.set(k,[l]);return 0};M.unregister=function(k,l){const a=J.get(k);a&&(a[l]=null,a.some(f=>null!=f)||J.delete(k))};M.update=function(k,l,a,f,m,e,p=null){if(k=P(k,l)){l=k.extent;var {cache:y,rasterInfo:K}=k;if(!l||l.xmin!==a.xmin||l.xmax!==a.xmax||l.ymin!==a.ymin||l.ymax!==
a.ymax){f=f??0;l=a.clone().normalize();var {spatialReference:F,transform:g}=K,w=new Set;for(let h=0;h<l.length;h++){var u=l[h];if(u.xmax-u.xmin<=f||u.ymax-u.ymin<=f)continue;var C=n.projectExtent(u,F,p);H.isSome(g)&&(C=g.inverseTransform(C));var d=new R({x:f,y:f,spatialReference:u.spatialReference});if(null==m&&(m=n.projectResolution(d,F,u,p),!m))return;const {pyramidLevel:q,pyramidResolution:z,excessiveReading:B}=n.snapPyramid(m,K,e||"closest");if(B)return;({storageInfo:u}=K);var {origin:b}=u;d=
Math.max(0,Math.floor((C.xmin-b.x)/z.x));b=Math.max(0,Math.floor((b.y-C.ymax)/z.y));const r=0<q?u.pyramidBlockWidth:u.blockWidth,x=0<q?u.pyramidBlockHeight:u.blockHeight;u=Math.max(0,Math.floor(d/r)-1);var c=Math.max(0,Math.floor(b/x)-1);d=Math.floor((d+Math.ceil((C.xmax-C.xmin)/z.x-.1)-1)/r)+1;C=Math.floor((b+Math.ceil((C.ymax-C.ymin)/z.y-.1)-1)/x)+1;for(b=c;b<=C;b++)for(c=u;c<=d;c++)w.add(`${q}/${b}/${c}`)}y.forEach((h,q)=>{w.has(q)||(h=y.get(q),(null==h||h.isResolved||h.isRejected)&&y.delete(q))});
k.extent={xmin:a.xmin,ymin:a.ymin,xmax:a.xmax,ymax:a.ymax}}}};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(function(){return function(){function M(H=15E3,I=5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=H;this._interval=Math.min(H,I)}var D=M.prototype;D.decreaseRefCount=function(H,I){H=H+"/"+I;I=this._cachedBlocks;if(I.has(H)){const n=I.get(H);n.refCount--;
0>=n.refCount&&(I.delete(H),n.controller&&n.controller.abort());return n.refCount}return 0};D.getBlock=function(H,I){H=H+"/"+I;I=this._cachedBlocks;if(I.has(H)){const n=I.get(H);n.ts=Date.now();n.refCount++;I.delete(H);I.set(H,n);return n.block}return null};D.putBlock=function(H,I,n,R){const P=this._cachedBlocks;H=H+"/"+I;P.has(H)?(n=P.get(H),n.ts=Date.now(),n.refCount++):P.set(H,{block:n,ts:Date.now(),refCount:1,controller:R});this._trim();this._updateTimer()};D.deleteBlock=function(H,I){const n=
this._cachedBlocks;H=H+"/"+I;n.has(H)&&n.delete(H)};D.updateMaxSize=function(H){this._size=H;this._trim()};D.empty=function(){this._cachedBlocks.clear();this._clearTimer()};D.getCurrentSize=function(){return this._cachedBlocks.size};D._updateTimer=function(){if(null==this._timer){var H=this._cachedBlocks;this._timer=setInterval(()=>{const I=Array.from(H),n=Date.now();for(let R=0;R<I.length;R++)if(I[R][1].ts<=n-this._duration)H.delete(I[R][0]);else break;0===H.size&&this._clearTimer()},this._interval)}};
D._trim=function(){const H=this._cachedBlocks;if(!(-1===this._size||this._size>=H.size)){var I=Array.from(H);for(let n=0;n<I.length-this._size;n++)H.delete(I[n][0])}};D._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return M}()})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a){function f(G,S,T){return!J.canProjectWithoutEngine(G,S,T)}function m(G,S,T){if((G=f(G,S,T))&&!J.isLoaded())throw new I("rasterprojectionhelper-project","projection engine is not loaded");return G}function e(){e=D._asyncToGenerator(function*(){J.isLoaded()||(yield J.load())});return e.apply(this,arguments)}function p(G,S,T,aa=null){const Z=G.spatialReference;if(Z.equals(S))return G;m(Z,S,aa);T=T.center;T=new L({xmin:T.x-G.x/2,xmax:T.x+G.x/2,ymin:T.y-G.y/2,ymax:T.y+
G.y/2,spatialReference:Z});aa=J.project(T,S,aa);T=r(S);n.isNone(aa)||n.isSome(T)&&aa.width>=T?(S=R.getMetersPerUnitForSR(Z)/R.getMetersPerUnitForSR(S),G={x:G.x*S,y:G.y*S}):G={x:aa.width,y:aa.height};return G}function y(G,S=.01){return R.getMetersPerUnitForSR(G)?S/R.getMetersPerUnitForSR(G):0}function K(G,S,T=null,aa=!0){const Z=G.spatialReference;if(Z.equals(S))return G;m(Z,S,T);T=J.project(G,S,T);if(!aa||!T)return T;F([G],[T],Z,S);return T}function F(G,S,T,aa){const Z=x(T,!0),Q=x(aa,!0);T=y(T,500);
aa=y(aa,500);if(T&&n.isSome(Z)&&n.isSome(Q))for(let Y=0;Y<G.length;Y++){const ba=S[Y];if(!ba)continue;const {x:ca}=G[Y],{x:fa}=ba;fa>=Q[1]-aa&&Math.abs(ca-Z[0])<T?ba.x-=Q[1]-Q[0]:fa<=Q[0]+aa&&Math.abs(ca-Z[1])<T&&(ba.x+=Q[1]-Q[0])}}function g(G){const {inSR:S,outSR:T,datumTransformation:aa,preferPE:Z}=G;if(S.equals(T))return{points:G}=b(G,null),G;if(S.isWebMercator&&T.isWGS84||S.isWGS84&&T.isWebMercator){const {cols:fa,rows:ha,xres:ka,yres:ma,usePixelCenter:na,inSR:ra,outSR:ta}=G;let {xmin:pa,ymax:qa}=
G;na&&(pa+=ka/2,qa-=ma/2);G=[];var Q=[],Y=Math.max(fa,ha);for(var ba=0;ba<Y;ba++){var ca=J.project(new k({x:pa+ka*Math.min(fa,ba),y:qa-ma*Math.min(ha,ba),spatialReference:ra}),ta);ba<=fa&&G.push(ca.x);ba<=ha&&Q.push(ca.y)}Y=[];for(ba=0;ba<fa;ba++)for(ca=0;ca<ha;ca++)Y.push([G[ba],Q[ca]]);return Y}if(m(S,T,aa)&&Z){if(S.isGeographic)return u(G);Q=C(S);if(n.isSome(Q))return u(G)}return w(G)}function w(G){var {points:S}=b(G,null);const {inSR:T,outSR:aa,datumTransformation:Z}=G;G=S.map(Q=>new k(Q[0],Q[1],
T));S=J.project(G,aa,Z);Z&&F(G,S,T,aa);return S.map(Q=>Q?[Q.x,Q.y]:[NaN,NaN])}function u(G){const {inSR:S,outSR:T,datumTransformation:aa}=G;var Z=C(S);const {points:Q,mask:Y}=b(G,Z);S.isGeographic||(G=S.wkid?P.PeFactory.coordsys(S.wkid):P.PeFactory.fromString(S.isGeographic?P.PeDefs.PE_TYPE_GEOGCS:P.PeDefs.PE_TYPE_PROJCS,S.wkt),P.PeCSTransformations.projToGeog(G,Q.length,Q));if(n.isSome(aa)&&aa.steps.length){var ba;T.isGeographic&&(ba=Q.map(([ca])=>179.9955<ca?1:-179.9955>ca?-1:0));aa.steps.forEach(ca=>
{const fa=ca.wkid?P.PeFactory.geogtran(ca.wkid):P.PeFactory.fromString(P.PeDefs.PE_TYPE_GEOGTRAN,ca.wkt);P.PeGTTransformations.geogToGeog(fa,Q.length,Q,null,ca.isInverse?P.PeDefs.PE_TRANSFORM_2_TO_1:P.PeDefs.PE_TRANSFORM_1_TO_2)});if(ba)for(G=0;G<Q.length;G++){Z=ba[G];const ca=Q[G][0],fa=179.9955<ca?1:-179.9955>ca?-1:0;Z&&fa&&Z!==fa&&(Q[G][0]=0<Z?ca+360:ca-360)}}T.isGeographic||(ba=C(T,!0),ba=n.isSome(ba)&&ba.isEnvelope?[ba.bbox[1],ba.bbox[3]]:[-90,90],c(Q,ba),ba=T.wkid?P.PeFactory.coordsys(T.wkid):
P.PeFactory.fromString(T.isGeographic?P.PeDefs.PE_TYPE_GEOGCS:P.PeDefs.PE_TYPE_PROJCS,T.wkt),P.PeCSTransformations.geogToProj(ba,Q.length,Q));ba=Q;if(Y&&Q.length!==Y.length){ba=[];for(let ca=0,fa=0;ca<Y.length;ca++)Y[ca]?ba.push(Q[fa++]):ba.push([NaN,NaN])}return ba}function C(G,S=!1){var T=G.wkid||G.wkt;if(!T||G.isGeographic)return null;T=String(T);if(V.has(T))return T=V.get(T),S?T?.gcs:T?.pcs;var aa=G.wkid?P.PeFactory.coordsys(G.wkid):P.PeFactory.fromString(G.isGeographic?P.PeDefs.PE_TYPE_GEOGCS:
P.PeDefs.PE_TYPE_PROJCS,G.wkt);G=y(G,1E-4);G=d(aa,G);aa=d(aa,0,!0);V.set(T,{pcs:G,gcs:aa});return S?aa:G}function d(G,S=0,T=!1){var aa=P.PePCSInfo.generate(G),Z=T?G.horizonGcsGenerate():G.horizonPcsGenerate();if(!aa||!Z?.length)return null;G=!1;var Q=Z.find(ha=>1===ha.getInclusive()&&1===ha.getKind());if(!Q){Q=Z.find(ha=>1===ha.getInclusive()&&0===ha.getKind());if(!Q)return null;G=!0}T=T?0:(2===aa.getNorthPoleLocation()?1:0)|(2===aa.getSouthPoleLocation()?2:0);aa=aa.isPannableRectangle();Q=Q.getCoord();
if(G)return{isEnvelope:G,isPannable:aa,vertices:Q,coef:null,bbox:[Q[0][0]-S,Q[0][1]-S,Q[1][0]+S,Q[1][1]+S],poleLocation:T};S=0;G=[];let [Y,ba]=Q[0],[ca,fa]=Q[0];for(let ha=0,ka=Q.length;ha<ka;ha++){S++;S===ka&&(S=0);const [ma,na]=Q[ha],[ra,ta]=Q[S];if(ta===na)G.push([ma,ra,na,ta,2]);else{Z=(ra-ma)/(ta-na||1E-4);const pa=ma-Z*na;na<ta?G.push([Z,pa,na,ta,0]):G.push([Z,pa,ta,na,1])}Y=Y<ma?Y:ma;ba=ba<na?ba:na;ca=ca>ma?ca:ma;fa=fa>na?fa:na}return{isEnvelope:!1,isPannable:aa,vertices:Q,coef:G,bbox:[Y,ba,
ca,fa],poleLocation:T}}function b(G,S){const T=[],{cols:aa,rows:Z,xres:Q,yres:Y,usePixelCenter:ba}=G;let {xmin:ca,ymax:fa}=G;ba&&(ca+=Q/2,fa-=Y/2);if(n.isNone(S)){for(G=0;G<aa;G++)for(S=0;S<Z;S++)T.push([ca+Q*G,fa-Y*S]);return{points:T}}G=new Uint8Array(aa*Z);if(S.isEnvelope){const {bbox:[pa,qa,oa,U]}=S;for(let ia=0,da=0;ia<aa;ia++){var ha=ca+Q*ia,ka=S.isPannable||ha>=pa&&ha<=oa;for(var ma=0;ma<Z;ma++,da++){var na=fa-Y*ma;ka&&na>=qa&&na<=U&&(T.push([ha,na]),G[da]=1)}}return{points:T,mask:G}}ha=S.coef;
S=[];for(ka=0;ka<Z;ka++){var ra=fa-Y*ka;ma=[];na=[];for(var ta=0;ta<ha.length;ta++){const [pa,qa,oa,U,ia]=ha[ta];ra===oa&&oa===U?(ma.push(pa),ma.push(qa),na.push(2),na.push(2)):ra>=oa&&ra<=U&&(ma.push(pa*ra+qa),na.push(ia))}ra=ma;if(2<ma.length){ta=2===na[0]?0:na[0];let pa=ma[0];ra=[];for(let qa=1;qa<na.length;qa++)if(2!==na[qa]||qa===na.length-1)na[qa]!==ta&&(ra.push(0===ta?Math.min(pa,ma[qa-1]):Math.max(pa,ma[qa-1])),ta=na[qa],pa=ma[qa]),qa===na.length-1&&ra.push(0===na[qa]?Math.min(pa,ma[qa]):
Math.max(pa,ma[qa]));ra.sort((qa,oa)=>qa-oa)}else ma[0]>ma[1]&&(ra=[ma[1],ma[0]]);S.push(ra)}for(let pa=0,qa=0;pa<aa;pa++)for(ha=ca+Q*pa,ka=0;ka<Z;ka++,qa++)if(ma=fa-Y*ka,na=S[ka],2===na.length)ha>=na[0]&&ha<=na[1]&&(T.push([ha,ma]),G[qa]=1);else if(2<na.length){ra=!1;for(ta=0;ta<na.length;ta+=2)if(ha>=na[ta]&&ha<=na[ta+1]){ra=!0;break}ra&&(T.push([ha,ma]),G[qa]=1)}return{points:T,mask:G}}function c(G,S){const [T,aa]=S;for(S=0;S<G.length;S++){const Z=G[S][1];if(Z<T||Z>aa)G[S]=[NaN,NaN]}}function h(G){const S=
r(G[0].spatialReference);if(2>G.length||n.isNone(S))return G[0];let {xmin:T,xmax:aa,ymin:Z,ymax:Q}=G[0];for(let Y=1;Y<G.length;Y++){const ba=G[Y];aa=ba.xmax+S*Y;Z=Math.min(Z,ba.ymin);Q=Math.max(Q,ba.ymax)}return new L({xmin:T,xmax:aa,ymin:Z,ymax:Q,spatialReference:G[0].spatialReference})}function q(G,S,T=null,aa=!0){var Z=G.spatialReference;if(Z.equals(S))return G;var Q=E(G);const Y=r(Z,!0);var ba=r(S);if(0===Q||n.isNone(Y)||n.isNone(ba))return Q=B(G,S,T,aa),n.isNone(Y)&&n.isSome(ba)&&Math.abs(Q.width-
ba)<y(S)&&J.isLoaded()&&(Z=C(Z),n.isSome(Z)&&Z.poleLocation===O.None&&G.width<(Z.bbox[2]-Z.bbox[0])/2)?z(G,S)||Q:Q;ba=G.clone().normalize();if(1===ba.length&&G.xmax<Y&&G.xmax-Y/2>y(Z)){const {xmin:ca,xmax:fa}=G;for(let ha=0;ha<=Q;ha++)ba[ha]=new L({xmin:0===ha?ca:-Y/2,xmax:ha===Q?fa-Y*ha:Y/2,ymin:G.ymin,ymax:G.ymax,spatialReference:Z})}G=ba.map(ca=>B(ca,S,T,aa));return h(G.filter(n.isSome))}function z(G,S){const T=r(S);if(n.isNone(T))return null;let {xmin:aa,ymin:Z,xmax:Q,ymax:Y}=G;var ba=G.spatialReference;
G=new l({spatialReference:ba,rings:[[[aa,Z],[Q,Z],[Q,Y],[aa,Y],[aa,Z]]]});G=J.project(G,S);if(2!==G.rings.length||!G.rings[0].length||!G.rings[1].length)return null;({rings:G}=G);ba=y(ba);S=new L({spatialReference:S});for(let ca=0;2>ca;ca++){aa=Q=G[ca][0][0];Z=Y=G[ca][0][1];for(let fa=0;fa<G[ca].length;fa++)aa=aa>G[ca][fa][0]?G[ca][fa][0]:aa,Q=Q<G[ca][fa][0]?G[ca][fa][0]:Q,Z=Z>G[ca][fa][1]?G[ca][fa][1]:Z,Y=Y<G[ca][fa][1]?G[ca][fa][1]:Y;if(0===ca)S.ymin=Z,S.ymax=Y,S.xmin=aa,S.xmax=Q;else if(S.ymin=
Math.min(S.ymin,Z),S.ymax=Math.max(S.ymax,Y),Math.abs(Q-T/2)<ba)S.xmin=aa,S.xmax+=T;else if(Math.abs(aa+T/2)<ba)S.xmax=Q+T;else return null}return S}function B(G,S,T=null,aa=!0,Z=!0){const Q=G.spatialReference;if(Q.equals(S)||!S)return G;m(Q,S,T);const Y=J.project(G,S,T);if(Z&&S.isWebMercator&&Y&&(Y.ymax=Math.min(2.0037508342787E7,Y.ymax),Y.ymin=Math.max(-2.0037508342787E7,Y.ymin),Y.ymin>=Y.ymax))return null;if(!aa||!Y)return Y;var ba=x(Q,!0);aa=x(S,!0);if(n.isNone(ba)||n.isNone(aa))return Y;Z=y(Q,
.001);const ca=y(Q,500);var fa=y(S,.001);if(Math.abs(Y.xmin-aa[0])<fa&&Math.abs(Y.xmax-aa[1])<fa){fa=Math.abs(G.xmin-ba[0]);ba=Math.abs(ba[1]-G.xmax);if(fa<Z&&ba>ca){Y.xmin=aa[0];var ha=[];ha.push(new k(G.xmax,G.ymin,Q));ha.push(new k(G.xmax,(G.ymin+G.ymax)/2,Q));ha.push(new k(G.xmax,G.ymax,Q));ha=ha.map(ka=>K(ka,S,T)).filter(ka=>!isNaN(ka?.x)).map(ka=>ka.x);Y.xmax=Math.max.apply(null,ha)}ba<Z&&fa>ca&&(Y.xmax=aa[1],aa=[],aa.push(new k(G.xmin,G.ymin,Q)),aa.push(new k(G.xmin,(G.ymin+G.ymax)/2,Q)),aa.push(new k(G.xmin,
G.ymax,Q)),G=aa.map(ka=>K(ka,S,T)).filter(ka=>!isNaN(ka?.x)).map(ka=>ka.x),Y.xmin=Math.min.apply(null,G))}else G=y(S,.001),Math.abs(Y.xmin-aa[0])<G&&(Y.xmin=aa[0]),Math.abs(Y.xmax-aa[1])<G&&(Y.xmax=aa[1]);return Y}function r(G,S=!1){return G?G.isWebMercator?2*(S?2.0037508342787E7:2.0037508342788905E7):G.wkid&&G.isGeographic?360:2*X[G.wkid]||null:null}function x(G,S=!1){if(G.isGeographic)return[-180,180];G=r(G,S);return n.isSome(G)?[-G/2,G/2]:null}function v(G,S,T,aa){G=(G-S)/T;0!==G-Math.floor(G)?
G=Math.floor(G):aa&&--G;return G}function E(G,S=!1){var T=r(G.spatialReference);if(n.isNone(T))return 0;const aa=S?0:-(T/2),Z=y(G.spatialReference),Q=!S&&Math.abs(G.xmin+T/2)<Z?-T/2:G.xmin;G=v(!S&&Math.abs(G.xmax-T/2)<Z?T/2:G.xmax,aa,T,!0);T=v(Q,aa,T,!1);return G-T}function t(G){const {projectedExtent:S,srcBufferExtent:T,pixelSize:aa,datumTransformation:Z,rasterTransform:Q}=G;var Y=S.spatialReference;const ba=T.spatialReference;var ca=m(Y,ba);const {xmin:fa,ymin:ha,xmax:ka,ymax:ma}=S,na=r(ba),ra=
n.isSome(na)&&(G.hasWrapAround||"gcs-shift"===Q?.type);G=G.spacing||[32,32];var ta=G[0]*aa.x,pa=G[1]*aa.y;const qa=1===G[0],oa=Math.ceil((ka-fa)/ta-.1/G[0])+(qa?0:1),U=Math.ceil((ma-ha)/pa-.1/G[1])+(qa?0:1);ta=g({cols:oa,rows:U,xmin:fa,ymax:ma,xres:ta,yres:pa,inSR:Y,outSR:ba,datumTransformation:Z,preferPE:4>=G[0],usePixelCenter:qa});pa=[];let ia,da=0;const la=qa?-1:NaN,{xmin:ja,xmax:ea,ymax:sa,width:ua,height:va}=T,xa=y(ba,500),ya=n.isSome(na)&&0<ja&&ea>na/2;var za=!1;ca&&(za=C(Y),za=n.isSome(za)&&
0<za.poleLocation);for(Y=0;Y<oa;Y++){ca=[];for(let Aa=0;Aa<U;Aa++){var wa=ta[Y*U+Aa];ra&&wa[0]>ea&&wa[0]>na/2-xa?wa[0]-=na:ra&&0===Y&&0>wa[0]&&ya&&!Q&&(wa[0]+=na);!wa||isNaN(wa[0])||isNaN(wa[1])?(pa.push(la),pa.push(la),ca.push(null),da++):(Q&&(wa=Q.inverseTransform(new k({x:wa[0],y:wa[1],spatialReference:ba})),wa=[wa.x,wa.y]),ca.push(wa),0<Y&&ra&&ia[Aa]&&wa[0]<ia[Aa][0]&&(wa[0]+=na,za&&wa[0]>ea&&wa[0]>na&&(wa[0]-=na)),pa.push((wa[0]-ja)/ua),pa.push((sa-wa[1])/va))}ia=ca}return{offsets:pa,error:null,
coefficients:null,outofBoundPointCount:da,spacing:G,size:qa?[oa,U]:[oa-1,U-1]}}function A(G,S,T){const {cols:aa,rows:Z}=S;S=new Float32Array((aa-1)*(Z-1)*12);const Q=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),Y=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let ma=0;ma<aa-1;ma++){for(var ba=0;ba<Z-1;ba++){var ca=ma*Z*2+2*ba,fa=G[ca];const na=G[ca+1];var ha=G[ca+2],ka=G[ca+3];ca+=2*Z;const ra=G[ca],ta=G[ca+1],pa=G[ca+2];ca=G[ca+3];let qa=0,oa=12*(ba*(aa-1)+ma);for(let U=0;3>U;U++)S[oa++]=Q[qa++]*fa+
Q[qa++]*ha+Q[qa++]*pa;qa=0;for(ha=0;3>ha;ha++)S[oa++]=Q[qa++]*na+Q[qa++]*ka+Q[qa++]*ca;qa=0;for(ka=0;3>ka;ka++)S[oa++]=Y[qa++]*fa+Y[qa++]*ra+Y[qa++]*pa;qa=0;for(fa=0;3>fa;fa++)S[oa++]=Y[qa++]*na+Y[qa++]*ta+Y[qa++]*ca}if(T)for(ba=0;ba<S.length;ba++)isNaN(S[ba])&&(S[ba]=-1)}return S}var O;(function(G){G[G.None=0]="None";G[G.North=1]="North";G[G.South=2]="South";G[G.Both=3]="Both"})(O||(O={}));const N=(G,S,T,aa=0)=>{if(1===T[0])return[0,0];var Z=1,Q=-1,Y=1,ba=-1;for(var ca=0;ca<G.length;ca+=2)isNaN(G[ca])||
(Z=Z>G[ca]?G[ca]:Z,Q=Q>G[ca]?Q:G[ca],Y=Y>G[ca+1]?G[ca+1]:Y,ba=ba>G[ca+1]?ba:G[ca+1]);const {cols:fa,rows:ha}=S;S=(Q-Z)/fa/T[0];T=(ba-Y)/ha/T[1];aa*=2;Y=0;ba=!1;Z=[0,0];for(Q=0;Q<fa-3;Q++){for(ca=0;ca<ha-3;ca++){var ka=Q*ha*2+2*ca;const ma=Math.abs(((G[ka]+G[ka+4]+G[ka+4*ha]+G[ka+4*ha+4])/4-G[ka+2*ha+2])/S);ka=Math.abs(((G[ka+1]+G[ka+5]+G[ka+4*ha+1]+G[ka+4*ha+5])/4-G[ka+2*ha+3])/T);ma+ka>Y&&(Y=ma+ka,Z=[ma,ka]);if(aa&&Y>aa){ba=!0;break}}if(ba)break}return Z},X={3395:2.0037508342789244E7,3410:1.7334193943686873E7,
3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,
54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},V=new Map,W=new Map;M.computeProjectedScales=function(G,S,T=512,aa=!0){const {extent:Z,spatialReference:Q,pixelSize:Y}=G,ba=p(new k({x:Y.x,y:Y.y,spatialReference:Q}),S,Z);if(null==ba)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ca=(ba.x+ba.y)/2;var fa=R.getMetersPerUnitForSR(S),
ha=ca*fa*96*39.37,ka=S.isGeographic?256/T*2.958287637958547E8:256/T*5.91657527591555E8,ma="vector-magdir"===G.dataType||"vector-uv"===G.dataType,na=q(Z,S);G=Math.min(Math.ceil(Math.log(Math.min(G.width,G.height)/32)/Math.LN2),Math.ceil(Math.log(ka/2/ha)/Math.LN2));!ma&&aa&&(S.isGeographic||S.isWebMercator)&&(ma=0>na.xmin*na.xmax,!ma&&3>G&&(aa=r(S),n.isSome(aa)&&(ma=2**G*ca*T,T=Math.ceil(aa/ma),ma=1===T||2===T&&aa/2-na.xmax<ma)));T=ha;if(ma)T=ka,ka=S.isGeographic?1.341104507446289E-6:.29858214164761665,
fa=96*ka*fa*39.37,S=p(new k({x:ka,y:ka,spatialReference:{wkid:S.isGeographic?4326:3857}}),Q,na),S.x*=T/fa,S.y*=T/fa;else{S={x:Y.x,y:Y.y};for(na=0;T<.5005*ka&&na<G;)na++,T*=2,S.x*=2,S.y*=2;1.001>=Math.max(T,ka)/Math.min(T,ka)&&(T=ka)}ka=[T];na=[{x:S.x,y:S.y}];for(ha=Math.min(70.5310735,ha)/1.001;T>=ha;)T/=2,S.x/=2,S.y/=2,ka.push(T),na.push({x:S.x,y:S.y});return{projectedPixelSize:ba,scales:ka,srcResolutions:na,isCustomTilingScheme:!ma}};M.defaultGridSpacing=32;M.defaultProjectionToleranceInPixels=
4;M.getDefaultDatumTransformationForDataset=function(G,S,T){return m(G.spatialReference,S)?T?J.getTransformation(S,G.spatialReference,G):J.getTransformation(G.spatialReference,S,G):null};M.getProjectedGridPoints=g;M.getProjectionOffsetGrid=function(G){var S=G.isAdaptive&&null==G.spacing;let T=G.spacing||[32,32],aa=t(G);var Z={cols:aa.size[0]+1,rows:aa.size[1]+1};const Q=0<aa.outofBoundPointCount&&aa.outofBoundPointCount<aa.offsets.length/2;let Y=aa.outofBoundPointCount===aa.offsets.length/2||S&&Q?
[0,0]:N(aa.offsets,Z,T,4);const ba=(Y[0]+Y[1])/2;var ca=G.projectedExtent.spatialReference;const fa=G.srcBufferExtent.spatialReference;S&&(Q||4<ba)&&(f(ca,fa,G.datumTransformation)&&(ca.isGeographic||n.isSome(C(ca))),T=[4,4],aa=t({...G,spacing:T}),Z={cols:aa.size[0]+1,rows:aa.size[1]+1},Y=N(aa.offsets,Z,T,4));aa.error=Y;1<T[0]&&(aa.coefficients=A(aa.offsets,Z,Q));!G.includeGCSGrid||ca.isGeographic||ca.isWebMercator||(fa.isGeographic?aa.gcsGrid={offsets:aa.offsets,coefficients:aa.coefficients,spacing:T}:
(S=C(ca),n.isSome(S)&&!S.isEnvelope&&(ca&&!ca.isGeographic&&(S=String(ca.wkid||ca.wkt),W.has(S)?ca=W.get(S):(ca=(ca.wkid?P.PeFactory.coordsys(ca.wkid):P.PeFactory.fromString(P.PeDefs.PE_TYPE_PROJCS,ca.wkt)).getGeogcs().getCode(),W.set(S,ca)),ca=new a({wkid:ca})),ca=q(G.projectedExtent,ca),{offsets:G}=t({...G,srcBufferExtent:ca,spacing:T}),Z=A(G,Z,Q),aa.gcsGrid={offsets:G,coefficients:Z,spacing:T})));return aa};M.getRasterDatasetAlignmentInfo=function(G){const S=G.storageInfo.origin.x;var T=r(G.spatialReference,
!0);if(n.isNone(T))return{originX:S,halfWorldWidth:null,pyramidsInfo:null};const aa=T/2,{nativePixelSize:Z,storageInfo:Q,extent:Y}=G,{maximumPyramidLevel:ba,blockWidth:ca,pyramidScalingFactor:fa}=Q;let ha=Z.x;const ka=[];G=n.isSome(G.transform)&&"gcs-shift"===G.transform.type;const ma=S+(G?0:aa);T=G?T-S:aa-S;for(let na=0;na<=ba;na++){const ra=(Y.xmax-S)/ha/ca,ta=T/ha/ca;ka.push({resolutionX:ha,blockWidth:ca,datsetColumnCount:0===ra-Math.floor(ra)?ra:Math.ceil(ra),worldColumnCountFromOrigin:0===ta-
Math.floor(ta)?ta:Math.ceil(ta),leftMargin:Math.round(ma/ha)%ca,rightPadding:(ca-Math.round(T/ha)%ca)%ca,originColumnOffset:Math.floor(ma/ha/ca)});ha*=fa}return{originX:S,halfWorldWidth:aa,pyramidsInfo:ka,hasGCSSShiftTransform:G}};M.getWorldWidth=r;M.getWorldWrapCount=E;M.load=function(){return e.apply(this,arguments)};M.minimumGridSpacing=4;M.projectExtent=q;M.projectPoint=K;M.projectResolution=p;M.requirePE=f;M.snapExtent=function(G){G=G.clone().normalize();return 1===G.length?G[0]:h(G)};M.snapPyramid=
function(G,S,T){const {storageInfo:aa,pixelSize:Z}=S;var Q=0;let Y=!1;var {pyramidResolutions:ba}=aa;if(n.isSome(ba)&&ba.length){G=(G.x+G.y)/2;var ca=ba[ba.length-1];ca=(ca.x+ca.y)/2;var fa=(Z.x+Z.y)/2;if(G<=fa)Q=0;else if(G>=ca)Q=ba.length,Y=8<G/ca;else{ca=fa;for(let ha=1;ha<=ba.length;ha++){fa=(ba[ha-1].x+ba[ha-1].y)/2;if(G<=fa){G===fa?Q=ha:"down"===T?(Q=ha-1,Y=8<G/ca):Q="up"===T?ha:G-ca>fa-G||2<G/ca?ha:ha-1;break}ca=fa}}T=0===Q?Z:ba[Q-1];Y&&(ba=Math.min(T.x,T.y),G=R.getMetersPerUnitForSR(S.spatialReference),
19567<ba*G&&(Y=!1));return{pyramidLevel:Q,pyramidResolution:new k({x:T.x,y:T.y,spatialReference:S.spatialReference}),excessiveReading:Y}}Q=Math.log(G.x/Z.x)/Math.LN2;G=Math.log(G.y/Z.y)/Math.LN2;ba=S.storageInfo.maximumPyramidLevel||0;Q="down"===T?Math.floor(Math.min(Q,G)):"up"===T?Math.ceil(Math.max(Q,G)):Math.round((Q+G)/2);0>Q?Q=0:Q>ba&&(Y=Q>ba+3,Q=ba);T=2**Q;S=new k({x:T*S.nativePixelSize.x,y:T*S.nativePixelSize.y,spatialReference:S.spatialReference});return{pyramidLevel:Q,pyramidResolution:S,
excessiveReading:Y}};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(M,D,H,I,n,R,P,J,L,k,l,a,f){function m(v,E){return e.apply(this,arguments)}function e(){e=D._asyncToGenerator(function*(v,
E){if(!f.isPlatformLittleEndian)throw new H("rasterCoded:decode","lerc decoder is not supported on big endian platform");yield J.load();const {offset:t,noDataValue:A}=E,{width:O,height:N,pixelType:X,statistics:V,pixels:W,mask:G}=J.decode(v,{inputOffset:t,noDataValue:A,returnInterleaved:E.returnInterleaved});return new n({width:O,height:N,pixelType:X.toLowerCase(),pixels:W,mask:G,statistics:V})});return e.apply(this,arguments)}function p(v,E){return y.apply(this,arguments)}function y(){y=D._asyncToGenerator(function*(v,
E){v=yield a.decode(v,E);I.assertIsSome(v);v=new n({width:v.width,height:v.height,pixels:v.pixels,pixelType:v.pixelType.toLowerCase(),mask:v.mask,statistics:null});v.updateStatistics();return v});return y.apply(this,arguments)}function K(v,E){return F.apply(this,arguments)}function F(){F=D._asyncToGenerator(function*(v,E){v=yield a.decodeTileOrStrip(v,E.customOptions);v=new n({width:v.width,height:v.height,pixels:v.pixels,pixelType:v.pixelType.toLowerCase(),mask:v.mask,statistics:null});v.updateStatistics();
return v});return F.apply(this,arguments)}function g(v,E){const t=E.pixelType||"u8",A=n.getPixelArrayConstructor(t),O="u8"===t?v:new A(v.buffer),N=[],X=E.planes||1;if(1===X)N.push(O);else for(let V=0;V<X;V++){const W=(E.width||1)*(E.height||v.length),G=new A(W);for(let S=0;S<W;S++)G[S]=O[S*X+V];N.push(G)}v=new n({width:E.width||1,height:E.height||v.length,pixels:N,pixelType:t,statistics:null});v.updateStatistics();return v}function w(v,E){v=(new k.Zlib(new Uint8Array(v))).getBytes();return g(v,E)}
function u(v,E){v=L.decode(v,E.offset,E.eof,!E.isInputBigEndian);return g(v,E)}function C(v,E){v=P.decode(v,E.hasNoZlibMask??void 0);v=new n({width:v.width,height:v.height,pixels:v.pixels,pixelType:"U8",mask:v.mask,statistics:null});v.updateStatistics();return v}function d(v,E){v=new Uint8Array(v);v=new r(v);const {width:t,height:A}=E;E=t*A;v=v.decode();let O=0;var N=0;let X;N=new Uint8Array(E);for(O=0;O<E;O++)N[O]=v[4*O+3];const V=new n({width:t,height:A,pixels:[],pixelType:"U8",mask:N,statistics:[]});
for(O=0;3>O;O++){X=new Uint8Array(E);for(N=0;N<E;N++)X[N]=v[4*N+O];V.addData({pixels:X})}V.updateStatistics();return V}function b(v,E,t,A){return c.apply(this,arguments)}function c(){c=D._asyncToGenerator(function*(v,E,t,A){v=yield(new R).decode(v,{applyJpegMask:!1,format:E,...t},A);v=new n(v);v.updateStatistics();return v});return c.apply(this,arguments)}function h(v){if(null==v)throw new H("rasterCodec:decode","parameter encodeddata is required.");v=new Uint8Array(v,0,10);let E="";255===v[0]&&216===
v[1]?E="jpg":137===v[0]&&80===v[1]&&78===v[2]&&71===v[3]?E="png":67===v[0]&&110===v[1]&&116===v[2]&&90===v[3]&&73===v[4]&&109===v[5]&&97===v[6]&&103===v[7]&&101===v[8]&&32===v[9]?E="lerc":76===v[0]&&101===v[1]&&114===v[2]&&99===v[3]&&50===v[4]&&32===v[5]?E="lerc2":73===v[0]&&73===v[1]&&42===v[2]&&0===v[3]||77===v[0]&&77===v[1]&&0===v[2]&&42===v[3]||73===v[0]&&73===v[1]&&43===v[2]&&0===v[3]||77===v[0]&&77===v[1]&&0===v[2]&&43===v[3]?E="tiff":71===v[0]&&73===v[1]&&70===v[2]?E="gif":66===v[0]&&77===
v[1]?E="bmp":String.fromCharCode.apply(null,v).toLowerCase().includes("error")&&(E="error");return E}function q(v){let E=null;switch(v){case "lerc":case "lerc2":E=m;break;case "jpg":E=C;break;case "png":E=d;break;case "bsq":case "bip":E=(t,A)=>{var O=A.pixelType,N=null;let X=null;switch(O?O.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":X=255;N=Uint8Array;break;case "u16":X=X||65535;N=Uint16Array;break;case "u32":X=X||2**32-1;N=Uint32Array;break;case "s8":X=X||-128;N=Int8Array;break;
case "s16":X=X||-32768;N=Int16Array;break;case "s32":X=X||-(2**31);N=Int32Array;break;default:N=Float32Array}({pixelTypeCtor:O}={pixelTypeCtor:N,noDataValue:X});N=l.decode;t=N(t,{width:A.width,height:A.height,pixelType:O,format:v});A=new n({width:A.width,height:A.height,pixels:t.pixels,pixelType:A.pixelType,mask:t.mask,statistics:null});A.updateStatistics();return A};break;case "tiff":E=p;break;case "deflate":E=w;break;case "lzw":E=u;break;case "error":E=()=>{throw new H("rasterCodec:decode","input data contains error");
};break;default:E=()=>{throw new H("rasterCodec:decode","unsupported raster format");}}return E}function z(v,E=1){if(v){var {pixels:t,width:A,height:O,mask:N}=v;if(t&&0!==t.length){var X=t.length,V=A-1,W=O-1,G=[],S,T,aa=null,Z=n.getPixelArrayConstructor(v.pixelType);if(0===E){for(E=0;E<X;E++){var Q=t[E];var Y=new Z(V*W);for(S=0;S<W;S++){var ba=S*A;for(T=0;T<V;T++)Y[S*V+T]=Q[ba+T]}G.push(Y)}if(I.isSome(N))for(aa=new Uint8Array(V*W),S=0;S<W;S++)for(ba=S*A,T=0;T<V;T++)aa[S*V+T]=N[ba+T]}else{for(E=0;E<
X;E++){Q=t[E];Y=new Z(V*W);for(S=0;S<W;S++)for(ba=S*A,T=0;T<V;T++)Y[S*V+T]=(Q[ba+T]+Q[ba+T+1]+Q[ba+A+T]+Q[ba+A+T+1])/4;G.push(Y)}if(N)for(aa=new Uint8Array(V*W),S=0;S<W;S++)for(ba=S*A,T=0;T<V;T++)aa[S*V+T]=Math.min.apply(null,[N[ba+T],N[ba+T+1],N[ba+A+T],N[ba+A+T+1]])}v.width=V;v.height=W;v.mask=aa;v.pixels=G}}}function B(){B=D._asyncToGenerator(function*(v,E={},t){if(null==v)throw new H("rasterCodec:decode","missing encodeddata parameter.");let A=E.format&&E.format.toLowerCase();if(!("bsq"!==A&&
"bip"!==A||null!=E.width&&null!=E.height))throw new H("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===A&&E.customOptions)return K(v,E);if(!A||"bsq"!==A&&"bip"!==A&&"deflate"!==A&&"lzw"!==A)A=h(v);E.useCanvas&&x.has(A)?v=yield b(v,A,E,t):(t=q(A),E.isPoint&&(E={...E},null!=E.width&&E.width++,null!=E.height&&E.height++),v=yield t(v,E),E.isPoint&&z(v));return v});return B.apply(this,arguments)}var r=function(v){function E(N){var X,V;this.data=N;this.pos=8;this.palette=
[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(V=null;;){var W=this.readUInt32();var G=N=void 0;N=[];for(G=0;4>G;++G)N.push(String.fromCharCode(this.data[this.pos++]));N=N.join("");switch(N){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation=
{numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(W);break;case "fcTL":V&&this.animation.frames.push(V);this.pos+=4;V={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};N=this.readUInt16();W=this.readUInt16()||100;V.delay=1E3*N/W;V.disposeOp=this.data[this.pos++];V.blendOp=this.data[this.pos++];V.data=[];break;case "IDAT":case "fdAT":"fdAT"===N&&(this.pos+=4,W-=4);N=(null!=V?V.data:
void 0)||this.imgData;for(G=0;0<=W?G<W:G>W;0<=W?++G:--G)N.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(W);W=255-this.transparency.indexed.length;if(0<W)for(N=0;0<=W?N<W:N>W;0<=W?++N:--N)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(W)[0];break;case 2:this.transparency.rgb=this.read(W)}break;case "tEXt":G=this.read(W);W=G.indexOf(0);N=String.fromCharCode.apply(String,G.slice(0,
W));this.text[N]=String.fromCharCode.apply(String,G.slice(W+1));break;case "IEND":V&&this.animation.frames.push(V);a:{switch(this.colorType){case 0:case 3:case 4:V=1;break a;case 2:case 6:V=3;break a}V=void 0}this.colors=V;this.hasAlphaChannel=4===(X=this.colorType)||6===X;X=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*X;a:{switch(this.colors){case 1:X="DeviceGray";break a;case 3:X="DeviceRGB";break a}X=void 0}this.colorSpace=X;this.imgData=new Uint8Array(this.imgData);return;
default:this.pos+=W}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var t;E.load=function(N,X,V){"function"===typeof X&&(V=X);var W=new XMLHttpRequest;W.open("GET",N,!0);W.responseType="arraybuffer";W.onload=function(){var G=new Uint8Array(W.response||W.mozResponseArrayBuffer);G=new E(G);"function"===typeof(null!=X?X.getContext:void 0)&&G.render(X);return"function"===typeof V?V(G):void 0};return W.send(null)};E.prototype.read=function(N){var X;var V=[];for(X=
0;0<=N?X<N:X>N;0<=N?++X:--X)V.push(this.data[this.pos++]);return V};E.prototype.readUInt32=function(){var N=this.data[this.pos++]<<24;var X=this.data[this.pos++]<<16;var V=this.data[this.pos++]<<8;var W=this.data[this.pos++];return N|X|V|W};E.prototype.readUInt16=function(){var N=this.data[this.pos++]<<8;var X=this.data[this.pos++];return N|X};E.prototype.decodePixels=function(N){var X,V,W,G,S,T,aa,Z;null==N&&(N=this.imgData);if(0===N.length)return new Uint8Array(0);N=new k.Zlib(N);N=N.getBytes();
var Q=this.pixelBitlength/8;var Y=Q*this.width;var ba=new Uint8Array(Y*this.height);var ca=N.length;for(V=G=S=0;G<ca;){switch(N[G++]){case 0:for(W=X=0;X<Y;W=X+=1)ba[V++]=N[G++];break;case 1:for(W=T=0;T<Y;W=T+=1){X=N[G++];var fa=W<Q?0:ba[V-Q];ba[V++]=(X+fa)%256}break;case 2:for(W=fa=0;fa<Y;W=fa+=1){X=N[G++];var ha=(W-W%Q)/Q;T=S&&ba[(S-1)*Y+ha*Q+W%Q];ba[V++]=(T+X)%256}break;case 3:for(W=Z=0;Z<Y;W=Z+=1)X=N[G++],ha=(W-W%Q)/Q,fa=W<Q?0:ba[V-Q],T=S&&ba[(S-1)*Y+ha*Q+W%Q],ba[V++]=(X+Math.floor((fa+T)/2))%
256;break;case 4:for(W=Z=0;Z<Y;W=Z+=1){X=N[G++];ha=(W-W%Q)/Q;fa=W<Q?0:ba[V-Q];0===S?T=aa=0:(T=ba[(S-1)*Y+ha*Q+W%Q],aa=ha&&ba[(S-1)*Y+(ha-1)*Q+W%Q]);var ka=fa+T-aa;W=Math.abs(ka-fa);ha=Math.abs(ka-T);ka=Math.abs(ka-aa);fa=W<=ha&&W<=ka?fa:ha<=ka?T:aa;ba[V++]=(X+fa)%256}break;default:throw Error("Invalid filter algorithm: "+N[G-1]);}S++}return ba};E.prototype.decodePalette=function(){var N,X,V,W;var G=this.palette;var S=this.transparency.indexed||[];var T=new Uint8Array((S.length||0)+G.length);var aa=
0;G.length;var Z=X=N=0;for(V=G.length;X<V;Z=X+=3)T[aa++]=G[Z],T[aa++]=G[Z+1],T[aa++]=G[Z+2],T[aa++]=null!=(W=S[N++])?W:255;return T};E.prototype.copyToImageData=function(N,X){var V,W;var G=this.colors;var S=null;var T=this.hasAlphaChannel;this.palette.length&&(S=null!=(V=this._decodedPalette)?V:this._decodedPalette=this.decodePalette(),G=4,T=!0);N=N.data||N;var aa=N.length;var Z=S||X;V=W=0;if(1===G)for(;V<aa;)G=S?4*X[V/4]:W,W=Z[G++],N[V++]=W,N[V++]=W,N[V++]=W,N[V++]=T?Z[G++]:this.transparency.grayscale&&
this.transparency.grayscale===W?0:255,W=G;else for(;V<aa;)G=S?4*X[V/4]:W,N[V++]=Z[G++],N[V++]=Z[G++],N[V++]=Z[G++],N[V++]=T?Z[G++]:this.transparency.rgb&&this.transparency.rgb[1]===Z[G-3]&&this.transparency.rgb[3]===Z[G-2]&&this.transparency.rgb[5]===Z[G-1]?0:255,W=G};E.prototype.decode=function(){var N=new Uint8Array(this.width*this.height*4);this.copyToImageData(N,this.decodePixels());return N};var A=(t=v.document&&v.document.createElement("canvas"))&&t.getContext("2d");var O=function(N){A.width=
N.width;A.height=N.height;A.clearRect(0,0,N.width,N.height);A.putImageData(N,0,0);N=new Image;N.src=t.toDataURL();return N};E.prototype.decodeFrames=function(N){var X,V;if(this.animation){var W=this.animation.frames;var G=[];var S=X=0;for(V=W.length;X<V;S=++X){S=W[S];var T=N.createImageData(S.width,S.height);var aa=this.decodePixels(new Uint8Array(S.data));this.copyToImageData(T,aa);S.imageData=T;G.push(S.image=O(T))}return G}};E.prototype.renderFrame=function(N,X){var V=this.animation.frames;var W=
V[X];V=V[X-1];0===X&&N.clearRect(0,0,this.width,this.height);1===(null!=V?V.disposeOp:void 0)?N.clearRect(V.xOffset,V.yOffset,V.width,V.height):2===(null!=V?V.disposeOp:void 0)&&N.putImageData(V.imageData,V.xOffset,V.yOffset);0===W.blendOp&&N.clearRect(W.xOffset,W.yOffset,W.width,W.height);return N.drawImage(W.image,W.xOffset,W.yOffset)};E.prototype.animate=function(N){var X,V=this;var W=0;var G=this.animation;var S=G.numFrames;var T=G.frames;var aa=G.numPlays;return(X=function(){var Z=W++%S;var Q=
T[Z];V.renderFrame(N,Z);if(1<S&&W/S<aa)return V.animation._timeout=setTimeout(X,Q.delay)})()};E.prototype.stopAnimation=function(){var N;return clearTimeout(null!=(N=this.animation)?N._timeout:void 0)};E.prototype.render=function(N){N._png&&N._png.stopAnimation();N._png=this;N.width=this.width;N.height=this.height;N=N.getContext("2d");if(this.animation)return this.decodeFrames(N),this.animate(N);var X=N.createImageData(this.width,this.height);this.copyToImageData(X,this.decodePixels());return N.putImageData(X,
0,0)};return E}(self);const x=new Set(["jpg","png","bmp","gif"]);M.decode=function(v){return B.apply(this,arguments)};M.getFormat=function(v){v=h(v);"lerc2"===v?v="lerc":"error"===v&&(v="");return v};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(M,D,H){return function(){function I(n){this._ctx=this._canvas=
null;n&&(this._canvas=n.canvas,this._ctx=n.ctx||n.canvas&&n.canvas.getContext("2d"))}I.prototype.decode=function(n,R,P){if(!n||10>n.byteLength)throw new M("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:J=0,height:L=0,format:k}=R;const {applyJpegMask:l}=R;if(l&&(!J||!L))throw new M("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((a,f)=>{let m=null;"jpg"===k&&l&&(m=I._getMask(n,{width:J,height:L}));
const e=new Blob([new Uint8Array(n)],{type:"jpg"==="image/"+k?"jpeg":k}),p=URL.createObjectURL(e),y=new Image;let K;y.src=p;y.onload=()=>{URL.revokeObjectURL(p);if(D.isAborted(P))f(D.createAbortError());else{J=y.width;L=y.height;if(this._canvas&&this._ctx){if(this._canvas.width!==J||this._canvas.height!==L)this._canvas.width=J,this._canvas.height=L;this._ctx.clearRect(0,0,J,L)}else this._canvas=document.createElement("canvas"),this._canvas.width=J,this._canvas.height=L,this._ctx=this._canvas.getContext("2d");
this._ctx.drawImage(y,0,0);var F=this._ctx.getImageData(0,0,J,L);K=F.data;var g;if(R.renderOnCanvas){if(m)for(g=0;g<m.length;g++)K[4*g+3]=m[g]?255:0;this._ctx.putImageData(F,0,0);a(null)}else{F=J*L;var w=new Uint8Array(F),u=new Uint8Array(F),C=new Uint8Array(F);if(m)for(g=0;g<F;g++)w[g]=K[4*g],u[g]=K[4*g+1],C[g]=K[4*g+2];else for(m=new Uint8Array(F),g=0;g<F;g++)w[g]=K[4*g],u[g]=K[4*g+1],C[g]=K[4*g+2],m[g]=K[4*g+3];a({width:J,height:L,pixels:[w,u,C],mask:m,pixelType:"u8"})}}};y.onerror=()=>{URL.revokeObjectURL(p);
f("cannot load image")}})};I._getMask=function(n,R){let P=null;try{var J=new Uint8Array(n);n=0;var L=J.length-2;for(n=Math.ceil(J.length/2);n<L&&(255!==J[n]||217!==J[n+1]);n++);n+=2;if(n<J.length-1){const k=(new H.Zlib(J.subarray(n))).getBytes();P=new Uint8Array(R.width*R.height);R=0;for(J=0;J<k.length;J++)for(L=7;0<=L;L--)P[R++]=k[J]>>L&1}}catch(k){}return P};return I}()})},"esri/chunks/Zlib":function(){define(["exports"],function(M){var D={exports:{}};(function(H){(function(I){I=I();void 0!==I&&
(H.exports=I)})(function(){var I=function(){function n(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}n.prototype={ensureBuffer:function(R){var P=this.buffer,J=P?P.byteLength:0;if(R<J)return P;for(var L=512;L<R;)L<<=1;R=new Uint8Array(L);for(L=0;L<J;++L)R[L]=P[L];return this.buffer=R},getByte:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(R){var P=this.pos;if(R){this.ensureBuffer(P+R);for(R=
P+R;!this.eof&&this.bufferLength<R;)this.readBlock();var J=this.bufferLength;R>J&&(R=J)}else{for(;!this.eof;)this.readBlock();R=this.bufferLength}this.pos=R;return this.buffer.subarray(P,R)},lookChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var R=this.pos;this.bufferLength<=R;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(R,
P,J){for(var L=R+P;this.bufferLength<=L&&!this.eof;)this.readBlock();return new Stream(this.buffer,R,P,J)},skip:function(R){R||(R=1);this.pos+=R},reset:function(){this.pos=0}};return n}();return function(){function n(a){throw Error(a);}function R(a){var f=0,m=a[f++],e=a[f++];-1!=m&&-1!=e||n("Invalid header in flate stream");8!=(m&15)&&n("Unknown compression method in flate stream");0!=((m<<8)+e)%31&&n("Bad FCHECK in flate stream");e&32&&n("FDICT bit set in flate stream");this.bytes=a;this.bytesPos=
f;this.codeBuf=this.codeSize=0;I.call(this)}if(!self||!self.Uint32Array)return null;var P=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),J=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),L=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,
724993,727041,794625,798721,868353,876545]),k=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,
590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,
590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,
590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,
590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,
590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,
590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,
590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],l=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];R.prototype=Object.create(I.prototype);R.prototype.getBits=function(a){for(var f=this.codeSize,m=this.codeBuf,e=this.bytes,p=this.bytesPos,
y;f<a;)"undefined"==typeof(y=e[p++])&&n("Bad encoding in flate stream"),m|=y<<f,f+=8;this.codeBuf=m>>a;this.codeSize=f-=a;this.bytesPos=p;return m&(1<<a)-1};R.prototype.getCode=function(a){var f=a[0],m=a[1];a=this.codeSize;for(var e=this.codeBuf,p=this.bytes,y=this.bytesPos;a<m;){var K;"undefined"==typeof(K=p[y++])&&n("Bad encoding in flate stream");e|=K<<a;a+=8}m=f[e&(1<<m)-1];f=m>>16;m&=65535;(0==a||a<f||0==f)&&n("Bad encoding in flate stream");this.codeBuf=e>>f;this.codeSize=a-f;this.bytesPos=
y;return m};R.prototype.generateHuffmanTable=function(a){for(var f=a.length,m=0,e=0;e<f;++e)a[e]>m&&(m=a[e]);for(var p=1<<m,y=new Uint32Array(p),K=1,F=0,g=2;K<=m;++K,F<<=1,g<<=1)for(var w=0;w<f;++w)if(a[w]==K){var u=0,C=F;for(e=0;e<K;++e)u=u<<1|C&1,C>>=1;for(e=u;e<p;e+=g)y[e]=K<<16|w;++F}return[y,m]};R.prototype.readBlock=function(){function a(u,C,d,b,c){for(u=u.getBits(d)+b;0<u--;)C[F++]=c}var f=this.getBits(3);f&1&&(this.eof=!0);f>>=1;if(0==f){var m=this.bytes,e=this.bytesPos,p;"undefined"==typeof(p=
m[e++])&&n("Bad block header in flate stream");var y=p;"undefined"==typeof(p=m[e++])&&n("Bad block header in flate stream");y|=p<<8;"undefined"==typeof(p=m[e++])&&n("Bad block header in flate stream");f=p;"undefined"==typeof(p=m[e++])&&n("Bad block header in flate stream");(f|p<<8)!=(~y&65535)&&n("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;p=this.bufferLength;f=this.ensureBuffer(p+y);this.bufferLength=y=p+y;for(var K=p;K<y;++K){if("undefined"==typeof(p=m[e++])){this.eof=
!0;break}f[K]=p}this.bytesPos=e}else{if(1==f)e=k,p=l;else if(2==f){f=this.getBits(5)+257;p=this.getBits(5)+1;m=this.getBits(4)+4;e=Array(P.length);for(var F=0;F<m;)e[P[F++]]=this.getBits(3);e=this.generateHuffmanTable(e);F=m=0;p=f+p;for(y=Array(p);F<p;)K=this.getCode(e),16==K?a(this,y,2,3,m):17==K?a(this,y,3,3,m=0):18==K?a(this,y,7,11,m=0):y[F++]=m=K;e=this.generateHuffmanTable(y.slice(0,f));p=this.generateHuffmanTable(y.slice(f,p))}else n("Unknown block type in flate stream");y=(f=this.buffer)?f.length:
0;for(K=this.bufferLength;;){var g=this.getCode(e);if(256>g)K+1>=y&&(f=this.ensureBuffer(K+1),y=f.length),f[K++]=g;else{if(256==g){this.bufferLength=K;break}g-=257;g=J[g];var w=g>>16;0<w&&(w=this.getBits(w));m=(g&65535)+w;g=this.getCode(p);g=L[g];w=g>>16;0<w&&(w=this.getBits(w));g=(g&65535)+w;K+m>=y&&(f=this.ensureBuffer(K+m),y=f.length);for(w=0;w<m;++w,++K)f[K]=f[K-g]}}}};return R}()})})(D);M.Zlib=D.exports})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],
function(M,D){return function(){function H(){}H.decode=function(I,n=!1){const R=new Uint8Array(I);I=new M.JpegImage;I.parse(R);const {width:P,height:J,numComponents:L,eof:k}=I;I=I.getData(P,J,!0);const l=P*J;let a=null,f=0,m=0,e=0;if(!n&&k<R.length-1)try{var p=(new D.Zlib(R.subarray(k))).getBytes();a=new Uint8Array(l);for(f=n=0;f<p.length;f++)for(e=7;0<=e;e--)a[n++]=p[f]>>e&1}catch{}if(1===L&&I.length===P*J)p=[I,I,I];else{p=[];for(f=0;3>f;f++)p.push(new Uint8Array(l));for(m=e=0;m<l;m++)for(f=0;3>
f;f++)p[f][m]=I[e++]}return{width:P,height:J,pixels:p,mask:a}};return H}()})},"esri/chunks/Jpg":function(){define(["exports"],function(M){var D={exports:{}};(function(H){(function(I){I=I();void 0!==I&&(H.exports=I)})(function(){var I=function(){function n(R){this.message="JPEG error: "+R}n.prototype=Error();n.prototype.name="JpegError";return n.constructor=n}();return function(){function n(){this.decodeTransform=null;this.colorTransform=-1}function R(l,a){for(var f=0,m=[],e,p,y=16;0<y&&!l[y-1];)y--;
m.push({children:[],index:0});var K=m[0],F;for(e=0;e<y;e++){for(p=0;p<l[e];p++){K=m.pop();for(K.children[K.index]=a[f];0<K.index;)K=m.pop();K.index++;for(m.push(K);m.length<=e;)m.push(F={children:[],index:0}),K.children[K.index]=F.children,K=F;f++}e+1<y&&(m.push(F={children:[],index:0}),K.children[K.index]=F.children,K=F)}return m[0].children}function P(l,a,f,m,e,p,y,K,F){function g(){if(0<x)return x--,r>>x&1;r=l[a++];if(255===r){var Z=l[a++];if(Z)throw new I("unexpected marker "+(r<<8|Z).toString(16));
}x=7;return r>>>7}function w(Z){for(;;){Z=Z[g()];if("number"===typeof Z)return Z;if("object"!==typeof Z)throw new I("invalid huffman sequence");}}function u(Z){for(var Q=0;0<Z;)Q=Q<<1|g(),Z--;return Q}function C(Z){if(1===Z)return 1===g()?1:-1;var Q=u(Z);return Q>=1<<Z-1?Q:Q+(-1<<Z)+1}function d(Z,Q){var Y=w(Z.huffmanTableDC);Y=0===Y?0:C(Y);Z.blockData[Q]=Z.pred+=Y;for(Y=1;64>Y;){var ba=w(Z.huffmanTableAC),ca=ba&15;ba>>=4;if(0===ca){if(15>ba)break;Y+=16}else Y+=ba,Z.blockData[Q+k[Y]]=C(ca),Y++}}function b(Z,
Q){var Y=w(Z.huffmanTableDC);Y=0===Y?0:C(Y)<<F;Z.blockData[Q]=Z.pred+=Y}function c(Z,Q){Z.blockData[Q]|=g()<<F}function h(Z,Q){if(0<v)v--;else for(var Y=p;Y<=y;){var ba=w(Z.huffmanTableAC),ca=ba&15;ba>>=4;if(0===ca){if(15>ba){v=u(ba)+(1<<ba)-1;break}Y+=16}else Y+=ba,Z.blockData[Q+k[Y]]=C(ca)*(1<<F),Y++}}function q(Z,Q){for(var Y=p,ba=0,ca;Y<=y;){ca=k[Y];switch(E){case 0:ba=w(Z.huffmanTableAC);ca=ba&15;ba>>=4;if(0===ca)15>ba?(v=u(ba)+(1<<ba),E=4):(ba=16,E=1);else{if(1!==ca)throw new I("invalid ACn encoding");
t=C(ca);E=ba?2:3}continue;case 1:case 2:Z.blockData[Q+ca]?Z.blockData[Q+ca]+=g()<<F:(ba--,0===ba&&(E=2===E?3:0));break;case 3:Z.blockData[Q+ca]?Z.blockData[Q+ca]+=g()<<F:(Z.blockData[Q+ca]=t<<F,E=0);break;case 4:Z.blockData[Q+ca]&&(Z.blockData[Q+ca]+=g()<<F)}Y++}4===E&&(v--,0===v&&(E=0))}var z=f.mcusPerLine,B=a,r=0,x=0,v=0,E=0,t,A=m.length,O,N,X,V;K=f.progressive?0===p?0===K?b:c:0===K?h:q:d;var W=0;f=1===A?m[0].blocksPerLine*m[0].blocksPerColumn:z*f.mcusPerColumn;for(var G,S;W<f;){var T=e?Math.min(f-
W,e):f;for(O=0;O<A;O++)m[O].pred=0;v=0;if(1===A){var aa=m[0];for(V=0;V<T;V++)K(aa,64*((aa.blocksPerLine+1)*(W/aa.blocksPerLine|0)+W%aa.blocksPerLine)),W++}else for(V=0;V<T;V++){for(O=0;O<A;O++)for(aa=m[O],G=aa.h,S=aa.v,N=0;N<S;N++)for(X=0;X<G;X++)K(aa,64*((aa.blocksPerLine+1)*((W/z|0)*aa.v+N)+(W%z*aa.h+X)));W++}x=0;(aa=L(l,a))&&aa.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+aa.invalid),a=aa.offset);aa=aa&&aa.marker;if(!aa||65280>=aa)throw new I("marker was not found");
if(65488<=aa&&65495>=aa)a+=2;else break}(aa=L(l,a))&&aa.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+aa.invalid),a=aa.offset);return a-B}function J(l,a){l=a.blocksPerLine;for(var f=a.blocksPerColumn,m=new Int16Array(64),e=0;e<f;e++)for(var p=0;p<l;p++){var y=void 0,K=void 0,F=void 0,g=void 0,w=void 0,u=void 0,C=void 0,d=void 0,b=w=u=g=K=y=void 0,c=void 0,h=void 0,q=void 0,z=64*((a.blocksPerLine+1)*e+p),B=m,r=a.quantizationTable,x=a.blockData;if(!r)throw new I("missing required Quantization Table.");
for(var v=0;64>v;v+=8)y=x[z+v],d=x[z+v+1],C=x[z+v+2],u=x[z+v+3],w=x[z+v+4],g=x[z+v+5],F=x[z+v+6],K=x[z+v+7],y*=r[v],0===(d|C|u|w|g|F|K)?(y=5793*y+512>>10,B[v]=y,B[v+1]=y,B[v+2]=y,B[v+3]=y,B[v+4]=y,B[v+5]=y,B[v+6]=y,B[v+7]=y):(d*=r[v+1],C*=r[v+2],u*=r[v+3],w*=r[v+4],g*=r[v+5],F*=r[v+6],K*=r[v+7],q=5793*y+128>>8,h=5793*w+128>>8,c=C,b=F,w=2896*(d-K)+128>>8,K=2896*(d+K)+128>>8,u<<=4,g<<=4,q=q+h+1>>1,h=q-h,y=3784*c+1567*b+128>>8,c=1567*c-3784*b+128>>8,b=y,w=w+g+1>>1,g=w-g,K=K+u+1>>1,u=K-u,q=q+b+1>>1,b=
q-b,h=h+c+1>>1,c=h-c,y=2276*w+3406*K+2048>>12,w=3406*w-2276*K+2048>>12,K=y,y=799*u+4017*g+2048>>12,u=4017*u-799*g+2048>>12,g=y,B[v]=q+K,B[v+7]=q-K,B[v+1]=h+g,B[v+6]=h-g,B[v+2]=c+u,B[v+5]=c-u,B[v+3]=b+w,B[v+4]=b-w);for(r=0;8>r;++r)y=B[r],d=B[r+8],C=B[r+16],u=B[r+24],w=B[r+32],g=B[r+40],F=B[r+48],K=B[r+56],0===(d|C|u|w|g|F|K)?(y=5793*y+8192>>14,y=-2040>y?0:2024<=y?255:y+2056>>4,x[z+r]=y,x[z+r+8]=y,x[z+r+16]=y,x[z+r+24]=y,x[z+r+32]=y,x[z+r+40]=y,x[z+r+48]=y,x[z+r+56]=y):(q=5793*y+2048>>12,h=5793*w+2048>>
12,c=C,b=F,w=2896*(d-K)+2048>>12,K=2896*(d+K)+2048>>12,q=(q+h+1>>1)+4112,h=q-h,y=3784*c+1567*b+2048>>12,c=1567*c-3784*b+2048>>12,b=y,w=w+g+1>>1,g=w-g,K=K+u+1>>1,u=K-u,q=q+b+1>>1,b=q-b,h=h+c+1>>1,c=h-c,y=2276*w+3406*K+2048>>12,w=3406*w-2276*K+2048>>12,K=y,y=799*u+4017*g+2048>>12,u=4017*u-799*g+2048>>12,g=y,y=q+K,K=q-K,d=h+g,F=h-g,C=c+u,g=c-u,u=b+w,w=b-w,y=16>y?0:4080<=y?255:y>>4,d=16>d?0:4080<=d?255:d>>4,C=16>C?0:4080<=C?255:C>>4,u=16>u?0:4080<=u?255:u>>4,w=16>w?0:4080<=w?255:w>>4,g=16>g?0:4080<=g?
255:g>>4,F=16>F?0:4080<=F?255:F>>4,K=16>K?0:4080<=K?255:K>>4,x[z+r]=y,x[z+r+8]=d,x[z+r+16]=C,x[z+r+24]=u,x[z+r+32]=w,x[z+r+40]=g,x[z+r+48]=F,x[z+r+56]=K)}return a.blockData}function L(l,a,f){var m=l.length-1;f=f<a?f:a;if(a>=m)return null;var e=l[a]<<8|l[a+1];if(65472<=e&&65534>=e)return{invalid:null,marker:e,offset:a};for(a=l[f]<<8|l[f+1];!(65472<=a&&65534>=a);){if(++f>=m)return null;a=l[f]<<8|l[f+1]}return{invalid:e.toString(16),marker:a,offset:f}}if(!self||!self.Uint8ClampedArray)return null;var k=
new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);n.prototype={parse:function(l){function a(){var r=l[e]<<8|l[e+1];e+=2;return r}function f(){var r=a();r=e+r-2;var x=L(l,r,e);x&&x.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+x.invalid),r=x.offset);r=l.subarray(e,r);e+=r.length;return r}function m(r){for(var x=Math.ceil(r.samplesPerLine/
8/r.maxH),v=Math.ceil(r.scanLines/8/r.maxV),E=0;E<r.components.length;E++){B=r.components[E];var t=Math.ceil(Math.ceil(r.samplesPerLine/8)*B.h/r.maxH),A=Math.ceil(Math.ceil(r.scanLines/8)*B.v/r.maxV);B.blockData=new Int16Array(64*v*B.v*(x*B.h+1));B.blocksPerLine=t;B.blocksPerColumn=A}r.mcusPerLine=x;r.mcusPerColumn=v}var e=0,p=null,y=null,K=[],F=[],g=[],w=a();if(65496!==w)throw new I("SOI not found");for(w=a();65497!==w;){switch(w){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var u=
f();65504===w&&74===u[0]&&70===u[1]&&73===u[2]&&70===u[3]&&0===u[4]&&(p={version:{major:u[5],minor:u[6]},densityUnits:u[7],xDensity:u[8]<<8|u[9],yDensity:u[10]<<8|u[11],thumbWidth:u[12],thumbHeight:u[13],thumbData:u.subarray(14,14+3*u[12]*u[13])});65518===w&&65===u[0]&&100===u[1]&&111===u[2]&&98===u[3]&&101===u[4]&&(y={version:u[5]<<8|u[6],flags0:u[7]<<8|u[8],flags1:u[9]<<8|u[10],transformCode:u[11]});break;case 65499:w=a()+e-2;for(var C;e<w;){var d=l[e++],b=new Uint16Array(64);if(0===d>>4)for(u=
0;64>u;u++)C=k[u],b[C]=l[e++];else if(1===d>>4)for(u=0;64>u;u++)C=k[u],b[C]=a();else throw new I("DQT - invalid table spec");K[d&15]=b}break;case 65472:case 65473:case 65474:if(c)throw new I("Only single frame JPEGs supported");a();var c={};c.extended=65473===w;c.progressive=65474===w;c.precision=l[e++];c.scanLines=a();c.samplesPerLine=a();c.components=[];c.componentIds={};u=l[e++];for(w=b=d=0;w<u;w++){C=l[e];var h=l[e+1]>>4;var q=l[e+1]&15;d<h&&(d=h);b<q&&(b=q);h=c.components.push({h,v:q,quantizationId:l[e+
2],quantizationTable:null});c.componentIds[C]=h-1;e+=3}c.maxH=d;c.maxV=b;m(c);break;case 65476:C=a();for(w=2;w<C;){d=l[e++];b=new Uint8Array(16);for(u=h=0;16>u;u++,e++)h+=b[u]=l[e];q=new Uint8Array(h);for(u=0;u<h;u++,e++)q[u]=l[e];w+=17+h;(0===d>>4?g:F)[d&15]=R(b,q)}break;case 65501:a();var z=a();break;case 65498:a();C=l[e++];u=[];for(w=0;w<C;w++){d=c.componentIds[l[e++]];var B=c.components[d];d=l[e++];B.huffmanTableDC=g[d>>4];B.huffmanTableAC=F[d&15];u.push(B)}w=l[e++];C=l[e++];d=l[e++];w=P(l,e,
c,u,z,w,C,d>>4,d&15);e+=w;break;case 65535:255!==l[e]&&e--;break;default:if(255===l[e-3]&&192<=l[e-2]&&254>=l[e-2])e-=3;else throw new I("unknown marker "+w.toString(16));}w=a()}this.width=c.samplesPerLine;this.height=c.scanLines;this.jfif=p;this.eof=e;this.adobe=y;this.components=[];for(w=0;w<c.components.length;w++){B=c.components[w];if(p=K[B.quantizationId])B.quantizationTable=p;this.components.push({output:J(c,B),scaleX:B.h/c.maxH,scaleY:B.v/c.maxV,blocksPerLine:B.blocksPerLine,blocksPerColumn:B.blocksPerColumn})}this.numComponents=
this.components.length},_getLinearizedBlockData:function(l,a){var f=this.width/l,m=this.height/a,e,p,y=0,K=this.components.length,F=l*a*K,g=new Uint8ClampedArray(F),w=new Uint32Array(l);for(p=0;p<K;p++){var u=this.components[p];var C=u.scaleX*f;var d=u.scaleY*m;y=p;var b=u.output;var c=u.blocksPerLine+1<<3;for(e=0;e<l;e++)u=0|e*C,w[e]=(u&4294967288)<<3|u&7;for(C=0;C<a;C++)for(u=0|C*d,u=c*(u&4294967288)|(u&7)<<3,e=0;e<l;e++)g[y]=b[u+w[e]],y+=K}if(a=this.decodeTransform)for(p=0;p<F;)for(l=u=0;u<K;u++,
p++,l+=2)g[p]=(g[p]*a[l]>>8)+a[l+1];return g},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(l){for(var a,f,m,e=0,p=l.length;e<p;e+=3)a=l[e],f=l[e+1],m=l[e+2],l[e]=a-179.456+1.402*m,l[e+1]=a+135.459-.344*f-.714*m,l[e+2]=a-226.816+1.772*f;return l},_convertYcckToRgb:function(l){for(var a,f,m,e,p=0,y=0,K=l.length;y<K;y+=4)a=l[y],f=l[y+1],m=l[y+2],e=l[y+3],l[p++]=
-122.67195406894+f*(-6.60635669420364E-5*f+4.37130475926232E-4*m-5.4080610064599E-5*a+4.8449797120281E-4*e-.154362151871126)+m*(-9.57964378445773E-4*m+8.17076911346625E-4*a-.00477271405408747*e+1.53380253221734)+a*(9.61250184130688E-4*a-.00266257332283933*e+.48357088451265)+e*(-3.36197177618394E-4*e+.484791561490776),l[p++]=107.268039397724+f*(2.19927104525741E-5*f-6.40992018297945E-4*m+6.59397001245577E-4*a+4.26105652938837E-4*e-.176491792462875)+m*(-7.78269941513683E-4*m+.00130872261408275*a+7.70482631801132E-4*
e-.151051492775562)+a*(.00126935368114843*a-.00265090189010898*e+.25802910206845)+e*(-3.18913117588328E-4*e-.213742400323665),l[p++]=-20.810012546947+f*(-5.70115196973677E-4*f-2.63409051004589E-5*m+.0020741088115012*a-.00288260236853442*e+.814272968359295)+m*(-1.53496057440975E-5*m-1.32689043961446E-4*a+5.60833691242812E-4*e-.195152027534049)+a*(.00174418132927582*a-.00255243321439347*e+.116935020465145)+e*(-3.43531996510555E-4*e+.24165260232407);return l},_convertYcckToCmyk:function(l){for(var a,
f,m,e=0,p=l.length;e<p;e+=4)a=l[e],f=l[e+1],m=l[e+2],l[e]=434.456-a-1.402*m,l[e+1]=119.541-a+.344*f+.714*m,l[e+2]=481.816-a-1.772*f;return l},_convertCmykToRgb:function(l){for(var a,f,m,e,p=0,y=1/255,K=0,F=l.length;K<F;K+=4)a=l[K]*y,f=l[K+1]*y,m=l[K+2]*y,e=l[K+3]*y,l[p++]=255+a*(-4.387332384609988*a+54.48615194189176*f+18.82290502165302*m+212.25662451639585*e-285.2331026137004)+f*(1.7149763477362134*f-5.6096736904047315*m-17.873870861415444*e-5.497006427196366)+m*(-2.5217340131683033*m-21.248923337353073*
e+17.5119270841813)-e*(21.86122147463605*e+189.48180835922747),l[p++]=255+a*(8.841041422036149*a+60.118027045597366*f+6.871425592049007*m+31.159100130055922*e-79.2970844816548)+f*(-15.310361306967817*f+17.575251261109482*m+131.35250912493976*e-190.9453302588951)+m*(4.444339102852739*m+9.8632861493405*e-24.86741582555878)-e*(20.737325471181034*e+187.80453709719578),l[p++]=255+a*(.8842522430003296*a+8.078677503112928*f+30.89978309703729*m-.23883238689178934*e-14.183576799673286)+f*(10.49593273432072*
f+63.02378494754052*m+50.606957656360734*e-112.23884253719248)+m*(.03296041114873217*m+115.60384449646641*e-193.58209356861505)-e*(22.33816807309886*e+180.12613974708367);return l},getData:function(l,a,f){if(4<this.numComponents)throw new I("Unsupported color mode");l=this._getLinearizedBlockData(l,a);if(1===this.numComponents&&f){f=l.length;a=new Uint8ClampedArray(3*f);for(var m=0,e=0;e<f;e++){var p=l[e];a[m++]=p;a[m++]=p;a[m++]=p}return a}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(l);
if(4===this.numComponents){if(this._isColorConversionNeeded())return f?this._convertYcckToRgb(l):this._convertYcckToCmyk(l);if(f)return this._convertCmykToRgb(l)}return l}};return n}()})})(D);M.JpegImage=D.exports})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(M,D,H){function I(k,l,a){a.set(k.slice(l,l+a.length))}function n(k){const {_malloc:l,_free:a,_lerc_getBlobInfo:f,_lerc_getDataRanges:m,_lerc_decode_4D:e,asm:p}=k;let y;const K=
Object.values(p).find(g=>g&&"buffer"in g&&g.buffer===k.HEAPU8.buffer),F=g=>{g=g.map(C=>(C>>3<<3)+16);var w=g.reduce((C,d)=>C+d),u=l(w);y=new Uint8Array(K.buffer);w=g[0];g[0]=u;for(u=1;u<g.length;u++){const C=g[u];g[u]=g[u-1]+w;w=C}return g};L.getBlobInfo=g=>{var w=new Uint8Array(48),u=new Uint8Array(24);const [C,d,b]=F([g.length,w.length,u.length]);y.set(g,C);y.set(w,d);y.set(u,b);var c=f(C,g.length,d,b,12,3);if(c)throw a(C),`lerc-getBlobInfo: error code is ${c}`;y=new Uint8Array(K.buffer);I(y,d,
w);I(y,b,u);w=new Uint32Array(w.buffer);var h=new Float64Array(u.buffer);const [q,z,,B,r,x,v,E,t,A,O]=w;u={version:q,depthCount:A,width:B,height:r,validPixelCount:v,bandCount:x,blobSize:E,maskCount:t,dataType:z,minValue:h[0],maxValue:h[1],maxZerror:h[2],statistics:[],bandCountWithNoData:O};if(O)return u;if(1===A&&1===x)return a(C),u.statistics.push({minValue:h[0],maxValue:h[1]}),u;c=A*x*8;var N=new Uint8Array(c),X=new Uint8Array(c);w=C;var V=h=0;let W=!1;y.byteLength<C+2*c?(a(C),W=!0,[w,h,V]=F([g.length,
c,c]),y.set(g,w)):[h,V]=F([c,c]);y.set(N,h);y.set(X,V);if(c=m(w,g.length,A,x,h,V))throw a(w),W||a(h),`lerc-getDataRanges: error code is ${c}`;y=new Uint8Array(K.buffer);I(y,h,N);I(y,V,X);g=new Float64Array(N.buffer);c=new Float64Array(X.buffer);X=u.statistics;for(N=0;N<x;N++)if(1<A){V=g.slice(N*A,(N+1)*A);const G=c.slice(N*A,(N+1)*A),S=Math.min.apply(null,V),T=Math.max.apply(null,G);X.push({minValue:S,maxValue:T,depthStats:{minValues:V,maxValues:G}})}else X.push({minValue:g[N],maxValue:c[N]});a(w);
W||a(h);return u};L.decode=(g,w)=>{const {maskCount:u,depthCount:C,bandCount:d,width:b,height:c,dataType:h,bandCountWithNoData:q}=w;var z=R[h],B=b*c;w=new Uint8Array(B*d);z=new Uint8Array(B*C*d*z.size);B=new Uint8Array(d);var r=new Uint8Array(8*d);const [x,v,E,t,A]=F([g.length,w.length,z.length,B.length,r.length]);y.set(g,x);y.set(w,v);y.set(z,E);y.set(B,t);y.set(r,A);if(g=e(x,g.length,u,v,C,b,c,d,h,E,t,A))throw a(x),`lerc-decode: error code is ${g}`;y=new Uint8Array(K.buffer);I(y,E,z);I(y,v,w);g=
null;if(q){I(y,t,B);I(y,A,r);g=[];r=new Float64Array(r.buffer);for(let O=0;O<B.length;O++)g.push(B[O]?r[O]:null)}a(x);return{data:z,maskData:w,noDataValues:g}}}const R=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,128]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,
range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let P=null,J=!1;const L={getBlobInfo:null,decode:null};D.decode=function(k,l={}){var a=l.inputOffset??0;k=k instanceof Uint8Array?k.subarray(a):new Uint8Array(k,a);a=L.getBlobInfo(k);const {data:f,maskData:m}=L.decode(k,a),{width:e,height:p,bandCount:y,depthCount:K,dataType:F,maskCount:g,
statistics:w}=a;var u=R[F],C=new u.ctor(f.buffer);k=[];a=[];const d=e*p;var b=d*K;for(var c=0;c<y;c++){var h=C.subarray(c*b,(c+1)*b);if(l.returnInterleaved)k.push(h);else{a:{var q=d,z=K;if(2>z)break a;const B=new u.ctor(q*z);for(let r=0,x=0;r<q;r++)for(let v=0,E=r;v<z;v++,E+=q)B[E]=h[x++];h=B}k.push(h)}a.push(m.subarray(c*b,(c+1)*b))}C=0===g?null:1===g?a[0]:new Uint8Array(d);if(1<g)for(C.set(a[0]),b=1;b<a.length;b++)for(c=a[b],h=0;h<d;h++)C[h]&=c[h];({noDataValue:l}=l);b=null!=l&&u.range[0]<=l&&u.range[1]>=
l;if(0<g&&b)for(b=0;b<y;b++)for(c=k[b],h=a[b]||C,q=0;q<d;q++)0===h[q]&&(c[q]=l);({pixelType:u}=u);return{width:e,height:p,bandCount:y,pixelType:u,depthCount:K,statistics:w,pixels:k,mask:C,bandMasks:g===y&&1<y?a:null}};D.getBlobInfo=function(k,l={}){k=k instanceof Uint8Array?k.subarray(l.inputOffset??0):new Uint8Array(k,l.inputOffset??0);return L.getBlobInfo(k)};D.isLoaded=function(){return J};D.load=function(){return P?P:P=(new Promise((k,l)=>M(["../../../chunks/lerc-wasm"],k,l))).then(k=>k.lercWasm).then(({default:k})=>
k({locateFile:l=>H.getAssetUrl(`esri/layers/support/rasterFormats/${l}`)})).then(k=>{n(k);J=!0})};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(M){function D(R,P,J,L=!0){if(0!==P%4||0!==J%4){var k=new ArrayBuffer(4*Math.ceil(J/4));k=new Uint8Array(k);R=new Uint8Array(R,P,J);if(L)for(L=0;L<k.length;L+=4)k[L]=R[L+3],k[L+1]=R[L+2],k[L+2]=R[L+1],k[L+3]=R[L];else k.set(R);return new Uint32Array(k.buffer)}if(L){L=
new Uint8Array(R,P,J);k=new Uint8Array(L.length);for(R=0;R<k.length;R+=4)k[R]=L[R+3],k[R+1]=L[R+2],k[R+2]=L[R+1],k[R+3]=L[R];return new Uint32Array(k.buffer)}return new Uint32Array(R,P,J/4)}function H(){const R=[];for(let P=0;257>=P;P++)R[P]=[P];return R}function I(R,P){for(let J=0;J<P.length;J++)R.push(P[J])}const n=new Set;n.add(511);n.add(1023);n.add(2047);n.add(4095);n.add(8191);M.decode=function(R,P,J,L=!0){R=D(R,P,J,L);P=9;L=H();let k=32,l=L.length,a=[],f=1,m=R[0],e=0;const p=R.length;J=8*(4*
p-J);const y=[];for(;null!=m;){if(k>=P)k-=P,e=m>>>32-P,m<<=P;else{e=m>>>32-k;m=R[f++];var K=P-k;k=32-K;e=(e<<K)+(m>>>k);m<<=K}if(257===e)break;if(256===e)P=9,L=H(),l=L.length,a=[];else{K=L[e];if(null==K){if(e>L.length)throw"data integrity issue: code does not exist on code page";a.push(a[0]);L[l++]=a.slice();I(y,a)}else I(y,K),a.push(K[0]),1<a.length&&(L[l++]=a.slice()),a=K.slice();n.has(l)&&P++;0===k&&(m=R[f++],k=32);if(f>p||f===p&&k<=J)break}}return new Uint8Array(y)};Object.defineProperties(M,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const M=D=>{let H=1;switch(D){case Uint8Array:case Int8Array:H=1;break;case Uint16Array:case Int16Array:H=2;break;case Uint32Array:case Int32Array:case Float32Array:H=4;break;case Float64Array:H=8}return H};return function(){function D(){}D.decode=function(H,I){var n=I.pixelType;const R=[],P=I.width*I.height;var J=Math.floor(H.byteLength/(I.width*I.height*M(I.pixelType)));
const {bandIds:L,format:k}=I;I=L&&L.length||Math.floor(H.byteLength/(I.width*I.height*M(I.pixelType)));var l=H.byteLength-H.byteLength%(P*M(n)),a=new n(H,0,P*J);let f,m,e,p,y=null;if("bip"===k)for(f=0;f<I;f++){e=new n(P);p=L?L[f]:f;for(m=0;m<P;m++)e[m]=a[m*J+p];R.push(e)}else if("bsq"===k)for(f=0;f<I;f++)p=L?L[f]:f,R.push(a.subarray(p*P,(p+1)*P));if(l<H.byteLength-1)if(H=H.slice(l),8*H.byteLength<P)y=null;else{H=new Uint8Array(H,0,Math.ceil(P/8));n=new Uint8Array(P);for(l=a=l=I=J=0;l<H.length-1;l++)for(I=
H[l],a=7;0<=a;a--)n[J++]=I>>a&1;for(a=7;J<P-1;)I=H[H.length-1],n[J++]=I>>a&1,a--;y=n}return{pixels:R,mask:y}};return D}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(M,D,H,I,n,R,P,J,L,k){function l(t,A){let O="unknown";3===t?O=64===A?"f64":"f32":1===t?1===A?O="u1":2===A?O="u2":
4===A?O="u4":8>=A?O="u8":16>=A?O="u16":32>=A&&(O="u32"):2===t&&(8>=A?O="s8":16>=A?O="s16":32>=A&&(O="s32"));return O}function a(t){let A=null;switch(t?t.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":A=Uint8Array;break;case "u16":A=Uint16Array;break;case "u32":A=Uint32Array;break;case "s8":A=Int8Array;break;case "s16":A=Int16Array;break;case "s32":A=Int32Array;break;case "f64":A=Float64Array;break;default:A=Float32Array}return A}function f(t,A){return{x:A[0]*t.x+A[1]*t.y+A[2],y:A[3]*
t.x+A[4]*t.y+A[5]}}function m(t,A){return t.get(A)?.values?.[0]}function e(t,A,O,N=0,X=J.TIFF_TAGS,V=4){var W=8===V;const G=W?d(new DataView(t,O,8),0,A):(new DataView(t,O,2)).getUint16(0,A),S=4+2*V;var T=W?8:2;W=T+G*S;if(O+W>t.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:W};const aa=O+W+4<=t.byteLength?b(new DataView(t,O+W,8===V?8:4),0,A,8===V):null;O+=T;T=new Map;let Z,Q,Y,ba=0,ca=0;for(let ha=0;ha<G;ha++){var fa=new DataView(t,O+S*ha,S);Z=fa.getUint16(0,A);Y=fa.getUint16(2,
A);Q=J.getTagName(Z,X);const ka=[];2===V?(ba=fa.getUint16(4,A),ca=fa.getUint16(6,A)):4===V?(ba=fa.getUint32(4,A),ca=fa.getUint32(8,A)):8===V&&(ba=b(fa,4,A,!0),ca=b(fa,12,A,!0),ka.push(fa.getUint32(12,A)),ka.push(fa.getUint32(16,A)));fa={id:Z,type:Y,valueCount:ba,valueOffset:ca,valueOffsets:ka,values:null};g(t,A,fa,N,!1,V);T.set(Q,fa)}return{success:!0,ifd:T,nextIFD:aa,requiredBufferSize:W}}function p(t,A,O,N,X){return y.apply(this,arguments)}function y(){y=D._asyncToGenerator(function*(t,A,O,N,X){var V=
L.isPlatformLittleEndian===A,W=m(O,"BITSPERSAMPLE"),G=m(O,"SAMPLEFORMAT")??1;G=l(G,W);const S=m(O,"COMPRESSION")??1;W=a(G);if(34887===S)return yield R.load(),R.decode(t,{inputOffset:N}).pixels[0];if(1===S){var T=t.slice(N,N+X);var aa=new Uint8Array(T)}else if(8===S||32946===S)aa=new Uint8Array(t,N,X),aa=new k.Zlib(aa),t=aa.getBytes(),T=new ArrayBuffer(t.length),aa=new Uint8Array(T),aa.set(t);else if(6===S)aa=new Uint8Array(t,N,X),T=new n.JpegImage,T.parse(aa),t=T.getData(T.width,T.height,!0),T=new ArrayBuffer(t.length),
aa=new Uint8Array(T),aa.set(t);else if(7===S){A=O.get("JPEGTABLES").values;T=A.length-2;aa=new Uint8Array(T+X-2);for(O=0;O<T;O++)aa[O]=A[O];t=new Uint8Array(t,N+2,X-2);for(N=0;N<t.length;N++)aa[T+N]=t[N];T=new n.JpegImage;T.parse(aa);t=T.getData(T.width,T.height,!0);T=new ArrayBuffer(t.length);aa=new Uint8Array(T);aa.set(t)}else 5===S&&(aa=P.decode(t,N,X,A),T=aa.buffer);if("u8"!==G&&"s8"!==G&&!V)switch(H.assertIsSome(aa),T=new ArrayBuffer(aa.length),V=new Uint8Array(T),G){case "u16":case "s16":for(G=
0;G<aa.length;G+=2)V[G]=aa[G+1],V[G+1]=aa[G];break;case "u32":case "s32":case "f32":for(G=0;G<aa.length;G+=4)V[G]=aa[G+3],V[G+1]=aa[G+2],V[G+2]=aa[G+1],V[G+3]=aa[G]}return new W(T)});return y.apply(this,arguments)}function K(t,A,O){return F.apply(this,arguments)}function F(){F=D._asyncToGenerator(function*(t,A,O){const N=O.get("TILEOFFSETS")?.values;if(void 0===N)return null;const X=O.get("TILEBYTECOUNTS")?.values,{width:V,height:W,pixelType:G,tileWidth:S,tileHeight:T}=w([O]);var aa=u(O,A);const Z=
A.planes;var Q=V*W,Y=m(O,"BITSPERSAMPLE"),ba=34887===(m(O,"COMPRESSION")??1),ca=a(G);const fa=[];for(var ha=0;ha<Z;ha++)fa.push(new ca(Q));let ka,ma,na,ra,ta,pa,qa,oa;Q=Math.ceil(V/S);if(0===Y%8)if(ba&&aa&&1<Z)for(aa=Math.round(N.length/Z),Y=0;Y<aa;Y++){var U=Math.floor(Y/Q)*T;na=Y%Q*S;ca=U*V+na;for(ba=0;ba<Z;ba++)if(ha=Y*Z+ba,0!==X[ha])for(ha=yield p(t,A.littleEndian,O,N[ha],X[ha]),ta=0,ra=ca,qa=Math.min(S,V-na),pa=Math.min(T,W-U),oa=fa[ba],ka=0;ka<pa;ka++)for(ra=ca+ka*V,ta=ka*S,ma=0;ma<qa;ma++,
ra++,ta++)oa[ra]=ha[ta]}else for(Y=0;Y<N.length;Y++)if(0!==X[Y])for(U=Math.floor(Y/Q)*T,na=Y%Q*S,ca=U*V+na,ha=yield p(t,A.littleEndian,O,N[Y],X[Y]),ta=0,ra=ca,qa=Math.min(S,V-na),pa=Math.min(T,W-U),U=0;U<Z;U++)if(oa=fa[U],aa||ba)for(ka=0;ka<pa;ka++)for(ra=ca+ka*V,ta=S*T*U+ka*S,ma=0;ma<qa;ma++,ra++,ta++)oa[ra]=ha[ta];else for(ka=0;ka<pa;ka++)for(ra=ca+ka*V,ta=ka*S*Z+U,ma=0;ma<qa;ma++,ra++,ta+=Z)oa[ra]=ha[ta];return{width:V,height:W,pixelType:G,pixels:fa}});return F.apply(this,arguments)}function g(t,
A,O,N=0,X=!1,V=4){if(O.values)return!0;var W=O.type,G=O.valueCount,S=O.valueOffset;let T=[];var aa=r[W],Z=8*aa,Q=G*aa,Y=G*r[W]*8,ba=8===V?64:32;V=O.valueOffsets;if(Y>ba&&Q>(X?t.byteLength:t?t.byteLength-S+N:0))return O.offlineOffsetSize=[S,Q],O.values=null,!1;if(Y<=ba)if(A||(32>=ba?S>>>=32-Y:(t=V?.length?V[0]:S>>>0,A=V?.length?V[1]:Math.round((S-t)/4294967296),32>=Y?(S=t>>>32-Y,V[0]=S):(S=t*2**(32-Y)+(A>>>32-Y),V[0]=t,V[1]=A>>>32-Y))),1===G&&Z===ba)T=[S];else if(64===ba)for(t=V?.length?V[0]:S>>>0,
S=V?.length?V[1]:Math.round((S-t)/4294967296),A=t,aa=32,t=1;t<=G;t++)Q=32-Z*t%32,aa<Z?(Q=A<<Q>>>32-aa,Y=S<<32-aa>>>32-aa,A=S,T.push(Q+Y*2**(Z-aa)),aa-=32-(Z-aa)):(T.push(A<<Q>>>32-Z),aa-=Z),0===aa&&(aa=32,A=S);else for(t=1;t<=G;t++)T.push(S<<32-Z*t>>>32-Z);else for(S-=N,X&&(S=0),G=S;G<S+Q;G+=aa){switch(W){case 1:Z=(new DataView(t,G,1)).getUint8(0);break;case 2:Z=(new DataView(t,G,1)).getUint8(0);break;case 3:Z=(new DataView(t,G,2)).getUint16(0,A);break;case 4:case 13:Z=(new DataView(t,G,4)).getUint32(0,
A);break;case 5:Z=(new DataView(t,G,4)).getUint32(0,A)/(new DataView(t,G+4,4)).getUint32(0,A);break;case 6:Z=(new DataView(t,G,1)).getInt8(0);break;case 7:Z=(new DataView(t,G,1)).getUint8(0);break;case 8:Z=(new DataView(t,G,2)).getInt16(0,A);break;case 9:Z=(new DataView(t,G,4)).getInt32(0,A);break;case 10:Z=(new DataView(t,G,4)).getInt32(0,A)/(new DataView(t,G+4,4)).getInt32(0,A);break;case 11:Z=(new DataView(t,G,4)).getFloat32(0,A);break;case 12:Z=(new DataView(t,G,8)).getFloat64(0,A);break;case 16:case 18:Z=
d(new DataView(t,G,8),0,A);break;case 17:V=new DataView(t,G,8);Y=(Z=A)?V.getInt32(0,Z):V.getUint32(0,Z);V=Z?V.getUint32(4,Z):V.getInt32(4,Z);ba=0<=(Z?Y:V)?1:-1;Z?Y*=ba:V*=ba;Z=ba*(Z?4294967296*V+Y:4294967296*Y+V);break;default:Z=null}T.push(Z)}if(2===W){W="";S=T;T=[];for(t=0;t<S.length;t++)0===S[t]&&""!==W?(T.push(W),W=""):W+=String.fromCharCode(S[t]);""===W&&0!==T.length||T.push(W)}O.values=T;return!0}function w(t){var A=t[0];const O=m(A,"TILEWIDTH"),N=m(A,"TILELENGTH"),X=m(A,"IMAGEWIDTH"),V=m(A,
"IMAGELENGTH");var W=m(A,"BITSPERSAMPLE");const G=m(A,"SAMPLESPERPIXEL");var S=m(A,"SAMPLEFORMAT")??1;const T=l(S,W),aa=u(A);var Z=A.get("GDAL_NODATA")?.values;let Q=null;Z?.length&&(Q=Z.map(oa=>parseFloat(oa)),Q.some(oa=>isNaN(oa))&&(Q=null));var Y=m(A,"COMPRESSION")??1;switch(Y){case 1:Z="NONE";break;case 2:case 3:case 4:case 32771:Z="CCITT";break;case 5:Z="LZW";break;case 6:case 7:Z="JPEG";break;case 32773:Z="PACKBITS";break;case 8:case 32946:Z="DEFLATE";break;case 34712:Z="JPEG2000";break;case 34887:Z=
"LERC";break;default:Z=String(Y)}let ba=!0,ca="";x.has(Y)||(ba=!1,ca+="unsupported tag compression "+Y);3<S&&(ba=!1,ca+="unsupported tag sampleFormat "+S);0!==W%8&&(ba=!1,ca+="unsupported tag bitsPerSample "+W);W=A.get("GEOASCIIPARAMS")?.values?.[0];if(W){var fa=(fa=W.split("|").find(oa=>oa.includes("ESRI PE String \x3d ")))?fa.replace("ESRI PE String \x3d ",""):"";fa=fa.startsWith("COMPD_CS")||fa.startsWith("PROJCS")||fa.startsWith("GEOGCS")?{wkid:null,wkt:fa}:null}S=A.get("GEOTIEPOINTS")?.values;
W=A.get("GEOPIXELSCALE")?.values;Y=A.get("GEOTRANSMATRIX")?.values;var ha=A.has("GEOKEYDIRECTORY")?A.get("GEOKEYDIRECTORY").data:null;A=!1;if(ha){A=2===m(ha,"GTRasterTypeGeoKey");var ka=m(ha,"GTModelTypeGeoKey");2===ka?(ha=m(ha,"GeographicTypeGeoKey"),1024<=ha&&32766>=ha&&(fa={wkid:ha})):1===ka&&(ha=m(ha,"ProjectedCSTypeGeoKey"),1024<=ha&&32766>=ha&&(fa={wkid:ha}))}let ma;W&&S&&6<=S.length?(ma=[W[0],0,S[3]-S[0]*W[0],0,-Math.abs(W[1]),S[4]-S[1]*W[1]],A&&(ma[2]-=.5*ma[0]+.5*ma[1],ma[5]-=.5*ma[3]+.5*
ma[4])):Y&&16===Y.length&&(ma=A?[Y[0],Y[1],Y[3]-.5*Y[0],Y[4],Y[5],Y[7]-.5*Y[5]]:[Y[0],Y[1],Y[3],Y[4],Y[5],Y[7]]);if(ma){A=[{x:0,y:V},{x:0,y:0},{x:X,y:V},{x:X,y:0}];ha=Y=Number.POSITIVE_INFINITY;let oa=ka=Number.NEGATIVE_INFINITY;for(let U=0;U<A.length;U++)S=f(A[U],ma),Y=S.x>Y?Y:S.x,ka=S.x<ka?ka:S.x,ha=S.y>ha?ha:S.y,oa=S.y<oa?oa:S.y;fa={xmin:Y,xmax:ka,ymin:ha,ymax:oa,spatialReference:fa}}else fa={xmin:-.5,ymin:.5-V,xmax:X-.5,ymax:.5,spatialReference:fa};A=t.filter(oa=>1===oa.get("NEWSUBFILETYPE")?.values?.[0]);
let na;let ra,ta;if(0<A.length){ra=Math.round(Math.log(X/m(A[0],"IMAGEWIDTH"))/Math.LN2);var pa=A[A.length-1];ta=Math.round(Math.log(X/m(pa,"IMAGEWIDTH"))/Math.LN2);na=m(pa,"TILEWIDTH");pa=m(pa,"TILELENGTH")}na=null!=ta&&0<ta?na||O:null;pa=null!=ta&&0<ta?pa||N:null;let qa;O&&(qa=[{maxCol:Math.ceil(X/O)-1,maxRow:Math.ceil(V/N)-1,minRow:0,minCol:0}],A.forEach(oa=>{qa.push({maxCol:Math.ceil(m(oa,"IMAGEWIDTH")/m(oa,"TILEWIDTH"))-1,maxRow:Math.ceil(m(oa,"IMAGELENGTH")/m(oa,"TILELENGTH"))-1,minRow:0,minCol:0})}));
A=t[0].get("GDAL_METADATA")?.values?.[0];A=E(A);ca+=" "+q({width:X,height:V,tileWidth:O,tileHeight:N,planes:G,ifds:t});return{width:X,height:V,tileWidth:O,tileHeight:N,planes:G,isBSQ:aa,pixelType:T,compression:Z,noData:Q,isSupported:ba,message:ca,extent:fa,affine:W?null:ma,firstPyramidLevel:ra,maximumPyramidLevel:ta,pyramidBlockWidth:na,pyramidBlockHeight:pa,tileBoundary:qa,metadata:A}}function u(t,A){return(t=t.get("PLANARCONFIGURATION")?.values)?2===t[0]:A?A.isBSQ:!1}function C(t){const {littleEndian:A,
isBigTiff:O,firstIFDPos:N}=c(t);var X=N;const V=[];do if(X=h(t,A,X,0,J.TIFF_TAGS,O?8:4),X.success)V.push(X.ifd),X=X.nextIFD;else break;while(0<X);return{...w(V),littleEndian:A,isBigTiff:O,ifds:V}}function d(t,A,O){const N=t.getUint32(A,O);t=t.getUint32(A+4,O);return O?4294967296*t+N:4294967296*N+t}function b(t,A,O,N){return N?d(t,A,O):t.getUint32(A,O)}function c(t){var A=new DataView(t,0,16),O=A.getUint16(0,!1);t=null;if(18761===O)t=!0;else if(19789===O)t=!1;else throw"unexpected endianess byte";
var N=A.getUint16(2,t);if(42!==N&&43!==N)throw"unexpected tiff identifier";O=4;if(N=43===N){const X=A.getUint16(O,t);O+=2;if(8!==X)throw"unsupported bigtiff version";if(0!==A.getUint16(O,t))throw"unsupported bigtiff version";O+=2}A=b(A,O,t,N);return{littleEndian:t,isBigTiff:N,firstIFDPos:A}}function h(t,A,O,N=0,X=J.TIFF_TAGS,V=4){O=e(t,A,O,N,X,V);let W;const G=O.ifd;G&&(J.ifdTags.forEach((S,T)=>{G.has(T)&&(W=G.get(T),W.data=e(t,A,W.valueOffset-N,N,S).ifd)}),G.has("GEOKEYDIRECTORY")&&(W=G.get("GEOKEYDIRECTORY"),
(X=W.values)&&4<X.length&&(X=X[0]+"."+X[1]+"."+X[2],W.data=e(t,A,W.valueOffset+6-N,N,J.GEO_KEYS,2).ifd,W.data&&W.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[X]}))),G.has("XMP")&&(W=G.get("XMP"),X=W.values,"number"===typeof X[0]&&7===W.type&&(W.values=[I.bytesToUTF8(new Uint8Array(X))])));return O}function q(t){const {width:A,height:O,tileHeight:N,tileWidth:X}=t,V=t.planes,W=X?X*N:A*O;t=m(t.ifds[0],"BITSPERSAMPLE");let G="";W*V>2**30/(8<t?t/8:1)&&(G=X?"tiled tiff exceeding 1 gigabits per tile is not supported":
"scanline tiff exceeding 1 gigabits is not supported");return G}function z(){z=D._asyncToGenerator(function*(t,A){const {headerInfo:O,ifd:N,offsets:X,sizes:V}=A;var W=[];for(var G=0;G<X.length;G++){var S=yield p(t,O.littleEndian,N,X[G],V[G]||t.byteLength);W.push(S)}var T=u(N,O);const {pixelType:aa,planes:Z}=O;var Q=a(aa);t=m(N,"TILEWIDTH");G=m(N,"TILELENGTH");var Y=m(N,"COMPRESSION")??1;S=t*G;const ba=[];var ca=W[0];const fa=34887===Y;for(let ka=0;ka<Z;ka++){Y=new Q(S);if(T&&fa){if(ca=W[ka],ca.length)for(var ha=
0;ha<S;ha++)Y[ha]=ca[ka][ha+ka]}else if(ca.length)if(T||fa&&!T)Y=ca.slice(S*ka,S*(ka+1));else for(ha=0;ha<S;ha++)Y[ha]=ca[ha*Z+ka];ba.push(Y)}W=O.noData?O.noData[0]:A.noDataValue;T=(Q=O.metadata?O.metadata.statistics:null)?Q.map(ka=>ka.min):null;ca=Q?Q.map(ka=>ka.max):null;Q=null;if(null!=W)if(Q=new Uint8Array(S),1E24<Math.abs(W))for(A=0;A<S;A++)Q[A]=1E-6>Math.abs((ba[0][A]-W)/W)?0:1;else for(A=0;A<S;A++)Q[A]=ba[0][A]===W?0:1;else T&&ca&&A.applyMinMaxConstraint&&(Q=v(ba,T,ca));return{pixelType:aa,
width:t,height:G,pixels:ba,mask:Q,noDataValue:W}});return z.apply(this,arguments)}function B(){B=D._asyncToGenerator(function*(t,A={}){var O=A.pyramidLevel||0,N=A.headerInfo||C(t);const {ifds:X,noData:V}=N;if(0===X.length)throw"no valid image file directory";var W=q(N);if(W)throw W;W=null;var G=-1===O?X[X.length-1]:X[O];A=V?V[0]:A.noDataValue;if(N.tileWidth)W=yield K(t,N,G);else{{const ta=L.isPlatformLittleEndian===N.littleEndian,pa=G.get("STRIPOFFSETS")?.values;if(void 0===pa)t=null;else{var {width:S,
height:T,pixelType:aa}=w([G]);W=N.planes;O=S*T;var Z=m(G,"BITSPERSAMPLE"),Q=a(aa),Y=new Q(O*W),ba=G.get("STRIPBYTECOUNTS")?.values,ca=m(G,"ROWSPERSTRIP"),fa=m(G,"COMPRESSION")??1;var ha=ca;if(0===Z%8)for(G=0;G<pa.length;G++){var ka=G*ca*S*W;ha=(G+1)*ca>T?T-G*ca:ca;if("u8"===aa||"s8"===aa||ta)if(8===fa||32946===fa){var ma=new Uint8Array(t,pa[G],ba[G]);ma=new k.Zlib(ma);var na=ma.getBytes();var ra=new ArrayBuffer(na.length);ma=new Uint8Array(ra);ma.set(na);ma.length!==ha*S*W*Z/8&&console.log("strip byte counts is different than expected")}else 6===
fa?(ma=new Uint8Array(t,pa[G],ba[G]),ra=new n.JpegImage,ra.parse(ma),ha=ra.getData(ra.width,ra.height,!0),ra=new ArrayBuffer(ha.length),ma=new Uint8Array(ra),ma.set(ha)):5===fa?(ma=P.decode(t,pa[G],ba[G],N.littleEndian),ra=ma.buffer):(ba[G]!==ha*S*W*Z/8&&console.log("strip byte counts is different than expected"),ra=t.slice(pa[G],pa[G]+ba[G]));else{6===fa||8===fa||32946===fa?(ma=new Uint8Array(t,pa[G],ba[G]),ma=new k.Zlib(ma),ma=ma.getBytes(),ra=new ArrayBuffer(ma.length),na=new Uint8Array(ra),ma.length!==
ha*S*W*Z/8&&console.log("strip byte counts is different than expected")):(ba[G]!==ha*S*W*Z/8&&console.log("strip byte counts is different than expected"),ra=new ArrayBuffer(ba[G]),ma=new Uint8Array(t,pa[G],ba[G]),na=new Uint8Array(ra));switch(aa){case "u16":case "s16":for(ha=0;ha<ma.length;ha+=2)na[ha]=ma[ha+1],na[ha+1]=ma[ha];break;case "u32":case "s32":case "f32":for(ha=0;ha<ma.length;ha+=4)na[ha]=ma[ha+3],na[ha+1]=ma[ha+2],na[ha+2]=ma[ha+1],na[ha+3]=ma[ha]}H.assertIsSome(ra)}ma=new Q(ra);Y.set(ma,
ka)}Z=[];if(1===W)Z.push(Y);else for(G=0;G<W;G++){N=new Q(O);for(t=0;t<O;t++)N[t]=Y[t*W+G];Z.push(N)}t={width:S,height:T,pixelType:aa,pixels:Z}}}W=yield t}if(null!=A){H.assertIsSome(W);W.mask=new Uint8Array(W.width*W.height);if(1E24<Math.abs(A))for(t=0;t<W.width*W.height;t++)W.mask[t]=1E-6>Math.abs((W.pixels[0][t]-A)/A)?0:1;else for(t=0;t<W.width*W.height;t++)W.mask[t]=W.pixels[0][t]===A?0:1;W.noDataValue=A}return W});return B.apply(this,arguments)}const r=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,
8],x=new Set([1,5,6,7,8,34712,34887]),v=(t,A,O)=>{if(!(t&&0<t.length&&A&&O))return null;let N,X,V;const W=t[0].length,G=t.length,S=new Uint8Array(W);for(let aa=0;aa<G;aa++)if(N=t[aa],X=A[aa],V=O[aa],0===aa)for(var T=0;T<W;T++)S[T]=N[T]<X||N[T]>V?0:1;else for(T=0;T<W;T++)S[T]&&(S[T]=N[T]<X||N[T]>V?0:1);return S},E=t=>{if(!t)return null;var A=t.match(/<Item(.*?)Item>/gi);if(!A||0===A.length)return null;t=new Map;var O;for(var N=0;N<A.length;N++){var X=A[N];var V=X.slice(6,X.indexOf("\x3e"));var W=X.indexOf("sample\x3d");
-1<W&&(O=X.slice(W+8,X.indexOf('"',W+8)));W=X.indexOf("name\x3d");-1<W&&(V=X.slice(W+6,X.indexOf('"',W+6)));V&&(X=X.slice(X.indexOf("\x3e")+1,X.indexOf("\x3c/Item\x3e")).trim(),null!=O?t.has(V)?t.get(V)[O]=X:t.set(V,[X]):t.set(V,X));O=null}A=t.get("STATISTICS_MINIMUM");V=t.get("STATISTICS_MAXIMUM");N=t.get("STATISTICS_MEAN");X=t.get("STATISTICS_STDDEV");O=null;if(A&&V)for(O=[],W=0;W<A.length;W++)O.push({min:parseFloat(A[W]),max:parseFloat(V[W]),avg:N&&parseFloat(N[W]),stddev:X&&parseFloat(X[W])});
V=t.get("BandName");N=t.get("WavelengthMin");X=t.get("WavelengthMax");A=null;if(V)for(A=[],W=0;W<V.length;W++)A.push({BandName:V[W],WavelengthMin:N&&parseFloat(N[W]),WavelengthMax:X&&parseFloat(X[W])});V=t.get("DataType");return{statistics:O,bandProperties:A,dataType:V,rawMetadata:t}};M.decode=function(t){return B.apply(this,arguments)};M.decodeTileOrStrip=function(t,A){return z.apply(this,arguments)};M.getImageInfo=w;M.isBSQConfig=u;M.parseFieldValues=g;M.parseHeader=C;M.parseIFD=h;M.parseSignature=
c;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(M){M.bytesToUTF8=function(D,H){let I=0,n="",R=0,P=0;const J=D.length;for(;I<J;)if(P=D[I++],R=P>>4,8>R?R=1:15===R?(R=4,P=(P&7)<<18|(D[I++]&63)<<12|(D[I++]&63)<<6|D[I++]&63):14===R?(R=3,P=(P&15)<<12|(D[I++]&63)<<6|D[I++]&63):(R=2,P=(P&31)<<6|D[I++]&63),0!==P||H)n+=String.fromCharCode(P);return n};Object.defineProperties(M,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const M=(()=>{const n=[];n[254]="NEWSUBFILETYPE";n[255]="SUBFILETYPE";n[256]="IMAGEWIDTH";n[257]="IMAGELENGTH";n[258]="BITSPERSAMPLE";n[259]="COMPRESSION";n[262]="PHOTOMETRICINTERPRETATION";n[263]="THRESHHOLDING";n[264]="CELLWIDTH";n[265]="CELLLENGTH";n[266]="FILLORDER";n[269]="DOCUMENTNAME";n[270]="IMAGEDESCRIPTION";n[271]="MAKE";n[272]="MODEL";n[273]="STRIPOFFSETS";
n[274]="ORIENTATION";n[277]="SAMPLESPERPIXEL";n[278]="ROWSPERSTRIP";n[279]="STRIPBYTECOUNTS";n[280]="MINSAMPLEVALUE";n[281]="MAXSAMPLEVALUE";n[282]="XRESOLUTION";n[283]="YRESOLUTION";n[284]="PLANARCONFIGURATION";n[285]="PAGENAME";n[286]="XPOSITION";n[287]="YPOSITION";n[288]="FREEOFFSETS";n[289]="FREEBYTECOUNTS";n[290]="GRAYRESPONSEUNIT";n[291]="GRAYRESPONSECURVE";n[292]="T4OPTIONS";n[293]="T6OPTIONS";n[296]="RESOLUTIONUNIT";n[297]="PAGENUMBER";n[300]="COLORRESPONSEUNIT";n[301]="TRANSFERFUNCTION";
n[305]="SOFTWARE";n[306]="DATETIME";n[315]="ARTIST";n[316]="HOSTCOMPUTER";n[317]="PREDICTOR";n[318]="WHITEPOINT";n[319]="PRIMARYCHROMATICITIES";n[320]="COLORMAP";n[321]="HALFTONEHINTS";n[322]="TILEWIDTH";n[323]="TILELENGTH";n[324]="TILEOFFSETS";n[325]="TILEBYTECOUNTS";n[326]="BADFAXLINES";n[327]="CLEANFAXDATA";n[328]="CONSECUTIVEBADFAXLINES";n[330]="SUBIFD";n[332]="INKSET";n[333]="INKNAMES";n[334]="NUMBEROFINKS";n[336]="DOTRANGE";n[337]="TARGETPRINTER";n[338]="EXTRASAMPLES";n[339]="SAMPLEFORMAT";
n[340]="SMINSAMPLEVALUE";n[341]="SMAXSAMPLEVALUE";n[342]="TRANSFERRANGE";n[347]="JPEGTABLES";n[512]="JPEGPROC";n[513]="JPEGIFOFFSET";n[514]="JPEGIFBYTECOUNT";n[515]="JPEGRESTARTINTERVAL";n[517]="JPEGLOSSLESSPREDICTORS";n[518]="JPEGPOINTTRANSFORM";n[519]="JPEGQTABLES";n[520]="JPEGDCTABLES";n[521]="JPEGACTABLES";n[529]="YCBCRCOEFFICIENTS";n[530]="YCBCRSUBSAMPLING";n[531]="YCBCRPOSITIONING";n[532]="REFERENCEBLACKWHITE";n[700]="XMP";n[33550]="GEOPIXELSCALE";n[33922]="GEOTIEPOINTS";n[33432]="COPYRIGHT";
n[42112]="GDAL_METADATA";n[42113]="GDAL_NODATA";n[50844]="RPCCOEFFICIENT";n[34264]="GEOTRANSMATRIX";n[34735]="GEOKEYDIRECTORY";n[34736]="GEODOUBLEPARAMS";n[34737]="GEOASCIIPARAMS";n[34665]="EXIFIFD";n[34853]="GPSIFD";n[40965]="INTEROPERABILITYIFD";return n})(),D=(()=>{const n=M.slice();n[36864]="ExifVersion";n[40960]="FlashpixVersion";n[40961]="ColorSpace";n[42240]="Gamma";n[37121]="ComponentsConfiguration";n[37122]="CompressedBitsPerPixel";n[40962]="PixelXDimension";n[40963]="PixelYDimension";n[37500]=
"MakerNote";n[37510]="UserComment";n[40964]="RelatedSoundFile";n[36867]="DateTimeOriginal";n[36868]="DateTimeDigitized";n[36880]="OffsetTime";n[36881]="OffsetTimeOriginal";n[36882]="OffsetTimeDigitized";n[37520]="SubSecTime";n[37521]="SubSecTimeOriginal";n[37522]="SubSecTimeDigitized";n[37888]="Temperature";n[37889]="Humidity";n[37890]="Pressure";n[37891]="WaterDepth";n[37892]="Acceleration";n[37893]="CameraElevationAngle";n[42016]="ImageUniqueID";n[42032]="CameraOwnerName";n[42033]="BodySerialNumber";
n[42034]="LensSpecification";n[42035]="LensMake";n[42036]="LensModel";n[42037]="LensSerialNumber";n[33434]="ExposureTime";n[33437]="FNumber";n[34850]="ExposureProgram";n[34852]="SpectralSensitivity";n[34855]="PhotographicSensitivity";n[34856]="OECF";n[34864]="SensitivityType";n[34865]="StandardOutputSensitivity";n[34866]="RecommendedExposureIndex";n[34867]="ISOSpeed";n[34868]="ISOSpeedLatitudeyyy";n[34869]="ISOSpeedLatitudezzz";n[37377]="ShutterSpeedValue";n[37378]="ApertureValue";n[37379]="BrightnessValue";
n[37380]="ExposureBiasValue";n[37381]="MaxApertureValue";n[37382]="SubjectDistance";n[37383]="MeteringMode";n[37384]="LightSource";n[37385]="Flash";n[37386]="FocalLength";n[37396]="SubjectArea";n[41483]="FlashEnergy";n[41484]="SpatialFrequencyResponse";n[41486]="FocalPlaneXResolution";n[41487]="FocalPlaneYResolution";n[41488]="FocalPlaneResolutionUnit";n[41492]="SubjectLocation";n[41493]="ExposureIndex";n[41495]="SensingMethod";n[41728]="FileSource";n[41729]="SceneType";n[41730]="CFAPattern";n[41985]=
"CustomRendered";n[41986]="ExposureMode";n[41987]="WhiteBalance";n[41988]="DigitalZoomRatio";n[41989]="FocalLengthIn35mmFilm";n[41990]="SceneCaptureType";n[41991]="GainControl";n[41992]="Contrast";n[41993]="Saturation";n[41994]="Sharpness";n[41995]="DeviceSettingDescription";n[41996]="SubjectDistanceRange";return n})(),H=(()=>{const n=[];n[1024]="GTModelTypeGeoKey";n[1025]="GTRasterTypeGeoKey";n[1026]="GTCitationGeoKey";n[2048]="GeographicTypeGeoKey";n[2049]="GeogCitationGeoKey";n[2050]="GeogGeodeticDatumGeoKey";
n[2051]="GeogPrimeMeridianGeoKey";n[2052]="GeogLinearUnitsGeoKey";n[2053]="GeogLinearUnitSizeGeoKey";n[2054]="GeogAngularUnitsGeoKey";n[2055]="GeogAngularUnitSizeGeoKey";n[2056]="GeogEllipsoidGeoKey";n[2057]="GeogSemiMajorAxisGeoKey";n[2058]="GeogSemiMinorAxisGeoKey";n[2059]="GeogInvFlatteningGeoKey";n[2061]="GeogPrimeMeridianLongGeoKey";n[2060]="GeogAzimuthUnitsGeoKey";n[3072]="ProjectedCSTypeGeoKey";n[3073]="PCSCitationGeoKey";n[3074]="ProjectionGeoKey";n[3075]="ProjCoordTransGeoKey";n[3076]="ProjLinearUnitsGeoKey";
n[3077]="ProjLinearUnitSizeGeoKey";n[3078]="ProjStdParallel1GeoKey";n[3079]="ProjStdParallel2GeoKey";n[3080]="ProjNatOriginLongGeoKey";n[3081]="ProjNatOriginLatGeoKey";n[3082]="ProjFalseEastingGeoKey";n[3083]="ProjFalseNorthingGeoKey";n[3084]="ProjFalseOriginLongGeoKey";n[3085]="ProjFalseOriginLatGeoKey";n[3086]="ProjFalseOriginEastingGeoKey";n[3087]="ProjFalseOriginNorthingGeoKey";n[3088]="ProjCenterLongGeoKey";n[3090]="ProjCenterEastingGeoKey";n[3091]="ProjCenterNorthingGeoKey";n[3092]="ProjScaleAtNatOriginGeoKey";
n[3093]="ProjScaleAtCenterGeoKey";n[3094]="ProjAzimuthAngleGeoKey";n[3095]="ProjStraightVertPoleLongGeoKey";n[4096]="VerticalCSTypeGeoKey";n[4097]="VerticalCitationGeoKey";n[4098]="VerticalDatumGeoKey";n[4099]="VerticalUnitsGeoKey";return n})(),I=new Map;I.set("EXIFIFD",D);I.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:M,ifdTags:I,GEO_KEYS:H,getTagName:(n,R)=>{R=(R||M)[n];void 0===R&&(R="unknown"+String(n));return R}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(M){const D=new ArrayBuffer(4),H=new Uint8Array(D);(new Uint32Array(D))[0]=1;M.isPlatformLittleEndian=1===H[0];Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/Error ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ConvolutionFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsHistogramsFunction ./StretchFunction".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e){function p(F,g){return"rasters"===g[0]&&Array.isArray(F.rasters)?F.rasters:g.map(w=>F[w])}function y(F,g){const {rasterFunction:w,rasterFunctionArguments:u}=F;var C=F.outputPixelType?.toLowerCase();if(null==w||!K.has(w))throw new D("raster-function-helper",`unsupported raster function: ${w}`);var d=K.get(w);F=("function"===typeof d.ctor?d.ctor:d.ctor["default"]).fromJSON({...F,outputPixelType:C});({rasterArgumentNames:C}=F);d=[];const b=p(u,C),c="rasters"===
C[0],h=[];for(let q=0;q<b.length;q++){const z=b[q];let B;null==z||"string"===typeof z&&z.startsWith("$")?d.push(g?.raster):"string"===typeof z?g[z]&&d.push(g[z]):"number"!==typeof z&&"rasterFunction"in z&&(B=y(z,g),c||(F.functionArguments[C[q]]=B),d.push(B));c&&h.push(B??z)}c&&(F.functionArguments.rasters=h);g&&(F.sourceRasters=d,g=g.raster?.url)&&(F.mainPrimaryRasterId=g);return F}const K=new Map;K.set("Aspect",{desc:"Aspect Function",ctor:H,rasterArgumentNames:["raster"]});K.set("BandArithmetic",
{desc:"Band Arithmetic Function",ctor:I,rasterArgumentNames:["raster"]});K.set("Colormap",{desc:"Colormap Function",ctor:n,rasterArgumentNames:["raster"]});K.set("CompositeBand",{desc:"CompositeBand Function",ctor:R,rasterArgumentNames:["rasters"]});K.set("Convolution",{desc:"Convolution Function",ctor:P,rasterArgumentNames:["raster"]});K.set("ExtractBand",{desc:"ExtractBand Function",ctor:J,rasterArgumentNames:["raster"]});K.set("Local",{desc:"Local Function",ctor:L,rasterArgumentNames:["rasters"]});
K.set("Mask",{desc:"Mask Function",ctor:k,rasterArgumentNames:["raster"]});K.set("NDVI",{desc:"NDVI Function",ctor:l,rasterArgumentNames:["raster"]});K.set("Remap",{desc:"Remap Function",ctor:a,rasterArgumentNames:["raster"]});K.set("Slope",{desc:"Slope Function",ctor:f,rasterArgumentNames:["raster"]});K.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:m,rasterArgumentNames:["raster"]});K.set("Stretch",{desc:"Stretch Function",ctor:e,rasterArgumentNames:["raster"]});M.create=
function(F,g){if("rasterFunction"in F)return y(F,g??{});throw new D("raster-function-helper","unsupported raster function json.");};M.getRasterValues=p;M.getSupportedFunctions=function(){const F=new Set;K.forEach((g,w)=>F.add(w));return F};M.register=function(F,g,w=["raster"],u=""){K.set(F,{desc:u,ctor:g,rasterArgumentNames:w})};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="Aspect";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.isGCS=!1;return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){var m=this.sourceRasterInfos[0];this.isGCS=m.spatialReference.isGeographic;this.outputPixelType=this._getOutputPixelType("f32");m=m.clone();m.pixelType=this.outputPixelType;m.statistics=null;m.histograms=null;this.rasterInfo=m;return{success:!0}};
f._processPixels=function(m){const e=m.pixelBlocks?.[0];if(H.isNone(e))return null;({extent:m}=m);return k.aspect(e,{resolution:m?{x:m.width/e.width,y:m.height/e.height}:{x:1,y:1}})};return a}(L);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],
n.prototype,"isGCS",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.AspectFunction")],n)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/Error ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(M,D,H,I,n,
R,P,J,L){var k;H=k=function(l){function a(){return l.apply(this,arguments)||this}M._inheritsLoose(a,l);a.prototype.clone=function(){return new k({raster:this.raster})};return a}(L);return H=k=D.__decorate([J.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],H)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(M,D,H,I,n,R,P){H=function(J){function L(){var k=J.apply(this,arguments)||this;k.raster=void 0;return k}M._inheritsLoose(L,J);return L}(H.JSONSupport);D.__decorate([I.property({json:{write:!0}})],H.prototype,"raster",void 0);return H=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],H)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/subclass".split(" "),
function(M,D,H,I,n,R,P,J){H=function(L){function k(){var a=L.apply(this,arguments)||this;a.functionArguments=null;a.readingBufferSize=0;return a}M._inheritsLoose(k,L);var l=k.prototype;l.bind=function(a,f=!1){const m=this._getRasterValues();for(let p=0;p<m.length;p++){var e=m[p];if(e&&"object"===typeof e&&"bind"in e&&(!e.rasterInfo||f)&&(e=e.bind(a,f),!e.success))return e}return!this.rasterInfo||f?(this.sourceRasterInfos=this._getSourceRasterInfos(a),this._bindSourceRasters()):{success:!0}};l.process=
function(a){const f=this._getRasterValues().map(m=>this._readRasterValue(m,a));return this._processPixels({...a,pixelBlocks:f})};l.getPrimaryRasters=function(){const a=[],f=[];this._getPrimaryRasters(this,a,f);return{rasters:a,rasterIds:f}};l._getOutputPixelType=function(a){return"unknown"===this.outputPixelType?a:this.outputPixelType??a};l._getRasterValues=function(){const {rasterArgumentNames:a}=this;return"rasters"===a[0]&&Array.isArray(this.functionArguments.rasters)?this.functionArguments.rasters:
a.map(f=>this.functionArguments[f])};l._getSourceRasterInfos=function(a){const f=this._getRasterValues(),{rasterInfos:m,rasterIds:e}=a;return f.map(p=>p&&"object"===typeof p&&"bind"in p&&p.rasterInfo?p.rasterInfo:"string"===typeof p&&e.includes(p)?m[e.indexOf(p)]:m[0])};l._getPrimaryRasterId=function(a){return a?.url};l._getPrimaryRasters=function(a,f=[],m=[]){for(let p=0;p<a.sourceRasters.length;p++){var e=a.sourceRasters[p];if("number"!==typeof e)if("bind"in e)this._getPrimaryRasters(e,f,m);else{const y=
this._getPrimaryRasterId(e);null==y||m.includes(y)||(this.mainPrimaryRasterId===y?(f.unshift(e),m.unshift(y)):(f.push(e),m.push(y)))}}};l._readRasterValue=function(a,f){var {primaryPixelBlocks:m}=f;if(I.isNone(a)||"$$"===a)return a=m[0],I.isNone(a)?null:a.clone();if("string"===typeof a)return a=f.primaryRasterIds.indexOf(a),-1===a?null:m[a];if("number"===typeof a){m=m[0];if(I.isNone(m))return null;const e=new Float32Array(m.width*m.height);e.fill(a);a=m.clone();a.pixels=a.pixels.map(()=>e);return a}return a.process(f)};
return k}(H.JSONSupport);D.__decorate([n.property({json:{write:!0}})],H.prototype,"functionName",void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"functionArguments",void 0);D.__decorate([n.property()],H.prototype,"rasterArgumentNames",void 0);D.__decorate([n.property({json:{write:!0}}),P.cast(L=>L?.toLowerCase())],H.prototype,"outputPixelType",void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"mainPrimaryRasterId",void 0);D.__decorate([n.property()],H.prototype,"sourceRasters",
void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"sourceRasterInfos",void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"rasterInfo",void 0);D.__decorate([n.property({json:{write:!0}})],H.prototype,"readingBufferSize",void 0);return H=D.__decorate([J.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],H)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","./pixelUtils"],function(M,D,
H,I){function n(R){let {altitude:P,azimuth:J}=R;const {hillshadeType:L,pixelSizePower:k=1,pixelSizeFactor:l=1,scalingType:a,isGCS:f,resolution:m}=R;var e="multi-directional"===L?2*R.zFactor:R.zFactor;const {x:p,y}=m;R=e/(8*p);var K=e/(8*y);f&&.001<e&&(R/=111E3,K/=111E3);"adjusted"===a&&(f?(R=111E3*p,K=111E3*y,R=(e+R**k*l)/(8*R),K=(e+K**k*l)/(8*K)):(R=(e+p**k*l)/(8*p),K=(e+y**k*l)/(8*y)));var F=(90-P)*Math.PI/180;e=Math.cos(F);let g=(360-J+90)*Math.PI/180,w=Math.sin(F)*Math.cos(g);F=Math.sin(F)*Math.sin(g);
const u=[315,270,225,360,180,0],C=[60,60,60,60,60,90];var d=new Float32Array([3,5,3,2,1,4]);const b=d.reduce((B,r)=>B+r);d=d.map(B=>B/b);const c="multi-directional"===L?u.length:1,h=new Float32Array(6),q=new Float32Array(6),z=new Float32Array(6);if("multi-directional"===L)for(let B=0;B<c;B++)P=C[B],J=u[B],F=(90-P)*Math.PI/180,e=Math.cos(F),g=(360-J+90)*Math.PI/180,w=Math.sin(F)*Math.cos(g),F=Math.sin(F)*Math.sin(g),h[B]=e,q[B]=w,z[B]=F;else h.fill(e),q.fill(w),z.fill(F);return{resolution:m,factor:[R,
K],sinZcosA:w,sinZsinA:F,cosZ:e,sinZcosAs:q,sinZsinAs:z,cosZs:h,weights:d,hillshadeType:["traditional","multi-directional"].indexOf(L)}}M.aspect=function(R,P={}){if(!I.isValidPixelBlock(R))return R;const {width:J,height:L,mask:k}=R;var l=R.pixels[0];const a=new Uint8Array(J*L);D.isSome(k)&&a.set(k);const f=new Float32Array(J*L);var {resolution:m}=P;P=m?1/m.x:1;m=m?1/m.y:1;let e;let p,y,K,F;const g=D.isSome(k);for(let d=1;d<L-1;d++){const b=d*J;for(let c=1;c<J-1;c++)if(k&&!k[b+c])f[b+c]=0;else{var w=
0;if(g&&(w=k[b-J+c-1]+k[b-J+c]+k[b-J+c+1]+k[b+c-1]+k[b+c+1]+k[b+J+c-1]+k[b+J+c]+k[b+J+c+1],7>w)){f[b+c]=0;a[b+c]=0;continue}if(k&&7===w){w=k[b-J+c-1]?l[b-J+c-1]:l[b+c];var u=k[b-J+c]?l[b-J+c]:l[b+c];e=k[b-J+c+1]?l[b-J+c+1]:l[b+c];var C=k[b+c-1]?l[b+c-1]:l[b+c];p=k[b+c+1]?l[b+c+1]:l[b+c];y=k[b+J+c-1]?l[b+J+c-1]:l[b+c];K=k[b+J+c]?l[b+J+c]:l[b+c];F=k[b+J+c+1]?l[b+J+c+1]:l[b+c]}else w=l[b-J+c-1],u=l[b-J+c],e=l[b-J+c+1],C=l[b+c-1],p=l[b+c+1],y=l[b+J+c-1],K=l[b+J+c],F=l[b+J+c+1];C=(e+p+p+F-(w+C+C+y))*P;
w=(y+K+K+F-(w+u+u+e))*m;u=-1;if(0!==C||0!==w)u=90-57.29578*Math.atan2(w,-C),0>u&&(u+=360),360===u?u=0:360<u&&(u%=360);f[b+c]=u}}for(l=0;l<L;l++)f[l*J]=f[l*J+1],f[(l+1)*J-1]=f[(l+1)*J-2];for(l=1;l<J-1;l++)f[l]=f[l+J],f[l+(L-1)*J]=f[l+(L-2)*J];return new H({width:J,height:L,pixels:[f],mask:k?a:null,pixelType:"f32",validPixelCount:R.validPixelCount,statistics:[{minValue:0,maxValue:360}]})};M.calculateHillshadeParams=n;M.hillshade=function(R,P){if(!I.isValidPixelBlock(R))return R;const {width:J,height:L,
mask:k}=R,l=new Uint8Array(J*L);var a=1;if(D.isSome(k)){for(var f=0;f<k.length;f++)if(k[f]){a=k[f];break}l.set(k)}const {factor:m,sinZcosA:e,sinZsinA:p,cosZ:y,sinZcosAs:K,sinZsinAs:F,cosZs:g,weights:w}=n(P),[u,C]=m;({hillshadeType:f}=P);const d=R.pixels[0];P=new Uint8Array(J*L);let b;const c=D.isSome(k);for(let E=1;E<L-1;E++){const t=E*J;for(let A=1;A<J-1;A++)if(k&&!k[t+A])P[t+A]=0;else{var h=8;if(c&&(h=(k[t-J+A-1]+k[t-J+A]+k[t-J+A+1]+k[t+A-1]+k[t+A+1]+k[t+J+A-1]+k[t+J+A]+k[t+J+A+1])/a,7>h)){P[t+
A]=0;l[t+A]=0;continue}if(k&&7===h){var q=k[t-J+A-1]?d[t-J+A-1]:d[t+A];var z=k[t-J+A]?d[t-J+A]:d[t+A];var B=k[t-J+A+1]?d[t-J+A+1]:d[t+A];h=k[t+A-1]?d[t+A-1]:d[t+A];b=k[t+A+1]?d[t+A+1]:d[t+A];var r=k[t+J+A-1]?d[t+J+A-1]:d[t+A];var x=k[t+J+A]?d[t+J+A]:d[t+A];var v=k[t+J+A+1]?d[t+J+A+1]:d[t+A]}else q=d[t-J+A-1],z=d[t-J+A],B=d[t-J+A+1],h=d[t+A-1],b=d[t+A+1],r=d[t+J+A-1],x=d[t+J+A],v=d[t+J+A+1];h=(B+b+b+v-(q+h+h+r))*u;q=(r+x+x+v-(q+z+z+B))*C;z=Math.sqrt(1+h*h+q*q);B=0;if("traditional"===f)h=255*(y+p*q-
e*h)/z,0>h&&(h=0),B=h;else for(r=F.length,x=0;x<r;x++)v=255*(g[x]+F[x]*q-K[x]*h)/z,0>v&&(v=0),B+=v*w[x];P[t+A]=B&255}}for(a=0;a<L;a++)P[a*J]=P[a*J+1],P[(a+1)*J-1]=P[(a+1)*J-2];for(a=1;a<J-1;a++)P[a]=P[a+J],P[a+(L-1)*J]=P[a+(L-2)*J];return new H({width:J,height:L,pixels:[P],mask:k?l:null,pixelType:"u8",validPixelCount:R.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};M.slope=function(R,P){if(!I.isValidPixelBlock(R))return R;var J=P.zFactor,L=P.pixelSizePower??1,k=P.pixelSizeFactor??1;const l=
P.slopeType;var a=P.isGCS;const {width:f,height:m,mask:e}=R;var p=R.pixels[0];const y=new Uint8Array(f*m);let K=1;if(D.isSome(e)){for(var F=0;F<e.length;F++)if(e[F]){K=e[F];break}y.set(e)}F=new Float32Array(f*m);const {x:g,y:w}=P.resolution;P=J/(8*g);var u=J/(8*w);a&&1E-4>Math.abs(J-1)&&(P/=111E3,u/=111E3);"adjusted"===l&&(a?(P=111E3*g,u=111E3*w,P=(J+P**L*k)/(8*P),u=(J+u**L*k)/(8*u)):(P=(J+g**L*k)/(8*g),u=(J+w**L*k)/(8*w)));let C,d;let b,c,h,q;J=D.isSome(e);for(L=1;L<m-1;L++)for(k=L*f,a=1;a<f-1;a++)if(e&&
!e[k+a])F[k+a]=0;else{var z=0;if(J&&(z=(e[k-f+a-1]+e[k-f+a]+e[k-f+a+1]+e[k+a-1]+e[k+a+1]+e[k+f+a-1]+e[k+f+a]+e[k+f+a+1])/K,7>z)){F[k+a]=0;y[k+a]=0;continue}if(e&&7===z){z=e[k-f+a-1]?p[k-f+a-1]:p[k+a];C=e[k-f+a]?p[k-f+a]:p[k+a];d=e[k-f+a+1]?p[k-f+a+1]:p[k+a];var B=e[k+a-1]?p[k+a-1]:p[k+a];b=e[k+a+1]?p[k+a+1]:p[k+a];c=e[k+f+a-1]?p[k+f+a-1]:p[k+a];h=e[k+f+a]?p[k+f+a]:p[k+a];q=e[k+f+a+1]?p[k+f+a+1]:p[k+a]}else z=p[k-f+a-1],C=p[k-f+a],d=p[k-f+a+1],B=p[k+a-1],b=p[k+a+1],c=p[k+f+a-1],h=p[k+f+a],q=p[k+f+
a+1];B=(d+b+b+q-(z+B+B+c))*P;z=(c+h+h+q-(z+C+C+d))*u;z=Math.sqrt(B*B+z*z);F[k+a]="percent-rise"===l?100*z:57.2957795*Math.atan(z)}for(p=0;p<m;p++)F[p*f]=F[p*f+1],F[(p+1)*f-1]=F[(p+1)*f-2];for(p=1;p<f-1;p++)F[p]=F[p+f],F[p+(m-1)*f]=F[p+(m-2)*f];return new H({width:f,height:m,pixels:[F],mask:e?y:null,pixelType:"f32",validPixelCount:R.validPixelCount,statistics:[{minValue:0,maxValue:"percent-rise"===l?100:360}]})};M.tintHillshade=function(R,P,J,L){if(I.isValidPixelBlock(R)&&I.isValidPixelBlock(P)){var {min:k,
max:l}=L;L=R.pixels[0];var {pixels:a,mask:f}=P;P=a[0];var m=255.00001/(l-k),e=new Uint8ClampedArray(P.length),p=new Uint8ClampedArray(P.length),y=new Uint8ClampedArray(P.length),K=J.length-1;for(let w=0;w<P.length;w++){if(f&&0===f[w])continue;var F=Math.floor((P[w]-k)*m);const [u,C]=J[0>F?0:F>K?K:F];var g=L[w];F=g*C;const d=F*(1-Math.abs(u%2-1));g-=F;switch(Math.floor(u)){case 0:e[w]=F+g;p[w]=d+g;y[w]=g;break;case 1:e[w]=d+g;p[w]=F+g;y[w]=g;break;case 2:e[w]=g;p[w]=F+g;y[w]=d+g;break;case 3:e[w]=
g;p[w]=d+g;y[w]=F+g;break;case 4:e[w]=d+g;p[w]=g;y[w]=F+g;break;case 5:case 6:e[w]=F+g,p[w]=g,y[w]=d+g}}R.pixels=[e,p,y];R.updateStatistics()}};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="BandArithmetic";m.functionArguments=null;m.rasterArgumentNames=["raster"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const m=this.sourceRasterInfos[0],e=m.clone();e.pixelType=this.outputPixelType;e.statistics=null;e.histograms=null;e.bandCount="sultan"===this.functionArguments.method?m.bandCount:1;this.rasterInfo=
e;return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m))return m;const {method:e,bandIndexes:p}=this.functionArguments,y=p.split(" ").map(K=>parseFloat(K));return L.calculateBandIndex(m,{method:e,bandIndexes:y,equation:p})};return a}(k);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],
n.prototype,"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],n)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J,L){var k;n=k=function(l){function a(){var f=l.apply(this,arguments)||this;f.method="custom";return f}M._inheritsLoose(a,l);a.prototype.clone=function(){return new k({method:this.method,bandIndexes:this.bandIndexes,raster:H.clone(this.raster)})};return a}(L);D.__decorate([I.property({json:{type:String,write:!0}})],n.prototype,"bandIndexes",void 0);D.__decorate([R.enumeration(J.bandIndexMethodMap)],n.prototype,"method",void 0);return n=k=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],
n)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define("exports ../../../core/jsonMap ../../../core/maybe ../PixelBlock ./customBandIndexUtils ./pixelUtils".split(" "),function(M,D,H,I,n,R){function P(C,d,b){const c=b.length,h=new Float32Array(c);for(let q=0;q<c;q++)if(null==C||C[q]){const z=d[q],B=b[q],r=z+B;r&&(h[q]=(z-B)/r)}return[h]}function J(C,d,b){const c=b.length,h=new Float32Array(c);for(let q=0;q<c;q++)if(null==C||C[q]){const z=d[q],B=b[q];B&&(h[q]=z/B)}return[h]}function L(C,
d,b){const c=d.length,h=new Float32Array(c);for(let q=0;q<c;q++)if(null==C||C[q]){const z=d[q],B=b[q];B&&(h[q]=z/B-1)}return[h]}function k(C,d,b,c){const h=b.length,q=new Float32Array(h);for(let z=0;z<h;z++)if(null==C||C[z]){const B=b[z],r=d[z],x=r+B+c;x&&(q[z]=(r-B)/x*(1+c))}return[q]}function l(C,d,b,c,h,q){const z=b.length,B=new Float32Array(z);q=-h*c+q*(1+c*c);for(let r=0;r<z;r++)if(null==C||C[r]){const x=b[r],v=d[r],E=h*v+x+q;E&&(B[r]=c*(v-c*x-h)/E)}return[B]}function a(C,d,b){const c=b.length,
h=new Float32Array(c);for(let q=0;q<c;q++)if(null==C||C[q]){const z=d[q];h[q]=.5*(2*(z+1)-Math.sqrt((2*z+1)**2-8*(z-b[q])))}return[h]}function f(C,d,b){const c=b.length,h=new Float32Array(c);for(let z=0;z<c;z++)if(null==C||C[z]){const B=b[z];var q=d[z];1!==B&&(q=(2*(q*q-B*B)+1.5*q+.5*B)/(q+B+.5),h[z]=q*(1-.25*q)-(B-.125)/(1-B))}return[h]}function m(C,d,b,c,h){const q=b.length,z=new Float32Array(q),B=Math.sqrt(1+c*c);for(let r=0;r<q;r++)if(null==C||C[r])z[r]=(d[r]-c*b[r]-h)/B;return[z]}function e(C,
d){const [b,c,h,q,z,B]=d;d=b.length;const r=new Float32Array(d);for(let x=0;x<d;x++)if(null==C||C[x])r[x]=-.2848*b[x]-.2435*c[x]-.5436*h[x]+.7243*q[x]+.084*z[x]-1.18*B[x];return[r]}function p(C,d){const [b,,c,h,q,z]=d;d=b.length;const B=new Float32Array(d),r=new Float32Array(d),x=new Float32Array(d);for(let v=0;v<d;v++)if(null==C||C[v])B[v]=z[v]?q[v]/z[v]*100:0,r[v]=b[v]?q[v]/b[v]*100:0,x[v]=h[v]?c[v]/h[v]*(q[v]/h[v])*100:0;return[B,r,x]}function y(C,d){const [b,c,h]=d;d=b.length;const q=new Float32Array(d);
for(let z=0;z<d;z++)if(null==C||C[z])for(z=0;z<d;z++){const B=b[z],r=c[z],x=r+B-h[z];x&&(q[z]=(r-B)/x)}return[q]}function K(C,d){const [b,c,h]=d;d=b.length;const q=new Float32Array(d);for(let z=0;z<d;z++)if(null==C||C[z])for(z=0;z<d;z++){const B=b[z],r=c[z],x=h[z];q[z]=1.5*(1.2*(B-x)-2.5*(r-x))*Math.sqrt((2*B+1)**2-6*B-5*Math.sqrt(r)-.5)}return[q]}function F(C,d){const [b,c,h]=d;d=b.length;const q=new Float32Array(d);for(let z=0;z<d;z++)if(null==C||C[z])for(z=0;z<d;z++){const B=b[z];q[z]=100*(B-c[z])-
10*(B-h[z])}return[q]}function g(C,d){const [b,c,h]=d;d=b.length;const q=new Float32Array(d);for(let z=0;z<d;z++)if(null==C||C[z])for(z=0;z<d;z++){const B=b[z],r=c[z],x=B+6*r-7.5*h[z]+1;x&&(q[z]=2.5*(B-r)/x)}return[q]}function w(C,d,b=.5){const [c,h,q]=d;d=h.length;const z=new Float32Array(d);for(let B=0;B<d;B++)if(null==C||C[B])for(B=0;B<d;B++){const r=c[B],x=h[B],v=q[B],E=r+b*x+(1-b)*v;E&&(z[B]=(r-b*x-(1-b)*v)/E)}return[z]}function u(C,d,b){const c=b.length,h=new Float32Array(c);for(let q=0;q<c;q++)if(null==
C||C[q])for(q=0;q<c;q++){const z=(.1-d[q])**2+(.06-b[q])**2;z&&(h[q]=1/z)}return[h]}D=new D.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});M.bandIndexMethodMap=D;M.calculateBandIndex=function(C,
d){if(!R.isValidPixelBlock(C))return C;const {equation:b,method:c}=d;d=d.bandIndexes.map(B=>B-1);const {pixels:h,mask:q}=C;switch(c){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":d=P(q,h[d[0]],h[d[1]]);break;case "ndwi":d=P(q,h[d[1]],h[d[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":d=J(q,h[d[0]],h[d[1]]);break;case "ci-g":case "ci-re":d=L(q,h[d[0]],h[d[1]]);break;case "savi":d=k(q,h[d[0]],h[d[1]],
d[2]+1);break;case "tsavi":d=l(q,h[d[0]],h[d[1]],d[2]+1,d[3]+1,d[4]+1);break;case "msavi":d=a(q,h[d[0]],h[d[1]]);break;case "gemi":d=f(q,h[d[0]],h[d[1]]);break;case "pvi":d=m(q,h[d[0]],h[d[1]],d[2]+1,d[3]+1);break;case "gvitm":d=e(q,[h[d[0]],h[d[1]],h[d[2]],h[d[3]],h[d[4]],h[d[5]]]);break;case "sultan":d=p(q,[h[d[0]],h[d[1]],h[d[2]],h[d[3]],h[d[4]],h[d[5]]]);break;case "vari":d=y(q,[h[d[0]],h[d[1]],h[d[2]]]);break;case "mtvi2":d=K(q,[h[d[0]],h[d[1]],h[d[2]]]);break;case "rtvi-core":d=F(q,[h[d[0]],
h[d[1]],h[d[2]]]);break;case "evi":d=g(q,[h[d[0]],h[d[1]],h[d[2]]]);break;case "wndwi":d=w(q,[h[d[0]],h[d[1]],h[d[2]]],d[3]??.5);break;case "bai":d=u(q,h[d[0]],h[d[1]]);break;case "custom":d=n.calculateCustomBandIndex(q,h,b);break;default:return C}const z=H.isSome(q)?new Uint8Array(q.length):null;H.isSome(q)&&H.isSome(z)&&z.set(q);C=new I({width:C.width,height:C.height,pixelType:"f32",pixels:d,mask:z});C.updateStatistics();return C};M.calculateNDVI=function(C,d,b,c){const {mask:h,pixels:q,width:z,
height:B}=C;C=q[b];d=q[d];b=d.length;const r=c?new Uint8Array(b):new Float32Array(b),x=c?100:1,v=c?100:0;for(let E=0;E<b;E++)if(null==h||h[E]){const t=C[E],A=d[E],O=t+A;O&&(r[E]=(t-A)/O*x+v)}c=new I({width:z,height:B,mask:h,pixelType:c?"u8":"f32",pixels:[r]});c.updateStatistics();return c};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports","../../../core/has"],function(M,
D){const H=new Set("+-*/()".split(""));M.calculateCustomBandIndex=function(I,n,R){R=R.replace(/ /g,"");R.startsWith("-")&&(R="0"+R);R.startsWith("+")&&(R=R.slice(1,R.length));R=R.split("");var P=[],J=[],L="";for(let f=0;f<R.length;f++){const m=R[f];H.has(m)?(""!==L&&J.push(parseFloat(L)),P.push(m),L=""):"b"===m.toLowerCase()?(f++,L=m.concat(R[f]),J.push(n[parseInt(L[1],10)-1]),L=""):(L=L.concat(m),f===R.length-1&&J.push(parseFloat(L)))}let {ops:k,nums:l}={ops:P,nums:J};if(0===k.length){I=1===l.length?
l[0]:n[0];if(I instanceof Float32Array)return[I];var a=new Float32Array(n[0].length);"number"===typeof I?a.fill(I):a.set(I);return[a]}for(;0<k.length;){a=k;if(1===a.length)a={opIndex:0,numIndex:0};else{P=R=0;for(n=0;n<a.length;n++)if("("===a[n])R=n;else if(")"===a[n]){P=n;break}J=0===P?a:a.slice(R+1,P);n=-1;for(L=0;L<J.length;L++)if("*"===J[L]||"/"===J[L]){n=L;break}if(!(-1<n))for(L=0;L<J.length;L++)if("+"===J[L]||"-"===J[L]){n=L;break}0<P&&(n+=R+1);R=0;for(P=0;P<n;P++)"("===a[P]&&R++;a={opIndex:n,
numIndex:n-R}}const {numIndex:f,opIndex:m}=a;P=void 0;a=I;L=k[m];n=l[f];R=l[f+1];if("number"===typeof n&&"number"===typeof R)a=n+R;else{"number"===typeof n?(P=R.length,J=n,n=new Float32Array(P),n.fill(J)):(P=n.length,R.constructor===Number&&(J=R,R=new Float32Array(P),R.fill(J)));J=new Float32Array(P);switch(L){case "+":for(L=0;L<P;L++)if(null==a||a[L])J[L]=n[L]+R[L];break;case "-":for(L=0;L<P;L++)if(null==a||a[L])J[L]=n[L]-R[L];break;case "*":for(L=0;L<P;L++)if(null==a||a[L])J[L]=n[L]*R[L];break;
case "/":for(L=0;L<P;L++)(null==a||a[L])&&R[L]&&(J[L]=n[L]/R[L]);break;case "(":case ")":throw"encountered error with custom band index equation";}a=J}if(1===k.length)break;else{n=k;n.splice(m,1);P=R=0;do{P=R=0;for(J=0;J<n.length;J++)if("("===n[J])R=J;else if(")"===n[J]){P=J;break}P===R+1&&n.splice(R,2)}while(P===R+1);k=n;l.splice(f,2,a)}}return[a]};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ../../../renderers/support/colorRampUtils".split(" "),
function(M,D,H,I,n,R,P,J,L){I=function(k){function l(){var f=k.apply(this,arguments)||this;f.functionName="Colormap";f.functionArguments=null;f.rasterArgumentNames=["raster"];return f}M._inheritsLoose(l,k);var a=l.prototype;a._bindSourceRasters=function(){var f=this.sourceRasterInfos[0];if(1<f.bandCount)return{success:!1,error:"colormap-function: source data must be single band"};let {colormap:m,colorRamp:e}=this.functionArguments;m?.length||e&&(m=L.convertColorRampToColors(e,256,!0));if(!m?.length)return{success:!1,
error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");f=f.clone();f.pixelType=this.outputPixelType;f.colormap=m;this.rasterInfo=f;return{success:!0}};a._processPixels=function(f){return f.pixelBlocks?.[0]};return l}(P);D.__decorate([H.property({json:{write:!0,name:"rasterFunction"}})],I.prototype,"functionName",void 0);D.__decorate([H.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],I.prototype,"functionArguments",void 0);D.__decorate([H.property()],
I.prototype,"rasterArgumentNames",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"indexedColormap",void 0);return I=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],I)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../rest/support/colorRamps".split(" "),
function(M,D,H,I,n,R,P,J,L){var k;n=k=function(l){function a(){return l.apply(this,arguments)||this}M._inheritsLoose(a,l);var f=a.prototype;f.readColorRamp=function(m){return L.fromJSON(m)};f.clone=function(){return new k({colormap:H.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})};return a}(J);D.__decorate([I.property({type:[[Number]],json:{write:!0}})],n.prototype,"colormap",void 0);D.__decorate([I.property({type:String,json:{write:!0}})],
n.prototype,"colormapName",void 0);D.__decorate([I.property({types:L.types,json:{write:!0}})],n.prototype,"colorRamp",void 0);D.__decorate([R.reader("colorRamp")],n.prototype,"readColorRamp",null);D.__decorate([I.property({type:String,json:{write:!0}})],n.prototype,"colorRampName",void 0);return n=k=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],n)})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="CompositeBand";m.functionArguments=null;m.rasterArgumentNames=["rasters"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){const {sourceRasterInfos:m}=this;var e=m[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);e=e.clone();e.attributeTable=null;e.colormap=null;e.pixelType=this.outputPixelType;e.bandCount=m.map(({bandCount:p})=>p).reduce((p,y)=>
p+y);if(m.every(({statistics:p})=>H.isSome(p)&&p.length)){const p=[];m.forEach(({statistics:y})=>H.isSome(y)&&p.push(...y));e.statistics=p}if(m.every(({histograms:p})=>H.isSome(p)&&p.length)){const p=[];m.forEach(({histograms:y})=>H.isSome(y)&&p.push(...y));e.histograms=p}this.rasterInfo=e;return{success:!0}};f._processPixels=function(m){({pixelBlocks:m}=m);return!m||H.isNone(m?.[0])?null:k.compositeBands(m)};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,
"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],n)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J){var L;n=L=function(k){function l(){return k.apply(this,arguments)||this}M._inheritsLoose(l,k);var a=l.prototype;a.writeRasters=function(f,m){m.rasters=f.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())};a.clone=function(){return new L({rasters:H.clone(this.rasters)})};return l}(J);D.__decorate([I.property({json:{write:!0}})],n.prototype,"rasters",void 0);D.__decorate([P.writer("rasters")],n.prototype,"writeRasters",null);return n=L=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],
n)})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||
this;m.functionName="Convolution";m.rasterArgumentNames=["raster"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){const {kernelType:m,rows:e,cols:p,kernel:y}=this.functionArguments;if(!k.convolutionKernels.has(m))return{success:!1,error:`convolution-function: the specified kernel type is not supported ${m}`};if(m!==k.ConvolutionKernel.None&&e*p!==y.length)return{success:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};
var K=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(K.pixelType);K=K.clone();K.pixelType=this.outputPixelType;const F=[k.ConvolutionKernel.None,k.ConvolutionKernel.Sharpen,k.ConvolutionKernel.Sharpen2,k.ConvolutionKernel.Sharpening3x3,k.ConvolutionKernel.Sharpening5x5];"u8"===this.outputPixelType||F.includes(m)||(K.statistics=null,K.histograms=null);this.rasterInfo=K;return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m)||this.functionArguments.kernelType===
k.ConvolutionKernel.None)return m;let {kernel:e,rows:p,cols:y}=this.functionArguments;const K=e.reduce((F,g)=>F+g);0!==K&&1!==K&&(e=e.map(F=>F/K));return k.convolute(m,{kernel:e,rows:p,cols:y,outputPixelType:this.outputPixelType})};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,
"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],n)})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./convolutionUtils".split(" "),function(M,
D,H,I,n,R,P,J){var L;n=L=function(k){function l(){var a=k.apply(this,arguments)||this;a.rows=3;a.cols=3;a.kernel=[0,0,0,0,1,0,0,0,0];return a}M._inheritsLoose(l,k);l.prototype.clone=function(){return new L({cols:this.cols,rows:this.rows,kernel:[...this.kernel],kernelType:this.kernelType,raster:H.clone(this.raster)})};M._createClass(l,[{key:"kernelType",set:function(a){this._set("kernelType",a);const f=J.convolutionKernels.get(a);f&&a!==J.ConvolutionKernel.UserDefined&&a!==J.ConvolutionKernel.None&&
(a=Math.sqrt(f.length),this._set("kernel",f),this._set("cols",a),this._set("rows",a))}}]);return l}(P);D.__decorate([I.property({json:{type:Number,write:!0}})],n.prototype,"rows",void 0);D.__decorate([I.property({json:{type:Number,write:!0}})],n.prototype,"cols",void 0);D.__decorate([I.property({json:{name:"type",type:Number,write:!0}})],n.prototype,"kernelType",null);D.__decorate([I.property({json:{type:[Number],write:!0}})],n.prototype,"kernel",void 0);return n=L=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],
n)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock"],function(M,D){function H(L){const k=Math.sqrt(L.length),l=L.slice(0,k),a=[1];for(let f=1;f<k;f++){let m=null;for(let e=0;e<k;e++){const p=L[e+f*k],y=L[e];if(null==m)if(0===y){if(p)return{separable:!1,row:null,col:null}}else m=p/y;else if(p/y!==m)return{separable:!1,row:null,col:null}}if(null==m)return{separable:!1,row:null,col:null};a.push(m)}return{separable:!0,row:l,col:a}}function I(L,k,l,
a,f,m,e){const p=new Float32Array(k*l),y=m.length,K=e?0:a,F=e?a:0;e=e?1:k;for(let g=K;g<l-K;g++){const w=g*k;for(let u=F;u<k-F;u++){if(f&&!f[w+u])continue;let C=0;for(let d=0;d<y;d++)C+=L[w+u+(d-a)*e]*m[d];p[w+u]=C}}return p}function n(L,k,l=!0){const {pixels:a,width:f,height:m,pixelType:e,mask:p}=L;L=a.length;const y=[],{kernel:K,rows:F,cols:g}=k;for(k=0;k<L;k++){var w=a[k],u=f,C=m,d=F,b=g,c=p,h=K;const q=new Float32Array(u*C),z=Math.floor(d/2),B=Math.floor(b/2);for(let r=z;r<C-z;r++){const x=r*
u;for(let v=B;v<u-B;v++){if(c&&!c[x+v])continue;let E=0;for(let t=0;t<d;t++)for(let A=0;A<b;A++)E+=w[x+v+(t-z)*u+A-B]*h[t*b+A];q[x+v]=E}}w=q;l&&R(w,f,m,F,g);y.push(w)}return new D({width:f,height:m,pixelType:e,pixels:y,mask:p})}function R(L,k,l,a,f){a=Math.floor(a/2);for(var m=0;m<a;m++)for(var e=0;e<k;e++)L[m*k+e]=L[(f-1-m)*k+e],L[(l-1-m)*k+e]=L[(l-f+m)*k+e];a=Math.floor(f/2);for(m=0;m<l;m++){e=m*k;for(let p=0;p<a;p++)L[e+p]=L[e+f-1-p],L[e+k-p-1]=L[e+k+p-f]}}function P(L,k,l,a=!0){const {pixels:f,
width:m,height:e,pixelType:p,mask:y}=L;L=f.length;const K=[],F=k.length,g=l.length,w=Math.floor(F/2),u=Math.floor(g/2);for(let C=0;C<L;C++){let d=I(f[C],m,e,w,y,k,!0);d=I(d,m,e,u,y,l,!1);a&&R(d,m,e,F,g);K.push(d)}return new D({width:m,height:e,pixelType:p,pixels:K,mask:y})}M.ConvolutionKernel=void 0;(function(L){L[L.UserDefined=-1]="UserDefined";L[L.LineDetectionHorizontal=0]="LineDetectionHorizontal";L[L.LineDetectionVertical=1]="LineDetectionVertical";L[L.LineDetectionLeftDiagonal=2]="LineDetectionLeftDiagonal";
L[L.LineDetectionRightDiagonal=3]="LineDetectionRightDiagonal";L[L.GradientNorth=4]="GradientNorth";L[L.GradientWest=5]="GradientWest";L[L.GradientEast=6]="GradientEast";L[L.GradientSouth=7]="GradientSouth";L[L.GradientNorthEast=8]="GradientNorthEast";L[L.GradientNorthWest=9]="GradientNorthWest";L[L.SmoothArithmeticMean=10]="SmoothArithmeticMean";L[L.Smoothing3x3=11]="Smoothing3x3";L[L.Smoothing5x5=12]="Smoothing5x5";L[L.Sharpening3x3=13]="Sharpening3x3";L[L.Sharpening5x5=14]="Sharpening5x5";L[L.Laplacian3x3=
15]="Laplacian3x3";L[L.Laplacian5x5=16]="Laplacian5x5";L[L.SobelHorizontal=17]="SobelHorizontal";L[L.SobelVertical=18]="SobelVertical";L[L.Sharpen=19]="Sharpen";L[L.Sharpen2=20]="Sharpen2";L[L.PointSpread=21]="PointSpread";L[L.None=255]="None"})(M.ConvolutionKernel||(M.ConvolutionKernel={}));const J=new Map;J.set(M.ConvolutionKernel.None,[0,0,0,0,1,0,0,0,0]);J.set(M.ConvolutionKernel.LineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);J.set(M.ConvolutionKernel.LineDetectionVertical,[-1,2,-1,-1,2,-1,
-1,2,-1]);J.set(M.ConvolutionKernel.LineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);J.set(M.ConvolutionKernel.LineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);J.set(M.ConvolutionKernel.GradientNorth,[-1,-2,-1,0,0,0,1,2,1]);J.set(M.ConvolutionKernel.GradientWest,[-1,0,1,-2,0,2,-1,0,1]);J.set(M.ConvolutionKernel.GradientEast,[1,0,-1,2,0,-2,1,0,-1]);J.set(M.ConvolutionKernel.GradientSouth,[1,2,1,0,0,0,-1,-2,-1]);J.set(M.ConvolutionKernel.GradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);J.set(M.ConvolutionKernel.GradientNorthWest,
[-2,-1,0,-1,0,1,0,1,2]);J.set(M.ConvolutionKernel.SmoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);J.set(M.ConvolutionKernel.Smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);J.set(M.ConvolutionKernel.Smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);J.set(M.ConvolutionKernel.Sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);J.set(M.ConvolutionKernel.Sharpening5x5,[-1,-3,-4,
-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);J.set(M.ConvolutionKernel.Laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);J.set(M.ConvolutionKernel.Laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);J.set(M.ConvolutionKernel.SobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);J.set(M.ConvolutionKernel.SobelVertical,[-1,0,1,-2,0,2,-1,0,1]);J.set(M.ConvolutionKernel.Sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);J.set(M.ConvolutionKernel.Sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);
J.set(M.ConvolutionKernel.PointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);M.convolute=function(L,k){const l=H(k.kernel),a=!1!==k.mirrorEdges;L=l.separable?P(L,l.row,l.col,a):n(L,k,a);({outputPixelType:k}=k);k&&L.clamp(k);return L};M.convoluteSeparable=P;M.convolutionKernels=J;M.separateKernels=H;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="ExtractBand";m.functionArguments=null;m.rasterArgumentNames=["raster"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){var {sourceRasterInfos:m}=this;m=m[0];const {bandCount:e}=m,{bandIDs:p,missingBandAction:y}=this.functionArguments;if(y===k.MissingBandAction.fail&&p.some(g=>0>g||g>=e))return{success:!1,error:"extract-band-function: invalid bandIDs"};this.outputPixelType=
this._getOutputPixelType("f32");m=m.clone();m.pixelType=this.outputPixelType;const {statistics:K,histograms:F}=m;H.isSome(K)&&K.length&&(m.statistics=p.map(g=>K[g]||K[K.length-1]));H.isSome(F)&&F.length&&(m.histograms=p.map(g=>F[g]||F[F.length-1]));this.rasterInfo=m;return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m))return null;const e=m.pixels.length,p=this.functionArguments.bandIDs.map(y=>y>=e?e-1:y);return m.extractBands(p)};return a}(J);D.__decorate([I.property({json:{write:!0,
name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],n)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(M,D,H,I,n,R,P,J){var L;I=L=function(k){function l(){var a=k.apply(this,arguments)||this;a.bandIDs=[];a.missingBandAction=J.MissingBandAction.bestMatch;return a}M._inheritsLoose(l,k);l.prototype.clone=function(){return new L({bandIDs:[...this.bandIDs],missingBandAction:this.missingBandAction})};return l}(P);D.__decorate([H.property({json:{write:!0}})],I.prototype,"bandIDs",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"missingBandAction",void 0);return I=L=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
I)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName=
"Local";m.functionArguments=null;m.rasterArgumentNames=["rasters"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){var {sourceRasterInfos:m}=this;const e=m[0],{bandCount:p}=e,{processAsMultiband:y}=this.functionArguments;if(y&&m.some(K=>K.bandCount!==p))return{success:!1,error:"local-function: input rasters do not have same band count"};this.outputPixelType=this._getOutputPixelType("f32");m=e.clone();m.pixelType=this.outputPixelType;m.statistics=null;m.histograms=
null;y||(m.bandCount=1);this.rasterInfo=m;return{success:!0}};f._processPixels=function(m){({pixelBlocks:m}=m);return H.isNone(m)||m.some(e=>H.isNone(e))?null:k.local(m,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],
n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.LocalFunction")],n)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J){var L;n=L=function(k){function l(){var f=k.apply(this,arguments)||this;f.rasters=[];f.processAsMultiband=!1;return f}M._inheritsLoose(l,k);var a=l.prototype;a.writeRasters=function(f,m){m.rasters=f.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())};a.clone=function(){return new L({method:this.operation,processAsMultiband:this.processAsMultiband,rasters:H.clone(this.rasters)})};return l}(J);D.__decorate([I.property({json:{write:!0}})],n.prototype,"operation",void 0);
D.__decorate([I.property({json:{write:!0}})],n.prototype,"rasters",void 0);D.__decorate([P.writer("rasters")],n.prototype,"writeRasters",null);D.__decorate([I.property({json:{write:!0}})],n.prototype,"processAsMultiband",void 0);return n=L=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],n)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],function(M,D,H){function I(U){U=U.map(ea=>ea.mask).filter(ea=>
D.isSome(ea));if(0===U.length)return null;const ia=U[0].length,da=new Uint8Array(ia);if(1===U.length)return da.set(U[0]),da;let la=U[0],ja;for(let ea=1;ea<U.length;ea++){ja=U[ea];for(let sa=0;sa<ia;sa++)da[sa]=la[sa]|ja[sa];la=ja}return da}function n(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]+ja[ea];return da}function R(U,ia,da){[U]=U;ia=H.createEmptyBand("f32",U.length);ia.set(U);return ia}function P(U,ia,da){const [la,ja]=
U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]-ja[ea];return da}function J(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]*ja[ea];return da}function L(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=0===ja[ea]?0:la[ea]/ja[ea];return da}function k(U,ia,da){return L(U,ia,"f32")}function l(U,ia,da){const [la,ja]=U;U=la.length;da=
H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=0===ja[ea]?0:Math.floor(la[ea]/ja[ea]);return da}function a(U,ia,da,la){[U]=U;const ja=U.length;da=H.createEmptyBand(da,ja);for(let ea=0;ea<ja;ea++)if(!ia||ia[ea])da[ea]=la(U[ea]);return da}function f(U,ia,da,la){const [ja,ea]=U;U=ja.length;da=H.createEmptyBand(da,U);for(let sa=0;sa<U;sa++)if(!ia||ia[sa])da[sa]=la(ja[sa],ea[sa]);return da}function m(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<
U;ea++)if(!ia||ia[ea])da[ea]=la[ea]&ja[ea];return da}function e(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]<<ja[ea];return da}function p(U,ia,da){[U]=U;const la=U.length;da=H.createEmptyBand(da,la);for(let ja=0;ja<la;ja++)if(!ia||ia[ja])da[ja]=~U[ja];return da}function y(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]|ja[ea];return da}function K(U,ia,da){const [la,
ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]>>ja[ea];return da}function F(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]^ja[ea];return da}function g(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]&&ja[ea]?1:0;return da}function w(U,ia,da){[U]=U;const la=U.length;da=H.createEmptyBand(da,la);for(let ja=0;ja<la;ja++)if(!ia||
ia[ja])da[ja]=U[ja]?0:1;return da}function u(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]||ja[ea]?1:0;return da}function C(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=(la[ea]?1:0)^(ja[ea]?1:0);return da}function d(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]===ja[ea]?1:0;return da}function b(U,
ia,da,la){[U]=U;const ja=U.length;da=H.createEmptyBand(da,ja);for(let ea=0;ea<ja;ea++)if(!ia||ia[ea])da[ea]=la**U[ea];return da}function c(U,ia,da){return b(U,ia,da,10)}function h(U,ia,da){return b(U,ia,da,2)}function q(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]>ja[ea]?1:0;return da}function z(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]>=ja[ea]?1:0;return da}
function B(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]<ja[ea]?1:0;return da}function r(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]<=ja[ea]?1:0;return da}function x(U,ia,da){[U]=U;U=U.length;da=H.createEmptyBand(da,U);if(!ia)return da;for(let la=0;la<U;la++)da[la]=ia[la]?0:1;return da}function v(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,
U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]%ja[ea];return da}function E(U,ia,da){[U]=U;const la=U.length;da=H.createEmptyBand(da,la);for(let ja=0;ja<la;ja++)if(!ia||ia[ja])da[ja]=-U[ja];return da}function t(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);for(let ea=0;ea<U;ea++)if(!ia||ia[ea])da[ea]=la[ea]===ja[ea]?0:1;return da}function A(U,ia,da){const [la,ja]=U;U=la.length;da=H.createEmptyBand(da,U);const ea=new Uint8Array(U);for(let sa=0;sa<U;sa++)null!=ia&&!ia[sa]||
0!==la[sa]||(da[sa]=ja[sa],ea[sa]=255);return{band:da,mask:ea}}function O(U,ia,da){const [la,ja,ea]=U;U=la.length;da=H.createEmptyBand(da,U);for(let sa=0;sa<U;sa++)if(!ia||ia[sa])da[sa]=la[sa]?ja[sa]:ea[sa];return da}function N(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;const ea=ja.length;da=H.createEmptyBand(da,ea);da.set(ja);for(ja=0;ja<ea;ja++)if(!ia||ia[ja])for(let sa=1;sa<la;sa++){const ua=U[sa];da[ja]<ua[ja]&&(da[ja]=ua[ja])}return da}function X(U,ia,da){const la=U.length;if(2>
la)return U[0];var [ja]=U;const ea=ja.length;da=H.createEmptyBand(da,ea);da.set(ja);for(ja=0;ja<ea;ja++)if(!ia||ia[ja])for(let sa=1;sa<la;sa++){const ua=U[sa];da[ja]>ua[ja]&&(da[ja]=ua[ja])}return da}function V(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;const ea=ja.length;da=H.createEmptyBand(da,ea);da.set(ja);for(ja=0;ja<ea;ja++)if(!ia||ia[ja]){let sa=da[ja];for(let ua=1;ua<la;ua++){const va=U[ua];da[ja]<va[ja]&&(da[ja]=va[ja]);sa>va[ja]&&(sa=va[ja])}da[ja]-=sa}return da}function W(U,
ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;const ea=ja.length;da=H.createEmptyBand(da,ea);da.set(ja);for(ja=0;ja<ea;ja++)if(!ia||ia[ja]){for(let sa=1;sa<la;sa++)da[ja]+=U[sa][ja];da[ja]/=la}return da}function G(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;const ea=ja.length;da=H.createEmptyBand(da,ea);da.set(ja);for(ja=0;ja<ea;ja++)if(!ia||ia[ja])for(let sa=1;sa<la;sa++)da[ja]+=U[sa][ja];return da}function S(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;ja=ja.length;
da=H.createEmptyBand(da,ja);for(let ua=0;ua<ja;ua++)if(!ia||ia[ua]){const va=new Float32Array(la);let xa=0;for(var ea=0;ea<la;ea++){var sa=U[ea];xa+=sa[ua];va[ea]=sa[ua]}xa/=la;ea=0;for(sa=0;sa<la;sa++)ea+=(va[sa]-xa)*va[sa]-xa;da[ua]=Math.sqrt(ea/la-1)}return da}function T(U,ia,da){const la=U.length;if(2>la)return U[0];const ja=Math.floor(la/2);var [ea]=U;ea=ea.length;da=H.createEmptyBand(da,ea);const sa=new Float32Array(la);for(let ua=0;ua<ea;ua++)if(!ia||ia[ua]){for(let va=0;va<la;va++)sa[va]=
U[va][ua];sa.sort();da[ua]=sa[ja]}return da}function aa(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;ja=ja.length;da=H.createEmptyBand(da,ja);const ea=new Map;for(let ua=0;ua<ja;ua++)if(!ia||ia[ua]){ea.clear();let va;for(var sa=0;sa<la;sa++)va=U[sa][ua],ea.set(va,ea.has(va)?ea.get(va)+1:1);let xa=sa=0;for(const ya of ea.keys())sa=ea.get(ya),sa>xa&&(xa=sa,va=ya);da[ua]=va}return da}function Z(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;ja=ja.length;da=H.createEmptyBand(da,
ja);const ea=new Map;for(let ua=0;ua<ja;ua++)if(!ia||ia[ua]){ea.clear();let va;for(var sa=0;sa<la;sa++)va=U[sa][ua],ea.set(va,ea.has(va)?ea.get(va)+1:1);sa=0;let xa=U.length;for(const ya of ea.keys())sa=ea.get(ya),sa<xa&&(xa=sa,va=ya);da[ua]=va}return da}function Q(U,ia,da){const la=U.length;if(2>la)return U[0];var [ja]=U;ja=ja.length;da=H.createEmptyBand(da,ja);const ea=new Set;for(let sa=0;sa<ja;sa++)if(!ia||ia[sa]){ea.clear();let ua;for(let va=0;va<la;va++)ua=U[va][sa],ea.add(ua);da[sa]=ea.size}return da}
function Y(U,ia,da){return aa(U,null,da)}function ba(U,ia,da){return Z(U,null,da)}function ca(U,ia,da){return Q(U,null,da)}function fa(U,ia,da){return N(U,null,da)}function ha(U,ia,da){return X(U,null,da)}function ka(U,ia,da){return S(U,null,da)}function ma(U,ia,da){return G(U,null,da)}function na(U,ia,da){return W(U,null,da)}function ra(U,ia,da){return T(U,null,da)}function ta(U,ia,da){return V(U,null,da)}M.LocalOperator=void 0;(function(U){U[U.Plus=1]="Plus";U[U.Minus=2]="Minus";U[U.Times=3]="Times";
U[U.SquareRoot=4]="SquareRoot";U[U.Power=5]="Power";U[U.ACos=6]="ACos";U[U.ASin=7]="ASin";U[U.ATan=8]="ATan";U[U.ATanH=9]="ATanH";U[U.Abs=10]="Abs";U[U.BitwiseAnd=11]="BitwiseAnd";U[U.BitwiseLeftShift=12]="BitwiseLeftShift";U[U.BitwiseNot=13]="BitwiseNot";U[U.BitwiseOr=14]="BitwiseOr";U[U.BitwiseRightShift=15]="BitwiseRightShift";U[U.BitwiseXOr=16]="BitwiseXOr";U[U.BooleanAnd=17]="BooleanAnd";U[U.BooleanNot=18]="BooleanNot";U[U.BooleanOr=19]="BooleanOr";U[U.BooleanXOr=20]="BooleanXOr";U[U.Cos=21]=
"Cos";U[U.CosH=22]="CosH";U[U.Divide=23]="Divide";U[U.EqualTo=24]="EqualTo";U[U.Exp=25]="Exp";U[U.Exp10=26]="Exp10";U[U.Exp2=27]="Exp2";U[U.GreaterThan=28]="GreaterThan";U[U.GreaterThanEqual=29]="GreaterThanEqual";U[U.Int=30]="Int";U[U.IsNull=31]="IsNull";U[U.Float=32]="Float";U[U.LessThan=33]="LessThan";U[U.LessThanEqual=34]="LessThanEqual";U[U.Ln=35]="Ln";U[U.Log10=36]="Log10";U[U.Log2=37]="Log2";U[U.Majority=38]="Majority";U[U.Max=39]="Max";U[U.Mean=40]="Mean";U[U.Med=41]="Med";U[U.Min=42]="Min";
U[U.Minority=43]="Minority";U[U.Mod=44]="Mod";U[U.Negate=45]="Negate";U[U.NotEqual=46]="NotEqual";U[U.Range=47]="Range";U[U.RoundDown=48]="RoundDown";U[U.RoundUp=49]="RoundUp";U[U.SetNull=50]="SetNull";U[U.Sin=51]="Sin";U[U.SinH=52]="SinH";U[U.Square=53]="Square";U[U.Std=54]="Std";U[U.Sum=55]="Sum";U[U.Tan=56]="Tan";U[U.TanH=57]="TanH";U[U.Variety=58]="Variety";U[U.ACosH=59]="ACosH";U[U.ASinH=60]="ASinH";U[U.ATan2=61]="ATan2";U[U.FloatDivide=64]="FloatDivide";U[U.FloorDivide=65]="FloorDivide";U[U.MajorityIgnoreNoData=
66]="MajorityIgnoreNoData";U[U.MaxIgnoreNoData=67]="MaxIgnoreNoData";U[U.MeanIgnoreNoData=68]="MeanIgnoreNoData";U[U.MedIgnoreNoData=69]="MedIgnoreNoData";U[U.MinIgnoreNoData=70]="MinIgnoreNoData";U[U.MinorityIgnoreNoData=71]="MinorityIgnoreNoData";U[U.RangeIgnoreNoData=72]="RangeIgnoreNoData";U[U.StdIgnoreNoData=73]="StdIgnoreNoData";U[U.SumIgnoreNoData=74]="SumIgnoreNoData";U[U.VarietyIgnoreNoData=75]="VarietyIgnoreNoData";U[U.Con=76]="Con"})(M.LocalOperator||(M.LocalOperator={}));const pa=new Map,
qa=new Map,oa=new Map;M.local=function(U,ia,da={}){pa.size||(pa.set(4,Math.sqrt),pa.set(6,Math.acos),pa.set(7,Math.asin),pa.set(8,Math.atan),pa.set(9,Math.atanh),pa.set(10,Math.abs),pa.set(21,Math.cos),pa.set(22,Math.cosh),pa.set(25,Math.exp),pa.set(30,Math.floor),pa.set(35,Math.log),pa.set(36,Math.log10),pa.set(37,Math.log2),pa.set(48,Math.floor),pa.set(49,Math.ceil),pa.set(51,Math.sin),pa.set(52,Math.sinh),pa.set(56,Math.tan),pa.set(57,Math.tanh),pa.set(59,Math.acosh),pa.set(60,Math.asinh),pa.set(65,
Math.floor),qa.set(5,Math.pow),qa.set(61,Math.atan2),oa.set(1,n),oa.set(2,P),oa.set(3,J),oa.set(11,m),oa.set(12,e),oa.set(12,e),oa.set(13,p),oa.set(14,y),oa.set(15,K),oa.set(16,F),oa.set(17,g),oa.set(18,w),oa.set(19,u),oa.set(20,C),oa.set(23,L),oa.set(24,d),oa.set(26,c),oa.set(27,h),oa.set(28,q),oa.set(29,z),oa.set(31,x),oa.set(32,R),oa.set(33,B),oa.set(34,r),oa.set(44,v),oa.set(45,E),oa.set(46,t),oa.set(64,k),oa.set(65,l),oa.set(76,O),oa.set(38,aa),oa.set(39,N),oa.set(40,W),oa.set(41,T),oa.set(42,
X),oa.set(43,Z),oa.set(47,V),oa.set(54,S),oa.set(55,G),oa.set(58,Q),oa.set(66,Y),oa.set(67,fa),oa.set(68,na),oa.set(69,ra),oa.set(70,ha),oa.set(71,ba),oa.set(72,ta),oa.set(73,ka),oa.set(74,ma),oa.set(75,ca));const la=D.unwrap(I(U)),{processAsMultiband:ja,outputPixelType:ea="f32"}=da,sa=ja?U[0].pixels.length:1;da=[];for(let va=0;va<sa;va++){const xa=U.map(za=>za.pixels[va]);let ya;if(ia===M.LocalOperator.SetNull){var ua=A(xa,la,ea);ya=ua.band;ua=ua.mask}else oa.has(ia)?ya=oa.get(ia)(xa,la,ea):pa.has(ia)?
ya=a(xa,la,ea,pa.get(ia)):qa.has(ia)&&(ya=f(xa,la,ea,qa.get(ia)));if(null==ya)return null;da.push(ya)}ua||ia===M.LocalOperator.IsNull||(ua=la);U=U[0];return new H({width:U.width,height:U.height,pixelType:ea,mask:ua,pixels:da})};M.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,1,1,1,1,999,999,1,1,999,1,1,2,2,2,999,999,999,999,999,999,999,999,999,999,3];Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName=
"Mask";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.lookup=null;return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){const m=this.sourceRasterInfos[0].clone(),{pixelType:e}=m;this.outputPixelType=this._getOutputPixelType(e);m.pixelType=this.outputPixelType;this.rasterInfo=m;const {includedRanges:p,noDataValues:y}=this.functionArguments;if(!p?.length&&!y?.length)return{success:!1,error:"missing includedRanges or noDataValues argument"};this.lookup=k.createMaskLUT(e,
this.functionArguments.includedRanges,this.functionArguments.noDataValues);return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m))return null;const {outputPixelType:e,lookup:p}=this,{includedRanges:y,noDataValues:K,noDataInterpretation:F}=this.functionArguments;return k.mask(m,{includedRanges:y,noDataValues:K,outputPixelType:e,matchAll:F===k.NoDataInterpretation.matchAll,lookup:p})};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,
"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,"lookup",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.MaskFunction")],n)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(M,D,H,I,n,R,P,J){var L;I=L=function(k){function l(){var a=k.apply(this,arguments)||this;a.includedRanges=null;a.noDataValues=null;a.noDataInterpretation=J.NoDataInterpretation.matchAny;return a}M._inheritsLoose(l,k);l.prototype.clone=function(){return new L({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})};return l}(P);D.__decorate([H.property({json:{write:!0}})],I.prototype,"includedRanges",void 0);
D.__decorate([H.property({json:{write:!0}})],I.prototype,"noDataValues",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"noDataInterpretation",void 0);return I=L=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="NDVI";m.functionArguments=null;m.rasterArgumentNames=["raster"];return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){const {scaled:m}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(m?"u8":"f32");const e=this.sourceRasterInfos[0].clone();e.pixelType=this.outputPixelType;e.colormap=null;e.histograms=null;const [p,y,K,F]=m?[0,200,100,10]:[-1,1,
0,.1];e.statistics=[{min:p,max:y,avg:K,stddev:F}];this.rasterInfo=e;return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m))return null;const {visibleBandID:e,infraredBandID:p,scaled:y}=this.functionArguments;return J.calculateNDVI(m,e,p,y)};return a}(L);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:k,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",
void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],n)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P){var J;I=J=function(L){function k(){var l=L.apply(this,arguments)||this;l.visibleBandID=0;l.infraredBandID=1;l.scaled=!0;return l}M._inheritsLoose(k,L);k.prototype.clone=function(){const {visibleBandID:l,infraredBandID:a,scaled:f}=this;return new J({visibleBandID:l,infraredBandID:a,scaled:f})};return k}(P);D.__decorate([H.property({json:{write:!0}})],I.prototype,"visibleBandID",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"infraredBandID",void 0);D.__decorate([H.property({json:{write:!0}})],
I.prototype,"scaled",void 0);return I=J=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="Remap";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.lookup=null;return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){const m=this.sourceRasterInfos[0].clone(),{pixelType:e}=m;this.outputPixelType=this._getOutputPixelType(e);m.pixelType=this.outputPixelType;m.colormap=null;m.histograms=null;const {statistics:p}=m,{allowUnmatched:y,outputValues:K}=this.functionArguments;
if(H.isSome(p)&&p.length&&!y){let g=K[0],w=g;for(var F=0;F<K.length;F++)g=g>K[F]?K[F]:g,w=w>K[F]?w:K[F];for(F=0;F<p.length;F++)p[F]={...p[F],min:g,max:w}}this.rasterInfo=m;this.lookup=y?null:L.createRemapLUT(e,this.functionArguments.inputRanges,K);return{success:!0}};f._processPixels=function(m){m=m.pixelBlocks?.[0];if(H.isNone(m))return null;const {lookup:e,outputPixelType:p}=this;if(e)return L.lookupPixels(m,{lut:[e.lut],offset:e.offset,outputPixelType:p});const {inputRanges:y,outputValues:K,noDataRanges:F,
allowUnmatched:g}=this.functionArguments;return L.remap(m,{inputRanges:y,outputValues:K,noDataRanges:F,allowUnmatched:g,outputPixelType:p})};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:k,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,
"lookup",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.RemapFunction")],n)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(M,D,H,I,n,R,P){var J;I=J=function(L){function k(){var l=
L.apply(this,arguments)||this;l.inputRanges=null;l.outputValues=null;l.noDataRanges=null;l.allowUnmatched=!1;return l}M._inheritsLoose(k,L);k.prototype.clone=function(){return new J({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched})};return k}(P);D.__decorate([H.property({json:{write:!0}})],I.prototype,"inputRanges",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"outputValues",void 0);D.__decorate([H.property({json:{write:!0}})],
I.prototype,"noDataRanges",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"allowUnmatched",void 0);return I=J=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k){n=function(l){function a(){var m=l.apply(this,arguments)||this;m.functionName="Slope";m.functionArguments=null;m.rasterArgumentNames=["raster"];m.isGCS=!1;return m}M._inheritsLoose(a,l);var f=a.prototype;f._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const m=this.sourceRasterInfos[0].clone();m.pixelType=this.outputPixelType;m.statistics=null;m.histograms=null;this.rasterInfo=m;this.isGCS=m.spatialReference.isGeographic;return{success:!0}};
f._processPixels=function(m){const e=m.pixelBlocks?.[0];if(H.isNone(e))return null;const {zFactor:p,slopeType:y,pixelSizePower:K,pixelSizeFactor:F}=this.functionArguments,{isGCS:g}=this;({extent:m}=m);return k.slope(e,{zFactor:p,slopeType:y,pixelSizePower:K,pixelSizeFactor:F,isGCS:g,resolution:m?{x:m.width/e.width,y:m.height/e.height}:{x:1,y:1}})};return a}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:L,json:{write:!0,
name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,"isGCS",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],n)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J,L){var k;H=new H.JSONMap({0:"degree",1:"percent-rise",2:"adjusted"},{useNumericKeys:!0});L=k=function(l){function a(){var f=l.apply(this,arguments)||this;f.slopeType="degree";f.zFactor=1;f.pixelSizePower=.664;f.pixelSizeFactor=.024;return f}M._inheritsLoose(a,l);a.prototype.clone=function(){return new k({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,raster:this.raster})};return a}(L);D.__decorate([P.enumeration(H)],
L.prototype,"slopeType",void 0);D.__decorate([I.property({type:Number,json:{write:!0}})],L.prototype,"zFactor",void 0);D.__decorate([I.property({type:Number,json:{name:"psPower",write:!0}})],L.prototype,"pixelSizePower",void 0);D.__decorate([I.property({type:Number,json:{name:"psFactor",write:!0}})],L.prototype,"pixelSizeFactor",void 0);return L=k=D.__decorate([J.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/StatisticsHistogramsFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramsFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J){I=function(L){function k(){var a=L.apply(this,arguments)||this;a.functionName="StatisticsHistograms";a.functionArguments=null;a.rasterArgumentNames=["raster"];return a}M._inheritsLoose(k,L);var l=k.prototype;l._bindSourceRasters=function(){var a=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");a=a.clone();const {statistics:f,histograms:m}=this.functionArguments;a.histograms=m;f&&(a.statistics=f.map(([e,p,y,K])=>({min:e,max:p,avg:y,stddev:K})));
this.rasterInfo=a;return{success:!0}};l._processPixels=function(a){return a.pixelBlocks?.[0]};return k}(P);D.__decorate([H.property({json:{write:!0,name:"rasterFunction"}})],I.prototype,"functionName",void 0);D.__decorate([H.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],I.prototype,"functionArguments",void 0);D.__decorate([H.property()],I.prototype,"rasterArgumentNames",void 0);D.__decorate([H.property({json:{write:!0}})],I.prototype,"indexedColormap",void 0);return I=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramsFunction")],
I)})},"esri/layers/support/rasterFunctions/StatisticsHistogramsFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(M,D,H,I,n,R,P){var J;n=J=function(L){function k(){var l=L.apply(this,arguments)||this;l.statistics=null;l.histograms=null;return l}
M._inheritsLoose(k,L);k.prototype.clone=function(){return new J({statistics:H.clone(this.statistics),histograms:H.clone(this.histograms)})};return k}(P);D.__decorate([I.property({json:{write:!0}})],n.prototype,"statistics",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,"histograms",void 0);return n=J=D.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramsFunctionArguments")],n)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l){n=function(a){function f(){var e=a.apply(this,arguments)||this;e.functionName="Stretch";e.functionArguments=null;e.rasterArgumentNames=["raster"];e.lookup=null;e.cutOffs=null;return e}M._inheritsLoose(f,a);var m=f.prototype;m._bindSourceRasters=function(){this.cutOffs=this.lookup=null;var e=this.sourceRasterInfos[0];const {pixelType:p}=e;var {functionArguments:y}=this;const {dynamicRangeAdjustment:K,gamma:F,useGamma:g}=y;!K&&["u8","u16","s8","s16"].includes(p)?(y=l.getStretchCutoff(y.toJSON(),
{rasterInfo:e}),this.lookup=l.createStretchLUT({pixelType:p,...y,gamma:g?F:null})):K&&(this.cutOffs=l.getStretchCutoff(y.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(p);e=e.clone();e.pixelType=this.outputPixelType;e.statistics=null;e.histograms=null;"u8"===this.outputPixelType&&(e.keyProperties.DataType="processed");this.rasterInfo=e;return{success:!0}};m._processPixels=function(e){e=e.pixelBlocks?.[0];if(H.isNone(e))return e;var {lookup:p}=this;if(p)return L.lookupPixels(e,
{...p,outputPixelType:this.rasterInfo.pixelType});({functionArguments:p}=this);const y=this.cutOffs||l.getStretchCutoff(p.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e});return l.stretch(e,{...y,gamma:p.useGamma?p.gamma:null,outputPixelType:this.outputPixelType})};return f}(J);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],n.prototype,"functionName",void 0);D.__decorate([I.property({type:k,json:{write:!0,name:"rasterFunctionArguments"}})],n.prototype,"functionArguments",
void 0);D.__decorate([I.property()],n.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,"lookup",void 0);D.__decorate([I.property({json:{write:!0}})],n.prototype,"cutOffs",void 0);return n=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.StretchFunction")],n)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(M,D,H,I,n,R,P,J,L,k){var l;H=new H.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",7:"sigmoid"},{useNumericKeys:!0});k=l=function(a){function f(){var e=a.apply(this,arguments)||this;e.computeGamma=!1;e.dynamicRangeAdjustment=!1;e.gamma=[];e.histograms=null;e.statistics=null;e.stretchType="none";e.useGamma=!1;return e}M._inheritsLoose(f,a);var m=f.prototype;m.writeStatistics=function(e,p,y){e?.length&&(Array.isArray(e[0])||(e=e.map(K=>[K.min,
K.max,K.avg,K.stddev])),p[y]=e)};m.clone=function(){return new l({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:I.clone(this.statistics),gamma:I.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:I.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,
raster:this.raster})};return f}(k);D.__decorate([n.property({type:Boolean,json:{write:!0}})],k.prototype,"computeGamma",void 0);D.__decorate([n.property({type:Boolean,json:{name:"dra",write:!0}})],k.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([n.property({type:[Number],json:{write:!0}})],k.prototype,"gamma",void 0);D.__decorate([n.property()],k.prototype,"histograms",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],k.prototype,"maxPercent",void 0);D.__decorate([n.property({type:Number,
json:{write:!0}})],k.prototype,"minPercent",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],k.prototype,"numberOfStandardDeviations",void 0);D.__decorate([n.property({type:Number,json:{name:"max",write:!0}})],k.prototype,"outputMax",void 0);D.__decorate([n.property({type:Number,json:{name:"min",write:!0}})],k.prototype,"outputMin",void 0);D.__decorate([n.property({type:Number,json:{write:!0}})],k.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([n.property({json:{type:[[Number]],
write:!0}})],k.prototype,"statistics",void 0);D.__decorate([L.writer("statistics")],k.prototype,"writeStatistics",null);D.__decorate([P.enumeration(H)],k.prototype,"stretchType",void 0);D.__decorate([n.property({type:Boolean,json:{write:!0}})],k.prototype,"useGamma",void 0);return k=l=D.__decorate([J.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],k)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../../../renderers/support/stretchRendererUtils"],
function(M,D,H,I){function n(l,a=256){a=Math.min(a,256);const {size:f,counts:m}=l;l=new Uint8Array(f);var e=m.reduce((g,w)=>g+w/a,0);let p=0;var y=0;let K=0,F=e;for(let g=0;g<f;g++)if(K+=m[g],!(g<f-1&&K+m[g+1]<F)){for(;p<a-1&&F<K;)p++,F+=e;for(;y<=g;y++)l[y]=p;y=g+1}for(e=y;e<f;e++)l[e]=a-1;return l}function R(l,a){l=Math.min(Math.max(l,-100),100);a=Math.min(Math.max(a??0,-100),100);let f=0,m=0;const e=new Uint8Array(256);for(f=0;256>f;f++)0<l&&100>l?m=(200*f-25500+510*a)/(2*(100-l))+128:0>=l&&-100<
l?m=(200*f-25500+510*a)*(100+l)/2E4+128:100===l?(m=200*f-25500+256*(100-l)+510*a,m=0<m?255:0):-100===l&&(m=128),e[f]=255<m?255:0>m?0:m;return e}function P(l){if(D.isNone(l)||!l.pixels?.length)return null;l.statistics||l.updateStatistics();const {pixels:a,mask:f,pixelType:m,statistics:e}=l;l=l.width*l.height;const p=a.length;let y,K;let F;var g;const w=[],u=[];for(F=0;F<p;F++){var C=new Uint32Array(256);var d=a[F];if("u8"===m)if(y=-.5,K=255.5,f)for(g=0;g<l;g++)f[g]&&C[d[g]]++;else for(g=0;g<l;g++)C[d[g]]++;
else{D.assertIsSome(e);y=e[F].minValue;K=e[F].maxValue;var b=(K-y)/256;var c=new Uint32Array(257);if(f)for(g=0;g<l;g++)f[g]&&c[Math.floor((d[g]-y)/b)]++;else for(g=0;g<l;g++)c[Math.floor((d[g]-y)/b)]++;for(g=0;255>g;g++)C[g]=c[g];C[255]=c[255]+c[256]}w.push({min:y,max:K,size:256,counts:C});for(g=d=c=b=0;256>g;g++)b+=C[g],c+=g*C[g];c/=b;for(g=0;256>g;g++)d+=C[g]*(g-c)**2;C=Math.sqrt(d/(b-1));b=(K-y)/256;g=(c+.5)*b+y;C*=b;u.push({min:y,max:K,avg:g,stddev:C})}return{statistics:u,histograms:w}}function J(l,
a){if(null==a||0===a.length)return l;const f=Math.max.apply(null,a),{minCutOff:m,maxCutOff:e,outMin:p,outMax:y,histogramLut:K}=l;return m.length===a.length||m.length<=f?l:{minCutOff:a.map(F=>m[F]),maxCutOff:a.map(F=>e[F]),histogramLut:K?a.map(F=>K[F]):null,outMin:p,outMax:y}}const L={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},k=[.299,.587,.114];
M.computeGammaValues=function(l,a,f){const m=[];for(let F=0;F<a.length;F++){var e=0,p=0,y=0;"min"in a[F]?{min:e,max:p,avg:y}=a[F]:[e,p,y]=a[F];y=y??0;"u8"!==l&&(y=255*(y-e)/(p-e));f&&(y*=k[F]);e=m;p=e.push;if(0>=y||255<=y)y=1;else{var K=0;150!==y&&(K=150>=y?45*Math.cos(.01047*y):17*Math.sin(.021*y));K=Math.log((y+K)/255);0===K?y=1:(y=Math.log(y/255)/K,y=isNaN(y)?1:Math.min(9.9,Math.max(.01,y)))}p.call(e,y)}return m};M.createContrastBrightnessLUT=R;M.createHistogramEqualizationLUT=n;M.createStretchLUT=
function(l){const {minCutOff:a,maxCutOff:f,gamma:m,pixelType:e}=l,p=l.outMin||0,y=l.outMax||255;if(!["u8","u16","s8","s16"].includes(e))return null;const K=a.length;let F;let g=0;"s8"===e?g=-127:"s16"===e&&(g=-32767);let w=256;["u16","s16"].includes(e)&&(w=65536);const u=[],C=y-p;for(F=0;F<K;F++)u[F]=f[F]-a[F],C/(f[F]-a[F]);var d=m&&m.length>=K;const b=[];if(d)for(F=0;F<K;F++)b[F]=1<m[F]?2<m[F]?6.5+(m[F]-2)**2.5:6.5+100*(2-m[F])**4:1;let c;const h=[];let q,z,B;if(d)for(F=0;F<K;F++){B=[];for(d=0;d<
w;d++)q=d+g,c=(q-a[F])/u[F],z=1,1<m[F]&&(z-=(1/C)**(c*b[F])),B[d]=q<f[F]&&q>a[F]?Math.floor(z*C*c**(1/m[F]))+p:q>=f[F]?y:p;h[F]=B}else for(F=0;F<K;F++){B=[];for(d=0;d<w;d++)q=d+g,B[d]=q<=a[F]?p:q>=f[F]?y:Math.floor((q-a[F])/u[F]*C)+p;h[F]=B}if(null!=l.contrastOffset)for(l=R(l.contrastOffset,l.brightnessOffset),F=0;F<K;F++)for(B=h[F],d=0;d<w;d++)B[d]=l[B[d]];return{lut:h,offset:g}};M.estimateStatisticsFromHistograms=function(l){const a=[];for(let p=0;p<l.length;p++){const {min:y,max:K,size:F,counts:g}=
l[p];let w=0;var f=0;for(var m=0;m<F;m++)w+=g[m],f+=m*g[m];f/=w;m=0;for(var e=0;e<F;e++)m+=g[e]*(e-f)**2;e=(K-y)/F;a.push({min:y,max:K,avg:(f+.5)*e+y,stddev:Math.sqrt(m/(w-1))*e})}return a};M.estimateStatisticsHistograms=P;M.getStretchCutoff=function(l,a){const {pixelBlock:f,bandIds:m,returnHistogramLut:e,rasterInfo:p}=a;var y=null;a=null;var K=l.stretchType;"number"===typeof K&&(K=I.stretchTypeFunctionEnum[K]);l.dra?"minMax"===K&&D.isSome(f)&&f.statistics?y=f.statistics.map(z=>[z.minValue,z.maxValue,
0,0]):(a=P(f),y=D.isSome(a)?a.statistics:null,a=D.isSome(a)?a.histograms:null):(y=0<l.statistics?.length?l.statistics:D.unwrap(p.statistics),a=l.histograms||D.unwrap(p.histograms));"percentClip"!==K&&"histogramEqualization"!==K||a?.length||(K="minMax");var F=y?.length||a?.length||p.bandCount;const g=[],w=[];let u;let C,d,b,c;y&&!Array.isArray(y[0])&&(y=y.map(z=>[z.min,z.max,z.avg,z.stddev]));switch(K){case "none":y=L[p.pixelType]||L.f32;for(b=0;b<F;b++)g[b]=y[0],w[b]=y[1];break;case "minMax":D.assertIsSome(y);
for(b=0;b<F;b++)g[b]=y[b][0],w[b]=y[b][1];break;case "standardDeviation":D.assertIsSome(y);for(b=0;b<F;b++)g[b]=y[b][2]-l.numberOfStandardDeviations*y[b][3],w[b]=y[b][2]+l.numberOfStandardDeviations*y[b][3],g[b]<y[b][0]&&(g[b]=y[b][0]),w[b]>y[b][1]&&(w[b]=y[b][1]);break;case "histogramEqualization":D.assertIsSome(a);for(b=0;b<F;b++)g[b]=a[b].min,w[b]=a[b].max;break;case "percentClip":D.assertIsSome(a);for(b=0;b<a.length;b++){y=a[b];C=new Uint32Array(y.size);var h=[...y.counts];20<=h.length&&(h[0]=
h[1]=h[2]=h[h.length-1]=h[h.length-2]=0);u=0;F=(y.max-y.min)/y.size;d=-.5===y.min&&1===F?.5:0;for(c=0;c<y.size;c++)u+=h[c],C[c]=u;h=(l.minPercent||0)*u/100;for(c=0;c<y.size;c++)if(C[c]>h){g[b]=y.min+F*(c+d);break}h=(1-(l.maxPercent||0)/100)*u;for(c=y.size-2;0<=c;c--)if(C[c]<h){w[b]=y.min+F*(c+2-d);break}}break;default:for(D.assertIsSome(y),b=0;b<F;b++)g[b]=y[b][0],w[b]=y[b][1]}let q;"histogramEqualization"===K?(D.assertIsSome(a),K=a[0].size||256,l=0,e&&(q=a.map(z=>n(z)))):(K=l.max||255,l=l.min||0);
return J({minCutOff:g,maxCutOff:w,outMax:K,outMin:l,histogramLut:q},m)};M.stretch=function(l,a){if(D.isNone(l)||!l.pixels?.length)return l;const {mask:f,width:m,height:e,pixels:p}=l,{minCutOff:y,maxCutOff:K,gamma:F}=a;var g=a.outMin||0;const w=a.outMax||255,u=m*e,C=a.outputPixelType||"u8";l=l.pixels.map(()=>H.createEmptyBand(C,u));a=l.length;let d;let b,c,h;const q=w-g,z=[];for(d=0;d<a;d++)z[d]=K[d]-y[d],q/(K[d]-y[d]);var B=F&&F.length>=a;const r=[];if(B)for(d=0;d<a;d++)r[d]=1<F[d]?2<F[d]?6.5+(F[d]-
2)**2.5:6.5+100*(2-F[d])**4:1;if(B)if(null!=f)for(B=0;B<u;B++){if(f[B])for(d=0;d<a;d++)b=p[d][B],h=(b-y[d])/z[d],c=1,1<F[d]&&(c-=(1/q)**(h*r[d])),l[d][B]=b<K[d]&&b>y[d]?Math.floor(c*q*h**(1/F[d]))+g:b>=K[d]?w:g}else for(B=0;B<u;B++)for(d=0;d<a;d++)b=p[d][B],h=(b-y[d])/z[d],c=1,1<F[d]&&(c-=(1/q)**(h*r[d])),l[d][B]=b<K[d]&&b>y[d]?Math.floor(c*q*h**(1/F[d]))+g:b>=K[d]?w:g;else if(null!=f)for(B=0;B<u;B++){if(f[B])for(d=0;d<a;d++)b=p[d][B],l[d][B]=b<K[d]&&b>y[d]?Math.floor((b-y[d])/z[d]*q)+g:b>=K[d]?w:
g}else for(B=0;B<u;B++)for(d=0;d<a;d++)b=p[d][B],l[d][B]=b<K[d]&&b>y[d]?Math.floor((b-y[d])/z[d]*q)+g:b>=K[d]?w:g;g=new H({width:m,height:e,mask:f,pixels:l,pixelType:C});g.updateStatistics();return g};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/maybe ../../core/unitUtils ../../layers/support/Field ../../layers/support/RasterInfo ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./UniqueValueInfo ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w){function u(Q,Y){Q=C(Q,Y?.variableName);const {bandCount:ba}=Q;let {bandIds:ca,stretchType:fa}=Y||{};ca?.some(ra=>ra>=ba)&&(ca=null);let ha=I.unwrap(Q.statistics),ka=I.unwrap(Q.histograms);1<ba?(ca=ca?.length?ca:d(Q),ha=null==ha?null:ca?.map(ra=>ha[ra]),ka=null==ka?null:ca?.map(ra=>ka[ra])):ca=[0];null==fa&&(fa=c(Q));let ma=!1;switch(fa){case "none":ma=!1;break;case "percent-clip":ma=!ka?.length;break;default:ma=!ha?.length}var {dataType:na}=Q;na=
1===ca?.length&&aa.has(na)?S:null;na=new p({stretchType:fa,dynamicRangeAdjustment:ma,colorRamp:na,outputMin:0,outputMax:255,gamma:1===ca?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===fa?na.maxPercent=na.minPercent=.25:"standard-deviation"===fa&&(na.numberOfStandardDeviations=2);if(!ma&&(I.isSome(Q.multidimensionalInfo)||Y?.includeStatisticsInStretch))if("percent-clip"===fa)na.histograms=ka;else if("min-max"===fa||"standard-deviation"===fa)na.statistics=ha;return na}function C(Q,Y){if(null==Y)return Q;
let ba=I.unwrap(Q.statistics),ca=I.unwrap(Q.histograms);var {multidimensionalInfo:fa}=Q;if(Y&&I.isSome(fa)&&(fa=fa.variables.find(ha=>ha.name===Y))){const {statistics:ha,histograms:ka}=fa;ha?.length&&(ba=ha);ka?.length&&(ca=ka)}return P.fromJSON({...Q.toJSON(),statistics:ba,histograms:ca})}function d(Q){const Y=Q.bandCount;if(1===Y)return null;if(2===Y)return[0];Q=Q.keyProperties&&Q.keyProperties.BandProperties;let ba;if(Q&&Q.length===Y){const {red:ca,green:fa,blue:ha,nir:ka}=b(Q);null!=ca&&null!=
fa&&null!=ha?ba=[ca,fa,ha]:null!=ka&&null!=ca&&null!=fa&&(ba=[ka,ca,fa])}!ba&&3<=Y&&(ba=[0,1,2]);return ba}function b(Q){const Y={};for(let fa=0;fa<Q.length;fa++){var ba=Q[fa],ca=ba.BandName?.toLowerCase();"red"===ca?Y.red=fa:"green"===ca?Y.green=fa:"blue"===ca?Y.blue=fa:"nearinfrared"===ca||"nearinfrared_1"===ca||"nir"===ca?Y.nir=fa:ba.WavelengthMax&&ba.WavelengthMin&&(ca=ba.WavelengthMin,ba=ba.WavelengthMax,null==Y.blue&&410<=ca&&480>=ca&&480<=ba&&540>=ba?Y.blue=fa:null==Y.green&&490<=ca&&560>=
ca&&560<=ba&&610>=ba?Y.green=fa:null==Y.red&&595<=ca&&670>=ca&&660<=ba&&730>=ba?Y.red=fa:null==Y.nir&&700<=ca&&860>=ca&&800<=ba&&950>=ba&&(Y.nir=fa))}return Y}function c(Q){let Y="percent-clip";const {pixelType:ba,dataType:ca,histograms:fa,statistics:ha}=Q;"u8"!==ba||"processed"!==ca&&I.isSome(fa)&&I.isSome(ha)?"u8"===ba||"elevation"===ca||aa.has(ca)?Y="min-max":I.isSome(fa)?Y="percent-clip":I.isSome(ha)&&(Y="min-max"):Y="none";return Y}function h(Q,Y,ba,ca){if(!r(Q,Y))return null;const {attributeTable:fa,
statistics:ha}=Q,ka=q(fa,Y),ma=B(fa,"red"),na=B(fa,"green"),ra=B(fa,"blue");Q=new L;const ta=[],pa=new Set,qa=!!(ma&&na&&ra);if(I.isSome(fa))fa.features.forEach(oa=>{var U=oa.attributes[ka.name];pa.has(oa.attributes[ka.name])||null==U||(pa.add(U),U=!qa||"single"!==ma.type&&"double"!==ma.type||"single"!==na.type&&"double"!==na.type||"single"!==ra.type&&"double"!==ra.type||fa.features.some(ia=>1<ia.attributes[ma.name]||1<ia.attributes[na.name]||1<ia.attributes[ra.name])?1:255,ta.push(new a({value:oa.attributes[ka.name],
label:oa.attributes[ka.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:qa?new D([oa.attributes[ma.name]*U,oa.attributes[na.name]*U,oa.attributes[ra.name]*U,1]):new D([0,0,0,0])}})))});else if(ha?.[0])for(Y=ha[0].min;Y<=ha[0].max;Y++)ta.push(new a({value:Y,label:Y.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new D([0,0,0,0])}}));ta.sort((oa,U)=>oa.value&&"string"===typeof oa.value.valueOf()?0:oa.value>U.value?1:-1);if(!qa){const oa=l.convertColorRampToColormap(T,
ta.length);ta.forEach((U,ia)=>U.symbol.color=new D(oa[ia].slice(1,4)));Q.colorRamp=T}if(ba||ca){const oa=ba||l.convertColorRampToColormap(ca,ta.length).map(U=>U.slice(1));ta.forEach((U,ia)=>U.symbol.color=new D(oa[ia]));Q.colorRamp=ca}return new y({field:ka.name,uniqueValueInfos:ta,authoringInfo:Q})}function q(Q,Y,ba){let ca;I.isSome(Q)?(ca=Y?Q.fields.find(fa=>Y.toLowerCase()===fa.name.toLowerCase()):z(Q.fields),ca||(ba||(ca=Q.fields.find(fa=>"string"===fa.type)),ca||(ca=B(Q,"value")))):ca=new R({name:"value"});
return ca}function z(Q){let Y;for(let ba=0;ba<Q.length;ba++){const ca=Q[ba].name.toLowerCase();if("string"===Q[ba].type){if(ca.startsWith("class")){Y=Q[ba];break}null==Y&&(ca.endsWith("name")||ca.endsWith("type"))&&(Y=Q[ba])}}return Y}function B(Q,Y){return I.isNone(Q)?null:Q.fields.find(ba=>ba.name.toLowerCase()===Y)}function r(Q,Y){const {attributeTable:ba,bandCount:ca}=Q;return I.isNone(ba)&&O(Q)?!0:I.isNone(ba)||1<ca||Y&&null==ba.fields.find(fa=>fa.name.toLowerCase()===Y.toLowerCase())?!1:!0}
function x(Q){const {bandCount:Y,colormap:ba}=Q;return I.isSome(ba)&&0<ba.length&&1===Y}function v(Q){if(!x(Q))return null;let Y;const {attributeTable:ba,colormap:ca}=Q;if(I.isSome(ba)){const fa=B(ba,"value"),ha=q(ba,null,!0);"string"===ha.type&&(Y={},ba.features.forEach(ka=>{ka=ka.attributes;Y[ka[fa.name]]=ha?ka[ha.name]:ka[fa.name]}))}return K.createFromColormap(I.unwrap(ca),Y)}function E(Q){const {bandCount:Y,dataType:ba,pixelType:ca}=Q;return"elevation"===ba||"generic"===ba&&1===Y&&("s16"===ca||
"s32"===ca||"f32"===ca||"f64"===ca)}function t(Q,Y=!1){const {attributeTable:ba,bandCount:ca}=Q;return 1===ca&&(!Y||I.isSome(ba)||I.isSome(Q.histograms))}function A(Q,Y,ba){let ca=0,fa=0;I.isSome(Q.attributeTable)?(Q=Q.attributeTable,ca=fa=Q.features[0].attributes[Y.name],Q.features.forEach(ha=>{ha=ha.attributes[Y.name];ha<ca&&(ca=ha);ha>fa&&(fa=ha)})):I.isSome(Q.histograms)&&(Q=Q.histograms,ca=Q[0].min,fa=Q[0].max);return(fa-ca)/ba}function O(Q){return["u8","s8"].includes(Q.pixelType)&&null!=Q.statistics?.[0]?.min&&
null!=Q.statistics[0]?.max&&1===Q.bandCount}function N(Q){({dataType:Q}=Q);return"vector-uv"===Q||"vector-magdir"===Q}function X(Q){({dataType:Q}=Q);return"vector-uv"===Q||"vector-magdir"===Q}function V(Q){if(!N(Q))return null;if(I.isSome(Q.statistics)&&Q.statistics.length&&("vector-magdir"===Q.dataType||"vector-uv"===Q.dataType)){const {minMagnitude:ba,maxMagnitude:ca}=G(Q.dataType,Q.statistics);var Y=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:ba,maxDataValue:ca}]}Q=I.isSome(Q.multidimensionalInfo)?
Z.get(Q.multidimensionalInfo.variables[0].unit):null;Y=new w({visualVariables:Y,inputUnit:Q,rotationType:"geographic"});Y.visualVariables=[...Y.sizeVariables,...Y.rotationVariables];return Y}function W(Q){return{color:Q.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function G(Q,Y){if("vector-magdir"===Q)Q=Y[0].min,Y=Y[0].max;else{const ba=Y[0].min,ca=Y[0].max,fa=Y[1].min;Y=Y[1].max;Q=0;Y=Math.max(Math.abs(ba),Math.abs(fa),Math.abs(ca),Math.abs(Y))}return{minMagnitude:Q,maxMagnitude:Y}}
const S=e.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),T=e.fromJSON(l.PREDEFINED_JSON_COLOR_RAMPS[0]),aa=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),Z=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);M.createClassBreaksRenderer=
function(Q,Y){Q=C(Q,Y?.variableName);const {attributeTable:ba}=Q;if(!t(Q))return null;const ca=I.isSome(Q.histograms)?Q.histograms[0]:null,fa=null!=Y?.numClasses&&isFinite(Y?.numClasses)?Y.numClasses:5,ha=new L({classificationMethod:Y?.classificationMethod,colorRamp:Y?.colorRamp});let ka=Y?.field||"value";const ma=[],na=[],ra=I.isSome(ba),ta=ra&&ba.fields.find(ia=>"count"===ia.name.toLowerCase()),pa=ra?ba.fields.find(ia=>ia.name.toLowerCase()===ka.toLowerCase()):void 0;if(pa&&ra){ka=pa.name;const ia=
ba.features.length;let da=0;ba.features.forEach(la=>da+=(ta?la.attributes[ta.name]:50)/ia);ba.features.forEach(la=>{const ja=la.attributes[pa.name];la=ta?la.attributes[ta.name]:50;if(0<la){na.push(la);la=Math.max(1,Math.round(la/ia/da*1E3));for(let ea=0;ea<la;ea++)ma.push(ja)}})}else{var {pixelType:qa}=Q;const ia=(ca.max-ca.min)/ca.size,da=(qa=qa.includes("s")||qa.includes("u"))&&1===ia?Math.floor(ca.min+.5):ca.min,la=qa&&1===ia?Math.floor(ca.max-.5):ca.max,ja=ca.size;let ea=0,sa;ca.counts.forEach(ua=>
ea+=ua/ja);ca.counts.forEach((ua,va)=>{if(0<ua)for(na.push(ua),ua=Math.max(1,Math.round(ua/ja/ea*1E3)),sa=ra?ba.features[va].attributes[pa.name]:0===va?da:va===ja-1?la:ca.min+ia*(va+.5),va=0;va<ua;va++)ma.push(sa)})}qa=Y?.classificationMethod||"natural-breaks";let oa=Y?.definedInterval;"defined-interval"!==qa||oa||(oa=A(Q,pa,fa));Q=m.createGenerateRendererClassBreaks({values:ma,valueFrequency:na,normalizationTotal:null,definition:new f({classificationMethod:qa,breakCount:fa,definedInterval:oa})});
let U=Y?.colors;U||(Y=Y?.colorRamp||S,ha.colorRamp=Y,U=l.convertColorRampToColormap(Y,Q.classBreaks.length,!0).map(ia=>ia.slice(1)));Y=Q.classBreaks.map((ia,da)=>new k({minValue:ia.minValue,maxValue:ia.maxValue,label:ia.label,symbol:{type:"simple-fill",color:U[da]}}));return new g({field:ka,classBreakInfos:Y,authoringInfo:ha})};M.createColormapRenderer=v;M.createDefaultRenderer=function(Q,Y){const {attributeTable:ba,colormap:ca}=Q;if(N(Q)){var fa=V(Q);if(I.isSome(fa))return fa}return I.isSome(ca)&&
(fa=v(Q),I.isSome(fa))||I.isSome(ba)&&(fa=h(Q),I.isSome(fa))?fa:u(Q,Y)};M.createFlowRenderer=function(Q){if(!X(Q))return null;let Y;if(I.isSome(Q.statistics)&&0<Q.statistics.length&&("vector-magdir"===Q.dataType||"vector-uv"===Q.dataType)){const {minMagnitude:ba,maxMagnitude:ca}=G(Q.dataType,Q.statistics);Y=[{type:"color",field:"Magnitude",stops:[{value:ba,color:"#1020C0"},{value:ca,color:"#C02010"}]}]}return new J({visualVariables:Y})};M.createShadedReliefRenderer=function(Q,Y="traditional"){if(!E(Q))return null;
({extent:Q}=Q);Q=Q.width*n.getMetersPerUnitForSR(Q.spatialReference);return new F({hillshadeType:Y,scalingType:5E6<Q?"adjusted":"none"})};M.createStretchRenderer=u;M.createUVRenderer=h;M.createVectorFieldRenderer=V;M.estimateMagnitudeRange=G;M.getBandNames=function(Q,Y){const ba=Q.keyProperties&&Q.keyProperties.BandProperties;Y=Y?.length?Y:Array.from(Array(Q.bandCount).keys());return Y.map(ca=>ba&&ba.length===Q.bandCount?ba[ca]&&ba[ca].BandName||"band_"+(ca+1):"band_"+(ca+1))};M.getClassField=q;M.getDefaultBandCombination=
d;M.getDefaultInterpolation=function(Q,Y,ba){const ca=["nearest","bilinear","cubic","majority"].find(fa=>fa===ba?.toLowerCase());return"Map"===Y?ca??"bilinear":"standard-time"===Q.dataType?ca??"nearest":"thematic"===Q.dataType||Q.attributeTable||Q.colormap?"nearest"===ca||"majority"===ca?ca:"nearest":ca??"bilinear"};M.getDefinedInterval=A;M.getField=B;M.getSupportedRendererTypes=function(Q,Y=!1){const ba=["raster-stretch"];x(Q)&&ba.push("raster-colormap");r(Q)&&ba.push("unique-value");t(Q,Y)&&ba.push("class-breaks");
E(Q)&&ba.push("raster-shaded-relief");N(Q)&&ba.push("vector-field");X(Q)&&ba.push("flow");return ba};M.getWellKnownBandIndexes=b;M.isClassBreaksSupported=t;M.isColormapRendererSupported=x;M.isFlowRendererSupported=X;M.isShadedReliefRendererSupported=E;M.isSingleBand8BitRasterWithStats=O;M.isUVRendererSupported=r;M.isVectorFieldRendererSupported=N;M.normalizeRendererJSON=function(Q){if("uniqueValue"===Q.type){var Y=Q.uniqueValueInfos;Y?.[0].symbol?.symbolLayers?.length&&(Q.uniqueValueInfos=Y?.map(ba=>
({value:ba.value,label:ba.label,symbol:ba.symbol?W(ba.symbol):null})));return Q}"classBreaks"===Q.type&&(Y=Q.classBreakInfos,Y[0].symbol?.symbolLayers?.length&&(Q.classBreakInfos=Y.map(ba=>({classMinValue:ba.classMinValue,classMaxValue:ba.classMaxValue,label:ba.label,symbol:ba.symbol?W(ba.symbol):null}))));return Q};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/RasterInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterStorageInfo".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l){var a;H=a=function(f){function m(e){e=f.call(this,e)||this;e.attributeTable=null;e.bandCount=null;e.colormap=null;e.extent=null;e.format=void 0;e.height=null;e.width=null;e.histograms=null;e.keyProperties={};e.multidimensionalInfo=null;e.noDataValue=null;e.pixelSize=null;e.pixelType=null;e.isPseudoSpatialReference=!1;e.spatialReference=null;e.statistics=null;e.storageInfo=null;e.transform=null;return e}M._inheritsLoose(m,f);m.prototype.clone=function(){return new a({attributeTable:I.clone(this.attributeTable),
bandCount:this.bandCount,colormap:I.clone(this.colormap),extent:I.clone(this.extent),nativePixelSize:I.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:I.clone(this.histograms),keyProperties:I.clone(this.keyProperties),multidimensionalInfo:I.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:I.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:I.clone(this.spatialReference),
statistics:I.clone(this.statistics),storageInfo:I.clone(this.storageInfo),transform:I.clone(this.transform)})};M._createClass(m,[{key:"dataType",get:function(){const e=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===e?"standard-time":e}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(e){e&&this._set("nativeExtent",e)}},{key:"nativePixelSize",get:function(){if(n.isNone(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;
const e=this.nativeExtent;return{x:e.width/this.width,y:e.height/this.height}}},{key:"hasMultidimensionalTranspose",get:function(){return!!this.storageInfo?.transposeInfo}}]);return m}(H.JSONSupport);D.__decorate([R.property({json:{write:!0}})],H.prototype,"attributeTable",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"bandCount",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"colormap",void 0);D.__decorate([R.property({type:String,readOnly:!0})],H.prototype,"dataType",
null);D.__decorate([R.property({type:L,json:{write:!0}})],H.prototype,"extent",void 0);D.__decorate([R.property({type:L,json:{write:!0}})],H.prototype,"nativeExtent",null);D.__decorate([R.property({json:{write:!0}})],H.prototype,"nativePixelSize",null);D.__decorate([R.property({json:{write:!0}})],H.prototype,"format",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"height",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"width",void 0);D.__decorate([R.property({json:{write:!0}})],
H.prototype,"hasMultidimensionalTranspose",null);D.__decorate([R.property({json:{write:!0}})],H.prototype,"histograms",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"keyProperties",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"multidimensionalInfo",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"noDataValue",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"pixelSize",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,
"pixelType",void 0);D.__decorate([R.property()],H.prototype,"isPseudoSpatialReference",void 0);D.__decorate([R.property({type:k,json:{write:!0}})],H.prototype,"spatialReference",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"statistics",void 0);D.__decorate([R.property({type:l,json:{write:!0}})],H.prototype,"storageInfo",void 0);D.__decorate([R.property({json:{write:!0}})],H.prototype,"transform",void 0);return H=a=D.__decorate([J.subclass("esri.layers.support.RasterInfo")],H)})},
"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),function(M,D,H,I,n,R,P,J){n=new H.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",
esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});H=new H.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});J=function(L){function k(){var l=L.apply(this,arguments)||this;l.breakCount=null;l.classificationField=null;l.classificationMethod=null;l.normalizationField=null;l.normalizationType=null;l.type="class-breaks-definition";return l}M._inheritsLoose(k,L);M._createClass(k,[{key:"standardDeviationInterval",
set:function(l){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",l)}},{key:"definedInterval",set:function(l){"defined-interval"===this.classificationMethod&&this._set("definedInterval",l)}}]);return k}(J);D.__decorate([I.property({json:{write:!0}})],J.prototype,"breakCount",void 0);D.__decorate([I.property({json:{write:!0}})],J.prototype,"classificationField",void 0);D.__decorate([I.property({type:String,json:{read:n.read,write:n.write}})],J.prototype,"classificationMethod",
void 0);D.__decorate([I.property({json:{write:!0}})],J.prototype,"normalizationField",void 0);D.__decorate([I.property({json:{read:H.read,write:H.write}})],J.prototype,"normalizationType",void 0);D.__decorate([I.property({value:null,json:{write:!0}})],J.prototype,"standardDeviationInterval",null);D.__decorate([I.property({value:null,json:{write:!0}})],J.prototype,"definedInterval",null);D.__decorate([I.property()],J.prototype,"type",void 0);return J=D.__decorate([P.subclass("esri.rest.support.ClassBreaksDefinition")],
J)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),function(M,D,H,I,n,R,P,J,L,k){H=new H.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});
I=function(l){function a(){var f=l.apply(this,arguments)||this;f.baseSymbol=null;f.colorRamp=null;f.type=null;return f}M._inheritsLoose(a,l);return a}(I.JSONSupport);D.__decorate([n.property({type:k,json:{write:!0}})],I.prototype,"baseSymbol",void 0);D.__decorate([n.property({types:L.types,json:{read:{reader:L.fromJSON},write:!0}})],I.prototype,"colorRamp",void 0);D.__decorate([n.property({json:{read:H.read,write:H.write}})],I.prototype,"type",void 0);return I=D.__decorate([J.subclass("esri.rest.support.ClassificationDefinition")],
I)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(M,D){function H(f){const {classificationMethod:m,breakCount:e,normalizationType:p,definedInterval:y}=f.definition,K=[];var F=f.values;if(0===F.length)return[];F=F.sort((b,c)=>b-c);var g=F[0],w=F[F.length-1];if("equal-interval"===m)if(F.length>=e){F=(w-g)/e;f=g;for(var u=1;u<e;u++){var C=Number((g+u*F).toFixed(6));K.push({minValue:f,maxValue:C,label:I(f,C,p)});f=C}K.push({minValue:f,maxValue:w,
label:I(f,w,p)})}else F.forEach(b=>{K.push({minValue:b,maxValue:b,label:I(b,b,p)})});else if("natural-breaks"===m){F=n(F);f=R(F.uniqueValues,f.valueFrequency||F.valueFrequency,e);for(u=1;u<e;u++)F.uniqueValues.length>u&&(C=Number(F.uniqueValues[f[u]].toFixed(6)),K.push({minValue:g,maxValue:C,label:I(g,C,p)}),g=C);K.push({minValue:g,maxValue:w,label:I(g,w,p)})}else if("quantile"===m)if(F.length>=e&&g!==w){f=Math.ceil(F.length/e);u=0;for(C=1;C<e;C++){var d=f+u-1;d>F.length&&(d=F.length-1);0>d&&(d=0);
K.push({minValue:g,maxValue:F[d],label:I(g,F[d],p)});g=F[d];u+=f;f=Math.ceil((F.length-u)/(e-C))}K.push({minValue:g,maxValue:w,label:I(g,w,p)})}else for(w=-1,g=0;g<F.length;g++)f=F[g],f!==w&&(w=f,K.push({minValue:w,maxValue:f,label:I(w,f,p)}),w=f);else if("standard-deviation"===m)if(f=L(F),u=k(F,f),0===u)K.push({minValue:F[0],maxValue:F[0],label:I(F[0],F[0],p)});else{F=J(g,w,e,f,u)*u;u=0;for(C=e;1<=C;C--)d=Number((f-(C-.5)*F).toFixed(6)),K.push({minValue:g,maxValue:d,label:I(g,d,p)}),g=d,u++;C=Number((f+
.5*F).toFixed(6));K.push({minValue:g,maxValue:C,label:I(g,C,p)});g=C;u++;for(d=1;d<=e;d++)C=u===2*e?w:Number((f+(d+.5)*F).toFixed(6)),K.push({minValue:g,maxValue:C,label:I(g,C,p)}),g=C,u++}else if("defined-interval"===m){if(!y)return K;w=F[0];F=F[F.length-1];g=Math.ceil((F-w)/y);f=w;for(u=1;u<g;u++)C=Number((w+u*y).toFixed(6)),K.push({minValue:f,maxValue:C,label:I(f,C,p)}),f=C;K.push({minValue:f,maxValue:F,label:I(f,F,p)})}return K}function I(f,m,e){let p=null;return p=f===m?e&&"percent-of-total"===
e?f+"%":f.toString():e&&"percent-of-total"===e?f+"% - "+m+"%":f+" - "+m}function n(f){const m=[],e=[];let p=Number.MIN_VALUE,y=1,K=-1;for(let F=0;F<f.length;F++){const g=f[F];g===p?(y++,e[K]=y):null!==g&&(m.push(g),p=g,y=1,e.push(y),K++)}return{uniqueValues:m,valueFrequency:e}}function R(f,m,e){var p=f.length;const y=[];e>p&&(e=p);for(var K=0;K<e;K++)y.push(Math.round(K*p/e-1));y.push(p-1);K=P(y,f,m,e);p=K.mean;K=K.sdcm;var F=e,g=0,w=0;let u=0,C=0,d=!0;for(let c=0;2>c&&d;c++){0===c&&(d=!1);for(var b=
0;b<F-1;b++)for(;y[b+1]+1!==y[b+2];)if(y[b+1]+=1,g=l(b,y,f,m),u=g.sbMean,g=g.sbSdcm,w=l(b+1,y,f,m),C=w.sbMean,w=w.sbSdcm,g+w<K[b]+K[b+1])K[b]=g,K[b+1]=w,p[b]=u,p[b+1]=C,d=!0;else{--y[b+1];break}for(b=F-1;0<b;b--)for(;y[b]!==y[b-1]+1;)if(--y[b],g=l(b-1,y,f,m),u=g.sbMean,g=g.sbSdcm,w=l(b,y,f,m),C=w.sbMean,w=w.sbSdcm,g+w<K[b-1]+K[b])K[b-1]=g,K[b]=w,p[b-1]=u,p[b]=C,d=!0;else{y[b]+=1;break}}d&&(K=P(y,f,m,e));return y}function P(f,m,e,p){let y=[];var K=[],F=[];let g=0;const w=[],u=[];for(var C=0;C<p;C++){var d=
l(C,f,m,e);w.push(d.sbMean);u.push(d.sbSdcm);g+=u[C]}d=g;for(C=!0;C||g<d;){C=!1;y=[];for(K=0;K<p;K++)y.push(f[K]);for(F=0;F<p;F++)for(d=f[F]+1;d<=f[F+1];d++)if(K=m[d],0<F&&d!==f[F+1]&&Math.abs(K-w[F])>Math.abs(K-w[F-1]))f[F]=d;else if(F<p-1&&f[F]!==d-1&&Math.abs(K-w[F])>Math.abs(K-w[F+1])){f[F+1]=d-1;break}d=g;g=0;K=[];F=[];for(let b=0;b<p;b++){K.push(w[b]);F.push(u[b]);const c=l(b,f,m,e);w[b]=c.sbMean;u[b]=c.sbSdcm;g+=u[b]}}if(g>d){for(m=0;m<p;m++)f[m]=y[m],w[m]=K[m],u[m]=F[m];g=d}return{mean:w,
sdcm:u}}function J(f,m,e,p,y){f=Math.max(p-f,m-p)/y/e;return 1<=f?1:.5<=f?.5:.25}function L(f){let m=0;for(let e=0;e<f.length;e++)m+=f[e];return m/=f.length}function k(f,m){let e=0;for(let p=0;p<f.length;p++){const y=f[p];e+=(y-m)*(y-m)}e/=f.length;return Math.sqrt(e)}function l(f,m,e,p){var y=0,K=0;for(var F=m[f]+1;F<=m[f+1];F++){const g=p[F];y+=e[F]*g;K+=g}0>=K&&a.warn("Exception in Natural Breaks calculation");y/=K;K=0;for(F=m[f]+1;F<=m[f+1];F++)K+=p[F]*(e[F]-y)**2;return{sbMean:y,sbSdcm:K}}const a=
D.getLogger("esri.rest.support.generateRendererUtils");M.createGenerateRendererClassBreaks=function(f){const {normalizationTotal:m}=f;return{classBreaks:H(f),normalizationTotal:m}};M.createGenerateRendererUniqueValues=function(f){f=n(f);const m=[],e=f.uniqueValues.length;for(let p=0;p<e;p++){const y=f.uniqueValues[p];m.push({value:y,count:f.valueFrequency[p],label:y.toString()})}return{uniqueValues:m}};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e){function p(F,g){const {attributeTable:w,bandCount:u}=F;return R.isNone(w)||1<u||g&&null==w.fields.find(C=>C.name.toLowerCase()===g.toLowerCase())?!1:!0}function y(F){const {bandCount:g,colormap:w}=F;return R.isSome(w)&&0<w.length&&1===g}function K(F){return a.isValidPixelBlock(F)&&0!==F.validPixelCount}I=function(F){function g(u){return F.call(this,u)||this}M._inheritsLoose(g,F);var w=g.prototype;w.bind=function(){const {rendererJSON:u}=this;if(!u)return{success:!1};
this.lookup={rendererJSON:{}};let C;switch(u.type){case "uniqueValue":C=this._updateUVRenderer(u);break;case "rasterColormap":C=this._updateColormapRenderer(u);break;case "rasterStretch":C=this._updateStretchRenderer(u);break;case "classBreaks":C=this._updateClassBreaksRenderer(u);break;case "rasterShadedRelief":C=this._updateShadedReliefRenderer(u);break;case "vectorField":C=this._updateVectorFieldRenderer();break;case "flowRenderer":C=this._updateFlowRenderer()}return C};w.symbolize=function(u){let C=
u&&u.pixelBlock;if(!K(C))return C;if(u.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(C,u.simpleStretchParams);try{3<C.pixels.length&&(C=a.extractBands(C,[0,1,2]));let d;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":d=this._symbolizeColormap(C);break;case "classBreaks":d=this._symbolizeClassBreaks(C);break;case "rasterStretch":d=this._symbolizeStretch(C,u.bandIds);break;case "rasterShadedRelief":const b=u.extent;d=this._symbolizeShadedRelief(C,
{isGCS:b.spatialReference.isGeographic,resolution:{x:(b.xmax-b.xmin)/C.width,y:(b.ymax-b.ymin)/C.height}})}return d}catch(d){return n.getLogger(this.declaredClass).error("symbolize",d.message),C}};w.simpleStretch=function(u,C){if(!K(u))return u;try{return 3<u.pixels.length&&(u=a.extractBands(u,[0,1,2])),f.stretch(u,C)}catch(d){return n.getLogger(this.declaredClass).error("symbolize",d.message),u}};w.generateWebGLParameters=function(u){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:h,
offset:q}=this.lookup.colormapLut||{};return{colormap:h,colormapOffset:q,type:"lut"}}const {pixelBlock:C,isGCS:d,resolution:b,bandIds:c}=u;({rendererJSON:u}=this);return"rasterStretch"===u.type?this._generateStretchWebGLParams(C,u,c):"rasterShadedRelief"===u.type?this._generateShadedReliefWebGLParams(u,d,b):"vectorField"===u.type?this._generateVectorFieldWebGLParams(u):null};w._isLUTChanged=function(u){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const C=
this.rendererJSON.colorRamp;if(u)return JSON.stringify(C)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)};w._symbolizeColormap=function(u){return this._isLUTChanged()&&!this.bind().success?u:a.colorize(u,this.lookup.colormapLut)};w._symbolizeClassBreaks=function(u){const {canUseIndexedLUT:C}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&
!this.bind().success?u:C?a.colorize(u,this.lookup.colormapLut):a.remapColor(u,this.lookup.remapLut??[])};w._symbolizeStretch=function(u,C){const {rasterInfo:d}=this,{pixelType:b,bandCount:c}=d,h=this.rendererJSON;var q=["u8","u16","s8","s16"].includes(b);let z;var {dra:B}=h;({gamma:r}=this.lookup);if("histogramEqualization"===h.stretchType){q=B?null:this.lookup?.histogramLut;C=f.getStretchCutoff(h,{rasterInfo:d,pixelBlock:u,bandIds:C,returnHistogramLut:!q});var r=f.stretch(u,{...C,gamma:r});r=a.lookupPixels(r,
{lut:B?C.histogramLut:q,offset:0})}else if(q){if(B)B=f.getStretchCutoff(h,{rasterInfo:d,pixelBlock:u,bandIds:C}),z=f.createStretchLUT({pixelType:b,...B,gamma:r});else{if(this._isLUTChanged()&&!this.bind().success)return u;z=this.lookup?this.lookup.stretchLut:null}if(!z)return u;1<c&&C?.length===R.unwrap(u)?.pixels.length&&z?.lut.length===c&&(z={lut:C.map(x=>z.lut[x]),offset:z.offset});r=a.lookupPixels(u,z)}else B=f.getStretchCutoff(h,{rasterInfo:d,pixelBlock:u,bandIds:C}),r=f.stretch(u,{...B,gamma:r});
if(h.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return u;r=a.colorize(r,this.lookup?.colormapLut)}return r};w._symbolizeShadedRelief=function(u,C){var d=this.rendererJSON;C=m.hillshade(u,{...d,...C});if(!d.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return C;d=this.lookup?this.lookup.hsvMap:null;if(!d)return C;const b=R.unwrap(this.rasterInfo.statistics)?.[0]??{min:0,max:8E3};m.tintHillshade(C,u,d,b);return C};w._isVectorFieldData=function(){const {bandCount:u,dataType:C}=
this.rasterInfo;return 2===u&&("vector-magdir"===C||"vector-uv"===C)};w._updateVectorFieldRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}};w._updateFlowRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}};
w._updateUVRenderer=function(u){const {bandCount:C,attributeTable:d,pixelType:b}=this.rasterInfo,c=u.field1;if(!c)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const h=u.defaultSymbol;var q=1===C&&["u8","s8"].includes(b);if(!p(this.rasterInfo,c)&&!q)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const z=[];if(R.isSome(d)){const B=d.fields.find(r=>"value"===r.name.toLowerCase());
if(!B)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};d.features.forEach(r=>{const x=u.uniqueValueInfos?.find(v=>String(v.value)===String(r.attributes[c]))?.symbol?.color;x?z.push([r.attributes[B.name]].concat(x)):h&&z.push([r.attributes[B.name]].concat(h.color))})}else{if("value"!==c.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};u.uniqueValueInfos?.forEach(B=>
{const r=B?.symbol?.color;r?z.push([parseInt(""+B.value,10)].concat(r)):h&&z.push([parseInt(""+B.value,10)].concat(h?.color))})}if(0===z.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};q=a.createColormapLUT({colormap:z});this.lookup={rendererJSON:u,colormapLut:q};this.canRenderInWebGL=!0;return{success:!0}};w._updateColormapRenderer=function(u){if(!y(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};
var C=u.colormapInfos.map(d=>[d.value].concat(d.color)).sort((d,b)=>d[0]-b[0]);if(!C||0===C.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};C=a.createColormapLUT({colormap:C});this.lookup={rendererJSON:u,colormapLut:C};this.canRenderInWebGL=!0;return{success:!0}};w._updateShadedReliefRenderer=function(u){const {bandCount:C,dataType:d,pixelType:b}=this.rasterInfo;if("elevation"!==d&&("generic"!==d||1!==C||"s16"!==b&&"f32"!==b&&"f64"!==b))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(u.colorRamp){var c=e.convertColorRampToColormap(u.colorRamp,256,!0);c=a.createColormapLUT({colormap:c});const h=[],q=c.indexedColormap;for(let z=0;z<q.length;z+=4){const B=H.toHSV({r:q[z],g:q[z+1],b:q[z+2]});h.push([B.h/60,B.s/100,255*B.v/100])}this.lookup={rendererJSON:u,colormapLut:c,hsvMap:h}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}};
w._analyzeClassBreaks=function(u){const {attributeTable:C,pixelType:d}=this.rasterInfo,b=R.isSome(C)?C.fields.find(q=>"value"===q.name.toLowerCase()):null,c=R.isSome(C)?C.fields.find(q=>q.name.toLowerCase()===u.field.toLowerCase()):null,h=null!=b&&null!==c;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(d)||h,tableValueField:b,tableBreakField:c}};w._updateClassBreaksRenderer=function(u){var {attributeTable:C}=this.rasterInfo;const {canUseIndexedLUT:d,tableValueField:b,tableBreakField:c}=
this._analyzeClassBreaks(u);var h=u.classBreakInfos;if(!h?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};h=h.sort((x,v)=>x.classMaxValue-v.classMaxValue);var q=h[h.length-1],z=u.minValue;if(!d){var B=[];for(var r=0;r<h.length;r++)B.push({value:h[r].classMinValue??z,mappedColor:h[r].symbol.color}),z=h[r].classMaxValue;B.push({value:q.classMaxValue,mappedColor:q.symbol.color});this.lookup={rendererJSON:u,remapLut:B};this.canRenderInWebGL=
!1;return{success:!0}}B=[];if(R.isSome(C)&&null!=b&&null!==c&&b!==c){q=b.name;const x=c.name,v=h[h.length-1],{classMaxValue:E}=v;z=u.minValue;for(r of C.features){C=r.attributes[q];const t=r.attributes[x],A=t===E?v:t<z?null:h.find(({classMaxValue:O})=>O>t);A&&B.push([C].concat(A.symbol.color))}}else{z=Math.floor(u.minValue);for(r=0;r<h.length;r++){for(C=h[r];z<C.classMaxValue;z++)B.push([z].concat(C.symbol.color));z=Math.ceil(C.classMaxValue)}q.classMaxValue===z&&B.push([q.classMaxValue].concat(q.symbol.color))}h=
a.createColormapLUT({colormap:B,fillUnspecified:!1});this.lookup={rendererJSON:u,colormapLut:h};this.canRenderInWebGL=!0;return{success:!0}};w._isHistogramRequired=function(u){return"percentClip"===u||"histogramEqualization"===u};w._isValidRasterStatistics=function(u){return R.isSome(u)&&0<u.length&&null!=u[0].min&&null!=u[0].max};w._updateStretchRenderer=function(u){let {stretchType:C,dra:d}=u;if(!("none"===C||u.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||d))return{success:!1,
error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var b=R.unwrap(u.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(u.stretchType)||b?.length||d||(C="minMax");const {computeGamma:c,useGamma:h,colorRamp:q}=u;var {gamma:z}=u;h&&c&&!z?.length&&(z=u.statistics?.length?u.statistics:R.unwrap(this.rasterInfo.statistics),z=f.computeGammaValues(this.rasterInfo.pixelType,z));const B=this.rasterInfo.pixelType,r=!d&&["u8","u16",
"s8","s16"].includes(B);"histogramEqualization"===C?(b=b.map(x=>f.createHistogramEqualizationLUT(x)),this.lookup={rendererJSON:u,histogramLut:b}):r&&(b=f.getStretchCutoff(u,{rasterInfo:this.rasterInfo}),b=f.createStretchLUT({pixelType:B,...b,gamma:h?z:null}),this.lookup={rendererJSON:u,stretchLut:b});q&&(b=e.convertColorRampToColormap(q,256,!0),this.lookup||(this.lookup={rendererJSON:u}),this.lookup.colormapLut=a.createColormapLUT({colormap:b}),this.lookup.rendererJSON=u);this.lookup.gamma=h&&z?.length?
z:null;this.canRenderInWebGL=!0;return{success:!0}};w._generateStretchWebGLParams=function(u,C,d){let b=null,c=null;var h=this.lookup&&this.lookup.colormapLut;C.colorRamp&&h&&(b=h.indexedColormap,c=h.offset);"histogramEqualization"===C.stretchType&&(C={...C,stretchType:"minMax"});({gamma:h}=this.lookup);const q=!!(C.useGamma&&h&&h.some(A=>1!==A)),{minCutOff:z,maxCutOff:B,outMin:r,outMax:x}=f.getStretchCutoff(C,{rasterInfo:this.rasterInfo,pixelBlock:u,bandIds:d});var v=0;R.isSome(u)&&(v=u.getPlaneCount(),
2===v&&(u=u.clone(),u.statistics=[u.statistics[0]],u.pixels=[u.pixels[0]]));u=Math.min(3,d?.length||v||this.rasterInfo.bandCount);d=new Float32Array(u);v=b||q?1:255;let E;for(E=0;E<u;E++)d[E]=(x-r)/(B[E]-z[E])/v;const t=new Float32Array(u);if(q)for(E=0;E<u;E++)t[E]=1<h[E]?2<h[E]?6.5+(h[E]-2)**2.5:6.5+100*(2-h[E])**4:1;return{bandCount:u,outMin:r/v,outMax:x/v,minCutOff:z,maxCutOff:B,factor:d,useGamma:q,gamma:q?h:[1,1,1],gammaCorrection:q?t:[1,1,1],colormap:b,colormapOffset:c,stretchType:C.stretchType,
type:"stretch"}};w._generateShadedReliefWebGLParams=function(u,C=!1,d={x:0,y:0}){let b=null,c=null;const h=this.lookup&&this.lookup.colormapLut;u.colorRamp&&h&&(b=h.indexedColormap,c=h.offset);C=m.calculateHillshadeParams({...u,isGCS:C,resolution:d});d=R.unwrap(this.rasterInfo.statistics)?.[0];return{...C,minValue:d?.min??0,maxValue:d?.max??8E3,hillshadeType:"traditional"===u.hillshadeType?0:1,type:"hillshade",colormap:b,colormapOffset:c}};w._generateVectorFieldWebGLParams=function(u){const {style:C,
inputUnit:d,outputUnit:b,visualVariables:c,symbolTileSize:h,flowRepresentation:q}=u;let z;var B=this.rasterInfo.statistics?.[0].min??0,r=this.rasterInfo.statistics?.[0].max??50,x=c?.find(t=>"sizeInfo"===t.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:r,maxSize:.8*h,minDataValue:B,minSize:.2*h},v=x.minDataValue??B,E=x.maxDataValue??r;r=R.isSome(x.maxSize)&&R.isSome(x.minSize)?[x.minSize/h,x.maxSize/h]:[.2,.8];"wind_speed"===C&&(r[0]=r[1]=(r[0]+r[1])/2);B=R.isSome(v)&&R.isSome(E)?[v,E]:null;
if("classified_arrow"===C)if(R.isSome(v)&&R.isSome(E)&&R.isSome(x))for(z=[],v=(x.maxDataValue-x.minDataValue)/5,E=0;6>E;E++)z.push(x.minDataValue+v*E);else z=[0,1E-6,3.5,7,10.5,14];x="flow_to"===q===("ocean_current_kn"===C||"ocean_current_m"===C)?0:Math.PI;v=c?.find(t=>"rotationInfo"===t.type);return{breakValues:z,dataRange:B,inputUnit:d,outputUnit:b,symbolTileSize:h,symbolPercentRange:r,style:C||"single_arrow",rotation:x,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?
"geographic":v?.rotationType||u.rotationType,type:"vectorField"}};return g}(I.JSONSupport);D.__decorate([P.property({json:{write:!0}})],I.prototype,"rendererJSON",void 0);D.__decorate([P.property({type:l,json:{write:!0}})],I.prototype,"rasterInfo",void 0);D.__decorate([P.property({json:{write:!0}})],I.prototype,"lookup",void 0);D.__decorate([P.property()],I.prototype,"canRenderInWebGL",void 0);return I=D.__decorate([k.subclass("esri.renderers.support.RasterSymbolizer")],I)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l){function a(){a=D._asyncToGenerator(function*(b,c,h,q){const z=performance.now();var B=f(c,h);const r=performance.now();h=e(c,B,h.width,h.height);c=performance.now();B=y(h,!0);h=performance.now();b="Streamlines"===b?K(B,10):F(B);B=performance.now();I("esri-2d-profiler")&&(d.info("I.1","_createFlowFieldFromData (ms)",Math.round(r-z)),d.info("I.2","_getStreamlines (ms)",Math.round(c-r)),d.info("I.3","createAnimatedLinesData (ms)",Math.round(h-c)),d.info("I.4","create{Streamlines|Particles}Mesh (ms)",
Math.round(B-h)),d.info("I.5","createFlowMesh (ms)",Math.round(B-z)),d.info("I.6","Mesh size (bytes)",b.vertexData.buffer.byteLength+b.indexData.buffer.byteLength));yield Promise.resolve();J.throwIfAborted(q);return b});return a.apply(this,arguments)}function f(b,c){const h=p(c.data,c.width,c.height,b.smoothing);return b.interpolate?(q,z)=>{const B=Math.floor(q),r=Math.floor(z);if(0>B||B>=c.width||0>r||r>=c.height)return[0,0];q-=B;z-=r;const x=B<c.width-1?B+1:B,v=r<c.height-1?r+1:r;return[(h[2*(r*
c.width+B)]*(1-z)+h[2*(v*c.width+B)]*z)*(1-q)+(h[2*(r*c.width+x)]*(1-z)+h[2*(v*c.width+x)]*z)*q,(h[2*(r*c.width+B)+1]*(1-z)+h[2*(v*c.width+B)+1]*z)*(1-q)+(h[2*(r*c.width+x)+1]*(1-z)+h[2*(v*c.width+x)+1]*z)*q]}:(q,z)=>{q=Math.round(q);z=Math.round(z);return 0>q||q>=c.width||0>z||z>=c.height?[0,0]:[h[2*(z*c.width+q)],h[2*(z*c.width+q)+1]]}}function m(b,c,h,q,z,B,r,x,v){const E=[];let t=0,[A,O]=c(h,q);A*=b.velocityScale;O*=b.velocityScale;E.push({x:h,y:q,t,speed:Math.sqrt(A*A+O*O)});for(let V=0;V<b.verticesPerLine;V++){let [W,
G]=c(h,q);W*=b.velocityScale;G*=b.velocityScale;const S=Math.sqrt(W*W+G*G);if(S<b.minSpeedThreshold)break;const T=W/S,aa=G/S;h+=T*b.segmentLength;q+=aa*b.segmentLength;t+=b.segmentLength/S;if(Math.acos(T*N+aa*X)>b.maxTurnAngle)break;if(b.collisions){var N=Math.round(h*v);var X=Math.round(q*v);if(0>N||N>r-1||0>X||X>x-1)break;const Z=B[X*r+N];if(-1!==Z&&Z!==z)break;B[X*r+N]=z}E.push({x:h,y:q,t,speed:S});N=T;X=aa}return E}function e(b,c,h,q){const z=[],B=new L,r=1/Math.max(b.lineCollisionWidth,1),x=
Math.round(h*r),v=Math.round(q*r),E=new Int32Array(x*v);for(var t=0;t<E.length;t++)E[t]=-1;t=[];for(let A=0;A<q;A+=b.lineSpacing)for(let O=0;O<h;O+=b.lineSpacing)t.push({x:O,y:A,sort:B.getFloat()});t.sort((A,O)=>A.sort-O.sort);for(const {x:A,y:O}of t)B.getFloat()<b.density&&(h=m(b,c,A,O,z.length,E,x,v,r),2>h.length||z.push(h));return z}function p(b,c,h,q){if(0===q)return b;const z=Math.round(3*q),B=Array(2*z+1);var r=0;for(var x=-z;x<=z;x++){var v=Math.exp(-x*x/(q*q));B[x+z]=v;r+=v}for(q=-z;q<=z;q++)B[q+
z]/=r;r=new Float32Array(b.length);for(q=0;q<h;q++)for(x=0;x<c;x++){var E=v=0;for(var t=-z;t<=z;t++)if(!(0>x+t||x+t>=c)){var A=B[t+z];v+=A*b[2*(q*c+(x+t))];E+=A*b[2*(q*c+(x+t))+1]}r[2*(q*c+x)]=v;r[2*(q*c+x)+1]=E}b=new Float32Array(b.length);for(q=0;q<c;q++)for(x=0;x<h;x++){E=v=0;for(t=-z;t<=z;t++)0>x+t||x+t>=h||(A=B[t+z],v+=A*r[2*((x+t)*c+q)],E+=A*r[2*((x+t)*c+q)+1]);b[2*(x*c+q)]=v;b[2*(x*c+q)+1]=E}return b}function y(b,c){const h=new L;var q=b.reduce((x,v)=>x+v.length,0);q=new Float32Array(4*q);
const z=Array(b.length);let B=0,r=0;for(const x of b){b=B;for(const v of x)q[4*B]=v.x,q[4*B+1]=v.y,q[4*B+2]=v.t,q[4*B+3]=v.speed,B++;z[r++]={startVertex:b,numberOfVertices:x.length,totalTime:x[x.length-1].t,timeSeed:c?h.getFloat():0}}return{lineVertices:q,lineDescriptors:z}}function K(b,c){function h(N,X,V,W,G,S,T,aa){const Z=9*v;let Q=0;x[Z+Q++]=N;x[Z+Q++]=X;x[Z+Q++]=1;x[Z+Q++]=V;x[Z+Q++]=S;x[Z+Q++]=T;x[Z+Q++]=W/2;x[Z+Q++]=G/2;x[Z+Q++]=aa;v++;x[Z+Q++]=N;x[Z+Q++]=X;x[Z+Q++]=-1;x[Z+Q++]=V;x[Z+Q++]=
S;x[Z+Q++]=T;x[Z+Q++]=-W/2;x[Z+Q++]=-G/2;x[Z+Q++]=aa;v++}const {lineVertices:q,lineDescriptors:z}=b;var B=b=0;for(var r of z)b+=2*r.numberOfVertices,B+=6*(r.numberOfVertices-1);const x=new Float32Array(9*b);r=new Uint32Array(B);let v=0;b=0;for(const N of z){const {totalTime:X,timeSeed:V}=N;let W=B=null,G=null;var E=null,t=null,A=null;for(let S=0;S<N.numberOfVertices;S++){E=q[4*(N.startVertex+S)];const T=q[4*(N.startVertex+S)+1],aa=q[4*(N.startVertex+S)+2],Z=q[4*(N.startVertex+S)+3];let Q=null,Y=null;
var O=null;let ba=null;0<S&&(Q=E-B,Y=T-W,O=Math.sqrt(Q*Q+Y*Y),Q/=O,Y/=O,1<S?(t=Q+t,A=Y+A,O=Math.sqrt(t*t+A*A),t/=O,A/=O,O=Math.min(1/(t*Q+A*Y),c),t*=O,A*=O,O=-A,ba=t):(O=-Y,ba=Q),null!==O&&null!==ba&&(h(B,W,G,O,ba,X,V,Z),r[b++]=v-2,r[b++]=v,r[b++]=v-1,r[b++]=v,r[b++]=v+1,r[b++]=v-1));B=E;W=T;G=aa;t=Q;A=Y;E=Z}h(B,W,G,-A,t,X,V,E)}return{vertexData:x,indexData:r}}function F(b){function c(fa,ha){var ka=aa+Q,ma=Z+Y,na=Math.sqrt(ka*ka+ma*ma);ka/=na;ma/=na;var ra=aa*ka+Z*ma,ta=Q+ba,pa=Y+ca;na=Math.sqrt(ta*
ta+pa*pa);ta/=na;pa/=na;var qa=Q*ta+Y*pa;na=O;var oa=N,U=X,ia=V;ma=-(ma/ra);ka/=ra;ra=W;var da=G,la=S,ja=T;pa=-(pa/qa);ta/=qa;qa=16*t;let ea=0;for(const sa of[1,2])for(const ua of[1,2,3,4])v[qa+ea++]=na,v[qa+ea++]=oa,v[qa+ea++]=U,v[qa+ea++]=ia,v[qa+ea++]=ra,v[qa+ea++]=da,v[qa+ea++]=la,v[qa+ea++]=ja,v[qa+ea++]=sa,v[qa+ea++]=ua,v[qa+ea++]=fa,v[qa+ea++]=ha,v[qa+ea++]=ma/2,v[qa+ea++]=ka/2,v[qa+ea++]=pa/2,v[qa+ea++]=ta/2,t++;E[A++]=t-8;E[A++]=t-7;E[A++]=t-6;E[A++]=t-7;E[A++]=t-5;E[A++]=t-6;E[A++]=t-4;
E[A++]=t-3;E[A++]=t-2;E[A++]=t-3;E[A++]=t-1;E[A++]=t-2}function h(fa,ha,ka,ma,na,ra){aa=Q;Z=Y;Q=ba;Y=ca;null==aa&&null==Z&&(aa=Q,Z=Y);if(null!=W&&null!=G){ba=fa-W;ca=ha-G;const ta=Math.sqrt(ba*ba+ca*ca);ba/=ta;ca/=ta}null!=aa&&null!=Z&&c(na,ra);O=W;N=G;X=S;V=T;W=fa;G=ha;S=ka;T=ma}function q(fa,ha){aa=Q;Z=Y;Q=ba;Y=ca;null==aa&&null==Z&&(aa=Q,Z=Y);null!=aa&&null!=Z&&c(fa,ha)}const {lineVertices:z,lineDescriptors:B}=b;let r=b=0;for(var x of B){const fa=x.numberOfVertices-1;b+=8*fa;r+=12*fa}const v=new Float32Array(16*
b),E=new Uint32Array(r);let t=0,A=0,O,N,X,V,W,G,S,T,aa,Z,Q,Y,ba,ca;for(const fa of B){ca=ba=Y=Q=Z=aa=T=S=G=W=V=X=N=O=null;const {totalTime:ha,timeSeed:ka}=fa;for(x=0;x<fa.numberOfVertices;x++)h(z[4*(fa.startVertex+x)],z[4*(fa.startVertex+x)+1],z[4*(fa.startVertex+x)+2],z[4*(fa.startVertex+x)+3],ha,ka);q(ha,ka)}return{vertexData:v,indexData:E}}function g(b,c){const h=c.pixels,{width:q,height:z}=c,B=new Float32Array(q*z*2),r=c.mask||new Uint8Array(q*z*2);c.mask||r.fill(255);if("vector-uv"===b)for(b=
0;b<q*z;b++)B[2*b]=h[0][b],B[2*b+1]=-h[1][b];else if("vector-magdir"===b)for(b=0;b<q*z;b++){c=h[0][b];const x=R.deg2rad(h[1][b]),v=Math.sin(x-Math.PI/2);B[2*b]=Math.cos(x-Math.PI/2)*c;B[2*b+1]=v*c}return{data:B,mask:r,width:q,height:z}}function w(){w=D._asyncToGenerator(function*(b,c,h,q,z,B){const r=performance.now();var x=k.getInfo(c.spatialReference);if(!x)return h=yield u(b,c,h,q,z,B),I("esri-2d-profiler")&&d.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-r)),I("esri-2d-profiler")&&
d.info("I.9","Number of parts",1),h;const [v,E]=x.valid,t=Math.ceil(c.width/(E-v)),A=c.width/t,O=Math.round(h/t);let N=c.xmin;const X=[];x=performance.now();for(let V=0;V<t;V++){const W=new l({xmin:N,xmax:N+A,ymin:c.ymin,ymax:c.ymax,spatialReference:c.spatialReference});X.push(u(b,W,O,q,z,B));N+=A}b=yield Promise.all(X);I("esri-2d-profiler")&&d.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-x));I("esri-2d-profiler")&&d.info("I.9","Number of parts",b.length);q={data:new Float32Array(h*
q*2),mask:new Uint8Array(h*q),width:h,height:q};c=0;for(const V of b){for(b=0;b<V.height;b++)for(z=0;z<V.width;z++)c+z>=h||(q.data[2*(b*h+c+z)]=V.data[2*(b*V.width+z)],q.data[2*(b*h+c+z)+1]=V.data[2*(b*V.width+z)+1],q.mask[b*h+c+z]=V.mask[b*V.width+z]);c+=V.width}I("esri-2d-profiler")&&d.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-r));return q});return w.apply(this,arguments)}function u(b,c,h,q,z,B){return C.apply(this,arguments)}function C(){C=D._asyncToGenerator(function*(b,
c,h,q,z,B){const r={requestProjectedLocalDirections:!0,signal:B};P.isSome(z)&&(r.timeExtent=z);if("imagery"===b.type)return yield b.load({signal:B}),z=b.rasterInfo.dataType,b=yield b.fetchImage(c,h,q,r),!b||P.isNone(b.pixelData)||P.isNone(b.pixelData.pixelBlock)?{data:new Float32Array(h*q*2),mask:new Uint8Array(h*q),width:h,height:q}:g(z,b.pixelData.pixelBlock);yield b.load({signal:B});z=b.rasterInfo.dataType;b=yield b.fetchPixels(c,h,q,r);return!b||P.isNone(b.pixelBlock)?{data:new Float32Array(h*
q*2),mask:new Uint8Array(h*q),width:h,height:q}:g(z,b.pixelBlock)});return C.apply(this,arguments)}const d=n.getLogger("esri.views.2d.engine.flow.dataUtils");M.createAnimatedLinesData=y;M.createFlowMesh=function(b,c,h,q){return a.apply(this,arguments)};M.createParticlesMesh=F;M.createStreamlinesMesh=K;M.loadImagery=function(b,c,h,q,z,B){return w.apply(this,arguments)};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterEnums":function(){define(["exports",
"../../core/jsonMap"],function(M,D){const H=D.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"});D=D.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});M.interpolationKebab=H;M.noDataInterpretationKebab=D;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),
function(M,D,H,I,n,R,P){const J=new Map;J.set("CRF",{desc:"Cloud Raster Format",constructor:H});J.set("MRF",{desc:"Meta Raster Format",constructor:R});J.set("TIFF",{desc:"GeoTIFF",constructor:P});J.set("RasterTileServer",{desc:"Raster Tile Server",constructor:n});J.set("JPG",{desc:"JPG Raster Format",constructor:I});J.set("PNG",{desc:"PNG Raster Format",constructor:I});J.set("GIF",{desc:"GIF Raster Format",constructor:I});J.set("BMP",{desc:"BMP Raster Format",constructor:I});return function(){function L(){}
L.open=function(){var k=M._asyncToGenerator(function*(l){const {url:a,ioConfig:f,sourceJSON:m}=l;let e=l.datasetFormat;null==e&&a.lastIndexOf(".")&&(e=a.slice(a.lastIndexOf(".")+1).toUpperCase());if("OVR"===e||"TIF"===e)e="TIFF";else if("JPG"===e||"JPEG"===e||"JFIF"===e)e="JPG";a.toLowerCase().includes("/imageserver")&&!a.toLowerCase().includes("/wcsserver")&&(e="RasterTileServer");const p={bandIds:null,sampling:null},y={url:a,sourceJSON:m,datasetFormat:e,ioConfig:f??p};let K,F;if(e&&this.supportedFormats.has(e)){if("CRF"===
e&&!f?.enableCRF)throw new D("rasterfactory:open",`cannot open raster: ${a}`);K=J.get(e).constructor;F=new K(y);yield F.open({signal:l.signal});return F}if(e)throw new D("rasterfactory:open","not a supported format "+e);const g=Array.from(J.keys());let w=0;const u=()=>{e=g[w++];if(!e||"CRF"===e&&!f?.enableCRF)return null;K=J.get(e).constructor;F=new K(y);return F.open({signal:l.signal}).then(()=>F).catch(()=>u())};return u()});return function(l){return k.apply(this,arguments)}}();L.register=function(k,
l,a){J.has(k.toUpperCase())||J.set(k.toUpperCase(),{desc:l,constructor:a})};M._createClass(L,null,[{key:"supportedFormats",get:function(){const k=new Set;J.forEach((l,a)=>k.add(a));return k}}]);return L}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F){const g=new Map;g.set("int16","esriFieldTypeSmallInteger");g.set("int32","esriFieldTypeInteger");g.set("int64","esriFieldTypeInteger");g.set("float32","esriFieldTypeSingle");g.set("float64","esriFieldTypeDouble");g.set("text","esriFieldTypeString");H=function(w){function u(){var d=w.apply(this,arguments)||this;d.storageInfo=null;d.datasetFormat="CRF";return d}M._inheritsLoose(u,w);var C=u.prototype;C.open=function(){var d=M._asyncToGenerator(function*(b){yield this.init();
({data:b}=yield this.request(this.url+"/conf.json",{signal:b?.signal}));if(!this._validateHeader(b))throw new I("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:c,rasterInfo:h}=this._parseHeader(b);"thematic"===h.dataType&&(b=yield this._fetchAuxiliaryInformation(),h.attributeTable=b);this._set("storageInfo",c);this._set("rasterInfo",h);this.ioConfig.retryCount=this.ioConfig.retryCount||0});return function(b){return d.apply(this,
arguments)}}();C.fetchRawTile=function(){var d=M._asyncToGenerator(function*(b,c,h,q={}){var {transposeInfo:z}=this.rasterInfo.storageInfo,{transposedVariableName:B}=q;b=(z=!(!z||!B))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-b;if(0>b)return null;B=this._buildCacheFilePath(b,c,h,q.multidimensionalDefinition,B);c=this._getIndexRecordFromBundle(c,h,z);h=yield this.request(B,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:q.signal});if(!h)return null;h=new Uint8Array(h.data);
c=this._getTileEndAndContentType(h,c);if(0===c.recordSize)return null;q=yield this.request(B,{range:{from:c.position,to:c.position+c.recordSize},responseType:"array-buffer",signal:q.signal});if(!q)return null;const [r,x]=this._getTileSize(z);return this.decodePixelBlock(q.data,{width:r,height:x,planes:null,pixelType:null,returnInterleaved:z})});return function(b,c,h){return d.apply(this,arguments)}}();C._validateHeader=function(d){const b="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");
return d&&"RasterInfo"===d.type&&!b.some(c=>!d[c])};C._parseHeader=function(d){var b="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[d.pixelType];const {bandCount:c,histograms:h,colormap:q,blockWidth:z,blockHeight:B,firstPyramidLevel:r,maximumPyramidLevel:x}=d,v=d.statistics&&d.statistics.map(ba=>({min:ba.min,max:ba.max,avg:ba.mean,stddev:ba.standardDeviation,median:ba.median,mode:ba.mode}));var E=d.extent.spatialReference,t=d.geodataXform?.spatialReference;E=new y(E?.wkid||E?.wkt?E:t);t=new K({xmin:d.extent.xmin,
ymin:d.extent.ymin,xmax:d.extent.xmax,ymax:d.extent.ymax,spatialReference:E});const A=new F({x:d.pixelSizeX,y:d.pixelSizeY,spatialReference:E}),O=Math.round((t.xmax-t.xmin)/A.x),N=Math.round((t.ymax-t.ymin)/A.y),X=this._parseTransform(d.geodataXform),V=X?t:null;X&&(t=X.forwardTransform(t),A.x=(t.xmax-t.xmin)/O,A.y=(t.ymax-t.ymin)/N);const W=d.properties??{};var G=d.format.toLowerCase().replace("cache/","");const S=new F(d.origin.x,d.origin.y,E);let T;var aa;if(q&&q.colors)for(T=[],aa=0;aa<q.colors.length;aa++){var Z=
q.colors[aa];var Q=q.values?q.values[aa]:aa;T.push([Q,Z&255,Z<<16>>>24,Z<<8>>>24,Z>>>24])}Z=d.LODInfos;Q=[];for(aa=0;aa<Z.levels.length;aa++)Q.push({level:Z.levels[aa],resolution:Z.resolutions[aa],scale:96/.0254*Z.resolutions[aa]});Z=new a({dpi:96,lods:Q,format:G,origin:S,size:[z,B],spatialReference:E});G={recordSize:8,packetSize:d.packetSize,headerSize:d.packetSize*d.packetSize*8+64};Q=[{maxCol:Math.ceil(O/z)-1,maxRow:Math.ceil(N/B)-1,minCol:0,minRow:0}];let Y=2;if(0<x)for(aa=0;aa<x;aa++)Q.push({maxCol:Math.ceil(O/
Y/z)-1,maxRow:Math.ceil(N/Y/B)-1,minCol:0,minRow:0}),Y*=2;d=d.mdInfo;aa=null;d&&W._yxs&&(aa=W._yxs,aa={packetSize:aa.PacketSize,tileSize:[aa.TileXSize,aa.TileYSize]});b=new k({width:O,height:N,pixelType:b,bandCount:c,extent:t,nativeExtent:V,transform:X,spatialReference:E,pixelSize:A,keyProperties:W,statistics:v,histograms:h,multidimensionalInfo:d,colormap:T,storageInfo:new l({blockWidth:z,blockHeight:B,pyramidBlockWidth:z,pyramidBlockHeight:B,origin:S,tileInfo:Z,transposeInfo:aa,firstPyramidLevel:r,
maximumPyramidLevel:x,blockBoundary:Q})});return{storageInfo:G,rasterInfo:b}};C._parseTransform=function(d){if(!e.isTransformSupported(d))throw new I("cloudraster:open","the data contains unsupported geodata transform types");d=e.readTransform(d);if("identity"===d.type)return null;if("polynomial"!==d.type||!d.forwardCoefficients?.length||!d.inverseCoefficients?.length)throw new I("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");
return d};C._fetchAuxiliaryInformation=function(){var d=M._asyncToGenerator(function*(b){var c=this.request(this.url+"/conf.vat.json",{signal:b}).then(q=>q.data).catch(()=>null);b=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:b}).then(q=>q.data).catch(()=>null);c=yield Promise.all([c,b]);let h;if(c[0]){b=c[0].fields;const q=c[0].values;if(b&&q){b=b.map(B=>({type:"OID"===B.name?"esriFieldTypeOID":g.get(B.type),name:B.name,alias:B.alias||B.name}));const z=q.map(B=>({attributes:B}));
b&&q&&(h={fields:b,features:z})}}!h&&c[1]&&(h=m.parse(c[1]).recordSet);return p.fromJSON(h)});return function(b){return d.apply(this,arguments)}}();C._buildCacheFilePath=function(d,b,c,h,q){var z=this._getPackageSize(!!q);c=Math.floor(c/z)*z;b="R"+this._toHexString4(Math.floor(b/z)*z)+"C"+this._toHexString4(c);z="L";z=10<=d?z+d.toString():z+("0"+d.toString());({multidimensionalInfo:d}=this.rasterInfo);const B=h?.[0];if(n.isNone(d)||!B)return`${this.url}/_alllayers/${z}/${b}.bundle`;h="_yxs";if(!q){h=
d.variables.find(r=>r.name===B.variableName).dimensions[0].values.indexOf(B.values[0]).toString(16);d=4-h.length;for(c=0;c<d;c++)h="0"+h;h="S"+h}q=this._getVariableFolderName(q||B.variableName);return`${this.url}/_alllayers/${q}/${h}/${z}/${b}.bundle`};C._getPackageSize=function(d=!1){const {transposeInfo:b}=this.rasterInfo.storageInfo;return d&&n.isSome(b)?b.packetSize??0:this.storageInfo.packetSize};C._getTileSize=function(d=!1){const {storageInfo:b}=this.rasterInfo,{transposeInfo:c}=b;return d&&
n.isSome(c)?c.tileSize:b.tileInfo.size};C._getVariableFolderName=function(d){d=d.trim();return""===d?"_v":d.replace(/[\{|\}\-]/g,"_").replace("\\*","_v")};C._getIndexRecordFromBundle=function(d,b,c=!1){c=this._getPackageSize(c);d=d%c*c+b%c;if(0>d)throw"Invalid level / row / col";return d*this.storageInfo.recordSize+64};C._getTileEndAndContentType=function(d,b){d=d.subarray(b,b+8);b=0;let c;for(c=0;5>c;c++)b|=(d[c]&255)<<8*c;const h=b&0xffffffffff;b=0;for(c=5;8>c;c++)b|=(d[c]&255)<<8*(c-5);return{position:h,
recordSize:b&0xffffffffff}};C._toHexString4=function(d){d=d.toString(16);if(4!==d.length){let b=4-d.length;for(;0<b--;)d="0"+d}return d};return u}(f);D.__decorate([R.property({readOnly:!0})],H.prototype,"storageInfo",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=D.__decorate([L.subclass("esri.layers.support.rasterDatasets.CloudRaster")],H)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"./byteStreamUtils"],function(M,D){function H(I){var n=I.fields;I=I.records;const R=n.some(l=>"oid"===l.name.toLowerCase())?"OBJECTID":"OID";n=[{name:R,type:"esriFieldTypeOID",alias:"OID"}].concat(n.map(l=>({name:l.name,type:"esriFieldType"+l.typeName,alias:l.name})));const P=n.map(l=>l.name),J=[];let L=0,k=0;I.forEach(l=>{const a={};a[R]=L++;for(k=1;k<P.length;k++)a[P[k]]=l[k-1];J.push({attributes:a})});return{displayFieldName:"",fields:n,features:J}}return function(){function I(){}I.parse=function(n){var R=
new DataView(n),P=R.getUint8(0)&3;if(3!==P)return{header:{version:P},recordSet:null};const J=R.getUint32(4,!0);var L=R.getUint16(8,!0);const k=R.getUint16(10,!0);L={version:P,recordCount:J,headerByteCount:L,recordByteCount:k};let l=32;const a=[],f=[];if(3===P){for(;13!==R.getUint8(l);)P=String.fromCharCode(R.getUint8(l+11)).trim(),a.push({name:D.bytesToUTF8(new Uint8Array(n,l,11)),type:P,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(P)],length:R.getUint8(l+
16)}),l+=32;l+=1;if(0<a.length)for(;f.length<J&&n.byteLength-l>k;){const m=[];32===R.getUint8(l)?(l+=1,a.forEach(e=>{if("C"===e.type)m.push(D.bytesToUTF8(new Uint8Array(n,l,e.length)).trim());else if("N"===e.type)m.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(n,l,e.length)).trim(),10));else if("F"===e.type)m.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(n,l,e.length)).trim()));else if("D"===e.type){const p=String.fromCharCode.apply(null,new Uint8Array(n,l,e.length)).trim();
m.push(new Date(parseInt(p.substring(0,4),10),parseInt(p.substring(4,6),10)-1,parseInt(p.substring(6,8),10)))}l+=e.length}),f.push(m)):l+=k}}R=H({fields:a,records:f});return{header:L,fields:a,records:f,recordSet:R}};M._createClass(I,null,[{key:"supportedVersions",get:function(){return[5]}}]);return I}()})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(M,D,H,I){const n={GCSShiftXform:D,IdentityXform:H,
PolynomialXform:I},R=Object.keys(n);M.isTransformSupported=function(P){return!P||R.includes(P?.type)};M.readTransform=function(P){if(!P?.type)return null;var J=n[P?.type];return J?(J=new J,J.read(P),J):null};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(M,D,H,I,n,R,P,J){I=function(L){function k(){var a=L.apply(this,arguments)||this;a.type="gcs-shift";a.tolerance=1E-8;return a}M._inheritsLoose(k,L);var l=k.prototype;l.forwardTransform=function(a){a=a.clone();if("point"===a.type)return a.x>180+this.tolerance&&(a.x-=360),a;a.xmin>=180-this.tolerance?(a.xmax-=360,a.xmin-=360):a.xmax>180+this.tolerance&&(a.xmin=-180,a.xmax=180);return a};l.inverseTransform=function(a){a=a.clone();if("point"===a.type)return a.x<-this.tolerance&&(a.x+=360),a;a.xmin<
-this.tolerance&&(a.xmin+=360,a.xmax+=360);return a};return k}(J);D.__decorate([R.enumeration({GCSShiftXform:"gcs-shift"})],I.prototype,"type",void 0);D.__decorate([H.property()],I.prototype,"tolerance",void 0);return I=D.__decorate([P.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],I)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(M,D,H,I,n,R,P){H=function(J){function L(){return J.apply(this,arguments)||this}M._inheritsLoose(L,J);var k=L.prototype;k.forwardTransform=function(l){return l};k.inverseTransform=function(l){return l};M._createClass(L,[{key:"affectsPixelSize",get:function(){return!1}}]);return L}(H.JSONSupport);D.__decorate([I.property()],H.prototype,"affectsPixelSize",null);D.__decorate([I.property({json:{write:!0}})],H.prototype,"spatialReference",void 0);return H=D.__decorate([P.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],
H)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/Error ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(M,D,H,I,n,R,P,J,L,k){H=function(l){function a(){var f=l.apply(this,arguments)||this;
f.type="identity";return f}M._inheritsLoose(a,l);return a}(k);D.__decorate([J.enumeration({IdentityXform:"identity"})],H.prototype,"type",void 0);return H=D.__decorate([L.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],H)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f){function m(p,y,K){const {x:F,y:g}=y;if(2>K)return{x:p[0]+F*p[2]+g*p[4],y:p[1]+F*p[3]+g*p[5]};if(2===K){y=F*F;K=g*g;var w=F*g;return{x:p[0]+F*p[2]+g*p[4]+y*p[6]+w*p[8]+K*p[10],y:p[1]+F*p[3]+g*p[5]+y*p[7]+w*p[9]+K*p[11]}}y=F*F;K=g*g;w=F*g;const u=y*F,C=y*g,d=F*K,b=g*K;return{x:p[0]+F*p[2]+g*p[4]+y*p[6]+w*p[8]+K*p[10]+u*p[12]+C*p[14]+d*p[16]+b*p[18],y:p[1]+F*p[3]+g*p[5]+y*p[7]+w*p[9]+K*p[11]+u*p[13]+C*p[15]+d*p[17]+b*p[19]}}function e(p,y,K){const {xmin:F,ymin:g,xmax:w,
ymax:u,spatialReference:C}=y;y=[];if(2>K)y.push({x:F,y:u}),y.push({x:w,y:u}),y.push({x:F,y:g}),y.push({x:w,y:g});else{var d=10;for(var b=0;b<d;b++)y.push({x:F,y:g+(u-g)*b/(d-1)}),y.push({x:w,y:g+(u-g)*b/(d-1)});d=8;for(b=1;b<=d;b++)y.push({x:F+(w-F)*b/d,y:g}),y.push({x:F+(w-F)*b/d,y:u})}y=y.map(c=>m(p,c,K));d=y.map(c=>c.x);y=y.map(c=>c.y);return new f({xmin:Math.min.apply(null,d),xmax:Math.max.apply(null,d),ymin:Math.min.apply(null,y),ymax:Math.max.apply(null,y),spatialReference:C})}H=function(p){function y(){var F=
p.apply(this,arguments)||this;F.polynomialOrder=1;F.type="polynomial";return F}M._inheritsLoose(y,p);var K=y.prototype;K.readForwardCoefficients=function(F,g){const {coeffX:w,coeffY:u}=g;if(!w?.length||!u?.length||w.length!==u.length)return null;F=[];for(g=0;g<w.length;g++)F.push(w[g]),F.push(u[g]);return F};K.writeForwardCoefficients=function(F,g,w){w=[];const u=[];for(let C=0;C<F?.length;C++)0===C%2?w.push(F[C]):u.push(F[C]);g.coeffX=w;g.coeffY=u};K.readInverseCoefficients=function(F,g){const {inverseCoeffX:w,
inverseCoeffY:u}=g;if(!w?.length||!u?.length||w.length!==u.length)return null;F=[];for(g=0;g<w.length;g++)F.push(w[g]),F.push(u[g]);return F};K.writeInverseCoefficients=function(F,g,w){w=[];const u=[];for(let C=0;C<F?.length;C++)0===C%2?w.push(F[C]):u.push(F[C]);g.inverseCoeffX=w;g.inverseCoeffY=u};K.forwardTransform=function(F){if("point"===F.type){const g=m(this.forwardCoefficients,F,this.polynomialOrder);return new a({x:g.x,y:g.y,spatialReference:F.spatialReference})}return e(this.forwardCoefficients,
F,this.polynomialOrder)};K.inverseTransform=function(F){if("point"===F.type){const g=m(this.inverseCoefficients,F,this.polynomialOrder);return new a({x:g.x,y:g.y,spatialReference:F.spatialReference})}return e(this.inverseCoefficients,F,this.polynomialOrder)};M._createClass(y,[{key:"inverseCoefficients",get:function(){var F=this._get("inverseCoefficients"),g=this._get("forwardCoefficients");if(!F&&g&&2>this.polynomialOrder){const [w,u,C,d,b,c]=g;F=C*c-b*d;g=b*d-C*c;F=[(b*u-w*c)/F,(C*u-w*d)/g,c/F,d/
g,-b/F,-C/g]}return F},set:function(F){this._set("inverseCoefficients",F)}},{key:"affectsPixelSize",get:function(){return 0<this.polynomialOrder}}]);return y}(l);D.__decorate([I.property({json:{write:!0}})],H.prototype,"polynomialOrder",void 0);D.__decorate([I.property()],H.prototype,"forwardCoefficients",void 0);D.__decorate([J.reader("forwardCoefficients",["coeffX","coeffY"])],H.prototype,"readForwardCoefficients",null);D.__decorate([k.writer("forwardCoefficients")],H.prototype,"writeForwardCoefficients",
null);D.__decorate([I.property({json:{write:!0}})],H.prototype,"inverseCoefficients",null);D.__decorate([J.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],H.prototype,"readInverseCoefficients",null);D.__decorate([k.writer("inverseCoefficients")],H.prototype,"writeInverseCoefficients",null);D.__decorate([I.property()],H.prototype,"affectsPixelSize",null);D.__decorate([P.enumeration({PolynomialXform:"polynomial"})],H.prototype,"type",void 0);return H=D.__decorate([L.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
H)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F){H=function(g){function w(){return g.apply(this,arguments)||this}M._inheritsLoose(w,g);var u=w.prototype;u.open=function(){var C=M._asyncToGenerator(function*(d){yield this.init();var b=yield this._fetchData(d);let {spatialReference:c,statistics:h,histograms:q,transform:z}=yield this._fetchAuxiliaryData(d);(d=!c)&&(c=new K({wkid:3857}));q?.length&&null==h&&(h=p.estimateStatisticsFromHistograms(q));const {width:B,height:r}=b;let x=new F({xmin:-.5,ymin:.5-
r,xmax:B-.5,ymax:.5,spatialReference:c});const v=z?z.forwardTransform(x):x;var E=!0;z&&(E=(E=z.forwardCoefficients)&&0===E[1]&&0===E[2])&&(z=null,x=v);b=new f({data:{extent:v,nativeExtent:x,transform:z,pixelBlock:b,statistics:h,histograms:q,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:d}});yield b.open();b.data=null;this._set("rasterInfo",b.rasterInfo);this._inMemoryRaster=b});return function(d){return C.apply(this,arguments)}}();u.fetchRawTile=function(C,d,b,c={}){return this._inMemoryRaster.fetchRawTile(C,
d,b,c)};u._fetchData=function(){var C=M._asyncToGenerator(function*(d){({data:d}=yield this.request(this.url,{responseType:"array-buffer",signal:d?.signal}));var b=e.getFormat(d).toUpperCase();if("JPG"===b||"PNG"===b||"GIF"===b||"BMP"===b)this._set("datasetFormat",b);else throw new I("image-aux-raster:open","the data is not a supported format");b=b.toLowerCase();const c="gif"===b||"bmp"===b||!n("ios");return yield this.decodePixelBlock(d,{format:b,useCanvas:c,hasNoZlibMask:!0})});return function(d){return C.apply(this,
arguments)}}();u._fetchAuxiliaryData=function(){var C=M._asyncToGenerator(function*(d){d=R.unwrap(d?.signal);var b=this.ioConfig.skipExtensions??[],c=b.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:d}),h=this.datasetFormat;b=(h="JPG"===h?"jgw":"PNG"===h?"pgw":"BMP"===h?"bpw":null)&&b.includes(h)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+h,{responseType:"text",signal:d});c=yield P.eachAlways([c,b]);if(d?.aborted)throw P.createAbortError();
d=m.parsePAMInfo(c[0].value?.data);d.transform||(c=c[1].value?c[1].value.data.split("\n").slice(0,6).map(q=>Number(q)):null,d.transform=6===c?.length?new y({forwardCoefficients:[c[4],c[5],c[0],-c[1],c[2],-c[3]]}):null);return d});return function(d){return C.apply(this,arguments)}}();return w}(a);D.__decorate([J.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=D.__decorate([l.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],H)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p){H=function(y){function K(){var g=y.apply(this,arguments)||this;g.datasetFormat="MEMORY";g.data=null;return g}M._inheritsLoose(K,y);var F=K.prototype;F.open=function(){var g=M._asyncToGenerator(function*(w){yield this.init();var u=this.data;const {pixelBlock:C,statistics:d,histograms:b,name:c,keyProperties:h,nativeExtent:q,transform:z}=this.data,{width:B,height:r,pixelType:x}=C,v=u.extent??new e({xmin:-.5,ymin:.5,xmax:B-.5,ymax:r-.5,spatialReference:new p({wkid:3857})});
u=new l({width:B,height:r,pixelType:x,extent:v,nativeExtent:q,transform:z,pixelSize:{x:v.width/B,y:v.height/r},spatialReference:v.spatialReference,bandCount:3,keyProperties:h||{},statistics:d,isPseudoSpatialReference:u.isPseudoSpatialReference??!u.extent,histograms:b});this.createRemoteDatasetStorageInfo(u,512,512);this._set("rasterInfo",u);this.updateTileInfo();yield this._buildInMemoryRaster(C,{width:512,height:512},w);this.datasetName=c;this.url="/InMemory/"+c});return function(w){return g.apply(this,
arguments)}}();F.fetchRawTile=function(g,w,u,C){g=this._pixelBlockTiles.get(`${g}/${w}/${u}`);return Promise.resolve(g)};F._buildInMemoryRaster=function(){var g=M._asyncToGenerator(function*(w,u,C){var d=this.rasterInfo.storageInfo.maximumPyramidLevel;const b=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:w,tileSize:u,maximumPyramidLevel:d},C):Promise.resolve(f.split(w,u,d));u=n.isSome(this.rasterInfo.statistics);d=n.isSome(this.rasterInfo.histograms);w=u?Promise.resolve({statistics:null,
histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:w},C):Promise.resolve(m.estimateStatisticsHistograms(w));w=yield R.eachAlways([b,w]);if(!w[0].value&&w[1].value)throw new I("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=w[0].value;u||(this.rasterInfo.statistics=w[1].value?.statistics);d||(this.rasterInfo.histograms=w[1].value?.histograms)});return function(w,u,C){return g.apply(this,arguments)}}();return K}(a);
D.__decorate([P.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);D.__decorate([P.property()],H.prototype,"data",void 0);return H=D.__decorate([k.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],H)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/maybe ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),function(M,D,H,I,n,R){function P(a,f){if(!a||
!f)return null;const m=[];for(let e=0;e<a.length;e++)m.push(a[e]),m.push(f[e]);return m}function J(a){var f=I.getElement(a,"GeodataXform");a=I.getElementNumericValue(f,"SpatialReference/WKID")||I.getElementValue(f,"SpatialReference/WKT");a=k(a);if("typens:PolynomialXform"!==f.getAttribute("xsi:type"))return{spatialReference:a,transform:null};var m=I.getElementNumericValue(f,"PolynomialOrder")??1,e=I.getElementNumericValues(f,"CoeffX/Double");const p=I.getElementNumericValues(f,"CoeffY/Double");var y=
I.getElementNumericValues(f,"InverseCoeffX/Double");f=I.getElementNumericValues(f,"InverseCoeffY/Double");e=P(e,p);y=P(y,f);m=e&&y&&e.length&&y.length?new n({spatialReference:a,polynomialOrder:m,forwardCoefficients:e,inverseCoefficients:y}):null;return{spatialReference:a,transform:m}}function L(a){const f=I.getElementNumericValue(a,"NoDataValue");var m=I.getElement(a,"Histograms/HistItem");const e=I.getElementNumericValue(m,"HistMin"),p=I.getElementNumericValue(m,"HistMax"),y=I.getElementNumericValue(m,
"BucketCount");m=I.getElementValue(m,"HistCounts")?.split("|").map(u=>Number(u));let K,F,g,w;I.getElements(a,"Metadata/MDI").forEach(u=>{const C=Number(u.textContent??u.nodeValue);switch(u.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":K=C;break;case "STATISTICS_MAXIMUM":F=C;break;case "STATISTICS_MEAN":g=C;break;case "STATISTICS_STDDEV":w=C}});a=I.getElementNumericValue(a,"Metadata/SourceBandIndex");return{noDataValue:f,histogram:m?.length&&null!=e&&null!=p?{min:e,max:p,size:y||m.length,
counts:m}:null,sourceBandIndex:a,statistics:null!=K&&null!=F?{min:K,max:F,avg:g,stddev:w}:null}}function k(a){if(!a)return null;var f=Number(a);if(!isNaN(f)&&0!==f)return new R({wkid:f});a=String(a);if(a.startsWith("COMPD_CS")){if(!a.includes("VERTCS")||!a.includes("GEOGCS")&&!a.startsWith("PROJCS"))return null;f=a.indexOf("VERTCS");var m=a.indexOf("PROJCS");m=-1<m?m:a.indexOf("GEOGCS");if(-1===m)return null;m=a.slice(m,a.lastIndexOf("]",f)+1).trim();a=a.slice(f,a.lastIndexOf("]")).trim();f=(f=l(m))?
new R({wkid:f}):new R({wkt:m});if(a=l(a))f.vcsWkid=a;return f}if(!a.startsWith("GEOGCS")&&!a.startsWith("PROJCS"))return null;f=l(a);return 0!==f?new R({wkid:f}):new R({wkt:a})}function l(a){var f=a.replace(/\]/g,"[").replace(/"/g,"").split("[").map(e=>e.trim()).filter(e=>""!==e);f=f[f.length-1].split(",");const m=f[0]?.toLowerCase();return"epsg"!==m&&"esri"!==m||!a.endsWith('"]]')||(a=Number(f[1]),isNaN(a)||0===a)?0:a}M.parsePAMInfo=function(a){if("pamdataset"!==a?.documentElement.tagName?.toLowerCase())return{};
const f={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};a.documentElement.childNodes.forEach(m=>{if(1===m.nodeType)if(I.isSameTagIgnoreNS(m,"SRS"))f.spatialReference||(m=I.getElementValue(m),f.spatialReference=k(m));else if(I.isSameTagIgnoreNS(m,"Metadata"))if("xml:ESRI"===m.getAttribute("domain")){const {spatialReference:e,transform:p}=J(m);f.transform=p;f.spatialReference||(f.spatialReference=e)}else I.getElements(m,"MDI").forEach(e=>f.metadata[e.getAttribute("key")]=
I.getElementValue(e));else I.isSameTagIgnoreNS(m,"PAMRasterBand")&&(m=L(m),null!=m.sourceBandIndex&&null==f.rasterBands[m.sourceBandIndex]?f.rasterBands[m.sourceBandIndex]=m:f.rasterBands.push(m))});a=f.rasterBands;a.length&&(f.statistics=a[0].statistics?a.map(m=>m.statistics).filter(H.isSome):null,f.histograms=a[0].histogram?a.map(m=>m.histogram).filter(H.isSome):null);return f};M.parseSpatialReference=k;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(M){function D(R,P){if(!R||!P)return[];var J=P;P.includes("/")?(J=P.slice(0,P.indexOf("/")),P=P.slice(P.indexOf("/")+1)):P="";const L=[];if(P){R=D(R,J);for(J=0;J<R.length;J++)D(R[J],P).forEach(k=>L.push(k));return L}P=R.getElementsByTagNameNS("*",J);if(!P||0===P.length)return[];for(R=0;R<P.length;R++)L.push(P[R]||P.item[R]);return L}function H(R,P){if(!R||!P)return null;let J=P;P.includes("/")?(J=P.slice(0,P.indexOf("/")),
P=P.slice(P.indexOf("/")+1)):P="";R=D(R,J);return 0<R.length?P?H(R[0],P):R[0]:null}function I(R,P=null){if(R=P?H(R,P):R)if(R=R.textContent||R.nodeValue)return R.trim();return null}function n(R,P){R=D(R,P);P=[];let J;for(let L=0;L<R.length;L++)if(J=R[L].textContent||R[L].nodeValue)J=J.trim(),""!==J&&P.push(J);return P}M.getElement=H;M.getElementNumericValue=function(R,P){R=I(R,P);return Number(R)};M.getElementNumericValues=function(R,P){return n(R,P).map(J=>Number(J))};M.getElementValue=I;M.getElementValues=
n;M.getElements=D;M.getNodeNameIgnoreNS=function(R){return R.nodeName.slice(R.nodeName.lastIndexOf(":")+1)};M.getSpaceDelimitedNumericValues=function(R,P=null){return I(R,P)?.split(" ").map(J=>Number(J))??[]};M.isSameTagIgnoreNS=function(R,P){R=R?.nodeName?.toLowerCase();P=P.toLowerCase();return R.slice(R.lastIndexOf(":")+1)===P};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../serviceTileInfoProperty ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u){H=function(C){function d(){var c=C.apply(this,arguments)||this;c._levelOffset=0;c._tilemapCache=null;c._slices=null;c.datasetFormat="RasterTileServer";c.tileType=null;return c}M._inheritsLoose(d,C);var b=d.prototype;b.open=function(){var c=M._asyncToGenerator(function*(h){yield this.init();var q=h&&h.signal;h=this.sourceJSON?{data:this.sourceJSON}:yield this.request(this.url,{query:{f:"json"},signal:q});h.ssl&&(this.url=this.url.replace(/^http:/i,
"https:"));this.sourceJSON=h=h.data;if(!h)throw new I("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!h.tileInfo)throw new I("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();var z="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=h.cacheType;null==this.tileType&&(z.includes(h.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===h.tileInfo.format.toLowerCase()?this.tileType="Elevation":
this.tileType="Raster");this.datasetName=h.name?.slice(h.name.indexOf("/")+1)??"";q=yield this._fetchRasterInfo({signal:q});if(n.isNone(q))throw new I("image-server-raster:open","cannot initialize image service");z="Map"===this.tileType?f.readServiceTileInfo(h.tileInfo,h):m.fromJSON(h.tileInfo);n.assertIsSome(z);const [B,r]=this._computeMinMaxLOD(q,z),{extent:x,pixelSize:v}=q,E=.5/q.width*v.x,t=Math.max(v.x,v.y);var {lods:A}=z;if("Map"!==this.tileType&&0!==h.maxScale||Math.abs(v.x-v.y)>E||!A.some(S=>
Math.abs(S.resolution-t)<E))v.x=v.y=B.resolution,q.width=Math.ceil((x.xmax-x.xmin)/v.x-.1),q.height=Math.ceil((x.ymax-x.ymin)/v.y-.1);const O=B.level-r.level,[N,X]=z.size,V=[];A.forEach(S=>{S.level>=r.level&&S.level<=B.level&&V.push({x:S.resolution,y:S.resolution})});V.sort((S,T)=>S.x-T.x);A=this.computeBlockBoundary(x,N,X,z.origin,V,O);const W=1<V.length?V.slice(1):null;var G;h.transposeInfo&&(G={tileSize:[h.transposeInfo.rows,h.transposeInfo.cols],packetSize:q.keyProperties?._yxs.PacketSize??0});
q.storageInfo=new a({blockWidth:z.size[0],blockHeight:z.size[1],pyramidBlockWidth:z.size[0],pyramidBlockHeight:z.size[1],pyramidResolutions:W,compression:z.format,origin:z.origin,firstPyramidLevel:1,maximumPyramidLevel:O,tileInfo:z,transposeInfo:G,blockBoundary:A});this._fixGCSShift(q);this._set("rasterInfo",q);h.capabilities.toLowerCase().includes("tilemap")&&(G={tileInfo:q.storageInfo.tileInfo,parsedUrl:R.urlToObject(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new e.TilemapCache({layer:G}))});
return function(h){return c.apply(this,arguments)}}();b.fetchRawTile=function(){var c=M._asyncToGenerator(function*(h,q,z,B={}){const {storageInfo:r,extent:x}=this.rasterInfo;var {transposeInfo:v}=r,E=n.isSome(v)&&!!B.transposedVariableName;if(this._slices&&!E&&null==B.sliceId)return null;({data:B}=yield this.request(`${this.url}/tile/${E?0:r.maximumPyramidLevel-h+this._levelOffset}/${q}/${z}`,{query:this._slices?E?{variable:B.transposedVariableName}:{sliceId:B.sliceId||0}:null,responseType:"array-buffer",
signal:B.signal}));if(!B)return null;v=E?v.tileSize:r.tileInfo.size;E=yield this.decodePixelBlock(B,{width:v[0],height:v[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:E});v=r.blockBoundary[h];if("jpg"!==r.compression||z>v.minCol&&z<v.maxCol&&q>v.minRow&&q<v.maxRow)return E;const {origin:t,blockWidth:A,blockHeight:O}=r,{x:N,y:X}=this.getPyramidPixelSize(h);var V=Math.round((x.xmin-t.x)/N)%A;h=Math.round((x.xmax-t.x)/N)%A||A;var W=Math.round((t.y-x.ymax)/X)%O;B=
Math.round((t.y-x.ymin)/X)%O||O;V=z===v.minCol?V:0;W=q===v.minRow?W:0;y.setValidBoundary(E,{x:V,y:W},{width:(z===v.maxCol?h:A)-V,height:(q===v.maxRow?B:O)-W});return E});return function(h,q,z){return c.apply(this,arguments)}}();b.getSliceIndex=function(c){if(!this._slices||n.isNone(c)||0===c.length)return null;for(let h=0;h<this._slices.length;h++){const q=this._slices[h].multidimensionalDefinition;if(q.length===c.length&&!q.some(z=>{var B=c.find(x=>z.variableName===x.variableName&&x.dimensionName===
z.dimensionName);if(!B)return!0;const r=Array.isArray(z.values[0])?`${z.values[0][0]}-${z.values[0][1]}`:z.values[0];B=Array.isArray(B.values[0])?`${B.values[0][0]}-${B.values[0][1]}`:B.values[0];return r!==B}))return h}return null};b.fetchVariableStatisticsHistograms=function(){var c=M._asyncToGenerator(function*(h,q){var z=this.request(this.url+"/statistics",{query:{variable:h,f:"json"},signal:q}).then(B=>B.data?.statistics);h=this.request(this.url+"/histograms",{query:{variable:h,f:"json"},signal:q}).then(B=>
B.data?.histograms);z=yield Promise.all([z,h]);z[0]&&z[0].forEach(B=>{B.avg=B.mean;B.stddev=B.standardDeviation});return{statistics:z[0]||null,histograms:z[1]||null}});return function(h,q){return c.apply(this,arguments)}}();b.computeBestPyramidLevelForLocation=function(){var c=M._asyncToGenerator(function*(h,q={}){if(!this._tilemapCache)return 0;h=this.identifyPixelLocation(h,0,n.unwrap(q.datumTransformation));if(null===h)return null;let z=0;var {maximumPyramidLevel:B}=this.rasterInfo.storageInfo;
B=B-z+this._levelOffset;const r=h.srcLocation;for(;0<=B;){try{if("available"===(yield this._tilemapCache.fetchAvailability(B,h.row,h.col,q)))break}catch{}B--;z++;h=this.identifyPixelLocation(r,z,n.unwrap(q.datumTransformation));if(null===h)return null}return-1===B||null==h?null:z});return function(h){return c.apply(this,arguments)}}();b._fetchRasterInfo=function(){var c=M._asyncToGenerator(function*(h){var q=this.sourceJSON;if("Map"===this.tileType){h=q.fullExtent||q.extent;var z=Math.ceil((h.xmax-
h.xmin)/q.pixelSizeX-.1);const B=Math.ceil((h.ymax-h.ymin)/q.pixelSizeY-.1),r=g.fromJSON(q.spatialReference||h.spatialReference);q=new w({x:q.pixelSizeX,y:q.pixelSizeY,spatialReference:r});return new l({width:z,height:B,bandCount:3,extent:u.fromJSON(h),spatialReference:r,pixelSize:q,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:z}=h);h=F.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:z,query:this.ioConfig.customFetchParameters});q=q.hasMultidimensions?this.request(`${this.url}/slices`,
{query:{f:"json"},signal:z}).then(B=>B.data&&B.data.slices).catch(()=>null):null;q=yield Promise.all([h,q]);this._slices=q[1];return q[0]});return function(h){return c.apply(this,arguments)}}();b._fixScaleInServiceInfo=function(){const {sourceJSON:c}=this;c.minScale&&0>c.minScale&&(c.minScale=0);c.maxScale&&0>c.maxScale&&(c.maxScale=0)};b._fixGCSShift=function(c){const {extent:h,spatialReference:q}=c;-1<h.xmin&&181<h.xmax&&q?.wkid&&q.isGeographic&&(c.nativeExtent=c.extent,c.transform=new K,c.extent=
c.transform.forwardTransform(h))};b._computeMinMaxLOD=function(c,h){const {pixelSize:q}=c,z=.5/c.width*q.x;({lods:c}=h);var B=h.lodAt(Math.max.apply(null,c.map(E=>E.level)));h=h.lodAt(Math.min.apply(null,c.map(E=>E.level)));var {tileType:r}=this;if("Map"===r)return this._levelOffset=c[0].level,[B,h];if("Raster"===r)return[c.find(E=>E.resolution===q.x)??B,h];const {minScale:x,maxScale:v}=this.sourceJSON;r=B;0<v&&((r=c.find(E=>Math.abs(E.scale-v)<z))||(r=c.filter(E=>E.scale>v).sort((E,t)=>E.scale>t.scale?
1:-1)[0]??B));B=h;0<x&&(B=c.find(E=>Math.abs(E.scale-x)<z)??h,this._levelOffset=B.level-h.level);return[r,B]};return d}(p);D.__decorate([P.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);D.__decorate([P.property()],H.prototype,"tileType",void 0);return H=D.__decorate([k.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],H)})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(M,D){function H(n,R,P,J){if(!n)return null;
const {minScale:L,maxScale:k,minLOD:l,maxLOD:a}=R;if(null!=l&&null!=a)return J&&J.ignoreMinMaxLOD?D.fromJSON(n):D.fromJSON({...n,lods:n.lods.filter(({level:f})=>null!=f&&f>=l&&f<=a)});if(0!==L&&0!==k){const f=L?Math.round(1E4*L)/1E4:Infinity,m=k?Math.round(1E4*k)/1E4:-Infinity;return D.fromJSON({...n,lods:n.lods.filter(e=>{e=Math.round(1E4*e.scale)/1E4;return e<=f&&e>=m})})}return D.fromJSON(n)}const I={type:D,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],
reader:H}}}}};M.readServiceTileInfo=H;M.serviceTileInfoProperty=I;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/byteSizeEstimations ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w){var u;M.TilemapCache=u=function(C){function d(c){c=C.call(this,c)||this;c._pendingTilemapRequests={};c._availableLevels={};c.levels=5;c.cacheByteSize=2*R.ByteSizeUnit.MEGABYTES;c.request=I;c._prefetchingEnabled=!0;return c}D._inheritsLoose(d,C);var b=d.prototype;b.initialize=function(){this._tilemapCache=new k(this.cacheByteSize);this.addHandles([f.watch(()=>{const {layer:c}=this;return[c?.parsedUrl,c?.tileServers,c?.apiKey,c?.customParameters]},
()=>this._initializeTilemapDefinition()),f.watch(()=>this.layer?.tileInfo?.lods,c=>this._initializeAvailableLevels(c),f.syncAndInitial)]);this._initializeTilemapDefinition()};b.castLevels=function(c){return 2>=c?(L.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",c),3):c};b.fetchTilemap=function(c,h,q,z){if(!this._availableLevels[c])return Promise.reject(new P("tilemap-cache:level-unavailable",`Level ${c} is unavailable in the service`));const B=this._tmpTilemapDefinition;
if(c=this._tilemapFromCache(c,h,q,B))return Promise.resolve(c);const r=z&&z.signal;z={...z,signal:null};return new Promise((x,v)=>{a.onAbort(r,()=>v(a.createAbortError()));const E=w.tilemapDefinitionId(B);let t=this._pendingTilemapRequests[E];if(!t){t=w.Tilemap.fromDefinition(B,z).then(O=>{this._tilemapCache.put(E,O,O.byteSize);return O});const A=()=>delete this._pendingTilemapRequests[E];this._pendingTilemapRequests[E]=t;t.then(A,A)}t.then(x,v)})};b.getAvailability=function(c,h,q){return this._availableLevels[c]?
(c=this._tilemapFromCache(c,h,q,this._tmpTilemapDefinition))?c.getAvailability(h,q):"unknown":"unavailable"};b.fetchAvailability=function(c,h,q,z){return this._availableLevels[c]?this.fetchTilemap(c,h,q,z).catch(B=>B).then(B=>{if(B instanceof w.Tilemap){B=B.getAvailability(h,q);if("unavailable"===B)throw new P("tile-map:tile-unavailable","Tile is not available",{level:c,row:h,col:q});return B}if(a.isAbortError(B))throw B;return"unknown"}):Promise.reject(new P("tilemap-cache:level-unavailable",`Level ${c} is unavailable in the service`))};
b.fetchAvailabilityUpsample=function(c,h,q,z,B){z.level=c;z.row=h;z.col=q;const r=this.layer.tileInfo;r.updateTileInfo(z);const x=this.fetchAvailability(c,h,q,B).catch(v=>{if(a.isAbortError(v))throw v;if(r.upsampleTile(z))return this.fetchAvailabilityUpsample(z.level,z.row,z.col,z);throw v;});this._fetchAvailabilityUpsamplePrefetch(z.id,c,h,q,B,x);return x};b._fetchAvailabilityUpsamplePrefetch=function(){var c=D._asyncToGenerator(function*(h,q,z,B,r,x){if(this._prefetchingEnabled){var v=`prefetch-${h}`;
if(!this.handles.has(v)){var E=new AbortController;x.then(()=>E.abort(),()=>E.abort());var t=!1;this.handles.add({remove(){t||(t=!0,E.abort())}},v);yield m.waitTicks(10,E.signal).catch(()=>{});t||(t=!0,this.handles.remove(v));if(!a.isAborted(E))for(h=new g.TileKey(h,q,z,B),r={...r,signal:E.signal},q=this.layer.tileInfo,z=0;u._prefetches.length<u._maxPrefetch&&q.upsampleTile(h);++z){const A=this.fetchAvailability(h.level,h.row,h.col,r);u._prefetches.push(A);B=()=>{u._prefetches.removeUnordered(A)};
A.then(B,B)}}}});return function(h,q,z,B,r,x){return c.apply(this,arguments)}}();b._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var {parsedUrl:c,apiKey:h,customParameters:q}=this.layer;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:c.path,query:e.objectToQuery({...c.query,...q,token:h??c.query?.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};b._tilemapFromCache=function(c,
h,q,z){z.level=c;z.row=h-h%this.size;z.col=q-q%this.size;c=w.tilemapDefinitionId(z);return this._tilemapCache.get(c)};b._initializeAvailableLevels=function(c){this._availableLevels={};c&&c.forEach(h=>this._availableLevels[h.level]=!0)};D._createClass(d,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const c=this;return{get prefetchingEnabled(){return c._prefetchingEnabled},set prefetchingEnabled(h){c._prefetchingEnabled=h},hasTilemap(h,q,z){return!!c._tilemapFromCache(h,
q,z,c._tmpTilemapDefinition)}}}}]);return d}(J.HandleOwnerMixin(n));M.TilemapCache._maxPrefetch=4;M.TilemapCache._prefetches=new l({initialSize:u._maxPrefetch});H.__decorate([p.property({constructOnly:!0,type:Number})],M.TilemapCache.prototype,"levels",void 0);H.__decorate([K.cast("levels")],M.TilemapCache.prototype,"castLevels",null);H.__decorate([p.property({readOnly:!0,type:Number})],M.TilemapCache.prototype,"size",null);H.__decorate([p.property({constructOnly:!0,type:Number})],M.TilemapCache.prototype,
"cacheByteSize",void 0);H.__decorate([p.property({constructOnly:!0})],M.TilemapCache.prototype,"layer",void 0);H.__decorate([p.property({constructOnly:!0})],M.TilemapCache.prototype,"request",void 0);M.TilemapCache=u=H.__decorate([F.subclass("esri.layers.support.TilemapCache")],M.TilemapCache);Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(M){function D(n){return 32+n.length}function H(n){if(!n)return 0;
if(Array.isArray(n)){var R=n.length;if(0===R||"number"===typeof n[0])n=32+8*R;else{var P=32;for(let J=0;J<R;J++)P+=I(n[J]);n=P}return n}P=32;for(R in n)n.hasOwnProperty(R)&&(P+=I(n[R]));return P}function I(n){switch(typeof n){case "object":return H(n);case "string":return D(n);case "number":return 16;case "boolean":return 4;default:return 8}}M.ByteSizeUnit=void 0;(function(n){n[n.KILOBYTES=1024]="KILOBYTES";n[n.MEGABYTES=1048576]="MEGABYTES";n[n.GIGABYTES=1073741824]="GIGABYTES"})(M.ByteSizeUnit||
(M.ByteSizeUnit={}));M.estimateAttributesObjectSize=function(n){if(!n)return 0;let R=32;for(const P in n)if(n.hasOwnProperty(P)){const J=n[P];switch(typeof J){case "string":R+=D(J);break;case "number":R+=16;break;case "boolean":R+=4}}return R};M.estimateFixedArraySize=function(n,R){return 32+n.length*R};M.estimateNestedObjectSize=H;M.estimateNumberByteSize=function(n){return 16};M.estimateStringByteSize=D;Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/Tilemap":function(){define(["exports","../../request","../../core/arrayUtils","../../core/Error","../../core/lang"],function(M,D,H,I,n){function R(J){if("vector-tile"===J.service.type)var L=`${J.service.url}/tilemap/${J.level}/${J.row}/${J.col}/${J.width}/${J.height}`;else L=J.service.tileServers,L=`${L&&L.length?L[J.row%L.length]:J.service.url}/tilemap/${J.level}/${J.row}/${J.col}/${J.width}/${J.height}`;(J=J.service.query)&&(L=`${L}?${J}`);return L}let P=function(){function J(){this.location=
{left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var L=J.prototype;L.getAvailability=function(k,l){if("unknown"!==this._allAvailability)return this._allAvailability;k=(k-this.location.top)*this.location.width+(l-this.location.left);l=k>>3;const a=this._tileAvailabilityBitSet;return 0>l||l>a.length?"unknown":a[l]&1<<k%8?"available":"unavailable"};L._updateFromData=function(k){let l=!0,a=!0;const f=new Uint8Array(Math.ceil(this.location.width*this.location.height/8));
let m=0;for(let e=0;e<k.length;e++){const p=e%8;k[e]?(a=!1,f[m]|=1<<p):l=!1;7===p&&++m}a?this._allAvailability="unavailable":l?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=f,this.byteSize+=f.length)};J.fromDefinition=function(k,l){const a=k.service.request||D,{row:f,col:m,width:e,height:p}=k,y={query:{f:"json"}};l=l?{...y,...l}:y;return a(R(k),l).then(K=>K.data).catch(K=>{if(K&&K.details&&422===K.details.httpStatus)return{location:{top:f,left:m,width:e,
height:p},valid:!0,data:H.constant(e*p,0)};throw K;}).then(K=>{if(K.location&&(K.location.top!==f||K.location.left!==m||K.location.width!==e||K.location.height!==p))throw new I("tilemap:location-mismatch","Tilemap response for different location than requested",{response:K,definition:{top:f,left:m,width:e,height:p}});return J.fromJSON(K)})};J.fromJSON=function(k){J._validateJSON(k);const l=new J;l.location=Object.freeze(n.clone(k.location));l._updateFromData(k.data);return Object.freeze(l)};J._validateJSON=
function(k){if(!k||!k.location)throw new I("tilemap:missing-location","Location missing from tilemap response");if(!1===k.valid)throw new I("tilemap:invalid","Tilemap response was marked as invalid");if(!k.data)throw new I("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(k.data))throw new I("tilemap:data-mismatch","Data must be an array of numbers");if(k.data.length!==k.location.width*k.location.height)throw new I("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");
};return J}();M.Tilemap=P;M.tilemapDefinitionId=function(J){return`${J.level}/${J.row}/${J.col}/${J.width}/${J.height}`};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),function(M,D,H,I,
n,R,P,J,L){function k(a,f,m){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(a,f,m){a=J.parseUrl(a);const {renderingRule:e,sourceJSON:p}=f||{};f=e?JSON.stringify(e.rasterFunctionDefinition||e):null;f=J.encode({...a.query,renderingRule:f,f:"json"});f=J.asValidOptions(f,m);a=a.path;m=p||(yield H(a,f).then(h=>h.data));var y=m.hasRasterAttributeTable?H(`${a}/rasterAttributeTable`,f):null,K=m.hasColormap?H(`${a}/colormap`,f):null,F=m.hasHistograms?H(`${a}/histograms`,f):null,
g=10.3<=m.currentVersion?H(`${a}/keyProperties`,f):null;a=m.hasMultidimensions?H(`${a}/multidimensionalInfo`,f):null;f=yield Promise.allSettled([y,K,F,g,a]);a=null;if(m.minValues&&m.minValues.length===m.bandCount)for(a=[],y=0;y<m.minValues.length;y++)a.push({min:m.minValues[y],max:m.maxValues[y],avg:m.meanValues[y],stddev:m.stdvValues[y]});K=I.fromJSON(m.extent);y=Math.ceil(K.width/m.pixelSizeX-.1);K=Math.ceil(K.height/m.pixelSizeY-.1);F=R.fromJSON(m.spatialReference||m.extent.spatialReference);g=
"fulfilled"===f[0].status?f[0].value?L.fromJSON(f[0].value.data):null:null;const w="fulfilled"===f[1].status?f[1].value?.data.colormap:null,u="fulfilled"===f[2].status?f[2].value?.data.histograms:null,C="fulfilled"===f[3].status?f[3].value?.data??{}:{};f="fulfilled"===f[4].status?f[4].value?.data.multidimensionalInfo:null;f?.variables?.length&&f.variables.forEach(h=>{h.statistics?.length&&h.statistics.forEach(q=>{q.avg=q.mean;q.stddev=q.standardDeviation})});const {defaultVariable:d,serviceDataType:b}=
m;d&&d!==C.DefaultVariable&&(C.DefaultVariable=d);b&&b.includes("esriImageServiceDataTypeVector")&&!b.includes(C.DataType)&&(C.DataType=b.replace("esriImageServiceDataType",""));let c=m.noDataValue;m.noDataValues?.length&&m.noDataValues.some(h=>h!==c)&&(c=m.noDataValues);return new P({width:y,height:K,bandCount:m.bandCount,extent:I.fromJSON(m.extent),spatialReference:F,pixelSize:new n({x:m.pixelSizeX,y:m.pixelSizeY,spatialReference:F}),pixelType:m.pixelType.toLowerCase(),statistics:a,attributeTable:g,
colormap:w,histograms:u,keyProperties:C,noDataValue:c,multidimensionalInfo:f})});return l.apply(this,arguments)}M.fetchServiceRasterInfo=function(a,f,m){return k(a,{sourceJSON:f},m)};M.generateRasterInfo=function(a,f,m){return k(a,{renderingRule:f},m)};Object.defineProperties(M,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g){const w=new Map;w.set("Int8","s8");w.set("UInt8","u8");w.set("Int16","s16");w.set("UInt16","u16");w.set("Int32","s32");w.set("UInt32","u32");w.set("Float32","f32");w.set("Float64","f32");w.set("Double64","f32");const u=new Map;u.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});u.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});u.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
u.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});H=function(C){function d(){var c=C.apply(this,arguments)||this;c._files=null;c._storageIndex=null;c.datasetFormat="MRF";return c}M._inheritsLoose(d,C);var b=d.prototype;b.open=function(){var c=M._asyncToGenerator(function*(h){yield this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var q=h?n.unwrap(h.signal):null,z=yield this.request(this.url,{responseType:"xml",signal:q});const {rasterInfo:B,files:r}=this._parseHeader(z.data);
-1===this.ioConfig.skipExtensions?.indexOf("aux.xml")&&(h=yield this._fetchAuxiliaryData(h),null!=h&&(B.statistics=h.statistics??B.statistics,(B.histograms=h.histograms)&&n.isNone(B.statistics)&&(B.statistics=y.estimateStatisticsFromHistograms(h.histograms))));this._set("rasterInfo",B);this._files=r;q=yield this.request(r.index,{responseType:"array-buffer",signal:q});this._storageIndex=this._parseIndex(q.data);const {blockWidth:x,blockHeight:v}=this.rasterInfo.storageInfo;q=this.rasterInfo.storageInfo.pyramidScalingFactor;
const {width:E,height:t}=this.rasterInfo;h=[];z=this._getBandSegmentCount();let A=0,O=-1;for(;A<this._storageIndex.length;){O++;const N=Math.ceil(E/x/q**O)-1,X=Math.ceil(t/v/q**O)-1;A+=(N+1)*(X+1)*z*4;h.push({maxRow:X,maxCol:N,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=h;0<O&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=O);this.updateTileInfo()});return function(h){return c.apply(this,arguments)}}();b.fetchRawTile=function(){var c=
M._asyncToGenerator(function*(h,q,z,B={}){const {blockWidth:r,blockHeight:x,blockBoundary:v}=this.rasterInfo.storageInfo;var E=v[h];if(!E||E.maxRow<q||E.maxCol<z||E.minRow>q||E.minCol>z)return null;const {bandCount:t,pixelType:A}=this.rasterInfo,{ranges:O,actualTileWidth:N,actualTileHeight:X}=this._getTileLocation(h,q,z);if(!O||0===O.length)return null;if(0===O[0].from&&0===O[0].to)return h=new Uint8Array(r*x),new k({width:r,height:x,pixels:null,mask:h,validPixelCount:0});({bandIds:q}=this.ioConfig);
z=this._getBandSegmentCount();E=[];for(h=h=0;h<z;h++)(!q||-1<q.indexOf[h])&&E.push(this.request(this._files.data,{range:{from:O[h].from,to:O[h].to},responseType:"array-buffer",signal:B.signal}));B=yield Promise.all(E);h=B.map(W=>W.data.byteLength).reduce((W,G)=>W+G);E=new Uint8Array(h);let V=0;for(h=0;h<z;h++)E.set(new Uint8Array(B[h].data),V),V+=B[h].data.byteLength;h=u.get(this.rasterInfo.storageInfo.compression).decoderFormat;q=yield this.decodePixelBlock(E.buffer,{width:r,height:x,format:h,planes:q?.length||
t,pixelType:A});if(n.isSome(this.rasterInfo.noDataValue)&&"lerc"!==h&&!q.mask&&(B=this.rasterInfo.noDataValue[0],null!=B)){z=q.width*q.height;E=new Uint8Array(z);if(1E24<Math.abs(B))for(h=0;h<z;h++)1E-6<Math.abs((q.pixels[0][h]-B)/B)&&(E[h]=1);else for(h=0;h<z;h++)q.pixels[0][h]!==B&&(E[h]=1);q.mask=E}z=B=0;if(N!==r||X!==x)if(E=q.mask)for(h=0;h<x;h++)for(z=h*r,B=h<X?N:0;B<r;B++)E[z+B]=0;else for(E=new Uint8Array(r*x),q.mask=E,h=0;h<X;h++)for(z=h*r,B=0;B<N;B++)E[z+B]=1;return q});return function(h,
q,z){return c.apply(this,arguments)}}();b._parseIndex=function(c){if(0<c.byteLength%16)throw"invalid array buffer must be multiples of 16";let h,q,z,B,r;if(p.isPlatformLittleEndian){h=new Uint8Array(c);z=new ArrayBuffer(c.byteLength);q=new Uint8Array(z);for(B=0;B<c.byteLength/4;B++)for(r=0;4>r;r++)q[4*B+r]=h[4*B+3-r];c=new Uint32Array(z)}else c=new Uint32Array(c);return c};b._getBandSegmentCount=function(){return u.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount};
b._getTileLocation=function(c,h,q){const {blockWidth:z,blockHeight:B,pyramidScalingFactor:r}=this.rasterInfo.storageInfo,{width:x,height:v}=this.rasterInfo,E=this._getBandSegmentCount();let t,A;var O,N=0;let X=0;for(O=0;O<c;O++)X=r**O,t=Math.ceil(x/z/X),A=Math.ceil(v/B/X),N+=t*A;X=r**c;t=Math.ceil(x/z/X);A=Math.ceil(v/B/X);N=4*(N+(h*t+q))*E;c=this._storageIndex.subarray(N,N+4*E);N=O=0;const V=[];for(let W=0;W<E;W++)O=c[4*W]*2**32+c[4*W+1],N=O+c[4*W+2]*2**32+c[4*W+3],V.push({from:O,to:N});return{ranges:V,
actualTileWidth:q<t-1?z:Math.ceil(x/X)-z*(t-1),actualTileHeight:h<A-1?B:Math.ceil(v/X)-B*(A-1)}};b._parseHeader=function(c){var h=e.getElement(c,"MRF_META/Raster");if(!h)throw new I("mrf:open","not a valid MRF format");var q=e.getElement(h,"Size"),z=parseInt(q.getAttribute("x"),10),B=parseInt(q.getAttribute("y"),10);const r=parseInt(q.getAttribute("c"),10);q=(e.getElementValue(h,"Compression")||"none").toLowerCase();if(!u.has(q))throw new I("mrf:open","currently does not support compression "+q);
var x=e.getElementValue(h,"DataType")||"UInt8";const v=w.get(x);if(null==v)throw new I("mrf:open","currently does not support pixel type "+x);var E=e.getElement(h,"PageSize");x=parseInt(E.getAttribute("x"),10);E=parseInt(E.getAttribute("y"),10);h=e.getElement(h,"DataValues");let t;h&&(h=h.getAttribute("NoData"),null!=h&&(t=h.trim().split(" ").map(G=>parseFloat(G))));if(e.getElement(c,"MRF_META/CachedSource"))throw new I("mrf:open","currently does not support MRF referencing other data files");var A=
e.getElement(c,"MRF_META/GeoTags"),O=e.getElement(A,"BoundingBox");h=!1;if(null!=O){var N=parseFloat(O.getAttribute("minx"));var X=parseFloat(O.getAttribute("miny")),V=parseFloat(O.getAttribute("maxx"));O=parseFloat(O.getAttribute("maxy"));var W=e.getElementValue(A,"Projection")||"";A=K.WGS84;"LOCAL_CS[]"!==W?W.toLowerCase().startsWith("epsg:")?(W=Number(W.slice(5)),isNaN(W)||0===W||(A=new K({wkid:W}))):A=m.parseSpatialReference(W)??K.WGS84:(h=!0,A=new K({wkid:3857}));N=new F(N,X,V,O);N.spatialReference=
A}else h=!0,N=new F({xmin:-.5,ymin:.5-B,xmax:z-.5,ymax:.5,spatialReference:new K({wkid:3857})});X=e.getElement(c,"MRF_META/Rsets");V=parseInt(X&&X.getAttribute("scale")||"2",10);X=N.spatialReference;x=new a({origin:new g({x:N.xmin,y:N.ymax,spatialReference:X}),blockWidth:x,blockHeight:E,pyramidBlockWidth:x,pyramidBlockHeight:E,compression:q,pyramidScalingFactor:V});E=new g({x:N.width/z,y:N.height/B,spatialReference:X});z=new l({width:z,height:B,extent:N,isPseudoSpatialReference:h,spatialReference:X,
bandCount:r,pixelType:v,pixelSize:E,noDataValue:t,storageInfo:x});B=e.getElementValue(c,"datafile");c=e.getElementValue(c,"IndexFile");c={mrf:this.url,index:c||this.url.replace(".mrf",".idx"),data:B||this.url.replace(".mrf",u.get(q).blobExtension)};return{rasterInfo:z,files:c}};b._fetchAuxiliaryData=function(){var c=M._asyncToGenerator(function*(h){try{const {data:q}=yield this.request(this.url+".aux.xml",{responseType:"xml",signal:h?.signal});return m.parsePAMInfo(q)}catch{return null}});return function(h){return c.apply(this,
arguments)}}();return d}(f);D.__decorate([R.property()],H.prototype,"_files",void 0);D.__decorate([R.property()],H.prototype,"_storageIndex",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=D.__decorate([L.subclass("esri.layers.support.rasterIO.MRFRaster")],H)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(M,D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u){H=function(C){function d(){var c=C.apply(this,arguments)||this;c._files=null;c._headerInfo=null;c._bufferSize=1048576;c.datasetFormat="TIFF";return c}M._inheritsLoose(d,C);var b=d.prototype;b.open=function(){var c=M._asyncToGenerator(function*(h){yield this.init();var q=h?n.unwrap(h.signal):null,{data:z}=yield this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:q});if(!z)throw new I("tiffraster:open","failed to open url "+
this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {littleEndian:B,firstIFDPos:r,isBigTiff:x}=e.parseSignature(z),v=[];yield this._readIFDs(v,z,B,r,0,x?8:4,q);const {imageInfo:E,rasterInfo:t}=this._parseIFDs(v);this._headerInfo={littleEndian:B,isBigTiff:x,ifds:v,...E};this._set("rasterInfo",t);if(!E.isSupported)throw new I("tiffraster:open","this tiff is not supported: "+E.message);if(!E.tileWidth)throw new I("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");
({skipExtensions:q=[]}=this.ioConfig);q.includes("aux.xml")||(z=yield this._fetchAuxiliaryMetaData(h),null!=z&&this._processPAMInfo(z,t));q.includes("vat.dbf")||1!==t.bandCount||"u8"!==t.pixelType||(t.attributeTable=yield this._fetchAuxiliaryTable(h),n.isSome(t.attributeTable)&&(t.keyProperties.DataType="thematic"));this.updateTileInfo()});return function(h){return c.apply(this,arguments)}}();b.fetchRawTile=function(){var c=M._asyncToGenerator(function*(h,q,z,B={}){if(!this._headerInfo?.isSupported||
this.isBlockOutside(h,q,z))return null;q=this._getTileLocation(h,q,z);if(!q)return null;const {ranges:r,actualTileWidth:x,actualTileHeight:v,ifd:E}=q;q=r.map(X=>this.request(this.url,{range:X,responseType:"array-buffer",signal:B.signal}));q=yield Promise.all(q);z=q.map(X=>X.data.byteLength).reduce((X,V)=>X+V);z=1===q.length?q[0].data:new ArrayBuffer(z);var t=[0],A=[0];if(1<q.length){const X=new Uint8Array(z);for(let V=0,W=0;V<q.length;V++){const G=q[V].data;X.set(new Uint8Array(G),W);t[V]=W;W+=G.byteLength;
A[V]=G.byteLength}}const {blockWidth:O,blockHeight:N}=this.getBlockWidthHeight(h);h=yield this.decodePixelBlock(z,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:E,offsets:t,sizes:A},width:O,height:N,planes:null,pixelType:null});if(x!==O||v!==N)if(A=h.mask)for(q=0;q<N;q++)for(t=q*O,z=q<v?x:0;z<O;z++)A[t+z]=0;else for(A=new Uint8Array(O*N),h.mask=A,q=0;q<v;q++)for(t=q*O,z=0;z<x;z++)A[t+z]=1;return h});return function(h,q,z){return c.apply(this,arguments)}}();b._parseIFDs=function(c){const h=
e.getImageInfo(c),{width:q,height:z,tileWidth:B,tileHeight:r,planes:x,pixelType:v,compression:E,firstPyramidLevel:t,maximumPyramidLevel:A,pyramidBlockWidth:O,pyramidBlockHeight:N,tileBoundary:X,affine:V,metadata:W}=h;let G=m.parseSpatialReference(h.extent.spatialReference?.wkt||h.extent.spatialReference?.wkid);var S=!1;null==G&&(S=!0,G=new g({wkid:3857}));const T=new w({...h.extent,spatialReference:G});var aa=T?new u({x:T.xmin,y:T.ymax,spatialReference:G}):new u({x:0,y:0});aa=new l({blockWidth:B,
blockHeight:r,pyramidBlockWidth:O,pyramidBlockHeight:N,compression:E,origin:aa,firstPyramidLevel:t,maximumPyramidLevel:A,blockBoundary:X});const Z=new u({x:(T.xmax-T.xmin)/q,y:(T.ymax-T.ymin)/z,spatialReference:G}),Q=W?{BandProperties:W.bandProperties,DataType:W.dataType}:{};let Y=null;var ba=c[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];c=c[0].get("COLORMAP")?.values;if(3===ba&&3<c?.length&&0===c.length%3){Y=[];ba=c.length/3;for(let ca=0;ca<ba;ca++)Y.push([ca,c[ca]>>>8,c[ca+ba]>>>8,c[ca+2*ba]>>>
8])}S=new k({width:q,height:z,bandCount:x,pixelType:v,pixelSize:Z,storageInfo:aa,spatialReference:G,isPseudoSpatialReference:S,keyProperties:Q,extent:T,colormap:Y,statistics:W?W.statistics:null});V?.length&&(S.nativeExtent=new w({xmin:-.5,ymin:.5-z,xmax:q-.5,ymax:.5,spatialReference:G}),S.transform=new K({polynomialOrder:1,forwardCoefficients:[V[2]+V[0]/2,V[5]-V[3]/2,V[0],V[3],-V[1],-V[4]]}),S.extent=S.transform.forwardTransform(S.nativeExtent),S.pixelSize=new u({x:(T.xmax-T.xmin)/q,y:(T.ymax-T.ymin)/
z,spatialReference:G}),aa.origin.x=-.5,aa.origin.y=.5);return{imageInfo:h,rasterInfo:S}};b._processPAMInfo=function(c,h){h.statistics=c.statistics??h.statistics;(h.histograms=c.histograms)&&n.isNone(h.statistics)&&(h.statistics=y.estimateStatisticsFromHistograms(c.histograms));if(c.transform&&n.isNone(h.transform)){h.transform=c.transform;h.nativeExtent=h.extent;const q=h.transform.forwardTransform(h.nativeExtent);h.pixelSize=new u({x:(q.xmax-q.xmin)/h.width,y:(q.ymax-q.ymin)/h.height,spatialReference:h.spatialReference});
h.extent=q}h.spatialReference||(h.spatialReference=c.spatialReference)};b._readIFDs=function(){var c=M._asyncToGenerator(function*(h,q,z,B,r,x=4,v){if(!B)return null;if(B>=q.byteLength||0>B)q=(yield this.request(this.url,{range:{from:B+r,to:B+r+this._bufferSize},responseType:"array-buffer",signal:v})).data,r=B+r,B=0;B=yield this._readIFD(q,z,B,r,p.TIFF_TAGS,x,v);h.push(B.ifd);if(!B.nextIFD)return null;yield this._readIFDs(h,q,z,B.nextIFD-r,r,x,v)});return function(h,q,z,B,r){return c.apply(this,arguments)}}();
b._readIFD=function(){var c=M._asyncToGenerator(function*(h,q,z,B,r=p.TIFF_TAGS,x=4,v){if(!h)return null;z=e.parseIFD(h,q,z,B,r,x);if(z.success){const E=[];z.ifd?.forEach(t=>{t.values||E.push(t)});0<E.length&&(x=E.map(t=>t.offlineOffsetSize).filter(n.isSome),r=Math.min.apply(null,x.map(t=>t[0])),Math.min.apply(null,x.map(t=>t[0]+t[1]))-r<=this._bufferSize&&({data:x}=yield this.request(this.url,{range:{from:r,to:r+this._bufferSize},responseType:"array-buffer",signal:v}),h=x,B=r,E.forEach(t=>e.parseFieldValues(h,
q,t,B))));z.ifd?.has("GEOKEYDIRECTORY")&&(r=z.ifd.get("GEOKEYDIRECTORY"),(x=r?.values)&&4<x.length&&(x=x[0]+"."+x[1]+"."+x[2],v=yield this._readIFD(h,q,r.valueOffset+6-B,B,p.GEO_KEYS,2,v),r.data=v.ifd,r.data&&r.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[x]})));return z}if(z.requiredBufferSize&&z.requiredBufferSize!==h.byteLength)return h=(yield this.request(this.url,{range:{from:B,to:B+z.requiredBufferSize+4},responseType:"array-buffer",signal:v})).data,h.byteLength<
z.requiredBufferSize?null:this._readIFD(h,q,0,B,p.TIFF_TAGS,4,v)});return function(h,q,z,B){return c.apply(this,arguments)}}();b._getTileLocation=function(c,h,q){const {firstPyramidLevel:z,blockBoundary:B}=this.rasterInfo.storageInfo;var r=0===c?0:c-(z-1);c=this._headerInfo?.ifds[r];if(!c)return null;var x=e.isBSQConfig(c,this._headerInfo);const v=c.get("TILEOFFSETS")?.values;if(void 0===v)return null;var E=c.get("TILEBYTECOUNTS")?.values;const {minRow:t,minCol:A,maxRow:O,maxCol:N}=B[r];if(h>O||q>
N||h<t||q<A)return null;r=c.get("IMAGEWIDTH")?.values?.[0];const X=c.get("IMAGELENGTH")?.values?.[0],V=c.get("TILEWIDTH")?.values?.[0],W=c.get("TILELENGTH")?.values?.[0],G=x?this.rasterInfo.bandCount:1,S=G*h*(N+1)+q,T=[{from:v[S],to:v[S+G-1]+E[S+G-1]-1}];if(x){x=!0;for(let aa=0;aa<G;aa++)if(v[S+aa]+E[S+aa]!==v[S+aa+1]){x=!1;break}if(!x)for(x=0;x<G;x++)T[x]={from:v[S+x],to:v[S+x]+E[S+x]-1}}E=E[S];return null==v[S]||null==E?null:{ranges:T,ifd:c,actualTileWidth:q===N?r%V||V:V,actualTileHeight:h===O?
X%W||W:W}};b._fetchAuxiliaryMetaData=function(){var c=M._asyncToGenerator(function*(h){try{const {data:q}=yield this.request(this.url+".aux.xml",{responseType:"xml",signal:h?.signal});return m.parsePAMInfo(q)}catch{return null}});return function(h){return c.apply(this,arguments)}}();b._fetchAuxiliaryTable=function(){var c=M._asyncToGenerator(function*(h){try{const {data:q}=yield this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:h?.signal}),z=f.parse(q);return z?.recordSet?F.fromJSON(z.recordSet):
null}catch{return null}});return function(h){return c.apply(this,arguments)}}();return d}(a);D.__decorate([R.property()],H.prototype,"_files",void 0);D.__decorate([R.property()],H.prototype,"_headerInfo",void 0);D.__decorate([R.property()],H.prototype,"_bufferSize",void 0);D.__decorate([R.property({type:String,json:{write:!0}})],H.prototype,"datasetFormat",void 0);return H=D.__decorate([L.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],H)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../rasterRenderers ../core/Error ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ./Layer ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils".split(" "),function(M,
D,H,I,n,R,P,J,L,k,l,a,f,m,e,p,y,K,F,g,w,u,C,d,b,c,h,q,z,B,r){P=function(x){function v(...t){t=x.call(this,...t)||this;t.bandIds=null;t.interpolation=null;t.legendEnabled=!0;t.isReference=null;t.listMode="show";t.sourceJSON=null;t.version=null;t.title=null;t.type="imagery-tile";t.operationalLayerType="ArcGISTiledImageServiceLayer";t.popupEnabled=!0;t.popupTemplate=null;t.fields=null;return t}M._inheritsLoose(v,x);var E=v.prototype;E.normalizeCtorArgs=function(t,A){return"string"===typeof t?{url:t,
...A}:t};E.load=function(t){const A=R.isSome(t)?t.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},t).catch(J.throwIfAbortError).then(()=>this._openRaster(A)));return Promise.resolve(this)};E.readRenderer=function(t,A,O){t=I.read(A&&A.layerDefinition&&A.layerDefinition.drawingInfo&&A.layerDefinition.drawingInfo.renderer,O)||void 0;if(null!=t)return t};E.createPopupTemplate=function(t){return r.createPopupTemplate({fields:this.rasterFields,title:this.title},
t)};E.write=function(t,A){const {raster:O}=this;if(this.loaded?"RasterTileServer"===O.datasetFormat&&("Raster"===O.tileType||"Map"===O.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return x.prototype.write.call(this,t,A);A&&A.messages&&A.messages.push(new n("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${A.origin}/${A.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null};E._openRaster=
function(){var t=M._asyncToGenerator(function*(A){this.raster?(this.raster.rasterInfo||(yield this.raster.open()),this.url=this.raster.url):(A=yield z.open({url:this.url,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:A}),this.rasterFunction?(A=B.create(this.rasterFunction.toJSON(),{raster:A}),A=new q({rasterFunction:A}),yield A.open(),this.raster=A):this.raster=A);({rasterInfo:A}=this.raster);if(!A)throw new n("imagery-tile-layer:load",
"cannot load resources on "+this.url);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON&&this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"});null==this.title&&(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.addHandles(L.watch(()=>this.customParameters,O=>{this.raster.ioConfig.customFetchParameters=
O}))});return function(A){return t.apply(this,arguments)}}();M._createClass(v,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){let t=[new c({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})];var {rasterInfo:A}=this,{attributeTable:O}=A;if(O=R.isSome(O)?O.fields:null)O=O.filter(V=>"oid"!==V.type&&"value"!==V.name.toLowerCase()).map(V=>{const W=V.clone();W.name="Raster."+V.name;return W}),
t=t.concat(O);const {dataType:N,multidimensionalInfo:X}=A;"vector-magdir"!==N&&"vector-uv"!==N||!R.isSome(X)||(A=X.variables[0].unit?.trim(),t.push(new c({name:"Raster.Magnitude",alias:"Magnitude"+(A?` (${A})`:""),domain:null,editable:!1,type:"double"})),t.push(new c({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"})));return t}},{key:"renderer",set:function(t){this._set("renderer",t);this.updateRenderer()}}]);return v}(y.BlendLayer(C.ScaleRangeLayer(g.OperationalLayer(w.PortalLayer(K.CustomParametersMixin(F.ImageryTileMixin(d.TemporalLayer(u.RefreshableLayer(P.MultiOriginJSONMixin(p))))))))));
D.__decorate([k.property({type:[a.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],P.prototype,"bandIds",void 0);D.__decorate([k.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),f.enumeration(h.interpolationKebab)],P.prototype,"interpolation",void 0);D.__decorate([k.property({json:{write:!0}})],P.prototype,"multidimensionalDefinition",
void 0);D.__decorate([k.property(b.legendEnabled)],P.prototype,"legendEnabled",void 0);D.__decorate([k.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],P.prototype,"isReference",void 0);D.__decorate([k.property({type:["show","hide"]})],P.prototype,"listMode",void 0);D.__decorate([k.property({json:{read:!0,write:!0}})],P.prototype,"blendMode",void 0);D.__decorate([k.property()],P.prototype,"sourceJSON",void 0);D.__decorate([k.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],
P.prototype,"version",void 0);D.__decorate([k.property()],P.prototype,"title",void 0);D.__decorate([k.property({readOnly:!0,json:{read:!1}})],P.prototype,"type",void 0);D.__decorate([k.property({type:["ArcGISTiledImageServiceLayer"]})],P.prototype,"operationalLayerType",void 0);D.__decorate([k.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(x,v){return!v.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},
writer(x,v,E){v[E]=!x}}}})],P.prototype,"popupEnabled",void 0);D.__decorate([k.property({type:H,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],P.prototype,"popupTemplate",void 0);D.__decorate([k.property({readOnly:!0})],P.prototype,"defaultPopupTemplate",null);D.__decorate([k.property({readOnly:!0,type:[c]})],P.prototype,"fields",void 0);D.__decorate([k.property({readOnly:!0,type:[c]})],P.prototype,"rasterFields",
null);D.__decorate([k.property({types:I.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const x="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!x}}},origins:{"web-scene":{types:I.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(x){return{enabled:x&&"vector-field"!==x.type&&"flow"!==x.type}}}}}}})],
P.prototype,"renderer",null);D.__decorate([m.reader("renderer")],P.prototype,"readRenderer",null);return P=D.__decorate([e.subclass("esri.layers.ImageryTileLayer")],P)});