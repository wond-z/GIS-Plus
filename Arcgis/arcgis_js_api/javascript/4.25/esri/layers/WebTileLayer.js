// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../geometry ../request ../core/Error ../core/MultiOriginJSONSupport ../core/string ../core/urlUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./Layer ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./support/LOD ./support/TileInfo ./support/WMTSLayerInfo ../geometry/SpatialReference ../geometry/Extent ../geometry/Point".split(" "),
function(r,e,d,t,y,z,A,p,f,M,N,u,B,C,D,E,F,G,H,I,c,v,J,m,w,K){d=function(x){function q(...a){a=x.call(this,...a)||this;a.copyright="";a.fullExtent=new w(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,m.WebMercator);a.legendEnabled=!1;a.isReference=null;a.popupEnabled=!1;a.spatialReference=m.WebMercator;a.subDomains=null;a.tileInfo=new v({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new K({x:-2.0037508342787E7,y:2.0037508342787E7,spatialReference:m.WebMercator}),
spatialReference:m.WebMercator,lods:[new c({level:0,scale:5.91657527591555E8,resolution:156543.033928}),new c({level:1,scale:2.95828763795777E8,resolution:78271.5169639999}),new c({level:2,scale:1.47914381897889E8,resolution:39135.7584820001}),new c({level:3,scale:7.3957190948944E7,resolution:19567.8792409999}),new c({level:4,scale:3.6978595474472E7,resolution:9783.93962049996}),new c({level:5,scale:1.8489297737236E7,resolution:4891.96981024998}),new c({level:6,scale:9244648.868618,resolution:2445.98490512499}),
new c({level:7,scale:4622324.434309,resolution:1222.99245256249}),new c({level:8,scale:2311162.217155,resolution:611.49622628138}),new c({level:9,scale:1155581.108577,resolution:305.748113140558}),new c({level:10,scale:577790.554289,resolution:152.874056570411}),new c({level:11,scale:288895.277144,resolution:76.4370282850732}),new c({level:12,scale:144447.638572,resolution:38.2185141425366}),new c({level:13,scale:72223.819286,resolution:19.1092570712683}),new c({level:14,scale:36111.909643,resolution:9.55462853563415}),
new c({level:15,scale:18055.954822,resolution:4.77731426794937}),new c({level:16,scale:9027.977411,resolution:2.38865713397468}),new c({level:17,scale:4513.988705,resolution:1.19432856685505}),new c({level:18,scale:2256.994353,resolution:.597164283559817}),new c({level:19,scale:1128.497176,resolution:.298582141647617}),new c({level:20,scale:564.248588,resolution:.14929107082380833}),new c({level:21,scale:282.124294,resolution:.07464553541190416}),new c({level:22,scale:141.062147,resolution:.03732276770595208}),
new c({level:23,scale:70.5310735,resolution:.01866138385297604})]});a.type="web-tile";a.urlTemplate=null;a.wmtsInfo=null;return a}r._inheritsLoose(q,x);var k=q.prototype;k.normalizeCtorArgs=function(a,b){return"string"===typeof a?{urlTemplate:a,...b}:a};k.load=function(a){a=this.loadFromPortal({supportedTypes:["WMTS"]},a).then(()=>{let b="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const g=new p.Url(this.urlTemplate);this.subDomains&&0<this.subDomains.length||
!g.authority.includes("{subDomain}")||(b="is missing 'subDomains' property")}else b="spatialReference must match tileInfo.spatialReference";else b="is missing the required 'urlTemplate' property value";if(b)throw new y("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${b}`);});this.addResolvingPromise(a);return Promise.resolve(this)};k.readSpatialReference=function(a,b){return a||b.fullExtent&&b.fullExtent.spatialReference&&m.fromJSON(b.fullExtent.spatialReference)};
k.readUrlTemplate=function(a,b){return a||b.templateUrl};k.writeUrlTemplate=function(a,b){a&&p.isProtocolRelative(a)&&(a="https:"+a);a&&(a=a.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),a=p.normalize(a));b.templateUrl=a};k.fetchTile=function(a,b,g,h={}){({signal:h}=h);a=this.getTileUrl(a,b,g);return t(a,{responseType:"image",signal:h,query:{...this.refreshParameters}}).then(l=>l.data)};k.fetchImageBitmapTile=function(){var a=r._asyncToGenerator(function*(b,g,
h,l={}){({signal:l}=l);b=this.getTileUrl(b,g,h);({data:b}=yield t(b,{responseType:"blob",signal:l,query:{...this.refreshParameters}}));return createImageBitmap(b)});return function(b,g,h){return a.apply(this,arguments)}}();k.getTileUrl=function(a,b,g){a=this.levelValues[a];return this.tileServers[b%this.tileServers.length]+A.replace(this.urlPath,{level:a,z:a,col:g,x:g,row:b,y:b})};r._createClass(q,[{key:"levelValues",get:function(){const a=[];if(!this.tileInfo)return null;for(const b of this.tileInfo.lods)a[b.level]=
b.levelValue||b.level;return a}},{key:"tileServers",get:function(){if(!this.urlTemplate)return null;const a=[],{urlTemplate:b,subDomains:g}=this,h=new p.Url(b),l=h.scheme?h.scheme+"://":"//",L=l+h.authority+"/";if(!h.authority.includes("{subDomain}"))a.push(L);else if(g&&0<g.length&&1<h.authority.split(".").length)for(const n of g)a.push(l+h.authority.replace(/\{subDomain\}/gi,n)+"/");return a.map(n=>{"/"!==n.charAt(n.length-1)&&(n+="/");return n})}},{key:"urlPath",get:function(){if(!this.urlTemplate)return null;
const a=this.urlTemplate,b=new p.Url(a);return a.substring(((b.scheme?b.scheme+"://":"//")+b.authority+"/").length)}}]);return q}(E.BlendLayer(H.RefreshableLayer(I.ScaleRangeLayer(F.OperationalLayer(G.PortalLayer(z.MultiOriginJSONMixin(D)))))));e.__decorate([f.property({type:String,value:"",json:{write:!0}})],d.prototype,"copyright",void 0);e.__decorate([f.property({type:w,json:{write:!0},nonNullable:!0})],d.prototype,"fullExtent",void 0);e.__decorate([f.property({readOnly:!0,json:{read:!1,write:!1}})],
d.prototype,"legendEnabled",void 0);e.__decorate([f.property({type:["show","hide"]})],d.prototype,"listMode",void 0);e.__decorate([f.property({json:{read:!0,write:!0}})],d.prototype,"blendMode",void 0);e.__decorate([f.property()],d.prototype,"levelValues",null);e.__decorate([f.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],d.prototype,"isReference",void 0);e.__decorate([f.property({type:["WebTiledLayer"],value:"WebTiledLayer"})],d.prototype,"operationalLayerType",
void 0);e.__decorate([f.property({readOnly:!0,json:{read:!1,write:!1}})],d.prototype,"popupEnabled",void 0);e.__decorate([f.property({type:m})],d.prototype,"spatialReference",void 0);e.__decorate([u.reader("spatialReference",["spatialReference","fullExtent.spatialReference"])],d.prototype,"readSpatialReference",null);e.__decorate([f.property({type:[String],json:{write:!0}})],d.prototype,"subDomains",void 0);e.__decorate([f.property({type:v,json:{write:!0}})],d.prototype,"tileInfo",void 0);e.__decorate([f.property({readOnly:!0})],
d.prototype,"tileServers",null);e.__decorate([f.property({json:{read:!1}})],d.prototype,"type",void 0);e.__decorate([f.property()],d.prototype,"urlPath",null);e.__decorate([f.property({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],d.prototype,"urlTemplate",void 0);e.__decorate([u.reader("urlTemplate",["urlTemplate","templateUrl"])],d.prototype,"readUrlTemplate",null);e.__decorate([C.writer("urlTemplate",{templateUrl:{type:String}})],d.prototype,"writeUrlTemplate",null);e.__decorate([f.property({type:J.WMTSLayerInfo,
json:{write:!0}})],d.prototype,"wmtsInfo",void 0);return d=e.__decorate([B.subclass("esri.layers.WebTileLayer")],d)});