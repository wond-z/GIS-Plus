// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),function(z,na,Aa,oa,w,I,y,B,N,C,pa,qa){function P(a,b,c){return!B.canProjectWithoutEngine(a,b,c)}function J(a,b,c){if((a=P(a,b,c))&&!B.isLoaded())throw new oa("rasterprojectionhelper-project",
"projection engine is not loaded");return a}function Q(){Q=na._asyncToGenerator(function*(){B.isLoaded()||(yield B.load())});return Q.apply(this,arguments)}function R(a,b,c,f=null){const k=a.spatialReference;if(k.equals(b))return a;J(k,b,f);c=c.center;c=new N({xmin:c.x-a.x/2,xmax:c.x+a.x/2,ymin:c.y-a.y/2,ymax:c.y+a.y/2,spatialReference:k});f=B.project(c,b,f);c=F(b);w.isNone(f)||w.isSome(c)&&f.width>=c?(b=I.getMetersPerUnitForSR(k)/I.getMetersPerUnitForSR(b),a={x:a.x*b,y:a.y*b}):a={x:f.width,y:f.height};
return a}function E(a,b=.01){return I.getMetersPerUnitForSR(a)?b/I.getMetersPerUnitForSR(a):0}function S(a,b,c=null,f=!0){const k=a.spatialReference;if(k.equals(b))return a;J(k,b,c);c=B.project(a,b,c);if(!f||!c)return c;aa([a],[c],k,b);return c}function aa(a,b,c,f){const k=O(c,!0),d=O(f,!0);c=E(c,500);f=E(f,500);if(c&&w.isSome(k)&&w.isSome(d))for(let h=0;h<a.length;h++){const g=b[h];if(!g)continue;const {x:e}=a[h],{x:m}=g;m>=d[1]-f&&Math.abs(e-k[0])<c?g.x-=d[1]-d[0]:m<=d[0]+f&&Math.abs(e-k[1])<c&&
(g.x+=d[1]-d[0])}}function ba(a){const {inSR:b,outSR:c,datumTransformation:f,preferPE:k}=a;if(b.equals(c))return{points:a}=T(a,null),a;if(b.isWebMercator&&c.isWGS84||b.isWGS84&&c.isWebMercator){const {cols:m,rows:l,xres:n,yres:q,usePixelCenter:p,inSR:v,outSR:t}=a;let {xmin:u,ymax:r}=a;p&&(u+=n/2,r-=q/2);a=[];var d=[],h=Math.max(m,l);for(var g=0;g<h;g++){var e=B.project(new C({x:u+n*Math.min(m,g),y:r-q*Math.min(l,g),spatialReference:v}),t);g<=m&&a.push(e.x);g<=l&&d.push(e.y)}h=[];for(g=0;g<m;g++)for(e=
0;e<l;e++)h.push([a[g],d[e]]);return h}if(J(b,c,f)&&k){if(b.isGeographic)return ca(a);d=H(b);if(w.isSome(d))return ca(a)}return ra(a)}function ra(a){var {points:b}=T(a,null);const {inSR:c,outSR:f,datumTransformation:k}=a;a=b.map(d=>new C(d[0],d[1],c));b=B.project(a,f,k);k&&aa(a,b,c,f);return b.map(d=>d?[d.x,d.y]:[NaN,NaN])}function ca(a){const {inSR:b,outSR:c,datumTransformation:f}=a;var k=H(b);const {points:d,mask:h}=T(a,k);b.isGeographic||(a=b.wkid?y.PeFactory.coordsys(b.wkid):y.PeFactory.fromString(b.isGeographic?
y.PeDefs.PE_TYPE_GEOGCS:y.PeDefs.PE_TYPE_PROJCS,b.wkt),y.PeCSTransformations.projToGeog(a,d.length,d));if(w.isSome(f)&&f.steps.length){var g;c.isGeographic&&(g=d.map(([e])=>179.9955<e?1:-179.9955>e?-1:0));f.steps.forEach(e=>{const m=e.wkid?y.PeFactory.geogtran(e.wkid):y.PeFactory.fromString(y.PeDefs.PE_TYPE_GEOGTRAN,e.wkt);y.PeGTTransformations.geogToGeog(m,d.length,d,null,e.isInverse?y.PeDefs.PE_TRANSFORM_2_TO_1:y.PeDefs.PE_TRANSFORM_1_TO_2)});if(g)for(a=0;a<d.length;a++){k=g[a];const e=d[a][0],
m=179.9955<e?1:-179.9955>e?-1:0;k&&m&&k!==m&&(d[a][0]=0<k?e+360:e-360)}}c.isGeographic||(g=H(c,!0),g=w.isSome(g)&&g.isEnvelope?[g.bbox[1],g.bbox[3]]:[-90,90],sa(d,g),g=c.wkid?y.PeFactory.coordsys(c.wkid):y.PeFactory.fromString(c.isGeographic?y.PeDefs.PE_TYPE_GEOGCS:y.PeDefs.PE_TYPE_PROJCS,c.wkt),y.PeCSTransformations.geogToProj(g,d.length,d));g=d;if(h&&d.length!==h.length){g=[];for(let e=0,m=0;e<h.length;e++)h[e]?g.push(d[m++]):g.push([NaN,NaN])}return g}function H(a,b=!1){var c=a.wkid||a.wkt;if(!c||
a.isGeographic)return null;c=String(c);if(U.has(c))return c=U.get(c),b?c?.gcs:c?.pcs;var f=a.wkid?y.PeFactory.coordsys(a.wkid):y.PeFactory.fromString(a.isGeographic?y.PeDefs.PE_TYPE_GEOGCS:y.PeDefs.PE_TYPE_PROJCS,a.wkt);a=E(a,1E-4);a=da(f,a);f=da(f,0,!0);U.set(c,{pcs:a,gcs:f});return b?f:a}function da(a,b=0,c=!1){var f=y.PePCSInfo.generate(a),k=c?a.horizonGcsGenerate():a.horizonPcsGenerate();if(!f||!k?.length)return null;a=!1;var d=k.find(l=>1===l.getInclusive()&&1===l.getKind());if(!d){d=k.find(l=>
1===l.getInclusive()&&0===l.getKind());if(!d)return null;a=!0}c=c?0:(2===f.getNorthPoleLocation()?1:0)|(2===f.getSouthPoleLocation()?2:0);f=f.isPannableRectangle();d=d.getCoord();if(a)return{isEnvelope:a,isPannable:f,vertices:d,coef:null,bbox:[d[0][0]-b,d[0][1]-b,d[1][0]+b,d[1][1]+b],poleLocation:c};b=0;a=[];let [h,g]=d[0],[e,m]=d[0];for(let l=0,n=d.length;l<n;l++){b++;b===n&&(b=0);const [q,p]=d[l],[v,t]=d[b];if(t===p)a.push([q,v,p,t,2]);else{k=(v-q)/(t-p||1E-4);const u=q-k*p;p<t?a.push([k,u,p,t,
0]):a.push([k,u,t,p,1])}h=h<q?h:q;g=g<p?g:p;e=e>q?e:q;m=m>p?m:p}return{isEnvelope:!1,isPannable:f,vertices:d,coef:a,bbox:[h,g,e,m],poleLocation:c}}function T(a,b){const c=[],{cols:f,rows:k,xres:d,yres:h,usePixelCenter:g}=a;let {xmin:e,ymax:m}=a;g&&(e+=d/2,m-=h/2);if(w.isNone(b)){for(a=0;a<f;a++)for(b=0;b<k;b++)c.push([e+d*a,m-h*b]);return{points:c}}a=new Uint8Array(f*k);if(b.isEnvelope){const {bbox:[u,r,A,D]}=b;for(let G=0,K=0;G<f;G++){var l=e+d*G,n=b.isPannable||l>=u&&l<=A;for(var q=0;q<k;q++,K++){var p=
m-h*q;n&&p>=r&&p<=D&&(c.push([l,p]),a[K]=1)}}return{points:c,mask:a}}l=b.coef;b=[];for(n=0;n<k;n++){var v=m-h*n;q=[];p=[];for(var t=0;t<l.length;t++){const [u,r,A,D,G]=l[t];v===A&&A===D?(q.push(u),q.push(r),p.push(2),p.push(2)):v>=A&&v<=D&&(q.push(u*v+r),p.push(G))}v=q;if(2<q.length){t=2===p[0]?0:p[0];let u=q[0];v=[];for(let r=1;r<p.length;r++)if(2!==p[r]||r===p.length-1)p[r]!==t&&(v.push(0===t?Math.min(u,q[r-1]):Math.max(u,q[r-1])),t=p[r],u=q[r]),r===p.length-1&&v.push(0===p[r]?Math.min(u,q[r]):
Math.max(u,q[r]));v.sort((r,A)=>r-A)}else q[0]>q[1]&&(v=[q[1],q[0]]);b.push(v)}for(let u=0,r=0;u<f;u++)for(l=e+d*u,n=0;n<k;n++,r++)if(q=m-h*n,p=b[n],2===p.length)l>=p[0]&&l<=p[1]&&(c.push([l,q]),a[r]=1);else if(2<p.length){v=!1;for(t=0;t<p.length;t+=2)if(l>=p[t]&&l<=p[t+1]){v=!0;break}v&&(c.push([l,q]),a[r]=1)}return{points:c,mask:a}}function sa(a,b){const [c,f]=b;for(b=0;b<a.length;b++){const k=a[b][1];if(k<c||k>f)a[b]=[NaN,NaN]}}function ea(a){const b=F(a[0].spatialReference);if(2>a.length||w.isNone(b))return a[0];
let {xmin:c,xmax:f,ymin:k,ymax:d}=a[0];for(let h=1;h<a.length;h++){const g=a[h];f=g.xmax+b*h;k=Math.min(k,g.ymin);d=Math.max(d,g.ymax)}return new N({xmin:c,xmax:f,ymin:k,ymax:d,spatialReference:a[0].spatialReference})}function V(a,b,c=null,f=!0){var k=a.spatialReference;if(k.equals(b))return a;var d=fa(a);const h=F(k,!0);var g=F(b);if(0===d||w.isNone(h)||w.isNone(g))return d=ha(a,b,c,f),w.isNone(h)&&w.isSome(g)&&Math.abs(d.width-g)<E(b)&&B.isLoaded()&&(k=H(k),w.isSome(k)&&k.poleLocation===W.None&&
a.width<(k.bbox[2]-k.bbox[0])/2)?ta(a,b)||d:d;g=a.clone().normalize();if(1===g.length&&a.xmax<h&&a.xmax-h/2>E(k)){const {xmin:e,xmax:m}=a;for(let l=0;l<=d;l++)g[l]=new N({xmin:0===l?e:-h/2,xmax:l===d?m-h*l:h/2,ymin:a.ymin,ymax:a.ymax,spatialReference:k})}a=g.map(e=>ha(e,b,c,f));return ea(a.filter(w.isSome))}function ta(a,b){const c=F(b);if(w.isNone(c))return null;let {xmin:f,ymin:k,xmax:d,ymax:h}=a;var g=a.spatialReference;a=new pa({spatialReference:g,rings:[[[f,k],[d,k],[d,h],[f,h],[f,k]]]});a=B.project(a,
b);if(2!==a.rings.length||!a.rings[0].length||!a.rings[1].length)return null;({rings:a}=a);g=E(g);b=new N({spatialReference:b});for(let e=0;2>e;e++){f=d=a[e][0][0];k=h=a[e][0][1];for(let m=0;m<a[e].length;m++)f=f>a[e][m][0]?a[e][m][0]:f,d=d<a[e][m][0]?a[e][m][0]:d,k=k>a[e][m][1]?a[e][m][1]:k,h=h<a[e][m][1]?a[e][m][1]:h;if(0===e)b.ymin=k,b.ymax=h,b.xmin=f,b.xmax=d;else if(b.ymin=Math.min(b.ymin,k),b.ymax=Math.max(b.ymax,h),Math.abs(d-c/2)<g)b.xmin=f,b.xmax+=c;else if(Math.abs(f+c/2)<g)b.xmax=d+c;else return null}return b}
function ha(a,b,c=null,f=!0,k=!0){const d=a.spatialReference;if(d.equals(b)||!b)return a;J(d,b,c);const h=B.project(a,b,c);if(k&&b.isWebMercator&&h&&(h.ymax=Math.min(2.0037508342787E7,h.ymax),h.ymin=Math.max(-2.0037508342787E7,h.ymin),h.ymin>=h.ymax))return null;if(!f||!h)return h;var g=O(d,!0);f=O(b,!0);if(w.isNone(g)||w.isNone(f))return h;k=E(d,.001);const e=E(d,500);var m=E(b,.001);if(Math.abs(h.xmin-f[0])<m&&Math.abs(h.xmax-f[1])<m){m=Math.abs(a.xmin-g[0]);g=Math.abs(g[1]-a.xmax);if(m<k&&g>e){h.xmin=
f[0];var l=[];l.push(new C(a.xmax,a.ymin,d));l.push(new C(a.xmax,(a.ymin+a.ymax)/2,d));l.push(new C(a.xmax,a.ymax,d));l=l.map(n=>S(n,b,c)).filter(n=>!isNaN(n?.x)).map(n=>n.x);h.xmax=Math.max.apply(null,l)}g<k&&m>e&&(h.xmax=f[1],f=[],f.push(new C(a.xmin,a.ymin,d)),f.push(new C(a.xmin,(a.ymin+a.ymax)/2,d)),f.push(new C(a.xmin,a.ymax,d)),a=f.map(n=>S(n,b,c)).filter(n=>!isNaN(n?.x)).map(n=>n.x),h.xmin=Math.min.apply(null,a))}else a=E(b,.001),Math.abs(h.xmin-f[0])<a&&(h.xmin=f[0]),Math.abs(h.xmax-f[1])<
a&&(h.xmax=f[1]);return h}function F(a,b=!1){return a?a.isWebMercator?2*(b?2.0037508342787E7:2.0037508342788905E7):a.wkid&&a.isGeographic?360:2*ua[a.wkid]||null:null}function O(a,b=!1){if(a.isGeographic)return[-180,180];a=F(a,b);return w.isSome(a)?[-a/2,a/2]:null}function ia(a,b,c,f){a=(a-b)/c;0!==a-Math.floor(a)?a=Math.floor(a):f&&--a;return a}function fa(a,b=!1){var c=F(a.spatialReference);if(w.isNone(c))return 0;const f=b?0:-(c/2),k=E(a.spatialReference),d=!b&&Math.abs(a.xmin+c/2)<k?-c/2:a.xmin;
a=ia(!b&&Math.abs(a.xmax-c/2)<k?c/2:a.xmax,f,c,!0);c=ia(d,f,c,!1);return a-c}function X(a){const {projectedExtent:b,srcBufferExtent:c,pixelSize:f,datumTransformation:k,rasterTransform:d}=a;var h=b.spatialReference;const g=c.spatialReference;var e=J(h,g);const {xmin:m,ymin:l,xmax:n,ymax:q}=b,p=F(g),v=w.isSome(p)&&(a.hasWrapAround||"gcs-shift"===d?.type);a=a.spacing||[32,32];var t=a[0]*f.x,u=a[1]*f.y;const r=1===a[0],A=Math.ceil((n-m)/t-.1/a[0])+(r?0:1),D=Math.ceil((q-l)/u-.1/a[1])+(r?0:1);t=ba({cols:A,
rows:D,xmin:m,ymax:q,xres:t,yres:u,inSR:h,outSR:g,datumTransformation:k,preferPE:4>=a[0],usePixelCenter:r});u=[];let G,K=0;const ja=r?-1:NaN,{xmin:ka,xmax:Y,ymax:va,width:wa,height:xa}=c,ya=E(g,500),za=w.isSome(p)&&0<ka&&Y>p/2;var L=!1;e&&(L=H(h),L=w.isSome(L)&&0<L.poleLocation);for(h=0;h<A;h++){e=[];for(let M=0;M<D;M++){var x=t[h*D+M];v&&x[0]>Y&&x[0]>p/2-ya?x[0]-=p:v&&0===h&&0>x[0]&&za&&!d&&(x[0]+=p);!x||isNaN(x[0])||isNaN(x[1])?(u.push(ja),u.push(ja),e.push(null),K++):(d&&(x=d.inverseTransform(new C({x:x[0],
y:x[1],spatialReference:g})),x=[x.x,x.y]),e.push(x),0<h&&v&&G[M]&&x[0]<G[M][0]&&(x[0]+=p,L&&x[0]>Y&&x[0]>p&&(x[0]-=p)),u.push((x[0]-ka)/wa),u.push((va-x[1])/xa))}G=e}return{offsets:u,error:null,coefficients:null,outofBoundPointCount:K,spacing:a,size:r?[A,D]:[A-1,D-1]}}function la(a,b,c){const {cols:f,rows:k}=b;b=new Float32Array((f-1)*(k-1)*12);const d=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),h=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let q=0;q<f-1;q++){for(var g=0;g<k-1;g++){var e=q*k*2+2*
g,m=a[e];const p=a[e+1];var l=a[e+2],n=a[e+3];e+=2*k;const v=a[e],t=a[e+1],u=a[e+2];e=a[e+3];let r=0,A=12*(g*(f-1)+q);for(let D=0;3>D;D++)b[A++]=d[r++]*m+d[r++]*l+d[r++]*u;r=0;for(l=0;3>l;l++)b[A++]=d[r++]*p+d[r++]*n+d[r++]*e;r=0;for(n=0;3>n;n++)b[A++]=h[r++]*m+h[r++]*v+h[r++]*u;r=0;for(m=0;3>m;m++)b[A++]=h[r++]*p+h[r++]*t+h[r++]*e}if(c)for(g=0;g<b.length;g++)isNaN(b[g])&&(b[g]=-1)}return b}var W;(function(a){a[a.None=0]="None";a[a.North=1]="North";a[a.South=2]="South";a[a.Both=3]="Both"})(W||(W=
{}));const ma=(a,b,c,f=0)=>{if(1===c[0])return[0,0];var k=1,d=-1,h=1,g=-1;for(var e=0;e<a.length;e+=2)isNaN(a[e])||(k=k>a[e]?a[e]:k,d=d>a[e]?d:a[e],h=h>a[e+1]?a[e+1]:h,g=g>a[e+1]?g:a[e+1]);const {cols:m,rows:l}=b;b=(d-k)/m/c[0];c=(g-h)/l/c[1];f*=2;h=0;g=!1;k=[0,0];for(d=0;d<m-3;d++){for(e=0;e<l-3;e++){var n=d*l*2+2*e;const q=Math.abs(((a[n]+a[n+4]+a[n+4*l]+a[n+4*l+4])/4-a[n+2*l+2])/b);n=Math.abs(((a[n+1]+a[n+5]+a[n+4*l+1]+a[n+4*l+5])/4-a[n+2*l+3])/c);q+n>h&&(h=q+n,k=[q,n]);if(f&&h>f){g=!0;break}}if(g)break}return k},
ua={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,
54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},U=new Map,Z=new Map;z.computeProjectedScales=function(a,b,c=512,f=!0){const {extent:k,spatialReference:d,pixelSize:h}=a,g=R(new C({x:h.x,y:h.y,spatialReference:d}),b,k);if(null==g)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};
const e=(g.x+g.y)/2;var m=I.getMetersPerUnitForSR(b),l=e*m*96*39.37,n=b.isGeographic?256/c*2.958287637958547E8:256/c*5.91657527591555E8,q="vector-magdir"===a.dataType||"vector-uv"===a.dataType,p=V(k,b);a=Math.min(Math.ceil(Math.log(Math.min(a.width,a.height)/32)/Math.LN2),Math.ceil(Math.log(n/2/l)/Math.LN2));!q&&f&&(b.isGeographic||b.isWebMercator)&&(q=0>p.xmin*p.xmax,!q&&3>a&&(f=F(b),w.isSome(f)&&(q=2**a*e*c,c=Math.ceil(f/q),q=1===c||2===c&&f/2-p.xmax<q)));c=l;if(q)c=n,n=b.isGeographic?1.341104507446289E-6:
.29858214164761665,m=96*n*m*39.37,b=R(new C({x:n,y:n,spatialReference:{wkid:b.isGeographic?4326:3857}}),d,p),b.x*=c/m,b.y*=c/m;else{b={x:h.x,y:h.y};for(p=0;c<.5005*n&&p<a;)p++,c*=2,b.x*=2,b.y*=2;1.001>=Math.max(c,n)/Math.min(c,n)&&(c=n)}n=[c];p=[{x:b.x,y:b.y}];for(l=Math.min(70.5310735,l)/1.001;c>=l;)c/=2,b.x/=2,b.y/=2,n.push(c),p.push({x:b.x,y:b.y});return{projectedPixelSize:g,scales:n,srcResolutions:p,isCustomTilingScheme:!q}};z.defaultGridSpacing=32;z.defaultProjectionToleranceInPixels=4;z.getDefaultDatumTransformationForDataset=
function(a,b,c){return J(a.spatialReference,b)?c?B.getTransformation(b,a.spatialReference,a):B.getTransformation(a.spatialReference,b,a):null};z.getProjectedGridPoints=ba;z.getProjectionOffsetGrid=function(a){var b=a.isAdaptive&&null==a.spacing;let c=a.spacing||[32,32],f=X(a);var k={cols:f.size[0]+1,rows:f.size[1]+1};const d=0<f.outofBoundPointCount&&f.outofBoundPointCount<f.offsets.length/2;let h=f.outofBoundPointCount===f.offsets.length/2||b&&d?[0,0]:ma(f.offsets,k,c,4);const g=(h[0]+h[1])/2;var e=
a.projectedExtent.spatialReference;const m=a.srcBufferExtent.spatialReference;b&&(d||4<g)&&(P(e,m,a.datumTransformation)&&(e.isGeographic||w.isSome(H(e))),c=[4,4],f=X({...a,spacing:c}),k={cols:f.size[0]+1,rows:f.size[1]+1},h=ma(f.offsets,k,c,4));f.error=h;1<c[0]&&(f.coefficients=la(f.offsets,k,d));!a.includeGCSGrid||e.isGeographic||e.isWebMercator||(m.isGeographic?f.gcsGrid={offsets:f.offsets,coefficients:f.coefficients,spacing:c}:(b=H(e),w.isSome(b)&&!b.isEnvelope&&(e&&!e.isGeographic&&(b=String(e.wkid||
e.wkt),Z.has(b)?e=Z.get(b):(e=(e.wkid?y.PeFactory.coordsys(e.wkid):y.PeFactory.fromString(y.PeDefs.PE_TYPE_PROJCS,e.wkt)).getGeogcs().getCode(),Z.set(b,e)),e=new qa({wkid:e})),e=V(a.projectedExtent,e),{offsets:a}=X({...a,srcBufferExtent:e,spacing:c}),k=la(a,k,d),f.gcsGrid={offsets:a,coefficients:k,spacing:c})));return f};z.getRasterDatasetAlignmentInfo=function(a){const b=a.storageInfo.origin.x;var c=F(a.spatialReference,!0);if(w.isNone(c))return{originX:b,halfWorldWidth:null,pyramidsInfo:null};const f=
c/2,{nativePixelSize:k,storageInfo:d,extent:h}=a,{maximumPyramidLevel:g,blockWidth:e,pyramidScalingFactor:m}=d;let l=k.x;const n=[];a=w.isSome(a.transform)&&"gcs-shift"===a.transform.type;const q=b+(a?0:f);c=a?c-b:f-b;for(let p=0;p<=g;p++){const v=(h.xmax-b)/l/e,t=c/l/e;n.push({resolutionX:l,blockWidth:e,datsetColumnCount:0===v-Math.floor(v)?v:Math.ceil(v),worldColumnCountFromOrigin:0===t-Math.floor(t)?t:Math.ceil(t),leftMargin:Math.round(q/l)%e,rightPadding:(e-Math.round(c/l)%e)%e,originColumnOffset:Math.floor(q/
l/e)});l*=m}return{originX:b,halfWorldWidth:f,pyramidsInfo:n,hasGCSSShiftTransform:a}};z.getWorldWidth=F;z.getWorldWrapCount=fa;z.load=function(){return Q.apply(this,arguments)};z.minimumGridSpacing=4;z.projectExtent=V;z.projectPoint=S;z.projectResolution=R;z.requirePE=P;z.snapExtent=function(a){a=a.clone().normalize();return 1===a.length?a[0]:ea(a)};z.snapPyramid=function(a,b,c){const {storageInfo:f,pixelSize:k}=b;var d=0;let h=!1;var {pyramidResolutions:g}=f;if(w.isSome(g)&&g.length){a=(a.x+a.y)/
2;var e=g[g.length-1];e=(e.x+e.y)/2;var m=(k.x+k.y)/2;if(a<=m)d=0;else if(a>=e)d=g.length,h=8<a/e;else{e=m;for(let l=1;l<=g.length;l++){m=(g[l-1].x+g[l-1].y)/2;if(a<=m){a===m?d=l:"down"===c?(d=l-1,h=8<a/e):d="up"===c?l:a-e>m-a||2<a/e?l:l-1;break}e=m}}c=0===d?k:g[d-1];h&&(g=Math.min(c.x,c.y),a=I.getMetersPerUnitForSR(b.spatialReference),19567<g*a&&(h=!1));return{pyramidLevel:d,pyramidResolution:new C({x:c.x,y:c.y,spatialReference:b.spatialReference}),excessiveReading:h}}d=Math.log(a.x/k.x)/Math.LN2;
a=Math.log(a.y/k.y)/Math.LN2;g=b.storageInfo.maximumPyramidLevel||0;d="down"===c?Math.floor(Math.min(d,a)):"up"===c?Math.ceil(Math.max(d,a)):Math.round((d+a)/2);0>d?d=0:d>g&&(h=d>g+3,d=g);c=2**d;b=new C({x:c*b.nativePixelSize.x,y:c*b.nativePixelSize.y,spatialReference:b.spatialReference});return{pyramidLevel:d,pyramidResolution:b,excessiveReading:h}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});