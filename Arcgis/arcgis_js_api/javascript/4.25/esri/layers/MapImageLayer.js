// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/unitUtils"],function(n,k){function c(d,l){l=k.getMetersPerUnitForSR(l);return d/(l*k.inchesPerMeter*96)}n.getExtentForScale=function(d,l){const f=d.extent;d=d.width-(d.padding?d.padding.left+d.padding.right:0);l=c(l,f.spatialReference);return f.clone().expand(l*d/f.width)};n.getResolutionForScale=c;n.getResolutionInMetersForScale=function(d){return d/(96*k.inchesPerMeter)};n.getScale=function(d,l){l=l||d.extent;
d=d.width;const f=k.getMetersPerUnitForSR(l&&l.spatialReference);return l&&d?l.width/d*f*k.inchesPerMeter*96:0};n.getScaleForResolution=function(d,l){l=k.getMetersPerUnitForSR(l);return d*l*k.inchesPerMeter*96};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/ArcGISMapService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/promiseUtils ../../core/urlUtils ../../core/Version ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ../support/commonProperties".split(" "),
function(n,k,c,d,l,f,A,m,F,ba,K,na,ea,G,Y){n.ArcGISMapService=L=>{L=function(P){function V(){var q=P.apply(this,arguments)||this;q.capabilities=void 0;q.copyright=null;q.fullExtent=null;q.legendEnabled=!0;q.spatialReference=null;q.version=void 0;q._allLayersAndTablesPromise=null;q._allLayersAndTablesMap=null;return q}k._inheritsLoose(V,P);var h=V.prototype;h.readCapabilities=function(q,p){var t=p.capabilities&&p.capabilities.split(",").map(Q=>Q.toLowerCase().trim());if(!t)return{operations:{supportsExportMap:!1,
supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var y=this.type;q=t.includes("data");const M=t.includes("query"),u=t.includes("map"),B=!!p.exportTilesAllowed;t=t.includes("tilemap");const C="tile"!==y&&!!p.supportsDynamicLayers,R="tile"!==y&&(!p.tileInfo||C),v="tile"!==y&&(!p.tileInfo||C);y="tile"!==y;var O=p.cimVersion&&A.Version.parse(p.cimVersion);const ca=O?.since(1,4)??!1;O=O?.since(2,0)??!1;return{operations:{supportsExportMap:u,
supportsExportTiles:B,supportsIdentify:M,supportsQuery:q,supportsTileMap:t},exportMap:u?{supportsArcadeExpressionForLabeling:ca,supportsSublayersChanges:y,supportsDynamicLayers:C,supportsSublayerVisibility:R,supportsSublayerDefinitionExpression:v,supportsCIMSymbols:O}:null,exportTiles:B?{maxExportTilesCount:+p.maxExportTilesCount}:null}};h.readVersion=function(q,p){(q=p.currentVersion)||(q=p.hasOwnProperty("capabilities")||p.hasOwnProperty("tables")?10:p.hasOwnProperty("supportedImageFormatTypes")?
9.31:9.3);return q};h.fetchSublayerInfo=function(){var q=k._asyncToGenerator(function*(p,t){yield this.fetchAllLayersAndTables(t);return this._allLayersAndTablesMap?.get(p)});return function(p,t){return q.apply(this,arguments)}}();h.fetchAllLayersAndTables=function(){var q=k._asyncToGenerator(function*(p){yield this.load(p);this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=d(f.urlToObject(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(y=>
{this._allLayersAndTablesMap=new Map;for(const M of y.data.layers)this._allLayersAndTablesMap.set(M.id,M);return{result:y.data}},y=>({error:y})));const t=yield this._allLayersAndTablesPromise;l.throwIfAborted(p);if("result"in t)return t.result;throw t.error;});return function(p){return q.apply(this,arguments)}}();return V}(L);c.__decorate([m.property({readOnly:!0})],L.prototype,"capabilities",void 0);c.__decorate([K.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount",
"supportsDynamicLayers","tileInfo"])],L.prototype,"readCapabilities",null);c.__decorate([m.property({json:{read:{source:"copyrightText"}}})],L.prototype,"copyright",void 0);c.__decorate([m.property({type:ea})],L.prototype,"fullExtent",void 0);c.__decorate([m.property(Y.id)],L.prototype,"id",void 0);c.__decorate([m.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],L.prototype,"legendEnabled",void 0);c.__decorate([m.property(Y.popupEnabled)],
L.prototype,"popupEnabled",void 0);c.__decorate([m.property({type:G})],L.prototype,"spatialReference",void 0);c.__decorate([m.property({readOnly:!0})],L.prototype,"version",void 0);c.__decorate([K.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],L.prototype,"readVersion",null);return L=c.__decorate([na.subclass("esri.layers.mixins.ArcGISMapService")],L)};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/Version":function(){define(["exports",
"./Error"],function(n,k){let c=function(){function d(f,A,m=""){this.major=f;this.minor=A;this._context=m}var l=d.prototype;l.lessThan=function(f,A){return this.major<f||f===this.major&&this.minor<A};l.since=function(f,A){return!this.lessThan(f,A)};l.validate=function(f){if(this.major!==f.major)throw new k((this._context&&this._context+":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:f});
};l.clone=function(){return new d(this.major,this.minor,this._context)};d.parse=function(f,A=""){const [m,F]=f.split(".");var ba=/^\s*\d+\s*$/;if(!m||!m.match||!m.match(ba))throw new k((A&&A+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:f});if(!F||!F.match||!F.match(ba))throw new k((A&&A+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:f});f=parseInt(m,10);ba=parseInt(F,10);return new d(f,ba,A)};return d}();
n.Version=c;Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/SublayersOwner":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/CollectionFlattener ../../core/Error ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/utils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/PropertyOrigin ../support/Sublayer ../support/sublayerUtils".split(" "),
function(n,k,c,d,l,f,A,m,F,ba,K,na,ea,G,Y,L){function P(p,t){const y=[],M={};if(!p)return y;p.forEach(u=>{const B=new Y;B.read(u,t);M[B.id]=B;null!=u.parentLayerId&&-1!==u.parentLayerId?(u=M[u.parentLayerId],u.sublayers||(u.sublayers=[]),u.sublayers.unshift(B)):y.unshift(B)});return y}function V(p,t){p&&p.forEach(y=>{t(y);y.sublayers&&y.sublayers.length&&V(y.sublayers,t)})}const h=A.getLogger("esri.layers.TileLayer"),q=d.ofType(Y);n.SublayersOwner=p=>{p=function(t){function y(...u){var B=t.call(this,
...u)||this;B.allSublayers=new l({getCollections:()=>[B.sublayers],getChildrenFunction(C){return C.sublayers}});B.sublayersSourceJSON={[G.OriginId.SERVICE]:{},[G.OriginId.PORTAL_ITEM]:{},[G.OriginId.WEB_SCENE]:{},[G.OriginId.WEB_MAP]:{}};B.addHandles(m.watch(()=>B.sublayers,(C,R)=>B._handleSublayersChange(C,R),m.sync));return B}k._inheritsLoose(y,t);var M=y.prototype;M.readSublayers=function(u,B){if(B&&u){var {sublayersSourceJSON:C}=this,R=G.nameToId(B.origin);if(!(R<G.OriginId.SERVICE||(C[R]={context:B,
visibleLayers:u.visibleLayers||C[R].visibleLayers,layers:u.layers||C[R].layers},R>G.OriginId.SERVICE))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var {sublayers:v,origin:O}=this.createSublayersForOrigin("web-document");u=K.getProperties(this);u.setDefaultOrigin(O);this._set("sublayers",new q(v));u.setDefaultOrigin("user")}}};M.findSublayerById=function(u){return this.allSublayers.find(B=>B.id===u)};M.createServiceSublayers=function(){return this.createSublayersForOrigin("service").sublayers};
M.createSublayersForOrigin=function(u){const B="web-document"===u?G.nameToId("web-map"):G.nameToId(u);let C=G.OriginId.SERVICE;u=this.sublayersSourceJSON[G.OriginId.SERVICE].layers;let R=this.sublayersSourceJSON[G.OriginId.SERVICE].context,v=null;var O=[G.OriginId.PORTAL_ITEM,G.OriginId.WEB_SCENE,G.OriginId.WEB_MAP].filter(x=>x<=B);for(var ca of O)O=this.sublayersSourceJSON[ca],L.isSublayerOverhaul(O.layers)&&(C=ca,u=O.layers,R=O.context,O.visibleLayers&&(v={visibleLayers:O.visibleLayers,context:O.context}));
ca=[G.OriginId.PORTAL_ITEM,G.OriginId.WEB_SCENE,G.OriginId.WEB_MAP].filter(x=>x>C&&x<=B);let Q=null;for(var ia of ca){const {layers:x,visibleLayers:la,context:ja}=this.sublayersSourceJSON[ia];x&&(Q={layers:x,context:ja});la&&(v={visibleLayers:la,context:ja})}ia=P(u,R);const da=new Map,Z=new Set;if(Q)for(const x of Q.layers)da.set(x.id,x);if(v)for(const x of v.visibleLayers)Z.add(x);V(ia,x=>{Q&&x.read(da.get(x.id),Q.context);v&&x.read({defaultVisibility:Z.has(x.id)},v.context)});return{origin:G.idToName(C),
sublayers:new q({items:ia})}};M.read=function(u,B){t.prototype.read.call(this,u,B);this.readSublayers(u,B)};M._handleSublayersChange=function(u,B){B&&(B.forEach(C=>{C.parent=null;C.layer=null}),this.handles.remove("sublayers-owner"));u&&(u.forEach(C=>{C.parent=this;C.layer=this}),this.handles.add([u.on("after-add",({item:C})=>{C.parent=this;C.layer=this}),u.on("after-remove",({item:C})=>{C.parent=null;C.layer=null})],"sublayers-owner"),"tile"===this.type&&this.handles.add(u.on("before-changes",C=>
{h.error(new f("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this}));C.preventDefault()}),"sublayers-owner"))};return y}(p);c.__decorate([F.property({readOnly:!0})],p.prototype,"allSublayers",void 0);c.__decorate([F.property({readOnly:!0,type:d.ofType(Y)})],p.prototype,"serviceSublayers",void 0);c.__decorate([F.property({value:null,type:q,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],p.prototype,"sublayers",void 0);c.__decorate([F.property({readOnly:!0})],
p.prototype,"sublayersSourceJSON",void 0);return p=c.__decorate([ea.subclass("esri.layers.mixins.SublayersOwner")],p)};n.forEachSublayer=V;Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Sublayer":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../PopupTemplate ../../renderers/ClassBreaksRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/HeatmapRenderer ../../renderers/PieChartRenderer ../../renderers/Renderer ../../renderers/SimpleRenderer ../../renderers/UniqueValueRenderer ../../renderers/support/jsonUtils ../../renderers/support/types ../../request ../../symbols ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/Identifiable ../../core/lang ../../core/Loadable ../../core/Logger ../../core/maybe ../../core/MultiOriginJSONSupport ../../core/sql ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/utils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../core/accessorSupport/PropertyOrigin ./arcgisLayerUrl ./FeatureType ./Field ./FieldsIndex ./LabelClass ./labelingInfo ./LayerFloorInfo ./source/DataLayerSource ./source/MapLayerSource ../../rest/support/Query ../../support/popupUtils ../../geometry/Extent ../../geometry/support/typeUtils".split(" "),
function(n,k,c,d,l,f,A,m,F,ba,K,na,ea,G,Y,L,P,V,h,q,p,t,y,M,u,B,C,R,v,O,ca,Q,ia,da,Z,x,la,ja,W,g,z,D,H,I,X,S,N,fa,ka){function qa(E){return E&&"esriSMS"===E.type}function ra(E,T,r){E=this.originIdOf(T)>=x.nameToId(r.origin);return{ignoreOrigin:!0,allowNull:E,enabled:r?"map-image"===r.layer?.type&&(r.writeSublayerStructure||E):!1}}function sa(E,T,r){return{enabled:r?"tile"===r.layer?.type&&this._isOverridden(T):!1}}function aa(E,T,r){return{ignoreOrigin:!0,enabled:r&&r.writeSublayerStructure||!1}}
function oa(E,T,r){return{ignoreOrigin:!0,enabled:r?r.writeSublayerStructure||this.originIdOf(T)>=x.nameToId(r.origin):!1}}const ta=E=>Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));var pa;let ua=0;const ma=new Set;ma.add("layer");ma.add("parent");ma.add("loaded");ma.add("loadStatus");ma.add("loadError");ma.add("loadWarnings");d=pa=function(E){function T(a){a=E.call(this,a)||this;a.capabilities=void 0;a.fields=null;a.fullExtent=null;a.geometryType=
null;a.globalIdField=null;a.legendEnabled=!0;a.objectIdField=null;a.popupEnabled=!0;a.popupTemplate=null;a.sourceJSON=null;a.title=null;a.typeIdField=null;a.types=null;return a}k._inheritsLoose(T,E);var r=T.prototype;r.load=function(){var a=k._asyncToGenerator(function*(b){var e=this;this.addResolvingPromise(k._asyncToGenerator(function*(){if(!e.layer&&!e.url)throw new h("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:e});var w=null;!e.layer||e.originIdOf("url")>
x.OriginId.SERVICE||"data-layer"===e.source?.type?w=(yield L(e.url,{responseType:"json",query:{f:"json"},...b})).data:(w=e.id,"map-layer"===e.source?.type&&(w=e.source.mapLayerId),w=yield e.layer.fetchSublayerInfo(w,b));w&&(e.sourceJSON=w,e.read({layerDefinition:w},{origin:"service"}))})());return this});return function(b){return a.apply(this,arguments)}}();r.readCapabilities=function(a,b){b=b.layerDefinition||b;a=(a=b.capabilities||a)?a.toLowerCase().split(",").map(w=>w.trim()):[];const e=this.url?
la.parse(this.url):null;a=a.includes(u.isSome(e)&&"MapServer"===e.serverType?"data":"query");return{exportMap:{supportsModification:!!b.canModifyLayer},operations:{supportsQuery:a}}};r.readGlobalIdFieldFromService=function(a,b){b=b.layerDefinition||b;if(b.globalIdField)return b.globalIdField;if(b.fields)for(const e of b.fields)if("esriFieldTypeGlobalID"===e.type)return e.name};r.writeLabelingInfo=function(a,b,e,w){a&&a.length&&(b.layerDefinition={drawingInfo:{labelingInfo:a.map(J=>J.write({},w))}})};
r.readMinScale=function(a,b){return b.minScale||b.layerDefinition&&b.layerDefinition.minScale||0};r.readMaxScale=function(a,b){return b.maxScale||b.layerDefinition&&b.layerDefinition.maxScale||0};r.readObjectIdFieldFromService=function(a,b){b=b.layerDefinition||b;if(b.objectIdField)return b.objectIdField;if(b.fields)for(const e of b.fields)if("esriFieldTypeOID"===e.type)return e.name};r.readOpacity=function(a,b){a=b.layerDefinition;return 1-.01*(null!=a.transparency?a.transparency:a.drawingInfo.transparency)};
r.writeOpacity=function(a,b,e,w){b.layerDefinition={drawingInfo:{transparency:100-100*a}}};r.writeParent=function(a,b){b.parentLayerId=this.parent&&this.parent!==this.layer?Z.ensureInteger(this.parent.id):-1};r.castSublayers=function(a){return Z.ensureType(V.ofType(pa),a)};r.writeSublayers=function(a,b,e){this.get("sublayers.length")&&(b[e]=this.sublayers.map(w=>w.id).toArray().reverse())};r.readTypeIdField=function(a,b){b=b.layerDefinition||b;let e=b.typeIdField;e&&b.fields&&(e=e.toLowerCase(),a=
b.fields.find(w=>w.name.toLowerCase()===e))&&(e=a.name);return e};r.writeVisible=function(a,b,e,w){b[e]=this.getAtOrigin("defaultVisibility","service")||a};r.clone=function(){const {store:a}=O.getProperties(this),b=new pa;O.getProperties(b).store=a.clone(ma);this.commitProperty("url");b._lastParsedUrl=this._lastParsedUrl;return b};r.createPopupTemplate=function(a){return N.createPopupTemplate(this,a)};r.createQuery=function(){return new S({returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})};
r.createFeatureLayer=function(){var a=k._asyncToGenerator(function*(){if(this.hasOwnProperty("sublayers"))return null;const b=this.layer?.parsedUrl,e=new (yield new Promise((w,J)=>n(["../FeatureLayer"],U=>w(ta(U)),J))).default({url:b.path});b&&this.source&&("map-layer"===this.source.type?e.layerId=this.source.mapLayerId:e.dynamicDataSource=this.source);null!=this.layer.refreshInterval&&(e.refreshInterval=this.layer.refreshInterval);this.definitionExpression&&(e.definitionExpression=this.definitionExpression);
this.floorInfo&&(e.floorInfo=t.clone(this.floorInfo));this.originIdOf("labelingInfo")>x.OriginId.SERVICE&&(e.labelingInfo=t.clone(this.labelingInfo));this.originIdOf("labelsVisible")>x.OriginId.DEFAULTS&&(e.labelsVisible=this.labelsVisible);this.originIdOf("legendEnabled")>x.OriginId.DEFAULTS&&(e.legendEnabled=this.legendEnabled);this.originIdOf("visible")>x.OriginId.DEFAULTS&&(e.visible=this.visible);this.originIdOf("minScale")>x.OriginId.DEFAULTS&&(e.minScale=this.minScale);this.originIdOf("maxScale")>
x.OriginId.DEFAULTS&&(e.maxScale=this.maxScale);this.originIdOf("opacity")>x.OriginId.DEFAULTS&&(e.opacity=this.opacity);this.originIdOf("popupTemplate")>x.OriginId.DEFAULTS&&(e.popupTemplate=t.clone(this.popupTemplate));this.originIdOf("renderer")>x.OriginId.SERVICE&&(e.renderer=t.clone(this.renderer));"data-layer"===this.source?.type&&(e.dynamicDataSource=this.source.clone());this.originIdOf("title")>x.OriginId.DEFAULTS&&(e.title=this.title);"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>
x.OriginId.DEFAULTS&&(e.customParameters=this.layer.customParameters);"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>x.OriginId.DEFAULTS&&(e.customParameters=this.layer.customParameters);return e});return function(){return a.apply(this,arguments)}}();r.getField=function(a){return this.fieldsIndex.get(a)};r.getFeatureType=function(a){const {typeIdField:b,types:e}=this;if(!b||!a)return null;const w=a.attributes?a.attributes[b]:void 0;if(null==w)return null;let J=null;e.some(U=>
{const {id:ha}=U;if(null==ha)return!1;ha.toString()===w.toString()&&(J=U);return!!J});return J};r.getFieldDomain=function(a,b){return(b=this.getFeatureType(b&&b.feature))&&(b=b.domains&&b.domains[a])&&"inherited"!==b.type?b:this._getLayerDomain(a)};r.queryFeatures=function(){var a=k._asyncToGenerator(function*(b=this.createQuery(),e){yield this.load();if(!this.capabilities?.operations?.supportsQuery)throw new h("Sublayer.queryFeatures","this layer doesn't support queries.");const [{executeQuery:w},
{default:J}]=yield Promise.all([new Promise((U,ha)=>n(["../../rest/query/operations/query"],U,ha)),new Promise((U,ha)=>n(["../../rest/support/FeatureSet"],va=>U(ta(va)),ha))]);b=yield w(this.url,S.from(b),this.layer?.spatialReference??null,{...e,query:{...this.layer?.customParameters,token:this.layer?.apiKey}});b=J.fromJSON(b.data);if(b?.features)for(const U of b.features)U.sourceLayer=this;return b});return function(){return a.apply(this,arguments)}}();r.toExportImageJSON=function(a){const b={id:this.id,
source:this.source?.toJSON()||{mapLayerId:this.id,type:"mapLayer"}};a=C.sqlAnd(a,this.definitionExpression);u.isSome(a)&&(b.definitionExpression=a);const e=["renderer","labelingInfo","opacity","labelsVisible"].reduce((w,J)=>{w[J]=this.originIdOf(J);return w},{});if(Object.keys(e).some(w=>e[w]>x.OriginId.SERVICE)){a=b.drawingInfo={};e.renderer>x.OriginId.SERVICE&&(a.renderer=this.renderer?this.renderer.toJSON():null);e.labelsVisible>x.OriginId.SERVICE&&(a.showLabels=this.labelsVisible);if(this.labelsVisible&&
e.labelingInfo>x.OriginId.SERVICE){!this.loaded&&this.labelingInfo.some(J=>!J.labelPlacement)&&M.getLogger(this.declaredClass).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' `+"and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.",{sublayer:this});let w=this.labelingInfo;u.isSome(this.geometryType)&&(w=D.validateLabelingInfo(this.labelingInfo,ka.featureGeometryTypeKebabDictionary.toJSON(this.geometryType)));
a.labelingInfo=w.filter(J=>J.labelPlacement).map(J=>J.toJSON({origin:"service",layer:this.layer}));a.showLabels=!0}e.opacity>x.OriginId.SERVICE&&(a.transparency=100-100*this.opacity);this._assignDefaultSymbolColors(a.renderer)}return b};r._assignDefaultSymbolColors=function(a){this._forEachSimpleMarkerSymbols(a,b=>{b.color||"esriSMSX"!==b.style&&"esriSMSCross"!==b.style||(b.color=b.outline&&b.outline.color?b.outline.color:[0,0,0,0])})};r._forEachSimpleMarkerSymbols=function(a,b){if(a){const e="uniqueValueInfos"in
a?a.uniqueValueInfos:"classBreakInfos"in a?a.classBreakInfos:[];for(const w of e)qa(w.symbol)&&b(w.symbol);"symbol"in a&&qa(a.symbol)&&b(a.symbol);"defaultSymbol"in a&&qa(a.defaultSymbol)&&b(a.defaultSymbol)}};r._setAndNotifyLayer=function(a,b){const e=this.layer,w=this._get(a);let J,U;switch(a){case "definitionExpression":case "floorInfo":J="supportsSublayerDefinitionExpression";case "minScale":case "maxScale":case "visible":J="supportsSublayerVisibility";break;case "labelingInfo":case "labelsVisible":case "opacity":case "renderer":case "source":J=
"supportsDynamicLayers",U="supportsModification"}const ha=O.getProperties(this).getDefaultOrigin();if("service"!==ha){if(J&&!1===this.get(`layer.capabilities.exportMap.${J}`)){this._logLockedError(a,`capability not available 'layer.capabilities.exportMap.${J}'`);return}if(U&&!1===this.get(`capabilities.exportMap.${U}`)){this._logLockedError(a,`capability not available 'capabilities.exportMap.${U}'`);return}}"source"===a&&"not-loaded"!==this.loadStatus?this._logLockedError(a,"'source' can't be changed after calling sublayer.load()"):
(this._set(a,b),"service"!==ha&&w!==b&&e&&e.emit&&e.emit("sublayer-update",{propertyName:a,target:this}))};r._handleSublayersChange=function(a,b){b&&(b.forEach(e=>{e.parent=null;e.layer=null}),this.handles.removeAll());a&&(a.forEach(e=>{e.parent=this;e.layer=this.layer}),this.handles.add([a.on("after-add",({item:e})=>{e.parent=this;e.layer=this.layer}),a.on("after-remove",({item:e})=>{e.parent=null;e.layer=null}),a.on("before-changes",e=>{const w=this.get("layer.capabilities.exportMap.supportsSublayersChanges");
null==w||w||(M.getLogger(this.declaredClass).error(new h("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),e.preventDefault())})]))};r._logLockedError=function(a,b){M.getLogger(this.declaredClass).error(new h("sublayer:locked",`Property '${String(a)}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:b,sublayer:this,layer:this.layer}))};r._getLayerDomain=function(a){return(a=this.fieldsIndex.get(a))?
a.domain:null};k._createClass(T,[{key:"definitionExpression",set:function(a){this._setAndNotifyLayer("definitionExpression",a)}},{key:"fieldsIndex",get:function(){return new g(this.fields||[])}},{key:"floorInfo",set:function(a){this._setAndNotifyLayer("floorInfo",a)}},{key:"id",get:function(){const a=this._get("id");return null==a?ua++:a},set:function(a){this._get("id")!==a&&(!1===this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"):
this._set("id",a))}},{key:"labelingInfo",set:function(a){this._setAndNotifyLayer("labelingInfo",a)}},{key:"labelsVisible",set:function(a){this._setAndNotifyLayer("labelsVisible",a)}},{key:"layer",set:function(a){this._set("layer",a);this.sublayers&&this.sublayers.forEach(b=>b.layer=a)}},{key:"listMode",set:function(a){this._set("listMode",a)}},{key:"minScale",set:function(a){this._setAndNotifyLayer("minScale",a)}},{key:"maxScale",set:function(a){this._setAndNotifyLayer("maxScale",a)}},{key:"effectiveScaleRange",
get:function(){const {minScale:a,maxScale:b}=this;return{minScale:a,maxScale:b}}},{key:"opacity",set:function(a){this._setAndNotifyLayer("opacity",a)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(a){if(a)for(const b of a.getSymbols())if(P.isSymbol3D(b)){M.getLogger(this.declaredClass).warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",a)}},{key:"source",get:function(){return this._get("source")||
new X.MapLayerSource({mapLayerId:this.id})},set:function(a){this._setAndNotifyLayer("source",a)}},{key:"sublayers",set:function(a){this._handleSublayersChange(a,this._get("sublayers"));this._set("sublayers",a)}},{key:"url",get:function(){const a=this.layer?.parsedUrl??this._lastParsedUrl;var b=this.source;if(!a)return null;this._lastParsedUrl=a;if("map-layer"===b?.type)return`${a.path}/${b.mapLayerId}`;b={layer:JSON.stringify({source:this.source})};return`${a.path}/dynamicLayer?${R.objectToQuery(b)}`},
set:function(a){this._overrideIfSome("url",a)}},{key:"visible",set:function(a){this._setAndNotifyLayer("visible",a)}}]);return T}(q.HandleOwnerMixin(B.MultiOriginJSONMixin(p.IdentifiableMixin(y))));d.test={isMapImageLayerOverridePolicy:E=>E===aa||E===ra,isTileImageLayerOverridePolicy:E=>E===sa};c.__decorate([v.property({readOnly:!0})],d.prototype,"capabilities",void 0);c.__decorate([Q.reader("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],d.prototype,"readCapabilities",
null);c.__decorate([v.property({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:ra}}})],d.prototype,"definitionExpression",null);c.__decorate([v.property({type:[W],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],d.prototype,"fields",void 0);c.__decorate([v.property({readOnly:!0})],d.prototype,"fieldsIndex",null);c.__decorate([v.property({type:H,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},
write:{target:"layerDefinition.floorInfo",overridePolicy:ra},origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"floorInfo",null);c.__decorate([v.property({type:fa,json:{read:{source:"layerDefinition.extent"}}})],d.prototype,"fullExtent",void 0);c.__decorate([v.property({type:ka.featureGeometryTypeKebabDictionary.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:ka.featureGeometryTypeKebabDictionary.read}}}}})],d.prototype,"geometryType",void 0);c.__decorate([v.property({type:String})],
d.prototype,"globalIdField",void 0);c.__decorate([Q.reader("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],d.prototype,"readGlobalIdFieldFromService",null);c.__decorate([v.property({type:Z.Integer,json:{write:{ignoreOrigin:!0}}})],d.prototype,"id",null);c.__decorate([v.property({value:null,type:[z],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:aa}}})],d.prototype,"labelingInfo",
null);c.__decorate([da.writer("labelingInfo")],d.prototype,"writeLabelingInfo",null);c.__decorate([v.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:aa}}})],d.prototype,"labelsVisible",null);c.__decorate([v.property({value:null})],d.prototype,"layer",null);c.__decorate([v.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",
overridePolicy:oa}}})],d.prototype,"legendEnabled",void 0);c.__decorate([v.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],d.prototype,"listMode",null);c.__decorate([v.property({type:Number,value:0,json:{write:{overridePolicy:aa}}})],d.prototype,"minScale",null);c.__decorate([Q.reader("minScale",["minScale","layerDefinition.minScale"])],d.prototype,"readMinScale",null);c.__decorate([v.property({type:Number,value:0,json:{write:{overridePolicy:aa}}})],
d.prototype,"maxScale",null);c.__decorate([Q.reader("maxScale",["maxScale","layerDefinition.maxScale"])],d.prototype,"readMaxScale",null);c.__decorate([v.property({readOnly:!0})],d.prototype,"effectiveScaleRange",null);c.__decorate([v.property({type:String})],d.prototype,"objectIdField",void 0);c.__decorate([Q.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],d.prototype,"readObjectIdFieldFromService",null);c.__decorate([v.property({type:Number,value:1,
json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:aa}}})],d.prototype,"opacity",null);c.__decorate([Q.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],d.prototype,"readOpacity",null);c.__decorate([da.writer("opacity")],d.prototype,"writeOpacity",null);c.__decorate([v.property({json:{type:Z.Integer,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:aa}}})],d.prototype,"parent",void 0);c.__decorate([da.writer("parent")],
d.prototype,"writeParent",null);c.__decorate([v.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(E,T){return!T.disablePopup}},write:{target:"disablePopup",overridePolicy:oa,writer(E,T,r){T[r]=!E}}}})],d.prototype,"popupEnabled",void 0);c.__decorate([v.property({type:l,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:oa}}})],d.prototype,"popupTemplate",void 0);c.__decorate([v.property({readOnly:!0})],d.prototype,"defaultPopupTemplate",null);c.__decorate([v.property({types:Y.rendererTypes,
value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:aa},origins:{"web-scene":{types:Y.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:aa}}}}})],d.prototype,"renderer",null);c.__decorate([v.property({types:{key:"type",base:null,typeMap:{"data-layer":I.DataLayerSource,"map-layer":X.MapLayerSource}},cast(E){if(E){if("mapLayerId"in E)return Z.ensureClass(X.MapLayerSource,E);if("dataSource"in E)return Z.ensureClass(I.DataLayerSource,
E)}return E},json:{name:"layerDefinition.source",write:{overridePolicy:aa}}})],d.prototype,"source",null);c.__decorate([v.property()],d.prototype,"sourceJSON",void 0);c.__decorate([v.property({value:null,json:{type:[Z.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:aa}}})],d.prototype,"sublayers",null);c.__decorate([ca.cast("sublayers")],d.prototype,"castSublayers",null);c.__decorate([da.writer("sublayers")],d.prototype,"writeSublayers",null);c.__decorate([v.property({type:String,
json:{name:"name",write:{overridePolicy:oa}}})],d.prototype,"title",void 0);c.__decorate([v.property({type:String})],d.prototype,"typeIdField",void 0);c.__decorate([Q.reader("typeIdField",["layerDefinition.typeIdField"])],d.prototype,"readTypeIdField",null);c.__decorate([v.property({type:[ja],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],d.prototype,"types",void 0);c.__decorate([v.property({type:String,json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:sa}}})],
d.prototype,"url",null);c.__decorate([v.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:aa}}})],d.prototype,"visible",null);c.__decorate([da.writer("visible")],d.prototype,"writeVisible",null);return d=pa=c.__decorate([ia.subclass("esri.layers.support.Sublayer")],d)})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],function(n,k,c){function d(l,
f){if(!l||!l.length||k.isNone(f))return!0;f=f.slice().reverse().flatten(({sublayers:F})=>F&&F.toArray().reverse()).map(F=>F.id).toArray();if(l.length>f.length)return!1;let A=0;const m=f.length;for(const {id:F}of l){for(;A<m&&f[A]!==F;)A++;if(A>=m)return!1}return!0}n.isExportDynamic=function(l,f,A){return l.some(m=>{const F=m.source;return!(!F||"map-layer"===F.type&&F.mapLayerId===m.id&&(k.isNone(F.gdbVersion)||F.gdbVersion===A))||m.originIdOf("renderer")>c.OriginId.SERVICE||m.originIdOf("labelingInfo")>
c.OriginId.SERVICE||m.originIdOf("opacity")>c.OriginId.SERVICE||m.originIdOf("labelsVisible")>c.OriginId.SERVICE})?!0:!d(l,f)};n.isSublayerOverhaul=function(l){return!!l&&l.some(f=>null!=f.minScale||f.layerDefinition&&null!=f.layerDefinition.minScale)};n.shouldWriteSublayerStructure=function(l,f,A){return f.flatten(({sublayers:m})=>m).length!==l.length||l.some(m=>m.originIdOf("minScale")>A||m.originIdOf("maxScale")>A||m.originIdOf("renderer")>A||m.originIdOf("labelingInfo")>A||m.originIdOf("opacity")>
A||m.originIdOf("labelsVisible")>A||m.originIdOf("source")>A)?!0:!d(l,f)};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(n,k,c,d,l,f,A,m,F,ba,K,na,ea,G){const Y={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};n.ExportImageParameters=function(L){function P(h){h=L.call(this,h)||this;h.floors=null;h.scale=0;return h}k._inheritsLoose(P,L);var V=P.prototype;V.destroy=function(){this.layer=null};V.toJSON=
function(){var h=this.layer;h={dpi:h.dpi,format:h.imageFormat,transparent:h.imageTransparency,gdbVersion:h.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?h.dynamicLayers=this.dynamicLayers:h={...h,layers:this.layers,layerDefs:this.layerDefs};return h};k._createClass(P,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const h=this.visibleSublayers.map(q=>{const p=ea.getLayerFloorFilterClause(this.floors,q);return q.toExportImageJSON(p)});return h.length?JSON.stringify(h):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&G.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(h){this._get("layer")!==h&&(this._set("layer",h),this.handles.remove("layer"),h&&this.handles.add([h.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),h.on("sublayer-update",q=>this.notifyChange(Y[q.propertyName]))],"layer"))}},{key:"layers",get:function(){const h=this.visibleSublayers;return h?h.length?
"show:"+h.map(q=>q.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){const h=!!this.floors?.length,q=this.visibleSublayers.filter(p=>null!=p.definitionExpression||h&&null!=p.floorInfo);return q.length?JSON.stringify(q.reduce((p,t)=>{var y=ea.getLayerFloorFilterClause(this.floors,t);y=A.sqlAnd(y,t.definitionExpression);f.isSome(y)&&(p[t.id]=y);return p},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const h=this.layer;h&&(h.commitProperty("dpi"),h.commitProperty("imageFormat"),h.commitProperty("imageTransparency"),h.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const h=[];if(!this.layer)return h;var q=this.layer.sublayers;const p=t=>{const y=this.scale,M=0===t.minScale||y<=t.minScale,u=0===t.maxScale||y>=t.maxScale;t.visible&&(0===y||M&&u)&&(t.sublayers?t.sublayers.forEach(p):h.unshift(t))};q&&q.forEach(p);
q=this._get("visibleSublayers");return!q||q.length!==h.length||q.some((t,y)=>h[y]!==t)?h:q}}]);return P}(l.HandleOwnerMixin(d));c.__decorate([m.property({readOnly:!0})],n.ExportImageParameters.prototype,"dynamicLayers",null);c.__decorate([m.property()],n.ExportImageParameters.prototype,"floors",void 0);c.__decorate([m.property({readOnly:!0})],n.ExportImageParameters.prototype,"hasDynamicLayers",null);c.__decorate([m.property()],n.ExportImageParameters.prototype,"layer",null);c.__decorate([m.property({readOnly:!0})],
n.ExportImageParameters.prototype,"layers",null);c.__decorate([m.property({readOnly:!0})],n.ExportImageParameters.prototype,"layerDefs",null);c.__decorate([m.property({type:Number})],n.ExportImageParameters.prototype,"scale",void 0);c.__decorate([m.property(na.combinedViewLayerTimeExtentProperty)],n.ExportImageParameters.prototype,"timeExtent",void 0);c.__decorate([m.property({readOnly:!0})],n.ExportImageParameters.prototype,"version",null);c.__decorate([m.property({readOnly:!0})],n.ExportImageParameters.prototype,
"visibleSublayers",null);n.ExportImageParameters=c.__decorate([K.subclass("esri.layers.mixins.ExportImageParameters")],n.ExportImageParameters);Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(n){function k(c,d){if(!c?.length)return null;c=c.filter(l=>""!==l).map(l=>`'${l}'`);c.push("''");return`${d} IN (${c.join(",")}) OR ${d} IS NULL`}n.getFloorFilterClause=function(c){const d=
c.layer;return"floorInfo"in d&&d.floorInfo?.floorField&&"floors"in c.view?k(c.view.floors,d.floorInfo.floorField):null};n.getLayerFloorFilterClause=function(c,d){return"floorInfo"in d&&d.floorInfo?.floorField?k(c,d.floorInfo.floorField):null};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../TimeExtent ../core/Error ../core/HandleOwner ../core/loadAll ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/accessorSupport/PropertyOrigin ../geometry/Extent ../geometry/support/scaleUtils ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISMapService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/SublayersOwner ./mixins/TemporalLayer ./support/commonProperties ./support/ExportImageParameters ./support/Sublayer ./support/sublayerUtils ./support/versionUtils".split(" "),function(n,
k,c,d,l,f,A,m,F,ba,K,na,ea,G,Y,L,P,V,h,q,p,t,y,M,u,B,C,R,v,O,ca,Q,ia,da,Z,x){f=function(la){function ja(...g){g=la.call(this,...g)||this;g.datesInUnknownTimezone=!1;g.dpi=96;g.gdbVersion=null;g.imageFormat="png24";g.imageMaxHeight=2048;g.imageMaxWidth=2048;g.imageTransparency=!0;g.isReference=null;g.labelsVisible=!1;g.operationalLayerType="ArcGISMapServiceLayer";g.sourceJSON=null;g.sublayers=null;g.type="map-image";g.url=null;return g}n._inheritsLoose(ja,la);var W=ja.prototype;W.normalizeCtorArgs=
function(g,z){return"string"===typeof g?{url:g,...z}:g};W.load=function(g){const z=m.isSome(g)?g.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},g).catch(ba.throwIfAbortError).then(()=>this._fetchService(z)));return Promise.resolve(this)};W.readImageFormat=function(g,z){return(g=z.supportedImageFormatTypes)&&g.includes("PNG32")?"png32":"png24"};W.writeSublayers=function(g,z,D,H){if(this.loaded&&g){g=g.slice().reverse().flatten(({sublayers:N})=>N&&N.toArray().reverse()).toArray();
D=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const N=P.nameToId(H.origin);N===P.OriginId.PORTAL_ITEM?(D=this.createSublayersForOrigin("service").sublayers,D=Z.shouldWriteSublayerStructure(g,D,P.OriginId.SERVICE)):N>P.OriginId.PORTAL_ITEM&&(D=this.createSublayersForOrigin("portal-item"),D=Z.shouldWriteSublayerStructure(g,D.sublayers,P.nameToId(D.origin)))}var I=[],X={writeSublayerStructure:D,...H},S=D;g.forEach(N=>{const fa=
N.write({},X);I.push(fa);S=S||"user"===N.originOf("visible")});I.some(N=>1<Object.keys(N).length)&&(z.layers=I);S&&(z.visibleLayers=g.filter(N=>N.visible).map(N=>N.id))}};W.createExportImageParameters=function(g,z,D,H){var I=H&&H.pixelRatio||1;g&&10<=this.version&&(g=g.clone().shiftCentralMeridian());var X=new ia.ExportImageParameters({layer:this,floors:H?.floors,scale:h.getScale({extent:g,width:z})*I});const S=X.toJSON();X.destroy();X=!H||!H.rotation||10.3>this.version?{}:{rotation:-H.rotation};
var N=g&&g.spatialReference;N=N.wkid||JSON.stringify(N.toJSON());S.dpi*=I;I={};if(H?.timeExtent){const {start:fa,end:ka}=H.timeExtent.toJSON();I.time=fa&&ka&&fa===ka?""+fa:`${null==fa?"null":fa},${null==ka?"null":ka}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(I.time="null,null");return{bbox:g&&g.xmin+","+g.ymin+","+g.xmax+","+g.ymax,bboxSR:N,imageSR:N,size:z+","+D,...S,...X,...I}};W.fetchImage=function(){var g=n._asyncToGenerator(function*(z,D,H,I){return this._fetchImage("image",z,D,H,I)});
return function(z,D,H,I){return g.apply(this,arguments)}}();W.fetchImageBitmap=function(){var g=n._asyncToGenerator(function*(z,D,H,I){z=yield this._fetchImage("blob",z,D,H,I);return createImageBitmap(z)});return function(z,D,H,I){return g.apply(this,arguments)}}();W.fetchRecomputedExtents=function(){var g=n._asyncToGenerator(function*(z={}){({data:z}=yield c(this.url,{...z,query:{returnUpdates:!0,f:"json",...this.customParameters,token:this.apiKey}}));const {extent:D,fullExtent:H,timeExtent:I}=z;
z=D||H;return{fullExtent:z&&V.fromJSON(z),timeExtent:I&&d.fromJSON({start:I[0],end:I[1]})}});return function(){return g.apply(this,arguments)}}();W.loadAll=function(){return A.loadAll(this,g=>{g(this.allSublayers)})};W.serviceSupportsSpatialReference=function(g){return x.serviceSupportsSpatialReference(this,g)};W._fetchImage=function(){var g=n._asyncToGenerator(function*(z,D,H,I,X){z={responseType:z,signal:X?.signal??null,query:{...this.parsedUrl.query,...this.createExportImageParameters(D,H,I,X),
f:"image",...this.refreshParameters,...this.customParameters,token:this.apiKey}};D=this.parsedUrl.path+"/export";if(null!=z.query.dynamicLayers&&!this.capabilities.exportMap.supportsDynamicLayers)throw new l("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:z.query});try{const {data:S}=yield c(D,z);return S}catch(S){if(ba.isAbortError(S))throw S;throw new l("mapimagelayer:image-fetch-error",
`Unable to load image: ${D}`,{error:S});}});return function(z,D,H,I,X){return g.apply(this,arguments)}}();W._fetchService=function(){var g=n._asyncToGenerator(function*(z){if(this.sourceJSON)this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});else{var {data:D,ssl:H}=yield c(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:z});H&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=D;this.read(D,{origin:"service",
url:this.parsedUrl})}});return function(z){return g.apply(this,arguments)}}();return ja}(M.BlendLayer(ca.TemporalLayer(v.ScaleRangeLayer(O.SublayersOwner(t.ArcGISMapService(y.ArcGISService(B.OperationalLayer(C.PortalLayer(F.MultiOriginJSONMixin(R.RefreshableLayer(p.APIKeyMixin(u.CustomParametersMixin(f.HandleOwnerMixin(q))))))))))))));k.__decorate([K.property({type:Boolean})],f.prototype,"datesInUnknownTimezone",void 0);k.__decorate([K.property()],f.prototype,"dpi",void 0);k.__decorate([K.property()],
f.prototype,"gdbVersion",void 0);k.__decorate([K.property()],f.prototype,"imageFormat",void 0);k.__decorate([G.reader("imageFormat",["supportedImageFormatTypes"])],f.prototype,"readImageFormat",null);k.__decorate([K.property({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],f.prototype,"imageMaxHeight",void 0);k.__decorate([K.property({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],f.prototype,"imageMaxWidth",void 0);k.__decorate([K.property()],f.prototype,"imageTransparency",
void 0);k.__decorate([K.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],f.prototype,"isReference",void 0);k.__decorate([K.property({json:{read:!1,write:!1}})],f.prototype,"labelsVisible",void 0);k.__decorate([K.property({type:["ArcGISMapServiceLayer"]})],f.prototype,"operationalLayerType",void 0);k.__decorate([K.property({json:{read:!1,write:!1}})],f.prototype,"popupEnabled",void 0);k.__decorate([K.property()],f.prototype,"sourceJSON",void 0);k.__decorate([K.property({json:{write:{ignoreOrigin:!0}}})],
f.prototype,"sublayers",void 0);k.__decorate([L.writer("sublayers",{layers:{type:[da]},visibleLayers:{type:[ea.Integer]}})],f.prototype,"writeSublayers",null);k.__decorate([K.property({type:["show","hide","hide-children"]})],f.prototype,"listMode",void 0);k.__decorate([K.property({json:{read:!1},readOnly:!0,value:"map-image"})],f.prototype,"type",void 0);k.__decorate([K.property(Q.url)],f.prototype,"url",void 0);return f=k.__decorate([Y.subclass("esri.layers.MapImageLayer")],f)});