// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../support/AggregateField ../support/featureReductionUtils ../../views/2d/layers/support/clusterUtils".split(" "),function(g,h,k,m,u,v,n,p,q,r){g.FeatureReductionLayer=d=>{d=function(l){function e(...a){var b=l.call(this,...a)||this;b.own(b.watch("renderer",()=>{if(b.featureReduction){const c=
b._normalizeFeatureReduction(b.featureReduction);b._set("featureReduction",c)}},!0));return b}h._inheritsLoose(e,l);e.prototype._normalizeFeatureReduction=function(a){if("cluster"!==a?.type)return a;const b=a.clone(),c=[new p({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],f=(b.fields??[]).filter(t=>!t.isAutoGenerated);if(a.renderer&&!a.renderer.authoringInfo?.isAutoGenerated)return b.fields=[...c,...f],b;if(a.symbol)return b.fields=[...c,...f],b.renderer=null,b;if(!this.renderer)return a;
a=r.createClusterRenderer(c,this.renderer,a,null,!1);b.fields=[...c,...f];b.renderer=a;return b};h._createClass(e,[{key:"featureReduction",set:function(a){a=this._normalizeFeatureReduction(a);this._set("featureReduction",a)}},{key:"renderer",set:function(a){}}]);return e}(d);k.__decorate([m.property(q.featureReductionProperty)],d.prototype,"featureReduction",null);return d=k.__decorate([n.subclass("esri.layers.mixins.FeatureReductionLayer")],d)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});