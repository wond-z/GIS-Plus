// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/identity/IdentityManagerBase":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/Evented ../core/events ../core/lang ../core/object ../core/promiseUtils ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./IdentityForm ./IdentityModal ./OAuthCredential ./OAuthInfo ./ServerInfo ../portal/support/urlUtils".split(" "),
function(E,B,v,t,w,K,F,T,N,M,D,V,Z,G,H,Q,ea,ja,aa,U,ma,ka,oa){const fa={},la=W=>{const X=(new G.Url(W.owningSystemUrl)).host;W=(new G.Url(W.server)).host;const u=/.+\.arcgis\.com$/i;return u.test(X)&&u.test(W)},pa=(W,X)=>!!(la(W)&&X&&X.some(u=>u.test(W.server)));let ba=null,ha=null;try{ba=window.localStorage,ha=window.sessionStorage}catch{}Q=function(W){function X(){var a=W.call(this)||this;a._portalConfig=globalThis.esriGeowConfig;a.serverInfos=[];a.oAuthInfos=[];a.credentials=[];a._soReqs=[];a._xoReqs=
[];a._portals=[];a._defaultOAuthInfo=null;a._defaultTokenValidity=60;a.dialog=null;a.formConstructor=ja;a.tokenValidity=null;a.normalizeWebTierAuth=!1;a._appOrigin="null"!==window.origin?window.origin:window.location.origin;a._appUrlObj=G.urlToObject(window.location.href);a._busy=null;a._rejectOnPersistedPageShow=!1;a._oAuthLocationParams=null;a._gwTokenUrl="/sharing/rest/generateToken";a._agsRest="/rest/services";a._agsPortal=/\/sharing(\/|$)/i;a._agsAdmin=/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i;
a._adminSvcs=/\/rest\/admin\/services(\/|$)/i;a._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},
{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}];a._legacyFed=[];a._regexSDirUrl=/http.+\/rest\/services\/?/gi;a._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi;
a._gwUser=/http.+\/users\/([^\/]+)\/?.*/i;a._gwItem=/http.+\/items\/([^\/]+)\/?.*/i;a._gwGroup=/http.+\/groups\/([^\/]+)\/?.*/i;a._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i;a._createDefaultOAuthInfo=!0;a._hasTestedIfAppIsOnPortal=!1;a._getOAuthLocationParams();window.addEventListener("pageshow",b=>{a._pageShowHandler(b)});return a}B._inheritsLoose(X,W);var u=X.prototype;u.registerServers=function(a){const b=this.serverInfos;b?(a=a.filter(c=>!this.findServerInfo(c.server)),this.serverInfos=
b.concat(a)):this.serverInfos=a;a.forEach(c=>{c.owningSystemUrl&&this._portals.push(c.owningSystemUrl);c.hasPortal&&this._portals.push(c.server)})};u.registerOAuthInfos=function(a){const b=this.oAuthInfos;if(b){for(const c of a){const d=this.findOAuthInfo(c.portalUrl);d&&b.splice(b.indexOf(d),1)}this.oAuthInfos=b.concat(a)}else this.oAuthInfos=a};u.registerToken=function(a){a={...a};const b=this._sanitizeUrl(a.server),c=this._isServerRsrc(b);let d=this.findServerInfo(b),f=!0,n;d||(d=new ka,d.server=
this._getServerInstanceRoot(b),c?d.hasServer=!0:(d.tokenServiceUrl=this._getTokenSvcUrl(b),d.hasPortal=!0),this.registerServers([d]));(n=this._findCredential(b))?(delete a.server,Object.assign(n,a),f=!1):(n=new E.Credential({userId:a.userId,server:d.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:c?"server":"portal"}),n.resources=[b],this.credentials.push(n));n.emitTokenChange(!1);f||n.refreshServerTokens()};u.toJSON=function(){return M.fixJson({serverInfos:this.serverInfos.map(a=>a.toJSON()),
oAuthInfos:this.oAuthInfos.map(a=>a.toJSON()),credentials:this.credentials.map(a=>a.toJSON())})};u.initialize=function(a){if(a){"string"===typeof a&&(a=JSON.parse(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){const d=[];b.forEach(f=>{f.server&&f.tokenServiceUrl&&d.push(f.declaredClass?f:new ka(f))});d.length&&this.registerServers(d)}if(c){const d=[];c.forEach(f=>{f.appId&&d.push(f.declaredClass?f:new ma(f))});d.length&&this.registerOAuthInfos(d)}a&&a.forEach(d=>{d.server&&d.token&&
d.expires&&d.expires>Date.now()&&(d=d.declaredClass?d:new E.Credential(d),d.emitTokenChange(),this.credentials.push(d))})}};u.findServerInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.serverInfos)if(this._hasSameServerInstance(c.server,a)){b=c;break}return b};u.findOAuthInfo=function(a){let b;a=this._sanitizeUrl(a);for(const c of this.oAuthInfos)if(this._hasSameServerInstance(c.portalUrl,a)){b=c;break}return b};u.findCredential=function(a,b){if(a){a=this._sanitizeUrl(a);var c=this._isServerRsrc(a)?
"server":"portal";if(b)for(const f of this.credentials){if(this._hasSameServerInstance(f.server,a)&&b===f.userId&&f.scope===c){var d=f;break}}else for(const f of this.credentials)if(this._hasSameServerInstance(f.server,a)&&-1!==this._getIdenticalSvcIdx(a,f)&&f.scope===c){d=f;break}return d}};u.getCredential=function(a,b){let c=!0;if(b){var d=!!b.token;var f=b.error;c=!1!==b.prompt}b={...b};a=this._sanitizeUrl(a);const n=new AbortController,r=V.createResolver();if(b.signal)V.onAbort(b.signal,()=>{n.abort()});
V.onAbort(n,()=>{r.reject(new F("identity-manager:user-aborted","ABORTED"))});if(V.isAborted(n))return r.promise;b.signal=n.signal;const A=this._isAdminResource(a);if((d=d?this.findCredential(a):null)&&f&&f.details&&498===f.details.httpStatus)d.destroy();else if(d)return a=new F("identity-manager:not-authorized","You are currently signed in as: '"+d.userId+"'. You do not have access to this resource: "+a,{error:f}),r.reject(a),r.promise;if(f=this._findCredential(a,b))return r.resolve(f),r.promise;
let l=this.findServerInfo(a);if(l)!l.hasServer&&this._isServerRsrc(a)&&(l._restInfoPms=this._getTokenSvcUrl(a),l.hasServer=!0);else{f=this._getTokenSvcUrl(a);if(!f)return a=new F("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),r.reject(a),r.promise;l=new ka;l.server=this._getServerInstanceRoot(a);"string"===typeof f?(l.tokenServiceUrl=f,l.hasPortal=!0):(l._restInfoPms=f,l.hasServer=!0);this.registerServers([l])}l.hasPortal&&void 0===l._selfReq&&(c||
G.hasSameOrigin(l.tokenServiceUrl,this._appOrigin)||this._gwDomains.some(p=>p.tokenServiceUrl===l.tokenServiceUrl))&&(l._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(l.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,l,b,r,A)};u.getResourceName=function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&
a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""};u.generateToken=function(a,b,c){const d=this._rePortalTokenSvc.test(a.tokenServiceUrl),f=new G.Url(this._appOrigin);var n=a.shortLivedTokenValidity;let r,A,l,p,h,e,g;b&&(g=this.tokenValidity||n||this._defaultTokenValidity,g>n&&0<n&&(g=n));c&&(r=c.isAdmin,A=c.serverUrl,l=c.token,h=c.signal,e=c.ssl,a.customParameters=c.customParameters);r?n=a.adminTokenServiceUrl:(n=a.tokenServiceUrl,p=new G.Url(n.toLowerCase()),
a.webTierAuth&&c?.serverUrl&&!e&&"http"===f.scheme&&(G.hasSameOrigin(f.uri,n,!0)||"https"===p.scheme&&f.host===p.host&&"7080"===f.port&&"7443"===p.port)&&(n=n.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));c={query:{request:"getToken",username:b?.username,password:b?.password,serverUrl:A,token:l,expiration:g,referer:r||d?this._appOrigin:null,client:r?"referer":null,f:"json",...a.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(a,c),signal:h,...c?.ioArgs};d||(c.withCredentials=
!1);return K(n,c).then(m=>{m=m.data;if(!m||!m.token)return new F("identity-manager:authentication-failed","Unable to generate token");const k=a.server;fa[k]||(fa[k]={});b&&(fa[k][b.username]=b.password);m.validity=g;return m})};u.isBusy=function(){return!!this._busy};u.checkSignInStatus=function(a){return this.checkAppAccess(a,"").then(b=>b.credential)};u.checkAppAccess=function(a,b,c){let d=!1;return this.getCredential(a,{prompt:!1}).then(f=>{let n;const r={f:"json"};if("portal"===f.scope)if(b&&
(this._doPortalSignIn(a)||c&&c.force))n=f.server+"/sharing/rest/oauth2/validateAppAccess",r.client_id=b;else if(f.token)n=f.server+"/sharing/rest";else return{credential:f};else if(f.token)n=f.server+"/rest/services";else return{credential:f};f.token&&(r.token=f.token);return K(n,{query:r,authMode:"anonymous"}).then(A=>{if(!1===A.data.valid)throw new F("identity-manager:not-authorized",`You are currently signed in as: '${f.userId}'.`,A.data);d=!!A.data.viewOnlyUserTypeApp;return{credential:f}}).catch(A=>
{if("identity-manager:not-authorized"===A.name)throw A;A=A.details&&A.details.httpStatus;if(498===A)throw f.destroy(),new F("identity-manager:not-authenticated","User is not signed in.");if(400===A)throw new F("identity-manager:invalid-request");return{credential:f}})}).then(f=>({credential:f.credential,viewOnly:d}))};u.setOAuthResponseHash=function(a){a&&("#"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(G.queryToObject(a)))};u.setOAuthRedirectionHandler=function(a){this._oAuthRedirectFunc=
a};u.setProtocolErrorHandler=function(a){this._protocolFunc=a};u.signIn=function(a,b,c={}){const d=V.createResolver(),f=()=>{A?.remove();l?.remove();p?.remove();r?.destroy();this.dialog?.destroy();this.dialog=r=A=l=p=null},n=()=>{f();this._oAuthDfd=null;d.reject(new F("identity-manager:user-aborted","ABORTED"))};if(c.signal)V.onAbort(c.signal,()=>{n()});let r=new this.formConstructor;r.resource=this.getResourceName(a);r.server=b.server;this.dialog=new aa;this.dialog.content=r;this.dialog.open=!0;
this.emit("dialog-create");let A=r.on("cancel",n),l=Z.watch(()=>this.dialog.open,n),p=r.on("submit",h=>{this.generateToken(b,h,{isAdmin:c.isAdmin,signal:c.signal}).then(e=>{f();e=new E.Credential({userId:h.username,server:b.server,token:e.token,expires:null!=e.expires?Number(e.expires):null,ssl:!!e.ssl,isAdmin:c.isAdmin,validity:e.validity});d.resolve(e)}).catch(e=>{r.error=e;r.signingIn=!1})});return d.promise};u.oAuthSignIn=function(a,b,c,d){const f=this._oAuthDfd=V.createResolver();if(d?.signal)V.onAbort(d.signal,
()=>{const m=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;m&&!m.closed?m.close():this.dialog&&e()});f.resUrl_=a;f.sinfo_=b;f.oinfo_=c;let n;const r=c._oAuthCred;if(r.storage&&("authorization-code"===c.flowType||"auto"===c.flowType&&!c.popup&&8.4<=b.currentVersion)){let m=crypto.getRandomValues(new Uint8Array(32));n=G.base64UrlEncode(m);r.codeVerifier=n;m=crypto.getRandomValues(new Uint8Array(32));r.stateUID=G.base64UrlEncode(m);r.save()||(r.codeVerifier=n=null)}else r.codeVerifier=null;this._getCodeChallenge(n).then(m=>
{const k=!d||!1!==d.oAuthPopupConfirmation;c.popup&&k?(A=new this.formConstructor,A.oAuthPrompt=!0,A.server=b.server,this.dialog=new aa,this.dialog.content=A,this.dialog.open=!0,this.emit("dialog-create"),l=A.on("cancel",e),p=Z.watch(()=>this.dialog.open,e),h=A.on("submit",()=>{g();this._doOAuthSignIn(a,b,c,m)})):this._doOAuthSignIn(a,b,c,m)});let A,l,p,h;const e=()=>{g();this._oAuthDfd=null;f.reject(new F("identity-manager:user-aborted","ABORTED"))},g=()=>{l?.remove();p?.remove();h?.remove();A?.destroy();
this.dialog?.destroy();this.dialog=null};return f.promise};u.destroyCredentials=function(){this.credentials&&this.credentials.slice().forEach(a=>{a.destroy()});this.emit("credentials-destroy")};u.enablePostMessageAuth=function(a="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove();this._postMessageAuthHandle=N.on(window,"message",b=>{if((b.origin===this._appOrigin||b.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===b.data?.type){const c=
b.source;this.getCredential(a).then(d=>{c.postMessage({type:"arcgis:auth:credential",credential:{expires:d.expires,server:d.server,ssl:d.ssl,token:d.token,userId:d.userId}},b.origin)}).catch(d=>{c.postMessage({type:"arcgis:auth:error",error:{name:d.name,message:d.message}},b.origin)})}})};u.disablePostMessageAuth=function(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)};u._getOAuthLocationParams=function(){var a=window.location.hash;if(a){"#"===
a.charAt(0)&&(a=a.substring(1));a=G.queryToObject(a);var b=!1;if(a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username"))try{a.state=JSON.parse(a.state),a.state.portalUrl&&(this._oAuthLocationParams=a,b=!0)}catch{}else if(a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0,a.state)))try{a.state=JSON.parse(a.state)}catch{}b&&(window.location.hash=a.state?.hash||"")}if(a=window.location.search){"?"===
a.charAt(0)&&(a=a.substring(1));a=G.queryToObject(a);b=!1;if(a.code&&a.state)try{a.state=JSON.parse(a.state),a.state.portalUrl&&a.state.uid&&(this._oAuthLocationParams=a,b=!0)}catch{}else if(a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0,a.state)))try{a.state=JSON.parse(a.state)}catch{}if(b){const c={...a};"code error error_description message_code persist state".split(" ").forEach(d=>{delete c[d]});b=
G.objectToQuery(c);window.history.replaceState(window.history.state,"",window.location.pathname+(b?`?${b}`:"")+(a.state?.hash||""))}}};u._getOAuthToken=function(a,b,c,d,f){a=a.replace(/^http:/i,"https:");return K(`${a}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:d&&f?{grant_type:"authorization_code",code:b,redirect_uri:d,client_id:c,code_verifier:f}:{grant_type:"refresh_token",refresh_token:b,client_id:c}}).then(n=>n.data)};u._getCodeChallenge=function(a){return a&&globalThis.isSecureContext?
(a=(new TextEncoder).encode(a),crypto.subtle.digest("SHA-256",a).then(b=>G.base64UrlEncode(new Uint8Array(b)))):Promise.resolve(null)};u._pageShowHandler=function(a){a.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow&&(a=new F("identity-manager:user-aborted","ABORTED"),this._errbackFunc(a))};u._findCredential=function(a,b){let c=-1,d,f,n;const r=b&&b.token;b=b&&b.resource;const A=this._isServerRsrc(a)?"server":"portal",l=this.credentials.filter(p=>this._hasSameServerInstance(p.server,a)&&
p.scope===A);a=b||a;if(l.length)if(1===l.length)if(b=l[0],n=(d=(f=this.findServerInfo(b.server))&&f.owningSystemUrl)?this.findCredential(d,b.userId):void 0,c=this._getIdenticalSvcIdx(a,b),r)-1!==c&&(b.resources.splice(c,1),this._removeResource(a,n));else return-1===c&&b.resources.push(a),this._addResource(a,n),b;else{let p,h;l.some(e=>{h=this._getIdenticalSvcIdx(a,e);return-1!==h?(p=e,n=(d=(f=this.findServerInfo(p.server))&&f.owningSystemUrl)?this.findCredential(d,p.userId):void 0,c=h,!0):!1});if(r)p&&
(p.resources.splice(c,1),this._removeResource(a,n));else if(p)return this._addResource(a,n),p}};u._findOAuthInfo=function(a){let b=this.findOAuthInfo(a);if(!b)for(const c of this.oAuthInfos)if(this._isIdProvider(c.portalUrl,a)){b=c;break}return b};u._addResource=function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)};u._removeResource=function(a,b){let c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&b.resources.splice(c,1))};u._useProxy=function(a,b){return b&&b.isAdmin&&!G.hasSameOrigin(a.adminTokenServiceUrl,
this._appOrigin)||!this._isPortalDomain(a.tokenServiceUrl)&&"10.1"===String(a.currentVersion)&&!G.hasSameOrigin(a.tokenServiceUrl,this._appOrigin)};u._getOrigin=function(a){a=new G.Url(a);return a.scheme+"://"+a.host+(null!=a.port?":"+a.port:"")};u._getServerInstanceRoot=function(a){const b=a.toLowerCase();let c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=this._agsAdmin.test(a)?a.replace(this._agsAdmin,"$1").length:a.search(this._adminSvcs));-1!==c||oa.isSecureProxyService(b)||(c=
b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a};u._hasSameServerInstance=function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=this._normalizeAGOLorgDomain(a);b=this._normalizeAGOLorgDomain(b);a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b};u._normalizeAGOLorgDomain=function(a){const b=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,c=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,
d=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;b.test(a)?a=a.replace(b,"https://www.arcgis.com"):c.test(a)?a=a.replace(c,"https://devext.arcgis.com"):d.test(a)&&(a=a.replace(d,"https://qaext.arcgis.com"));return a};u._sanitizeUrl=function(a){const b=(t.request.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+b.length+1));a=G.normalize(a);return G.urlToObject(a).path};u._isRESTService=function(a){return a.includes(this._agsRest)};u._isAdminResource=
function(a){return this._agsAdmin.test(a)||this._adminSvcs.test(a)};u._isServerRsrc=function(a){return this._isRESTService(a)||this._isAdminResource(a)};u._isIdenticalService=function(a,b){var c=!1;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),c=a===b,c||(c=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi,c=a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||
this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c};u._isPortalDomain=function(a){const b=new G.Url(a.toLowerCase());a=this._portalConfig;let c=this._gwDomains.some(d=>d.regex.test(b.uri));!c&&a&&(c=this._hasSameServerInstance(this._getServerInstanceRoot(a.restBaseUrl),b.uri));c||t.portalUrl&&(c=G.hasSameOrigin(b,t.portalUrl,!0));c||(c=this._portals.some(d=>this._hasSameServerInstance(d,b.uri)));return c=c||this._agsPortal.test(b.path)};u._isIdProvider=function(a,b){let c=-1,d=-1;this._gwDomains.forEach((n,
r)=>{-1===c&&n.regex.test(a)&&(c=r);-1===d&&n.regex.test(b)&&(d=r)});let f=!1;if(-1<c&&-1<d)if(0===c||4===c){if(0===d||4===d)f=!0}else if(1===c){if(1===d||2===d)f=!0}else 2===c?2===d&&(f=!0):3===c&&3===d&&(f=!0);if(!f){const n=this.findServerInfo(b),r=n&&n.owningSystemUrl;r&&la(n)&&this._isPortalDomain(r)&&this._isIdProvider(a,r)&&(f=!0)}return f};u._getIdenticalSvcIdx=function(a,b){let c=-1;for(let d=0;d<b.resources.length;d++)if(this._isIdenticalService(a,b.resources[d])){c=d;break}return c};u._getSuffix=
function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")};u._getTokenSvcUrl=function(a){if(this._isRESTService(a)||this._isAdminResource(a)){var b=this._getServerInstanceRoot(a);var c=b+"/admin/generateToken";a=b+"/rest/info";b=K(a,{query:{f:"json"}}).then(d=>d.data);return{adminUrl:c,promise:b}}if(this._isPortalDomain(a)){let d="";this._gwDomains.some(f=>{f.regex.test(a)&&(d=f.tokenServiceUrl);return!!d});d||this._portals.some(f=>{this._hasSameServerInstance(f,a)&&
(d=f+this._gwTokenUrl);return!!d});d||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(d=a.substring(0,c)+this._gwTokenUrl));d||(d=this._getOrigin(a)+this._gwTokenUrl);d&&(c=(new G.Url(a)).port,/^http:\/\//i.test(a)&&"7080"===c&&(d=d.replace(/:7080/i,":7443")),d=d.replace(/http:/i,"https:"));return d}if(a.toLowerCase().includes("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"};u._processOAuthResponseParams=function(a,b,c){const d=b._oAuthCred;if(a.code){var f=d.codeVerifier;
d.codeVerifier=null;d.stateUID=null;d.save();return this._getOAuthToken(c.server,a.code,b.appId,this._getRedirectURI(b,!0),f).then(n=>{const r=new E.Credential({userId:n.username,server:c.server,token:n.access_token,expires:Date.now()+1E3*n.expires_in,ssl:n.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=r.userId;d.storage=n.persist?ba:ha;d.refreshToken=n.refresh_token;d.token=null;d.expires=n.refresh_token_expires_in?Date.now()+1E3*n.refresh_token_expires_in:null;d.userId=r.userId;d.ssl=r.ssl;d.save();
return r})}f=new E.Credential({userId:a.username,server:c.server,token:a.access_token,expires:Date.now()+1E3*Number(a.expires_in),ssl:"true"===a.ssl,oAuthState:a.state,_oAuthCred:d});b.userId=f.userId;d.storage=a.persist?ba:ha;d.refreshToken=null;d.token=f.token;d.expires=f.expires;d.userId=f.userId;d.ssl=f.ssl;d.save();return Promise.resolve(f)};u._processOAuthPopupParams=function(a){const b=this._oAuthDfd;this._oAuthDfd=null;if(b)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),
a.error){const c="access_denied"===a.error;a=new F(c?"identity-manager:user-aborted":"identity-manager:authentication-failed",c?"ABORTED":"OAuth: "+a.error+" - "+a.error_description);b.reject(a)}else this._processOAuthResponseParams(a,b.oinfo_,b.sinfo_).then(c=>{b.resolve(c)}).catch(c=>{b.reject(c)})};u._setOAuthResponseQueryString=function(a){a&&("?"===a.charAt(0)&&(a=a.substring(1)),this._processOAuthPopupParams(G.queryToObject(a)))};u._exchangeToken=function(a,b,c){return K(`${a}/sharing/rest/oauth2/exchangeToken`,
{authMode:"anonymous",method:"post",query:{f:"json",client_id:b,token:c}}).then(d=>d.data.token)};u._getPlatformSelf=function(a,b){a=a.replace(/^http:/i,"https:");return K(`${a}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":b,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0}).then(c=>c.data)};u._getPortalSelf=function(a,b){let c;this._gwDomains.some(d=>{d.regex.test(a)&&(c=
d.customBaseUrl);return!!c});if(c)return Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:c,portalMode:"multitenant",supportsOAuth:!0});this._appOrigin.startsWith("https:")?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return K(a,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then(d=>d.data)};u._doPortalSignIn=function(a){const b=this._portalConfig,c=window.location.href,d=this.findServerInfo(a);
return(b||this._isPortalDomain(c))&&(d?d.hasPortal||d.owningSystemUrl&&this._isPortalDomain(d.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(c,a)||b&&(this._hasSameServerInstance(this._getServerInstanceRoot(b.restBaseUrl),a)||this._isIdProvider(b.restBaseUrl,a))||G.hasSameOrigin(c,a,!0))?!0:!1};u._checkProtocol=function(a,b,c,d){let f=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;d.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&G.getProxyRule(d)&&
(f=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,f||(a=new F("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection."),c(a)));return f};u._enqueue=function(a,b,c,d,f,n){d||(d=V.createResolver());d.resUrl_=a;d.sinfo_=b;d.options_=c;d.admin_=f;d.refresh_=n;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(d)):
this._xoReqs.push(d):this._doSignIn(d);return d.promise};u._doSignIn=function(a){this._busy=a;this._rejectOnPersistedPageShow=!1;const b=l=>{var p=a.options_&&a.options_.resource;const h=a.resUrl_,e=a.refresh_;let g=!1;this.credentials.includes(l)||(e&&this.credentials.includes(e)?(e.userId=l.userId,e.token=l.token,e.expires=l.expires,e.validity=l.validity,e.ssl=l.ssl,e.creationTime=l.creationTime,g=!0,l=e):this.credentials.push(l));l.resources||(l.resources=[]);l.resources.includes(p||h)||l.resources.push(p||
h);l.scope=this._isServerRsrc(h)?"server":"portal";l.emitTokenChange();p=this._soReqs;const m={};this._soReqs=[];p.forEach(k=>{if(!this._isIdenticalService(h,k.resUrl_)){const y=this._getSuffix(k.resUrl_);m[y]||(m[y]=!0,l.resources.push(k.resUrl_))}});a.resolve(l);p.forEach(k=>{this._hasSameServerInstance(this._getServerInstanceRoot(h),k.resUrl_)?k.resolve(l):this._soReqs.push(k)});this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;g||this.emit("credential-create",{credential:l});this._soReqs.length?this._doSignIn(this._soReqs.shift()):
this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},c=l=>{a.reject(l);this._busy=a.resUrl_=a.sinfo_=a.refresh_=null;this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},d=(l,p,h,e)=>{const g=a.sinfo_,m=!a.options_||!1!==a.options_.prompt,k=g.hasPortal&&this._findOAuthInfo(a.resUrl_);let y,C;if(l)b(new E.Credential({userId:l,server:g.server,token:h||null,expires:null!=e?Number(e):null,ssl:!!p}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&
this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),a.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const x=N.on(window,"message",I=>{I.source===window.parent&&I.data&&("arcgis:auth:credential"===I.data.type?(x.remove(),I.data.credential.expires<Date.now()?c(new F("identity-manager:credential-request-failed","Parent application's token has expired.")):
b(new E.Credential(I.data.credential))):"arcgis:auth:error"===I.data.type&&(x.remove(),"tokenExpiredError"===I.data.error.name?c(new F("identity-manager:credential-request-failed","Parent application's token has expired.")):c(F.fromJSON(I.data.error))))});V.onAbort(a.options_?.signal,()=>{x.remove()})}else if(k){let x=k._oAuthCred;x||(l=new U(k,ba),p=new U(k,ha),l.isValid()&&p.isValid()?l.expires>p.expires?(x=l,p.destroy()):(x=p,l.destroy()):x=l.isValid()?l:p,k._oAuthCred=x);if(x.isValid()){y=new E.Credential({userId:x.userId,
server:g.server,token:x.token,expires:x.expires,ssl:x.ssl,_oAuthCred:x});const I=k.appId!==x.appId&&this._doPortalSignIn(a.resUrl_);I||x.refreshToken?(a._pendingDfd=x.refreshToken?this._getOAuthToken(g.server,x.refreshToken,x.appId).then(J=>{y.expires=Date.now()+1E3*J.expires_in;y.token=J.access_token;return y}):Promise.resolve(y),a._pendingDfd.then(J=>I?this._exchangeToken(J.server,k.appId,J.token).then(R=>{J.token=R;return J}).catch(()=>J):J).then(J=>{b(J)}).catch(()=>{x?.destroy();d()})):b(y)}else if(this._oAuthLocationParams&&
this._hasSameServerInstance(k.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===x.stateUID&&x.codeVerifier))l=this._oAuthLocationParams,this._oAuthLocationParams=null,a._pendingDfd=this._processOAuthResponseParams(l,k,g).then(I=>{b(I)}).catch(c);else{const I=()=>{m?a._pendingDfd=this.oAuthSignIn(a.resUrl_,g,k,a.options_).then(b,c):(C=new F("identity-manager:not-authenticated","User is not signed in."),
c(C))};this._doPortalSignIn(a.resUrl_)?a._pendingDfd=this._getPlatformSelf(g.server,k.appId).then(J=>{G.hasSameOrigin(J.portalUrl,this._appOrigin,!0)?(y=new E.Credential({userId:J.username,server:g.server,expires:Date.now()+1E3*J.expires_in,token:J.token}),b(y)):I()}).catch(I):I()}}else m?this._checkProtocol(a.resUrl_,g,c,a.admin_)&&(l=a.options_,a.admin_&&(l=l||{},l.isAdmin=!0),a._pendingDfd=this.signIn(a.resUrl_,g,l).then(b,c)):(C=new F("identity-manager:not-authenticated","User is not signed in."),
c(C))},f=()=>{const l=a.sinfo_;var p=l.owningSystemUrl;const h=a.options_;let e,g,m,k;h&&(e=h.token,g=h.error,m=h.prompt);k=this._findCredential(p,{token:e,resource:a.resUrl_});if(!k)for(const y of this.credentials)if(this._isIdProvider(p,y.server)){k=y;break}k?(p=this.findCredential(a.resUrl_,k.userId))?b(p):pa(l,this._legacyFed)?(p=k.toJSON(),p.server=l.server,p.resources=null,b(new E.Credential(p))):(a._pendingDfd=this.generateToken(this.findServerInfo(k.server),null,{serverUrl:a.resUrl_,token:k.token,
signal:a.options_.signal,ssl:k.ssl})).then(y=>{b(new E.Credential({userId:k?.userId,server:l.server,token:y.token,expires:null!=y.expires?Number(y.expires):null,ssl:!!y.ssl,isAdmin:a.admin_,validity:y.validity}))},c):(this._busy=null,e&&(a.options_.token=null),(a._pendingDfd=this.getCredential(p.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:l.owningTenant,signal:a.options_.signal,token:e,error:g,prompt:m})).then(()=>{this._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},y=>{a.resUrl_=
a.sinfo_=a.refresh_=null;a.reject(y)}))};this._errbackFunc=c;const n=a.sinfo_.owningSystemUrl,r=this._isServerRsrc(a.resUrl_),A=a.sinfo_._restInfoPms;A?A.promise.then(l=>{const p=a.sinfo_;p._restInfoPms&&(p.adminTokenServiceUrl=p._restInfoPms.adminUrl,p._restInfoPms=null,p.tokenServiceUrl=(D.getDeepValue("authInfo.tokenServicesUrl",l)||D.getDeepValue("authInfo.tokenServiceUrl",l)||D.getDeepValue("tokenServiceUrl",l))??null,p.shortLivedTokenValidity=D.getDeepValue("authInfo.shortLivedTokenValidity",
l)??null,p.currentVersion=l.currentVersion,p.owningTenant=l.owningTenant,(l=p.owningSystemUrl=l.owningSystemUrl)&&this._portals.push(l));r&&p.owningSystemUrl?f():d()},()=>{a.sinfo_._restInfoPms=null;const l=new F("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");c(l)}):r&&n?f():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(l=>{const p={};let h,e,g,m;l&&(h=l.user&&l.user.username,p.username=h,p.allSSL=l.allSSL,e=l.supportsOAuth,m=parseFloat(l.currentVersion),
"multitenant"===l.portalMode&&(g=l.customBaseUrl),a.sinfo_.currentVersion=m);a.sinfo_.webTierAuth=!!h;return h&&this.normalizeWebTierAuth?this.generateToken(a.sinfo_,null,{ssl:p.allSSL}).catch(()=>null).then(k=>{p.portalToken=k&&k.token;p.tokenExpiration=k&&k.expires;return p}):!h&&e&&4.4<=m&&!this._findOAuthInfo(a.resUrl_)?this._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:g,owningTenant:a.sinfo_._selfReq.owningTenant}).catch(()=>null).then(()=>p):p}).catch(()=>null).then(l=>{a.sinfo_._selfReq=
null;l?d(l.username,l.allSSL,l.portalToken,l.tokenExpiration):d()}):d()};u._generateOAuthInfo=function(a){let b=null,c=a.portalUrl;const d=a.customBaseUrl,f=a.owningTenant;if(a=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){b=window.location.href;let n=b.indexOf("?");-1<n&&(b=b.slice(0,n));n=b.search(/\/(apps|home)\//);b=-1<n?b.slice(0,n):null}a&&b?(this._hasTestedIfAppIsOnPortal=!0,a=K(b+"/sharing/rest",{query:{f:"json"}}).then(()=>{this._defaultOAuthInfo=
new ma({appId:"arcgisonline",popupCallbackUrl:b+"/home/oauth-callback.html"})})):a=Promise.resolve();return a.then(()=>{if(this._defaultOAuthInfo)return c=c.replace(/^http:/i,"https:"),K(c+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:f,client_id:this._defaultOAuthInfo.appId,redirect_uri:G.makeAbsolute(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then(n=>{if(n.data.valid){const r=this._defaultOAuthInfo.clone();r.portalUrl=n.data.urlKey&&d?"https://"+n.data.urlKey.toLowerCase()+
"."+d:c;r.popup=window!==window.top||!(G.hasSameOrigin(c,this._appOrigin)||this._gwDomains.some(A=>A.regex.test(c)&&A.regex.test(this._appOrigin)));this.oAuthInfos.push(r)}})})};u._doOAuthSignIn=function(a,b,c,d){var f=c._oAuthCred,n={portalUrl:c.portalUrl};!c.popup&&c.preserveUrlHash&&window.location.hash&&(n.hash=window.location.hash);f.stateUID&&(n.uid=f.stateUID);n={client_id:c.appId,response_type:f.codeVerifier?"code":"token",state:JSON.stringify(n),expiration:c.expiration,locale:c.locale,redirect_uri:this._getRedirectURI(c,
!!f.codeVerifier)};c.forceLogin&&(n.force_login=!0);c.forceUserId&&c.userId&&(n.prepopulatedusername=c.userId);!c.popup&&this._doPortalSignIn(a)&&(n.redirectToUserOrgUrl=!0);f.codeVerifier&&(n.code_challenge=d||f.codeVerifier,n.code_challenge_method=d?"S256":"plain");d=c.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize";f=d+"?"+G.objectToQuery(n);if(c.popup){const r=window.open(f,"esriJSAPIOAuth",c.popupWindowFeatures);r?(r.focus(),this._oAuthDfd.oAuthWin_=r,this._oAuthIntervalId=
setInterval(()=>{if(r.closed){clearInterval(this._oAuthIntervalId);this._oAuthOnPopupHandle.remove();const A=this._oAuthDfd;if(A){const l=new F("identity-manager:user-aborted","ABORTED");A.reject(l)}}},500),this._oAuthOnPopupHandle=N.on(window,["arcgis:auth:hash","arcgis:auth:location:search"],A=>{"arcgis:auth:hash"===A.type?this.setOAuthResponseHash(A.detail):this._setOAuthResponseQueryString(A.detail)})):(a=new F("identity-manager:popup-blocked","ABORTED"),this._oAuthDfd.reject(a))}else this._rejectOnPersistedPageShow=
!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:n,authorizeUrl:d,resourceUrl:a,serverInfo:b,oAuthInfo:c}):window.location.href=f};u._getRedirectURI=function(a,b){const c=window.location.href.replace(/#.*$/,"");if(a.popup)return G.makeAbsolute(a.popupCallbackUrl);if(b){const d=G.urlToObject(c);d.query&&"code error error_description message_code persist state".split(" ").forEach(f=>{delete d.query[f]});return G.addQueryParameters(d.path,d.query)}return c};return X}(T);Q.prototype.declaredClass=
"esri.identity.IdentityManagerBase";E.Credential=function(W){function X(a){var b=W.call(this,a)||this;b._oAuthCred=null;b.tokenRefreshBuffer=2;a&&a._oAuthCred&&(b._oAuthCred=a._oAuthCred);return b}B._inheritsLoose(X,W);var u=X.prototype;u.initialize=function(){this.resources=this.resources||[];null==this.creationTime&&(this.creationTime=Date.now())};u.refreshToken=function(){const a=w.id.findServerInfo(this.server),b=a&&a.owningSystemUrl,c=!!b&&"server"===this.scope,d=c&&pa(a,w.id._legacyFed);var f=
a.webTierAuth;const n=f&&w.id.normalizeWebTierAuth;var r=fa[this.server];r=r&&r[this.userId];let A=this.resources&&this.resources[0],l=c?w.id.findServerInfo(b):null,p={username:this.userId,password:r},h;if(!f||n)if(c&&!l&&w.id.serverInfos.some(e=>{w.id._isIdProvider(b,e.server)&&(l=e);return!!l}),f=l?w.id.findCredential(l.server,this.userId):null,!c||f)if(d)f?.refreshToken();else{if(c)h={serverUrl:A,token:f&&f.token,ssl:f&&f.ssl};else if(n)p=null,h={ssl:this.ssl};else if(r)this.isAdmin&&(h={isAdmin:!0});
else{let e;A&&(A=w.id._sanitizeUrl(A),this._enqueued=1,e=w.id._enqueue(A,a,null,null,this.isAdmin,this),e.then(()=>{this._enqueued=0;this.refreshServerTokens()}).catch(()=>{this._enqueued=0}));return e}return w.id.generateToken(c?l:a,c?null:p,h).then(e=>{this.token=e.token;this.expires=null!=e.expires?Number(e.expires):null;this.creationTime=Date.now();this.validity=e.validity;this.emitTokenChange();this.refreshServerTokens()}).catch(()=>{})}};u.refreshServerTokens=function(){"portal"===this.scope&&
w.id.credentials.forEach(a=>{const b=w.id.findServerInfo(a.server),c=b&&b.owningSystemUrl;a!==this&&a.userId===this.userId&&c&&"server"===a.scope&&(w.id._hasSameServerInstance(this.server,c)||w.id._isIdProvider(c,this.server))&&(pa(b,w.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.emitTokenChange()):a.refreshToken())})};u.emitTokenChange=function(a){clearTimeout(this._refreshTimer);var b=this.server&&w.id.findServerInfo(this.server);
const c=(b=b&&b.owningSystemUrl)&&w.id.findServerInfo(b);!1===a||b&&"portal"!==this.scope&&(!c||!c.webTierAuth||w.id.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer();this.emit("token-change")};u.destroy=function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const a=w.id.credentials.indexOf(this);-1<a&&w.id.credentials.splice(a,1);this.emitTokenChange();
this.emit("destroy")};u.toJSON=function(){const a=M.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a};u._startRefreshTimer=function(){clearTimeout(this._refreshTimer);const a=6E4*this.tokenRefreshBuffer,b=2**31-1;let c=(this.validity?this.creationTime+6E4*this.validity:this.expires)-Date.now();
0>c?c=0:c>b&&(c=b);this._refreshTimer=setTimeout(this.refreshToken.bind(this),c>a?c-a:c)};return X}(T.EventedAccessor);v.__decorate([H.property()],E.Credential.prototype,"creationTime",void 0);v.__decorate([H.property()],E.Credential.prototype,"expires",void 0);v.__decorate([H.property()],E.Credential.prototype,"isAdmin",void 0);v.__decorate([H.property()],E.Credential.prototype,"oAuthState",void 0);v.__decorate([H.property()],E.Credential.prototype,"resources",void 0);v.__decorate([H.property()],
E.Credential.prototype,"scope",void 0);v.__decorate([H.property()],E.Credential.prototype,"server",void 0);v.__decorate([H.property()],E.Credential.prototype,"ssl",void 0);v.__decorate([H.property()],E.Credential.prototype,"token",void 0);v.__decorate([H.property()],E.Credential.prototype,"tokenRefreshBuffer",void 0);v.__decorate([H.property()],E.Credential.prototype,"userId",void 0);v.__decorate([H.property()],E.Credential.prototype,"validity",void 0);E.Credential=v.__decorate([ea.subclass("esri.identity.Credential")],
E.Credential);E.IdentityManagerBase=Q;Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/identity/IdentityForm":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../intl/substitute ../widgets/Widget ../widgets/support/widgetUtils ../widgets/support/decorators/messageBundle ../widgets/support/jsxFactory".split(" "),
function(E,B,v,t,w,K,F,T,N,M,D){t=function(V){function Z(H,Q){H=V.call(this,H,Q)||this;H._usernameInputNode=null;H._passwordInputNode=null;H.signingIn=!1;H.server=null;H.resource=null;H.error=null;H.oAuthPrompt=!1;return H}E._inheritsLoose(Z,V);var G=Z.prototype;G.render=function(){const {error:H,server:Q,resource:ea,signingIn:ja,oAuthPrompt:aa,messages:U}=this,ma=D.tsx("div",{class:"esri-identity-form__group"},F.substitute(aa?U.oAuthInfo:U.info,{server:Q&&/\.arcgis\.com/i.test(Q)?"ArcGIS Online":
Q,resource:`(${ea||U.lblItem})`})),ka=aa?null:D.tsx("div",{class:"esri-identity-form__group",key:"username"},D.tsx("label",{class:"esri-identity-form__label"},U.lblUser,D.tsx("input",{value:"",required:!0,autocomplete:"off",spellcheck:!1,type:"text",bind:this,afterCreate:N.storeNode,"data-node-ref":"_usernameInputNode",class:"esri-input"}))),oa=aa?null:D.tsx("div",{class:"esri-identity-form__group",key:"password"},D.tsx("label",{class:"esri-identity-form__label"},U.lblPwd,D.tsx("input",{value:"",
required:!0,type:"password",bind:this,afterCreate:N.storeNode,"data-node-ref":"_passwordInputNode",class:"esri-input"}))),fa=D.tsx("div",{class:this.classes("esri-identity-form__group","esri-identity-form__footer")},D.tsx("input",{type:"submit",disabled:!!ja,value:ja?U.lblSigning:U.lblOk,class:"esri-button"}),D.tsx("input",{type:"button",value:U.lblCancel,bind:this,onclick:this._cancel,class:this.classes("esri-button","esri-button--secondary")})),la=H?D.tsx("div",null,H.details&&H.details.httpStatus?
U.invalidUser:U.noAuthService):null;return D.tsx("form",{class:"esri-identity-form",bind:this,onsubmit:this._submit},ma,la,ka,oa,fa)};G._cancel=function(){this._set("signingIn",!1);this._usernameInputNode&&(this._usernameInputNode.value="");this._passwordInputNode&&(this._passwordInputNode.value="");this.emit("cancel")};G._submit=function(H){H.preventDefault();this._set("signingIn",!0);this.emit("submit",this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&
this._passwordInputNode.value})};return Z}(T);B.__decorate([v.property(),M.messageBundle("esri/identity/t9n/identity")],t.prototype,"messages",void 0);B.__decorate([v.property()],t.prototype,"signingIn",void 0);B.__decorate([v.property()],t.prototype,"server",void 0);B.__decorate([v.property()],t.prototype,"resource",void 0);B.__decorate([v.property()],t.prototype,"error",void 0);B.__decorate([v.property()],t.prototype,"oAuthPrompt",void 0);return t=B.__decorate([K.subclass("esri.identity.IdentityForm")],
t)})},"esri/identity/IdentityModal":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/handleUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../widgets/Widget ../widgets/support/widget ../widgets/support/jsxFactory ../widgets/support/decorators/messageBundle".split(" "),function(E,B,v,t,w,K,F,T,N,M,D,V){function Z(p,h){var e=Object.keys(p);if(Object.getOwnPropertySymbols){var g=
Object.getOwnPropertySymbols(p);h&&(g=g.filter(function(m){return Object.getOwnPropertyDescriptor(p,m).enumerable}));e.push.apply(e,g)}return e}function G(p){for(var h=1;h<arguments.length;h++){var e=null!=arguments[h]?arguments[h]:{};h%2?Z(Object(e),!0).forEach(function(g){var m=e[g];g in p?Object.defineProperty(p,g,{value:m,enumerable:!0,configurable:!0,writable:!0}):p[g]=m}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(e)):Z(Object(e)).forEach(function(g){Object.defineProperty(p,
g,Object.getOwnPropertyDescriptor(e,g))})}return p}K='input select textarea a[href] button [tabindex]:not(slot) audio[controls] video[controls] [contenteditable]:not([contenteditable\x3d"false"]) details\x3esummary:first-of-type details'.split(" ");var H=K.join(","),Q=(F="undefined"===typeof Element)?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,ea=!F&&Element.prototype.getRootNode?function(p){return p.getRootNode()}:function(p){return p.ownerDocument},
ja=function(p,h,e){var g=Array.prototype.slice.apply(p.querySelectorAll(H));h&&Q.call(p,H)&&g.unshift(p);return g=g.filter(e)},aa=function m(h,e,g){for(var k=[],y=Array.from(h);y.length;){var C=y.shift();if("SLOT"===C.tagName){var x=C.assignedElements();x=m(x.length?x:C.children,!0,g);g.flatten?k.push.apply(k,x):k.push({scope:C,candidates:x})}else{Q.call(C,H)&&g.filter(C)&&(e||!h.includes(C))&&k.push(C);x=C.shadowRoot||"function"===typeof g.getShadowRoot&&g.getShadowRoot(C);var I=!g.shadowRootFilter||
g.shadowRootFilter(C);x&&I?(x=m(!0===x?C.children:x.children,!0,g),g.flatten?k.push.apply(k,x):k.push({scope:C,candidates:x})):y.unshift.apply(y,C.children)}}return k},U=function(h,e){return 0>h.tabIndex&&(e||/^(AUDIO|VIDEO|DETAILS)$/.test(h.tagName)||h.isContentEditable)&&isNaN(parseInt(h.getAttribute("tabindex"),10))?0:h.tabIndex},ma=function(h,e){return h.tabIndex===e.tabIndex?h.documentOrder-e.documentOrder:h.tabIndex-e.tabIndex},ka=function(h){return"DETAILS"===h.tagName&&Array.prototype.slice.apply(h.children).some(function(e){return"SUMMARY"===
e.tagName})},oa=function(h,e){for(var g=0;g<h.length;g++)if(h[g].checked&&h[g].form===e)return h[g]},fa=function(h){if(!h.name)return!0;var e=h.form||ea(h),g=function(k){return e.querySelectorAll('input[type\x3d"radio"][name\x3d"'+k+'"]')};if("undefined"!==typeof window&&"undefined"!==typeof window.CSS&&"function"===typeof window.CSS.escape)var m=g(window.CSS.escape(h.name));else try{m=g(h.name)}catch(k){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",
k.message),!1}g=oa(m,h.form);return!g||g===h},la=function(h){h=h.getBoundingClientRect();var e=h.height;return 0===h.width&&0===e},pa=function(h,e){var g=e.displayCheck;e=e.getShadowRoot;if("hidden"===getComputedStyle(h).visibility)return!0;var m=Q.call(h,"details\x3esummary:first-of-type")?h.parentElement:h;if(Q.call(m,"details:not([open]) *"))return!0;if(!g||"full"===g||"legacy-full"===g){if("function"===typeof e){for(m=h;h;){var k=h.parentElement,y=ea(h);if(k&&!k.shadowRoot&&!0===e(k))return la(h);
h=h.assignedSlot?h.assignedSlot:k||y===h.ownerDocument?k:y.host}h=m}e=h;var C;m=ea(e).host;for(k=!!(null!==(C=m)&&void 0!==C&&C.ownerDocument.contains(m)||e.ownerDocument.contains(e));!k&&m;){var x;m=ea(m).host;k=!(null===(x=m)||void 0===x||!x.ownerDocument.contains(m))}if(k)return!h.getClientRects().length;if("legacy-full"!==g)return!0}else if("non-zero-area"===g)return la(h);return!1},ba=function(h,e){var g;(g=e.disabled)||(g="INPUT"===e.tagName&&"hidden"===e.type);if(!(h=g||pa(e,h)||ka(e)))a:{if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(h=
e.parentElement;h;){if("FIELDSET"===h.tagName&&h.disabled){for(g=0;g<h.children.length;g++){var m=h.children.item(g);if("LEGEND"===m.tagName){h=Q.call(h,"fieldset[disabled] *")?!0:!m.contains(e);break a}}h=!0;break a}h=h.parentElement}h=!1}return h?!1:!0},ha=function(h,e){return"INPUT"===e.tagName&&"radio"===e.type&&!fa(e)||0>U(e)||!ba(h,e)?!1:!0},W=function(h){h=parseInt(h.getAttribute("tabindex"),10);return isNaN(h)||0<=h?!0:!1},X=function g(e){var m=[],k=[];e.forEach(function(y,C){var x=!!y.scope,
I=x?y.scope:y,J=U(I,x),R=x?g(y.candidates):I;0===J?x?m.push.apply(m,R):m.push(I):k.push({documentOrder:C,tabIndex:J,item:y,isScope:x,content:R})});return k.sort(ma).reduce(function(y,C){C.isScope?y.push.apply(y,C.content):y.push(C.content);return y},[]).concat(m)},u=function(e,g){g=g||{};e=g.getShadowRoot?aa([e],g.includeContainer,{filter:ha.bind(null,g),flatten:!1,getShadowRoot:g.getShadowRoot,shadowRootFilter:W}):ja(e,g.includeContainer,ha.bind(null,g));return X(e)},a=function(e,g){g=g||{};return g.getShadowRoot?
aa([e],g.includeContainer,{filter:ba.bind(null,g),flatten:!0,getShadowRoot:g.getShadowRoot}):ja(e,g.includeContainer,ba.bind(null,g))},b=function(e,g){g=g||{};if(!e)throw Error("No node provided");return!1===Q.call(e,H)?!1:ha(g,e)},c=K.concat("iframe").join(","),d=function(e,g){g=g||{};if(!e)throw Error("No node provided");return!1===Q.call(e,c)?!1:ba(g,e)},f=function(){var e=[];return{activateTrap:function(g){if(0<e.length){var m=e[e.length-1];m!==g&&m.pause()}m=e.indexOf(g);-1!==m&&e.splice(m,1);
e.push(g)},deactivateTrap:function(g){g=e.indexOf(g);-1!==g&&e.splice(g,1);0<e.length&&e[e.length-1].unpause()}}}(),n=function(e,g){var m=-1;e.every(function(k,y){return g(k)?(m=y,!1):!0});return m},r=function(e){for(var g=arguments.length,m=Array(1<g?g-1:0),k=1;k<g;k++)m[k-1]=arguments[k];return"function"===typeof e?e.apply(void 0,m):e},A=function(e){return e.target.shadowRoot&&"function"===typeof e.composedPath?e.composedPath()[0]:e.target},l=function(e,g){var m=(null===g||void 0===g?void 0:g.document)||
document,k=G({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},g),y=[],C=[],x=[],I=null,J=null,R=!1,ca=!1,na=void 0,da=function(L,q,z){return L&&void 0!==L[q]?L[q]:k[z||q]},qa=function(L){return C.findIndex(function(q){var z=q.tabbableNodes;return q.container.contains(L)||z.find(function(O){return O===L})})},ra=function(L){var q=k[L];if("function"===typeof q){for(var z=arguments.length,O=Array(1<z?z-1:0),P=1;P<z;P++)O[P-1]=arguments[P];q=q.apply(void 0,O)}!0===q&&(q=void 0);if(!q){if(void 0===
q||!1===q)return q;throw Error("`".concat(L,"` was specified but was not a node, or did not return a node"));}z=q;if("string"===typeof q&&(z=m.querySelector(q),!z))throw Error("`".concat(L,"` as selector refers to no known node"));return z},ua=function(){var L=ra("initialFocus");if(!1===L)return!1;void 0===L&&(L=0<=qa(m.activeElement)?m.activeElement:(L=x[0])&&L.firstTabbableNode||ra("fallbackFocus"));if(!L)throw Error("Your focus-trap needs to have at least one focusable element");return L},sa=function(){C=
y.map(function(L){var q=u(L,k.tabbableOptions),z=a(L,k.tabbableOptions);return{container:L,tabbableNodes:q,focusableNodes:z,firstTabbableNode:0<q.length?q[0]:null,lastTabbableNode:0<q.length?q[q.length-1]:null,nextTabbableNode:function(O){var P=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,Y=z.findIndex(function(S){return S===O});if(!(0>Y))return P?z.slice(Y+1).find(function(S){return b(S,k.tabbableOptions)}):z.slice(0,Y).reverse().find(function(S){return b(S,k.tabbableOptions)})}}});
x=C.filter(function(L){return 0<L.tabbableNodes.length});if(0>=x.length&&!ra("fallbackFocus"))throw Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");},ta=function z(q){!1!==q&&q!==m.activeElement&&(q&&q.focus?(q.focus({preventScroll:!!k.preventScroll}),J=q,q.tagName&&"input"===q.tagName.toLowerCase()&&"function"===typeof q.select&&q.select()):z(ua()))},xa=function(q){var z=ra("setReturnFocus",q);return z?z:!1===z?!1:q},va=function(q){var z=
A(q);0<=qa(z)||(r(k.clickOutsideDeactivates,q)?ia.deactivate({returnFocus:k.returnFocusOnDeactivate&&!d(z,k.tabbableOptions)}):r(k.allowOutsideClick,q)||q.preventDefault())},ya=function(q){var z=A(q),O=0<=qa(z);O||z instanceof Document?O&&(J=z):(q.stopImmediatePropagation(),ta(J||ua()))},Da=function(q){var z=A(q);sa();var O=null;if(0<x.length){var P=qa(z),Y=0<=P?C[P]:void 0;if(0>P)O=q.shiftKey?x[x.length-1].lastTabbableNode:x[0].firstTabbableNode;else if(q.shiftKey){var S=n(x,function(wa){return z===
wa.firstTabbableNode});0>S&&(Y.container===z||d(z,k.tabbableOptions)&&!b(z,k.tabbableOptions)&&!Y.nextTabbableNode(z,!1))&&(S=P);0<=S&&(O=x[0===S?x.length-1:S-1].lastTabbableNode)}else S=n(x,function(wa){return z===wa.lastTabbableNode}),0>S&&(Y.container===z||d(z,k.tabbableOptions)&&!b(z,k.tabbableOptions)&&!Y.nextTabbableNode(z))&&(S=P),0<=S&&(O=x[S===x.length-1?0:S+1].firstTabbableNode)}else O=ra("fallbackFocus");O&&(q.preventDefault(),ta(O))},za=function(q){"Escape"!==q.key&&"Esc"!==q.key&&27!==
q.keyCode||!1===r(k.escapeDeactivates,q)?"Tab"!==q.key&&9!==q.keyCode||Da(q):(q.preventDefault(),ia.deactivate())},Aa=function(q){var z=A(q);0<=qa(z)||r(k.clickOutsideDeactivates,q)||r(k.allowOutsideClick,q)||(q.preventDefault(),q.stopImmediatePropagation())},Ba=function(){if(R)return f.activateTrap(ia),na=k.delayInitialFocus?setTimeout(function(){ta(ua())},0):ta(ua()),m.addEventListener("focusin",ya,!0),m.addEventListener("mousedown",va,{capture:!0,passive:!1}),m.addEventListener("touchstart",va,
{capture:!0,passive:!1}),m.addEventListener("click",Aa,{capture:!0,passive:!1}),m.addEventListener("keydown",za,{capture:!0,passive:!1}),ia},Ca=function(){if(R)return m.removeEventListener("focusin",ya,!0),m.removeEventListener("mousedown",va,!0),m.removeEventListener("touchstart",va,!0),m.removeEventListener("click",Aa,!0),m.removeEventListener("keydown",za,!0),ia};var ia={get active(){return R},get paused(){return ca},activate:function(q){if(R)return this;var z=da(q,"onActivate"),O=da(q,"onPostActivate"),
P=da(q,"checkCanFocusTrap");P||sa();R=!0;ca=!1;I=m.activeElement;z&&z();q=function(){P&&sa();Ba();O&&O()};if(P)return P(y.concat()).then(q,q),this;q();return this},deactivate:function(q){if(!R)return this;var z=G({onDeactivate:k.onDeactivate,onPostDeactivate:k.onPostDeactivate,checkCanReturnFocus:k.checkCanReturnFocus},q);clearTimeout(na);na=void 0;Ca();ca=R=!1;f.deactivateTrap(ia);var O=da(z,"onDeactivate"),P=da(z,"onPostDeactivate");q=da(z,"checkCanReturnFocus");var Y=da(z,"returnFocus","returnFocusOnDeactivate");
O&&O();z=function(){setTimeout(function(){Y&&ta(xa(I));P&&P()},0)};if(Y&&q)return q(xa(I)).then(z,z),this;z();return this},pause:function(){if(ca||!R)return this;ca=!0;Ca();return this},unpause:function(){if(!ca||!R)return this;ca=!1;sa();Ba();return this},updateContainerElements:function(q){y=[].concat(q).filter(Boolean).map(function(z){return"string"===typeof z?m.querySelector(z):z});R&&sa();return this}};ia.updateContainerElements(e);return ia};N=function(e){function g(k,y){var C=e.call(this,k,
y)||this;C.container=document.createElement("div");C.content=null;C.open=!1;C._focusTrap=null;C._close=()=>{C.open=!1};document.body.appendChild(C.container);C.addHandles(t.watch(()=>C.open,()=>C._toggleFocusTrap()));return C}E._inheritsLoose(g,e);var m=g.prototype;m.destroy=function(){this._destroyFocusTrap()};m.render=function(){var k=this.id;const {open:y,content:C,title:x,messages:I}=this;var J=y&&!!C;const R={["esri-identity-modal--open"]:J,["esri-identity-modal--closed"]:!J},ca=D.tsx("button",
{class:"esri-identity-modal__close-button","aria-label":I.close,title:I.close,bind:this,onclick:this._close,type:"button"},D.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})),na=`${k}_title`;k=`${k}_content`;const da=x?D.tsx("h1",{id:na,class:"esri-identity-modal__title"},x):null;J=J?D.tsx("div",{bind:this,class:"esri-identity-modal__dialog",role:"dialog","aria-labelledby":na,"aria-describedby":k,afterCreate:this._createFocusTrap},ca,da,this._renderContent(k)):null;return D.tsx("div",{tabIndex:-1,
class:this.classes("esri-identity-modal",R)},J)};m._destroyFocusTrap=function(){this._focusTrap?.deactivate({onDeactivate:()=>{}});this._focusTrap=null};m._toggleFocusTrap=function(){const {_focusTrap:k,open:y}=this;k&&(y?k.activate():k.deactivate())};m._createFocusTrap=function(k){this._destroyFocusTrap();const y=requestAnimationFrame(()=>{this._focusTrap=l(k,{initialFocus:"input",onDeactivate:this._close});this._toggleFocusTrap()});this.addHandles(v.makeHandle(()=>cancelAnimationFrame(y)))};m._renderContent=
function(k){const y=this.content;return"string"===typeof y?D.tsx("div",{class:"esri-identity-modal__content",id:k,innerHTML:y}):M.isWidget(y)?D.tsx("div",{class:"esri-identity-modal__content",id:k},y.render()):y instanceof HTMLElement?D.tsx("div",{class:"esri-identity-modal__content",id:k,bind:y,afterCreate:this._attachToNode}):null};m._attachToNode=function(k){k.appendChild(this)};E._createClass(g,[{key:"title",get:function(){return this.messages?.auth.signIn}}]);return g}(N);B.__decorate([w.property({readOnly:!0})],
N.prototype,"container",void 0);B.__decorate([w.property()],N.prototype,"content",void 0);B.__decorate([w.property()],N.prototype,"open",void 0);B.__decorate([w.property(),V.messageBundle("esri/t9n/common")],N.prototype,"messages",void 0);B.__decorate([w.property()],N.prototype,"title",null);return N=B.__decorate([T.subclass("esri.identity.IdentityModal")],N)})},"esri/identity/OAuthCredential":function(){define(function(){let E=function(){function B(t,w){this.userId=this.token=this.stateUID=this.ssl=
this.refreshToken=this.expires=this.codeVerifier=this.appId=this.storage=this.oAuthInfo=null;this.oAuthInfo=t;this.storage=w;this._init()}var v=B.prototype;v.isValid=function(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else if(this.expires){const w=Date.now();this.expires>w&&(this.expires-w)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}return t};v.save=function(){if(!this.storage)return!1;const t=this._load(),w=this.oAuthInfo;
if(w&&w.authNamespace&&w.portalUrl){let K=t[w.authNamespace];K||(K=t[w.authNamespace]={});this.appId||(this.appId=w.appId);K[w.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(F){return console.warn(F),!1}return!0}return!1};v.destroy=function(){const t=this._load(),w=this.oAuthInfo;if(w&&w.appId&&
w.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){var K=w.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken";const F=new FormData;F.append("f","json");F.append("auth_token",this.refreshToken||this.token);F.append("client_id",w.appId);F.append("token_type_hint",this.refreshToken?"refresh_token":"access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(K,F);else{const T=new XMLHttpRequest;T.open("POST",K);T.send(F)}}if(w&&
w.authNamespace&&w.portalUrl&&this.storage&&(K=t[w.authNamespace])){delete K[w.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(t))}catch(F){console.log(F)}}w&&(this.oAuthInfo=w._oAuthCred=null)};v._init=function(){var t=this._load();const w=this.oAuthInfo;w&&w.authNamespace&&w.portalUrl&&(t=t[w.authNamespace])&&(t=t[w.portalUrl])&&(this.appId=t.appId,this.codeVerifier=t.codeVerifier,this.expires=t.expires,this.refreshToken=t.refreshToken,this.ssl=t.ssl,this.stateUID=t.stateUID,
this.token=t.token,this.userId=t.userId)};v._load=function(){let t={};if(this.storage){const w=this.storage.getItem("esriJSAPIOAuth");if(w)try{t=JSON.parse(w)}catch(K){console.warn(K)}}return t};return B}();E.prototype.declaredClass="esri.identity.OAuthCredential";return E})},"esri/identity/OAuthInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(E,B,v,t,w,K,F){var T;v=T=function(N){function M(D){D=N.call(this,D)||this;D._oAuthCred=null;D.appId=null;D.authNamespace="/";D.expiration=20160;D.flowType="auto";D.forceLogin=!1;D.forceUserId=!1;D.locale=null;D.minTimeUntilExpiration=30;D.popup=!1;D.popupCallbackUrl="oauth-callback.html";D.popupWindowFeatures="height\x3d490,width\x3d800,resizable,scrollbars,status";D.portalUrl="https://www.arcgis.com";D.preserveUrlHash=!1;D.userId=null;return D}E._inheritsLoose(M,N);M.prototype.clone=function(){return T.fromJSON(this.toJSON())};
return M}(v.JSONSupport);B.__decorate([t.property({json:{write:!0}})],v.prototype,"appId",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"authNamespace",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"expiration",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"flowType",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"forceLogin",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"forceUserId",void 0);B.__decorate([t.property({json:{write:!0}})],
v.prototype,"locale",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"minTimeUntilExpiration",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"popup",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"popupCallbackUrl",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"popupWindowFeatures",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"portalUrl",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"preserveUrlHash",
void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"userId",void 0);return v=T=B.__decorate([F.subclass("esri.identity.OAuthInfo")],v)})},"esri/identity/ServerInfo":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(E,B,v,t,w,K,F){v=function(T){function N(M){M=T.call(this,M)||this;
M.adminTokenServiceUrl=null;M.currentVersion=null;M.hasPortal=null;M.hasServer=null;M.owningSystemUrl=null;M.owningTenant=null;M.server=null;M.shortLivedTokenValidity=null;M.tokenServiceUrl=null;M.webTierAuth=null;return M}E._inheritsLoose(N,T);return N}(v.JSONSupport);B.__decorate([t.property({json:{write:!0}})],v.prototype,"adminTokenServiceUrl",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"currentVersion",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"hasPortal",
void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"hasServer",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"owningSystemUrl",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"owningTenant",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"server",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"shortLivedTokenValidity",void 0);B.__decorate([t.property({json:{write:!0}})],v.prototype,"tokenServiceUrl",void 0);B.__decorate([t.property({json:{write:!0}})],
v.prototype,"webTierAuth",void 0);return v=B.__decorate([F.subclass("esri.identity.ServerInfo")],v)})},"*noref":1}});define(["../chunks/_rollupPluginBabelHelpers","../kernel","./IdentityManagerBase"],function(E,B,v){v=function(t){function w(){return t.apply(this,arguments)||this}E._inheritsLoose(w,t);return w}(v.IdentityManagerBase);v.prototype.declaredClass="esri.identity.IdentityManager";v=new v;B.setId(v);return v});