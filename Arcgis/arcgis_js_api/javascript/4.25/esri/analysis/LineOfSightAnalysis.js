// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ./LineOfSightAnalysisObserver ./LineOfSightAnalysisTarget ../core/Collection ../core/collectionUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/projection ../geometry/support/aaBoundingBox ../support/elevationInfoUtils".split(" "),function(n,e,c,v,w,x,r,b,t,f,E,F,y,z,p,A){const q=
x.ofType(w);c=function(u){function k(a){a=u.call(this,a)||this;a.type="line-of-sight";a.observer=null;a.extent=null;return a}n._inheritsLoose(k,u);var l=k.prototype;l.initialize=function(){this.addHandles(t.watch(()=>this._computeExtent(),a=>{(b.isNone(a)||b.isNone(a.pending))&&this._set("extent",b.isSome(a)?a.extent:null)},t.syncAndInitial))};l.waitComputeExtent=function(){var a=n._asyncToGenerator(function*(){const g=this._computeExtent();return b.isSome(g)?b.unwrap(g.pending):null});return function(){return a.apply(this,
arguments)}}();l._computeExtent=function(){var a=this.spatialReference;if(b.isNone(this.observer)||b.isNone(this.observer.position)||b.isNone(a))return null;const g=h=>"absolute-height"===A.getGeometryEffectiveElevationMode(h.position,h.elevationInfo);var d=this.observer.position;d=p.fromValues(d.x,d.y,d.z,d.x,d.y,d.z);for(const h of this.targets)if(b.isSome(h.position)){const m=z.projectOrLoad(h.position,a);if(b.isSome(m.pending))return{pending:m.pending,extent:null};if(b.isSome(m.geometry)){const {x:B,
y:C,z:D}=m.geometry;p.expandWithVec3(d,[B,C,D])}}a=p.toExtent(d,a);g(this.observer)&&this.targets.every(g)||(a.zmin=null,a.zmax=null);return{pending:null,extent:a}};l.clear=function(){this.observer=null;this.targets.removeAll()};n._createClass(k,[{key:"targets",get:function(){return this._get("targets")||new q},set:function(a){this._set("targets",r.referenceSetter(a,this.targets,q))}},{key:"spatialReference",get:function(){return b.isSome(this.observer)&&b.isSome(this.observer.position)?this.observer.position.spatialReference:
null}},{key:"requiredPropertiesForEditing",get:function(){return[b.applySome(this.observer,a=>a.position)]}}]);return k}(c);e.__decorate([f.property({type:["line-of-sight"]})],c.prototype,"type",void 0);e.__decorate([f.property({type:v,json:{read:!0,write:!0}})],c.prototype,"observer",void 0);e.__decorate([f.property({cast:r.castForReferenceSetter,type:q,nonNullable:!0,json:{read:!0,write:!0}})],c.prototype,"targets",null);e.__decorate([f.property({value:null,readOnly:!0})],c.prototype,"extent",void 0);
e.__decorate([f.property({readOnly:!0})],c.prototype,"spatialReference",null);e.__decorate([f.property({readOnly:!0})],c.prototype,"requiredPropertiesForEditing",null);return c=e.__decorate([y.subclass("esri.analysis.LineOfSightAnalysis")],c)});