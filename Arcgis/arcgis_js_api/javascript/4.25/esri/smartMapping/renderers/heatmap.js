// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../renderers/ClassBreaksRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/HeatmapRenderer ../../renderers/PieChartRenderer ../../renderers/Renderer ../../renderers/SimpleRenderer ../../renderers/UniqueValueRenderer ../../renderers/support/jsonUtils ../../core/Error ../../core/maybe ../../renderers/support/AuthoringInfo ../../renderers/support/HeatmapColorStop ../../renderers/support/heatmapUtils ./support/utils ../statistics/heatmapStatistics ../support/utils ../support/adapters/support/layerUtils ../symbology/heatmap".split(" "),
function(r,n,t,Z,aa,ba,L,ca,da,ea,fa,ha,D,u,E,p,M,v,N,O,k,w){function P(a){return x.apply(this,arguments)}function x(){x=n._asyncToGenerator(function*(a){if(!(a&&a.layer&&a.view))throw new D("heatmap-renderer:missing-parameters","'layer' and 'view' parameters are required");const {blurRadius:c,radius:d,minRatio:b,maxRatio:l,fadeToTransparent:m,fadeRatio:g}=a;a={...a};a.radius=null==d?null==c?18:M.gaussianBlurRadiusPxToKernelDensityRadiusPt(c):d;a.minRatio=null==b?.01:b;a.maxRatio=null==l?1:l;a.fadeRatio=
null==g?.2:g;a.fadeToTransparent=null==m?!0:m;var h=[k.LayerType.CSVLayer,k.LayerType.FeatureLayer,k.LayerType.OGCFeatureLayer,k.LayerType.GeoJSONLayer,k.LayerType.WFSLayer],e=k.createLayerAdapter(a.layer,h);a.layer=e;if(!e)throw new D("heatmap-renderer:invalid-parameters","'layer' must be one of these types: "+k.getLayerTypeLabels(h).join(", "));h=u.isSome(a.signal)?{signal:a.signal}:null;yield e.load(h);h=yield O.getFieldsList({field:a.field});if(e=v.verifyBasicFieldValidity(e,h,"heatmap-renderer:invalid-parameters"))throw e;
return a});return x.apply(this,arguments)}function Q(a){return y.apply(this,arguments)}function y(){y=n._asyncToGenerator(function*(a){let c=a.scheme,d=null;var b=null;b=yield v.getBasemapInfo(a.basemap,a.view);d=u.isSome(b.basemapId)?b.basemapId:null;b=u.isSome(b.basemapTheme)?b.basemapTheme:null;if(c)return{scheme:w.cloneScheme(c),basemapId:d,basemapTheme:b};if(a=w.getSchemes({basemap:d,basemapTheme:b}))c=a.primaryScheme,d=a.basemapId,b=a.basemapTheme;return{scheme:c,basemapId:d,basemapTheme:b}});
return y.apply(this,arguments)}function R(a,c){return z.apply(this,arguments)}function z(){z=n._asyncToGenerator(function*(a,c){const {fieldOffset:d}=a,{field:b,basemap:l,radius:m,minRatio:g,maxRatio:h,fadeToTransparent:e,fadeRatio:F,heatmapScheme:S,view:T}=c,{scheme:G,basemapId:U,basemapTheme:V}=yield Q({basemap:l,scheme:S,view:T}),A=G.colors,H=A.length,I=(c=!a.count)?[0,.04]:[a.min,a.max];const W=(h-g)/(H-1),f=A[0],J=e?g:.01,B=[new p({ratio:0,color:new t([f.r,f.g,f.b,0])}),new p({ratio:.01,color:new t([f.r,
f.g,f.b,0])}),new p({ratio:J,color:new t([f.r,f.g,f.b,J])})];v.createColors(A,H).forEach((X,Y)=>{B.push(new p({ratio:g+W*Y,color:X}))});if(e){K(B,F);var q=new E({fadeRatio:F})}q=new L({authoringInfo:q,radius:m,colorStops:B,field:b,minDensity:I[0],maxDensity:I[1]});null!=d&&(q.fieldOffset=d);return{renderer:q,statistics:a,defaultValuesUsed:c,scheme:w.cloneScheme(G),basemapId:U,basemapTheme:V}});return z.apply(this,arguments)}function K(a,c){const d=10*(1-c)+1;a.forEach((b,l)=>{if(!(2>=l)){var {ratio:m,
color:g}=b;g.a=0===c?1:Math.min(Math.max(m*d,0),1)}})}function C(){C=n._asyncToGenerator(function*(a){a=yield P(a);const c=a.statistics?a.statistics:yield N({layer:a.layer,field:a.field,fieldOffset:a.fieldOffset,radius:a.radius,view:a.view,signal:a.signal});return R(c,a)});return C.apply(this,arguments)}r.createRenderer=function(a){return C.apply(this,arguments)};r.updateRenderer=function(a){const {fadeRatio:c,renderer:d}=a;a=d.clone();const b=null==c?a?.authoringInfo?.fadeRatio||0:c;K(a.colorStops,
b);a.authoringInfo?a.authoringInfo.fadeRatio=b:a.authoringInfo=new E({fadeRatio:b});return a};Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});