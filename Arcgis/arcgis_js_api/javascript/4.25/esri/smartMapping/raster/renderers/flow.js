// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/maybe ../../../renderers/support/AuthoringInfo ../../../renderers/support/AuthoringInfoVisualVariable ../../../renderers/support/rasterRendererHelper ../../../renderers/visualVariables/ColorVariable ../../../renderers/visualVariables/OpacityVariable ../../../renderers/visualVariables/SizeVariable ../support/utils ../../renderers/support/utils ../../symbology/flow".split(" "),function(x,m,z,n,A,q,y,B,C,D,E,
g,r){function F(a){return t.apply(this,arguments)}function t(){t=m._asyncToGenerator(function*(a){a={...a};a.theme||(a.theme="flow-line");return E.processRasterRendererParameters(a)});return t.apply(this,arguments)}function G(a){return u.apply(this,arguments)}function u(){u=m._asyncToGenerator(function*(a){let d=a.flowScheme,f=null;var b=null;b=yield g.getBasemapInfo(null,a.view);f=n.isSome(b.basemapId)?b.basemapId:null;b=n.isSome(b.basemapTheme)?b.basemapTheme:null;if(d)return{scheme:r.cloneScheme(d),
basemapId:f,basemapTheme:b};if(a=r.getSchemes({basemap:f,basemapTheme:b,theme:a.theme,hasSizeVariable:a.hasSizeVariable}))d=a.primaryScheme,f=a.basemapId,b=a.basemapTheme;return{scheme:d,basemapId:f,basemapTheme:b}});return u.apply(this,arguments)}function H(a,d){return v.apply(this,arguments)}function v(){v=m._asyncToGenerator(function*(a,d){d.flowRepresentation&&(a.flowRepresentation=d.flowRepresentation);const f=yield G({theme:d.theme,flowScheme:d.flowScheme,view:d.view,hasSizeVariable:d.includeSizeVariable}),
b=f.scheme;if(!b)throw g.createError("flow-renderer:insufficient-info","Unable to find flow scheme");a.flowSpeed=b.flowSpeed;a.density=b.density;a.trailLength=b.trailLength;a.trailWidth=b.trailWidth;a.trailCap=b.trailCap;a.color=b.color;const k=[];var h=[],c=d.layer.rasterInfo;c=!n.isSome(c.statistics)||"vector-magdir"!==c.dataType&&"vector-uv"!==c.dataType?{minMagnitude:0,maxMagnitude:10}:y.estimateMagnitudeRange(c.dataType,c.statistics);if(!c||null==c.minMagnitude||null==c.maxMagnitude)throw g.createError("flow-renderer:insufficient-info",
"stats not available");c={min:c.minMagnitude,max:c.maxMagnitude};var e={min:c.min,max:null!=c.max?c.max/2:null},l=g.getDataRange(e,null,null,null);e=g.createDataValues(l,e,null);if(d.includeColorVariable){const p=g.createColors(b.colors,5);if(5>p.length)throw g.createError("flow-renderer:insufficient-info","Flow scheme does not have enough colors");l=new B({field:"Magnitude",stops:e.map((I,J)=>({value:I,color:p[J]}))});k.push(l);l=new q({type:"color",minSliderValue:c.min,maxSliderValue:c.max,theme:"high-to-low"});
h.push(l)}d.includeOpacityVariable&&(e=new C({field:"Magnitude",stops:[{value:e[0],opacity:b.minOpacity},{value:e[4],opacity:b.maxOpacity}]}),k.push(e),e=new q({type:"opacity",minSliderValue:c.min,maxSliderValue:c.max}),h.push(e));d.includeSizeVariable&&(e=new D({field:"Magnitude",stops:[{value:c.min,size:b.minSize},{value:c.max,size:b.maxSize}]}),k.push(e),e=new q({type:"size",minSliderValue:c.min,maxSliderValue:c.max,theme:"high-to-low"}),h.push(e));h=new A({type:"flow",visualVariables:h.length?
h:null,flowTheme:b.theme});a.visualVariables=k;a.authoringInfo=h;a.legendOptions=d.legendOptions;return{renderer:a,visualVariables:k.map(p=>p.clone()),flowScheme:r.cloneScheme(b),basemapId:f.basemapId,basemapTheme:f.basemapTheme,layerEffect:b.layerEffect,statistics:c}});return v.apply(this,arguments)}function w(){w=m._asyncToGenerator(function*(a){a=yield F(a);const d=y.createFlowRenderer(a.layer.rasterInfo);if(!n.isSome(d))throw new z("flow-renderer:not-supported","Only vector data is supported");
return H(d,a)});return w.apply(this,arguments)}x.createRenderer=function(a){return w.apply(this,arguments)};Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});