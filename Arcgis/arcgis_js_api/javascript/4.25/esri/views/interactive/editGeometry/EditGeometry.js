// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Evented ../../../core/maybe ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper ./unnormalizationHelper".split(" "),function(r,w,B,x,z,C,D,E,A){let t=function(){function n(d){this.component=d;this.rightEdge=this.leftEdge=null;this.type="vertex";this.index=null}w._createClass(n,[{key:"pos",get:function(){return this._pos},set:function(d){this._pos=d;this.component.unnormalizeVertexPositions()}}]);
return n}(),u=function(n,d,e){this.component=n;this.leftVertex=d;this.rightVertex=e;this.type="edge";d.rightEdge=this;e.leftEdge=this},v=function(){function n(e,a){this._spatialReference=e;this._viewingMode=a;this.vertices=[];this.edges=[]}var d=n.prototype;d.unnormalizeVertexPositions=function(){1>=this.vertices.length||A.unnormalize(this.vertices,A.getUnnormalizationInfo(this._spatialReference,this._viewingMode))};d.updateVertexIndex=function(e,a){if(0!==this.vertices.length){var c=this.vertices[0],
b=null;do b=e,b.index=a++,e=b.rightEdge?b.rightEdge.rightVertex:null;while(null!=e&&e!==c);b.leftEdge&&b!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(b),this.vertices.length-1)}};d.getFirstVertex=function(){return 0===this.vertices.length?null:this.vertices[0]};d.getLastVertex=function(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]};d.isClosed=function(){return 2<this.vertices.length&&null!==this.vertices[0].leftEdge};d.swapVertices=
function(e,a){const c=this.vertices[e];this.vertices[e]=this.vertices[a];this.vertices[a]=c};d.iterateVertices=function(e){if(0!==this.vertices.length){var a=this.vertices[0],c=a;do e(c,c.index),c=z.isSome(c.rightEdge)?c.rightEdge.rightVertex:null;while(c!==a&&null!=c)}};return n}();x=function(n){function d(a,c){var b=n.call(this)||this;b.type=a;b.coordinateHelper=c;b._geometry=null;b._dirty=!0;b.components=[];return b}w._inheritsLoose(d,n);var e=d.prototype;e.notifyChanges=function(a){this._dirty=
!0;this.emit("change",a)};e._toPoint=function(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)};e._toPolyline=function(){const a=[],c=this.coordinateHelper.vectorToArray;for(const b of this.components){if(1>b.vertices.length)continue;const m=[];let h=b.vertices.find(f=>null==f.leftEdge);const k=h;do m.push(c(h.pos)),h=h.rightEdge?h.rightEdge.rightVertex:null;while(h&&h!==k);a.push(m)}return new D({paths:a,
spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})};e._toPolygon=function(){const a=[],c=this.coordinateHelper.vectorToArray;for(const b of this.components){if(1>b.vertices.length)continue;const m=[],h=b.vertices[0];let k=h;const f=k;do m.push(c(k.pos)),k=z.isSome(k.rightEdge)?k.rightEdge.rightVertex:null;while(k&&k!==f);b.isClosed()&&m.push(c(h.pos));a.push(m)}return new C({rings:a,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),
hasM:this.coordinateHelper.hasM()})};d.fromGeometry=function(a,c){var b=a.spatialReference;const m=E.createCoordinateHelper(a.hasZ,a.hasM,b),h=new d(a.type,m);switch(a.type){case "polygon":var k=a.rings;for(a=0;a<k.length;++a){var f=k[a],g=new v(b,c),l=2<f.length&&B.equals(f[0],f[f.length-1]),p=l?f.length-1:f.length;for(var q=0;q<p;++q){const F=m.arrayToVector(f[q]),y=new t(g);g.vertices.push(y);y.pos=F;y.index=q}f=g.vertices.length-1;for(p=0;p<f;++p)q=new u(g,g.vertices[p],g.vertices[p+1]),g.edges.push(q);
l&&(l=new u(g,g.vertices[g.vertices.length-1],g.vertices[0]),g.edges.push(l));h.components.push(g)}break;case "polyline":for(k of a.paths){a=new v(b,c);g=k.length;for(l=0;l<g;++l)f=m.arrayToVector(k[l]),p=new t(a),a.vertices.push(p),p.pos=f,p.index=l;g=a.vertices.length-1;for(l=0;l<g;++l)f=new u(a,a.vertices[l],a.vertices[l+1]),a.edges.push(f);h.components.push(a)}break;case "point":c=new v(b,c),b=new t(c),b.index=0,b.pos=m.pointToVector(a),c.vertices.push(b),h.components.push(c)}return h};w._createClass(d,
[{key:"geometry",get:function(){if(this._dirty){switch(this.type){case "point":this._geometry=this._toPoint();break;case "polyline":this._geometry=this._toPolyline();break;case "polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}},{key:"spatialReference",get:function(){return this.coordinateHelper.spatialReference}}]);return d}(x);r.Component=v;r.Edge=u;r.EditGeometry=x;r.Vertex=t;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});