// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),function(x,B,C,n,D,y,r,q,t,E,l,z,u){t=function(A){function v(){return A.apply(this,arguments)||this}B._inheritsLoose(v,A);var w=v.prototype;w.snapNewVertex=function(f,
a){var e=a.editGeometryOperations.data.components[0],b=e.vertices.length;const m=[];if(2>b)return m;var {view:h}=this;const c=u.anyMapPointToScreenPoint(f,a.coordinateHelper,q.absoluteHeightElevationInfo,h);var k=e.vertices[b-1];this.edgeExceedsShortLineThreshold(k.leftEdge,a)&&(b=l.convertPointElevation(k.pos,h,a),k=l.editEdgeToSnappingEdge(k.leftEdge,h,a),this._checkForSnappingCandidate(m,k,b,f,k.left,b,a,f,c));b=e.vertices[0];this.edgeExceedsShortLineThreshold(b.rightEdge,a)&&(e=l.convertPointElevation(b.pos,
h,a),h=l.editEdgeToSnappingEdge(b.rightEdge,h,a),this._checkForSnappingCandidate(m,h,e,f,h.right,e,a,f,c));return m};w.snapExistingVertex=function(f,a){const e=[];var b=C.unwrap(a.vertexHandle),m=b.component;const h=m.vertices.length;if(3>h)return e;var {view:c}=this;const k=u.anyMapPointToScreenPoint(f,a.coordinateHelper,q.absoluteHeightElevationInfo,c);var d=b.leftEdge;b=b.rightEdge;var g=m.vertices[0];m=m.vertices[h-1];if(!d)return b=g.rightEdge.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(b,
a)&&(b=l.editEdgeToSnappingEdge(b,c,a),c=l.convertPointElevation(g.rightEdge.rightVertex.pos,c,a),this._checkForSnappingCandidate(e,b,c,f,b.right,c,a,f,k)),e;if(!b)return b=m.leftEdge.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(b,a)&&(b=l.editEdgeToSnappingEdge(b,c,a),c=l.convertPointElevation(m.leftEdge.leftVertex.pos,c,a),this._checkForSnappingCandidate(e,b,c,f,b.left,c,a,f,k)),e;d&&d.leftVertex.leftEdge&&(g=d.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(g,a)&&(g=l.editEdgeToSnappingEdge(g,
c,a),d=l.convertPointElevation(d.leftVertex.pos,c,a),this._checkForSnappingCandidate(e,g,d,f,g.left,d,a,f,k)));b&&b.rightVertex.rightEdge&&(d=b.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(d,a)&&(d=l.editEdgeToSnappingEdge(d,c,a),c=l.convertPointElevation(b.rightVertex.pos,c,a),this._checkForSnappingCandidate(e,d,c,f,d.right,c,a,f,k)));return e};w._checkForSnappingCandidate=function(f,a,e,b,m,h,c,k,d){const {coordinateHelper:g,pointer:F}=c;n.subtract(p,a.right,a.left);a=y.set(G,p[1],-p[0],
0);e=n.dot(a,n.subtract(p,b,e))/n.squaredLength(a);k=g.fromXYZ(n.scaleAndAdd(p,h,a,e),g.getZ(k,0));l.squaredScreenDistance(d,u.anyMapPointToScreenPoint(k,g,q.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(F)&&(d=g.toXYZ(h,H),d=y.scaleAndAdd(I,d,a,Math.sign(e)),d=g.fromXYZ(d),f.push(new z.RightAngleSnappingCandidate({coordinateHelper:g,targetPoint:k,constraint:new E.VerticalHalfPlaneConstraint(g,h,d),previousVertex:m,otherVertex:h,otherVertexType:z.OtherVertexType.CENTER,elevationInfo:g.hasZ()?
q.absoluteHeightElevationInfo:null})))};return v}(t.SnappingAlgorithm);const p=D.create(),H=r.create(),I=r.create(),G=r.create();x.RightAngleSnapper=t;Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});