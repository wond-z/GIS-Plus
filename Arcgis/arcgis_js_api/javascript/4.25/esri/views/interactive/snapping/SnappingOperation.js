// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),function(b,l,g,v,f,w,m,y,z,x,r){b.SnappingOperation=function(t){function n(c){var a=t.call(this,c)||this;a.constrainResult=d=>d;a._snapPoints=null;
a._abortController=null;a._stagedPoint=null;a._snap=w.debounce(function(){var d=l._asyncToGenerator(function*(e,h,k,p){const u=yield a._frameTask.schedule(()=>h.snap({...e,context:k,signal:p}),p);u.valid&&(yield a._frameTask.schedule(()=>{a.stagedPoint=u.apply();e!==a._snapPoints&&f.isSome(a._snapPoints)&&(a.stagedPoint=h.update({...a._snapPoints,context:k}))},p))});return function(e,h,k,p){return d.apply(this,arguments)}}());return a}l._inheritsLoose(n,t);var q=n.prototype;q.initialize=function(){const c=
"3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=f.isSome(c)?c.registerTask(r.TaskPriority.SNAPPING):r.ImmediateTask};q.destroy=function(){this._abortController=f.abortMaybe(this._abortController);this._frameTask=f.removeMaybe(this._frameTask)};q.snap=function(){var c=l._asyncToGenerator(function*(a,d,e){const {point:h,scenePoint:k}=a;this.stagedPoint=d.update({point:h,scenePoint:k,context:e});this._snapPoints=a;f.isNone(this._abortController)&&(this._abortController=
new AbortController);return this._snap(a,d,e,this._abortController.signal)});return function(a,d,e){return c.apply(this,arguments)}}();q.abort=function(){this._abortController=f.abortMaybe(this._abortController)};l._createClass(n,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(c){this._stagedPoint=this.constrainResult(c)}}]);return n}(v);g.__decorate([m.property({constructOnly:!0})],b.SnappingOperation.prototype,"view",void 0);g.__decorate([m.property()],b.SnappingOperation.prototype,
"stagedPoint",null);g.__decorate([m.property()],b.SnappingOperation.prototype,"constrainResult",void 0);g.__decorate([m.property()],b.SnappingOperation.prototype,"_stagedPoint",void 0);b.SnappingOperation=g.__decorate([x.subclass("esri.views.interactive.snapping.SnappingOperation")],b.SnappingOperation);Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});