// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../../core/Logger","./storageLayouts"],function(x,t,y){const k=(()=>{var f=new ArrayBuffer(2);const g=new Uint8Array(f);f=new Uint16Array(f);g[0]=170;g[1]=187;return 48042===f[0]})(),z=t.getLogger("esri.views.webgl.UniformBufferLayout");t=function(){function f(b){this._layout=new Map;this.byteLength=this._buildLayout(b);this.array=new ArrayBuffer(this.byteLength);this.arrayView32=new Float32Array(this.array);this._dataView=new DataView(this.array)}var g=f.prototype;g.setValues=
function(b,a){for(const c in b)this.setValue(c,b[c],a)};g.setValue=function(b,a,c){if(this._layout.has(b)){var h=this.byteLength/4,e=0,{type:u,offset:l,arrayLength:v}=this._layout.get(b),{numberType:p,elementLength:m,elementCount:w,arrayStride:n}=y.STD140_LAYOUT[u],d="number"!==typeof a;b=v*w;(d?"byteLength"in a?a.byteLength/4:a.length:1)!==b*m&&z.warn("Attempting to set layout array member value with the wrong length!");if(d)for(d=0;d<b;d++)for(let q=0;q<m;q++){var r=l+d*n+4*q;this._setData(r,a[d*
m+q],p)&&(r/=4,h=Math.min(h,r),e=Math.max(e,r+1))}else this._setData(l,a,p)&&(a=l/4,h=Math.min(h,a),e=Math.max(e,a+1));c&&(c.from=Math.min(h,c.from),c.to=Math.max(e,c.to))}else z.warn("Trying to set an unrecognized layout array member!")};g._setData=function(b,a,c){switch(c){case "Int32":if(a!==this._dataView.getInt32(b,k))return this._dataView.setInt32(b,a,k),!0;break;case "Uint32":if(a!==this._dataView.getUint32(b,k))return this._dataView.setUint32(b,a,k),!0;break;case "Float32":if(a!==this._dataView.getFloat32(b,
k))return this._dataView.setFloat32(b,a,k),!0}return!1};g._buildLayout=function(b){let a=0;for(const {name:h,type:e,count:u}of b){const {elementLength:l,elementCount:v,elementAlignment:p,arrayStride:m,arrayAlignment:w}=y.STD140_LAYOUT[e];b=u??1;var c=b*v;const n=1<c,d=n?w:p;c=n?c*m:4*l;a+=(d-a%d)%d;this._layout.set(h,{type:e,offset:a,arrayLength:b});a+=c;n&&(a+=(d-a%d)%d)}return a+(16-a%16)%16};return f}();x.UniformBufferLayout=t;Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});