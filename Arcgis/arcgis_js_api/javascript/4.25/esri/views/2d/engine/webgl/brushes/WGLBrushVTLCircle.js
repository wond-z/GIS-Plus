// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(p,y,q,z,A,B,l,h){l=function(r){function m(){var a=r.apply(this,arguments)||this;a._programOptions={id:!1};return a}y._inheritsLoose(m,r);var t=m.prototype;t.dispose=function(){};t.drawMany=function(a,d){const {context:e,displayLevel:n,requiredLevel:C,state:u,drawPhase:D,painter:E,spriteMosaic:F,
styleLayerUID:k,requestRender:v,allowDelayedRender:G}=a;if(d.some(b=>b.layerData.get(k)?.circleIndexCount??!1)){a=a.styleLayer;var w=a.circleMaterial,c=E.vectorTilesMaterialManager,g=a.getPaintValue("circle-translate",n),H=a.getPaintValue("circle-translate-anchor",n),f=D===A.WGLDrawPhase.HITTEST,x=this._programOptions;x.id=f;c=c.getMaterialProgram(e,w,x);if(G&&q.isSome(v)&&!c.isCompiled)v();else{e.useProgram(c);c.setUniformMatrix3fv("u_displayMat3",H===z.TranslateAnchor.VIEWPORT?u.displayMat3:u.displayViewMat3);
c.setUniform2fv("u_circleTranslation",g);c.setUniform1f("u_depth",a.z);c.setUniform1f("u_antialiasingWidth",1.2);g=-1;f&&(f=B.u32to4Xu8(k+1),c.setUniform4fv("u_id",f));for(const b of d)b.layerData.has(k)&&(b.key.level!==g&&(g=b.key.level,w.setDataUniforms(c,n,a,g,F)),d=b.layerData.get(k),d.circleIndexCount&&(d.prepareForRendering(e),f=d.circleVertexArrayObject,q.isNone(f)||(e.bindVAO(f),c.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),C!==b.key.level?e.setStencilFunction(h.CompareFunction.EQUAL,
b.stencilRef,255):e.setStencilFunction(h.CompareFunction.GREATER,255,255),e.drawElements(h.PrimitiveType.TRIANGLES,d.circleIndexCount,h.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*d.circleIndexStart),b.triangleCount+=d.circleIndexCount/3)))}}};return m}(l);p.WGLBrushVTLCircle=l;Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});