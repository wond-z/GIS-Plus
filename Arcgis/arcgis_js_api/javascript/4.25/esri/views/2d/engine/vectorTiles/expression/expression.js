// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../Color ../../../../../core/colorUtils ../../../unitBezier ../GeometryUtils ./types ../../webgl/Geometry".split(" "),function(k,v,r,z,va,t,g,D){function l(c,a,b){var d=typeof c;if("string"===d||"boolean"===d||"number"===d||null===c){if(b)switch(b.kind){case "string":"string"!==d&&(c=x.toString(c));break;case "number":"number"!==d&&(c=x.toNumber(c));break;case "color":c=x.toColor(c)}c=["literal",c]}if(!Array.isArray(c)||0===
c.length)throw Error("Expression must be a non empty array");d=c[0];if("string"!==typeof d)throw Error("First element of expression must be a string");const e=E[d];if(void 0===e)throw Error(`Invalid expression operator "${d}"`);if(!e)throw Error(`Unimplemented expression operator "${d}"`);return e.parse(c,a,b)}let wa=function(){function c(b){this._parent=b;this._vars={}}var a=c.prototype;a.add=function(b,d){this._vars[b]=d};a.get=function(b){return this._vars[b]?this._vars[b]:this._parent?this._parent.get(b):
null};return c}(),F=function(){function c(){this.type=g.ValueType}c.parse=function(a){if(1<a.length)throw Error('"id" does not expect arguments');return new c};c.prototype.evaluate=function(a,b){return a?.id};return c}(),G=function(){function c(){this.type=g.StringType}c.parse=function(a){if(1<a.length)throw Error('"geometry-type" does not expect arguments');return new c};c.prototype.evaluate=function(a,b){if(!a)return null;switch(a.type){case D.GeometryType.Point:return"Point";case D.GeometryType.LineString:return"LineString";
case D.GeometryType.Polygon:return"Polygon";default:return null}};return c}(),H=function(){function c(){this.type=g.ObjectType}c.parse=function(a){if(1<a.length)throw Error('"properties" does not expect arguments');return new c};c.prototype.evaluate=function(a,b){return a?.values};return c}(),I=function(){function c(){this.type=g.NumberType}c.parse=function(a){if(1<a.length)throw Error('"zoom" does not expect arguments');return new c};c.prototype.evaluate=function(a,b){return b};return c}(),w=function(){function c(a,
b,d){this._lhs=a;this._rhs=b;this._compare=d;this.type=g.BooleanType}c.parse=function(a,b,d){if(3!==a.length&&4!==a.length)throw Error(`"${a[0]}" expects 2 or 3 arguments`);if(4===a.length)throw Error(`"${a[0]}" collator not supported`);return new c(l(a[1],b),l(a[2],b),d)};c.prototype.evaluate=function(a,b){return this._compare(this._lhs.evaluate(a,b),this._rhs.evaluate(a,b))};return c}(),J=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,
d,(e,f)=>e===f)};return a}(w),K=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,d,(e,f)=>e!==f)};return a}(w),L=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,d,(e,f)=>e<f)};return a}(w),M=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,d,(e,f)=>e<=f)};return a}(w),N=function(c){function a(){return c.apply(this,
arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,d,(e,f)=>e>f)};return a}(w),O=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return w.parse(b,d,(e,f)=>e>=f)};return a}(w),P=function(){function c(a){this._arg=a;this.type=g.BooleanType}c.parse=function(a,b){if(2!==a.length)throw Error('"!" expects 1 argument');return new c(l(a[1],b))};c.prototype.evaluate=function(a,b){return!this._arg.evaluate(a,b)};return c}(),
Q=function(){function c(a){this._args=a;this.type=g.BooleanType}c.parse=function(a,b){const d=[];for(let e=1;e<a.length;e++)d.push(l(a[e],b));return new c(d)};c.prototype.evaluate=function(a,b){for(const d of this._args)if(!d.evaluate(a,b))return!1;return!0};return c}(),R=function(){function c(a){this._args=a;this.type=g.BooleanType}c.parse=function(a,b){const d=[];for(let e=1;e<a.length;e++)d.push(l(a[e],b));return new c(d)};c.prototype.evaluate=function(a,b){for(const d of this._args)if(d.evaluate(a,
b))return!0;return!1};return c}(),S=function(){function c(a){this._args=a;this.type=g.BooleanType}c.parse=function(a,b){const d=[];for(let e=1;e<a.length;e++)d.push(l(a[e],b));return new c(d)};c.prototype.evaluate=function(a,b){for(const d of this._args)if(d.evaluate(a,b))return!1;return!0};return c}(),T=function(){function c(a,b,d){this.type=a;this._args=b;this._fallback=d}c.parse=function(a,b,d){if(4>a.length)throw Error('"case" expects at least 3 arguments');if(1===a.length%2)throw Error('"case" expects an odd number of arguments');
let e;const f=[];for(let h=1;h<a.length-1;h+=2){const n=l(a[h],b),m=l(a[h+1],b,d);e||(e=m.type);f.push({condition:n,output:m})}a=l(a[a.length-1],b,d);e||(e=a.type);return new c(e,f,a)};c.prototype.evaluate=function(a,b){for(const d of this._args)if(d.condition.evaluate(a,b))return d.output.evaluate(a,b);return this._fallback.evaluate(a,b)};return c}(),U=function(){function c(a,b){this.type=a;this._args=b}c.parse=function(a,b){if(2>a.length)throw Error('"coalesce" expects at least 1 argument');let d;
const e=[];for(let f=1;f<a.length;f++){const h=l(a[f],b);d||(d=h.type);e.push(h)}return new c(d,e)};c.prototype.evaluate=function(a,b){for(const d of this._args){const e=d.evaluate(a,b);if(null!==e)return e}return null};return c}(),V=function(){function c(a,b,d,e,f){this.type=a;this._input=b;this._labels=d;this._outputs=e;this._fallback=f}c.parse=function(a,b){if(3>a.length)throw Error('"match" expects at least 3 arguments');if(0===a.length%2)throw Error('"case" expects an even number of arguments');
let d;const e=l(a[1],b),f=[],h={};let n;for(let q=2;q<a.length-1;q+=2){var m=a[q];Array.isArray(m)||(m=[m]);for(const y of m){m=typeof y;if("string"!==m&&"number"!==m)throw Error('"match" requires string or number literal as labels');if(!n)n=m;else if(m!==n)throw Error('"match" requires labels to have the same type');h[y]=f.length}m=l(a[q+1],b);d||(d=m.type);f.push(m)}return new c(d,e,h,f,l(a[a.length-1],b))};c.prototype.evaluate=function(a,b){const d=this._input.evaluate(a,b);return(this._outputs[this._labels[d]]||
this._fallback).evaluate(a,b)};return c}(),B=function(){function c(b,d,e,f,h){this._operator=b;this.type=d;this.interpolation=e;this.input=f;this._stops=h}c.parse=function(b,d,e){const f=b[0];if(5>b.length)throw Error(`"${f}" expects at least 4 arguments`);const h=b[1];if(!Array.isArray(h)||0===h.length)throw Error(`"${h}" is not a valid interpolation`);switch(h[0]){case "linear":if(1!==h.length)throw Error("Linear interpolation cannot have parameters");break;case "exponential":if(2!==h.length||"number"!==
typeof h[1])throw Error("Exponential interpolation requires one numeric argument");break;case "cubic-bezier":if(5!==h.length)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var n=1;5>n;n++){var m=h[n];if("number"!==typeof m||0>m||1<m)throw Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");}break;default:throw Error(`"${b[0]}" unknown interpolation type "${h[0]}"`);}if(1!==b.length%2)throw Error(`"${f}" expects an even number of arguments`);
n=l(b[2],d,g.NumberType);let q;"interpolate-hcl"===f||"interpolate-lab"===f?q=g.ColorType:e&&"value"!==e.kind&&(q=e);e=[];for(m=3;m<b.length;m+=2){const y=b[m];if("number"!==typeof y)throw Error(`"${f}" requires stop inputs as literal numbers`);if(e.length&&e[e.length-1][0]>=y)throw Error(`"${f}" requires strictly ascending stop inputs`);const W=l(b[m+1],d,q);q||(q=W.type);e.push([y,W])}if(q&&q!==g.ColorType&&q!==g.NumberType&&("array"!==q.kind||q.itemType!==g.NumberType))throw Error(`"${f}" cannot interpolate type ${g.typeToString(q)}`);
return new c(f,q,h,n,e)};var a=c.prototype;a.evaluate=function(b,d){var e=this._stops;if(1===e.length)return e[0][1].evaluate(b,d);var f=this.input.evaluate(b,d);if(f<=e[0][0])return e[0][1].evaluate(b,d);if(f>=e[e.length-1][0])return e[e.length-1][1].evaluate(b,d);let h=0;for(;++h<e.length&&!(f<e[h][0]););const n=c.interpolationRatio(this.interpolation,f,e[h-1][0],e[h][0]);f=e[h-1][1].evaluate(b,d);const m=e[h][1].evaluate(b,d);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(f)&&
Array.isArray(m))return f.map((q,y)=>t.interpolate(q,m[y],n));if("color"===this.type.kind&&f instanceof r&&m instanceof r)return f=new r(f),b=new r(m),new r([t.interpolate(f.r,b.r,n),t.interpolate(f.g,b.g,n),t.interpolate(f.b,b.b,n),t.interpolate(f.a,b.a,n)]);if("number"===this.type.kind&&"number"===typeof f&&"number"===typeof m)return t.interpolate(f,m,n);throw Error(`"${this._operator}" cannot interpolate type ${g.typeToString(this.type)}`);}if("interpolate-hcl"===this._operator)return b=z.toLCH(f),
d=z.toLCH(m),e=d.h-b.h,b=z.toRGB({h:b.h+n*(180<e||-180>e?e-360*Math.round(e/360):e),c:t.interpolate(b.c,d.c,n),l:t.interpolate(b.l,d.l,n)}),new r({a:t.interpolate(f.a,m.a,n),...b});if("interpolate-lab"===this._operator)return b=z.toLAB(f),d=z.toLAB(m),b=z.toRGB({l:t.interpolate(b.l,d.l,n),a:t.interpolate(b.a,d.a,n),b:t.interpolate(b.b,d.b,n)}),new r({a:t.interpolate(f.a,m.a,n),...b});throw Error(`Unexpected operator "${this._operator}"`);};a.interpolationUniformValue=function(b,d){const e=this._stops;
if(1===e.length||b>=e[e.length-1][0])return 0;let f=0;for(;++f<e.length&&!(b<e[f][0]););return c.interpolationRatio(this.interpolation,d,e[f-1][0],e[f][0])};a.getInterpolationRange=function(b){const d=this._stops;if(1===d.length)return b=d[0][0],[b,b];var e=d[d.length-1][0];if(b>=e)return[e,e];for(e=0;++e<d.length&&!(b<d[e][0]););return[d[e-1][0],d[e][0]]};c.interpolationRatio=function(b,d,e,f){let h=0;"linear"===b[0]?h=c._exponentialInterpolationRatio(d,1,e,f):"exponential"===b[0]?h=c._exponentialInterpolationRatio(d,
b[1],e,f):"cubic-bezier"===b[0]&&(h=va.unitBezier(b[1],b[2],b[3],b[4])(c._exponentialInterpolationRatio(d,1,e,f),1E-5));0>h?h=0:1<h&&(h=1);return h};c._exponentialInterpolationRatio=function(b,d,e,f){f-=e;if(0===f)return 0;b-=e;return 1===d?b/f:(d**b-1)/(d**f-1)};return c}(),X=function(){function c(a,b,d){this.type=a;this._input=b;this._stops=d}c.parse=function(a,b){if(5>a.length)throw Error('"step" expects at least 4 arguments');if(1!==a.length%2)throw Error('"step" expects an even number of arguments');
const d=l(a[1],b,g.NumberType);let e;const f=[];f.push([-Infinity,l(a[2],b)]);for(let h=3;h<a.length;h+=2){const n=a[h];if("number"!==typeof n)throw Error('"step" requires stop inputs as literal numbers');if(f.length&&f[f.length-1][0]>=n)throw Error('"step" requires strictly ascending stop inputs');const m=l(a[h+1],b);e||(e=m.type);f.push([n,m])}return new c(e,d,f)};c.prototype.evaluate=function(a,b){const d=this._stops;if(1===d.length)return d[0][1].evaluate(a,b);const e=this._input.evaluate(a,b);
let f=0;for(;++f<d.length&&!(e<d[f][0]););return this._stops[f-1][1].evaluate(a,b)};return c}(),Y=function(){function c(a,b){this.type=a;this._output=b}c.parse=function(a,b,d){if(4>a.length)throw Error('"let" expects at least 3 arguments');if(1===a.length%2)throw Error('"let" expects an odd number of arguments');const e=new wa(b);for(let f=1;f<a.length-1;f+=2){const h=a[f];if("string"!==typeof h)throw Error(`"let" requires a string to define variable names - found ${h}`);e.add(h,l(a[f+1],b))}a=l(a[a.length-
1],e,d);return new c(a.type,a)};c.prototype.evaluate=function(a,b){return this._output.evaluate(a,b)};return c}(),Z=function(){function c(a,b){this.type=a;this.output=b}c.parse=function(a,b,d){if(2!==a.length||"string"!==typeof a[1])throw Error('"var" requires just one literal string argument');b=b.get(a[1]);if(!b)throw Error(`${a[1]} must be defined before being used in a "var" expression`);return new c(d||g.ValueType,b)};c.prototype.evaluate=function(a,b){return this.output.evaluate(a,b)};return c}(),
aa=function(){function c(a,b,d){this.type=a;this._index=b;this._array=d}c.parse=function(a,b){if(3!==a.length)throw Error('"at" expects 2 arguments');const d=l(a[1],b,g.NumberType);a=l(a[2],b);return new c(a.type.itemType,d,a)};c.prototype.evaluate=function(a,b){const d=this._index.evaluate(a,b);a=this._array.evaluate(a,b);if(0>d||d>=a.length)throw Error('"at" index out of bounds');if(d!==Math.floor(d))throw Error('"at" index must be an integer');return a[d]};return c}(),ba=function(){function c(a,
b){this._key=a;this._obj=b;this.type=g.ValueType}c.parse=function(a,b){let d;switch(a.length){case 2:return d=l(a[1],b),new c(d);case 3:return d=l(a[1],b),a=l(a[2],b),new c(d,a);default:throw Error('"get" expects 1 or 2 arguments');}};c.prototype.evaluate=function(a,b){const d=this._key.evaluate(a,b);return this._obj?this._obj.evaluate(a,b)[d]:a?.values[d]};return c}(),ca=function(){function c(a,b){this._key=a;this._obj=b;this.type=g.BooleanType}c.parse=function(a,b){let d;switch(a.length){case 2:return d=
l(a[1],b),new c(d);case 3:return d=l(a[1],b),a=l(a[2],b),new c(d,a);default:throw Error('"has" expects 1 or 2 arguments');}};c.prototype.evaluate=function(a,b){const d=this._key.evaluate(a,b);return this._obj?(a=this._obj.evaluate(a,b),d in a):!!a?.values[d]};return c}(),da=function(){function c(a,b){this._key=a;this._vals=b;this.type=g.BooleanType}c.parse=function(a,b){if(3!==a.length)throw Error('"in" expects 2 arguments');return new c(l(a[1],b),l(a[2],b))};c.prototype.evaluate=function(a,b){const d=
this._key.evaluate(a,b);return this._vals.evaluate(a,b).includes(d)};return c}(),ea=function(){function c(a,b,d){this._item=a;this._array=b;this._from=d;this.type=g.NumberType}c.parse=function(a,b){if(3>a.length||4<a.length)throw Error('"index-of" expects 3 or 4 arguments');const d=l(a[1],b),e=l(a[2],b);return 4===a.length?(a=l(a[3],b,g.NumberType),new c(d,e,a)):new c(d,e)};c.prototype.evaluate=function(a,b){const d=this._item.evaluate(a,b),e=this._array.evaluate(a,b);if(this._from){a=this._from.evaluate(a,
b);if(a!==Math.floor(a))throw Error('"index-of" index must be an integer');return e.indexOf(d,a)}return e.indexOf(d)};return c}(),fa=function(){function c(a){this._arg=a;this.type=g.NumberType}c.parse=function(a,b){if(2!==a.length)throw Error('"length" expects 2 arguments');a=l(a[1],b);return new c(a)};c.prototype.evaluate=function(a,b){a=this._arg.evaluate(a,b);if("string"===typeof a||Array.isArray(a))return a.length;throw Error('"length" expects string or array');};return c}(),ha=function(){function c(a,
b,d,e){this.type=a;this._array=b;this._from=d;this._to=e}c.parse=function(a,b){if(3>a.length||4<a.length)throw Error('"slice" expects 2 or 3 arguments');const d=l(a[1],b),e=l(a[2],b,g.NumberType);if(e.type!==g.NumberType)throw Error('"slice" index must return a number');if(4===a.length){a=l(a[3],b,g.NumberType);if(a.type!==g.NumberType)throw Error('"slice" index must return a number');return new c(d.type,d,e,a)}return new c(d.type,d,e)};c.prototype.evaluate=function(a,b){const d=this._array.evaluate(a,
b);if(!Array.isArray(d)&&"string"!==typeof d)throw Error('"slice" input must be an array or a string');const e=this._from.evaluate(a,b);if(0>e||e>=d.length)throw Error('"slice" index out of bounds');if(e!==Math.floor(e))throw Error('"slice" index must be an integer');if(this._to){a=this._to.evaluate(a,b);if(0>a||a>=d.length)throw Error('"slice" index out of bounds');if(a!==Math.floor(a))throw Error('"slice" index must be an integer');return d.slice(e,a)}return d.slice(e)};return c}(),ia=function(){function c(){this.type=
g.BooleanType}c.parse=function(a){if(1!==a.length)throw Error('"has-id" expects no arguments');return new c};c.prototype.evaluate=function(a,b){return a&&void 0!==a.id};return c}(),u=function(){function c(a,b){this._args=a;this._calculate=b;this.type=g.NumberType}c.parse=function(a,b,d){a=a.slice(1).map(e=>l(e,b));return new c(a,d)};c.prototype.evaluate=function(a,b){let d;this._args&&(d=this._args.map(e=>e.evaluate(a,b)));return this._calculate(d)};return c}(),ja=function(c){function a(){return c.apply(this,
arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){switch(b.length){case 2:return u.parse(b,d,e=>-e[0]);case 3:return u.parse(b,d,e=>e[0]-e[1]);default:throw Error('"-" expects 1 or 2 arguments');}};return a}(u),ka=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return u.parse(b,d,e=>{let f=1;for(const h of e)f*=h;return f})};return a}(u),la=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=
function(b,d){if(3===b.length)return u.parse(b,d,e=>e[0]/e[1]);throw Error('"/" expects 2 arguments');};return a}(u),ma=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){if(3===b.length)return u.parse(b,d,e=>e[0]%e[1]);throw Error('"%" expects 2 arguments');};return a}(u),na=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){if(3===b.length)return u.parse(b,d,e=>e[0]**e[1]);throw Error('"^" expects 1 or 2 arguments');
};return a}(u),oa=function(c){function a(){return c.apply(this,arguments)||this}v._inheritsLoose(a,c);a.parse=function(b,d){return u.parse(b,d,e=>{let f=0;for(const h of e)f+=h;return f})};return a}(u),p=function(){function c(a,b){this._args=a;this._calculate=b;this.type=g.NumberType}c.parse=function(a,b){const d=a.slice(1).map(e=>l(e,b));return new c(d,c.ops[a[0]])};c.prototype.evaluate=function(a,b){let d;this._args&&(d=this._args.map(e=>e.evaluate(a,b)));return this._calculate(d)};return c}();
p.ops={abs:c=>Math.abs(c[0]),acos:c=>Math.acos(c[0]),asin:c=>Math.asin(c[0]),atan:c=>Math.atan(c[0]),ceil:c=>Math.ceil(c[0]),cos:c=>Math.cos(c[0]),e:()=>Math.E,floor:c=>Math.floor(c[0]),ln:c=>Math.log(c[0]),ln2:()=>Math.LN2,log10:c=>Math.log(c[0])/Math.LN10,log2:c=>Math.log(c[0])/Math.LN2,max:c=>Math.max(...c),min:c=>Math.min(...c),pi:()=>Math.PI,round:c=>Math.round(c[0]),sin:c=>Math.sin(c[0]),sqrt:c=>Math.sqrt(c[0]),tan:c=>Math.tan(c[0])};let pa=function(){function c(a){this._args=a;this.type=g.StringType}
c.parse=function(a,b){return new c(a.slice(1).map(d=>l(d,b)))};c.prototype.evaluate=function(a,b){return this._args.map(d=>d.evaluate(a,b)).join("")};return c}(),C=function(){function c(a,b){this._arg=a;this._calculate=b;this.type=g.StringType}c.parse=function(a,b){if(2!==a.length)throw Error(`${a[0]} expects 1 argument`);b=l(a[1],b);return new c(b,c.ops[a[0]])};c.prototype.evaluate=function(a,b){return this._calculate(this._arg.evaluate(a,b))};return c}();C.ops={downcase:c=>c.toLowerCase(),upcase:c=>
c.toUpperCase()};let qa=function(){function c(b){this._args=b;this.type=g.ColorType}c.parse=function(b,d){if(4!==b.length)throw Error('"rgb" expects 3 arguments');b=b.slice(1).map(e=>l(e,d));return new c(b)};var a=c.prototype;a.evaluate=function(b,d){const e=this._validate(this._args[0].evaluate(b,d)),f=this._validate(this._args[1].evaluate(b,d));b=this._validate(this._args[2].evaluate(b,d));return new r({r:e,g:f,b})};a._validate=function(b){if("number"!==typeof b||0>b||255<b)throw Error(`${b}: invalid color component`);
return Math.round(b)};return c}(),ra=function(){function c(b){this._args=b;this.type=g.ColorType}c.parse=function(b,d){if(5!==b.length)throw Error('"rgba" expects 4 arguments');b=b.slice(1).map(e=>l(e,d));return new c(b)};var a=c.prototype;a.evaluate=function(b,d){const e=this._validate(this._args[0].evaluate(b,d)),f=this._validate(this._args[1].evaluate(b,d)),h=this._validate(this._args[2].evaluate(b,d));b=this._validateAlpha(this._args[3].evaluate(b,d));return new r({r:e,g:f,b:h,a:b})};a._validate=
function(b){if("number"!==typeof b||0>b||255<b)throw Error(`${b}: invalid color component`);return Math.round(b)};a._validateAlpha=function(b){if("number"!==typeof b||0>b||1<b)throw Error(`${b}: invalid alpha color component`);return b};return c}(),sa=function(){function c(a){this._color=a;this.type=g.arrayType(g.NumberType,4)}c.parse=function(a,b){if(2!==a.length)throw Error('"to-rgba" expects 1 argument');a=l(a[1],b);return new c(a)};c.prototype.evaluate=function(a,b){return(new r(this._color.evaluate(a,
b))).toRgba()};return c}(),A=function(){function c(a,b){this.type=a;this._args=b}c.parse=function(a,b){var d=a[0];if(2>a.length)throw Error(`${d} expects at least one argument`);let e=1,f;if("array"===d){if(2<a.length){switch(a[1]){case "string":f=g.StringType;break;case "number":f=g.NumberType;break;case "boolean":f=g.BooleanType;break;default:throw Error('"array" type argument must be string, number or boolean');}e++}else f=g.ValueType;if(3<a.length){var h=a[2];if(null!==h&&("number"!==typeof h||
0>h||h!==Math.floor(h)))throw Error('"array" length argument must be a positive integer literal');e++}f=g.arrayType(f,h)}else switch(d){case "string":f=g.StringType;break;case "number":f=g.NumberType;break;case "boolean":f=g.BooleanType;break;case "object":f=g.ObjectType}for(d=[];e<a.length;e++)h=l(a[e],b),d.push(h);return new c(f,d)};c.prototype.evaluate=function(a,b){let d;for(const e of this._args){const f=e.evaluate(a,b);d=g.getType(f);if(g.matchType(d,this.type))return f}throw Error(`Expected ${g.typeToString(this.type)} but got ${g.typeToString(d)}`);
};return c}(),x=function(){function c(a,b){this.type=a;this._args=b}c.parse=function(a,b){var d=a[0];const e=c.types[d];if(e===g.BooleanType||e===g.StringType){if(2!==a.length)throw Error(`${d} expects one argument`);}else if(2>a.length)throw Error(`${d} expects at least one argument`);d=[];for(let f=1;f<a.length;f++){const h=l(a[f],b);d.push(h)}return new c(e,d)};c.prototype.evaluate=function(a,b){if(this.type===g.BooleanType)return!!this._args[0].evaluate(a,b);if(this.type===g.StringType)return g.valueToString(this._args[0].evaluate(a,
b));if(this.type===g.NumberType){for(const e of this._args){var d=Number(e.evaluate(a,b));if(!isNaN(d))return d}return null}if(this.type===g.ColorType){for(d of this._args)try{const e=c.toColor(d.evaluate(a,b));if(e instanceof r)return e}catch{}return null}};c.toBoolean=function(a){return!!a};c.toString=function(a){return g.valueToString(a)};c.toNumber=function(a){const b=Number(a);if(isNaN(b))throw Error(`"${a}" is not a number`);return b};c.toColor=function(a){if(a instanceof r)return a;if("string"===
typeof a){const b=r.fromString(a);if(b)return b;throw Error(`"${a}" is not a color`);}if(Array.isArray(a))return r.fromArray(a);throw Error(`"${a}" is not a color`);};return c}();x.types={"to-boolean":g.BooleanType,"to-color":g.ColorType,"to-number":g.NumberType,"to-string":g.StringType};let ta=function(){function c(a){this._val=a;this.type=g.getType(a)}c.parse=function(a){if(2!==a.length)throw Error('"literal" expects 1 argument');return new c(a[1])};c.prototype.evaluate=function(a,b){return this._val};
return c}(),ua=function(){function c(a){this._arg=a;this.type=g.StringType}c.parse=function(a,b){if(2!==a.length)throw Error('"typeof" expects 1 argument');return new c(l(a[1],b))};c.prototype.evaluate=function(a,b){return g.typeToString(g.getType(this._arg.evaluate(a,b)))};return c}();const E={array:A,boolean:A,collator:null,format:null,image:null,literal:ta,number:A,"number-format":null,object:A,string:A,"to-boolean":x,"to-color":x,"to-number":x,"to-string":x,typeof:ua,accumulated:null,"feature-state":null,
"geometry-type":G,id:F,"line-progress":null,properties:H,at:aa,get:ba,has:ca,in:da,"index-of":ea,length:fa,slice:ha,"!":P,"!\x3d":K,"\x3c":L,"\x3c\x3d":M,"\x3d\x3d":J,"\x3e":N,"\x3e\x3d":O,all:Q,any:R,case:T,coalesce:U,match:V,within:null,interpolate:B,"interpolate-hcl":B,"interpolate-lab":B,step:X,let:Y,var:Z,concat:pa,downcase:C,"is-supported-script":null,"resolved-locale":null,upcase:C,rgb:qa,rgba:ra,"to-rgba":sa,"-":ja,"*":ka,"/":la,"%":ma,"^":na,"+":oa,abs:p,acos:p,asin:p,atan:p,ceil:p,cos:p,
e:p,floor:p,ln:p,ln2:p,log10:p,log2:p,max:p,min:p,pi:p,round:p,sin:p,sqrt:p,tan:p,zoom:I,"heatmap-density":null,"has-id":ia,none:S};k.ALL=Q;k.ANY=R;k.Add=oa;k.Assert=A;k.At=aa;k.Calculate=p;k.Case=T;k.Coalesce=U;k.Coerce=x;k.Concat=pa;k.Div=la;k.EQ=J;k.GE=O;k.GT=N;k.GeomType=G;k.Get=ba;k.Has=ca;k.HasID=ia;k.ID=F;k.In=da;k.IndexOf=ea;k.Interpolate=B;k.LE=M;k.LT=L;k.Length=fa;k.Let=Y;k.Literal=ta;k.Match=V;k.Mod=ma;k.Mul=ka;k.NE=K;k.NONE=S;k.NOT=P;k.Pow=na;k.Properties=H;k.Rgb=qa;k.Rgba=ra;k.Slice=
ha;k.Step=X;k.String=C;k.Sub=ja;k.ToRgba=sa;k.TypeOf=ua;k.Var=Z;k.Zoom=I;k.createExpression=l;k.ops=E;Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});