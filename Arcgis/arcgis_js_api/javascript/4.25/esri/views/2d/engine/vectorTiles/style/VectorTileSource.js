// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TilemapIndex ../TilemapRequest ./VectorTilesRequestManager".split(" "),function(l,m,g,n,p,q,r,t,u){return function(){function k(b,a,c){this.fullExtent=this.capabilities=this.tileInfo=this.tilemap=null;this.name=b;this.sourceUrl=a;b=g.urlToObject(this.sourceUrl);
a=m.clone(c);var d=a.tiles;if(b)for(var e=0;e<d.length;e++){var f=g.urlToObject(d[e]);f&&(g.isAbsolute(f.path)||(f.path=g.join(b.path,f.path)),d[e]=g.addQueryParameters(f.path,{...b.query,...f.query}))}this.tileServers=d;e=c.capabilities&&c.capabilities.split(",").map(v=>v.toLowerCase().trim());d=!0===c?.exportTilesAllowed;e=!0===e?.includes("tilemap");f=d&&c.hasOwnProperty("maxExportTilesCount")?c.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:d,supportsTileMap:e},exportTiles:d?
{maxExportTilesCount:+f}:null};this.tileInfo=p.readServiceTileInfo(a.tileInfo,a,null,{ignoreMinMaxLOD:!0});a=c.tileMap?g.addQueryParameters(g.join(b.path,c.tileMap),b.query):null;e?(this.type="vector-tile",this.tilemap=new t(new q.TilemapCache({layer:{parsedUrl:b,tileInfo:this.tileInfo,type:"vector-tile",tileServers:this.tileServers}}),a)):a&&(this.tilemap=new r(a));this.fullExtent=n.fromJSON(c.fullExtent)}var h=k.prototype;h.destroy=function(){};h.getRefKey=function(){var b=l._asyncToGenerator(function*(a,
c){return this.tilemap?.dataKey(a,c)??a});return function(a,c){return b.apply(this,arguments)}}();h.requestTile=function(b,a,c,d){return u.request(this.tileServers[a%this.tileServers.length],b,a,c,d)};h.isCompatibleWith=function(b){var a=this.tileInfo;b=b.tileInfo;if(!a.spatialReference.equals(b.spatialReference)||!a.origin.equals(b.origin)||Math.round(a.dpi)!==Math.round(b.dpi))return!1;a=a.lods;b=b.lods;const c=Math.min(a.length,b.length);for(let d=0;d<c;d++){const e=a[d],f=b[d];if(e.level!==f.level||
Math.round(e.scale)!==Math.round(f.scale))return!1}return!0};return k}()});