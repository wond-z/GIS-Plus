// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(k,l,n,p){return function(){function m(a){this.geometryMap=k.createGeometryData(()=>({indexBuffer:l.BufferObject.createIndex(a,n.Usage.STATIC_DRAW),vao:null}),(b,c)=>({vertexBuffer:l.BufferObject.createVertex(a,k.C_VBO_INFO[c])}))}var f=m.prototype;f.dispose=function(){for(let a=0;5>a;a++){const b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();
for(const c in b.buffers)b.buffers[c]&&b.buffers[c].data.vertexBuffer.dispose()}}};f.get=function(a){const b=this.geometryMap[a];return{getVAO(c,d,e){if(!b.data.vao){const g={};for(const h in b.buffers)g[h]=b.buffers[h].data.vertexBuffer;b.data.vao=new p.VertexArrayObject(c,e,d,g,b.data.indexBuffer)}return b.data.vao}}};f.has=function(a){return null!=this.geometryMap[a]};f.upload=function(a,b){b.forEach((c,d)=>{this._upload(c,d,a)})};f._upload=function(a,b,c){a.indices&&(a.indices.allDirty?this._uploadIndices(c,
b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(c,b,a.indices.from,a.indices.count));if(a.vertices){a=a.vertices;for(const d in a){const e=a[d];e.allDirty?this._uploadVertices(c,b,d):null!=e.from&&null!=e.count&&this._uploadVertices(c,b,d,e.from,e.count)}}};f._uploadVertices=function(a,b,c,d,e){const g=this.geometryMap[b];if(g&&(a=a.geometries[b].vertexBuffer[c])){var {data:h,stride:q}=a;g.buffers[c]&&0<h.length&&(a=q/h.BYTES_PER_ELEMENT,null!=d&&null!=e?g.buffers[c].data.vertexBuffer.setSubData(h,
d*a,d*a,(d+e)*a):g.buffers[c].data.vertexBuffer.setData(h))}};f._uploadIndices=function(a,b,c,d){const e=this.geometryMap[b];e&&(a=a.geometries[b].indexBuffer,e.data.indexBuffer&&0<a.length&&(null!=c&&null!=d?e.data.indexBuffer.setSubData(a,c,c,c+d):e.data.indexBuffer.setData(a)))};return m}()});