// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./support/WatchUpdatingTracking".split(" "),function(v,t,E,B,u,A,x,e){const h=d=>{d=function(l){function m(){return l.apply(this,arguments)||this}t._inheritsLoose(m,l);m.prototype.destroy=function(){this.destroyed||(this._get("handles")?.destroy(),this._get("updatingHandles")?.destroy())};
t._createClass(m,[{key:"handles",get:function(){return this._get("handles")||new u}},{key:"updatingHandles",get:function(){return this._get("updatingHandles")||new e.WatchUpdatingTracking}}]);return m}(d);E.__decorate([A.property({readOnly:!0})],d.prototype,"handles",null);E.__decorate([A.property({readOnly:!0})],d.prototype,"updatingHandles",null);return d=E.__decorate([x.subclass("esri.core.HandleOwner")],d)};v.HandleOwner=function(d){function l(){return d.apply(this,arguments)||this}t._inheritsLoose(l,
d);return l}(h(B));v.HandleOwner=E.__decorate([x.subclass("esri.core.HandleOwner")],v.HandleOwner);v.HandleOwnerMixin=h;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../Accessor ../Handles ../maybe ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),function(v,
t,E,B,u,A,x,e,h,d){v.WatchUpdatingTracking=function(l){function m(){var k=l.apply(this,arguments)||this;k.updating=!1;k._handleId=0;k._handles=new u;k._scheduleHandleId=0;k._pendingPromises=new Set;return k}t._inheritsLoose(m,l);var r=m.prototype;r.destroy=function(){this.removeAll();this._handles.destroy()};r.add=function(k,c,b={}){return this._installWatch(k,c,b,x.watch)};r.addWhen=function(k,c,b={}){return this._installWatch(k,c,b,x.when)};r.addOnCollectionChange=function(k,c,{initial:b=!1,final:a=
!1}={}){const g=++this._handleId;this._handles.add([x.on(k,"after-changes",this._createSyncUpdatingCallback(),x.sync),x.on(k,"change",c,{onListenerAdd:b?n=>c({added:n.toArray(),removed:[]}):void 0,onListenerRemove:a?n=>c({added:[],removed:n.toArray()}):void 0})],g);return{remove:()=>this._handles.remove(g)}};r.addPromise=function(k){if(A.isNone(k))return k;const c=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(k)&&(0!==this._pendingPromises.size||this._handles.has(-42)||
this._set("updating",!1))}},c);this._pendingPromises.add(k);this._set("updating",!0);const b=()=>this._handles.remove(c);k.then(b,b);return k};r.removeAll=function(){this._pendingPromises.clear();this._handles.removeAll();this._set("updating",!1)};r._installWatch=function(k,c,b={},a){const g=++this._handleId;b.sync||this._installSyncUpdatingWatch(k,g);k=a(k,c,b);this._handles.add(k,g);return{remove:()=>this._handles.remove(g)}};r._installSyncUpdatingWatch=function(k,c){const b=this._createSyncUpdatingCallback();
k=x.watch(k,b,{sync:!0,equals:()=>!1});this._handles.add(k,c);return k};r._createSyncUpdatingCallback=function(){return()=>{this._handles.remove(-42);++this._scheduleHandleId;const k=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this._handles.add(e.schedule(()=>{k===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this._handles.remove(-42))}),-42)}};return m}(B);E.__decorate([h.property({readOnly:!0})],v.WatchUpdatingTracking.prototype,"updating",
void 0);v.WatchUpdatingTracking=E.__decorate([d.subclass("esri.core.support.WatchUpdatingTracking")],v.WatchUpdatingTracking);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(v,t,E,B,u,A,x){function e(r,k,c={}){return h(r,k,c,l)}function h(r,k,c={},b){let a=null;const g=c.once?(n,f)=>
{b(n)&&(B.removeMaybe(a),k(n,f))}:(n,f)=>{b(n)&&k(n,f)};a=A.watchTracked(r,g,c.sync,c.equals);c.initial&&(r=r(),g(r,r));return a}function d(r,k,c){if(u.isAborted(c))return Promise.reject(u.createAbortError());const b=r();if(k?.(b))return Promise.resolve(b);let a=null;return new Promise((g,n)=>{a=E.handlesGroup([u.onAbort(c,()=>{a=B.removeMaybe(a);n(u.createAbortError())}),h(r,f=>{a=B.removeMaybe(a);g(f)},{sync:!1,once:!0},k??l)])})}function l(r){return!0}function m(r){return!!r}v.autorun=x.autorun;
v.initial={initial:!0};v.on=function(r,k,c,b={}){function a(){n&&f&&(f.remove(),b.onListenerRemove?.(n),f=n=null)}function g(z){b.once&&b.once&&B.removeMaybe(q);c(z)}let n=null,f=null,q=null;const p=e(r,(z,w)=>{a();t.isEventTarget(z)&&(n=z,f=t.on(z,k,g),b.onListenerAdd?.(z))},{sync:b.sync,initial:!0});return q=E.makeHandle(()=>{p.remove();a()})};v.once=function(r,k){return d(r,null,k)};v.pausable=function(r,k,c={}){let b=!1;const a=e(r,(g,n)=>{b||k(g,n)},c);return{remove(){a.remove()},pause(){b=!0},
resume(){b=!1}}};v.sync={sync:!0};v.syncAndInitial={sync:!0,initial:!0};v.watch=e;v.when=function(r,k,c={}){return h(r,k,c,m)};v.whenOnce=function(r,k){return d(r,m,k)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n){var f;E=new E.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});B=f=function(q){function p(w){w=q.call(this,w)||this;w.dpi=96;w.format=null;w.origin=null;w.minScale=0;w.maxScale=0;w.size=null;w.spatialReference=null;return w}v._inheritsLoose(p,q);p.create=function(w=
{}){const {resolutionFactor:y=1,scales:G,size:H=256,spatialReference:I=k.WebMercator,numLODs:D=24}=w;if(!b.isValid(I)){w=[];if(G)for(var C=0;C<G.length;C++){var F=G[C];w.push({level:C,scale:F,resolution:F})}else for(C=5E-4,F=D-1;0<=F;F--)w.unshift({level:F,scale:C,resolution:C}),C*=2;return new f({dpi:96,lods:w,origin:new r(0,0,I),size:[H,H],spatialReference:I})}C=b.getInfo(I);w=w.origin?new r({x:w.origin.x,y:w.origin.y,spatialReference:I}):C?new r({x:C.origin[0],y:C.origin[1],spatialReference:I}):
new r({x:0,y:0,spatialReference:I});C=1/(39.37*A.getMetersPerUnitForSR(I)*96);F=[];if(G)for(var K=0;K<G.length;K++){var J=G[K];F.push({level:K,scale:J,resolution:J*C})}else{var P=b.isGeographic(I)?512/H*5.916575275917094E8:256/H*5.91657527591555E8;K=Math.ceil(D/y);F.push({level:0,scale:P,resolution:P*C});for(J=1;J<K;J++)P/=2**y,F.push({level:J,scale:P,resolution:P*C})}return new f({dpi:96,lods:F,origin:w,size:[H,H],spatialReference:I})};var z=p.prototype;z.readOrigin=function(w,y){return r.fromJSON({spatialReference:y.spatialReference,
...w})};z.readSize=function(w,y){return[y.cols,y.rows]};z.writeSize=function(w,y){y.cols=w[0];y.rows=w[1]};z.zoomToScale=function(w){const y=this.scales;if(0>=w)return y[0];if(w>=y.length-1)return y[y.length-1];const G=Math.floor(w);return y[G]/(y[G]/y[G+1])**(w-G)};z.scaleToZoom=function(w){const y=this.scales,G=y.length-1;let H=0;for(;H<G;H++){const I=y[H],D=y[H+1];if(I<=w)break;if(D===w)return H+1;if(I>w&&D<w)return H+Math.log(I/w)/Math.log(I/D)}return H};z.snapScale=function(w,y=.95){w=this.scaleToZoom(w);
return w%Math.floor(w)>=y?this.zoomToScale(Math.ceil(w)):this.zoomToScale(Math.floor(w))};z.tileAt=function(w,y,G,H){var I=this.lodAt(w);if(!I)return null;let D;if("number"===typeof y)D=y,y=G;else{if(b.equals(y.spatialReference,this.spatialReference))D=y.x,y=y.y;else{H=a.project(y,this.spatialReference);if(u.isNone(H))return null;D=H.x;y=H.y}H=G}G=I.resolution*this.size[0];I=I.resolution*this.size[1];H||(H=new n.TileKey(null,0,0,0,c.create()));H.level=w;H.row=Math.floor((this.origin.y-y)/I+.001);
H.col=Math.floor((D-this.origin.x)/G+.001);this.updateTileInfo(H);return H};z.updateTileInfo=function(w,y=f.ExtrapolateOptions.NONE){var G=this.lodAt(w.level);G||y!==f.ExtrapolateOptions.POWER_OF_TWO||(y=this.lods[this.lods.length-1],y.level<w.level&&(G=y));if(G){var H=w.level-G.level;y=G.resolution*this.size[0]/2**H;G=G.resolution*this.size[1]/2**H;w.id=`${w.level}/${w.row}/${w.col}`;w.extent||(w.extent=c.create());w.extent[0]=this.origin.x+w.col*y;w.extent[1]=this.origin.y-(w.row+1)*G;w.extent[2]=
w.extent[0]+y;w.extent[3]=w.extent[1]+G}};z.upsampleTile=function(w){const y=this._upsampleLevels[w.level];if(!y||-1===y.parentLevel)return!1;w.level=y.parentLevel;w.row=Math.floor(w.row/y.factor+.001);w.col=Math.floor(w.col/y.factor+.001);this.updateTileInfo(w);return!0};z.getTileBounds=function(w,y){var G=this.lodAt(y.level);if(null==G)return null;var {resolution:H}=G;G=H*this.size[0];H*=this.size[1];w[0]=this.origin.x+y.col*G;w[1]=this.origin.y-(y.row+1)*H;w[2]=w[0]+G;w[3]=w[1]+H;return w};z.lodAt=
function(w){return this._levelToLOD?.[w]??null};z.clone=function(){return f.fromJSON(this.write({}))};z.getOrCreateCompatible=function(w,y){if(256===this.size[0]&&256===this.size[1])return 256===w?this:null;const G=[],H=this.lods.length;for(let I=0;I<H;I++){const D=this.lods[I];G.push(new g({level:D.level,scale:D.scale,resolution:D.resolution*y}))}return new f({size:[w,w],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,
lods:G})};z._initializeUpsampleLevels=function(){const w=this.lods;this._upsampleLevels=[];let y=null;for(let G=0;G<w.length;G++){const H=w[G];this._upsampleLevels[H.level]={parentLevel:y?y.level:-1,factor:y?y.resolution/H.resolution:0};y=H}};v._createClass(p,[{key:"isWrappable",get:function(){const {spatialReference:w,origin:y}=this;if(w&&y){const G=b.getInfo(w);return w.isWrappable&&!!G&&Math.abs(G.origin[0]-y.x)<=G.dx}return!1}},{key:"lods",set:function(w){let y=0,G=0;const H=[],I=this._levelToLOD=
{};w&&(y=-Infinity,G=Infinity,w.forEach(D=>{H.push(D.scale);y=D.scale>y?D.scale:y;G=D.scale<G?D.scale:G;I[D.level]=D}));this._set("scales",H);this._set("minScale",y);this._set("maxScale",G);this._set("lods",w);this._initializeUpsampleLevels()}}]);return p}(B.JSONSupport);t.__decorate([x.property({type:Number,json:{write:!0}})],B.prototype,"compressionQuality",void 0);t.__decorate([x.property({type:Number,json:{write:!0}})],B.prototype,"dpi",void 0);t.__decorate([x.property({type:String,json:{read:E.read,
write:E.write,origins:{"web-scene":{read:!1,write:!1}}}})],B.prototype,"format",void 0);t.__decorate([x.property({readOnly:!0})],B.prototype,"isWrappable",null);t.__decorate([x.property({type:r,json:{write:!0}})],B.prototype,"origin",void 0);t.__decorate([d.reader("origin")],B.prototype,"readOrigin",null);t.__decorate([x.property({type:[g],value:null,json:{write:!0}})],B.prototype,"lods",null);t.__decorate([x.property({readOnly:!0})],B.prototype,"minScale",void 0);t.__decorate([x.property({readOnly:!0})],
B.prototype,"maxScale",void 0);t.__decorate([x.property({readOnly:!0})],B.prototype,"scales",void 0);t.__decorate([x.property({cast:q=>Array.isArray(q)?q:"number"===typeof q?[q,q]:[256,256]})],B.prototype,"size",void 0);t.__decorate([d.reader("size",["rows","cols"])],B.prototype,"readSize",null);t.__decorate([m.writer("size",{cols:{type:h.Integer},rows:{type:h.Integer}})],B.prototype,"writeSize",null);t.__decorate([x.property({type:k,json:{write:!0}})],B.prototype,"spatialReference",void 0);B=f=t.__decorate([l.subclass("esri.layers.support.TileInfo")],
B);(function(q){q=q.ExtrapolateOptions||(q.ExtrapolateOptions={});q[q.NONE=0]="NONE";q[q.POWER_OF_TWO=1]="POWER_OF_TWO"})(B||(B={}));return B})},"esri/core/unitUtils":function(){define("exports ./has ./jsonMap ./maybe ../geometry/projectionEllipsoid ../geometry/support/Ellipsoid ../geometry/support/spatialReferenceUtils ../geometry/support/WKIDUnitConversion".split(" "),function(v,t,E,B,u,A,x,e){function h(U){U=J[U];if(!U)throw Error("unknown type");return U}function d(U){return K[U].baseUnit}function l(U,
Q=null){Q=Q||h(U);return K[Q].baseUnit===U}function m(U,Q,O){if(Q===O)return U;const R=h(Q);if(R!==h(O))throw Error("incompatible units");U=l(Q,R)?U:U*K[R].units[Q].inBaseUnits;return l(O,R)?U:U/K[R].units[O].inBaseUnits}function r(U,Q){U=m(U,Q,"meters");return 3E3>Math.abs(U)?"meters":"kilometers"}function k(U,Q){U=m(U,Q,"meters");return 1E5>Math.abs(U)?"meters":"kilometers"}function c(U,Q){U=m(U,Q,"feet");return 1E3>Math.abs(U)?"feet":"miles"}function b(U,Q){U=m(U,Q,"feet");return 1E5>Math.abs(U)?
"feet":"miles"}function a(U,Q){U=m(U,Q,"square-meters");return 3E6>Math.abs(U)?"square-meters":"square-kilometers"}function g(U,Q){U=m(U,Q,"square-feet");return 1E6>Math.abs(U)?"square-feet":"square-miles"}function n(U){return F.fromJSON(U.toLowerCase())||null}function f(U){const Q=q(U),O=u.getReferenceEllipsoid(U).metersPerDegree;return Q>=O?"meters":w(U)}function q(U,Q=A.earth.metersPerDegree){return B.unwrapOr(p(U,!0),Q)}function p(U,Q=!1){const O=B.isSome(U)?U.wkid:null;U=B.isSome(U)?U.wkt:null;
let R=null;if(O){if(x.isWKIDFromMars(O))return A.mars.metersPerDegree;if(x.isWKIDFromMoon(O))return A.moon.metersPerDegree;R=I.values[I[O]];!R&&Q&&C.has(O)&&(R=G)}else U&&(/^PROJCS/i.test(U)?R=z(H.exec(U),R):/^GEOCCS/i.test(U)&&(R=z(D.exec(U),R)));return R}function z(U,Q){return U&&U[1]?parseFloat(U[1].split(",")[1]):Q}function w(U){var Q=B.isSome(U)?U.wkid:null,O=B.isSome(U)?U.wkt:null;U=null;if(Q)U=I.units[I[Q]];else if(O&&(Q=/^PROJCS/i.test(O)?H:/^GEOCCS/i.test(O)?D:null)&&(Q=Q.exec(O))&&Q[1]&&
(Q=Q[1],U=(U=/[\\"\\']{1}([^\\"\\']+)/.exec(Q))&&U[1],!U||!I.units.includes(U))){Q=parseFloat(Q.split(",")[1]);U=null;O=I.values;for(let R=0;R<O.length;++R)if(1E-7>Math.abs(Q-O[R])){U=I.units[R];break}}return B.isSome(U)?n(U):null}function y(U){U=w(U);if(B.isNone(U))return null;switch(U){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric"}return null}const G=A.earth.radius*Math.PI/200,H=/UNIT\[([^\]]+)\]\]$/i,I=e,D=/UNIT\[([^\]]+)\]/i,C=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),F=E.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",
yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});t={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},
"us-feet":{inBaseUnits:1200/3937}};e={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:(U=>U*U)(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};
const K={length:{baseUnit:"meters",units:t},area:{baseUnit:"square-meters",units:e},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},
angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},J=(()=>{const U={};for(const Q in K)for(const O in K[Q].units)U[O]=Q;return U})(),P="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" "),S=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]),X={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",
esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},ha={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",
esriYards:"yards"};t=E.strict()(X);e=E.strict()(ha);E=E.strict()({...X,...ha});v.areaUnitFromSpatialReference=function(U){U=w(U);return B.isNone(U)?null:S.get(U)};v.areaUnitsJSONMap=t;v.baseUnitForUnit=function(U){return d(h(U))};v.baseUnitForUnitType=d;v.convertUnit=m;v.getDefaultUnitForView=function(U){if(B.isNone(U))return"metric";var Q=U.map;if(Q=Q&&"portalItem"in Q?Q.portalItem?.portal:null)switch(Q?.user?.units??Q.units){case "metric":return"metric";case "english":return"imperial"}return B.unwrapOr(y(U.spatialReference),
"metric")};v.getDefaultUnitSystem=y;v.getMetersPerUnit=p;v.getMetersPerUnitForSR=q;v.getMetersPerVerticalUnitForSR=function(U){if(B.isSome(U)&&!x.isEarth(U))return 1;U=q(U);return 1E5<U?1:U};v.getUnitString=w;v.getVerticalUnitStringForSR=f;v.inchesPerMeter=39.37;v.isBaseUnit=l;v.isMeasurementSystem=function(U){return"imperial"===U||"metric"===U};v.lengthToDegrees=function(U,Q,O){return m(U,Q,"meters")/(O*Math.PI/180)};v.lengthUnitFromSpatialReference=function(U){U=w(U);return B.isNone(U)||!P.includes(U)?
null:U};v.lengthUnitsJSONMap=e;v.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");v.measurementLengthUnits=P;v.preferredAreaUnit=function(U,Q,O){switch(O){case "metric":return a(U,Q);case "imperial":return g(U,Q);default:return O}};v.preferredImperialAreaUnit=g;v.preferredImperialLengthUnit=c;v.preferredImperialVerticalLengthUnit=b;v.preferredLengthUnit=function(U,Q,O){switch(O){case "metric":return r(U,
Q);case "imperial":return c(U,Q);default:return O}};v.preferredMetricAreaUnit=a;v.preferredMetricLengthUnit=r;v.preferredMetricVerticalLengthUnit=k;v.preferredVerticalLengthUnit=function(U,Q,O){switch(O){case "metric":return k(U,Q);case "imperial":return b(U,Q);default:return O}};v.unitFromRESTJSON=n;v.unitToRESTJSON=function(U){return F.toJSON(U)||null};v.unitType=h;v.unitsJSONMap=E;v.verticalLengthUnitFromSpatialReference=function(U){U=f(U);return B.isNone(U)||!P.includes(U)?null:U};Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/projectionEllipsoid":function(){define(["exports","../core/maybe","./SpatialReference","./support/Ellipsoid","./support/spatialReferenceUtils"],function(v,t,E,B,u){function A(l){return new E({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${l.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}
const x=A(B.earth),e=A(B.mars),h=A(B.moon),d=new E({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${B.earth.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});v.SphericalECEFSpatialReference=x;v.SphericalPCPFMars=
e;v.SphericalPCPFMoon=h;v.WGS84ECEFSpatialReference=d;v.createSphericalPCPF=A;v.getReferenceEllipsoid=function(l){return t.isSome(l)&&(u.isMars(l)||l===e)?B.mars:t.isSome(l)&&(u.isMoon(l)||l===h)?B.moon:B.earth};v.getReferenceEllipsoidFromWKID=function(l){return u.isWKIDFromMars(l)?B.mars:u.isWKIDFromMoon(l)?B.moon:B.earth};v.getSphericalPCPF=function(l){return l&&(u.isMars(l)||l===e)?e:l&&(u.isMoon(l)||l===h)?h:x};v.getSphericalPCPFForEllipsoid=function(l){return l&&l===B.mars?e:l&&l===B.moon?h:
x};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/aaBoundingRect":function(){define(["exports","../../core/has","../../core/mathUtils","../../core/maybe","../Extent"],function(v,t,E,B,u){function A(k=r){return[k[0],k[1],k[2],k[3]]}function x(k,c){k!==c&&(k[0]=c[0],k[1]=c[1],k[2]=c[2],k[3]=c[3]);return k}function e(k){return B.isNone(k)||k[0]>=k[2]?0:k[2]-k[0]}function h(k){return k[1]>=k[3]?0:k[3]-k[1]}function d(k,c,b){return c>=
k[0]&&b>=k[1]&&c<=k[2]&&b<=k[3]}function l(k){return null!=k&&4===k.length}const m=[Infinity,Infinity,-Infinity,-Infinity],r=[0,0,0,0];v.NEGATIVE_INFINITY=m;v.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];v.UNIT=[0,0,1,1];v.ZERO=r;v.allFinite=function(k){for(let c=0;4>c;c++)if(!isFinite(k[c]))return!1;return!0};v.area=function(k){return e(k)*h(k)};v.center=function(k,c=[0,0]){c[0]=(k[0]+k[2])/2;c[1]=(k[1]+k[3])/2;return c};v.clone=function(k){return[k[0],k[1],k[2],k[3]]};v.contains=function(k,
c){return c[0]>=k[0]&&c[2]<=k[2]&&c[1]>=k[1]&&c[3]<=k[3]};v.containsPoint=function(k,c){return d(k,c[0],c[1])};v.containsPointObject=function(k,c){return d(k,c.x,c.y)};v.containsPointWithMargin=function(k,c,b){return c[0]>=k[0]-b&&c[1]>=k[1]-b&&c[0]<=k[2]+b&&c[1]<=k[3]+b};v.containsXY=d;v.containsXYWithMargin=function(k,c,b,a){return c>=k[0]-a&&b>=k[1]-a&&c<=k[2]+a&&b<=k[3]+a};v.copy=x;v.create=A;v.distance=function(k,c){const b=(k[1]+k[3])/2,a=Math.max(Math.abs(c[0]-(k[0]+k[2])/2)-e(k)/2,0);k=Math.max(Math.abs(c[1]-
b)-h(k)/2,0);return Math.sqrt(a*a+k*k)};v.empty=function(k){return k?x(k,m):A(m)};v.equals=function(k,c){return l(k)&&l(c)?k[0]===c[0]&&k[1]===c[1]&&k[2]===c[2]&&k[3]===c[3]:k===c};v.expand=function(k,c,b){if(B.isNone(c))x(b,k);else if("length"in c)if(l(c))b[0]=Math.min(k[0],c[0]),b[1]=Math.min(k[1],c[1]),b[2]=Math.max(k[2],c[2]),b[3]=Math.max(k[3],c[3]);else{if(2===c.length||3===c.length)b[0]=Math.min(k[0],c[0]),b[1]=Math.min(k[1],c[1]),b[2]=Math.max(k[2],c[0]),b[3]=Math.max(k[3],c[1])}else switch(c.type){case "extent":b[0]=
Math.min(k[0],c.xmin);b[1]=Math.min(k[1],c.ymin);b[2]=Math.max(k[2],c.xmax);b[3]=Math.max(k[3],c.ymax);break;case "point":b[0]=Math.min(k[0],c.x),b[1]=Math.min(k[1],c.y),b[2]=Math.max(k[2],c.x),b[3]=Math.max(k[3],c.y)}};v.expandPointInPlace=function(k,c){c[0]<k[0]&&(k[0]=c[0]);c[0]>k[2]&&(k[2]=c[0]);c[1]<k[1]&&(k[1]=c[1]);c[1]>k[3]&&(k[3]=c[1])};v.expandWithNestedArray=function(k,c,b=k){const a=c.length;let g=k[0],n=k[1],f=k[2];k=k[3];for(let q=0;q<a;q++){const p=c[q];g=Math.min(g,p[0]);n=Math.min(n,
p[1]);f=Math.max(f,p[0]);k=Math.max(k,p[1])}b[0]=g;b[1]=n;b[2]=f;b[3]=k;return b};v.fromExtent=function(k,c=A()){c[0]=k.xmin;c[1]=k.ymin;c[2]=k.xmax;c[3]=k.ymax;return c};v.fromValues=function(k,c,b,a,g=A()){g[0]=k;g[1]=c;g[2]=b;g[3]=a;return g};v.height=h;v.intersection=function(k,c,b){if(B.isNone(c))return x(b,k);const a=c[0],g=c[1],n=c[2];c=c[3];b[0]=E.clamp(k[0],a,n);b[1]=E.clamp(k[1],g,c);b[2]=E.clamp(k[2],a,n);b[3]=E.clamp(k[3],g,c);return b};v.intersects=function(k,c){return Math.max(c[0],
k[0])<=Math.min(c[2],k[2])&&Math.max(c[1],k[1])<=Math.min(c[3],k[3])};v.intersectsSegment=function(k,c,b){const a=k[0],g=k[1],n=k[2];k=k[3];const {x:f,y:q}=c,{x:p,y:z}=b;var w=(G,H)=>0>(z-q)*G+(f-p)*H+(p*q-f*z);c=w(a,k);b=w(n,k);const y=w(n,g);w=w(a,g);return c===b&&b===y&&y===w&&w===c||f<a&&p<a||f>n&&p>n||q>k&&z>k||q<g&&z<g?!1:!0};v.intersectsSphere=function(k,c){const b=c[3];var a=Math.abs(c[0]-.5*(k[0]+k[2]));const g=.5*(k[2]-k[0]);if(a>b+g)return!1;var n=.5*(k[3]-k[1]);k=Math.abs(c[1]-.5*(k[1]+
k[3]));if(k>b+n)return!1;if(a<g||k<n)return!0;a-=g;n=k-n;return a*a+n*n<=b*b};v.is=l;v.isPoint=function(k){return(0===e(k)||!isFinite(k[0]))&&(0===h(k)||!isFinite(k[1]))};v.offset=function(k,c,b,a=k){a[0]=k[0]+c;a[1]=k[1]+b;a[2]=k[2]+c;a[3]=k[3]+b;return a};v.pad=function(k,c,b=k){b[0]=k[0]-c;b[1]=k[1]-c;b[2]=k[2]+c;b[3]=k[3]+c;return b};v.setMax=function(k,c,b=k){b[2]=c[0];b[3]=c[1];b!==k&&(b[0]=k[0],b[1]=k[1]);return k};v.setMin=function(k,c,b=k){b[0]=c[0];b[1]=c[1];b!==k&&(b[2]=k[2],b[3]=k[3]);
return b};v.size=function(k,c){c[0]=k[2]-k[0];c[1]=k[3]-k[1]};v.toExtent=function(k,c){return new u({xmin:k[0],ymin:k[1],xmax:k[2],ymax:k[3],spatialReference:c})};v.width=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x){var e;E=e=function(h){function d(l){l=h.call(this,l)||this;l.cols=null;l.level=0;l.levelValue=null;l.origin=null;l.resolution=0;l.rows=null;l.scale=0;return l}v._inheritsLoose(d,h);d.prototype.clone=function(){return new e({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return d}(E.JSONSupport);t.__decorate([B.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,
write:!1}}}})],E.prototype,"cols",void 0);t.__decorate([B.property({type:A.Integer,json:{write:!0}})],E.prototype,"level",void 0);t.__decorate([B.property({type:String,json:{write:!0}})],E.prototype,"levelValue",void 0);t.__decorate([B.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"origin",void 0);t.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"resolution",void 0);t.__decorate([B.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],E.prototype,"rows",void 0);t.__decorate([B.property({type:Number,json:{write:!0}})],E.prototype,"scale",void 0);return E=e=t.__decorate([x.subclass("esri.layers.support.LOD")],E)})},"esri/layers/support/TileKey":function(){define(["exports"],function(v){v.TileKey=function(t,E,B,u,A){this.id=t;this.level=E;this.row=B;this.col=u;this.extent=A};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/processors":function(){define(["require","exports"],function(v,t){const E=B=>Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));t.loadProcessorModule=function(B){return"heatmap"===B?new Promise((u,A)=>v(["./processors/HeatmapProcessor"],x=>u(E(x)),A)):new Promise((u,A)=>v(["./processors/SymbolProcessor"],x=>u(E(x)),A))};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/BinStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z){function w(G){if(!A.isAbortError(G)&&"worker:port-closed"!==G.name)throw G;}function y(G){return"feature"===G.type&&"snapshot"===G.mode}E=function(G){function H(){var D=G.apply(this,arguments)||this;D._storage=new f.ComputedAttributeStorage;D._markedIdsBufId=D._storage.createBitset();D._lastCleanup=performance.now();D._cleanupNeeded=!1;D._invalidated=!1;D._tileToResolver=new Map;D._didEdit=!1;D._updateVersion=1;D.tileStore=null;D.config=null;
D.processor=null;D.remoteClient=null;D.service=null;return D}v._inheritsLoose(H,G);var I=H.prototype;I.initialize=function(){this._initStores();this._initSource();this._updateQueue=new z.QueueProcessor({concurrency:"geoevent"===this._source.type?1:4,process:(D,C)=>this._onTileMessage(D,{signal:C})});this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this)),x.when(()=>!this.updating,()=>this.onIdle())]);this._checkUpdating=setInterval(()=>this.notifyChange("updating"),300)};I._initSource=
function(){this._source=b.createSource(this.service,this.spatialReference,this.tileStore.tileScheme,(D,C)=>{this._invalidated=!0;return this._patchTile(D,C)},()=>50>this._updateQueue.length,this.featureStore);this._proxyEvents()};I._proxyEvents=function(){if("geoevent"===this._source.type){const D=this._source.events;this.handles.add([D.on("connectionStatus",C=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:C}).catch(w)),D.on("errorString",C=>this.remoteClient.invoke("setProperty",
{propertyName:"errorString",value:C}).catch(w)),D.on("data-received",C=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:C.attributes,centroid:C.centroid,geometry:C.geometry}}).catch(w)),D.on("updateRate",C=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...C}}).catch(w))])}};I._initAttributeStore=function(D){this.attributeStore||(this.attributeStore=new a({type:"remote",initialize:(C,F)=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",
C,{signal:F}).catch(w)),update:(C,F)=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",C,{signal:F}).catch(w)),render:C=>A.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:C}).catch(w))},D,()=>this.notifyChange("updating")))};I._initStores=function(){this.featureStore=new c.FeatureStore2D({geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,
fieldsIndex:this.fieldsIndex,fields:this.service.fields},this._storage,"snapshot"===this.service.type?"snapshot":"on-demand")};I._initQueryEngine=function(D){const C=this;this.featureQueryEngine?.destroy();this.featureQueryEngine=new r.QueryEngine({definitionExpression:D.schema.source.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,
featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(F){return u.isNone(C.aggregateStore)?[]:C.aggregateStore.getFeatureDisplayIdsForAggregate(F).map(K=>C.getObjectId(K))}},timeInfo:this.service.timeInfo})};I._initAggregateQueryEngine=function(D,C){this.aggregateQueryEngine?.destroy();u.isNone(D)||(C=C.targets.aggregate.params.fields.slice(),this.aggregateQueryEngine=new r.QueryEngine({definitionExpression:null,fields:C,geometryType:D.geometryInfo.geometryType,objectIdField:D.objectIdField,
hasM:D.geometryInfo.hasM,hasZ:D.geometryInfo.hasZ,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!1,featureStore:D,aggregateAdapter:{getFeatureObjectIds(F){return[]}}}))};I.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.featureQueryEngine?.destroy();this.aggregateQueryEngine?.destroy();this.attributeStore?.destroy();for(const D of this.tileStore.tiles)this._source.unsubscribe(D);clearInterval(this._checkUpdating)};I.isUpdating=function(){const D=this._source.updating,
C=!!this._updateQueue.length,F=!this.attributeStore||this.attributeStore.isUpdating(),K=D||C||F;B("esri-2d-log-updating")&&console.log(`Updating FeatureController2D: ${K}\n  -> updatingSource ${D}\n  -> updateQueue ${C}\n  -> updatingAttributeStore ${F}\n`);return K};I.enableEvent=function(D){this._source.enableEvent(D.name,D.value)};I.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};I.resume=function(){this._updateQueue.resume()};I.pauseStream=function(){"geoevent"===this._source.type&&
this._source.pauseStream()};I.resumeStream=function(){"geoevent"===this._source.type&&this._source.resumeStream()};I._initAggregateStore=function(D){D=D.schema.targets?.aggregate?.type;if(u.applySome(this.config,C=>C.schema.targets?.aggregate?.type)!==D&&(u.isSome(this.aggregateStore)&&(this.handles.remove("valueRangesChanged"),this.aggregateStore.destroy(),this.aggregateStore=null),D)){switch(D){case "cluster":this.aggregateStore=new n.ClusterStore({geometryInfo:{geometryType:"esriGeometryPoint",
hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields},this.spatialReference,this._storage,this.service);this.handles.add(this.aggregateStore.events.on("valueRangesChanged",C=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:C.valueRanges}}).catch(w)}),"valueRangesChanged");break;case "bin":this.aggregateStore=new g.BinStore({geometryInfo:{geometryType:"esriGeometryPolygon",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,
fieldsIndex:this.fieldsIndex,fields:this.service.fields},this.spatialReference,this._storage,this.service)}this.aggregateStore.onTileUpdate({added:this.tileStore.tiles,removed:[]})}};I.update=function(){var D=v._asyncToGenerator(function*(C,F){this._updateVersion++;this._initQueryEngine(F);this._initAttributeStore(F);this.pause();yield Promise.all([this._source.update(C,F.schema.source),this.featureStore.updateSchema(C,F.schema.targets.feature),this.attributeStore.update(C,F),this.attributeStore.updateFilters(C,
F,this)]);this._initAggregateStore(F);u.isSome(this.aggregateStore)&&(yield this.aggregateStore.updateSchema(C,F.schema.targets.aggregate));this._initAggregateQueryEngine(this.aggregateStore,F.schema);B("esri-2d-update-debug")&&C.describe();this._set("config",F)});return function(C,F){return D.apply(this,arguments)}}();I.applyUpdate=function(){var D=v._asyncToGenerator(function*(C){C.version=this._updateVersion;B("esri-2d-update-debug")&&console.debug(`Applying update ${C.version}`);C.mesh&&this.clearTiles();
this._updateQueue.resume();yield this._source.applyUpdate(C);this.notifyChange("updating");yield x.whenOnce(()=>!this.updating);u.isSome(this.aggregateStore)&&(yield A.after(10),yield x.whenOnce(()=>!this.updating))});return function(C){return D.apply(this,arguments)}}();I.onEdits=function(){var D=v._asyncToGenerator(function*({edits:C}){B("esri-2d-update-debug")&&console.debug("Applying Edit:",C);this._didEdit=!0;try{const F=C.removed.map(J=>J.objectId&&-1!==J.objectId?J.objectId:this._lookupObjectIdByGlobalId(J.globalId)),
K=C.addOrModified.map(({objectId:J})=>J);this.featureStore.invalidate();yield this._source.edit(K,F);this.clearTiles();this.notifyChange("updating");u.isSome(this.aggregateStore)&&this.aggregateStore.clear();yield this._source.resend();yield x.whenOnce(()=>!this.updating)}catch(F){}});return function(C){return D.apply(this,arguments)}}();I.refresh=function(){var D=v._asyncToGenerator(function*(C){if(!C.dataChanged)return C=p.UpdateToken.empty(),C.storage.filters=!0,this.applyUpdate(C);this.featureStore.invalidate();
this.clearTiles();this._source.refresh(this._updateVersion,C);this._cleanupNeeded=!0;this.notifyChange("updating");yield x.whenOnce(()=>!this.updating)});return function(C){return D.apply(this,arguments)}}();I.clearTiles=function(){for(const D of this.tileStore.tiles)this.processor.onTileClear(D)};I.onTileUpdate=function(D){if(u.isSome(this.aggregateStore))this.aggregateStore.onTileUpdate(D);for(const C of D.added)this._source.subscribe(C,this._updateVersion),this._level=C.level;for(const C of D.removed)this._source.unsubscribe(C),
this._cleanupNeeded=!0,this._tileToResolver.has(C.id)&&(this._tileToResolver.get(C.id).resolve(),this._tileToResolver.delete(C.id));this.notifyChange("updating")};I.onIdle=function(){var D=v._asyncToGenerator(function*(){this._invalidated&&(this._invalidated=!1,u.isSome(this.aggregateStore)||"heatmap"===this.processor.type)&&(yield this._repushCurrentLevelTiles());this._markAndSweep()});return function(){return D.apply(this,arguments)}}();I.querySummaryStatistics=function(){var D=v._asyncToGenerator(function*({query:C,
params:F}){return this.featureQueryEngine.executeQueryForSummaryStatistics(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryAggregateSummaryStatistics=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.aggregateQueryEngine.executeQueryForSummaryStatistics(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryUniqueValues=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.featureQueryEngine.executeQueryForUniqueValues(C,
F)});return function(C){return D.apply(this,arguments)}}();I.queryAggregateUniqueValues=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.aggregateQueryEngine.executeQueryForUniqueValues(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryClassBreaks=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.featureQueryEngine.executeQueryForClassBreaks(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryAggregateClassBreaks=
function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.aggregateQueryEngine.executeQueryForClassBreaks(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryHistogram=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.featureQueryEngine.executeQueryForHistogram(C,F)});return function(C){return D.apply(this,arguments)}}();I.queryAggregateHistogram=function(){var D=v._asyncToGenerator(function*({query:C,params:F}){return this.aggregateQueryEngine.executeQueryForHistogram(C,
F)});return function(C){return D.apply(this,arguments)}}();I.queryExtent=function(D){return this.featureQueryEngine.executeQueryForExtent(D)};I.queryAggregates=function(D){return this.aggregateQueryEngine.executeQuery(D)};I.queryAggregateCount=function(D){return this.aggregateQueryEngine.executeQueryForCount(D)};I.queryAggregateIds=function(D){return this.aggregateQueryEngine.executeQueryForIds(D)};I.queryFeatures=function(D){return this.featureQueryEngine.executeQuery(D)};I.queryVisibleFeatures=
function(){var D=v._asyncToGenerator(function*(C){C=yield this.featureQueryEngine.executeQuery(C);const F=C.objectIdFieldName;C.features=C.features.filter(K=>{K=this.getDisplayId(K.attributes[F]);return u.applySome(K,J=>this.attributeStore.isVisible(J))});return C});return function(C){return D.apply(this,arguments)}}();I.queryFeatureCount=function(D){return this.featureQueryEngine.executeQueryForCount(D)};I.queryLatestObservations=function(D){return this.featureQueryEngine.executeQueryForLatestObservations(D)};
I.queryObjectIds=function(D){return this.featureQueryEngine.executeQueryForIds(D)};I.queryStatistics=function(){var D=v._asyncToGenerator(function*(){return this.featureStore.storeStatistics});return function(){return D.apply(this,arguments)}}();I.getObjectId=function(D){return this.featureStore.lookupObjectId(D,this._storage)};I.getDisplayId=function(D){if(u.isSome(this.aggregateStore)){const C=this.aggregateStore.getDisplayId(D);return u.isNone(C)?(D=this.featureStore.lookupDisplayId(D),this.aggregateStore.getDisplayIdForReferenceId(D)):
C}return this.featureStore.lookupDisplayId(D)};I.getFeatures=function(D){const C=[],F=[];for(const K of D)D=u.isSome(this.aggregateStore)?this.getAggregate(K):null,u.isSome(D)?u.isSome(D.attributes.referenceId)?(D=this.getFeature(D.attributes.referenceId),u.isSome(D)&&C.push(D)):F.push(D):(D=this.getFeature(K),u.isSome(D)&&C.push(D));return{features:C,aggregates:F}};I.getFeature=function(D){D=this.featureStore.lookupFeatureByDisplayId(D,this._storage);if(u.isNone(D))return null;var C=D.readHydratedGeometry();
C=m.convertToGeometry(C,D.geometryType,D.hasZ,D.hasM);return{attributes:D.readAttributes(),geometry:C}};I.getAggregate=function(D){return u.isNone(this.aggregateStore)?null:this.aggregateStore.getAggregate(D)};I.getAggregates=function(){return u.isNone(this.aggregateStore)?[]:this.aggregateStore.getAggregates()};I.setHighlight=function(){var D=v._asyncToGenerator(function*(C){const F=u.filterNones(C.map(K=>this.getDisplayId(K)));return this.attributeStore.setHighlight(C,F)});return function(C){return D.apply(this,
arguments)}}();I._lookupObjectIdByGlobalId=function(D){const C=this.service.globalIdField;if(u.isNone(C))throw Error("Expected globalIdField to be defined");let F=null;this.featureStore.forEach(K=>{D===K.readAttribute(C)&&(F=K.getObjectId())});if(u.isNone(F))throw Error(`Expected to find a feature with globalId ${D}`);return F};I._repushCurrentLevelTiles=function(){var D=v._asyncToGenerator(function*(){var C=this,F=this.tileStore.tiles.filter(K=>K.level===this._level);F.map(function(){var K=v._asyncToGenerator(function*(J){return C._patchTile({type:"append",
id:J.key.id,clear:!0,addOrUpdate:null,end:!1})});return function(J){return K.apply(this,arguments)}}());F=F.map(function(){var K=v._asyncToGenerator(function*(J){return C._patchTile({type:"append",id:J.key.id,addOrUpdate:q.FeatureSetReaderJSON.fromOptimizedFeatures([],C.service),remove:[],end:!0,isRepush:!0,status:p.UpdateToken.empty()})});return function(J){return K.apply(this,arguments)}}());yield Promise.all(F)});return function(){return D.apply(this,arguments)}}();I._maybeForceCleanup=function(){5E3<
performance.now()-this._lastCleanup&&this._markAndSweep()};I._patchTile=function(D,C){D=this._updateQueue.push(D,C).then(()=>{this.notifyChange("updating")}).catch(F=>{this.notifyChange("updating")});this.notifyChange("updating");return D};I._onTileMessage=function(){var D=v._asyncToGenerator(function*(C,F){A.throwIfAborted(F);if(B("esri-2d-update-debug")){var K=u.applySome(C.addOrUpdate,S=>S.hasFeatures);console.debug(C.id,`FeatureController:onTileMessage: [clear:${C.clear}, end:${C.end}, features: ${K}]`)}if(K=
this.tileStore.get(C.id)){if(C.clear)return this.processor.onTileClear(K);var J=C.status;this._cleanupNeeded=!0;var P=[];for(const S of C.remove){const X=this.featureStore.lookupDisplayId(S);X&&P.push(X)}C.remove=P;try{if(u.isNone(C.addOrUpdate))this.processor.onTileMessage(K,{...C,addOrUpdate:null},u.isSome(this.aggregateStore),F).catch(A.throwIfNotAbortError);else{C.addOrUpdate.setArcadeSpatialReference(this.spatialReference);this.featureStore.hasInstance(C.addOrUpdate.instance)&&J.targets.feature||
(J.targets.feature=!0,this.featureStore.onTileData(K,C));J.storage.data&&J.storage.filters||(J.storage.data=!0,J.storage.filters=!0,this.attributeStore.onTileData(K,C),"geoevent"===this._source.type||this._didEdit?(yield this.attributeStore.sendUpdates(),A.throwIfAborted(F)):this.attributeStore.sendUpdates());if(u.isSome(this.aggregateStore)&&!J.targets.aggregate){J.targets.aggregate=!0;const S=y(this._source)&&this._source.loading,X=!y(this._source)||S||C.end;this.aggregateStore.onTileData(K,C,this._storage,
this.attributeStore,X);if(!X)return;J.mesh||(this.attributeStore.onTileData(K,C),yield this.attributeStore.sendUpdates())}if(!J.mesh){J.mesh=!0;const S=u.isSome(this.aggregateStore)&&"cluster"===this.aggregateStore.type;yield this.processor.onTileMessage(K,C,S,F);A.throwIfAborted(F)}this._maybeForceCleanup()}}catch(S){A.throwIfNotAbortError(S)}}});return function(C,F){return D.apply(this,arguments)}}();I._mark=function(D,C,F){const K=this._storage.getInstanceId(D);D&&(C.add((4294901760&K)>>>16),F.set(D))};
I._markAndSweep=function(){this._lastCleanup=performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||"geoevent"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var D=this._storage.getBitset(this._markedIdsBufId),C=new Set;D.clear();for(const K of this.tileStore.tiles)for(const J of this._source.readers(K.id)){const P=J.getCursor();for(;P.next();){var F=P.getDisplayId();F||(F=P.getObjectId(),F=this.featureStore.lookupDisplayId(F));this._mark(F,C,D)}}"symbol"===
this.processor.type&&this.processor.forEachBufferId(K=>{this._mark(K,C,D)});this._updateQueue.forEach(K=>{for(const J of K.remove)K=this.featureStore.lookupDisplayId(J),this._mark(K,C,D)});u.isSome(this.aggregateStore)&&(this.aggregateStore.sweepFeatures(D,this.featureStore),"sweepAggregates"in this.aggregateStore&&this.aggregateStore.sweepAggregates(this._storage,this.attributeStore,this._level));this.featureStore.sweepFeatures(D,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(C)}};
v._createClass(H,[{key:"fieldsIndex",get:function(){return new k(this.service.fields)}},{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},{key:"updating",get:function(){return this.isUpdating()}}]);return H}(E.HandleOwner);t.__decorate([e.property({constructOnly:!0})],E.prototype,"tileStore",void 0);t.__decorate([e.property()],E.prototype,"config",void 0);t.__decorate([e.property({readOnly:!0})],E.prototype,"fieldsIndex",null);t.__decorate([e.property()],E.prototype,
"processor",void 0);t.__decorate([e.property({constructOnly:!0})],E.prototype,"remoteClient",void 0);t.__decorate([e.property({constructOnly:!0})],E.prototype,"service",void 0);t.__decorate([e.property()],E.prototype,"spatialReference",null);t.__decorate([e.property()],E.prototype,"updating",null);return E=t.__decorate([l.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],E)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(v,t,E,B,u,A,x,e){function h(W,Y){return W?Y?4:3:Y?3:2}function d(W,Y,da,ja){if(W){if(da)return Y&&ja?M:ea;if(Y&&ja)return L}else if(Y&&ja)return ea;return wa}function l({scale:W,translate:Y},da){return Math.round((da-Y[0])/W[0])}function m({scale:W,translate:Y},da){return Math.round((Y[1]-da)/W[1])}function r({scale:W,translate:Y},da,ja){return da*W[ja]+Y[ja]}function k(W){W=W.coords;return{x:W[0],y:W[1]}}function c(W,Y){W.coords[0]=Y.x;W.coords[1]=Y.y;return W}function b(W){W=W.coords;return{x:W[0],
y:W[1],z:W[2]}}function a(W,Y){W.coords[0]=Y.x;W.coords[1]=Y.y;W.coords[2]=Y.z;return W}function g(W){W=W.coords;return{x:W[0],y:W[1],m:W[2]}}function n(W,Y){W.coords[0]=Y.x;W.coords[1]=Y.y;W.coords[2]=Y.m;return W}function f(W){W=W.coords;return{x:W[0],y:W[1],z:W[2],m:W[3]}}function q(W,Y){W.coords[0]=Y.x;W.coords[1]=Y.y;W.coords[2]=Y.z;W.coords[3]=Y.m;return W}function p(W,Y){return W&&Y?q:W?a:Y?n:c}function z(W,Y,da,ja,pa){da=p(da,ja);for(const {geometry:sa,attributes:ta}of Y)Y=B.isSome(sa)?da(new e,
sa):null,W.push(new A.OptimizedFeature(Y,ta,null,pa?ta[pa]:void 0));return W}function w(W,Y,da,ja){for(const {geometry:pa,attributes:sa}of Y)W.push({attributes:sa,geometry:B.isSome(pa)?y(pa,da,ja):null});return W}function y(W,Y,da){if(B.isNone(W))return null;const ja=h(Y,da),pa=[];for(let sa=0;sa<W.coords.length;sa+=ja){const ta=[];for(let ya=0;ya<ja;ya++)ta.push(W.coords[sa+ya]);pa.push(ta)}return Y?da?{points:pa,hasZ:Y,hasM:da}:{points:pa,hasZ:Y}:da?{points:pa,hasM:da}:{points:pa}}function G(W,
Y,da,ja,pa){da=h(da,ja);for(const {geometry:sa,attributes:ta}of Y)Y=B.isSome(sa)?H(new e,sa,da):null,W.push(new A.OptimizedFeature(Y,ta,null,pa?ta[pa]:void 0));return W}function H(W,Y,da=h(Y.hasZ,Y.hasM)){W.lengths[0]=Y.points.length;const ja=W.coords;let pa=0;for(const sa of Y.points)for(Y=0;Y<da;Y++)ja[pa++]=sa[Y];return W}function I(W,Y,da){if(!W)return null;const ja=h(Y,da),{coords:pa,lengths:sa}=W;W=[];let ta=0;for(const ya of sa){const za=[];for(let la=0;la<ya;la++){const oa=[];for(let va=0;va<
ja;va++)oa.push(pa[ta++]);za.push(oa)}W.push(za)}return Y?da?{paths:W,hasZ:Y,hasM:da}:{paths:W,hasZ:Y}:da?{paths:W,hasM:da}:{paths:W}}function D(W,Y,da,ja,pa){da=h(da,ja);for(const {geometry:sa,attributes:ta}of Y)Y=B.isSome(sa)?C(new e,sa,da):null,W.push(new A.OptimizedFeature(Y,ta,null,pa?ta[pa]:void 0));return W}function C(W,Y,da=h(Y.hasZ,Y.hasM)){const {lengths:ja,coords:pa}=W;let sa=0;for(const ta of Y.paths){for(const ya of ta)for(Y=0;Y<da;Y++)pa[sa++]=ya[Y];ja.push(ta.length)}return W}function F(W,
Y,da){if(!W)return null;const ja=h(Y,da),{coords:pa,lengths:sa}=W;W=[];let ta=0;for(const ya of sa){const za=[];for(let la=0;la<ya;la++){const oa=[];for(let va=0;va<ja;va++)oa.push(pa[ta++]);za.push(oa)}W.push(za)}return Y?da?{rings:W,hasZ:Y,hasM:da}:{rings:W,hasZ:Y}:da?{rings:W,hasM:da}:{rings:W}}function K(W,Y,da,ja,pa){for(const {geometry:sa,centroid:ta,attributes:ya}of Y){Y=B.isSome(sa)?J(new e,sa,da,ja):null;const za=pa?ya[pa]:void 0;B.isSome(ta)?W.push(new A.OptimizedFeature(Y,ya,c(new e,ta),
za)):W.push(new A.OptimizedFeature(Y,ya,null,za))}return W}function J(W,Y,da=Y.hasZ,ja=Y.hasM){P(W,Y.rings,da,ja);return W}function P(W,Y,da,ja){da=h(da,ja);const {lengths:pa,coords:sa}=W;ja=0;V(W);for(const ta of Y){for(const ya of ta)for(Y=0;Y<da;Y++)sa[ja++]=ya[Y];pa.push(ta.length)}return W}function S(W,Y,da,ja,pa,sa){Z(W);if(!da){for(const ta of Y)W.push(new A.OptimizedFeature(null,ta.attributes,null,sa?ta.attributes[sa]:void 0));return W}switch(da){case "esriGeometryPoint":return z(W,Y,ja,pa,
sa);case "esriGeometryMultipoint":return G(W,Y,ja,pa,sa);case "esriGeometryPolyline":return D(W,Y,ja,pa,sa);case "esriGeometryPolygon":return K(W,Y,ja,pa,sa);default:ka.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${da}'`)),Z(W)}return W}function X(W,Y,da,ja){W=W&&("coords"in W?W:W.geometry);if(B.isNone(W))return null;switch(Y){case "esriGeometryPoint":return Y=k,da&&ja?Y=f:da?Y=b:ja&&(Y=g),Y(W);case "esriGeometryMultipoint":return y(W,da,ja);case "esriGeometryPolyline":return I(W,
da,ja);case "esriGeometryPolygon":return F(W,da,ja);default:return ka.error("convertToGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${Y}'`)),null}}function ha(W,Y,da,ja,pa){Z(W);if(B.isNone(da)){for(const ta of Y)W.push({attributes:ta.attributes});return W}switch(da){case "esriGeometryPoint":da=k;ja&&pa?da=f:ja?da=b:pa&&(da=g);for(var sa of Y){const {geometry:ta,attributes:ya}=sa;ja=B.isSome(ta)?da(ta):null;W.push({attributes:ya,geometry:ja})}break;case "esriGeometryMultipoint":return w(W,
Y,ja,pa);case "esriGeometryPolyline":for(const {geometry:ta,attributes:ya}of Y)W.push({attributes:ya,geometry:B.isSome(ta)?I(ta,ja,pa):null});break;case "esriGeometryPolygon":for(const {geometry:ta,attributes:ya,centroid:za}of Y)sa=B.isSome(ta)?F(ta,ja,pa):null,B.isSome(za)?(Y=k(za),W.push({attributes:ya,centroid:Y,geometry:sa})):W.push({attributes:ya,geometry:sa});break;default:ka.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${da}'`))}return W}function U(W,
Y,da,ja,pa,sa,ta=da,ya=ja){V(W);if(B.isNone(Y)||!Y.coords.length)return null;pa=ia[pa];const {coords:za,lengths:la}=Y;Y=h(da,ja);const oa=h(da&&ta,ja&&ya);da=d(da,ja,ta,ya);if(!la.length)return da(W.coords,za,0,0,l(sa,za[0]),m(sa,za[1])),V(W,Y,0),W;let va,Ca=0,Fa,Ja=0;for(const Ka of la){if(Ka<pa)continue;let Ia=0;Fa=Ja;ya=ja=l(sa,za[Ca]);va=ta=m(sa,za[Ca+1]);da(W.coords,za,Fa,Ca,ya,va);Ia++;Ca+=Y;Fa+=oa;for(let Ma=1;Ma<Ka;Ma++,Ca+=Y)if(ya=l(sa,za[Ca]),va=m(sa,za[Ca+1]),ya!==ja||va!==ta)da(W.coords,
za,Fa,Ca,ya-ja,va-ta),Fa+=oa,Ia++,ja=ya,ta=va;Ia>=pa&&(W.lengths.push(Ia),Ja=Fa)}Z(W.coords,Ja);return W.coords.length?W:null}function Q(W,Y,da,ja,pa,sa,ta){let ya=ja,za=0;for(let oa=sa+da;oa<ta;oa+=da){var la=Y[oa];const va=Y[oa+1],Ca=Y[ta],Fa=Y[ta+1];let Ja=Y[sa],Ka=Y[sa+1],Ia=Ca-Ja,Ma=Fa-Ka;if(0!==Ia||0!==Ma){const Ba=((la-Ja)*Ia+(va-Ka)*Ma)/(Ia*Ia+Ma*Ma);1<Ba?(Ja=Ca,Ka=Fa):0<Ba&&(Ja+=Ia*Ba,Ka+=Ma*Ba)}Ia=la-Ja;Ma=va-Ka;la=Ia*Ia+Ma*Ma;la>ya&&(za=oa,ya=la)}ya>ja&&(za-sa>da&&Q(W,Y,da,ja,pa,sa,za),
pa(W,Y,W.length,za,Y[za],Y[za+1]),ta-za>da&&Q(W,Y,da,ja,pa,za,ta))}function O(W,Y,da,ja,pa){const {coords:sa,lengths:ta}=Y;da=h(da,ja);if(!sa.length)return W!==Y&&V(W),W;B.assertIsSome(pa);const {originPosition:ya,scale:za,translate:la}=pa;pa=ma;pa.originPosition=ya;ja=pa.scale;ja[0]=za[0]??1;ja[1]=-(za[1]??1);ja[2]=za[2]??1;ja[3]=za[3]??1;var oa=pa.translate;oa[0]=la[0]??0;oa[1]=la[1]??0;oa[2]=la[2]??0;oa[3]=la[3]??0;if(!ta.length){for(ja=0;ja<da;++ja)W.coords[ja]=r(pa,sa[ja],ja);W!==Y&&V(W,da,0);
return W}oa=0;for(let Ca=0;Ca<ta.length;Ca++){const Fa=ta[Ca];W.lengths[Ca]=Fa;for(var va=0;va<da;++va)W.coords[oa+va]=r(pa,sa[oa+va],va);va=W.coords[oa];let Ja=W.coords[oa+1];oa+=da;for(let Ka=1;Ka<Fa;Ka++,oa+=da){va+=sa[oa]*ja[0];Ja+=sa[oa+1]*ja[1];W.coords[oa]=va;W.coords[oa+1]=Ja;for(let Ia=2;Ia<da;++Ia)W.coords[oa+Ia]=r(pa,sa[oa+Ia],Ia)}}W!==Y&&V(W,sa.length,ta.length);return W}function R(W,Y,da,ja){let pa=0,sa=W[ja*Y],ta=W[ja*(Y+1)];for(let ya=1;ya<da;ya++){const za=sa+W[ja*(Y+ya)],la=ta+W[ja*
(Y+ya)+1],oa=(za-sa)*(la+ta);sa=za;ta=la;pa+=oa}return.5*pa}function V(W,Y=0,da=0){Z(W.lengths,da);Z(W.coords,Y)}function Z(W,Y=0){W.length!==Y&&(W.length=Y)}const ka=E.getLogger("esri.layers.graphics.featureConversionUtils"),ia={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},wa=(W,Y,da,ja,pa,sa)=>{W[da]=pa;W[da+1]=sa},ea=(W,Y,da,ja,pa,sa)=>{W[da]=pa;W[da+1]=sa;W[da+2]=Y[ja+2]},L=(W,Y,da,ja,pa,sa)=>{W[da]=pa;W[da+1]=sa;W[da+2]=Y[ja+3]},M=(W,Y,da,ja,pa,sa)=>
{W[da]=pa;W[da+1]=sa;W[da+2]=Y[ja+2];W[da+3]=Y[ja+3]},ba=[],ca=[],ma={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};v.convertFromFeature=function(W,Y,da,ja,pa){ba[0]=W;[W]=S(ca,ba,Y,da,ja,pa);Z(ba);Z(ca);return W};v.convertFromFeatureSet=function(W,Y){const da=new x,{hasM:ja,hasZ:pa,features:sa,objectIdFieldName:ta,spatialReference:ya,geometryType:za,exceededTransferLimit:la,transform:oa,fields:va}=W;va&&(da.fields=va);da.geometryType=za??null;da.objectIdFieldName=ta??Y??null;da.spatialReference=
ya??null;if(!da.objectIdFieldName)return ka.error(new t("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),da;sa&&S(da.features,sa,za,pa,ja,da.objectIdFieldName);la&&(da.exceededTransferLimit=la);ja&&(da.hasM=ja);pa&&(da.hasZ=pa);oa&&(da.transform=oa);return da};v.convertFromFeatures=S;v.convertFromGeometry=function(W,Y,da){if(B.isNone(W))return null;const ja=new e;"hasZ"in W&&null==Y&&(Y=W.hasZ);"hasM"in W&&null==da&&(da=W.hasM);if(u.isPoint(W))return p(null!=Y?Y:null!=
W.z,null!=da?da:null!=W.m)(ja,W);if(u.isPolygon(W))return J(ja,W,Y,da);if(u.isPolyline(W))return C(ja,W,h(Y,da));if(u.isMultipoint(W))return H(ja,W,h(Y,da));ka.error("convertFromGeometry:unknown-geometry",new t(`Unable to parse unknown geometry type '${W}'`))};v.convertFromGraphics=function(W,Y,da,ja,pa,sa){const ta=W.length;switch(da){case "esriGeometryPoint":z(W,Y,ja,pa,sa);break;case "esriGeometryMultipoint":G(W,Y,ja,pa,sa);break;case "esriGeometryPolyline":D(W,Y,ja,pa,sa);break;case "esriGeometryPolygon":K(W,
Y,ja,pa,sa);break;default:ka.error("convertToFeatureSet:unknown-geometry",new t(`Unable to parse unknown geometry type '${da}'`))}for(ja=0;ja<Y.length;ja++)W[ja+ta].geometryType=da,W[ja+ta].insertAfter=Y[ja].insertAfter,W[ja+ta].groupId=Y[ja].groupId;return W};v.convertFromMultipoint=H;v.convertFromMultipointFeatures=G;v.convertFromNestedArray=P;v.convertFromPoint=function(W,Y,da=p(null!=Y.z,null!=Y.m)){return da(W,Y)};v.convertFromPointFeatures=z;v.convertFromPolygon=J;v.convertFromPolyline=C;v.convertFromPolylineFeatures=
D;v.convertToFeature=function(W,Y,da,ja){ca[0]=W;ha(ba,ca,Y,da,ja);W=ba[0];Z(ba);Z(ca);return W};v.convertToFeatureSet=function(W){const {objectIdFieldName:Y,spatialReference:da,transform:ja,fields:pa,hasM:sa,hasZ:ta,features:ya,geometryType:za,exceededTransferLimit:la,uniqueIdField:oa,queryGeometry:va,queryGeometryType:Ca}=W;W=ha([],ya,za,ta,sa);const Fa=X(va,Ca,!1,!1);W={features:W,fields:pa,geometryType:za,objectIdFieldName:Y,spatialReference:da,uniqueIdField:oa,queryGeometry:Fa};ja&&(W.transform=
ja);la&&(W.exceededTransferLimit=la);sa&&(W.hasM=sa);ta&&(W.hasZ=ta);return W};v.convertToFeatures=ha;v.convertToGeometry=X;v.convertToMultipoint=y;v.convertToMultipointFeatures=w;v.convertToPoint=function(W,Y,da){return W?Y?da?f(W):b(W):da?g(W):k(W):null};v.convertToPolygon=F;v.convertToPolyline=I;v.deltaDecodeGeometry=function(W,Y){if(B.isNone(W))return null;const da=W.clone(),ja=W.coords;W=W.lengths;let pa=0;for(let ya=0;ya<W.length;ya++){const za=W[ya];var sa=ja[Y*pa],ta=ja[Y*pa+1];for(let la=
1;la<za;la++)sa+=ja[Y*(pa+la)],ta+=ja[Y*(pa+la)+1],da.coords[Y*(pa+la)]=sa,da.coords[Y*(pa+la)+1]=ta;pa+=za}return da};v.deltaEncodeGeometry=function(W,Y){const da=W.clone(),ja=W.coords;W=W.lengths;let pa=0;for(let ta=0;ta<W.length;ta++){const ya=W[ta];let za=ja[Y*pa];var sa=ja[Y*pa+1];for(let la=1;la<ya;la++){const oa=ja[Y*(pa+la)],va=ja[Y*(pa+la)+1];sa=va-sa;da.coords[Y*(pa+la)]=oa-za;da.coords[Y*(pa+la)+1]=sa;za=oa;sa=va}pa+=ya}return da};v.generalizeOptimizedGeometry=function(W,Y,da,ja,pa,sa,
ta=da,ya=ja){V(W);if(!Y||!Y.coords.length)return null;pa=ia[pa];const {coords:za,lengths:la}=Y;Y=h(da,ja);const oa=h(da&&ta,ja&&ya);da=d(da,ja,ta,ya);if(!la.length)return da(W.coords,za,0,0,za[0],za[1]),V(W,Y,0),W;ja=0;sa*=sa;for(const va of la){if(va<pa){ja+=va*Y;continue}ta=W.coords.length/oa;ya=ja;const Ca=ja+(va-1)*Y;da(W.coords,za,W.coords.length,ya,za[ya],za[ya+1]);Q(W.coords,za,Y,sa,da,ya,Ca);da(W.coords,za,W.coords.length,Ca,za[Ca],za[Ca+1]);ya=W.coords.length/oa-ta;ya>=pa?W.lengths.push(ya):
Z(W.coords,ta*oa);ja+=va*Y}return W.coords.length?W:null};v.getBoundsOptimizedGeometry=function(W,Y,da,ja){if(B.isNone(Y)||!Y.coords||!Y.coords.length)return null;da=h(da,ja);let pa=ja=Number.POSITIVE_INFINITY,sa=Number.NEGATIVE_INFINITY,ta=Number.NEGATIVE_INFINITY;if(Y&&Y.coords){Y=Y.coords;for(let ya=0;ya<Y.length;ya+=da){const za=Y[ya],la=Y[ya+1];ja=Math.min(ja,za);sa=Math.max(sa,za);pa=Math.min(pa,la);ta=Math.max(ta,la)}}W[0]=ja;W[1]=pa;W[2]=sa;W[3]=ta;return W};v.getQuantizedArea=function(W,
Y){const {coords:da,lengths:ja}=W;let pa=W=0;for(let sa=0;sa<ja.length;sa++){const ta=ja[sa];pa+=R(da,W,ta,Y);W+=ta}return Math.abs(pa)};v.getQuantizedBoundsOptimizedGeometry=function(W,Y,da,ja){da=h(da,ja);const {lengths:pa,coords:sa}=Y;ja=Y=Number.POSITIVE_INFINITY;let ta=Number.NEGATIVE_INFINITY,ya=Number.NEGATIVE_INFINITY,za=0;for(const la of pa){let oa=sa[za],va=sa[za+1];Y=Math.min(oa,Y);ja=Math.min(va,ja);ta=Math.max(oa,ta);ya=Math.max(va,ya);za+=da;for(let Ca=1;Ca<la;Ca++,za+=da){const Fa=
sa[za],Ja=sa[za+1];oa+=Fa;va+=Ja;0>Fa&&(Y=Math.min(Y,oa));0<Fa&&(ta=Math.max(ta,oa));0>Ja?ja=Math.min(ja,va):0<Ja&&(ya=Math.max(ya,va))}}W[0]=Y;W[1]=ja;W[2]=ta;W[3]=ya;return W};v.getSignedQuantizedRingArea=R;v.quantizeOptimizedFeatureSet=function(W,Y){const {geometryType:da,features:ja,hasM:pa,hasZ:sa}=Y;if(!W)return Y;for(let ta=0;ta<ja.length;ta++){const ya=ja[ta],za=ya.weakClone();za.geometry=new e;U(za.geometry,ya.geometry,pa,sa,da,W);ya.centroid&&(za.centroid=new e,U(za.centroid,ya.centroid,
pa,sa,"esriGeometryPoint",W));ja[ta]=za}Y.transform=W;return Y};v.quantizeOptimizedGeometry=U;v.quantizeX=l;v.quantizeY=m;v.removeCollinearVectices=function(W,Y,da,ja,pa){if(!Y||!Y.coords||!Y.coords.length)return null;da=ia[da];const {coords:sa,lengths:ta}=Y;Y=d(ja,pa,ja,pa);ja=h(ja,pa);let ya=pa=0,za=0,la=0;for(const Ca of ta){ya=la;Y(W.coords,sa,ya,pa,sa[pa],sa[pa+1]);pa+=ja;var oa=sa[pa];let Fa=sa[pa+1],Ja=oa,Ka=Fa;var va=Fa/oa;ya+=ja;Y(W.coords,sa,ya,pa,Ja,Ka);pa+=ja;for(let Ia=2;Ia<Ca;Ia++){oa=
sa[pa];Fa=sa[pa+1];const Ma=Fa/oa,Ba=va===Ma||!isFinite(va)&&!isFinite(Ma);va=Ba&&isFinite(Ma)?0<=va&&0<=Ma||0>=va&&0>=Ma:0<=Ka&&0<=Fa||0>=Ka&&0>=Fa;Ba&&va?(Ja+=oa,Ka+=Fa):(Ja=oa,Ka=Fa,ya+=ja);Y(W.coords,sa,ya,pa,Ja,Ka);pa+=ja;va=Ma}ya+=ja;oa=(ya-la)/ja;oa>=da&&(W.lengths[za]=oa,la=ya,za++)}W.coords.length>la&&(W.coords.length=la);W.lengths.length>za&&(W.lengths.length=za);return W.coords.length&&W.lengths.length?W:null};v.removeZMValues=function(W,Y,da,ja,pa,sa){V(W);W.lengths.push(...Y.lengths);
if(da===pa&&ja===sa)for(var ta=0;ta<Y.coords.length;ta++)W.coords.push(Y.coords[ta]);else for(ta=h(da,ja),da=d(da,ja,pa,sa),Y=Y.coords,ja=0;ja<Y.length;ja+=ta)da(W.coords,Y,W.coords.length,ja,Y[ja],Y[ja+1]);return W};v.unquantizeOptimizedFeatureSet=function(W){const {transform:Y,features:da,hasM:ja,hasZ:pa}=W;if(!Y)return W;for(const sa of da)B.isSome(sa.geometry)&&O(sa.geometry,sa.geometry,ja,pa,Y),B.isSome(sa.centroid)&&O(sa.centroid,sa.centroid,ja,pa,Y);W.transform=null;return W};v.unquantizeOptimizedGeometry=
O;v.unquantizeValue=r;v.unquantizeX=function(W,Y){return r(W,Y,0)};v.unquantizeY=function(W,Y){return r(W,-Y,1)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(v,t,E){let B=function(){function A(x=null,e={},h,d){this.geometry=x;this.attributes=e;this.centroid=h;this.objectId=d;this.geohashY=this.geohashX=this.displayId=
0}A.prototype.weakClone=function(){const x=new A(this.geometry,this.attributes,this.centroid,this.objectId);x.displayId=this.displayId;x.geohashX=this.geohashX;x.geohashY=this.geohashY;return x};return A}(),u=function(A){function x(){return A.apply(this,arguments)||this}t._inheritsLoose(x,A);return x}(B);v.OptimizedFeature=B;v.OptimizedFeatureWithGeometry=u;v.hasGeometry=function(A){return!(E.isNone(A.geometry)||!A.geometry.coords||!A.geometry.coords.length)};Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){return function(){function v(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}v.prototype.weakClone=function(){const t=new v;
t.objectIdFieldName=this.objectIdFieldName;t.globalIdFieldName=this.globalIdFieldName;t.geohashFieldName=this.geohashFieldName;t.geometryProperties=this.geometryProperties;t.geometryType=this.geometryType;t.spatialReference=this.spatialReference;t.hasZ=this.hasZ;t.hasM=this.hasM;t.features=this.features;t.fields=this.fields;t.transform=this.transform;t.exceededTransferLimit=this.exceededTransferLimit;t.uniqueIdField=this.uniqueIdField;t.queryGeometry=this.queryGeometry;t.queryGeometryType=this.queryGeometryType;
return t};return v}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(v){return function(){function t(B=[],u=[],A=!1){this.lengths=B??[];this.coords=u??[];this.hasIndeterminateRingOrder=A}t.fromRect=function(B){const [u,A,x,e]=B;B=x-u;const h=e-A;return new t([5],[u,A,B,0,0,h,-B,0,0,-h])};var E=t.prototype;E.forEachVertex=function(B){let u=0;this.lengths.length||B(this.coords[0],this.coords[1]);for(let A=0;A<this.lengths.length;A++){const x=
this.lengths[A];for(let e=0;e<x;e++)B(this.coords[2*(e+u)],this.coords[2*(e+u)+1]);u+=x}};E.clone=function(B){return B?(B.set(this.coords),new t(this.lengths.slice(),B,this.hasIndeterminateRingOrder)):new t(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};v._createClass(t,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},{key:"size",get:function(){return this.lengths.reduce((B,u)=>B+u)}}]);return t}()})},
"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z,w,y){function G(J){return J.every(P=>"exceedslimit"!==P.statisticType)}const H=new x.MemCacheStorage(2E6);let I=0,D=function(){function J(S){this.capabilities={query:g.queryCapabilities};this.geometryType=S.geometryType;this.hasM=S.hasM;this.hasZ=S.hasZ;this.objectIdField=S.objectIdField;this.spatialReference=S.spatialReference;this.definitionExpression=S.definitionExpression;this.featureStore=S.featureStore;this.aggregateAdapter=S.aggregateAdapter;
this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=S.timeInfo;S.cacheSpatialQueries&&(this._geometryQueryCache=new x.MemCache(I++ +"$$",H));this.fieldsIndex=new z(S.fields);S.scheduler&&S.priority&&(this._frameTask=S.scheduler.registerTask(S.priority))}var P=J.prototype;P.destroy=function(){this._frameTask=A.removeMaybe(this._frameTask);this.clearCache();A.destroyMaybe(this._geometryQueryCache);this._changeHandle=A.removeMaybe(this._changeHandle);A.destroyMaybe(this.fieldsIndex)};
P.clearCache=function(){this._geometryQueryCache?.clear();this._timeExtent=this._allItems=null};P.executeQuery=function(){var S=t._asyncToGenerator(function*(X,ha){try{return(yield this._executeQuery(X,{},ha)).createQueryResponse()}catch(U){if(U!==p.QUERY_ENGINE_EMPTY_RESULT)throw U;return(new n.QueryEngineResult([],X,this)).createQueryResponse()}});return function(X,ha){return S.apply(this,arguments)}}();P.executeQueryForCount=function(){var S=t._asyncToGenerator(function*(X={},ha){try{return(yield this._executeQuery(X,
{returnGeometry:!1,returnCentroid:!1,outSR:null},ha)).createQueryResponseForCount()}catch(U){if(U!==p.QUERY_ENGINE_EMPTY_RESULT)throw U;return 0}});return function(){return S.apply(this,arguments)}}();P.executeQueryForExtent=function(){var S=t._asyncToGenerator(function*(X,ha){const U=X.outSR;try{const Q=yield this._executeQuery(X,{returnGeometry:!0,returnCentroid:!1,outSR:null},ha),O=Q.size;if(!O)return{count:0,extent:null};h.set(F,h.NEGATIVE_INFINITY);this.featureStore.forEachBounds(Q.items,Z=>
h.expandWithAABB(F,Z),C);const R={xmin:F[0],ymin:F[1],xmax:F[3],ymax:F[4],spatialReference:p.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(F[2])&&isFinite(F[5])&&(R.zmin=F[2],R.zmax=F[5]);const V=a.project(R,Q.spatialReference,U);V.spatialReference=p.cleanFromGeometryEngine(U||this.spatialReference);if(0===V.xmax-V.xmin){const Z=e.getMetersPerUnitForSR(V.spatialReference);V.xmin-=Z;V.xmax+=Z}if(0===V.ymax-V.ymin){const Z=e.getMetersPerUnitForSR(V.spatialReference);V.ymin-=Z;
V.ymax+=Z}if(this.hasZ&&null!=V.zmin&&null!=V.zmax&&0===V.zmax-V.zmin){const Z=e.getMetersPerUnitForSR(V.spatialReference);V.zmin-=Z;V.zmax+=Z}return{count:O,extent:V}}catch(Q){if(Q===p.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw Q;}});return function(X,ha){return S.apply(this,arguments)}}();P.executeQueryForIds=function(){var S=t._asyncToGenerator(function*(X,ha){return this.executeQueryForIdSet(X,ha).then(U=>Array.from(U))});return function(X,ha){return S.apply(this,arguments)}}();
P.executeQueryForIdSet=function(){var S=t._asyncToGenerator(function*(X,ha){try{const U=yield this._executeQuery(X,{returnGeometry:!0,returnCentroid:!1,outSR:null},ha),Q=U.items,O=new Set;yield this._reschedule(()=>{for(const R of Q)O.add(U.featureAdapter.getObjectId(R))},ha);return O}catch(U){if(U===p.QUERY_ENGINE_EMPTY_RESULT)return new Set;throw U;}});return function(X,ha){return S.apply(this,arguments)}}();P.executeQueryForSnapping=function(){var S=t._asyncToGenerator(function*(X,ha){const {point:U,
distance:Q,types:O}=X;if(O===n.SnappingTypes.NONE)return{candidates:[]};const R=yield this._reschedule(()=>this._checkQuerySupport(X.query),ha),V=!k.equals(U.spatialReference,this.spatialReference);V&&(yield a.checkProjectionSupport(U.spatialReference,this.spatialReference));var Z="number"===typeof Q?Q:Q.x,ka="number"===typeof Q?Q:Q.y;Z={xmin:U.x-Z,xmax:U.x+Z,ymin:U.y-ka,ymax:U.y+ka,spatialReference:U.spatialReference};Z=V?a.project(Z,this.spatialReference):Z;if(!Z)return{candidates:[]};ka=(yield r.normalizeCentralMeridian(m.fromJSON(U),
null,{signal:ha}))[0];const ia=(yield r.normalizeCentralMeridian(m.fromJSON(Z),null,{signal:ha}))[0];if(A.isNone(ka)||A.isNone(ia))return{candidates:[]};const wa=new n.QueryEngineResult(this._searchFeatures(this._getQueryBBoxes(ia.toJSON())),R,this);yield this._reschedule(()=>this._executeObjectIdsQuery(wa),ha);yield this._reschedule(()=>this._executeTimeQuery(wa),ha);yield this._reschedule(()=>this._executeAttributesQuery(wa),ha);ha=ka.toJSON();ha=V?a.project(ha,this.spatialReference):ha;return wa.createSnappingResponse({...X,
point:ha,distance:V?Math.max(Z.xmax-Z.xmin,Z.ymax-Z.ymin)/2:Q},U.spatialReference)});return function(X,ha){return S.apply(this,arguments)}}();P.executeQueryForLatestObservations=function(){var S=t._asyncToGenerator(function*(X,ha){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new B("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:X,timeInfo:this.timeInfo});try{const U=yield this._executeQuery(X,{},ha);yield this._reschedule(()=>this._filterLatest(U),ha);
return U.createQueryResponse()}catch(U){if(U!==p.QUERY_ENGINE_EMPTY_RESULT)throw U;return(new n.QueryEngineResult([],X,this)).createQueryResponse()}});return function(X,ha){return S.apply(this,arguments)}}();P.executeQueryForSummaryStatistics=function(){var S=t._asyncToGenerator(function*(X={},ha,U){const {field:Q,normalizationField:O,valueExpression:R}=ha;return(yield this._getQueryEngineResultForStats(X,{field:Q,normalizationField:O,valueExpression:R},U)).createSummaryStatisticsResponse(ha)});return function(){return S.apply(this,
arguments)}}();P.executeQueryForUniqueValues=function(){var S=t._asyncToGenerator(function*(X={},ha,U){const {field:Q,field2:O,field3:R,valueExpression:V}=ha;return(yield this._getQueryEngineResultForStats(X,{field:Q,field2:O,field3:R,valueExpression:V},U)).createUniqueValuesResponse(ha)});return function(){return S.apply(this,arguments)}}();P.executeQueryForClassBreaks=function(){var S=t._asyncToGenerator(function*(X={},ha,U){const {field:Q,normalizationField:O,valueExpression:R}=ha;return(yield this._getQueryEngineResultForStats(X,
{field:Q,normalizationField:O,valueExpression:R},U)).createClassBreaksResponse(ha)});return function(){return S.apply(this,arguments)}}();P.executeQueryForHistogram=function(){var S=t._asyncToGenerator(function*(X={},ha,U){const {field:Q,normalizationField:O,valueExpression:R}=ha;return(yield this._getQueryEngineResultForStats(X,{field:Q,normalizationField:O,valueExpression:R},U)).createHistogramResponse(ha)});return function(){return S.apply(this,arguments)}}();P._schedule=function(){var S=t._asyncToGenerator(function*(X,
ha){return A.isSome(this._frameTask)?this._frameTask.schedule(X,ha):X(y.noBudget)});return function(X,ha){return S.apply(this,arguments)}}();P._reschedule=function(){var S=t._asyncToGenerator(function*(X,ha){return A.isSome(this._frameTask)?this._frameTask.reschedule(X,ha):X(y.noBudget)});return function(X,ha){return S.apply(this,arguments)}}();P._getAll=function(S){A.isNone(this._allItems)&&(this._allItems=this.featureStore.toArray());return new n.QueryEngineResult(this._allItems,S,this)};P._executeQuery=
function(){var S=t._asyncToGenerator(function*(X,ha,U){X=u.clone(X);X=yield this._schedule(()=>p.normalizeQuery(X,this.definitionExpression,this.spatialReference),U);X=yield this._reschedule(()=>this._checkQuerySupport(X),U);X={...X,...ha};const Q=yield this._reschedule(()=>this._executeSceneFilterQuery(X,U),U),O=yield this._reschedule(()=>this._executeGeometryQuery(X,Q,U),U);yield this._reschedule(()=>this._executeAggregateIdsQuery(O),U);yield this._reschedule(()=>this._executeObjectIdsQuery(O),
U);yield this._reschedule(()=>this._executeTimeQuery(O),U);yield this._reschedule(()=>this._executeAttributesQuery(O),U);return O});return function(X,ha,U){return S.apply(this,arguments)}}();P._executeSceneFilterQuery=function(){var S=t._asyncToGenerator(function*(X,ha){var U=this;if(A.isNone(X.sceneFilter))return null;const {outSR:Q,returnGeometry:O,returnCentroid:R}=X;var V=this.featureStore.featureSpatialReference,Z=X.sceneFilter.geometry;const ka=A.isNone(V)||k.equals(V,Z.spatialReference)?Z:
a.project(Z,V);if(!ka)return null;V=O||R;V=k.isValid(Q)&&!k.equals(this.spatialReference,Q)&&V?function(){var L=t._asyncToGenerator(function*(M){return U._project(M,Q)});return function(M){return L.apply(this,arguments)}}():L=>L;const ia=this.featureAdapter;Z=this._searchFeatures(this._getQueryBBoxes(ka));if("disjoint"===X.sceneFilter.spatialRelationship){if(!Z.length)return null;const L=new Set;for(var wa of Z)L.add(ia.getObjectId(wa));const M=yield this._reschedule(()=>this.featureStore.toArray(),
ha);wa=yield this._reschedule(t._asyncToGenerator(function*(){const ba=yield f.getSpatialQueryOperator("esriSpatialRelDisjoint",ka,U.geometryType,U.hasZ,U.hasM),ca=yield U._runSpatialFilter(M,ma=>!L.has(ia.getObjectId(ma))||ba(ia.getGeometry(ma)),ha);return new n.QueryEngineResult(ca,X,U)}),ha);return V(wa)}if(!Z.length)return new n.QueryEngineResult([],X,this);if(this._canExecuteSinglePass(ka,X))return V(new n.QueryEngineResult(Z,X,this));const ea=yield f.getSpatialQueryOperator("esriSpatialRelContains",
ka,this.geometryType,this.hasZ,this.hasM);wa=yield this._runSpatialFilter(Z,L=>ea(ia.getGeometry(L)),ha);return V(new n.QueryEngineResult(wa,X,this))});return function(X,ha){return S.apply(this,arguments)}}();P._executeGeometryQuery=function(){var S=t._asyncToGenerator(function*(X,ha,U){var Q=this;if(A.isSome(ha)&&0===ha.items.length)return ha;X=A.isSome(ha)?ha.query:X;const {geometry:O,outSR:R,spatialRel:V,returnGeometry:Z,returnCentroid:ka}=X;var ia=this.featureStore.featureSpatialReference;const wa=
!O||A.isNone(ia)||k.equals(ia,O.spatialReference)?O:a.project(O,ia),ea=Z||ka,L=k.isValid(R)&&!k.equals(this.spatialReference,R),M=this._geometryQueryCache&&A.isNone(ha)?L&&ea?JSON.stringify({originalFilterGeometry:O,spatialRelationship:V,outSpatialReference:R}):JSON.stringify({originalFilterGeometry:O,spatialRelationship:V}):null;ia=M?this._geometryQueryCache.get(M):null;if(A.isSome(ia))return new n.QueryEngineResult(ia,X,this);ia=function(){var Y=t._asyncToGenerator(function*(da){L&&ea&&(yield Q._project(da,
R));M&&Q._geometryQueryCache.put(M,da.items,da.items.length+1);return da});return function(da){return Y.apply(this,arguments)}}();if(!wa)return ia(A.isSome(ha)?ha:this._getAll(X));const ba=this.featureAdapter;let ca=this._searchFeatures(this._getQueryBBoxes(O));if("esriSpatialRelDisjoint"===V){if(!ca.length)return ia(A.isSome(ha)?ha:this._getAll(X));const Y=new Set;for(var ma of ca)Y.add(ba.getObjectId(ma));const da=A.isSome(ha)?ha.items:yield this._reschedule(()=>this.featureStore.toArray(),U);ma=
yield this._reschedule(t._asyncToGenerator(function*(){const ja=yield f.getSpatialQueryOperator(V,wa,Q.geometryType,Q.hasZ,Q.hasM),pa=yield Q._runSpatialFilter(da,sa=>!Y.has(ba.getObjectId(sa))||ja(ba.getGeometry(sa)),U);return new n.QueryEngineResult(pa,X,Q)}),U);return ia(ma)}if(A.isSome(ha)){const Y=new E.PositionHint;ca=ca.filter(da=>0<=E.indexOf(ha.items,da,ha.items.length,Y))}if(!ca.length)return ia=new n.QueryEngineResult([],X,this),M&&this._geometryQueryCache.put(M,ia.items,1),ia;if(this._canExecuteSinglePass(wa,
X))return ia(new n.QueryEngineResult(ca,X,this));const W=yield f.getSpatialQueryOperator(V,wa,this.geometryType,this.hasZ,this.hasM);ma=yield this._runSpatialFilter(ca,Y=>W(ba.getGeometry(Y)),U);return ia(new n.QueryEngineResult(ma,X,this))});return function(X,ha,U){return S.apply(this,arguments)}}();P._executeAggregateIdsQuery=function(S){if(0!==S.items.length&&S.query.aggregateIds&&S.query.aggregateIds.length&&!A.isNone(this.aggregateAdapter)){var X=new Set;for(const U of S.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(U).forEach(Q=>
X.add(Q));var ha=this.featureAdapter.getObjectId;S.items=S.items.filter(U=>X.has(ha(U)))}};P._executeObjectIdsQuery=function(S){if(0!==S.items.length&&S.query.objectIds&&S.query.objectIds.length){var X=new Set(S.query.objectIds),ha=this.featureAdapter.getObjectId;S.items=S.items.filter(U=>X.has(ha(U)))}};P._executeTimeQuery=function(S){if(0!==S.items.length){var X=q.getTimeOperator(this.timeInfo,S.query.timeExtent,this.featureAdapter);A.isNone(X)||(S.items=S.items.filter(X))}};P._executeAttributesQuery=
function(S){if(0!==S.items.length){var X=b.getWhereClause(S.query.where,this.fieldsIndex);if(X){if(!X.isStandardized)throw new TypeError("Where clause is not standardized");S.items=S.items.filter(ha=>X.testFeature(ha,this.featureAdapter))}}};P._runSpatialFilter=function(){var S=t._asyncToGenerator(function*(X,ha,U){var Q=this;if(!ha)return X;if(A.isNone(this._frameTask))return X.filter(Z=>ha(Z));let O=0;const R=[],V=function(){var Z=t._asyncToGenerator(function*(ka){for(;O<X.length;){const ia=X[O++];
ha(ia)&&(R.push(ia),ka.madeProgress());ka.done&&(yield Q._reschedule(wa=>V(wa),U))}});return function(ka){return Z.apply(this,arguments)}}();return this._reschedule(Z=>V(Z),U).then(()=>R)});return function(X,ha,U){return S.apply(this,arguments)}}();P._filterLatest=function(S){const {trackIdField:X,startTimeField:ha,endTimeField:U}=this.timeInfo,Q=U||ha,O=new Map,R=this.featureAdapter.getAttribute;for(const V of S.items){const Z=R(V,X),ka=R(V,Q),ia=O.get(Z);(!ia||ka>R(ia,Q))&&O.set(Z,V)}S.items=Array.from(O.values())};
P._canExecuteSinglePass=function(S,X){({spatialRel:X}=X);return f.canQueryWithRBush(S)&&("esriSpatialRelEnvelopeIntersects"===X||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===X||"esriSpatialRelContains"===X||"esriSpatialRelWithin"===X))};P._project=function(){var S=t._asyncToGenerator(function*(X,ha){if(!ha||k.equals(this.spatialReference,ha))return X;const U=this.featureAdapter;ha=yield a.projectMany(X.items.map(Q=>p.getGeometry(this.geometryType,this.hasZ,this.hasM,U.getGeometry(Q))),
this.spatialReference,ha);X.items=ha.map((Q,O)=>U.cloneWithGeometry(X.items[O],c.convertFromGeometry(Q,this.hasZ,this.hasM)));return X});return function(X,ha){return S.apply(this,arguments)}}();P._getQueryBBoxes=function(S){if(f.canQueryWithRBush(S)){if(m.isExtent(S))return[d.fromValues(S.xmin,S.ymin,S.xmax,S.ymax)];if(m.isPolygon(S))return S.rings.map(X=>d.fromValues(Math.min(X[0][0],X[2][0]),Math.min(X[0][1],X[2][1]),Math.max(X[0][0],X[2][0]),Math.max(X[0][1],X[2][1])))}return[l.getBoundsXY(d.create(),
S)]};P._searchFeatures=function(S){for(const X of S)this.featureStore.forEachInBounds(X,ha=>K.add(ha));S=Array.from(K.values());K.clear();return S};P._checkStatisticsSupport=function(){var S=t._asyncToGenerator(function*(X,ha){if(0>X.distance||null!=X.geometryPrecision||X.multipatchOption||X.pixelSize||X.relationParam||X.text||X.outStatistics||X.groupByFieldsForStatistics||X.having||X.orderByFields)throw new B("feature-store:unsupported-query","Unsupported query options",{query:X});this._checkAttributesQuerySupport(X);
return Promise.all([this._checkStatisticsParamsSupport(ha),f.checkSpatialQuerySupport(X,this.geometryType,this.spatialReference),a.checkProjectionSupport(this.spatialReference,X.outSR)]).then(()=>X)});return function(X,ha){return S.apply(this,arguments)}}();P._checkStatisticsParamsSupport=function(){var S=t._asyncToGenerator(function*(X){var ha=[];X.valueExpression&&({arcadeUtils:ha}=yield w.loadArcade(),ha=ha.extractFieldNames(X.valueExpression));X.field&&ha.push(X.field);X.field2&&ha.push(X.field2);
X.field3&&ha.push(X.field3);X.normalizationField&&ha.push(X.normalizationField);if(!ha.length)throw new B("feature-store:unsupported-query","params should have at least a field or valueExpression",{params:X});b.validateFields(this.fieldsIndex,ha,"params contains missing fields")});return function(X){return S.apply(this,arguments)}}();P._checkQuerySupport=function(){var S=t._asyncToGenerator(function*(X){if(0>X.distance||null!=X.geometryPrecision||X.multipatchOption||X.pixelSize||X.relationParam||
X.text)throw new B("feature-store:unsupported-query","Unsupported query options",{query:X});this._checkAttributesQuerySupport(X);this._checkStatisticsQuerySupport(X);return Promise.all([f.checkSpatialQuerySupport(X,this.geometryType,this.spatialReference),a.checkProjectionSupport(this.spatialReference,X.outSR)]).then(()=>X)});return function(X){return S.apply(this,arguments)}}();P._checkAttributesQuerySupport=function(S){const {outFields:X,orderByFields:ha,returnDistinctValues:U,outStatistics:Q}=
S,O=Q?Q.map(R=>R.outStatisticFieldName&&R.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(ha&&0<ha.length){const R=ha.map(V=>{const Z=V.toLowerCase();return Z.includes(" asc")?Z.split(" asc")[0]:Z.includes(" desc")?Z.split(" desc")[0]:V}).filter(V=>!O.includes(V));b.validateFields(this.fieldsIndex,R,"orderByFields contains missing fields")}if(X&&0<X.length)b.validateFields(this.fieldsIndex,X,"outFields contains missing fields");else if(U)throw new B("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",
{query:S});b.validateWhere(this.fieldsIndex,S.where)};P._checkStatisticsQuerySupport=function(S){const {outStatistics:X,groupByFieldsForStatistics:ha,having:U}=S;var Q=ha&&ha.length,O=X&&X.length;if(U){if(!Q||!O)throw new B("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:S});b.validateHaving(this.fieldsIndex,U,X)}if(O&&G(X)){O=X.map(R=>R.onStatisticField).filter(Boolean);b.validateFields(this.fieldsIndex,O,"onStatisticFields contains missing fields");
Q&&b.validateFields(this.fieldsIndex,ha,"groupByFieldsForStatistics contains missing fields");for(const R of X){const {onStatisticField:V,statisticType:Z}=R;if(("percentile_disc"===Z||"percentile_cont"===Z)&&"statisticParameters"in R){if({statisticParameters:Q}=R,!Q)throw new B("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:R,query:S});}else if("count"!==Z&&V&&b.hasInvalidFieldType(V,this.fieldsIndex))throw new B("feature-store:unsupported-query",
"outStatistics contains non-numeric fields",{definition:R,query:S});}}};P._getQueryEngineResultForStats=function(){var S=t._asyncToGenerator(function*(X,ha,U){X=u.clone(X);try{X=yield this._schedule(()=>p.normalizeQuery(X,this.definitionExpression,this.spatialReference),U);X=yield this._reschedule(()=>this._checkStatisticsSupport(X,ha),U);const Q=yield this._reschedule(()=>this._executeSceneFilterQuery(X,U),U),O=yield this._reschedule(()=>this._executeGeometryQuery(X,Q,U),U);yield this._reschedule(()=>
this._executeAggregateIdsQuery(O),U);yield this._reschedule(()=>this._executeObjectIdsQuery(O),U);yield this._reschedule(()=>this._executeTimeQuery(O),U);yield this._reschedule(()=>this._executeAttributesQuery(O),U);return O}catch(Q){if(Q!==p.QUERY_ENGINE_EMPTY_RESULT)throw Q;return new n.QueryEngineResult([],X,this)}});return function(X,ha,U){return S.apply(this,arguments)}}();t._createClass(J,[{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){const S=
this.featureStore.fullBounds;return A.isNone(S)?null:{xmin:S[0],ymin:S[1],xmax:S[2],ymax:S[3],spatialReference:p.cleanFromGeometryEngine(this.spatialReference)}}},{key:"timeExtent",get:function(){if(!this.timeInfo)return null;this._timeExtent||(this._timeExtent=q.getTimeExtent(this.timeInfo,this.featureStore));return this._timeExtent}}]);return J}();const C=h.create(),F=h.create(),K=new Set;v.Feature=function(J,P=null,S,X,ha){this.attributes=J;this.geometry=S;this.centroid=X;this.filterFlags=ha;this.groupId=
-1;this.displayId=P};v.QueryEngine=D;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./maybe","./PooledArray"],function(v,t,E,B){v.RemoveMode=void 0;(function(x){x[x.ALL=0]="ALL";x[x.SOME=1]="SOME"})(v.RemoveMode||(v.RemoveMode={}));let u=function(){function x(h,d,l){this._namespace=h;this._storage=d;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);
this._namespace+=":";l&&(this._storage.registerRemoveFunc(this._namespace,l),this._removeFunc=!0)}var e=x.prototype;e.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this);this._storage=null};e.resetHitRate=function(){this._hit=this._miss=0};e.put=function(h,d,l,m=0){this._storage.put(this._namespace+h,d,l,m)};e.get=function(h){h=this._storage.get(this._namespace+h);void 0===h?++this._miss:++this._hit;
return h};e.pop=function(h){h=this._storage.pop(this._namespace+h);void 0===h?++this._miss:++this._hit;return h};e.updateSize=function(h,d,l){this._storage.updateSize(this._namespace+h,d,l)};e.clear=function(){this._storage.clear(this._namespace)};e.clearAll=function(){this._storage.clearAll()};e.getStats=function(){return this._storage.getStats()};e.resetStats=function(){this._storage.resetStats()};t._createClass(x,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",
get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}}]);return x}(),A=function(){function x(h=10485760){this._maxSize=h;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new B;this._users=new B}var e=x.prototype;e.destroy=function(){this.clearAll();this._removeFuncs.clear();this._users.clear();this._db=null};e.register=function(h){this._users.push(h)};e.deregister=
function(h){this._users.removeUnordered(h)};e.registerRemoveFunc=function(h,d){this._removeFuncs.push([h,d])};e.deregisterRemoveFunc=function(h){this._removeFuncs.filterInPlace(d=>d[0]!==h)};e.put=function(h,d,l,m){const r=this._db.get(h);r&&(this._size-=r.size,this._db.delete(h),r.entry!==d&&this._notifyRemove(h,r.entry,v.RemoveMode.ALL));l>this._maxSize?this._notifyRemove(h,d,v.RemoveMode.ALL):void 0===d?console.warn("Refusing to cache undefined entry "):!l||0>l?console.warn("Refusing to cache entry with invalid size "+
l):(m=1+Math.max(m,-3)- -3,this._db.set(h,{entry:d,size:l,lifetime:m,lives:m}),this._size+=l,this._checkSizeLimit())};e.updateSize=function(h,d,l){const m=this._db.get(h);if(m&&m.entry===d){for(this._size-=m.size;l>this._maxSize;)if(l=this._notifyRemove(h,d,v.RemoveMode.SOME),!(E.isSome(l)&&0<l)){this._db.delete(h);return}m.size=l;this._size+=l;this._checkSizeLimit()}};e.pop=function(h){const d=this._db.get(h);if(d)return this._size-=d.size,this._db.delete(h),++this._hit,d.entry;++this._miss};e.get=
function(h){const d=this._db.get(h);if(void 0===d)++this._miss;else return this._db.delete(h),d.lives=d.lifetime,this._db.set(h,d),++this._hit,d.entry};e.getStats=function(){const h={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},d={},l=[];this._db.forEach((k,c)=>{const b=k.lifetime;l[b]=(l[b]||0)+k.size;this._users.forAll(a=>{a=a.namespace;c.startsWith(a)&&(d[a]=(d[a]||0)+k.size)})});
const m={};this._users.forAll(k=>{const c=k.namespace;!isNaN(k.hitRate)&&0<k.hitRate?(d[c]=d[c]||0,m[c]=Math.round(100*k.hitRate)+"%"):m[c]="0%"});var r=Object.keys(d);r.sort((k,c)=>d[c]-d[k]);r.forEach(k=>h[k]=Math.round(d[k]/2**20)+"MB / "+m[k]);for(r=l.length-1;0<=r;--r){const k=l[r];k&&(h["Priority "+(r+-3-1)]=Math.round(k/this.size*100)+"%")}return h};e.resetStats=function(){this._hit=this._miss=0;this._users.forAll(h=>h.resetHitRate())};e.clear=function(h){this._db.forEach((d,l)=>{l.startsWith(h)&&
(this._size-=d.size,this._db.delete(l),this._notifyRemove(l,d.entry,v.RemoveMode.ALL))})};e.clearAll=function(){this._db.forEach((h,d)=>this._notifyRemove(d,h.entry,v.RemoveMode.ALL));this._size=0;this._db.clear()};e._getHitRate=function(){return this._hit/(this._hit+this._miss)};e._notifyRemove=function(h,d,l){let m;this._removeFuncs.some(r=>h.startsWith(r[0])?(r=r[1](d,l),"number"===typeof r&&(m=r),!0):!1);return m};e._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [h,d]of this._db){this._db.delete(h);
if(1>=d.lives){this._size-=d.size;const l=this._notifyRemove(h,d.entry,v.RemoveMode.SOME);E.isSome(l)&&0<l&&(this._size+=l,d.lives=d.lifetime,d.size=l,this._db.set(h,d))}else--d.lives,this._db.set(h,d);if(this._size<=.9*this.maxSize)break}};t._createClass(x,[{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(h){this._maxSize=Math.max(h,0);this._checkSizeLimit()}}]);return x}();v.MIN_PRIORITY=-3;v.MemCache=u;v.MemCacheStorage=A;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../../core/maybe","../Extent","./aaBoundingRect"],function(v,t,E,B){function u(b=k){return[b[0],b[1],b[2],b[3],b[4],b[5]]}function A(b,a,g,n,f,q,p=u()){p[0]=b;p[1]=a;p[2]=g;p[3]=n;p[4]=f;p[5]=q;return p}function x(b){return b[0]>=b[3]?0:b[3]-b[0]}function e(b){return b[1]>=b[4]?0:b[4]-b[1]}function h(b){return b[2]>=b[5]?0:b[5]-b[2]}function d(b,a){return Math.max(a[0],
b[0])<=Math.min(a[3],b[3])&&Math.max(a[1],b[1])<=Math.min(a[4],b[4])&&Math.max(a[2],b[2])<=Math.min(a[5],b[5])}function l(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b}function m(b){return 6===b.length}const r=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],k=[0,0,0,0,0,0],c=u();v.NEGATIVE_INFINITY=r;v.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];v.ZERO=k;v.allFinite=function(b){for(let a=0;6>a;a++)if(!isFinite(b[a]))return!1;
return!0};v.center=function(b,a=[0,0,0]){a[0]=b[0]+x(b)/2;a[1]=b[1]+e(b)/2;a[2]=b[2]+h(b)/2;return a};v.contains=function(b,a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[3]<=b[3]&&a[4]<=b[4]&&a[5]<=b[5]};v.containsPoint=function(b,a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[0]<=b[3]&&a[1]<=b[4]&&a[2]<=b[5]};v.containsPointWithMargin=function(b,a,g){return a[0]>=b[0]-g&&a[1]>=b[1]-g&&a[2]>=b[2]-g&&a[0]<=b[3]+g&&a[1]<=b[4]+g&&a[2]<=b[5]+g};v.create=u;v.depth=e;v.diameter=function(b){const a=x(b),
g=h(b);b=e(b);return Math.sqrt(a*a+g*g+b*b)};v.empty=function(b){return b?l(b,r):u(r)};v.equals=function(b,a,g){if(t.isNone(b)||t.isNone(a))return b===a;if(!m(b)||!m(a))return!1;if(g)for(let n=0;n<b.length;n++){if(!g(b[n],a[n]))return!1}else for(g=0;g<b.length;g++)if(b[g]!==a[g])return!1;return!0};v.expandWithAABB=function(b,a){b[0]=Math.min(b[0],a[0]);b[1]=Math.min(b[1],a[1]);b[2]=Math.min(b[2],a[2]);b[3]=Math.max(b[3],a[3]);b[4]=Math.max(b[4],a[4]);b[5]=Math.max(b[5],a[5])};v.expandWithBuffer=function(b,
a,g=0,n=a.length/3){let f=b[0],q=b[1],p=b[2],z=b[3],w=b[4],y=b[5];for(let G=0;G<n;G++)f=Math.min(f,a[g+3*G]),q=Math.min(q,a[g+3*G+1]),p=Math.min(p,a[g+3*G+2]),z=Math.max(z,a[g+3*G]),w=Math.max(w,a[g+3*G+1]),y=Math.max(y,a[g+3*G+2]);b[0]=f;b[1]=q;b[2]=p;b[3]=z;b[4]=w;b[5]=y};v.expandWithNestedArray=function(b,a,g){const n=a.length;let f=b[0],q=b[1],p=b[2],z=b[3],w=b[4],y=b[5];if(g)for(g=0;g<n;g++){var G=a[g];f=Math.min(f,G[0]);q=Math.min(q,G[1]);p=Math.min(p,G[2]);z=Math.max(z,G[0]);w=Math.max(w,G[1]);
y=Math.max(y,G[2])}else for(g=0;g<n;g++)G=a[g],f=Math.min(f,G[0]),q=Math.min(q,G[1]),z=Math.max(z,G[0]),w=Math.max(w,G[1]);b[0]=f;b[1]=q;b[2]=p;b[3]=z;b[4]=w;b[5]=y};v.expandWithOffset=function(b,a,g,n){b[0]=Math.min(b[0],b[0]+a);b[3]=Math.max(b[3],b[3]+a);b[1]=Math.min(b[1],b[1]+g);b[4]=Math.max(b[4],b[4]+g);b[2]=Math.min(b[2],b[2]+n);b[5]=Math.max(b[5],b[5]+n)};v.expandWithRect=function(b,a){b[0]=Math.min(b[0],a[0]);b[1]=Math.min(b[1],a[1]);b[3]=Math.max(b[3],a[2]);b[4]=Math.max(b[4],a[3])};v.expandWithVec3=
function(b,a){b[0]=Math.min(b[0],a[0]);b[1]=Math.min(b[1],a[1]);b[2]=Math.min(b[2],a[2]);b[3]=Math.max(b[3],a[0]);b[4]=Math.max(b[4],a[1]);b[5]=Math.max(b[5],a[2])};v.fromExtent=function(b,a=u()){a[0]=b.xmin;a[1]=b.ymin;a[2]=b.hasZ?b.zmin:-Infinity;a[3]=b.xmax;a[4]=b.ymax;a[5]=b.hasZ?b.zmax:Infinity;return a};v.fromMinMax=function(b,a,g=u()){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=a[0];g[4]=a[1];g[5]=a[2];return g};v.fromRect=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=a[2];b[4]=
a[3];b[5]=Number.POSITIVE_INFINITY;return b};v.fromValues=A;v.getMax=function(b,a){a[0]=b[3];a[1]=b[4];a[2]=b[5];return a};v.getMin=function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};v.height=h;v.intersects=d;v.intersectsClippingArea=function(b,a){return t.isNone(a)?!0:d(b,a)};v.is=m;v.isPoint=function(b){return 0===x(b)&&0===e(b)&&0===h(b)};v.maximumDimension=function(b){return Math.max(x(b),h(b),e(b))};v.offset=function(b,a,g,n,f=b){f[0]=b[0]+a;f[1]=b[1]+g;f[2]=b[2]+n;f[3]=b[3]+a;f[4]=b[4]+g;
f[5]=b[5]+n;return f};v.scale=function(b,a,g=b){const n=b[0]+x(b)/2,f=b[1]+e(b)/2,q=b[2]+h(b)/2;g[0]=n+(b[0]-n)*a;g[1]=f+(b[1]-f)*a;g[2]=q+(b[2]-q)*a;g[3]=n+(b[3]-n)*a;g[4]=f+(b[4]-f)*a;g[5]=q+(b[5]-q)*a;return g};v.set=l;v.setMax=function(b,a,g=b){g[3]=a[0];g[4]=a[1];g[5]=a[2];g!==b&&(g[0]=b[0],g[1]=b[1],g[2]=b[2]);return b};v.setMin=function(b,a,g=b){g[0]=a[0];g[1]=a[1];g[2]=a[2];g!==b&&(g[3]=b[3],g[4]=b[4],g[5]=b[5]);return g};v.size=function(b,a=[0,0,0]){a[0]=x(b);a[1]=e(b);a[2]=h(b);return a};
v.toExtent=function(b,a){return isFinite(b[2])||isFinite(b[5])?new E({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:a}):new E({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:a})};v.toRect=function(b,a){a||(a=B.create());a[0]=b[0];a[1]=b[1];a[2]=b[3];a[3]=b[4];return a};v.width=x;v.wrap=function(b,a,g,n,f,q){return A(b,a,g,n,f,q,c)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){function k(p){const z=[];let w=0,y=0;for(let G=0;G<p.length;G++){const H=p[G];let I=null;for(let D=0;D<H.length;D++)I=H[D],z.push(I),0===D?y=w=I[0]:(w=Math.min(w,I[0]),y=Math.max(y,I[0]));I&&z.push([(w+y)/2,0])}return z}function c(p,z){if(!(p instanceof e||p instanceof x))throw q.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new B("straightLineDensify: the input geometry is neither polyline nor polygon");var w=h.getGeometryParts(p);
const y=[];for(const H of w){w=[];y.push(w);w.push([H[0][0],H[0][1]]);for(let I=0;I<H.length-1;I++){const D=H[I][0],C=H[I][1],F=H[I+1][0],K=H[I+1][1];var G=Math.sqrt((F-D)*(F-D)+(K-C)*(K-C));const J=(K-C)/G,P=(F-D)/G,S=G/z;if(1<S){for(let X=1;X<=S-1;X++){const ha=X*z;w.push([P*ha+D,J*ha+C])}G=(G+Math.floor(S-1)*z)/2;w.push([P*G+D,J*G+C])}w.push([F,K])}}return"polygon"===p.type?new x({rings:y,spatialReference:p.spatialReference}):new e({paths:y,spatialReference:p.spatialReference})}function b(p,z,
w){z&&(p=c(p,1E6),p=l.webMercatorToGeographic(p,!0));w&&(p=h.updatePolyGeometry(p,w));return p}function a(p,z,w){if(Array.isArray(p)){var y=p[0];y>z?(w=h.offsetMagnitude(y,z),p[0]=y+-2*w*z):y<w&&(z=h.offsetMagnitude(y,w),p[0]=y+-2*z*w)}else y=p.x,y>z?(w=h.offsetMagnitude(y,z),p=p.clone().offset(-2*w*z,0)):y<w&&(z=h.offsetMagnitude(y,w),p=p.clone().offset(-2*z*w,0));return p}function g(p,z){let w=-1;for(let y=0;y<z.cutIndexes.length;y++){const G=z.cutIndexes[y],H=z.geometries[y],I=h.getGeometryParts(H);
for(let D=0;D<I.length;D++){const C=I[D];C.some(F=>{if(180>F[0])return!0;F=0;for(var K=0;K<C.length;K++){var J=C[K][0];F=J>F?J:F}F=Number(F.toFixed(9));F=-360*h.offsetMagnitude(F,180);for(K=0;K<C.length;K++)J=H.getPoint(D,K),H.setPoint(D,K,J.clone().offset(F,0));return!0})}if(G===w)if("polygon"===p[0].type)for(const D of h.getGeometryParts(H))p[G]=p[G].addRing(D);else{if("polyline"===p[0].type)for(const D of h.getGeometryParts(H))p[G]=p[G].addPath(D)}else w=G,p[G]=H}return p}function n(p,z,w){return f.apply(this,
arguments)}function f(){f=t._asyncToGenerator(function*(p,z,w){if(!Array.isArray(p))return n([p],z);z&&"string"!==typeof z&&q.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var y="string"===typeof z?z:z?.url??E.geometryServiceUrl;let G,H,I;let D=0;var C=[];z=[];for(var F of p)if(A.isNone(F))z.push(F);else{if(!K){var K=F.spatialReference;var J=d.getInfo(K);var P=(G=K.isWebMercator)?102100:4326;H=h.cutParams[P].maxX;I=h.cutParams[P].minX;var S=h.cutParams[P].plus180Line;
P=h.cutParams[P].minus180Line}if(J)if("mesh"===F.type)z.push(F);else if("point"===F.type)z.push(a(F.clone(),H,I));else if("multipoint"===F.type){var X=F.clone();X.points=X.points.map(ha=>a(ha,H,I));z.push(X)}else if("extent"===F.type)X=F.clone()._normalize(!1,!1,J),z.push(X.rings?new x(X):X);else if(F.extent){X=F.extent;const ha=2*h.offsetMagnitude(X.xmin,I)*H;let U=0===ha?F.clone():h.updatePolyGeometry(F.clone(),ha);X.offset(ha,0);X.intersects(S)&&X.xmax!==H?(D=X.xmax>D?X.xmax:D,U=b(U,G),C.push(U),
z.push("cut")):X.intersects(P)&&X.xmin!==I?(D=2*X.xmax*H>D?2*X.xmax*H:D,U=b(U,G,360),C.push(U),z.push("cut")):z.push(U)}else z.push(F.clone());else z.push(F)}K=h.offsetMagnitude(D,H);J=-90;S=K;for(F=new e;0<K;)P=-180+360*K,F.addPath([[P,J],[P,-1*J]]),J*=-1,K--;if(0<C.length&&0<S){K=yield m.cut(y,C,F,w);K=g(C,K);J=[];C=[];for(S=0;S<z.length;S++)F=z[S],"cut"!==F?C.push(F):(F=K.shift(),P=p[S],A.isSome(P)&&"polygon"===P.type&&P.rings&&1<P.rings.length&&F.rings.length>=P.rings.length?(J.push(F),C.push("simplify")):
C.push(G?l.geographicToWebMercator(F):F));if(!J.length)return C;z=yield r.simplify(y,J,w);p=[];for(w=0;w<C.length;w++)y=C[w],"simplify"!==y?p.push(y):p.push(G?l.geographicToWebMercator(z.shift()):z.shift());return p}p=[];for(w=0;w<z.length;w++)y=z[w],"cut"!==y?p.push(y):(y=C.shift(),p.push(!0===G?l.geographicToWebMercator(y):y));return p});return f.apply(this,arguments)}const q=u.getLogger("esri.geometry.support.normalizeUtils");v.getDenormalizedExtent=function(p){if(!p)return null;const z=p.extent;
if(!z)return null;var w=p.spatialReference&&d.getInfo(p.spatialReference);if(!w)return z;const [y,G]=w.valid;({width:w}=z);let {xmin:H,xmax:I}=z;[H,I]=[I,H];if("extent"===p.type||0===w||w<=G||w>2*G||H<y||I>G)return z;let D;switch(p.type){case "polygon":if(1<p.rings.length)D=k(p.rings);else return z;break;case "polyline":if(1<p.paths.length)D=k(p.paths);else return z;break;case "multipoint":D=p.points}p=z.clone();for(let C=0;C<D.length;C++){let F=D[C][0];0>F?(F+=G,I=Math.max(F,I)):(F-=G,H=Math.min(F,
H))}p.xmin=H;p.xmax=I;return p.width<w?(p.xmin-=G,p.xmax-=G,p):z};v.normalizeCentralMeridian=n;v.normalizeMapX=function(p,z){if(z=d.getInfo(z)){const [w,y]=z.valid;z=y-w;if(p<w)for(;p<w;)p+=z;if(p>y)for(;p>y;)p-=z}return p};v.straightLineDensify=c;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(v,t,E,B){function u(A){return B.isPolygon(A)?
A.rings:A.paths}t={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new t({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:E.WebMercator}),minus180Line:new t({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:E.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new t({paths:[[[180,-180],[180,180]]],spatialReference:E.WGS84}),minus180Line:new t({paths:[[[-180,
-180],[-180,180]]],spatialReference:E.WGS84})}};v.cutParams=t;v.getGeometryParts=u;v.offsetMagnitude=function(A,x){return Math.ceil((A-x)/(2*x))};v.updatePolyGeometry=function(A,x){const e=u(A);for(const h of e)for(const d of h)d[0]+=x;return A};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/geometryService/cut":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../geometry/support/jsonUtils ../utils".split(" "),
function(v,t,E,B,u,A){function x(){x=t._asyncToGenerator(function*(e,h,d,l){e=A.parseUrl(e);const m=h[0].spatialReference;h={...l,query:{...e.query,f:"json",sr:JSON.stringify(m),target:JSON.stringify({geometryType:u.getJsonType(h[0]),geometries:h}),cutter:JSON.stringify(d)}};h=yield B(e.path+"/cut",h);const {cutIndexes:r,geometries:k=[]}=h.data;return{cutIndexes:r,geometries:k.map(c=>{c=u.fromJSON(c);c.spatialReference=m;return c})}});return x.apply(this,arguments)}v.cut=function(e,h,d,l){return x.apply(this,
arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(v,t,E,B,u,A){function x(e,h,d){const l={};for(const r in e)if("declaredClass"!==r){var m=e[r];if(null!=m&&"function"!==typeof m)if(Array.isArray(m)){l[r]=[];for(let k=0;k<m.length;k++)l[r][k]=x(m[k])}else"object"===typeof m?m.toJSON?(m=m.toJSON(d&&d[r]),l[r]=
h?m:JSON.stringify(m)):l[r]=h?m:JSON.stringify(m):l[r]=m}return l}v.asValidOptions=function(e,h){return h?{...h,query:{...e,...h.query}}:{query:e}};v.encode=x;v.getToken=function(e,h){return A.supportsApiKey(e)&&(h||t.apiKey)?h||t.apiKey:E.id?.findCredential(e)?.token};v.parseUrl=function(e){return"string"===typeof e?u.urlToObject(e):B.clone(e)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/geometryService/simplify":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ./utils".split(" "),
function(v,t,E,B,u,A){function x(){x=t._asyncToGenerator(function*(e,h,d){const l="string"===typeof e?B.urlToObject(e):e;e=h[0].spatialReference;const m=u.getJsonType(h[0]);h={...d,query:{...l.query,f:"json",sr:e.wkid?e.wkid:JSON.stringify(e),geometries:JSON.stringify(A.encodeGeometries(h))}};({data:h}=yield E(l.path+"/simplify",h));return A.decodeGeometries(h.geometries,m,e)});return x.apply(this,arguments)}v.simplify=function(e,h,d){return x.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(v,t){v.decodeGeometries=function(E,B,u){const A=t.getGeometryType(B);return E.map(x=>{x=A.fromJSON(x);x.spatialReference=u;return x})};v.encodeGeometries=function(E){return{geometryType:t.getJsonType(E[0]),geometries:E.map(B=>B.toJSON())}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports",
"../../../core/Error","../../../core/sql/WhereClauseCache"],function(v,t,E){function B(h,d){return h?x.get(h,d):null}function u(h,d,l,m=!0){const r=[];for(const k of d)if("*"!==k&&!h.has(k))if(m){d=A(k);try{const c=B(d,h);if(!c)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:d});if(!c.isStandardized)throw new t("feature-store:unsupported-query","expression is not standard",{clause:c});u(h,c.fieldNames,"expression contains missing fields")}catch(c){if((d=c&&c.details)&&
(d.clause||d.where))throw c;d&&d.missingFields?r.push(...d.missingFields):r.push(k)}}else r.push(k);if(r.length)throw new t("feature-store:unsupported-query",l,{missingFields:r});}function A(h){return h.split(" as ")[0]}const x=new E.WhereClauseCache(50,500),e=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));v.getAliasFromFieldName=function(h){return h.split(" as ")[1]};v.getExpressionFromFieldName=
A;v.getWhereClause=B;v.hasInvalidFieldType=function(h,d){return(h=d.get(h))?!e.has(h.type):!1};v.validateFields=u;v.validateHaving=function(h,d,l){if(!d)return!0;const m=x.get(d,h);if(!m)throw new t("feature-store:unsupported-query","invalid SQL expression",{having:d});if(!m.isAggregate)throw new t("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:d});u(h,m.fieldNames,"having contains missing fields");if(!m.getExpressions().every(r=>{const {aggregateType:k,
field:c}=r,b=h.has(c)&&h.get(c).name;return l.some(a=>{const {onStatisticField:g,statisticType:n}=a;return(h.has(g)&&h.get(g).name)===b&&n.toLowerCase().trim()===k})}))throw new t("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:d});return!0};v.validateWhere=function(h,d){if(!d)return!0;const l=x.get(d,h);if(!l)throw new t("feature-store:unsupported-query","invalid SQL expression",{where:d});if(!l.isStandardized)throw new t("feature-store:unsupported-query",
"where clause is not standard",{where:d});u(h,l.fieldNames,"where clause contains missing fields");return!0};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(v,t,E){let B=function(){function u(A,x){this._cache=new t(A);this._invalidCache=new t(x)}u.prototype.get=function(A,x){const e=`${x.uid}:${A}`,h=this._cache.get(e);if(h)return h;if(void 0!==this._invalidCache.get(e))return null;
try{const d=E.WhereClause.create(A,x);this._cache.put(e,d);return d}catch{return this._invalidCache.put(e,null),null}};return u}();v.WhereClauseCache=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(v){return function(){function t(B,u){this._storage=new v.MemCacheStorage;this._storage.maxSize=B;u&&this._storage.registerRemoveFunc("",u)}var E=t.prototype;E.put=function(B,u){this._storage.put(B,
u,1,1)};E.pop=function(B){return this._storage.pop(B)};E.get=function(B){return this._storage.get(B)};E.clear=function(){this._storage.clearAll()};E.destroy=function(){this._storage.destroy()};return t}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(v,t,E,B,u,A){function x(F,K){F+="";return F.length>=K?F:Array(K-F.length+1).join("0")+F}function e(F,K,J="0",P=
"0",S="0",X="0",ha="",U="0",Q="0"){return"+"===ha||"-"===ha?(F=`${x(parseInt(F,10),4)}-${x(parseInt(K,10),2)}-${x(parseInt(J,10),2)}`,K="",10>parseFloat(X)&&(K="0"),P=`${x(parseInt(P,10),2)}:${x(parseInt(S,10),2)}:${K+parseFloat(X).toString()}`,ha=`${ha}${x(parseInt(U,10),2)}:${x(parseInt(Q,10),2)}`,new Date(F+"T"+P+ha)):new Date(parseInt(F,10),parseInt(K,10)-1,parseInt(J,10),parseInt(P,10),parseInt(S,10),parseFloat(X))}function h(F){let K=p.exec(F);if(null!==K){const [,J,P,S,X,ha,U]=K;return e(J,
P,S,X,ha,U)}K=z.exec(F);if(null!==K){const [,J,P,S,X,ha,U,Q,O,R]=K;return e(J,P,S,X,ha,U,Q,O,R)}K=w.exec(F);if(null!==K){const [,J,P,S,X,ha,U,Q,O]=K;return e(J,P,S,X,ha,"0",U,Q,O)}K=y.exec(F);if(null!==K){const [,J,P,S,X,ha]=K;return e(J,P,S,X,ha)}K=q.exec(F);if(null!==K){const [,J,P,S]=K;return e(J,P,S)}throw Error("SQL Invalid Timestamp");}function d(F){const K=q.exec(F);if(null===K)try{return h(F)}catch{throw Error("SQL Invalid Date");}const [,J,P,S]=K;return new Date(parseInt(J,10),parseInt(P,
10)-1,parseInt(S,10))}function l(F){return Array.isArray(F)?F:[F]}function m(F){return null!==F?!0!==F:null}function r(F,K){return null!=F&&null!=K?!0===F&&!0===K:!1===F||!1===K?!1:null}function k(F,K){return null!=F&&null!=K?!0===F||!0===K:!0===F||!0===K?!0:null}function c(F,K){if(null==F)return null;let J=!1;for(const P of K)if(null==P)J=null;else if(F===P){J=!0;break}return J}function b(F,K,J){if(null==F)return null;let P="",S=D.Normal;for(let X=0;X<K.length;X++){const ha=K.charAt(X);switch(S){case D.Normal:ha===
J?S=D.Escaped:P="-[]/{}()*+?.\\^$|".includes(ha)?P+("\\"+ha):"%"===ha?P+".*":"_"===ha?P+".":P+ha;break;case D.Escaped:P="-[]/{}()*+?.\\^$|".includes(ha)?P+("\\"+ha):P+ha,S=D.Normal}}return(new RegExp("^"+P+"$","m")).test(F)}function a(F){return F instanceof Date?F.valueOf():F}function g(F,K,J){if(null==K||null==J)return null;K=a(K);J=a(J);switch(F){case "\x3c\x3e":return K!==J;case "\x3d":return K===J;case "\x3e":return K>J;case "\x3c":return K<J;case "\x3e\x3d":return K>=J;case "\x3c\x3d":return K<=
J}}function n(F,K,J){if(K instanceof u.SqlInterval)if(J instanceof Date)switch(F){case "+":return new Date(K.valueInMilliseconds()+J.getTime());case "-":return K.valueInMilliseconds()-J.getTime();case "*":return K.valueInMilliseconds()*J.getTime();case "/":return K.valueInMilliseconds()/J.getTime()}else if(J instanceof u.SqlInterval)switch(F){case "+":return u.SqlInterval.createFromMilliseconds(K.valueInMilliseconds()+J.valueInMilliseconds());case "-":return u.SqlInterval.createFromMilliseconds(K.valueInMilliseconds()-
J.valueInMilliseconds());case "*":return K.valueInMilliseconds()*J.valueInMilliseconds();case "/":return K.valueInMilliseconds()/J.valueInMilliseconds()}else K=K.valueInMilliseconds();else if(J instanceof u.SqlInterval)if(K instanceof Date)switch(F){case "+":return new Date(J.valueInMilliseconds()+K.getTime());case "-":return new Date(K.getTime()-J.valueInMilliseconds());case "*":return K.getTime()*J.valueInMilliseconds();case "/":return K.getTime()/J.valueInMilliseconds()}else J=J.valueInMilliseconds();
else if(K instanceof Date&&"number"===typeof J)switch(J*=864E5,K=K.getTime(),F){case "+":return new Date(K+J);case "-":return new Date(K-J);case "*":return new Date(K*J);case "/":return new Date(K/J)}else if(J instanceof Date&&"number"===typeof K)switch(K*=864E5,J=J.getTime(),F){case "+":return new Date(K+J);case "-":return new Date(K-J);case "*":return new Date(K*J);case "/":return new Date(K/J)}switch(F){case "+":return K+J;case "-":return K-J;case "*":return K*J;case "/":return K/J}}function f(F,
K,J,P){F=P.getAttribute(F,K);return null!=F&&1===J[K]?new Date(F):F}const q=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,z=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,G=new Set(["current_timestamp","current_date","current_time"]);let H=function(){function F(){}
F.makeBool=function(K){return!0===K};F.featureValue=function(K,J,P,S){return f(K,J,P,S)};F.equalsNull=function(K){return null===K};F.applyLike=function(K,J,P){return b(K,J,P)};F.ensureArray=function(K){return l(K)};F.applyIn=function(K,J){return c(K,J)};F.currentDate=function(){const K=new Date;K.setHours(0,0,0,0);return K};F.makeSqlInterval=function(K,J,P){return u.SqlInterval.createFromValueAndQualifer(K,J,P)};F.convertInterval=function(K){return K instanceof u.SqlInterval?K.valueInMilliseconds():
K};F.currentTimestamp=function(){return new Date};F.compare=function(K,J,P){return g(K,J,P)};F.calculate=function(K,J,P){return n(K,J,P)};F.makeComparable=function(K){return a(K)};F.evaluateFunction=function(K,J){return u.evaluateFunction(K,J)};F.lookup=function(K,J){K=J[K];return void 0===K?null:K};F.between=function(K,J){return null==K||null==J[0]||null==J[1]?null:K>=J[0]&&K<=J[1]};F.notbetween=function(K,J){return null==K||null==J[0]||null==J[1]?null:K<J[0]||K>J[1]};F.ternaryNot=function(K){return m(K)};
F.ternaryAnd=function(K,J){return r(K,J)};F.ternaryOr=function(K,J){return k(K,J)};return F}(),I=function(){function F(J,P){this.fieldsIndex=P;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=A.WhereGrammar.parse(J);const {isStandardized:S,isAggregate:X,referencedFieldNames:ha}=this._extractExpressionInfo(P);this._referencedFieldNames=ha;this.isStandardized=S;this.isAggregate=X}F.create=function(J,P){return new F(J,P)};var K=F.prototype;K.testSet=function(J,P=C){const S=
{};for(const X of this.fieldNames)S[X]=J.map(ha=>P.getAttribute(ha,X));return!!this._evaluateNode(this.parseTree,{attributes:S},C)};K.calculateValue=function(J,P=C){J=this._evaluateNode(this.parseTree,J,P);return J instanceof u.SqlInterval?J.valueInMilliseconds()/864E5:J};K.calculateValueCompiled=function(J,P=C){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(J,this.parameters,P,this._datefields);if(E("esri-csp-restrictions"))return this.calculateValue(J,P);this._compileMe();
return this.parseTree._compiledVersion(J,this.parameters,P,this._datefields)};K.testFeature=function(J,P=C){return!!this._evaluateNode(this.parseTree,J,P)};K.testFeatureCompiled=function(J,P=C){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(J,this.parameters,P,this._datefields);if(E("esri-csp-restrictions"))return this.testFeature(J,P);this._compileMe();return!!this.parseTree._compiledVersion(J,this.parameters,P,this._datefields)};K.getFunctions=function(){const J=
new Set;this._visitAll(this.parseTree,P=>{"function"===P.type&&J.add(P.name.toLowerCase())});return Array.from(J)};K.getExpressions=function(){const J=new Map;this._visitAll(this.parseTree,P=>{if("function"===P.type){const S=P.name.toLowerCase();P=P.args.value[0];if("column-reference"===P.type){P=P.column;const X=`${S}-${P}`;J.has(X)||J.set(X,{aggregateType:S,field:P})}}});return[...J.values()]};K.getVariables=function(){const J=new Set;this._visitAll(this.parseTree,P=>{"parameter"===P.type&&J.add(P.value.toLowerCase())});
return Array.from(J)};K._compileMe=function(){const J="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",J)).bind(H)};K._extractExpressionInfo=function(J){const P=[],S=new Set;let X=!0,ha=!0;this._visitAll(this.parseTree,U=>{switch(U.type){case "column-reference":const Q=J?.get(U.column);let O,R;Q?O=R=Q.name??"":(R=U.column,O=R.toLowerCase());Q&&Q.name&&("date"===Q.type||
"esriFieldTypeDate"===Q.type)&&(this._datefields[Q.name]=1);S.has(O)||(S.add(O),P.push(R));U.column=R;break;case "function":const {name:V,args:Z}=U;U=Z.value.length;X&&(X=u.isStandardized(V,U));ha&&(ha=B.isAggregate(V,U))}});return{referencedFieldNames:Array.from(P),isStandardized:X,isAggregate:ha}};K._visitAll=function(J,P){if(null!=J)switch(P(J),J.type){case "when-clause":this._visitAll(J.operand,P);this._visitAll(J.value,P);break;case "case-expression":for(const S of J.clauses)this._visitAll(S,
P);"simple"===J.format&&this._visitAll(J.operand,P);null!==J.else&&this._visitAll(J.else,P);break;case "expression-list":for(const S of J.value)this._visitAll(S,P);break;case "unary-expression":this._visitAll(J.expr,P);break;case "binary-expression":this._visitAll(J.left,P);this._visitAll(J.right,P);break;case "function":this._visitAll(J.args,P)}};K.evaluateNodeToJavaScript=function(J){switch(J.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(J.value)+", "+JSON.stringify(J.qualifier)+
","+JSON.stringify(J.op)+")";case "case-expression":var P="";if("simple"===J.format){var S="this.makeComparable("+this.evaluateNodeToJavaScript(J.operand)+")";P="( ";for(let X=0;X<J.clauses.length;X++)P+=" ("+S+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(J.clauses[X].operand)+")) ? ("+this.evaluateNodeToJavaScript(J.clauses[X].value)+") : "}else for(P="( ",S=0;S<J.clauses.length;S++)P+=" this.makeBool("+this.evaluateNodeToJavaScript(J.clauses[S].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(J.clauses[S].value)+") : ";P=null!==J.else?P+this.evaluateNodeToJavaScript(J.else):P+"null";return P+" )";case "parameter":return"this.lookup("+JSON.stringify(J.value.toLowerCase())+",lookups)";case "expression-list":P="[";for(S of J.value)"["!==P&&(P+=","),P+=this.evaluateNodeToJavaScript(S);return P+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(J.expr)+")";case "binary-expression":switch(J.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+" )";case "IS":if("null"!==J.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(J.left)+")";case "ISNOT":if("null"!==J.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(J.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(J.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(J.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(J.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(J.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+","+JSON.stringify(J.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+","+JSON.stringify(J.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(J.operator)+","+this.evaluateNodeToJavaScript(J.left)+","+
this.evaluateNodeToJavaScript(J.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(J.operator)+","+this.evaluateNodeToJavaScript(J.left)+","+this.evaluateNodeToJavaScript(J.right)+")"}throw Error("Not Supported Operator "+J.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(J.value);case "date":return"(new Date("+d(J.value).getTime().toString()+"))";case "timestamp":return"(new Date("+h(J.value).getTime().toString()+"))";case "current-time":return"date"===
J.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(J.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(J.name)+","+this.evaluateNodeToJavaScript(J.args)+")"}throw Error("Unsupported sql syntax "+J.type);};K._evaluateNode=function(J,P,S){switch(J.type){case "interval":return P=this._evaluateNode(J.value,P,S),u.SqlInterval.createFromValueAndQualifer(P,J.qualifier,J.op);case "case-expression":if("simple"===
J.format){var X=a(this._evaluateNode(J.operand,P,S));for(var ha=0;ha<J.clauses.length;ha++)if(X===a(this._evaluateNode(J.clauses[ha].operand,P,S)))return this._evaluateNode(J.clauses[ha].value,P,S)}else for(X=0;X<J.clauses.length;X++)if(!0===this._evaluateNode(J.clauses[X].operand,P,S))return this._evaluateNode(J.clauses[X].value,P,S);return null!==J.else?this._evaluateNode(J.else,P,S):null;case "parameter":return this.parameters[J.value.toLowerCase()];case "expression-list":X=[];for(ha of J.value)X.push(this._evaluateNode(ha,
P,S));return X;case "unary-expression":return m(this._evaluateNode(J.expr,P,S));case "binary-expression":switch(J.operator){case "AND":return r(this._evaluateNode(J.left,P,S),this._evaluateNode(J.right,P,S));case "OR":return k(this._evaluateNode(J.left,P,S),this._evaluateNode(J.right,P,S));case "IS":if("null"!==J.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(J.left,P,S);case "ISNOT":if("null"!==J.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(J.left,
P,S);case "IN":return X=l(this._evaluateNode(J.right,P,S)),c(this._evaluateNode(J.left,P,S),X);case "NOT IN":return X=l(this._evaluateNode(J.right,P,S)),m(c(this._evaluateNode(J.left,P,S),X));case "BETWEEN":return X=this._evaluateNode(J.left,P,S),J=this._evaluateNode(J.right,P,S),null==X||null==J[0]||null==J[1]?null:X>=a(J[0])&&X<=a(J[1]);case "NOTBETWEEN":return X=this._evaluateNode(J.left,P,S),J=this._evaluateNode(J.right,P,S),null==X||null==J[0]||null==J[1]?null:X<a(J[0])||X>a(J[1]);case "LIKE":return b(this._evaluateNode(J.left,
P,S),this._evaluateNode(J.right,P,S),J.escape);case "NOT LIKE":return m(b(this._evaluateNode(J.left,P,S),this._evaluateNode(J.right,P,S),J.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return g(J.operator,this._evaluateNode(J.left,P,S),this._evaluateNode(J.right,P,S));case "-":case "+":case "*":case "/":return n(J.operator,this._evaluateNode(J.left,P,S),this._evaluateNode(J.right,P,S))}case "null":case "boolean":case "string":case "number":return J.value;
case "date":return d(J.value);case "timestamp":return h(J.value);case "current-time":return P=new Date,"date"===J.mode&&P.setHours(0,0,0,0),P;case "column-reference":return f(P,J.column,this._datefields,S);case "function":return P=this._evaluateNode(J.args,P,S),this.isAggregate?B.aggregateFunction(J.name,P):u.evaluateFunction(J.name,P)}throw Error("Unsupported sql syntax "+J.type);};t._createClass(F,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,J=>{"current-time"===J.type?this._hasDateFunctions=!0:"function"===J.type&&(this._hasDateFunctions=this._hasDateFunctions||G.has(J.name.toLowerCase()))});return this._hasDateFunctions}}]);return F}();var D;(function(F){F[F.Normal=0]="Normal";F[F.Escaped=1]="Escaped"})(D||(D={}));const C={getAttribute(F,K){return(F&&"object"===typeof F.attributes?F.attributes:F)[K]}};v.WhereClause=I;v.defaultAttributeAdapter=
C;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(v){function t(u){let A=0;for(let x=0;x<u.length;x++)A+=u[x];return A/u.length}function E(u){const A=t(u),x=u.length;let e=0;for(const h of u)e+=(h-A)**2;return 1<x?e/(x-1):0}const B={min:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.min.apply(Math,u[0])},max:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.max.apply(Math,
u[0])},avg:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:t(u[0])},sum:{minParams:1,maxParams:1,evaluate:u=>{if(null==u[0])u=null;else{u=u[0];let A=0;for(let x=0;x<u.length;x++)A+=u[x];u=A}return u}},stddev:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.sqrt(E(u[0]))},count:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].length},var:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:E(u[0])}};v.aggregateFunction=function(u,A){const x=B[u.toLowerCase()];if(null==x)throw Error("Function Not Recognised");
if(A.length<x.minParams||A.length>x.maxParams)throw Error(`Invalid Parameter count for call to ${u.toUpperCase()}`);return x.evaluate(A)};v.isAggregate=function(u,A){u=B[u.toLowerCase()];return null!=u&&A>=u.minParams&&A<=u.maxParams};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(v,t){let E=function(){function u(){this.op="+";this.minute=this.year=this.month=this.hour=
this.second=this.day=0}u._fixDefaults=function(A){if(null!==A.precision||null!==A.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};u.createFromMilliseconds=function(A){const x=new u;x.second=A/1E3;return x};u.createFromValueAndQualifer=function(A,x,e){let h=null;const d=new u;d.op="-"===e?"-":"+";if("interval-period"===x.type){u._fixDefaults(x);e=RegExp("^[0-9]{1,}$");if("year"===x.period||"month"===x.period)throw Error("Year-Month Intervals not supported");if(e.test(A))d[x.period]=
parseFloat(A);else throw Error("Illegal Interval");}else{u._fixDefaults(x.start);u._fixDefaults(x.end);if("year"===x.start.period||"month"===x.start.period)throw Error("Year-Month Intervals not supported");if("year"===x.end.period||"month"===x.end.period)throw Error("Year-Month Intervals not supported");switch(x.start.period){case "day":switch(x.end.period){case "hour":h=RegExp("^[0-9]{1,} [0-9]{1,}$");if(h.test(A))d[x.start.period]=parseFloat(A.split(" ")[0]),d[x.end.period]=parseFloat(A.split(" ")[1]);
else throw Error("Illegal Interval");break;case "minute":h=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(h.test(A))d[x.start.period]=parseFloat(A.split(" ")[0]),A=A.split(" ")[1].split(":"),d.hour=parseFloat(A[0]),d.minute=parseFloat(A[1]);else throw Error("Illegal Interval");break;case "second":h=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(h.test(A))d[x.start.period]=parseFloat(A.split(" ")[0]),A=A.split(" ")[1].split(":"),d.hour=parseFloat(A[0]),d.minute=parseFloat(A[1]),
d.second=parseFloat(A[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(x.end.period){case "minute":h=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(h.test(A))d.hour=parseFloat(A.split(":")[0]),d.minute=parseFloat(A.split(":")[1]);else throw Error("Illegal Interval");break;case "second":h=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(h.test(A))A=A.split(":"),d.hour=parseFloat(A[0]),d.minute=parseFloat(A[1]),d.second=parseFloat(A[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "minute":switch(x.end.period){case "second":h=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(h.test(A))A=A.split(":"),d.minute=parseFloat(A[0]),d.second=parseFloat(A[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return d};u.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+
6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return u}();const B={extract:{minParams:2,maxParams:2,evaluate:([u,A])=>{if(null==A)return null;if(A instanceof Date)switch(u.toUpperCase()){case "SECOND":return A.getSeconds();case "MINUTE":return A.getMinutes();case "HOUR":return A.getHours();case "DAY":return A.getDate();case "MONTH":return A.getMonth()+1;case "YEAR":return A.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:u=>{if(2===u.length){const [A,x]=u;return null==A||null==x?null:A.toString().substring(x-1)}if(3===u.length){const [A,x,e]=u;return null==A||null==x||null==e?null:0>=e?"":A.toString().substring(x-1,x+e-1)}}},position:{minParams:2,maxParams:2,evaluate:([u,A])=>null==u||null==A?null:A.indexOf(u)+1},trim:{minParams:2,maxParams:3,evaluate:u=>{var A=3===u.length,x=A?u[1]:" ";A=A?u[2]:u[1];if(null==x||null==A)return null;x=`(${t.escapeRegExpString(x)})`;switch(u[0]){case "BOTH":return A.replace(new RegExp(`^${x}*|${x}*$`,
"g"),"");case "LEADING":return A.replace(new RegExp(`^${x}*`,"g"),"");case "TRAILING":return A.replace(new RegExp(`${x}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.abs(u[0])},ceiling:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.ceil(u[0])},floor:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.floor(u[0])},log:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.log(u[0])},log10:{minParams:1,
maxParams:1,evaluate:u=>null==u[0]?null:Math.log(u[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.sin(u[0])},cos:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.cos(u[0])},tan:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.tan(u[0])},asin:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.asin(u[0])},acos:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.acos(u[0])},atan:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.atan(u[0])},
sign:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:0<u[0]?1:0>u[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:u=>null==u[0]||null==u[1]?null:u[0]**u[1]},mod:{minParams:2,maxParams:2,evaluate:u=>null==u[0]||null==u[1]?null:u[0]%u[1]},round:{minParams:1,maxParams:2,evaluate:u=>{const A=u[0];u=2===u.length?10**u[1]:1;return null==A?null:Math.round(A*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:u=>null==u[0]?null:1===u.length?parseInt(u[0].toFixed(0),10):parseFloat(u[0].toFixed(u[1]))},
char_length:{minParams:1,maxParams:1,evaluate:u=>"string"===typeof u[0]||u[0]instanceof String?u[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:u=>{let A="";for(let x=0;x<u.length;x++){if(null==u[x])return null;A+=u[x].toString()}return A}},lower:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].toString().toUpperCase()}};v.SqlInterval=E;v.evaluateFunction=function(u,A){const x=B[u.toLowerCase()];
if(null==x)throw Error("Function Not Recognised");if(A.length<x.minParams||A.length>x.maxParams)throw Error(`Invalid Parameter count for call to ${u.toUpperCase()}`);return x.evaluate(A)};v.isStandardized=function(u,A){u=B[u.toLowerCase()];return null!=u&&A>=u.minParams&&A<=u.maxParams};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(v,t){var E={exports:{}};
(function(u){(function(A,x){u.exports&&(u.exports=x())})(t.commonjsGlobal,function(){function A(e,h,d,l){e=Error.call(this,e);Object.setPrototypeOf&&Object.setPrototypeOf(e,A.prototype);e.expected=h;e.found=d;e.location=l;e.name="SyntaxError";return e}function x(e,h,d){d=d||" ";if(e.length>h)return e;h-=e.length;d+=d.repeat(h);return e+d.slice(0,h)}(function(e,h){function d(){this.constructor=e}d.prototype=h.prototype;e.prototype=new d})(A,Error);A.prototype.format=function(e){var h="Error: "+this.message;
if(this.location){var d=null,l;for(l=0;l<e.length;l++)if(e[l].source===this.location.source){d=e[l].text.split(/\r\n|\n|\r/g);break}e=this.location.start;l=this.location.source+":"+e.line+":"+e.column;if(d){var m=this.location.end,r=x("",e.line.toString().length," ");d=d[e.line-1];m=(e.line===m.line?m.column:d.length+1)-e.column||1;h+="\n --\x3e "+l+"\n"+r+" |\n"+e.line+" | "+d+"\n"+r+" | "+x("",e.column-1," ")+x("",m,"^")}else h+="\n at "+l}return h};A.buildMessage=function(e,h){function d(c){return c.charCodeAt(0).toString(16).toUpperCase()}
function l(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+d(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+d(b)})}function m(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+
d(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+d(b)})}function r(c){return k[c.type](c)}var k={literal:function(c){return'"'+l(c.text)+'"'},class:function(c){var b=c.parts.map(function(a){return Array.isArray(a)?m(a[0])+"-"+m(a[1]):m(a)});return"["+(c.inverted?"^":"")+b.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};return"Expected "+function(c){c=c.map(r);var b,a;c.sort();if(0<c.length){for(a=b=1;b<
c.length;b++)c[b-1]!==c[b]&&(c[a]=c[b],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(e)+" but "+(h?'"'+l(h)+'"':"end of input")+" found."};return{SyntaxError:A,parse:function(e,h){function d(aa,fa){return{type:"literal",text:aa,ignoreCase:fa}}function l(aa,fa,ra){return{type:"class",parts:aa,inverted:fa,ignoreCase:ra}}function m(aa){var fa=Rb[aa],ra;if(!fa){for(ra=aa-1;!Rb[ra];)ra--;fa=Rb[ra];for(fa=
{line:fa.line,column:fa.column};ra<aa;)10===e.charCodeAt(ra)?(fa.line++,fa.column=1):fa.column++,ra++;Rb[aa]=fa}return fa}function r(aa,fa){var ra=m(aa),Ea=m(fa);return{source:Wa,start:{offset:aa,line:ra.line,column:ra.column},end:{offset:fa,line:Ea.line,column:Ea.column}}}function k(aa){T<tb||(T>tb&&(tb=T,Uc=[]),Uc.push(aa))}function c(){var aa=T;Ba();var fa=a();fa!==N?(Ba(),aa=fa):(T=aa,aa=N);return aa}function b(){var aa=T;var fa=a();if(fa!==N){aa=[];var ra=T;var Ea=Ba();var La=Ka();if(La!==N){var Ua=
Ba();var Va=a();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;for(;ra!==N;)aa.push(ra),ra=T,Ea=Ba(),La=Ka(),La!==N?(Ua=Ba(),Va=a(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);ra={type:"expression-list"};fa=[fa];for(Ea=0;Ea<aa.length;Ea++)fa.push(aa[Ea][3]);ra.value=fa;aa=ra}else T=aa,aa=N;return aa}function a(){var aa=T;var fa=g();if(fa!==N){aa=[];var ra=T;var Ea=Ba();var La=W();if(La!==N){var Ua=Ba();var Va=g();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;for(;ra!==N;)aa.push(ra),
ra=T,Ea=Ba(),La=W(),La!==N?(Ua=Ba(),Va=g(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);aa=$a(fa,aa)}else T=aa,aa=N;return aa}function g(){var aa=T;var fa=n();if(fa!==N){aa=[];var ra=T;var Ea=Ba();var La=ma();if(La!==N){var Ua=Ba();var Va=n();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;for(;ra!==N;)aa.push(ra),ra=T,Ea=Ba(),La=ma(),La!==N?(Ua=Ba(),Va=n(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);aa=$a(fa,aa)}else T=aa,aa=N;return aa}function n(){var aa=T;var fa=ca();if(fa===
N){fa=T;if(33===e.charCodeAt(T)){var ra=cb;T++}else ra=N,0===Da&&k(ge);if(ra!==N){var Ea=T;Da++;if(61===e.charCodeAt(T)){var La=Sa;T++}else La=N,0===Da&&k(Hb);Da--;La===N?Ea=void 0:(T=Ea,Ea=N);Ea!==N?fa=ra=[ra,Ea]:(T=fa,fa=N)}else T=fa,fa=N}fa!==N?(ra=Ba(),Ea=n(),Ea!==N?aa={type:"unary-expression",operator:"NOT",expr:Ea}:(T=aa,aa=N)):(T=aa,aa=N);if(aa===N){fa=T;aa=z();if(aa!==N){Ba();fa=[];ra=T;Ea=Ba();La=f();if(La!==N){var Ua=Ba();var Va=z();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;
if(ra!==N)for(;ra!==N;)fa.push(ra),ra=T,Ea=Ba(),La=f(),La!==N?(Ua=Ba(),Va=z(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);else fa=N;fa!==N&&(fa={type:"arithmetic",tail:fa});fa===N&&(fa=T,ra=p(),ra!==N?(Ba(),Ea=Ia(),Ea!==N?(Ba(),Ea=b(),Ea!==N?(Ba(),La=Ma(),La!==N?fa={op:ra,right:Ea}:(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N),fa===N&&(fa=T,ra=p(),ra!==N?(Ba(),Ea=Ia(),Ea!==N?(Ba(),Ea=Ma(),Ea!==N?fa={op:ra,right:{type:"expression-list",value:[]}}:(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N),
fa===N&&(fa=T,ra=p(),ra!==N?(Ba(),Ea=K(),Ea!==N?fa={op:ra,right:Ea}:(T=fa,fa=N)):(T=fa,fa=N))),fa===N&&(fa=T,La=ca(),La!==N?(Ba(),ra=Y(),ra!==N?(Ba(),Ea=z(),Ea!==N?(Ba(),Ua=ma(),Ua!==N?(Ba(),La=z(),La!==N?fa={op:"NOT"+ra,right:{type:"expression-list",value:[Ea,La]}}:(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N),fa===N&&(fa=T,La=Y(),La!==N?(Ba(),ra=z(),ra!==N?(Ba(),Ea=ma(),Ea!==N?(Ba(),Ua=z(),Ua!==N?fa={op:La,right:{type:"expression-list",value:[ra,Ua]}}:(T=fa,fa=N)):(T=fa,fa=N)):
(T=fa,fa=N)):(T=fa,fa=N)),fa===N&&(fa=T,ra=M(),ra!==N?(Ba(),Ea=ca(),Ea!==N?(Ba(),Ea=z(),Ea!==N?fa={op:ra+"NOT",right:Ea}:(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N),fa===N&&(fa=T,ra=M(),ra!==N?(Ba(),Ea=z(),Ea!==N?fa={op:ra,right:Ea}:(T=fa,fa=N)):(T=fa,fa=N)),fa===N&&(fa=T,ra=q(),ra!==N?(Ba(),Ea=U(),Ea!==N?(Ba(),La=T,e.substr(T,6).toLowerCase()===Aa?(Ua=e.substr(T,6),T+=6):(Ua=N,0===Da&&k(wd)),Ua!==N?(Ua=T,Da++,Va=C(),Da--,Va===N?Ua=void 0:(T=Ua,Ua=N),Ua!==N?La="ESCAPE":(T=La,La=N)):(T=La,La=N),La!==N?(Ba(),
La=Q(),La!==N?fa={op:ra,right:Ea,escape:La.value}:(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N)):(T=fa,fa=N),fa===N&&(fa=T,ra=q(),ra!==N?(Ba(),Ea=U(),Ea!==N?fa={op:ra,right:Ea,escape:""}:(T=fa,fa=N)):(T=fa,fa=N))))));fa===N&&(fa=null);""==fa||void 0==fa||null==fa?fa=aa:(ra=null,fa=ra="arithmetic"==fa.type?$a(aa,fa.tail):Za(fa.op,aa,fa.right,fa.escape))}else T=fa,fa=N;aa=fa}return aa}function f(){if(e.substr(T,2)===jb){var aa=jb;T+=2}else aa=N,0===Da&&k(wc);aa===N&&(62===e.charCodeAt(T)?(aa=ob,T++):(aa=N,
0===Da&&k(Vc)),aa===N&&(e.substr(T,2)===Bb?(aa=Bb,T+=2):(aa=N,0===Da&&k(Ib)),aa===N&&(e.substr(T,2)===xa?(aa=xa,T+=2):(aa=N,0===Da&&k(Wc)),aa===N&&(60===e.charCodeAt(T)?(aa=ac,T++):(aa=N,0===Da&&k(bc)),aa===N&&(61===e.charCodeAt(T)?(aa=Sa,T++):(aa=N,0===Da&&k(Hb)),aa===N&&(e.substr(T,2)===Cb?(aa=Cb,T+=2):(aa=N,0===Da&&k(xc))))))));return aa}function q(){var aa=aa=T;var fa=ca();if(fa!==N){var ra=Ba();var Ea=ba();Ea!==N?aa=fa=[fa,ra,Ea]:(T=aa,aa=N)}else T=aa,aa=N;aa!==N&&(aa=aa[0]+" "+aa[2]);aa===N&&
(aa=ba());return aa}function p(){var aa=aa=T;var fa=ca();if(fa!==N){var ra=Ba();var Ea=L();Ea!==N?aa=fa=[fa,ra,Ea]:(T=aa,aa=N)}else T=aa,aa=N;aa!==N&&(aa=aa[0]+" "+aa[2]);aa===N&&(aa=L());return aa}function z(){var aa=T;var fa=y();if(fa!==N){aa=[];var ra=T;var Ea=Ba();var La=w();if(La!==N){var Ua=Ba();var Va=y();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;for(;ra!==N;)aa.push(ra),ra=T,Ea=Ba(),La=w(),La!==N?(Ua=Ba(),Va=y(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);aa=$a(fa,aa)}else T=
aa,aa=N;return aa}function w(){if(43===e.charCodeAt(T)){var aa=lb;T++}else aa=N,0===Da&&k(yc);aa===N&&(45===e.charCodeAt(T)?(aa=ub,T++):(aa=N,0===Da&&k(Xc)));return aa}function y(){var aa=T;var fa=H();if(fa!==N){aa=[];var ra=T;var Ea=Ba();var La=G();if(La!==N){var Ua=Ba();var Va=H();Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)}else T=ra,ra=N;for(;ra!==N;)aa.push(ra),ra=T,Ea=Ba(),La=G(),La!==N?(Ua=Ba(),Va=H(),Va!==N?ra=Ea=[Ea,La,Ua,Va]:(T=ra,ra=N)):(T=ra,ra=N);aa=$a(fa,aa)}else T=aa,aa=N;return aa}function G(){if(42===
e.charCodeAt(T)){var aa=hc;T++}else aa=N,0===Da&&k(he);aa===N&&(47===e.charCodeAt(T)?(aa=Sb,T++):(aa=N,0===Da&&k(ic)));return aa}function H(){var aa=Q();if(aa===N){var fa=T;var ra=T;var Ea=Z();if(Ea!==N){var La=ka();if(La!==N){var Ua=ia();Ua!==N?ra=parseFloat(Ea+La+Ua):(T=ra,ra=N)}else T=ra,ra=N}else T=ra,ra=N;ra===N&&(ra=T,Ea=Z(),Ea!==N?(La=ka(),La!==N?ra=parseFloat(Ea+La):(T=ra,ra=N)):(T=ra,ra=N),ra===N&&(ra=T,Ea=Z(),Ea!==N?(La=ia(),La!==N?ra=parseFloat(Ea+La):(T=ra,ra=N)):(T=ra,ra=N),ra===N&&(ra=
T,Ea=Z(),Ea!==N&&(Ea=parseFloat(Ea)),ra=Ea)));var Va=ra;if(Va!==N){var xd=T;Da++;var Xe=D();Da--;Xe===N?xd=void 0:(T=xd,xd=N);xd!==N?fa={type:"number",value:Va}:(T=fa,fa=N)}else T=fa,fa=N;aa=fa;if(aa===N){var Yc=T;var zc=T;if(e.substr(T,4).toLowerCase()===Ta){var yd=e.substr(T,4);T+=4}else yd=N,0===Da&&k(jc);if(yd!==N){var Zc=T;Da++;var Ye=C();Da--;Ye===N?Zc=void 0:(T=Zc,Zc=N);Zc!==N?zc=yd=[yd,Zc]:(T=zc,zc=N)}else T=zc,zc=N;var kc=zc;kc!==N&&(kc={type:"boolean",value:!0});Yc=kc;if(Yc===N){Yc=T;var Ac=
T;if(e.substr(T,5).toLowerCase()===zb){var zd=e.substr(T,5);T+=5}else zd=N,0===Da&&k(ie);if(zd!==N){var $c=T;Da++;var Ze=C();Da--;Ze===N?$c=void 0:(T=$c,$c=N);$c!==N?Ac=zd=[zd,$c]:(T=Ac,Ac=N)}else T=Ac,Ac=N;kc=Ac;kc!==N&&(kc={type:"boolean",value:!1});Yc=kc}aa=Yc;if(aa===N){var Bc=T;if(e.substr(T,4).toLowerCase()===pb){var Ad=e.substr(T,4);T+=4}else Ad=N,0===Da&&k(Bd);if(Ad!==N){var ad=T;Da++;var $e=C();Da--;$e===N?ad=void 0:(T=ad,ad=N);ad!==N?Bc=Ad=[Ad,ad]:(T=Bc,Bc=N)}else T=Bc,Bc=N;var je=Bc;je!==
N&&(je={type:"null",value:null});aa=je;if(aa===N){var Cc=T;var Dc=T;if(e.substr(T,4).toLowerCase()===Cd){var Fe=e.substr(T,4);T+=4}else Fe=N,0===Da&&k(Ec);if(Fe!==N){var Dd=T;Da++;var af=C();Da--;af===N?Dd=void 0:(T=Dd,Dd=N);Dd!==N?Dc="DATE":(T=Dc,Dc=N)}else T=Dc,Dc=N;if(Dc!==N){Ba();var Ge=U();Ge!==N?Cc={type:"date",value:Ge.value}:(T=Cc,Cc=N)}else T=Cc,Cc=N;aa=Cc;if(aa===N){var Fc=T;var Gc=T;if(e.substr(T,9).toLowerCase()===cc){var He=e.substr(T,9);T+=9}else He=N,0===Da&&k(Ed);if(He!==N){var Fd=
T;Da++;var bf=C();Da--;bf===N?Fd=void 0:(T=Fd,Fd=N);Fd!==N?Gc="TIMESTAMP":(T=Gc,Gc=N)}else T=Gc,Gc=N;if(Gc!==N){Ba();var Ie=U();Ie!==N?Fc={type:"timestamp",value:Ie.value}:(T=Fc,Fc=N)}else T=Fc,Fc=N;aa=Fc;if(aa===N){var mb=T;var ke=pa();if(ke!==N){Ba();if(45===e.charCodeAt(T)){var Tb=ub;T++}else Tb=N,0===Da&&k(Xc);Tb===N&&(43===e.charCodeAt(T)?(Tb=lb,T++):(Tb=N,0===Da&&k(yc)));if(Tb!==N){Ba();var bd=U();if(bd!==N){Ba();var Je=P();Je!==N?mb={type:"interval",value:bd,qualifier:Je,op:Tb}:(T=mb,mb=N)}else T=
mb,mb=N}else T=mb,mb=N}else T=mb,mb=N;mb===N&&(mb=T,ke=pa(),ke!==N?(Ba(),Tb=U(),Tb!==N?(Ba(),bd=P(),bd!==N?mb={type:"interval",value:Tb,qualifier:bd,op:""}:(T=mb,mb=N)):(T=mb,mb=N)):(T=mb,mb=N));aa=mb}}}}}}var gb=aa;if(gb===N){var vb=T;var Hc=T;if(e.substr(T,7).toLowerCase()===fb){var Ke=e.substr(T,7);T+=7}else Ke=N,0===Da&&k(Ub);if(Ke!==N){var Gd=T;Da++;var cf=C();Da--;cf===N?Gd=void 0:(T=Gd,Gd=N);Gd!==N?Hc="EXTRACT":(T=Hc,Hc=N)}else T=Hc,Hc=N;if(Hc!==N){Ba();var df=Ia();if(df!==N){Ba();var Db=sa();
Db===N&&(Db=ta(),Db===N&&(Db=ya(),Db===N&&(Db=za(),Db===N&&(Db=la(),Db===N&&(Db=oa())))));var Le=Db;if(Le!==N){Ba();var ef=da();if(ef!==N){Ba();var Me=a();if(Me!==N){Ba();var ff=Ma();ff!==N?vb={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Le},Me]}}:(T=vb,vb=N)}else T=vb,vb=N}else T=vb,vb=N}else T=vb,vb=N}else T=vb,vb=N}else T=vb,vb=N;gb=vb;if(gb===N){var wb=T;var Ic=T;if(e.substr(T,9).toLowerCase()===ab){var Ne=e.substr(T,9);T+=9}else Ne=N,0===Da&&k(Jc);
if(Ne!==N){var Hd=T;Da++;var gf=C();Da--;gf===N?Hd=void 0:(T=Hd,Hd=N);Hd!==N?Ic="SUBSTRING":(T=Ic,Ic=N)}else T=Ic,Ic=N;if(Ic!==N){Ba();var hf=Ia();if(hf!==N){Ba();var le=a();if(le!==N){Ba();var jf=da();if(jf!==N){Ba();var me=a();if(me!==N){Ba();var Vb=T;var Kc=T;if(e.substr(T,3).toLowerCase()===Ya){var Oe=e.substr(T,3);T+=3}else Oe=N,0===Da&&k(lc);if(Oe!==N){var Id=T;Da++;var kf=C();Da--;kf===N?Id=void 0:(T=Id,Id=N);Id!==N?Kc="FOR":(T=Kc,Kc=N)}else T=Kc,Kc=N;var cd=Kc;if(cd!==N){var lf=Ba();var Pe=
a();if(Pe!==N){var mf=Ba();Vb=cd=[cd,lf,Pe,mf]}else T=Vb,Vb=N}else T=Vb,Vb=N;Vb===N&&(Vb=null);cd=Ma();cd!==N?wb={type:"function",name:"substring",args:{type:"expression-list",value:Vb?[le,me,Vb[2]]:[le,me]}}:(T=wb,wb=N)}else T=wb,wb=N}else T=wb,wb=N}else T=wb,wb=N}else T=wb,wb=N}else T=wb,wb=N;gb=wb;if(gb===N){var hb=T;var ne=ja();if(ne!==N){Ba();var oe=Ia();if(oe!==N){Ba();var Wb=J();Wb===N&&(Wb=null);Ba();var dd=a();if(dd!==N){Ba();var pe=da();if(pe!==N){Ba();var Qe=a();if(Qe!==N){Ba();var nf=
Ma();nf!==N?hb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Wb?"BOTH":Wb},dd,Qe]}}:(T=hb,hb=N)}else T=hb,hb=N}else T=hb,hb=N}else T=hb,hb=N}else T=hb,hb=N}else T=hb,hb=N;hb===N&&(hb=T,ne=ja(),ne!==N?(Ba(),oe=Ia(),oe!==N?(Ba(),Wb=J(),Wb===N&&(Wb=null),Ba(),dd=a(),dd!==N?(Ba(),pe=Ma(),pe!==N?hb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Wb?"BOTH":Wb},dd]}}:(T=hb,hb=N)):(T=hb,hb=N)):(T=hb,hb=N)):(T=hb,hb=
N));gb=hb;if(gb===N){var xb=T;var Lc=T;if(e.substr(T,8).toLowerCase()===Jd){var Re=e.substr(T,8);T+=8}else Re=N,0===Da&&k(Kd);if(Re!==N){var Ld=T;Da++;var of=C();Da--;of===N?Ld=void 0:(T=Ld,Ld=N);Ld!==N?Lc="POSITION":(T=Lc,Lc=N)}else T=Lc,Lc=N;if(Lc!==N){Ba();var pf=Ia();if(pf!==N){Ba();var Se=a();if(Se!==N){Ba();var qf=L();if(qf!==N){Ba();var Te=a();if(Te!==N){Ba();var rf=Ma();rf!==N?xb={type:"function",name:"position",args:{type:"expression-list",value:[Se,Te]}}:(T=xb,xb=N)}else T=xb,xb=N}else T=
xb,xb=N}else T=xb,xb=N}else T=xb,xb=N}else T=xb,xb=N;gb=xb;if(gb===N){var dc=T;var Md;var Eb=T;Eb=Md=I();if(Eb===N)if(Eb=T,96===e.charCodeAt(T)?(Md=yb,T++):(Md=N,0===Da&&k(ed)),Md!==N){var Nd=[];if(mc.test(e.charAt(T))){var Xb=e.charAt(T);T++}else Xb=N,0===Da&&k(Od);if(Xb!==N)for(;Xb!==N;)Nd.push(Xb),mc.test(e.charAt(T))?(Xb=e.charAt(T),T++):(Xb=N,0===Da&&k(Od));else Nd=N;Nd!==N?(96===e.charCodeAt(T)?(Xb=yb,T++):(Xb=N,0===Da&&k(ed)),Xb!==N?Eb=Nd.join(""):(T=Eb,Eb=N)):(T=Eb,Eb=N)}else T=Eb,Eb=N;var Ue=
Eb;if(Ue!==N){Ba();var sf=Ia();if(sf!==N){Ba();var Pd=b();Pd===N&&(Pd=null);Ba();var tf=Ma();tf!==N?dc={type:"function",name:Ue,args:Pd?Pd:{type:"expression-list",value:[]}}:(T=dc,dc=N)}else T=dc,dc=N}else T=dc,dc=N;gb=dc;if(gb===N){var Jb;var nb=T;var qe=va();if(qe!==N){Ba();var fd=a();if(fd!==N){Ba();var gd=[];for(Jb=R();Jb!==N;)gd.push(Jb),Jb=R();Jb=Ba();var Qd=Ca();Qd!==N?nb={type:"case-expression",format:"simple",operand:fd,clauses:gd,else:null}:(T=nb,nb=N)}else T=nb,nb=N}else T=nb,nb=N;if(nb===
N)if(nb=T,qe=va(),qe!==N)if(Ba(),fd=a(),fd!==N){Ba();gd=[];for(Jb=R();Jb!==N;)gd.push(Jb),Jb=R();Jb=Ba();Qd=V();if(Qd!==N){Ba();var uf=Ca();uf!==N?nb={type:"case-expression",format:"simple",operand:fd,clauses:gd,else:Qd.value}:(T=nb,nb=N)}else T=nb,nb=N}else T=nb,nb=N;else T=nb,nb=N;var re=nb;if(re===N){var Kb;var rb=T;var se=va();if(se!==N){Ba();var hd=[];for(Kb=O();Kb!==N;)hd.push(Kb),Kb=O();Kb=Ba();var Rd=Ca();Rd!==N?rb={type:"case-expression",format:"searched",clauses:hd,else:null}:(T=rb,rb=N)}else T=
rb,rb=N;if(rb===N)if(rb=T,se=va(),se!==N){Ba();hd=[];for(Kb=O();Kb!==N;)hd.push(Kb),Kb=O();Kb=Ba();Rd=V();if(Rd!==N){Ba();var vf=Ca();vf!==N?rb={type:"case-expression",format:"searched",clauses:hd,else:Rd.value}:(T=rb,rb=N)}else T=rb,rb=N}else T=rb,rb=N;re=rb}gb=re;if(gb===N){var Sd;var Td=T;var Ve=D();if(Ve!==N){var We=[];for(Sd=F();Sd!==N;)We.push(Sd),Sd=F();Td=Ve+We.join("")}else T=Td,Td=N;var Ud=Td;if(Ud!==N){var te=Ud;Ud=/^CURRENT_DATE$/i.test(te)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(te)?
{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:te}}gb=Ud;if(gb===N&&(gb=K(),gb===N)){gb=T;var wf=Ia();if(wf!==N){Ba();var ue=a();if(ue!==N){Ba();var xf=Ma();xf!==N?(ue.paren=!0,gb=ue):(T=gb,gb=N)}else T=gb,gb=N}else T=gb,gb=N}}}}}}}}return gb}function I(){var aa;var fa=T;var ra=D();if(ra!==N){fa=[];for(aa=C();aa!==N;)fa.push(aa),aa=C();fa=ra+fa.join("")}else T=fa,fa=N;return fa}function D(){if(Lb.test(e.charAt(T))){var aa=e.charAt(T);T++}else aa=N,0===Da&&k(Mb);return aa}
function C(){if(id.test(e.charAt(T))){var aa=e.charAt(T);T++}else aa=N,0===Da&&k(Nb);return aa}function F(){if(jd.test(e.charAt(T))){var aa=e.charAt(T);T++}else aa=N,0===Da&&k(Fb);return aa}function K(){var aa=T;if(64===e.charCodeAt(T)){var fa=Ob;T++}else fa=N,0===Da&&k(Vd);if(fa!==N){var ra=I();ra!==N?aa=fa=[fa,ra]:(T=aa,aa=N)}else T=aa,aa=N;aa!==N&&(aa={type:"parameter",value:aa[1]});return aa}function J(){var aa=T;if(e.substr(T,7).toLowerCase()===ec){var fa=e.substr(T,7);T+=7}else fa=N,0===Da&&
k(Wd);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="LEADING":(T=aa,aa=N)}else T=aa,aa=N;aa===N&&(aa=T,e.substr(T,8).toLowerCase()===nc?(fa=e.substr(T,8),T+=8):(fa=N,0===Da&&k(kd)),fa!==N?(fa=T,Da++,ra=C(),Da--,ra===N?fa=void 0:(T=fa,fa=N),fa!==N?aa="TRAILING":(T=aa,aa=N)):(T=aa,aa=N),aa===N&&(aa=T,e.substr(T,4).toLowerCase()===ld?(fa=e.substr(T,4),T+=4):(fa=N,0===Da&&k(Gb)),fa!==N?(fa=T,Da++,ra=C(),Da--,ra===N?fa=void 0:(T=fa,fa=N),fa!==N?aa="BOTH":(T=aa,aa=N)):(T=aa,
aa=N)));return aa}function P(){var aa=T;var fa=T;var ra=S();if(ra!==N){Ba();var Ea=Ia();if(Ea!==N)if(Ba(),Ea=ha(),Ea!==N){Ba();var La=Ma();La!==N?fa={type:"interval-period",period:ra.value,precision:Ea,secondary:null}:(T=fa,fa=N)}else T=fa,fa=N;else T=fa,fa=N}else T=fa,fa=N;fa===N&&(fa=T,ra=S(),ra!==N&&(ra={type:"interval-period",period:ra.value,precision:null,secondary:null}),fa=ra);if(fa!==N)if(Ba(),ra=T,e.substr(T,2).toLowerCase()===oc?(Ea=e.substr(T,2),T+=2):(Ea=N,0===Da&&k(fc)),Ea!==N?(Ea=T,
Da++,La=C(),Da--,La===N?Ea=void 0:(T=Ea,Ea=N),Ea!==N?ra="TO":(T=ra,ra=N)):(T=ra,ra=N),ra!==N){Ba();ra=T;Ea=S();Ea!==N&&(Ea={type:"interval-period",period:Ea.value,precision:null,secondary:null});ra=Ea;if(ra===N){ra=T;Ea=oa();if(Ea!==N)if(Ba(),Ea=Ia(),Ea!==N)if(Ba(),Ea=ha(),Ea!==N)if(Ba(),La=Ka(),La!==N)if(Ba(),La=X(),La!==N){Ba();var Ua=Ma();Ua!==N?ra={type:"interval-period",period:"second",precision:Ea,secondary:La}:(T=ra,ra=N)}else T=ra,ra=N;else T=ra,ra=N;else T=ra,ra=N;else T=ra,ra=N;else T=ra,
ra=N;ra===N&&(ra=T,Ea=oa(),Ea!==N?(Ba(),Ea=Ia(),Ea!==N?(Ba(),Ea=ha(),Ea!==N?(Ba(),La=Ma(),La!==N?ra={type:"interval-period",period:"second",precision:Ea,secondary:null}:(T=ra,ra=N)):(T=ra,ra=N)):(T=ra,ra=N)):(T=ra,ra=N),ra===N&&(ra=T,Ea=oa(),Ea!==N&&(Ea={type:"interval-period",period:"second",precision:null,secondary:null}),ra=Ea))}ra!==N?aa={type:"interval-qualifier",start:fa,end:ra}:(T=aa,aa=N)}else T=aa,aa=N;else T=aa,aa=N;aa===N&&(aa=T,ra=S(),ra!==N?(Ba(),fa=Ia(),fa!==N?(Ba(),fa=X(),fa!==N?(Ba(),
Ea=Ma(),Ea!==N?aa={type:"interval-period",period:ra.value,precision:fa,secondary:null}:(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N),aa===N&&(aa=T,ra=S(),ra!==N&&(ra={type:"interval-period",period:ra.value,precision:null,secondary:null}),aa=ra,aa===N&&(aa=T,ra=oa(),ra!==N?(Ba(),fa=Ia(),fa!==N?(Ba(),fa=ha(),fa!==N?(Ba(),Ea=Ka(),Ea!==N?(Ba(),ra=X(),ra!==N?(Ba(),Ea=Ma(),Ea!==N?aa={type:"interval-period",period:"second",precision:fa,secondary:ra}:(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N)):
(T=aa,aa=N)):(T=aa,aa=N),aa===N&&(aa=T,ra=oa(),ra!==N?(Ba(),fa=Ia(),fa!==N?(Ba(),fa=X(),fa!==N?(Ba(),Ea=Ma(),Ea!==N?aa={type:"interval-period",period:"second",precision:fa,secondary:null}:(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N)):(T=aa,aa=N),aa===N&&(aa=T,ra=oa(),ra!==N&&(ra={type:"interval-period",period:"second",precision:null,secondary:null}),aa=ra)))));return aa}function S(){var aa=T;aa=ya();aa!==N&&(aa={type:"string",value:"day"});aa===N&&(aa=T,aa=za(),aa!==N&&(aa={type:"string",value:"hour"}),
aa===N&&(aa=T,aa=la(),aa!==N&&(aa={type:"string",value:"minute"}),aa===N&&(aa=T,aa=ta(),aa!==N&&(aa={type:"string",value:"month"}),aa===N&&(aa=T,aa=sa(),aa!==N&&(aa={type:"string",value:"year"})))));return aa}function X(){var aa=wa();aa!==N&&(aa=parseFloat(aa));return aa}function ha(){var aa=wa();aa!==N&&(aa=parseFloat(aa));return aa}function U(){var aa=Q();aa===N&&(aa=K());return aa}function Q(){var aa=T;if(39===e.charCodeAt(T)){var fa=qb;T++}else fa=N,0===Da&&k(md);fa===N&&(e.substr(T,2)===db?(fa=
db,T+=2):(fa=N,0===Da&&k(ve)));if(fa!==N){fa=[];var ra=T;e.substr(T,2)===Xa?(ra=Xa,T+=2):(ra=N,0===Da&&k(Xd));ra!==N&&(ra="'");ra===N&&(pc.test(e.charAt(T))?(ra=e.charAt(T),T++):(ra=N,0===Da&&k(qc)));for(;ra!==N;)fa.push(ra),ra=T,e.substr(T,2)===Xa?(ra=Xa,T+=2):(ra=N,0===Da&&k(Xd)),ra!==N&&(ra="'"),ra===N&&(pc.test(e.charAt(T))?(ra=e.charAt(T),T++):(ra=N,0===Da&&k(qc)));39===e.charCodeAt(T)?(ra=qb,T++):(ra=N,0===Da&&k(md));ra!==N?aa={type:"string",value:fa.join("")}:(T=aa,aa=N)}else T=aa,aa=N;return aa}
function O(){var aa=T;if(Fa()!==N){Ba();var fa=a();if(fa!==N){Ba();var ra=Ja();ra!==N?(Ba(),ra=a(),ra!==N?aa={type:"when-clause",operand:fa,value:ra}:(T=aa,aa=N)):(T=aa,aa=N)}else T=aa,aa=N}else T=aa,aa=N;return aa}function R(){var aa=T;if(Fa()!==N){Ba();var fa=a();if(fa!==N){Ba();var ra=Ja();ra!==N?(Ba(),ra=a(),ra!==N?aa={type:"when-clause",operand:fa,value:ra}:(T=aa,aa=N)):(T=aa,aa=N)}else T=aa,aa=N}else T=aa,aa=N;return aa}function V(){var aa=T;var fa=T;if(e.substr(T,4).toLowerCase()===Mc){var ra=
e.substr(T,4);T+=4}else ra=N,0===Da&&k(nd);if(ra!==N){ra=T;Da++;var Ea=C();Da--;Ea===N?ra=void 0:(T=ra,ra=N);ra!==N?fa="ELSE":(T=fa,fa=N)}else T=fa,fa=N;fa!==N?(Ba(),fa=a(),fa!==N?aa={type:"else-clause",value:fa}:(T=aa,aa=N)):(T=aa,aa=N);return aa}function Z(){var aa=wa();if(aa===N){aa=T;if(45===e.charCodeAt(T)){var fa=ub;T++}else fa=N,0===Da&&k(Xc);fa===N&&(43===e.charCodeAt(T)?(fa=lb,T++):(fa=N,0===Da&&k(yc)));if(fa!==N){var ra=wa();ra!==N?aa=fa[0]+ra:(T=aa,aa=N)}else T=aa,aa=N}return aa}function ka(){var aa=
T;if(46===e.charCodeAt(T)){var fa=kb;T++}else fa=N,0===Da&&k(Pb);fa!==N?(aa=wa(),aa===N&&(aa=null),aa="."+(null!=aa?aa:"")):(T=aa,aa=N);return aa}function ia(){var aa;var fa=aa=T;if(Yb.test(e.charAt(T))){var ra=e.charAt(T);T++}else ra=N,0===Da&&k(Ab);ra!==N?(Nc.test(e.charAt(T))?(fa=e.charAt(T),T++):(fa=N,0===Da&&k(Oc)),fa===N&&(fa=null),fa="e"+(null===fa?"":fa)):(T=fa,fa=N);fa!==N?(ra=wa(),ra!==N?aa=fa+ra:(T=aa,aa=N)):(T=aa,aa=N);return aa}function wa(){var aa=[];var fa=ea();if(fa!==N)for(;fa!==
N;)aa.push(fa),fa=ea();else aa=N;aa!==N&&(aa=aa.join(""));return aa}function ea(){if(we.test(e.charAt(T))){var aa=e.charAt(T);T++}else aa=N,0===Da&&k(sb);return aa}function L(){var aa=T;if(e.substr(T,2).toLowerCase()===na){var fa=e.substr(T,2);T+=2}else fa=N,0===Da&&k(xe);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="IN":(T=aa,aa=N)}else T=aa,aa=N;return aa}function M(){var aa=T;if(e.substr(T,2).toLowerCase()===ua){var fa=e.substr(T,2);T+=2}else fa=N,0===Da&&k(Yd);if(fa!==
N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="IS":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ba(){var aa=T;if(e.substr(T,4).toLowerCase()===qa){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(Zd);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="LIKE":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ca(){var aa=T;if(e.substr(T,3).toLowerCase()===Ga){var fa=e.substr(T,3);T+=3}else fa=N,0===Da&&k(ye);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:
(T=fa,fa=N);fa!==N?aa="NOT":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ma(){var aa=T;if(e.substr(T,3).toLowerCase()===Ha){var fa=e.substr(T,3);T+=3}else fa=N,0===Da&&k($d);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="AND":(T=aa,aa=N)}else T=aa,aa=N;return aa}function W(){var aa=T;if(e.substr(T,2).toLowerCase()===Na){var fa=e.substr(T,2);T+=2}else fa=N,0===Da&&k(ze);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="OR":(T=aa,aa=N)}else T=
aa,aa=N;return aa}function Y(){var aa=T;if(e.substr(T,7).toLowerCase()===Pa){var fa=e.substr(T,7);T+=7}else fa=N,0===Da&&k(ae);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="BETWEEN":(T=aa,aa=N)}else T=aa,aa=N;return aa}function da(){var aa=T;if(e.substr(T,4).toLowerCase()===eb){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(be);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="FROM":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ja(){var aa=
T;if(e.substr(T,4).toLowerCase()===ib){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(ce);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="TRIM":(T=aa,aa=N)}else T=aa,aa=N;return aa}function pa(){var aa=T;if(e.substr(T,8).toLowerCase()===de){var fa=e.substr(T,8);T+=8}else fa=N,0===Da&&k(rc);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="INTERVAL":(T=aa,aa=N)}else T=aa,aa=N;return aa}function sa(){var aa=T;if(e.substr(T,4).toLowerCase()===sc){var fa=
e.substr(T,4);T+=4}else fa=N,0===Da&&k(Pc);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="YEAR":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ta(){var aa=T;if(e.substr(T,5).toLowerCase()===Ae){var fa=e.substr(T,5);T+=5}else fa=N,0===Da&&k(od);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="MONTH":(T=aa,aa=N)}else T=aa,aa=N;return aa}function ya(){var aa=T;if(e.substr(T,3).toLowerCase()===pd){var fa=e.substr(T,3);T+=3}else fa=N,0===Da&&k(qd);
if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="DAY":(T=aa,aa=N)}else T=aa,aa=N;return aa}function za(){var aa=T;if(e.substr(T,4).toLowerCase()===Qc){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(tc);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="HOUR":(T=aa,aa=N)}else T=aa,aa=N;return aa}function la(){var aa=T;if(e.substr(T,6).toLowerCase()===Rc){var fa=e.substr(T,6);T+=6}else fa=N,0===Da&&k(ee);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===
N?fa=void 0:(T=fa,fa=N);fa!==N?aa="MINUTE":(T=aa,aa=N)}else T=aa,aa=N;return aa}function oa(){var aa=T;if(e.substr(T,6).toLowerCase()===uc){var fa=e.substr(T,6);T+=6}else fa=N,0===Da&&k(rd);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="SECOND":(T=aa,aa=N)}else T=aa,aa=N;return aa}function va(){var aa=T;if(e.substr(T,4).toLowerCase()===sd){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(Sc);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="CASE":
(T=aa,aa=N)}else T=aa,aa=N;return aa}function Ca(){var aa=T;if(e.substr(T,3).toLowerCase()===Be){var fa=e.substr(T,3);T+=3}else fa=N,0===Da&&k(fe);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="END":(T=aa,aa=N)}else T=aa,aa=N;return aa}function Fa(){var aa=T;if(e.substr(T,4).toLowerCase()===Tc){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(Ce);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="WHEN":(T=aa,aa=N)}else T=aa,aa=N;return aa}function Ja(){var aa=
T;if(e.substr(T,4).toLowerCase()===Zb){var fa=e.substr(T,4);T+=4}else fa=N,0===Da&&k(De);if(fa!==N){fa=T;Da++;var ra=C();Da--;ra===N?fa=void 0:(T=fa,fa=N);fa!==N?aa="THEN":(T=aa,aa=N)}else T=aa,aa=N;return aa}function Ka(){if(44===e.charCodeAt(T)){var aa=td;T++}else aa=N,0===Da&&k(Qb);return aa}function Ia(){if(40===e.charCodeAt(T)){var aa=gc;T++}else aa=N,0===Da&&k(vc);return aa}function Ma(){if(41===e.charCodeAt(T)){var aa=Ee;T++}else aa=N,0===Da&&k($b);return aa}function Ba(){var aa;var fa=[];
for(aa=Oa();aa!==N;)fa.push(aa),aa=Oa();return fa}function Oa(){if(ud.test(e.charAt(T))){var aa=e.charAt(T);T++}else aa=N,0===Da&&k(vd);return aa}function Za(aa,fa,ra,Ea){aa={type:"binary-expression",operator:aa,left:fa,right:ra};void 0!==Ea&&(aa.escape=Ea);return aa}function $a(aa,fa){for(var ra=0;ra<fa.length;ra++)aa=Za(fa[ra][1],aa,fa[ra][3]);return aa}h=void 0!==h?h:{};var N={},Wa=h.grammarSource,Ra={start:c},bb=c,cb="!",Sa="\x3d",jb="\x3e\x3d",ob="\x3e",Bb="\x3c\x3d",xa="\x3c\x3e",ac="\x3c",
Cb="!\x3d",lb="+",ub="-",hc="*",Sb="/",Ob="@",qb="'",db="N'",Xa="''",kb=".",pb="null",Ta="true",zb="false",na="in",ua="is",qa="like",Aa="escape",Ga="not",Ha="and",Na="or",Pa="between",eb="from",Ya="for",ab="substring",fb="extract",ib="trim",Jd="position",cc="timestamp",Cd="date",ec="leading",nc="trailing",ld="both",oc="to",de="interval",sc="year",Ae="month",pd="day",Qc="hour",Rc="minute",uc="second",sd="case",Be="end",Tc="when",Zb="then",Mc="else",td=",",gc="(",Ee=")",yb="`",Lb=/^[A-Za-z_\x80-\uFFFF]/,
id=/^[A-Za-z0-9_]/,jd=/^[A-Za-z0-9_.\x80-\uFFFF]/,pc=/^[^']/,we=/^[0-9]/,Yb=/^[eE]/,Nc=/^[+\-]/,ud=/^[ \t\n\r]/,mc=/^[^`]/,ge=d("!",!1),Hb=d("\x3d",!1),wc=d("\x3e\x3d",!1),Vc=d("\x3e",!1),Ib=d("\x3c\x3d",!1),Wc=d("\x3c\x3e",!1),bc=d("\x3c",!1),xc=d("!\x3d",!1),yc=d("+",!1),Xc=d("-",!1),he=d("*",!1),ic=d("/",!1),Mb=l([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Nb=l([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Fb=l([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Vd=d("@",!1),
md=d("'",!1),ve=d("N'",!1),Xd=d("''",!1),qc=l(["'"],!0,!1),Pb=d(".",!1),sb=l([["0","9"]],!1,!1),Ab=l(["e","E"],!1,!1),Oc=l(["+","-"],!1,!1),Bd=d("NULL",!0),jc=d("TRUE",!0),ie=d("FALSE",!0),xe=d("IN",!0),Yd=d("IS",!0),Zd=d("LIKE",!0),wd=d("ESCAPE",!0),ye=d("NOT",!0),$d=d("AND",!0),ze=d("OR",!0),ae=d("BETWEEN",!0),be=d("FROM",!0),lc=d("FOR",!0),Jc=d("SUBSTRING",!0),Ub=d("EXTRACT",!0),ce=d("TRIM",!0),Kd=d("POSITION",!0),Ed=d("TIMESTAMP",!0),Ec=d("DATE",!0),Wd=d("LEADING",!0),kd=d("TRAILING",!0),Gb=d("BOTH",
!0),fc=d("TO",!0),rc=d("INTERVAL",!0),Pc=d("YEAR",!0),od=d("MONTH",!0),qd=d("DAY",!0),tc=d("HOUR",!0),ee=d("MINUTE",!0),rd=d("SECOND",!0),Sc=d("CASE",!0),fe=d("END",!0),Ce=d("WHEN",!0),De=d("THEN",!0),nd=d("ELSE",!0),Qb=d(",",!1),vc=d("(",!1),$b=d(")",!1),vd=l([" ","\t","\n","\r"],!1,!1),ed=d("`",!1),Od=l(["`"],!0,!1),T=0,Rb=[{line:1,column:1}],tb=0,Uc=[],Da=0;if("startRule"in h){if(!(h.startRule in Ra))throw Error("Can't start parsing from rule \""+h.startRule+'".');bb=Ra[h.startRule]}var Qa=bb();
if(Qa!==N&&T===e.length)return Qa;Qa!==N&&T<e.length&&k({type:"end"});throw function(aa,fa,ra){return new A(A.buildMessage(aa,fa),aa,fa,ra)}(Uc,tb<e.length?e.charAt(tb):null,tb<e.length?r(tb,tb+1):r(tb,tb));}}})})(E);let B=function(){function u(){}u.parse=function(A){return E.exports.parse(A)};return u}();v.WhereGrammar=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(v){v.commonjsGlobal=
"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};v.commonjsRequire=function(t){throw Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.');};v.getDefaultExportFromCjs=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:
t}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(v,t,E,B,u,A,x){function e(b,a){if(!a)return null;if("x"in a){var g={x:0,y:0};[g.x,g.y]=b(a.x,a.y,m);null!=a.z&&(g.z=a.z);null!=a.m&&(g.m=a.m);return g}return"xmin"in a?(g={xmin:0,
ymin:0,xmax:0,ymax:0},[g.xmin,g.ymin]=b(a.xmin,a.ymin,m),[g.xmax,g.ymax]=b(a.xmax,a.ymax,m),a.hasZ&&(g.zmin=a.zmin,g.zmax=a.zmax,g.hasZ=!0),a.hasM&&(g.mmin=a.mmin,g.mmax=a.mmax,g.hasM=!0),g):"rings"in a?{rings:h(a.rings,b),hasM:a.hasM,hasZ:a.hasZ}:"paths"in a?{paths:h(a.paths,b),hasM:a.hasM,hasZ:a.hasZ}:"points"in a?{points:d(a.points,b),hasM:a.hasM,hasZ:a.hasZ}:null}function h(b,a){const g=[];for(const n of b)g.push(d(n,a));return g}function d(b,a){const g=[];for(const n of b)b=a(n[0],n[1],[0,0]),
g.push(b),2<n.length&&b.push(n[2]),3<n.length&&b.push(n[3]);return g}function l(){l=t._asyncToGenerator(function*(b,a){b&&a&&(b=Array.isArray(b)?b.map(g=>E.isSome(g.geometry)?g.geometry.spatialReference:null).filter(E.isSome):[b],yield B.initializeProjection(b.map(g=>({source:g,dest:a}))))});return l.apply(this,arguments)}const m=[0,0],r=e.bind(null,x.lngLatToXY),k=e.bind(null,x.xyToLngLat),c=new (function(){function b(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var a=
b.prototype;a.push=function(){var g=t._asyncToGenerator(function*(n,f,q){if(!(n&&n.length&&f&&q)||A.equals(f,q))return n;const p={geometries:n,inSpatialReference:f,outSpatialReference:q,resolve:null};this._jobs.push(p);return new Promise(z=>{p.resolve=z;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(n,f,q){return g.apply(this,arguments)}}();a._process=function(){this._timer=null;const g=this._jobs.shift();if(g){var {geometries:n,inSpatialReference:f,outSpatialReference:q,
resolve:p}=g;x.canProject(f,q)?A.isWebMercator(q)?p(n.map(r)):p(n.map(k)):p(B.projectMany(u.jsonAdapter,n,f,q,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return b}());v.checkProjectionSupport=function(b,a){return l.apply(this,arguments)};v.project=function(b,a,g,n){if(!b)return b;g||(g=a,a=b.spatialReference);return A.isValid(a)&&A.isValid(g)&&!A.equals(a,g)?x.canProject(a,g)?(b=A.isWebMercator(g)?r(b):k(b),b.spatialReference=g,b):B.projectMany(u.jsonAdapter,[b],
a,g,null,n)[0]:b};v.projectMany=function(b,a,g){return c.push(b,a,g)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/tracking ../core/accessorSupport/tracking/SimpleObservable ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./projectionEllipsoid ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/SupportedGCSWkids ./support/zscale".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z,w,y,G,H){function I(){return!!bb&&b.isLoaded()}function D(na){A.isNone(Sa)&&(Sa=Promise.all([b.load(),(new Promise((ua,qa)=>v(["../chunks/geometryEngineBase"],ua,qa))).then(ua=>ua.geometryEngineBase),new Promise((ua,qa)=>v(["./geometryAdapters/hydrated"],ua,qa))]));return Sa.then(([,ua,{hydratedAdapter:qa}])=>{x.throwIfAborted(na);cb=qa;bb=ua.default;bb._enableProjection(b.pe);ob.notify()})}function C(na,ua,qa=null,Aa=null){return Array.isArray(na)?
0===na.length?[]:F(cb,na,na[0].spatialReference,ua,qa,Aa):F(cb,[na],na.spatialReference,ua,qa,Aa)[0]}function F(na,ua,qa,Aa,Ga=null,Ha=null){if(A.isNone(qa)||A.isNone(Aa))return ua;if(S(qa,Aa,Ga))return ua.map(Na=>A.unwrap(ha(Na,qa,Aa)));if(A.isNone(Ga)){const Na=w.cacheKey(qa,Aa);void 0!==jb[Na]?Ga=jb[Na]:(Ga=J(qa,Aa,void 0),A.isNone(Ga)&&(Ga=new w),jb[Na]=Ga)}if(A.isNone(bb)||A.isNone(na))throw new Bb;return A.isSome(Ha)?bb._project(na,ua,qa,Aa,Ga,Ha):bb._project(na,ua,qa,Aa,Ga)}function K(na,ua){if(!I())for(const qa of na)if(A.isSome(qa)&&
!y.equals(qa.spatialReference,ua)&&y.isValid(qa.spatialReference)&&y.isValid(ua)&&!S(qa.spatialReference,ua))return h.trackAccess(ob),{pending:D(),geometries:null};return{pending:null,geometries:na.map(qa=>A.isNone(qa)?null:y.equals(qa.spatialReference,ua)?qa:y.isValid(qa.spatialReference)&&y.isValid(ua)?P(qa,ua):null)}}function J(na,ua,qa=null){if(A.isNone(na)||A.isNone(ua))return null;if(A.isNone(bb)||A.isNone(cb))throw new Bb;na=bb._getTransformation(cb,na,ua,qa,qa?.spatialReference);return null!==
na?w.fromGE(na):null}function P(na,ua){try{const qa=C(na,ua);if(null==qa)return null;"xmin"in na&&"xmin"in qa&&(qa.zmin=na.zmin,qa.zmax=na.zmax);const Aa=H.getGeometryZScaler(qa.type,na.spatialReference,ua);A.isSome(Aa)&&Aa(qa);return qa}catch(qa){if(!(qa instanceof Bb))throw qa;return null}}function S(na,ua,qa){return qa?!1:y.equals(na,ua)?!0:y.isValid(na)&&y.isValid(ua)&&!!N(na,ua,Sb)}function X(){X=E._asyncToGenerator(function*(na,ua,qa,Aa){if(I())return x.waitTick(Aa);if(Array.isArray(na))for(const {source:Ga,
dest:Ha,geographicTransformation:Na}of na){if(!S(Ga,Ha,Na))return D(Aa)}else if(!S(na,ua,qa))return D(Aa);return x.waitTick(Aa)});return X.apply(this,arguments)}function ha(na,ua,qa){return na?"x"in na?U(na,ua,new a,qa,0):"xmin"in na?V(na,ua,new k,qa,0):"rings"in na?R(na,ua,new g,qa,0):"paths"in na?O(na,ua,new n,qa,0):"points"in na?Q(na,ua,new c,qa,0):null:null}function U(na,ua,qa,Aa,Ga){Ta[0]=na.x;Ta[1]=na.y;const Ha=na.z;Ta[2]=void 0!==Ha?Ha:Ga;if(!wa(Ta,ua,0,Ta,Aa,0,1))return null;qa.x=Ta[0];qa.y=
Ta[1];qa.spatialReference=Aa;void 0===Ha?(qa.z=void 0,qa.hasZ=!1):(qa.z=Ta[2],qa.hasZ=!0);void 0===na.m?(qa.m=void 0,qa.hasM=!1):(qa.m=na.m,qa.hasM=!0);return qa}function Q(na,ua,qa,Aa,Ga){const {points:Ha,hasZ:Na,hasM:Pa}=na;na=[];const eb=Ha.length,Ya=[];for(var ab of Ha)Ya.push(ab[0],ab[1],Na?ab[2]:Ga);if(!wa(Ya,ua,0,Ya,Aa,0,eb))return null;for(ua=0;ua<eb;++ua){Ga=3*ua;ab=Ya[Ga];const fb=Ya[Ga+1];Na&&Pa?na.push([ab,fb,Ya[Ga+2],Ha[ua][3]]):Na?na.push([ab,fb,Ya[Ga+2]]):Pa?na.push([ab,fb,Ha[ua][2]]):
na.push([ab,fb])}qa.points=na;qa.spatialReference=Aa;qa.hasZ=Na;qa.hasM=Pa;return qa}function O(na,ua,qa,Aa,Ga){const {paths:Ha,hasZ:Na,hasM:Pa}=na;na=[];if(!ea(Ha,Na??!1,Pa??!1,ua,na,Aa,Ga))return null;qa.paths=na;qa.spatialReference=Aa;qa.hasZ=Na;qa.hasM=Pa;return qa}function R(na,ua,qa,Aa,Ga){const {rings:Ha,hasZ:Na,hasM:Pa}=na;na=[];if(!ea(Ha,Na??!1,Pa??!1,ua,na,Aa,Ga))return null;qa.rings=na;qa.spatialReference=Aa;qa.hasZ=Na;qa.hasM=Pa;return qa}function V(na,ua,qa,Aa,Ga){const {xmin:Ha,ymin:Na,
xmax:Pa,ymax:eb,hasZ:Ya,hasM:ab}=na;if(!Z(Ha,Na,Ya?na.zmin:Ga,ua,Ta,Aa))return null;qa.xmin=Ta[0];qa.ymin=Ta[1];Ya&&(qa.zmin=Ta[2]);if(!Z(Pa,eb,Ya?na.zmax:Ga,ua,Ta,Aa))return null;qa.xmax=Ta[0];qa.ymax=Ta[1];Ya&&(qa.zmax=Ta[2]);ab&&(qa.mmin=na.mmin,qa.mmax=na.mmax);qa.spatialReference=Aa;return qa}function Z(na,ua,qa,Aa,Ga,Ha){Xa[0]=na;Xa[1]=ua;Xa[2]=qa;return wa(Xa,Aa,0,Ga,Ha,0,1)}function ka(na,ua,qa,Aa){if(A.isNone(ua)||A.isNone(Aa)||2>na.length)return!1;2===na.length&&(Xa[0]=na[0],Xa[1]=na[1],
Xa[2]=0,na=Xa);return wa(na,ua,0,qa,Aa,0,1)}function ia(na,ua,qa){if(A.isNone(ua))return!1;ua=ca(ua,ub);ua=lb[ua][xa.WGS84_COMPARABLE_LON_LAT];if(A.isNone(ua))return!1;ua(na,0,Xa,0);qa!==Xa&&(qa[0]=Xa[0],qa[1]=Xa[1],2<qa.length&&(qa[2]=Xa[2]));return!0}function wa(na,ua,qa,Aa,Ga,Ha,Na=1){ua=N(ua,Ga,Sb);if(A.isNone(ua))return!1;if(ua===ma){if(na===Aa&&qa===Ha)return!0;Na=qa+3*Na;for(let Pa=qa,eb=Ha;Pa<Na;Pa++,eb++)Aa[eb]=na[Pa];return!0}Na=qa+3*Na;for(let Pa=qa,eb=Ha;Pa<Na;Pa+=3,eb+=3)ua(na,Pa,Aa,
eb);return!0}function ea(na,ua,qa,Aa,Ga,Ha,Na=0){const Pa=[];for(const eb of na)for(const Ya of eb)Pa.push(Ya[0],Ya[1],ua?Ya[2]:Na);if(!wa(Pa,Aa,0,Pa,Ha,0,Pa.length/3))return!1;Aa=0;Ga.length=0;for(const eb of na){na=[];for(const Ya of eb)ua&&qa?na.push([Pa[Aa++],Pa[Aa++],Pa[Aa++],Ya[3]]):ua?na.push([Pa[Aa++],Pa[Aa++],Pa[Aa++]]):(qa?na.push([Pa[Aa++],Pa[Aa++],Ya[2]]):na.push([Pa[Aa++],Pa[Aa++]]),Aa++);Ga.push(na)}return!0}function L(na,ua,qa,Aa){ua=Aa+ua;if(ua<Aa/2||qa>ua)return Number.MAX_VALUE;
na=Math.abs(qb*na)+Math.asin(qa/ua);return na>=Math.PI/2?Number.MAX_VALUE:qa/Math.cos(na)}function M(na,ua,qa){const Aa=Math.sin(na);na=Math.cos(na);const Ga=Math.sin(ua);ua=Math.cos(ua);qa[0]=-Aa;qa[4]=-Ga*na;qa[8]=ua*na;qa[12]=0;qa[1]=na;qa[5]=-Ga*Aa;qa[9]=ua*Aa;qa[13]=0;qa[2]=0;qa[6]=ua;qa[10]=Ga;qa[14]=0;qa[3]=0;qa[7]=0;qa[11]=0;qa[15]=1;return qa}function ba(na,ua,qa){M(na,ua,qa);l.transpose(qa,qa);return qa}function ca(na,ua){if(!na)return xa.UNKNOWN;if(ua.spatialReference===na)return ua.spatialReferenceId;
ua.spatialReference=na;"metersPerUnit"in ua&&(ua.metersPerUnit=e.getMetersPerUnitForSR(na,1));return na.wkt===f.SphericalECEFSpatialReference.wkt?ua.spatialReferenceId=xa.SPHERICAL_ECEF:y.isWGS84(na)?ua.spatialReferenceId=xa.WGS84:y.isWebMercator(na)?ua.spatialReferenceId=xa.WEB_MERCATOR:y.isPlateCarree(na)?ua.spatialReferenceId=xa.PLATE_CARREE:na.wkt===f.WGS84ECEFSpatialReference.wkt?ua.spatialReferenceId=xa.WGS84_ECEF:na.wkid===G.SupportedGCSWkids.CGCS2000?ua.spatialReferenceId=xa.CGCS2000:na.wkt===
f.SphericalPCPFMars.wkt?ua.spatialReferenceId=xa.SPHERICAL_MARS_PCPF:na.wkt===f.SphericalPCPFMoon.wkt?ua.spatialReferenceId=xa.SPHERICAL_MOON_PCPF:y.isMars(na)?ua.spatialReferenceId=xa.GCSMARS2000:y.isMoon(na)?ua.spatialReferenceId=xa.GCSMOON2000:ua.spatialReferenceId=xa.UNKNOWN}function ma(na,ua,qa,Aa){na!==qa&&(qa[Aa++]=na[ua++],qa[Aa++]=na[ua++],qa[Aa]=na[ua])}function W(na,ua,qa,Aa){qa[Aa++]=db*(na[ua++]/p.earth.radius);qa[Aa++]=db*(Math.PI/2-2*Math.atan(Math.exp(-na[ua++]/p.earth.radius)));qa[Aa]=
na[ua]}function Y(na,ua,qa,Aa){W(na,ua,qa,Aa);va(qa,Aa,qa,Aa)}function da(na,ua,qa,Aa){W(na,ua,qa,Aa);Ba(qa,Aa,qa,Aa)}function ja(na,ua,qa,Aa,Ga){var Ha=.4999999*Math.PI;Ha=u.clamp(qb*na[ua+1],-Ha,Ha);Ha=Math.sin(Ha);qa[Aa++]=qb*na[ua]*Ga.radius;qa[Aa++]=Ga.halfSemiMajorAxis*Math.log((1+Ha)/(1-Ha));qa[Aa]=na[ua+2]}function pa(na,ua,qa,Aa){ja(na,ua,qa,Aa,p.earth)}function sa(na,ua,qa,Aa){qa[Aa]=na[ua]*ac;qa[Aa+1]=na[ua+1]*ac;qa[Aa+2]=na[ua+2]}function ta(na,ua,qa,Aa){qa[Aa]=na[ua]*Cb;qa[Aa+1]=na[ua+
1]*Cb;qa[Aa+2]=na[ua+2]}function ya(na,ua,qa,Aa){W(na,ua,qa,Aa);sa(qa,Aa,qa,Aa)}function za(na,ua,qa,Aa,Ga){Ga+=na[ua+2];const Ha=qb*na[ua+1];na=qb*na[ua];ua=Math.cos(Ha);qa[Aa++]=Math.cos(na)*ua*Ga;qa[Aa++]=Math.sin(na)*ua*Ga;qa[Aa]=Math.sin(Ha)*Ga}function la(na,ua,qa,Aa){za(na,ua,qa,Aa,p.moon.radius)}function oa(na,ua,qa,Aa){za(na,ua,qa,Aa,p.mars.radius)}function va(na,ua,qa,Aa){za(na,ua,qa,Aa,p.earth.radius)}function Ca(na,ua,qa,Aa,Ga){var Ha=na[ua];const Na=na[ua+1];ua=na[ua+2];na=Math.sqrt(Ha*
Ha+Na*Na+ua*ua);ua=u.asinClamped(ua/(0===na?1:na));Ha=Math.atan2(Na,Ha);qa[Aa++]=db*Ha;qa[Aa++]=db*ua;qa[Aa]=na-Ga}function Fa(na,ua,qa,Aa){Ca(na,ua,qa,Aa,p.moon.radius)}function Ja(na,ua,qa,Aa){Ca(na,ua,qa,Aa,p.mars.radius)}function Ka(na,ua,qa,Aa){Ca(na,ua,qa,Aa,p.earth.radius)}function Ia(na,ua,qa,Aa){Ka(na,ua,qa,Aa);pa(qa,Aa,qa,Aa)}function Ma(na,ua,qa,Aa){Ka(na,ua,qa,Aa);Ba(qa,Aa,qa,Aa)}function Ba(na,ua,qa,Aa){var Ga=p.earth;const Ha=qb*na[ua];var Na=qb*na[ua+1];na=na[ua+2];ua=Math.sin(Na);
Na=Math.cos(Na);const Pa=Ga.radius/Math.sqrt(1-Ga.eccentricitySquared*ua*ua);qa[Aa++]=(Pa+na)*Na*Math.cos(Ha);qa[Aa++]=(Pa+na)*Na*Math.sin(Ha);qa[Aa++]=(Pa*(1-Ga.eccentricitySquared)+na)*ua}function Oa(na,ua,qa,Aa){var Ga=z.earthEllipsoidConstants,Ha=na[ua],Na=na[ua+1];na=na[ua+2];let Pa;ua=Math.abs(na);var eb=Ha*Ha+Na*Na;var Ya=Math.sqrt(eb);var ab=eb+na*na;var fb=Math.sqrt(ab);Ha=Math.atan2(Na,Ha);var ib=na*na/ab;ab=eb/ab;Na=Ga.a2/fb;eb=Ga.a3-Ga.a4/fb;.3<ab?(ib=ua/fb*(1+ab*(Ga.a1+Na+ib*eb)/fb),
fb=Math.asin(ib),Na=ib*ib,ab=Math.sqrt(1-Na)):(ab=Ya/fb*(1-ib*(Ga.a5-Na-ab*eb)/fb),fb=Math.acos(ab),Na=1-ab*ab,ib=Math.sqrt(Na));Pa=1-p.earth.eccentricitySquared*Na;Na=p.earth.radius/Math.sqrt(Pa);Ga=Ga.a6*Na;Na=Ya-Na*ab;eb=ua-Ga*ib;ua=ab*Na+ib*eb;Ya=ab*eb-ib*Na;Ga=Ya/(Ga/Pa+ua);fb+=Ga;0>na&&(fb=-fb);qa[Aa++]=db*Ha;qa[Aa++]=db*fb;qa[Aa]=ua+Ya*Ga/2}function Za(na,ua,qa,Aa){Oa(na,ua,qa,Aa);va(qa,Aa,qa,Aa)}function $a(na,ua,qa,Aa){Oa(na,ua,qa,Aa);pa(qa,Aa,qa,Aa)}function N(na,ua,qa=Ra()){return A.isNone(na)||
A.isNone(ua)?null:Wa(na,ua,qa).projector}function Wa(na,ua,qa){if(A.isNone(na)||A.isNone(ua)||qa.source.spatialReference===na&&qa.dest.spatialReference===ua)return qa;const Aa=ca(na,qa.source),Ga=ca(ua,qa.dest);Aa===xa.UNKNOWN&&Ga===xa.UNKNOWN?y.equals(na,ua)?qa.projector=ma:qa.projector=null:qa.projector=lb[Aa][Ga];return qa}function Ra(){return{source:{spatialReference:null,spatialReferenceId:xa.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:xa.UNKNOWN,metersPerUnit:1},
projector:ma}}let bb=null,cb=null,Sa=null,jb={};const ob=new d.SimpleObservable;let Bb=function(na){function ua(){return na.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}E._inheritsLoose(ua,na);return ua}(B);var xa;(function(na){na[na.UNKNOWN=0]="UNKNOWN";na[na.SPHERICAL_ECEF=1]="SPHERICAL_ECEF";na[na.WGS84=2]="WGS84";na[na.WEB_MERCATOR=3]="WEB_MERCATOR";na[na.WGS84_ECEF=4]="WGS84_ECEF";na[na.CGCS2000=5]="CGCS2000";na[na.WGS84_COMPARABLE_LON_LAT=
6]="WGS84_COMPARABLE_LON_LAT";na[na.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF";na[na.GCSMARS2000=8]="GCSMARS2000";na[na.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF";na[na.GCSMOON2000=10]="GCSMOON2000";na[na.LON_LAT=11]="LON_LAT";na[na.PLATE_CARREE=12]="PLATE_CARREE"})(xa||(xa={}));const ac=p.earth.radius*Math.PI/180,Cb=180/(p.earth.radius*Math.PI),lb={[xa.WGS84]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:ma,[xa.SPHERICAL_ECEF]:va,
[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:pa,[xa.PLATE_CARREE]:sa,[xa.WGS84]:ma,[xa.WGS84_ECEF]:Ba},[xa.CGCS2000]:{[xa.CGCS2000]:ma,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:ma,[xa.SPHERICAL_ECEF]:va,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:sa,[xa.WGS84]:null,[xa.WGS84_ECEF]:Ba},[xa.GCSMARS2000]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:ma,
[xa.GCSMOON2000]:null,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:null,[xa.SPHERICAL_ECEF]:null,[xa.SPHERICAL_MARS_PCPF]:oa,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:null,[xa.WGS84]:null,[xa.WGS84_ECEF]:null},[xa.GCSMOON2000]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:ma,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:null,[xa.SPHERICAL_ECEF]:null,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:la,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:null,
[xa.PLATE_CARREE]:null,[xa.WGS84]:null,[xa.WGS84_ECEF]:null},[xa.WEB_MERCATOR]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:W,[xa.WGS84_COMPARABLE_LON_LAT]:W,[xa.SPHERICAL_ECEF]:Y,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:ma,[xa.PLATE_CARREE]:ya,[xa.WGS84]:W,[xa.WGS84_ECEF]:da},[xa.WGS84_ECEF]:{[xa.CGCS2000]:Oa,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:Oa,[xa.WGS84_COMPARABLE_LON_LAT]:Oa,[xa.SPHERICAL_ECEF]:Za,
[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:$a,[xa.PLATE_CARREE]:function(na,ua,qa,Aa){Oa(na,ua,qa,Aa);sa(qa,Aa,qa,Aa)},[xa.WGS84]:Oa,[xa.WGS84_ECEF]:ma},[xa.SPHERICAL_ECEF]:{[xa.CGCS2000]:Ka,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:Ka,[xa.WGS84_COMPARABLE_LON_LAT]:Ka,[xa.SPHERICAL_ECEF]:ma,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:Ia,[xa.PLATE_CARREE]:function(na,ua,qa,Aa){Ka(na,
ua,qa,Aa);sa(qa,Aa,qa,Aa)},[xa.WGS84]:Ka,[xa.WGS84_ECEF]:Ma},[xa.SPHERICAL_MARS_PCPF]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:Ja,[xa.GCSMOON2000]:null,[xa.LON_LAT]:Ja,[xa.WGS84_COMPARABLE_LON_LAT]:null,[xa.SPHERICAL_ECEF]:null,[xa.SPHERICAL_MARS_PCPF]:ma,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:null,[xa.WGS84]:null,[xa.WGS84_ECEF]:null},[xa.SPHERICAL_MOON_PCPF]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:Fa,[xa.LON_LAT]:Fa,[xa.WGS84_COMPARABLE_LON_LAT]:null,
[xa.SPHERICAL_ECEF]:null,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:ma,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:null,[xa.WGS84]:null,[xa.WGS84_ECEF]:null},[xa.UNKNOWN]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:null,[xa.WGS84_COMPARABLE_LON_LAT]:null,[xa.SPHERICAL_ECEF]:null,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:ma,[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:null,[xa.WGS84]:null,[xa.WGS84_ECEF]:null},[xa.LON_LAT]:{[xa.CGCS2000]:ma,
[xa.GCSMARS2000]:ma,[xa.GCSMOON2000]:ma,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:ma,[xa.SPHERICAL_ECEF]:va,[xa.SPHERICAL_MARS_PCPF]:oa,[xa.SPHERICAL_MOON_PCPF]:la,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:pa,[xa.PLATE_CARREE]:sa,[xa.WGS84]:ma,[xa.WGS84_ECEF]:Ba},[xa.WGS84_COMPARABLE_LON_LAT]:{[xa.CGCS2000]:null,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:ma,[xa.WGS84_COMPARABLE_LON_LAT]:ma,[xa.SPHERICAL_ECEF]:va,[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,
[xa.WEB_MERCATOR]:null,[xa.PLATE_CARREE]:sa,[xa.WGS84]:ma,[xa.WGS84_ECEF]:Ba},[xa.PLATE_CARREE]:{[xa.CGCS2000]:ta,[xa.GCSMARS2000]:null,[xa.GCSMOON2000]:null,[xa.LON_LAT]:ta,[xa.WGS84_COMPARABLE_LON_LAT]:ta,[xa.SPHERICAL_ECEF]:function(na,ua,qa,Aa){ta(na,ua,qa,Aa);va(qa,Aa,qa,Aa)},[xa.SPHERICAL_MARS_PCPF]:null,[xa.SPHERICAL_MOON_PCPF]:null,[xa.UNKNOWN]:null,[xa.WEB_MERCATOR]:function(na,ua,qa,Aa){ta(na,ua,qa,Aa);pa(qa,Aa,qa,Aa)},[xa.PLATE_CARREE]:ma,[xa.WGS84]:ta,[xa.WGS84_ECEF]:function(na,ua,qa,
Aa){ta(na,ua,qa,Aa);Ba(qa,Aa,qa,Aa)}}},ub={spatialReference:null,spatialReferenceId:xa.UNKNOWN},hc={spatialReference:null,spatialReferenceId:xa.UNKNOWN},Sb=Ra(),Ob=Ra(),qb=u.deg2rad(1),db=u.rad2deg(1),Xa=r.create(),kb=r.create(),pb=r.create(),Ta=r.create(),zb=r.create();t.canProjectToWGS84ComparableLonLat=function(na){if(A.isNone(na))return!1;na=ca(na,ub);return!!lb[na][xa.WGS84_COMPARABLE_LON_LAT]};t.canProjectWithoutEngine=S;t.computeENUToSphericalPCPFLocalRotation=M;t.computeSphericalPCPFToENULocalRotation=
ba;t.computeTranslationToOriginAndRotation=function(na,ua,qa,Aa){if(A.isNone(na)||A.isNone(Aa))return!1;var Ga=ca(na,ub),Ha=ca(Aa,hc);if(Ga===Ha&&Ha!==xa.SPHERICAL_ECEF&&Ha!==xa.SPHERICAL_MARS_PCPF&&Ha!==xa.SPHERICAL_MOON_PCPF&&(Ga!==xa.UNKNOWN||y.equals(na,Aa)))return l.fromTranslation(qa,ua),!0;if(Ha===xa.SPHERICAL_ECEF||Ha===xa.SPHERICAL_MARS_PCPF||Ha===xa.SPHERICAL_MOON_PCPF){Ga=lb[Ga][xa.LON_LAT];Ha=lb[xa.LON_LAT][Ha];if(A.isNone(Ga)||A.isNone(Ha))return!1;Ga(ua,0,kb,0);Ha(kb,0,pb,0);M(qb*kb[0],
qb*kb[1],qa);qa[12]=pb[0];qa[13]=pb[1];qa[14]=pb[2];return!0}if((Ha===xa.WEB_MERCATOR||Ha===xa.PLATE_CARREE)&&(Ga===xa.WGS84||Ga===xa.CGCS2000&&Ha===xa.PLATE_CARREE||Ga===xa.SPHERICAL_ECEF||Ga===xa.WEB_MERCATOR)){na=lb[Ga][xa.LON_LAT];Ha=lb[xa.LON_LAT][Ha];if(A.isNone(na)||A.isNone(Ha))return!1;na(ua,0,kb,0);Ha(kb,0,pb,0);Ga===xa.SPHERICAL_ECEF?ba(qb*kb[0],qb*kb[1],qa):l.identity(qa);qa[12]=pb[0];qa[13]=pb[1];qa[14]=pb[2];return!0}return!1};t.getProjectorName=function(na,ua){switch(N(na,ua,Sb)){case ma:return"copy3";
case va:return"wgs84ToSphericalECEF";case pa:return"wgs84ToWebMercator";case sa:return"wgs84ToPlateCarree";case Ba:return"wgs84ToWGS84ECEF";case W:return"webMercatorToWGS84";case Y:return"webMercatorToSphericalECEF";case da:return"webMercatorToWGS84ECEF";case ya:return"webMercatorToPlateCarree";case Oa:return"wgs84ECEFToWGS84";case Za:return"wgs84ECEFToSphericalECEF";case $a:return"wgs84ECEFToWebMercator";case Ka:return"sphericalECEFToWGS84";case Ia:return"sphericalECEFToWebMercator";case Ja:return"sphericalMarsPCPFToMars2000";
case Fa:return"sphericalMoonPCPFToMoon2000";case Ma:return"sphericalECEFToWGS84ECEF";case oa:return"mars2000ToSphericalPCPF";case la:return"moon2000ToSphericalPCPF";default:return null}};t.getTransformation=J;t.getTransformations=function(na,ua,qa=null){if(A.isNone(bb)||A.isNone(cb))throw new Bb;na=bb._getTransformationBySuitability(cb,na,ua,qa,qa?.spatialReference);if(null!==na){ua=[];for(const Aa of na)ua.push(w.fromGE(Aa));return ua}return[]};t.initializeProjection=function(na,ua,qa,Aa){return X.apply(this,
arguments)};t.isLoaded=I;t.load=D;t.localLinearScaleFactors=function(na,ua,qa,Aa){if(A.isNone(ua)||A.isNone(Aa))return!1;const Ga=ca(ua,ub);var Ha=ca(Aa,hc);if(Ga===Ha&&Ga!==xa.UNKNOWN||y.equals(ua,Aa))return qa[0]=1,qa[1]=1,qa[2]=1,!0;if(Ga===xa.SPHERICAL_ECEF){ua=m.length(na);na=ua/Math.sqrt(na[0]*na[0]+na[1]*na[1]);ua/=p.earth.radius;if(Ha===xa.WEB_MERCATOR)return qa[0]=na*ua,qa[1]=na*ua,qa[2]=1,!0;if(Ha===xa.WGS84||Ha===xa.CGCS2000)return Ha=Cb,qa[0]=Ha*na*ua,qa[1]=Ha*ua,qa[2]=1,!0}else if(Ga===
xa.PLATE_CARREE){if(Ha===xa.WGS84||Ha===xa.CGCS2000)return qa[0]=Cb,qa[1]=Cb,qa[2]=1,!0;if(Ha===xa.WEB_MERCATOR)return Ha=na[1]/p.earth.radius,qa[0]=1,qa[1]=1/Math.cos(Ha),qa[2]=1,!0}return!1};t.lonLatToSphericalPCPF=function(na,ua,qa,Aa){const Ga=Math.cos(qa);na[0]=Math.cos(ua)*Ga*Aa;na[1]=Math.sin(ua)*Ga*Aa;na[2]=Math.sin(qa)*Aa};t.lonLatToWebMercatorComparable=ja;t.project=C;t.projectBoundingRect=function(na,ua,qa,Aa){if(null==na)return!1;if(y.equals(ua,Aa))return q.copy(qa,na),!0;Xa[0]=na[0];
Xa[1]=na[1];Xa[2]=0;if(!wa(Xa,ua,0,Xa,Aa,0,1))return!1;qa[0]=Xa[0];qa[1]=Xa[1];Xa[0]=na[2];Xa[1]=na[3];Xa[2]=0;if(!wa(Xa,ua,0,Xa,Aa,0,1))return!1;qa[2]=Xa[0];qa[3]=Xa[1];return!0};t.projectBoundingSphere=function(na,ua,qa,Aa){if(A.isNone(ua)||A.isNone(Aa))return!1;ua=Wa(ua,Aa,Ob);if(ua.projector===ma)return qa[0]=na[0],qa[1]=na[1],qa[2]=na[2],qa[3]=na[3],!0;if(A.isNone(ua.projector))return!1;const {source:Ga,dest:Ha}=ua;if(Ha.spatialReferenceId===xa.WEB_MERCATOR){ua=lb[Ga.spatialReferenceId][xa.WGS84];
if(A.isNone(ua))return!1;ua(na,0,kb,0);pa(kb,0,qa,0);qa[3]=L(kb[1],na[2],na[3],p.earth.radius);return!0}if(Ga.spatialReferenceId!==xa.WGS84&&Ga.spatialReferenceId!==xa.CGCS2000||Ha.spatialReferenceId!==xa.PLATE_CARREE)ua.projector(na,0,qa,0),qa[3]=na[3]*(Ga.metersPerUnit??1)/(Ha.metersPerUnit??1);else{Aa=lb[xa.SPHERICAL_ECEF][xa.PLATE_CARREE];let Na=na[3];A.isSome(lb[Ga.spatialReferenceId][xa.SPHERICAL_ECEF])&&A.isSome(Aa)&&(Na=L(na[1],na[2],na[3],p.earth.radius));ua.projector(na,0,qa,0);qa[3]=Na}return!0};
t.projectBuffer=wa;t.projectDirection=function(na,ua,qa,Aa,Ga){m.copy(Ta,na);m.add(zb,na,ua);ka(Ta,qa,Ta,Ga);ka(zb,qa,zb,Ga);m.subtract(Aa,zb,Ta);m.normalize(Aa,Aa)};t.projectExtent=function(na,ua,qa=ua.spatialReference,Aa=0){return A.isSome(na.spatialReference)&&A.isSome(qa)&&A.isSome(V(na,na.spatialReference,ua,qa,Aa))};t.projectMany=F;t.projectMultipoint=function(na,ua,qa=ua.spatialReference,Aa=0){return A.isSome(na.spatialReference)&&A.isSome(qa)&&A.isSome(Q(na,na.spatialReference,ua,qa,Aa))};
t.projectOrLoad=function(na,ua){na=K([na],ua);return A.isSome(na.pending)?{pending:na.pending,geometry:null}:A.isSome(na.geometries)?{pending:null,geometry:na.geometries[0]}:{pending:null,geometry:null}};t.projectOrLoadMany=K;t.projectPoint=function(na,ua,qa=ua.spatialReference,Aa=0){return A.isSome(qa)&&A.isSome(na.spatialReference)&&A.isSome(U(na,na.spatialReference,ua,qa,Aa))};t.projectPointToVector=function(na,ua,qa,Aa=0){Ta[0]=na.x;Ta[1]=na.y;const Ga=na.z;Ta[2]=void 0!==Ga?Ga:Aa;return wa(Ta,
na.spatialReference,0,ua,qa,0,1)};t.projectPointToWGS84ComparableLonLat=function(na,ua){Ta[0]=na.x;Ta[1]=na.y;const qa=na.z;Ta[2]=void 0!==qa?qa:0;return ia(Ta,na.spatialReference,ua)};t.projectPolygon=function(na,ua,qa=ua.spatialReference,Aa=0){return A.isSome(na.spatialReference)&&A.isSome(qa)&&A.isSome(R(na,na.spatialReference,ua,qa,Aa))};t.projectPolygonToWGS84ComparableLonLat=function({hasZ:na,spatialReference:ua,rings:qa},Aa,Ga=0){ua=ca(ua,ub);ua=lb[ua][xa.WGS84_COMPARABLE_LON_LAT];if(A.isNone(ua))return!1;
na=na?Ha=>Ha:Ha=>m.set(Ta,Ha[0],Ha[1],Ga);for(const Ha of qa){qa=[];for(const Na of Ha){const Pa=[0,0,Ga];ua(na(Na),0,Pa,0);qa.push(Pa)}Aa.push(qa)}return!0};t.projectPolyline=function(na,ua,qa=ua.spatialReference,Aa=0){return A.isSome(na.spatialReference)&&A.isSome(qa)&&A.isSome(O(na,na.spatialReference,ua,qa,Aa))};t.projectPolylineToWGS84ComparableLonLat=function({hasZ:na,spatialReference:ua,paths:qa},Aa,Ga=0){ua=ca(ua,ub);ua=lb[ua][xa.WGS84_COMPARABLE_LON_LAT];if(A.isNone(ua))return!1;na=na?Ha=>
Ha:Ha=>m.set(Ta,Ha[0],Ha[1],Ga);for(const Ha of qa){qa=[];for(const Na of Ha){const Pa=[0,0,Ga];ua(na(Na),0,Pa,0);qa.push(Pa)}Aa.push(qa)}return!0};t.projectVectorToDehydratedPoint=function(na,ua,qa){return wa(na,ua,0,Ta,qa.spatialReference,0,1)?(qa.x=Ta[0],qa.y=Ta[1],qa.z=Ta[2],qa):null};t.projectVectorToPoint=function(na,ua,qa){if(A.isNone(ua)||A.isNone(qa))return null;const Aa=new a({spatialReference:qa});return wa(na,ua,0,Ta,qa,0,1)?(Aa.x=Ta[0],Aa.y=Ta[1],Aa.z=Ta[2],Aa):null};t.projectVectorToVector=
ka;t.projectVectorToWGS84ComparableLonLat=function(na,ua,qa){return ia(na,ua,qa)};t.projectWithoutEngine=ha;t.projectXYZToVector=Z;t.sphericalPCPFtoLonLatElevation=Ca;t.test={get loadPromise(){return Sa}};t.tryProjectWithZConversion=P;t.unload=function(){Sa=cb=bb=null;jb={}};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports","./ObservationHandle"],function(v,t){let E=function(){function B(){this._observers=
[]}var u=B.prototype;u.observe=function(A){this._observers.includes(A)||this._observers.push(A);return new t.ObservationHandle(this._observers,A)};u.notify=function(){const A=this._observers.slice();for(let x=0;x<A.length;++x){const e=A[x];e.onInvalidated();e.onCommitted()}};return B}();v.SimpleObservable=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(v,t,E){function B(L,
M){L[0]=M[0];L[1]=M[1];L[2]=M[2];L[3]=M[3];L[4]=M[4];L[5]=M[5];L[6]=M[6];L[7]=M[7];L[8]=M[8];L[9]=M[9];L[10]=M[10];L[11]=M[11];L[12]=M[12];L[13]=M[13];L[14]=M[14];L[15]=M[15];return L}function u(L,M,ba,ca,ma,W,Y,da,ja,pa,sa,ta,ya,za,la,oa,va){L[0]=M;L[1]=ba;L[2]=ca;L[3]=ma;L[4]=W;L[5]=Y;L[6]=da;L[7]=ja;L[8]=pa;L[9]=sa;L[10]=ta;L[11]=ya;L[12]=za;L[13]=la;L[14]=oa;L[15]=va;return L}function A(L){L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=1;L[11]=0;L[12]=0;L[13]=0;L[14]=
0;L[15]=1;return L}function x(L,M){if(L===M){const ba=M[1],ca=M[2],ma=M[3],W=M[6],Y=M[7],da=M[11];L[1]=M[4];L[2]=M[8];L[3]=M[12];L[4]=ba;L[6]=M[9];L[7]=M[13];L[8]=ca;L[9]=W;L[11]=M[14];L[12]=ma;L[13]=Y;L[14]=da}else L[0]=M[0],L[1]=M[4],L[2]=M[8],L[3]=M[12],L[4]=M[1],L[5]=M[5],L[6]=M[9],L[7]=M[13],L[8]=M[2],L[9]=M[6],L[10]=M[10],L[11]=M[14],L[12]=M[3],L[13]=M[7],L[14]=M[11],L[15]=M[15];return L}function e(L,M){const ba=M[0],ca=M[1],ma=M[2],W=M[3],Y=M[4],da=M[5],ja=M[6],pa=M[7],sa=M[8],ta=M[9],ya=M[10],
za=M[11],la=M[12],oa=M[13],va=M[14];M=M[15];const Ca=ba*da-ca*Y,Fa=ba*ja-ma*Y,Ja=ba*pa-W*Y,Ka=ca*ja-ma*da,Ia=ca*pa-W*da,Ma=ma*pa-W*ja,Ba=sa*oa-ta*la,Oa=sa*va-ya*la,Za=sa*M-za*la,$a=ta*va-ya*oa,N=ta*M-za*oa,Wa=ya*M-za*va;let Ra=Ca*Wa-Fa*N+Ja*$a+Ka*Za-Ia*Oa+Ma*Ba;if(!Ra)return null;Ra=1/Ra;L[0]=(da*Wa-ja*N+pa*$a)*Ra;L[1]=(ma*N-ca*Wa-W*$a)*Ra;L[2]=(oa*Ma-va*Ia+M*Ka)*Ra;L[3]=(ya*Ia-ta*Ma-za*Ka)*Ra;L[4]=(ja*Za-Y*Wa-pa*Oa)*Ra;L[5]=(ba*Wa-ma*Za+W*Oa)*Ra;L[6]=(va*Ja-la*Ma-M*Fa)*Ra;L[7]=(sa*Ma-ya*Ja+za*Fa)*
Ra;L[8]=(Y*N-da*Za+pa*Ba)*Ra;L[9]=(ca*Za-ba*N-W*Ba)*Ra;L[10]=(la*Ia-oa*Ja+M*Ca)*Ra;L[11]=(ta*Ja-sa*Ia-za*Ca)*Ra;L[12]=(da*Oa-Y*$a-ja*Ba)*Ra;L[13]=(ba*$a-ca*Oa+ma*Ba)*Ra;L[14]=(oa*Fa-la*Ka-va*Ca)*Ra;L[15]=(sa*Ka-ta*Fa+ya*Ca)*Ra;return L}function h(L,M){const ba=M[0],ca=M[1],ma=M[2],W=M[3],Y=M[4],da=M[5],ja=M[6],pa=M[7],sa=M[8],ta=M[9],ya=M[10],za=M[11],la=M[12],oa=M[13],va=M[14];M=M[15];L[0]=da*(ya*M-za*va)-ta*(ja*M-pa*va)+oa*(ja*za-pa*ya);L[1]=-(ca*(ya*M-za*va)-ta*(ma*M-W*va)+oa*(ma*za-W*ya));L[2]=
ca*(ja*M-pa*va)-da*(ma*M-W*va)+oa*(ma*pa-W*ja);L[3]=-(ca*(ja*za-pa*ya)-da*(ma*za-W*ya)+ta*(ma*pa-W*ja));L[4]=-(Y*(ya*M-za*va)-sa*(ja*M-pa*va)+la*(ja*za-pa*ya));L[5]=ba*(ya*M-za*va)-sa*(ma*M-W*va)+la*(ma*za-W*ya);L[6]=-(ba*(ja*M-pa*va)-Y*(ma*M-W*va)+la*(ma*pa-W*ja));L[7]=ba*(ja*za-pa*ya)-Y*(ma*za-W*ya)+sa*(ma*pa-W*ja);L[8]=Y*(ta*M-za*oa)-sa*(da*M-pa*oa)+la*(da*za-pa*ta);L[9]=-(ba*(ta*M-za*oa)-sa*(ca*M-W*oa)+la*(ca*za-W*ta));L[10]=ba*(da*M-pa*oa)-Y*(ca*M-W*oa)+la*(ca*pa-W*da);L[11]=-(ba*(da*za-pa*ta)-
Y*(ca*za-W*ta)+sa*(ca*pa-W*da));L[12]=-(Y*(ta*va-ya*oa)-sa*(da*va-ja*oa)+la*(da*ya-ja*ta));L[13]=ba*(ta*va-ya*oa)-sa*(ca*va-ma*oa)+la*(ca*ya-ma*ta);L[14]=-(ba*(da*va-ja*oa)-Y*(ca*va-ma*oa)+la*(ca*ja-ma*da));L[15]=ba*(da*ya-ja*ta)-Y*(ca*ya-ma*ta)+sa*(ca*ja-ma*da);return L}function d(L){const M=L[0],ba=L[1],ca=L[2],ma=L[3],W=L[4],Y=L[5],da=L[6],ja=L[7],pa=L[8],sa=L[9],ta=L[10],ya=L[11],za=L[12],la=L[13],oa=L[14];L=L[15];return(M*Y-ba*W)*(ta*L-ya*oa)-(M*da-ca*W)*(sa*L-ya*la)+(M*ja-ma*W)*(sa*oa-ta*la)+
(ba*da-ca*Y)*(pa*L-ya*za)-(ba*ja-ma*Y)*(pa*oa-ta*za)+(ca*ja-ma*da)*(pa*la-sa*za)}function l(L,M,ba){const ca=M[0],ma=M[1],W=M[2],Y=M[3],da=M[4],ja=M[5],pa=M[6],sa=M[7],ta=M[8],ya=M[9],za=M[10],la=M[11],oa=M[12],va=M[13],Ca=M[14];M=M[15];let Fa=ba[0],Ja=ba[1],Ka=ba[2],Ia=ba[3];L[0]=Fa*ca+Ja*da+Ka*ta+Ia*oa;L[1]=Fa*ma+Ja*ja+Ka*ya+Ia*va;L[2]=Fa*W+Ja*pa+Ka*za+Ia*Ca;L[3]=Fa*Y+Ja*sa+Ka*la+Ia*M;Fa=ba[4];Ja=ba[5];Ka=ba[6];Ia=ba[7];L[4]=Fa*ca+Ja*da+Ka*ta+Ia*oa;L[5]=Fa*ma+Ja*ja+Ka*ya+Ia*va;L[6]=Fa*W+Ja*pa+Ka*
za+Ia*Ca;L[7]=Fa*Y+Ja*sa+Ka*la+Ia*M;Fa=ba[8];Ja=ba[9];Ka=ba[10];Ia=ba[11];L[8]=Fa*ca+Ja*da+Ka*ta+Ia*oa;L[9]=Fa*ma+Ja*ja+Ka*ya+Ia*va;L[10]=Fa*W+Ja*pa+Ka*za+Ia*Ca;L[11]=Fa*Y+Ja*sa+Ka*la+Ia*M;Fa=ba[12];Ja=ba[13];Ka=ba[14];Ia=ba[15];L[12]=Fa*ca+Ja*da+Ka*ta+Ia*oa;L[13]=Fa*ma+Ja*ja+Ka*ya+Ia*va;L[14]=Fa*W+Ja*pa+Ka*za+Ia*Ca;L[15]=Fa*Y+Ja*sa+Ka*la+Ia*M;return L}function m(L,M,ba){const ca=ba[0],ma=ba[1];ba=ba[2];if(M===L)L[12]=M[0]*ca+M[4]*ma+M[8]*ba+M[12],L[13]=M[1]*ca+M[5]*ma+M[9]*ba+M[13],L[14]=M[2]*ca+
M[6]*ma+M[10]*ba+M[14],L[15]=M[3]*ca+M[7]*ma+M[11]*ba+M[15];else{const W=M[0],Y=M[1],da=M[2],ja=M[3],pa=M[4],sa=M[5],ta=M[6],ya=M[7],za=M[8],la=M[9],oa=M[10],va=M[11];L[0]=W;L[1]=Y;L[2]=da;L[3]=ja;L[4]=pa;L[5]=sa;L[6]=ta;L[7]=ya;L[8]=za;L[9]=la;L[10]=oa;L[11]=va;L[12]=W*ca+pa*ma+za*ba+M[12];L[13]=Y*ca+sa*ma+la*ba+M[13];L[14]=da*ca+ta*ma+oa*ba+M[14];L[15]=ja*ca+ya*ma+va*ba+M[15]}return L}function r(L,M,ba){const ca=ba[0],ma=ba[1];ba=ba[2];L[0]=M[0]*ca;L[1]=M[1]*ca;L[2]=M[2]*ca;L[3]=M[3]*ca;L[4]=M[4]*
ma;L[5]=M[5]*ma;L[6]=M[6]*ma;L[7]=M[7]*ma;L[8]=M[8]*ba;L[9]=M[9]*ba;L[10]=M[10]*ba;L[11]=M[11]*ba;L[12]=M[12];L[13]=M[13];L[14]=M[14];L[15]=M[15];return L}function k(L,M,ba,ca){let ma=ca[0],W=ca[1];ca=ca[2];let Y=Math.sqrt(ma*ma+W*W+ca*ca);var da=void 0,ja=void 0;let pa=void 0,sa=void 0,ta=void 0,ya=void 0,za=void 0,la=void 0,oa=void 0,va=void 0,Ca=void 0,Fa=void 0,Ja=void 0,Ka=void 0,Ia=void 0,Ma=void 0,Ba=void 0,Oa=void 0,Za=void 0,$a=void 0,N=void 0,Wa=void 0;ja=da=void 0;if(Y<E.getEpsilon())return null;
Y=1/Y;ma*=Y;W*=Y;ca*=Y;da=Math.sin(ba);ja=Math.cos(ba);pa=1-ja;sa=M[0];ta=M[1];ya=M[2];za=M[3];la=M[4];oa=M[5];va=M[6];Ca=M[7];Fa=M[8];Ja=M[9];Ka=M[10];Ia=M[11];Ma=ma*ma*pa+ja;Ba=W*ma*pa+ca*da;Oa=ca*ma*pa-W*da;Za=ma*W*pa-ca*da;$a=W*W*pa+ja;N=ca*W*pa+ma*da;Wa=ma*ca*pa+W*da;da=W*ca*pa-ma*da;ja=ca*ca*pa+ja;L[0]=sa*Ma+la*Ba+Fa*Oa;L[1]=ta*Ma+oa*Ba+Ja*Oa;L[2]=ya*Ma+va*Ba+Ka*Oa;L[3]=za*Ma+Ca*Ba+Ia*Oa;L[4]=sa*Za+la*$a+Fa*N;L[5]=ta*Za+oa*$a+Ja*N;L[6]=ya*Za+va*$a+Ka*N;L[7]=za*Za+Ca*$a+Ia*N;L[8]=sa*Wa+la*da+
Fa*ja;L[9]=ta*Wa+oa*da+Ja*ja;L[10]=ya*Wa+va*da+Ka*ja;L[11]=za*Wa+Ca*da+Ia*ja;M!==L&&(L[12]=M[12],L[13]=M[13],L[14]=M[14],L[15]=M[15]);return L}function c(L,M,ba){const ca=Math.sin(ba);ba=Math.cos(ba);const ma=M[4],W=M[5],Y=M[6],da=M[7],ja=M[8],pa=M[9],sa=M[10],ta=M[11];M!==L&&(L[0]=M[0],L[1]=M[1],L[2]=M[2],L[3]=M[3],L[12]=M[12],L[13]=M[13],L[14]=M[14],L[15]=M[15]);L[4]=ma*ba+ja*ca;L[5]=W*ba+pa*ca;L[6]=Y*ba+sa*ca;L[7]=da*ba+ta*ca;L[8]=ja*ba-ma*ca;L[9]=pa*ba-W*ca;L[10]=sa*ba-Y*ca;L[11]=ta*ba-da*ca;
return L}function b(L,M,ba){const ca=Math.sin(ba);ba=Math.cos(ba);const ma=M[0],W=M[1],Y=M[2],da=M[3],ja=M[8],pa=M[9],sa=M[10],ta=M[11];M!==L&&(L[4]=M[4],L[5]=M[5],L[6]=M[6],L[7]=M[7],L[12]=M[12],L[13]=M[13],L[14]=M[14],L[15]=M[15]);L[0]=ma*ba-ja*ca;L[1]=W*ba-pa*ca;L[2]=Y*ba-sa*ca;L[3]=da*ba-ta*ca;L[8]=ma*ca+ja*ba;L[9]=W*ca+pa*ba;L[10]=Y*ca+sa*ba;L[11]=da*ca+ta*ba;return L}function a(L,M,ba){const ca=Math.sin(ba);ba=Math.cos(ba);const ma=M[0],W=M[1],Y=M[2],da=M[3],ja=M[4],pa=M[5],sa=M[6],ta=M[7];
M!==L&&(L[8]=M[8],L[9]=M[9],L[10]=M[10],L[11]=M[11],L[12]=M[12],L[13]=M[13],L[14]=M[14],L[15]=M[15]);L[0]=ma*ba+ja*ca;L[1]=W*ba+pa*ca;L[2]=Y*ba+sa*ca;L[3]=da*ba+ta*ca;L[4]=ja*ba-ma*ca;L[5]=pa*ba-W*ca;L[6]=sa*ba-Y*ca;L[7]=ta*ba-da*ca;return L}function g(L,M){L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=1;L[11]=0;L[12]=M[0];L[13]=M[1];L[14]=M[2];L[15]=1;return L}function n(L,M){L[0]=M[0];L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=M[1];L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=M[2];L[11]=
0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function f(L,M,ba){if(0===M)return A(L);let ca=ba[0],ma=ba[1];ba=ba[2];let W=Math.sqrt(ca*ca+ma*ma+ba*ba),Y=void 0,da=void 0,ja=void 0;if(W<E.getEpsilon())return null;W=1/W;ca*=W;ma*=W;ba*=W;Y=Math.sin(M);da=Math.cos(M);ja=1-da;L[0]=ca*ca*ja+da;L[1]=ma*ca*ja+ba*Y;L[2]=ba*ca*ja-ma*Y;L[3]=0;L[4]=ca*ma*ja-ba*Y;L[5]=ma*ma*ja+da;L[6]=ba*ma*ja+ca*Y;L[7]=0;L[8]=ca*ba*ja+ma*Y;L[9]=ma*ba*ja-ca*Y;L[10]=ba*ba*ja+da;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function q(L,
M){const ba=Math.sin(M);M=Math.cos(M);L[0]=1;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=M;L[6]=ba;L[7]=0;L[8]=0;L[9]=-ba;L[10]=M;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function p(L,M){const ba=Math.sin(M);M=Math.cos(M);L[0]=M;L[1]=0;L[2]=-ba;L[3]=0;L[4]=0;L[5]=1;L[6]=0;L[7]=0;L[8]=ba;L[9]=0;L[10]=M;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function z(L,M){const ba=Math.sin(M);M=Math.cos(M);L[0]=M;L[1]=ba;L[2]=0;L[3]=0;L[4]=-ba;L[5]=M;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=1;L[11]=0;L[12]=0;L[13]=
0;L[14]=0;L[15]=1;return L}function w(L,M,ba){var ca=M[0],ma=M[1],W=M[2],Y=M[3],da=ca+ca,ja=ma+ma;const pa=W+W;M=ca*da;const sa=ca*ja;ca*=pa;const ta=ma*ja;ma*=pa;W*=pa;da*=Y;ja*=Y;Y*=pa;L[0]=1-(ta+W);L[1]=sa+Y;L[2]=ca-ja;L[3]=0;L[4]=sa-Y;L[5]=1-(M+W);L[6]=ma+da;L[7]=0;L[8]=ca+ja;L[9]=ma-da;L[10]=1-(M+ta);L[11]=0;L[12]=ba[0];L[13]=ba[1];L[14]=ba[2];L[15]=1;return L}function y(L,M){const ba=ea,ca=-M[0],ma=-M[1],W=-M[2],Y=M[3],da=M[4],ja=M[5],pa=M[6],sa=M[7],ta=ca*ca+ma*ma+W*W+Y*Y;0<ta?(ba[0]=2*(da*
Y+sa*ca+ja*W-pa*ma)/ta,ba[1]=2*(ja*Y+sa*ma+pa*ca-da*W)/ta,ba[2]=2*(pa*Y+sa*W+da*ma-ja*ca)/ta):(ba[0]=2*(da*Y+sa*ca+ja*W-pa*ma),ba[1]=2*(ja*Y+sa*ma+pa*ca-da*W),ba[2]=2*(pa*Y+sa*W+da*ma-ja*ca));w(L,M,ba);return L}function G(L,M){L[0]=M[12];L[1]=M[13];L[2]=M[14];return L}function H(L,M){const ba=M[0],ca=M[1],ma=M[2],W=M[4],Y=M[5],da=M[6],ja=M[8],pa=M[9];M=M[10];L[0]=Math.sqrt(ba*ba+ca*ca+ma*ma);L[1]=Math.sqrt(W*W+Y*Y+da*da);L[2]=Math.sqrt(ja*ja+pa*pa+M*M);return L}function I(L,M){const ba=M[0]+M[5]+
M[10];let ca=0;0<ba?(ca=2*Math.sqrt(ba+1),L[3]=.25*ca,L[0]=(M[6]-M[9])/ca,L[1]=(M[8]-M[2])/ca,L[2]=(M[1]-M[4])/ca):M[0]>M[5]&&M[0]>M[10]?(ca=2*Math.sqrt(1+M[0]-M[5]-M[10]),L[3]=(M[6]-M[9])/ca,L[0]=.25*ca,L[1]=(M[1]+M[4])/ca,L[2]=(M[8]+M[2])/ca):M[5]>M[10]?(ca=2*Math.sqrt(1+M[5]-M[0]-M[10]),L[3]=(M[8]-M[2])/ca,L[0]=(M[1]+M[4])/ca,L[1]=.25*ca,L[2]=(M[6]+M[9])/ca):(ca=2*Math.sqrt(1+M[10]-M[0]-M[5]),L[3]=(M[1]-M[4])/ca,L[0]=(M[8]+M[2])/ca,L[1]=(M[6]+M[9])/ca,L[2]=.25*ca);return L}function D(L,M,ba,ca){var ma=
M[0],W=M[1],Y=M[2],da=M[3],ja=ma+ma,pa=W+W,sa=Y+Y;M=ma*ja;const ta=ma*pa;ma*=sa;const ya=W*pa;W*=sa;Y*=sa;ja*=da;pa*=da;da*=sa;sa=ca[0];const za=ca[1];ca=ca[2];L[0]=(1-(ya+Y))*sa;L[1]=(ta+da)*sa;L[2]=(ma-pa)*sa;L[3]=0;L[4]=(ta-da)*za;L[5]=(1-(M+Y))*za;L[6]=(W+ja)*za;L[7]=0;L[8]=(ma+pa)*ca;L[9]=(W-ja)*ca;L[10]=(1-(M+ya))*ca;L[11]=0;L[12]=ba[0];L[13]=ba[1];L[14]=ba[2];L[15]=1;return L}function C(L,M,ba,ca,ma){var W=M[0],Y=M[1],da=M[2],ja=M[3],pa=W+W,sa=Y+Y,ta=da+da;M=W*pa;var ya=W*sa,za=W*ta;W=Y*sa;
Y*=ta;var la=da*ta;da=ja*pa;sa*=ja;const oa=ja*ta;var va=ca[0],Ca=ca[1];ta=ca[2];ca=ma[0];ja=ma[1];ma=ma[2];pa=(1-(W+la))*va;const Fa=(ya+oa)*va;va*=za-sa;ya=(ya-oa)*Ca;la=(1-(M+la))*Ca;Ca*=Y+da;za=(za+sa)*ta;Y=(Y-da)*ta;M=(1-(M+W))*ta;L[0]=pa;L[1]=Fa;L[2]=va;L[3]=0;L[4]=ya;L[5]=la;L[6]=Ca;L[7]=0;L[8]=za;L[9]=Y;L[10]=M;L[11]=0;L[12]=ba[0]+ca-(pa*ca+ya*ja+za*ma);L[13]=ba[1]+ja-(Fa*ca+la*ja+Y*ma);L[14]=ba[2]+ma-(va*ca+Ca*ja+M*ma);L[15]=1;return L}function F(L,M){var ba=M[0],ca=M[1],ma=M[2];M=M[3];var W=
ba+ba,Y=ca+ca;const da=ma+ma;ba*=W;const ja=ca*W;ca*=Y;const pa=ma*W,sa=ma*Y;ma*=da;W*=M;Y*=M;M*=da;L[0]=1-ca-ma;L[1]=ja+M;L[2]=pa-Y;L[3]=0;L[4]=ja-M;L[5]=1-ba-ma;L[6]=sa+W;L[7]=0;L[8]=pa+Y;L[9]=sa-W;L[10]=1-ba-ca;L[11]=0;L[12]=0;L[13]=0;L[14]=0;L[15]=1;return L}function K(L,M,ba,ca,ma,W,Y){const da=1/(ba-M),ja=1/(ma-ca),pa=1/(W-Y);L[0]=2*W*da;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2*W*ja;L[6]=0;L[7]=0;L[8]=(ba+M)*da;L[9]=(ma+ca)*ja;L[10]=(Y+W)*pa;L[11]=-1;L[12]=0;L[13]=0;L[14]=Y*W*2*pa;L[15]=0;return L}
function J(L,M,ba,ca,ma){M=1/Math.tan(M/2);let W=void 0;L[0]=M/ba;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=M;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[11]=-1;L[12]=0;L[13]=0;L[15]=0;null!=ma&&Infinity!==ma?(W=1/(ca-ma),L[10]=(ma+ca)*W,L[14]=2*ma*ca*W):(L[10]=-1,L[14]=-2*ca);return L}function P(L,M,ba,ca){const ma=Math.tan(M.upDegrees*Math.PI/180),W=Math.tan(M.downDegrees*Math.PI/180),Y=Math.tan(M.leftDegrees*Math.PI/180);M=Math.tan(M.rightDegrees*Math.PI/180);const da=2/(Y+M),ja=2/(ma+W);L[0]=da;L[1]=0;L[2]=0;L[3]=0;
L[4]=0;L[5]=ja;L[6]=0;L[7]=0;L[8]=-((Y-M)*da*.5);L[9]=(ma-W)*ja*.5;L[10]=ca/(ba-ca);L[11]=-1;L[12]=0;L[13]=0;L[14]=ca*ba/(ba-ca);L[15]=0;return L}function S(L,M,ba,ca,ma,W,Y){const da=1/(M-ba),ja=1/(ca-ma),pa=1/(W-Y);L[0]=-2*da;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=-2*ja;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=2*pa;L[11]=0;L[12]=(M+ba)*da;L[13]=(ma+ca)*ja;L[14]=(Y+W)*pa;L[15]=1;return L}function X(L,M,ba,ca){var ma=void 0;let W=void 0;var Y=void 0,da=void 0;let ja=void 0,pa=void 0;var sa=void 0,ta=void 0;let ya=
void 0,za=void 0;const la=M[0],oa=M[1];M=M[2];Y=ca[0];da=ca[1];ca=ca[2];sa=ba[0];ta=ba[1];ba=ba[2];ma=E.getEpsilon();if(Math.abs(la-sa)<ma&&Math.abs(oa-ta)<ma&&Math.abs(M-ba)<ma)return A(L);sa=la-sa;ta=oa-ta;ya=M-ba;za=1/Math.sqrt(sa*sa+ta*ta+ya*ya);sa*=za;ta*=za;ya*=za;ma=da*ya-ca*ta;W=ca*sa-Y*ya;Y=Y*ta-da*sa;(za=Math.sqrt(ma*ma+W*W+Y*Y))?(za=1/za,ma*=za,W*=za,Y*=za):Y=W=ma=0;da=ta*Y-ya*W;ja=ya*ma-sa*Y;pa=sa*W-ta*ma;(za=Math.sqrt(da*da+ja*ja+pa*pa))?(za=1/za,da*=za,ja*=za,pa*=za):pa=ja=da=0;L[0]=
ma;L[1]=da;L[2]=sa;L[3]=0;L[4]=W;L[5]=ja;L[6]=ta;L[7]=0;L[8]=Y;L[9]=pa;L[10]=ya;L[11]=0;L[12]=-(ma*la+W*oa+Y*M);L[13]=-(da*la+ja*oa+pa*M);L[14]=-(sa*la+ta*oa+ya*M);L[15]=1;return L}function ha(L,M,ba,ca){const ma=M[0],W=M[1];M=M[2];var Y=ca[0];const da=ca[1];var ja=ca[2];ca=ma-ba[0];let pa=W-ba[1];ba=M-ba[2];let sa=ca*ca+pa*pa+ba*ba;0<sa&&(sa=1/Math.sqrt(sa),ca*=sa,pa*=sa,ba*=sa);let ta=da*ba-ja*pa;ja=ja*ca-Y*ba;Y=Y*pa-da*ca;sa=ta*ta+ja*ja+Y*Y;0<sa&&(sa=1/Math.sqrt(sa),ta*=sa,ja*=sa,Y*=sa);L[0]=ta;
L[1]=ja;L[2]=Y;L[3]=0;L[4]=pa*Y-ba*ja;L[5]=ba*ta-ca*Y;L[6]=ca*ja-pa*ta;L[7]=0;L[8]=ca;L[9]=pa;L[10]=ba;L[11]=0;L[12]=ma;L[13]=W;L[14]=M;L[15]=1;return L}function U(L){return"mat4("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+", "+L[8]+", "+L[9]+", "+L[10]+", "+L[11]+", "+L[12]+", "+L[13]+", "+L[14]+", "+L[15]+")"}function Q(L){return Math.sqrt(L[0]**2+L[1]**2+L[2]**2+L[3]**2+L[4]**2+L[5]**2+L[6]**2+L[7]**2+L[8]**2+L[9]**2+L[10]**2+L[11]**2+L[12]**2+L[13]**2+L[14]**2+
L[15]**2)}function O(L,M,ba){L[0]=M[0]+ba[0];L[1]=M[1]+ba[1];L[2]=M[2]+ba[2];L[3]=M[3]+ba[3];L[4]=M[4]+ba[4];L[5]=M[5]+ba[5];L[6]=M[6]+ba[6];L[7]=M[7]+ba[7];L[8]=M[8]+ba[8];L[9]=M[9]+ba[9];L[10]=M[10]+ba[10];L[11]=M[11]+ba[11];L[12]=M[12]+ba[12];L[13]=M[13]+ba[13];L[14]=M[14]+ba[14];L[15]=M[15]+ba[15];return L}function R(L,M,ba){L[0]=M[0]-ba[0];L[1]=M[1]-ba[1];L[2]=M[2]-ba[2];L[3]=M[3]-ba[3];L[4]=M[4]-ba[4];L[5]=M[5]-ba[5];L[6]=M[6]-ba[6];L[7]=M[7]-ba[7];L[8]=M[8]-ba[8];L[9]=M[9]-ba[9];L[10]=M[10]-
ba[10];L[11]=M[11]-ba[11];L[12]=M[12]-ba[12];L[13]=M[13]-ba[13];L[14]=M[14]-ba[14];L[15]=M[15]-ba[15];return L}function V(L,M,ba){L[0]=M[0]*ba;L[1]=M[1]*ba;L[2]=M[2]*ba;L[3]=M[3]*ba;L[4]=M[4]*ba;L[5]=M[5]*ba;L[6]=M[6]*ba;L[7]=M[7]*ba;L[8]=M[8]*ba;L[9]=M[9]*ba;L[10]=M[10]*ba;L[11]=M[11]*ba;L[12]=M[12]*ba;L[13]=M[13]*ba;L[14]=M[14]*ba;L[15]=M[15]*ba;return L}function Z(L,M,ba,ca){L[0]=M[0]+ba[0]*ca;L[1]=M[1]+ba[1]*ca;L[2]=M[2]+ba[2]*ca;L[3]=M[3]+ba[3]*ca;L[4]=M[4]+ba[4]*ca;L[5]=M[5]+ba[5]*ca;L[6]=M[6]+
ba[6]*ca;L[7]=M[7]+ba[7]*ca;L[8]=M[8]+ba[8]*ca;L[9]=M[9]+ba[9]*ca;L[10]=M[10]+ba[10]*ca;L[11]=M[11]+ba[11]*ca;L[12]=M[12]+ba[12]*ca;L[13]=M[13]+ba[13]*ca;L[14]=M[14]+ba[14]*ca;L[15]=M[15]+ba[15]*ca;return L}function ka(L,M){return L[0]===M[0]&&L[1]===M[1]&&L[2]===M[2]&&L[3]===M[3]&&L[4]===M[4]&&L[5]===M[5]&&L[6]===M[6]&&L[7]===M[7]&&L[8]===M[8]&&L[9]===M[9]&&L[10]===M[10]&&L[11]===M[11]&&L[12]===M[12]&&L[13]===M[13]&&L[14]===M[14]&&L[15]===M[15]}function ia(L,M){if(L===M)return!0;const ba=L[0],ca=
L[1],ma=L[2],W=L[3],Y=L[4],da=L[5],ja=L[6],pa=L[7],sa=L[8],ta=L[9],ya=L[10],za=L[11],la=L[12],oa=L[13],va=L[14];L=L[15];const Ca=M[0],Fa=M[1],Ja=M[2],Ka=M[3],Ia=M[4],Ma=M[5],Ba=M[6],Oa=M[7],Za=M[8],$a=M[9],N=M[10],Wa=M[11],Ra=M[12],bb=M[13],cb=M[14];M=M[15];const Sa=E.getEpsilon();return Math.abs(ba-Ca)<=Sa*Math.max(1,Math.abs(ba),Math.abs(Ca))&&Math.abs(ca-Fa)<=Sa*Math.max(1,Math.abs(ca),Math.abs(Fa))&&Math.abs(ma-Ja)<=Sa*Math.max(1,Math.abs(ma),Math.abs(Ja))&&Math.abs(W-Ka)<=Sa*Math.max(1,Math.abs(W),
Math.abs(Ka))&&Math.abs(Y-Ia)<=Sa*Math.max(1,Math.abs(Y),Math.abs(Ia))&&Math.abs(da-Ma)<=Sa*Math.max(1,Math.abs(da),Math.abs(Ma))&&Math.abs(ja-Ba)<=Sa*Math.max(1,Math.abs(ja),Math.abs(Ba))&&Math.abs(pa-Oa)<=Sa*Math.max(1,Math.abs(pa),Math.abs(Oa))&&Math.abs(sa-Za)<=Sa*Math.max(1,Math.abs(sa),Math.abs(Za))&&Math.abs(ta-$a)<=Sa*Math.max(1,Math.abs(ta),Math.abs($a))&&Math.abs(ya-N)<=Sa*Math.max(1,Math.abs(ya),Math.abs(N))&&Math.abs(za-Wa)<=Sa*Math.max(1,Math.abs(za),Math.abs(Wa))&&Math.abs(la-Ra)<=Sa*
Math.max(1,Math.abs(la),Math.abs(Ra))&&Math.abs(oa-bb)<=Sa*Math.max(1,Math.abs(oa),Math.abs(bb))&&Math.abs(va-cb)<=Sa*Math.max(1,Math.abs(va),Math.abs(cb))&&Math.abs(L-M)<=Sa*Math.max(1,Math.abs(L),Math.abs(M))}function wa(L){const M=E.getEpsilon(),ba=L[0],ca=L[1],ma=L[2],W=L[4],Y=L[5],da=L[6],ja=L[8],pa=L[9];L=L[10];return Math.abs(1-(ba*ba+W*W+ja*ja))<=M&&Math.abs(1-(ca*ca+Y*Y+pa*pa))<=M&&Math.abs(1-(ma*ma+da*da+L*L))<=M}const ea=t.create();t=Object.freeze(Object.defineProperty({__proto__:null,
copy:B,set:u,identity:A,transpose:x,invert:e,adjoint:h,determinant:d,multiply:l,translate:m,scale:r,rotate:k,rotateX:c,rotateY:b,rotateZ:a,fromTranslation:g,fromScaling:n,fromRotation:f,fromXRotation:q,fromYRotation:p,fromZRotation:z,fromRotationTranslation:w,fromQuat2:y,getTranslation:G,getScaling:H,getRotation:I,fromRotationTranslationScale:D,fromRotationTranslationScaleOrigin:C,fromQuat:F,frustum:K,perspective:J,perspectiveFromFieldOfView:P,ortho:S,lookAt:X,targetTo:ha,str:U,frob:Q,add:O,subtract:R,
multiplyScalar:V,multiplyScalarAndAdd:Z,exactEquals:ka,equals:ia,isOrthoNormal:wa,mul:l,sub:R},Symbol.toStringTag,{value:"Module"}));v.add=O;v.adjoint=h;v.copy=B;v.determinant=d;v.equals=ia;v.exactEquals=ka;v.frob=Q;v.fromQuat=F;v.fromQuat2=y;v.fromRotation=f;v.fromRotationTranslation=w;v.fromRotationTranslationScale=D;v.fromRotationTranslationScaleOrigin=C;v.fromScaling=n;v.fromTranslation=g;v.fromXRotation=q;v.fromYRotation=p;v.fromZRotation=z;v.frustum=K;v.getRotation=I;v.getScaling=H;v.getTranslation=
G;v.identity=A;v.invert=e;v.isOrthoNormal=wa;v.lookAt=X;v.mat4=t;v.mul=l;v.multiply=l;v.multiplyScalar=V;v.multiplyScalarAndAdd=Z;v.ortho=S;v.perspective=J;v.perspectiveFromFieldOfView=P;v.rotate=k;v.rotateX=c;v.rotateY=b;v.rotateZ=a;v.scale=r;v.set=u;v.str=U;v.sub=R;v.subtract=R;v.targetTo=ha;v.translate=m;v.transpose=x})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(v,t,E,B,u){function A(){return!!t._pe}function x(){return!!u("esri-wasm")}
function e(){return k?k:k=(new Promise((b,a)=>v(["./pe-wasm"],b,a))).then(b=>b.peWasm).then(({default:b})=>b({locateFile:a=>B.getAssetUrl(`esri/geometry/support/${a}`)})).then(b=>{h(b)})}function h(b){function a(f,q,p){f[q]=p(f[q])}t._pe=b;t.PeDefs.init();t.PeGTlistExtended.init();t.PeNotationMgrs.init();t.PeNotationUtm.init();t.PePCSInfo.init();t.PeGCSExtent=function(f){function q(){return f.apply(this,arguments)||this}E._inheritsLoose(q,f);q.prototype.destroy=function(){t._pe.destroy(this)};return q}(t._pe.PeGCSExtent);
b=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(var g of b)a(g.prototype,"getName",f=>function(){return f.call(this,Array(t.PeDefs.PE_NAME_MAX))});for(const f of[t._pe.PeGeogtran,t._pe.PeProjcs])a(f.prototype,"getParameters",q=>function(){const p=Array(t.PeDefs.PE_PARM_MAX);let z=q.call(this);for(let w=0;w<p.length;w++){const y=t._pe.getValue(z,"*");p[w]=y?t._pe.wrapPointer(y,t._pe.PeParameter):null;
z+=Int32Array.BYTES_PER_ELEMENT}return p});a(t._pe.PeHorizon.prototype,"getCoord",f=>function(){const q=this.getSize();if(!q)return null;const p=[],z=f.call(this);r(p,q,z);return p});a(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",f=>{const q=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let p=null;var z=f.call(this);if(!t._pe.compare(z,t._pe.NULL)){p=[z];const w=this.getSteps();if(1<w){z=t._pe.getPointer(z);for(let y=1;y<w;y++)p.push(t._pe.wrapPointer(z+q*y,t._pe.PeGTlistExtendedGTs))}}return p}});
const n=t._pe._pe_getPeHorizonSize();g=f=>function(){let q=this._cache;q||(this._cache=q=new Map);if(q.has(f))return q.get(f);let p=null;var z=f.call(this);if(!t._pe.compare(z,t._pe.NULL)){p=[z];const w=z.getNump();if(1<w){z=t._pe.getPointer(z);for(let y=1;y<w;y++)p.push(t._pe.wrapPointer(z+n*y,t._pe.PeHorizon))}}q.set(f,p);return p};a(t._pe.PeProjcs.prototype,"horizonGcsGenerate",g);a(t._pe.PeProjcs.prototype,"horizonPcsGenerate",g);t._pe.PeObject.prototype.toString=function(f=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();
const q=t._pe.getPointer(this),p=t._pe.ensureInt8(Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(q,f,p))}}function d(b){if(b){var a=t._pe.getClass(b);a&&(a=t._pe.getCache(a))&&(b=t._pe.getPointer(b))&&delete a[b]}}function l(b,a){const g=[];a=Array(a);for(let n=0;n<b;n++)g.push(t._pe.ensureInt8(a));return g}function m(b){let a;Array.isArray(b[0])?(a=[],b.forEach(g=>{a.push(g[0],g[1])})):a=b;return a}function r(b,a,g,n=!1){if(n)for(n=0;n<2*a;n++)b[n]=t._pe.getValue(g+
n*Float64Array.BYTES_PER_ELEMENT,"double");else{n=0===b.length;for(let f=0;f<a;f++)n&&(b[f]=Array(2)),b[f][0]=t._pe.getValue(g,"double"),b[f][1]=t._pe.getValue(g+Float64Array.BYTES_PER_ELEMENT,"double"),g+=2*Float64Array.BYTES_PER_ELEMENT}}let k;t._pe=null;t.PeCSTransformations=void 0;(function(b){function a(f,q,p){t._pe.ensureCache.prepare();var z=m(p);const w=p===z;z=t._pe.ensureFloat64(z);(f=t._pe._pe_geog_to_proj(t._pe.getPointer(f),q,z))&&r(p,q,z,w);return f}function g(f,q,p){return n(f,q,p,
0)}function n(f,q,p,z){t._pe.ensureCache.prepare();var w=m(p);const y=p===w;w=t._pe.ensureFloat64(w);(f=t._pe._pe_proj_to_geog_center(t._pe.getPointer(f),q,w,z))&&r(p,q,w,y);return f}b.geogToProj=a;b.projGeog=function(f,q,p,z){switch(z){case t.PeDefs.PE_TRANSFORM_P_TO_G:return g(f,q,p);case t.PeDefs.PE_TRANSFORM_G_TO_P:return a(f,q,p)}return 0};b.projToGeog=g;b.projToGeogCenter=n})(t.PeCSTransformations||(t.PeCSTransformations={}));t.PeDefs=void 0;(function(b){b.init=function(){b.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX;
b.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=
t._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT;b.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=
t._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE;
b.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(t.PeDefs||(t.PeDefs={}));t.PeFactory=void 0;(function(b){function a(q,p){let z=null,w=g[q];w||(w={},g[q]=w);w.hasOwnProperty(String(p))?z=w[p]:(q=t._pe.PeFactory.prototype.factoryByType(q,p),t._pe.compare(q,t._pe.NULL)||(z=q,w[p]=z));return z=f(z)}const g={},n={},f=q=>{if(q){const p=q.getType();switch(p){case t.PeDefs.PE_TYPE_GEOGCS:q=t._pe.castObject(q,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:q=t._pe.castObject(q,t._pe.PeProjcs);
break;case t.PeDefs.PE_TYPE_GEOGTRAN:q=t._pe.castObject(q,t._pe.PeGeogtran);break;default:p&t.PeDefs.PE_TYPE_UNIT&&(q=t._pe.castObject(q,t._pe.PeUnit))}}return q};b.initialize=function(){t._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(q){return a(t.PeDefs.PE_TYPE_COORDSYS,q)};b.factoryByType=a;b.fromString=function(q,p){let z=null,w=n[q];w||(w={},n[q]=w);w.hasOwnProperty(p)?z=w[p]:(q=t._pe.PeFactory.prototype.fromString(q,p),t._pe.compare(q,t._pe.NULL)||(z=q,w[p]=z));return z=f(z)};
b.geogcs=function(q){return a(t.PeDefs.PE_TYPE_GEOGCS,q)};b.geogtran=function(q){return a(t.PeDefs.PE_TYPE_GEOGTRAN,q)};b.getCode=function(q){return t._pe.PeFactory.prototype.getCode(q)};b.projcs=function(q){return a(t.PeDefs.PE_TYPE_PROJCS,q)};b.unit=function(q){return a(t.PeDefs.PE_TYPE_UNIT,q)}})(t.PeFactory||(t.PeFactory={}));t.PeGCSExtent=null;t.PeGTlistExtended=void 0;(function(b){let a;b.init=function(){b.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;a=t._pe._pe_getPeGTlistExtendedEntrySize()};
b.getGTlist=function(g,n,f,q,p,z){let w=null;const y=new t._pe.PeInteger(z);try{const G=t._pe.PeGTlistExtended.prototype.getGTlist(g,n,f,q,p,y);if(z=y.val)if(w=[G],1<z){const H=t._pe.getPointer(G);for(g=1;g<z;g++)w.push(t._pe.wrapPointer(H+a*g,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(y)}return w}})(t.PeGTlistExtended||(t.PeGTlistExtended={}));t.PeGTlistExtendedEntry=void 0;(function(b){b.destroy=function(a){if(a&&a.length){for(const g of a)d(g),g.getEntries().forEach(n=>{d(n);n=n.getGeogtran();
d(n);n.getParameters().forEach(d);[n.getGeogcs1(),n.getGeogcs2()].forEach(f=>{d(f);const q=f.getDatum();d(q);d(q.getSpheroid());d(f.getPrimem());d(f.getUnit())})});t._pe.PeGTlistExtendedEntry.prototype.Delete(a[0])}}})(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={}));t.PeGTTransformations=void 0;(function(b){b.geogToGeog=function(a,g,n,f,q){t._pe.ensureCache.prepare();var p=m(n);const z=n===p;p=t._pe.ensureFloat64(p);let w=0;f&&(w=t._pe.ensureFloat64(f));(a=t._pe._pe_geog_to_geog(t._pe.getPointer(a),
g,p,w,q))&&r(n,g,p,z);return a}})(t.PeGTTransformations||(t.PeGTTransformations={}));t.PeNotationDms=void 0;(function(b){const a=(n,f,q,p,z,w)=>{t._pe.ensureCache.prepare();switch(n){case "dd":var y=t._pe._pe_geog_to_dd;var G=t.PeDefs.PE_DD_MAX;break;case "ddm":y=t._pe._pe_geog_to_ddm;G=t.PeDefs.PE_DDM_MAX;break;case "dms":y=t._pe._pe_geog_to_dms,G=t.PeDefs.PE_DMS_MAX}n=0;f&&(n=t._pe.getPointer(f));f=m(p);f=t._pe.ensureFloat64(f);G=l(q,G);p=t._pe.ensureInt32(G);if(z=y(n,q,f,z,p))for(y=0;y<q;y++)w[y]=
t._pe.UTF8ToString(G[y]);return z},g=(n,f,q,p,z)=>{t._pe.ensureCache.prepare();switch(n){case "dd":var w=t._pe._pe_dd_to_geog;break;case "ddm":w=t._pe._pe_ddm_to_geog;break;case "dms":w=t._pe._pe_dms_to_geog}n=0;f&&(n=t._pe.getPointer(f));f=p.map(y=>t._pe.ensureString(y));p=t._pe.ensureInt32(f);f=t._pe.ensureFloat64(Array(2*q));(w=w(n,q,p,f))&&r(z,q,f);return w};b.geogToDms=function(n,f,q,p,z){return a("dms",n,f,q,p,z)};b.dmsToGeog=function(n,f,q,p){return g("dms",n,f,q,p)};b.geogToDdm=function(n,
f,q,p,z){return a("ddm",n,f,q,p,z)};b.ddmToGeog=function(n,f,q,p){return g("ddm",n,f,q,p)};b.geogToDd=function(n,f,q,p,z){return a("dd",n,f,q,p,z)};b.ddToGeog=function(n,f,q,p){return g("dd",n,f,q,p)}})(t.PeNotationDms||(t.PeNotationDms={}));t.PeNotationMgrs=void 0;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;
b.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geogToMgrsExtended=function(a,g,n,f,q,p,z){t._pe.ensureCache.prepare();let w=0;a&&(w=t._pe.getPointer(a));a=m(n);n=t._pe.ensureFloat64(a);a=l(g,t.PeDefs.PE_MGRS_MAX);const y=t._pe.ensureInt32(a);if(f=t._pe._pe_geog_to_mgrs_extended(w,g,n,f,q,p,y))for(q=0;q<g;q++)z[q]=t._pe.UTF8ToString(a[q]);return f};b.mgrsToGeogExtended=function(a,g,n,f,q){t._pe.ensureCache.prepare();
let p=0;a&&(p=t._pe.getPointer(a));a=n.map(z=>t._pe.ensureString(z));n=t._pe.ensureInt32(a);a=t._pe.ensureFloat64(Array(2*g));(f=t._pe._pe_mgrs_to_geog_extended(p,g,n,f,a))&&r(q,g,a);return f}})(t.PeNotationMgrs||(t.PeNotationMgrs={}));t.PeNotationUsng=void 0;(function(b){b.geogToUsng=function(a,g,n,f,q,p,z){t._pe.ensureCache.prepare();let w=0;a&&(w=t._pe.getPointer(a));a=m(n);n=t._pe.ensureFloat64(a);a=l(g,t.PeDefs.PE_MGRS_MAX);const y=t._pe.ensureInt32(a);if(f=t._pe._pe_geog_to_usng(w,g,n,f,q,p,
y))for(q=0;q<g;q++)z[q]=t._pe.UTF8ToString(a[q]);return f};b.usngToGeog=function(a,g,n,f){t._pe.ensureCache.prepare();var q=0;a&&(q=t._pe.getPointer(a));a=n.map(p=>t._pe.ensureString(p));n=t._pe.ensureInt32(a);a=t._pe.ensureFloat64(Array(2*g));(q=t._pe._pe_usng_to_geog(q,g,n,a))&&r(f,g,a);return q}})(t.PeNotationUsng||(t.PeNotationUsng={}));t.PeNotationUtm=void 0;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;
b.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geogToUtm=function(a,g,n,f,q){t._pe.ensureCache.prepare();var p=0;a&&(p=t._pe.getPointer(a));a=m(n);n=t._pe.ensureFloat64(a);a=l(g,t.PeDefs.PE_UTM_MAX);const z=t._pe.ensureInt32(a);if(f=t._pe._pe_geog_to_utm(p,g,n,f,z))for(p=0;p<g;p++)q[p]=t._pe.UTF8ToString(a[p]);return f};b.utmToGeog=function(a,g,n,f,q){t._pe.ensureCache.prepare();let p=0;a&&(p=t._pe.getPointer(a));a=n.map(z=>t._pe.ensureString(z));n=t._pe.ensureInt32(a);a=t._pe.ensureFloat64(Array(2*
g));(f=t._pe._pe_utm_to_geog(p,g,n,f,a))&&r(q,g,a);return f}})(t.PeNotationUtm||(t.PeNotationUtm={}));t.PePCSInfo=void 0;(function(b){const a=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(g,n=b.PE_PCSINFO_OPTION_DOMAIN){let f=
null,q=null;a.has(g)&&(q=a.get(g),q[n]&&(f=q[n]));f||(f=t._pe.PePCSInfo.prototype.generate(g,n),q||(q=[],a.set(g,q)),q[n]=f);return f}})(t.PePCSInfo||(t.PePCSInfo={}));t.PeVersion=void 0;(function(b){b.versionString=function(){return t._pe.PeVersion.prototype.version_string()}})(t.PeVersion||(t.PeVersion={}));const c=Object.freeze(Object.defineProperty({__proto__:null,get _pe(){return t._pe},isLoaded:A,isSupported:x,load:e,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},
get PeFactory(){return t.PeFactory},get PeGCSExtent(){return t.PeGCSExtent},get PeGTlistExtended(){return t.PeGTlistExtended},get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeGTTransformations(){return t.PeGTTransformations},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:h},
Symbol.toStringTag,{value:"Module"}));t._init=h;t.isLoaded=A;t.isSupported=x;t.load=e;t.pe=c})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(v,t){const E=Math.PI/180;var B=t.earth.radius;const u=t.earth.eccentricitySquared;B={a1:B*u,a2:B*u*B*u,a3:B*u*u/2,a4:B*u*B*u*2.5,a5:B*u+B*u*u/2,a6:1-u};t={4267:{a:6378206.4,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:t.earth.radius,f:t.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,
f:0},104902:{a:6051800,f:0},104903:{a:t.moon.radius,f:t.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:t.mars.radius,f:t.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,
f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},
104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,
f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:t.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};v.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;v.earthEllipsoidConstants=B;v.spheroids=t;v.toRadians=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/GeographicTransformation":function(){define(["./GeographicTransformationStep"],function(v){return function(){function t(B){this.steps=
[];this._cachedProjection={};this._chain="";this._gtlistentry=null;if(B&&B.steps)for(const u of B.steps)u instanceof v?this.steps.push(u):this.steps.push(new v({wkid:u.wkid,wkt:u.wkt,isInverse:u.isInverse}))}t.cacheKey=function(B,u){return[void 0!==B.wkid&&null!==B.wkid?B.wkid.toString():"-1",void 0!==B.wkt&&null!==B.wkt?B.wkt.toString():"",void 0!==u.wkid&&null!==u.wkid?u.wkid.toString():"-1",void 0!==u.wkt&&null!==u.wkt?u.wkt.toString():""].join()};t.fromGE=function(B){const u=new t;let A="";for(const x of B.steps)B=
v.fromGE(x),u.steps.push(B),A+=B.uid.toString()+",";u._cachedProjection={};u._gtlistentry=null;u._chain=A;return u};var E=t.prototype;E.getInverse=function(){const B=new t;B.steps=[];for(let u=this.steps.length-1;0<=u;u--)B.steps.push(this.steps[u].getInverse());return B};E.getGTListEntry=function(){let B="";for(const u of this.steps)B+=u.uid.toString()+",";B!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=B);return this._gtlistentry};E.assignCachedGe=function(B,u,A){this._cachedProjection[t.cacheKey(B,
u)]=A};E.getCachedGeTransformation=function(B,u){let A="";for(const x of this.steps)A+=x.uid.toString()+",";A!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=A);B=this._cachedProjection[t.cacheKey(B,u)];return void 0===B?null:B};return t}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(v){let t=0;return function(){function E(B){this.uid=t++;B?(this._wkt=null!=B.wkt?B.wkt:null,this._wkid=null!=
B.wkid?B.wkid:-1,this._isInverse=null!=B.isInverse?!0===B.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}E.fromGE=function(B){const u=new E;u._wkt=B.wkt;u._wkid=B.wkid;u._isInverse=B.isInverse;return u};E.prototype.getInverse=function(){const B=new E;B._wkt=this.wkt;B._wkid=this._wkid;B._isInverse=!this.isInverse;return B};v._createClass(E,[{key:"wkt",get:function(){return this._wkt},set:function(B){this._wkt=B;this.uid=t++}},{key:"wkid",get:function(){return this._wkid},set:function(B){this._wkid=
B;this.uid=t++}},{key:"isInverse",get:function(){return this._isInverse},set:function(B){this._isInverse=B;this.uid=t++}}]);return E}()})},"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(v,t,E,B){v.getGeometryZScaler=function(u,A,x){if(t.isNone(A)||t.isNone(x)||x.vcsWkid||B.equals(A,x))return null;A=E.getMetersPerVerticalUnitForSR(A);x=E.getMetersPerVerticalUnitForSR(x);const e=A/x;if(1===e)return null;switch(u){case "point":case "esriGeometryPoint":return h=>
{h&&null!=h.z&&(h.z*=e)};case "polyline":case "esriGeometryPolyline":return h=>{if(h)for(const d of h.paths)for(const l of d)2<l.length&&(l[2]*=e)};case "polygon":case "esriGeometryPolygon":return h=>{if(h)for(const d of h.rings)for(const l of d)2<l.length&&(l[2]*=e)};case "multipoint":case "esriGeometryMultipoint":return h=>{if(h)for(const d of h.points)2<d.length&&(d[2]*=e)};case "extent":case "esriGeometryExtent":return h=>{h&&null!=h.zmin&&null!=h.zmax&&(h.zmin*=e,h.zmax*=e)};default:return null}};
Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(v){let t=function(x,e,h){this.x=x;this.y=e;this.spatialReference=h;this.m=this.z=void 0},E=function(x,e,h,d){this.rings=x;this.spatialReference=e;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);d&&(this.hasM=d)},B=function(x,e,h,d){this.paths=x;this.spatialReference=e;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);d&&(this.hasM=d)},u=function(x,
e,h,d){this.points=x;this.spatialReference=e;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);d&&(this.hasM=d)},A=function(x,e,h,d,l){this.xmin=x;this.ymin=e;this.xmax=h;this.ymax=d;this.spatialReference=l;this.mmax=this.mmin=this.zmax=this.zmin=void 0};v.jsonAdapter={convertToGEGeometry:function(x,e){return null==e?null:x.convertJSONToGeometry(e)},exportPoint:function(x,e,h){h=new t(x.getPointX(e),x.getPointY(e),h);const d=x.hasZ(e),l=x.hasM(e);d&&(h.z=x.getPointZ(e));l&&(h.m=x.getPointM(e));return h},
exportPolygon:function(x,e,h){return new E(x.exportPaths(e),h,x.hasZ(e),x.hasM(e))},exportPolyline:function(x,e,h){return new B(x.exportPaths(e),h,x.hasZ(e),x.hasM(e))},exportMultipoint:function(x,e,h){return new u(x.exportPoints(e),h,x.hasZ(e),x.hasM(e))},exportExtent:function(x,e,h){var d=x.hasZ(e);const l=x.hasM(e);h=new A(x.getXMin(e),x.getYMin(e),x.getXMax(e),x.getYMax(e),h);d&&(d=x.getZExtent(e),h.zmin=d.vmin,h.zmax=d.vmax);l&&(x=x.getMExtent(e),h.mmin=x.vmin,h.mmax=x.vmax);return h}};Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(v){v.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,
standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c){function b(f,q,p,z){const w=z.x-p.x;z=z.y-p.y;q=Math.min(1,Math.max(0,((q.x-p.x)*w+(q.y-p.y)*z)/(w*w+z*z)));f.x=p.x+w*q;f.y=p.y+z*q}function a(f,q){return f?q?4:3:q?3:2}let g=function(){function f(p,z,w){this.items=p;this.query=z;this.geometryType=w.geometryType;this.hasM=w.hasM;this.hasZ=w.hasZ;this.fieldsIndex=w.fieldsIndex;this.objectIdField=w.objectIdField;this.spatialReference=w.spatialReference;this.featureAdapter=w.featureAdapter}var q=f.prototype;q.createQueryResponseForCount=
function(){const p=new h(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return p.countDistinctValues(this.items);const {groupByFieldsForStatistics:z,having:w,outStatistics:y}=this.query;if(!z?.length)return 1;const G=new Map,H=new Map,I=new Set;for(const F of y){var {statisticType:D}=F;D="exceedslimit"!==D?F.onStatisticField:void 0;if(!H.has(D)){var C=[];for(const K of z){const J=this._getAttributeValues(p,K,G);C.push(J)}H.set(D,this._calculateUniqueValues(C,p.returnDistinctValues))}D=
H.get(D);for(const K in D){const {data:J,items:P}=D[K];C=J.join(",");w&&!p.validateItems(P,w)||I.add(C)}}return I.size};q.createQueryResponse=function(){var p=E._asyncToGenerator(function*(){let z;z=this.query.outStatistics?this.query.outStatistics.some(w=>"exceedslimit"===w.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);this.query.returnQueryGeometry&&(e.isValid(this.query.outSR)&&
!e.equals(this.query.geometry.spatialReference,this.query.outSR)?z.queryGeometry=m.cleanFromGeometryEngine({spatialReference:this.query.outSR,...d.project(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):z.queryGeometry=m.cleanFromGeometryEngine({spatialReference:this.query.outSR,...this.query.geometry}));return z});return function(){return p.apply(this,arguments)}}();q.createSnappingResponse=function(p,z){const w=this.featureAdapter,y=a(this.hasZ,this.hasM),{point:G}=
p,H="number"===typeof p.distance?p.distance:p.distance.x,I="number"===typeof p.distance?p.distance:p.distance.y,D={candidates:[]},C="esriGeometryPolygon"===this.geometryType;z=this._getPointCreator(G,null!=G.z,null!=G.m,this.spatialReference,z);const F=new n(null,0),K=new n(null,0),J={x:0,y:0,z:0};for(const O of this.items){var P=w.getGeometry(O);if(B.isNone(P))continue;const {coords:R,lengths:V}=P;F.coords=R;K.coords=R;if(p.types&t.SnappingTypes.EDGE){P=0;for(var S=0;S<V.length;S++){var X=V[S];for(var ha=
0;ha<X;ha++,P+=y){var U=F;U.coordsIndex=P;if(ha!==X-1){const Z=K;Z.coordsIndex=P+y;const ka=J;b(J,G,U,Z);var Q=(G.x-ka.x)/H;const ia=(G.y-ka.y)/I;Q=Q*Q+ia*ia;1>=Q&&D.candidates.push(l.makeEdgeCandidate(w.getObjectId(O),z(ka),Math.sqrt(Q),z(U),z(Z)))}}}}if(p.types&t.SnappingTypes.VERTEX)for(P=C?R.length-y:R.length,S=0;S<P;S+=y)X=F,X.coordsIndex=S,ha=(G.x-X.x)/H,U=(G.y-X.y)/I,ha=ha*ha+U*U,1>=ha&&D.candidates.push(l.makeVertexCandidate(w.getObjectId(O),z(X),Math.sqrt(ha)))}D.candidates.sort((O,R)=>O.distance-
R.distance);return D};q._getPointCreator=function(p,z,w,y,G){const H=B.isSome(G)&&!e.equals(y,G)?C=>d.project(C,y,G):C=>C,{hasZ:I}=this,D=p.m;return z&&w?I?({x:C,y:F,z:K})=>H({x:C,y:F,z:K,m:D}):({x:C,y:F})=>H({x:C,y:F,z:0,m:D}):z?I?({x:C,y:F,z:K})=>H({x:C,y:F,z:K}):({x:C,y:F})=>H({x:C,y:F,z:0}):w?({x:C,y:F})=>H({x:C,y:F,m:D}):({x:C,y:F})=>H({x:C,y:F})};q.createSummaryStatisticsResponse=function(){var p=E._asyncToGenerator(function*(z){const {field:w,valueExpression:y,normalizationField:G,normalizationType:H,
normalizationTotal:I,minValue:D,maxValue:C,scale:F}=z;z=this.fieldsIndex.isDateField(w);var K=yield this._getDataValues({field:w,valueExpression:y,normalizationField:G,normalizationType:H,normalizationTotal:I,scale:F});const J=k.isNullCountSupported({normalizationType:H,normalizationField:G,minValue:D,maxValue:C}),P=this.fieldsIndex.get(w),S={value:.5,fieldType:P?.type};K=r.isStringField(P)?k.calculateStringStatistics({values:K,supportsNullCount:J,percentileParams:S}):k.calculateStatistics({values:K,
minValue:D,maxValue:C,useSampleStdDev:!H,supportsNullCount:J,percentileParams:S});return k.processSummaryStatisticsResult(K,z)});return function(z){return p.apply(this,arguments)}}();q.createUniqueValuesResponse=function(){var p=E._asyncToGenerator(function*(z){const {field:w,valueExpression:y,domains:G,returnAllCodedValues:H,scale:I}=z;var D=yield this._getDataValues({field:w,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,valueExpression:y,scale:I});D=k.calculateUniqueValuesCount(D);
return k.createUVResult(D,G,H,z.fieldDelimiter)});return function(z){return p.apply(this,arguments)}}();q.createClassBreaksResponse=function(){var p=E._asyncToGenerator(function*(z){const {field:w,valueExpression:y,normalizationField:G,normalizationType:H,normalizationTotal:I,classificationMethod:D,standardDeviationInterval:C,minValue:F,maxValue:K,numClasses:J,scale:P}=z;z=yield this._getDataValues({field:w,valueExpression:y,normalizationField:G,normalizationType:H,normalizationTotal:I,scale:P});
z=k.calculateClassBreaks(z,{field:w,normalizationField:G,normalizationType:H,normalizationTotal:I,classificationMethod:D,standardDeviationInterval:C,minValue:F,maxValue:K,numClasses:J});return k.resolveCBResult(z,D)});return function(z){return p.apply(this,arguments)}}();q.createHistogramResponse=function(){var p=E._asyncToGenerator(function*(z){const {field:w,valueExpression:y,normalizationField:G,normalizationType:H,normalizationTotal:I,classificationMethod:D,standardDeviationInterval:C,minValue:F,
maxValue:K,numBins:J,scale:P}=z;z=yield this._getDataValues({field:w,valueExpression:y,normalizationField:G,normalizationType:H,normalizationTotal:I,scale:P});return k.calculateHistogram(z,{field:w,normalizationField:G,normalizationType:H,normalizationTotal:I,classificationMethod:D,standardDeviationInterval:C,minValue:F,maxValue:K,numBins:J})});return function(z){return p.apply(this,arguments)}}();q._sortFeatures=function(p,z,w){if(1<p.length&&z&&z.length)for(const y of z.reverse()){z=y.split(" ");
const G=z[0],H=this.fieldsIndex.get(G);z=z[1]&&"desc"===z[1].toLowerCase();const I=k.getAttributeComparator(H?.type,z);p.sort((D,C)=>{D=w(D,G,H);C=w(C,G,H);return I(D,C)})}};q._createFeatureQueryResponse=function(p){const z=this.items,{geometryType:w,hasM:y,hasZ:G,objectIdField:H,spatialReference:I}=this,{outFields:D,outSR:C,quantizationParameters:F,resultRecordCount:K,resultOffset:J,returnZ:P,returnM:S}=p,X=null!=K?z.length>(J||0)+K:!1,ha=D&&(D.includes("*")?[...this.fieldsIndex.fields]:D.map(U=>
this.fieldsIndex.get(U)));return{exceededTransferLimit:X,features:this._createFeatures(p,z),fields:ha,geometryType:w,hasM:y&&S,hasZ:G&&P,objectIdFieldName:H,spatialReference:m.cleanFromGeometryEngine(C?C:I),transform:F&&x.toQuantizationTransform(F)||null}};q._createFeatures=function(p,z){const w=new h(p,this.featureAdapter,this.fieldsIndex),{hasM:y,hasZ:G}=this,{orderByFields:H,quantizationParameters:I,returnGeometry:D,returnCentroid:C,maxAllowableOffset:F,resultOffset:K,resultRecordCount:J,returnZ:P=
!1,returnM:S=!1}=p,X=G&&P,ha=y&&S;p=[];var U=0;z=[...z];this._sortFeatures(z,H,(R,V,Z)=>w.getFieldValue(R,V,Z));if(D||C){var Q=x.toQuantizationTransform(I);if(D&&!C)for(var O of z)p[U++]={attributes:w.getAttributes(O),geometry:m.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(O),F,Q,X,ha)};else if(!D&&C)for(const R of z)p[U++]={attributes:w.getAttributes(R),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(R,this),Q)};else for(const R of z)p[U++]=
{attributes:w.getAttributes(R),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(R,this),Q),geometry:m.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(R),F,Q,X,ha)}}else for(Q of z)(O=w.getAttributes(Q))&&(p[U++]={attributes:O});U=K||0;null!=J&&(p=p.slice(U,Math.min(p.length,U+J)));return p};q._createExceedsLimitQueryResponse=function(p){var z=!1;let w=Number.POSITIVE_INFINITY,y=Number.POSITIVE_INFINITY;z=Number.POSITIVE_INFINITY;for(const G of p.outStatistics)if("exceedslimit"===
G.statisticType){w=null!=G.maxPointCount?G.maxPointCount:Number.POSITIVE_INFINITY;y=null!=G.maxRecordCount?G.maxRecordCount:Number.POSITIVE_INFINITY;z=null!=G.maxVertexCount?G.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)z=this.items.length>w;else if(this.items.length>y)z=!0;else{p=a(this.hasZ,this.hasM);const G=this.featureAdapter;z=this.items.reduce((H,I)=>{I=G.getGeometry(I);return H+(B.isSome(I)&&I.coords.length||0)},0)/p>z}return{fields:[{name:"exceedslimit",
type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(z)}}]}};q._createStatisticsQueryResponse=function(){var p=E._asyncToGenerator(function*(z){var w={attributes:{}};const y=[],G=new Map,H=new Map,I=new Map,D=new Map,C=new h(z,this.featureAdapter,this.fieldsIndex);var F=z.outStatistics;const {groupByFieldsForStatistics:K,having:J,orderByFields:P}=z;z=K&&K.length;const S=!!z,X=S&&K[0],ha=S&&!this.fieldsIndex.get(X);
for(const V of F){const {outStatisticFieldName:Z,statisticType:ka}=V;F=V;var U="exceedslimit"!==ka?V.onStatisticField:void 0;const ia="percentile_disc"===ka||"percentile_cont"===ka,wa="EnvelopeAggregate"===ka||"CentroidAggregate"===ka||"ConvexHullAggregate"===ka,ea=S&&1===z&&(U===X||ha)&&"count"===ka;if(S){if(!I.has(U)){var Q=[];for(const L of K){var O=this._getAttributeValues(C,L,G);Q.push(O)}I.set(U,this._calculateUniqueValues(Q,wa?!1:C.returnDistinctValues))}Q=I.get(U);for(const L in Q){const {count:M,
data:ba,items:ca,itemPositions:ma}=Q[L];O=ba.join(",");if(!J||C.validateItems(ca,J)){const W=D.get(O)||{attributes:{}};if(wa){W.aggregateGeometries||(W.aggregateGeometries={});const {aggregateGeometries:da,outStatisticFieldName:ja}=yield this._getAggregateGeometry(F,ca);W.aggregateGeometries[ja]=da}else{var R=null;if(ea)R=M;else{const da=this._getAttributeValues(C,U,G);R=ma.map(ja=>da[ja]);R=ia&&"statisticParameters"in F?this._getPercentileValue(F,R):this._getStatisticValue(F,R,null,C.returnDistinctValues)}W.attributes[Z]=
R}let Y=0;K.forEach((da,ja)=>W.attributes[this.fieldsIndex.get(da)?da:`EXPR_${++Y}`]=ba[ja]);D.set(O,W)}}}else if(wa){w.aggregateGeometries||(w.aggregateGeometries={});const {aggregateGeometries:L,outStatisticFieldName:M}=yield this._getAggregateGeometry(F,this.items);w.aggregateGeometries[M]=L}else U=this._getAttributeValues(C,U,G),w.attributes[Z]=ia&&"statisticParameters"in F?this._getPercentileValue(F,U):this._getStatisticValue(F,U,H,C.returnDistinctValues);y.push({name:Z,alias:Z,type:"esriFieldTypeDouble"})}w=
S?Array.from(D.values()):[w];this._sortFeatures(w,P,(V,Z)=>V.attributes[Z]);return{fields:y,features:w}});return function(z){return p.apply(this,arguments)}}();q._getAggregateGeometry=function(){var p=E._asyncToGenerator(function*(z,w){var y=yield new Promise((P,S)=>v(["../../../geometry/geometryEngineJSON"],P,S));const {statisticType:G,outStatisticFieldName:H}=z,{featureAdapter:I,spatialReference:D,geometryType:C,hasZ:F,hasM:K}=this;w=w.map(P=>m.getGeometry(C,F,K,I.getGeometry(P)));const J=y.convexHull(D,
w,!0)[0];z={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===G?(y=J?A.getPolygonExtent(J):A.getGeometryExtent(y.union(D,w)),z.aggregateGeometries={...y,spatialReference:D},z.outStatisticFieldName=H||"extent"):"CentroidAggregate"===G?(y=J?u.polygonCentroid(J):u.extentCentroid(A.getGeometryExtent(y.union(D,w))),z.aggregateGeometries={x:y[0],y:y[1],spatialReference:D},z.outStatisticFieldName=H||"centroid"):"ConvexHullAggregate"===G&&(z.aggregateGeometries=J,z.outStatisticFieldName=
H||"convexHull");return z});return function(z,w){return p.apply(this,arguments)}}();q._getStatisticValue=function(p,z,w,y){const {onStatisticField:G,statisticType:H}=p;p=null;p=w?.has(G)?w.get(G):r.isStringField(this.fieldsIndex.get(G))?k.calculateStringStatistics({values:z,returnDistinct:y}):k.calculateStatistics({values:z,minValue:null,maxValue:null,useSampleStdDev:!0});w&&w.set(G,p);return p["var"===H?"variance":H]};q._getPercentileValue=function(p,z){const {onStatisticField:w,statisticParameters:y,
statisticType:G}=p,{value:H,orderBy:I}=y;p=this.fieldsIndex.get(w);return k.calculatePercentile(z,{value:H,orderBy:I,fieldType:p?.type,isDiscrete:"percentile_disc"===G})};q._getAttributeValues=function(p,z,w){if(w.has(z))return w.get(z);const y=this.fieldsIndex.get(z),G=this.items.map(H=>p.getFieldValue(H,z,y));w.set(z,G);return G};q._getAttributeDataValues=function(p,z){return this.items.map(w=>p.getDataValue(w,{field:z.field,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,normalizationField:z.normalizationField,
normalizationType:z.normalizationType,normalizationTotal:z.normalizationTotal}))};q._getAttributeExpressionValues=function(){var p=E._asyncToGenerator(function*(z,w,y){const {arcadeUtils:G}=yield c.loadArcade();w=G.createFunction(w);y=y&&G.getViewInfo(y);return z.getExpressionValues(this.items,w,y,G)});return function(z,w,y){return p.apply(this,arguments)}}();q._calculateUniqueValues=function(p,z){const w={},y=this.items,G=y.length;for(let H=0;H<G;H++){const I=y[H],D=[];for(const F of p)D.push(F[H]);
const C=D.join(",");z?null==w[C]&&(w[C]={count:1,data:D,items:[I],itemPositions:[H]}):null==w[C]?w[C]={count:1,data:D,items:[I],itemPositions:[H]}:(w[C].count++,w[C].items.push(I),w[C].itemPositions.push(H))}return w};q._getDataValues=function(){var p=E._asyncToGenerator(function*(z){const w=new h(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:y,field:G,normalizationField:H,normalizationType:I,normalizationTotal:D,scale:C}=z,F=y?{viewingMode:"map",scale:C,spatialReference:this.query.outSR||
this.spatialReference}:null;return y?this._getAttributeExpressionValues(w,y,F):this._getAttributeDataValues(w,{field:G,field2:z.field2,field3:z.field3,fieldDelimiter:z.fieldDelimiter,normalizationField:H,normalizationType:I,normalizationTotal:D})});return function(z){return p.apply(this,arguments)}}();E._createClass(f,[{key:"size",get:function(){return this.items.length}}]);return f}();t.SnappingTypes=void 0;(function(f){f[f.NONE=0]="NONE";f[f.EDGE=1]="EDGE";f[f.VERTEX=2]="VERTEX"})(t.SnappingTypes||
(t.SnappingTypes={}));let n=function(){function f(q,p){this.coords=q;this.coordsIndex=p}E._createClass(f,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return f}();t.QueryEngineResult=g;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe",
"./jsonUtils"],function(v,t,E){function B({scale:H,translate:I},D){return Math.round((D-I[0])/H[0])}function u({scale:H,translate:I},D){return Math.round((I[1]-D)/H[1])}function A(H,I,D){const C=[];let F,K,J,P;for(let S=0;S<D.length;S++){const X=D[S];if(0<S){if(J=B(H,X[0]),P=u(H,X[1]),J!==F||P!==K)C.push(I(X,J-F,P-K)),F=J,K=P}else F=B(H,X[0]),K=u(H,X[1]),C.push(I(X,F,K))}return 0<C.length?C:null}function x(H,I,D,C){return A(H,D?C?G:y:C?y:w,I)}function e(H,I,D,C){const F=[];D=D?C?G:y:C?y:w;for(C=0;C<
I.length;C++){const K=A(H,D,I[C]);K&&3<=K.length&&F.push(K)}return F.length?F:null}function h(H,I,D,C){const F=[];D=D?C?G:y:C?y:w;for(C=0;C<I.length;C++){const K=A(H,D,I[C]);K&&2<=K.length&&F.push(K)}return F.length?F:null}function d({scale:H,translate:I},D){return D*H[0]+I[0]}function l({scale:H,translate:I},D){return I[1]-D*H[1]}function m(H,I,D){const C=Array(D.length);if(!D.length)return C;const [F,K]=H.scale;let J=d(H,D[0][0]);H=l(H,D[0][1]);C[0]=I(D[0],J,H);for(let P=1;P<D.length;P++){const S=
D[P];J+=S[0]*F;H-=S[1]*K;C[P]=I(S,J,H)}return C}function r(H,I,D){const C=Array(D.length);for(let F=0;F<D.length;F++)C[F]=m(H,I,D[F]);return C}function k(H,I,D,C){return m(H,D?C?G:y:C?y:w,I)}function c(H,I,D,C){return r(H,D?C?G:y:C?y:w,I)}function b(H,I,D,C){return r(H,D?C?G:y:C?y:w,I)}function a(H,I,D){let [C,F]=D[0],K=Math.min(C,I[0]),J=Math.min(F,I[1]),P=Math.max(C,I[2]);I=Math.max(F,I[3]);for(let S=1;S<D.length;S++){const [X,ha]=D[S];C+=X;F+=ha;0>X&&(K=Math.min(K,C));0<X&&(P=Math.max(P,C));0>
ha?J=Math.min(J,F):0<ha&&(I=Math.max(I,F))}H[0]=K;H[1]=J;H[2]=P;H[3]=I;return H}function g(H,I){if(!I.length)return null;H[0]=H[1]=Number.POSITIVE_INFINITY;H[2]=H[3]=Number.NEGATIVE_INFINITY;for(let D=0;D<I.length;D++)a(H,H,I[D]);return H}function n(H,I,D,C,F){I.xmin=B(H,D.xmin);I.ymin=u(H,D.ymin);I.xmax=B(H,D.xmax);I.ymax=u(H,D.ymax);I!==D&&(C&&(I.zmin=D.zmin,I.zmax=D.zmax),F&&(I.mmin=D.mmin,I.mmax=D.mmax));return I}function f(H,I,D,C,F){I.points=x(H,D.points,C,F)??[];return I}function q(H,I,D,C,
F){I.x=B(H,D.x);I.y=u(H,D.y);I!==D&&(C&&(I.z=D.z),F&&(I.m=D.m));return I}function p(H,I,D,C,F){H=e(H,D.rings,C,F);if(!H)return null;I.rings=H;return I}function z(H,I,D,C,F){H=h(H,D.paths,C,F);if(!H)return null;I.paths=H;return I}const w=(H,I,D)=>[I,D],y=(H,I,D)=>[I,D,H[2]],G=(H,I,D)=>[I,D,H[2],H[3]];v.equals=function(H,I){if(H===I||null==H&&null==I)return!0;if(null==H||null==I)return!1;let D,C,F,K;H&&"upperLeft"===H.originPosition?(D=H.translate[0],C=H.translate[1],H=H.scale[0]):(D=t.isSome(H.extent)?
H.extent.xmin:0,C=t.isSome(H.extent)?H.extent.ymax:0,H=H.tolerance);I&&"upperLeft"===I.originPosition?(F=I.translate[0],K=I.translate[1],I=I.scale[0]):(F=t.isSome(I.extent)?I.extent.xmin:0,K=t.isSome(I.extent)?I.extent.ymax:0,I=I.tolerance);return D===F&&C===K&&H===I};v.getQuantizedBoundsCoordsArray=a;v.getQuantizedBoundsCoordsArrayArray=g;v.getQuantizedBoundsPaths=function(H){return g([0,0,0,0],H)};v.getQuantizedBoundsPoints=function(H){const I=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return a(I,I,H)};v.getQuantizedBoundsRings=function(H){return g([0,0,0,0],H)};v.quantizeBounds=function(H,I,D){I[0]=B(H,D[0]);I[3]=u(H,D[1]);I[2]=B(H,D[2]);I[1]=u(H,D[3]);return I};v.quantizeExtent=n;v.quantizeGeometry=function(H,I){return H&&I?E.isPoint(I)?q(H,{},I,!1,!1):E.isPolyline(I)?z(H,{},I,!1,!1):E.isPolygon(I)?p(H,{},I,!1,!1):E.isMultipoint(I)?f(H,{},I,!1,!1):E.isExtent(I)?n(H,{},I,!1,!1):null:null};v.quantizeMultipoint=f;v.quantizePaths=
h;v.quantizePoint=q;v.quantizePoints=x;v.quantizePolygon=p;v.quantizePolyline=z;v.quantizeRings=e;v.quantizeX=B;v.quantizeY=u;v.toQuantizationTransform=function(H){return H?{originPosition:"upper-left"===H.originPosition?"upperLeft":"lower-left"===H.originPosition?"lowerLeft":H.originPosition,scale:H.tolerance?[H.tolerance,H.tolerance]:[1,1],translate:t.isSome(H.extent)?[H.extent.xmin,H.extent.ymax]:[0,0]}:null};v.unquantizeBounds=function(H,I,D){return D?(I[0]=d(H,D[0]),I[1]=l(H,D[3]),I[2]=d(H,D[2]),
I[3]=l(H,D[1]),I):[d(H,I[0]),l(H,I[3]),d(H,I[2]),l(H,I[1])]};v.unquantizeCoordsArray=m;v.unquantizeCoordsArrayArray=r;v.unquantizeExtent=function(H,I,D,C,F){I.xmin=d(H,D.xmin);I.ymin=l(H,D.ymin);I.xmax=d(H,D.xmax);I.ymax=l(H,D.ymax);I!==D&&(C&&(I.zmin=D.zmin,I.zmax=D.zmax),F&&(I.mmin=D.mmin,I.mmax=D.mmax));return I};v.unquantizeMultipoint=function(H,I,D,C,F){t.isSome(D)&&(I.points=k(H,D.points,C,F));return I};v.unquantizePaths=c;v.unquantizePoint=function(H,I,D,C,F){if(t.isNone(D))return I;I.x=d(H,
D.x);I.y=l(H,D.y);I!==D&&(C&&(I.z=D.z),F&&(I.m=D.m));return I};v.unquantizePoints=k;v.unquantizePolygon=function(H,I,D,C,F){t.isSome(D)&&(I.rings=b(H,D.rings,C,F));return I};v.unquantizePolyline=function(H,I,D,C,F){t.isSome(D)&&(I.paths=c(H,D.paths,C,F));return I};v.unquantizeRings=b;v.unquantizeX=d;v.unquantizeY=l;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport",
"../../../statistics/utils"],function(v,t,E){return function(){function B(A,x,e){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=A.returnDistinctValues??!1;this.fieldsIndex=e;this.featureAdapter=x;if((x=A.outFields)&&!x.includes("*")){this.outFields=x;A=0;for(const d of x){var h=t.getExpressionFromFieldName(d);h=(x=this.fieldsIndex.get(h))?null:t.getWhereClause(h,e);x=x?x.name:t.getAliasFromFieldName(d)||`FIELD_EXP_${A++}`;this._fieldDataCache.set(d,{alias:x,
clause:h})}}}var u=B.prototype;u.countDistinctValues=function(A){if(!this.returnDistinctValues)return A.length;A.forEach(x=>this.getAttributes(x));return this._returnDistinctMap.size};u.getAttributes=function(A){A=this._processAttributesForOutFields(A);return this._processAttributesForDistinctValues(A)};u.getFieldValue=function(A,x,e){const h=e?e.name:x;let d=null;this._fieldDataCache.has(h)?d=this._fieldDataCache.get(h).clause:e||(d=t.getWhereClause(x,this.fieldsIndex),this._fieldDataCache.set(h,
{alias:h,clause:d}));return e?this.featureAdapter.getAttribute(A,h):d.calculateValue(A,this.featureAdapter)};u.getDataValue=function(A,x){const e=x.normalizationType,h=x.normalizationTotal;let d=this.getFieldValue(A,x.field,this.fieldsIndex.get(x.field));x.field2&&(d=`${E.processNullValue(d)}${x.fieldDelimiter}${E.processNullValue(this.getFieldValue(A,x.field2,this.fieldsIndex.get(x.field2)))}`,x.field3&&(d=`${d}${x.fieldDelimiter}${E.processNullValue(this.getFieldValue(A,x.field3,this.fieldsIndex.get(x.field3)))}`));
e&&Number.isFinite(d)&&(A="field"===e&&x.normalizationField?this.getFieldValue(A,x.normalizationField,this.fieldsIndex.get(x.normalizationField)):null,d=E.getNormalizedValue(d,e,A,h));return d};u.getExpressionValue=function(A,x,e,h){A={attributes:this.featureAdapter.getAttributes(A),layer:{fields:this.fieldsIndex.fields}};e=h.createExecContext(A,e);return h.executeFunction(x,e)};u.getExpressionValues=function(A,x,e,h){const d={fields:this.fieldsIndex.fields};return A.map(l=>{l={attributes:this.featureAdapter.getAttributes(l),
layer:d};l=h.createExecContext(l,e);return h.executeFunction(x,l)})};u.validateItem=function(A,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:t.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x).clause.testFeature(A,this.featureAdapter)};u.validateItems=function(A,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:t.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x).clause.testSet(A,this.featureAdapter)};
u._processAttributesForOutFields=function(A){const x=this.outFields;if(!x||!x.length)return this.featureAdapter.getAttributes(A);const e={};for(const h of x){const {alias:d,clause:l}=this._fieldDataCache.get(h);e[d]=l?l.calculateValue(A,this.featureAdapter):this.featureAdapter.getAttribute(A,d)}return e};u._processAttributesForDistinctValues=function(A){if(v.isNone(A)||!this.returnDistinctValues)return A;var x=this.outFields,e=[];if(x)for(const d of x){var {alias:h}=this._fieldDataCache.get(d);e.push(A[h])}else for(h in A)e.push(A[h]);
x=`${(x||["*"]).join(",")}=${e.join(",")}`;e=this._returnDistinctMap.get(x)||0;this._returnDistinctMap.set(x,++e);return 1<e?null:A};return B}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(v,t,E){function B(p){return null==p||"string"===typeof p&&!p?"\x3cNull\x3e":p}function u(p){const z=null!=p.minValue||null!=p.maxValue,w=!!p.sqlExpression&&p.supportsSQLExpression;return!(null!=p.normalizationField||
null!=p.normalizationType)&&!z&&!w}function A(p){const {values:z,useSampleStdDev:w,supportsNullCount:y}=p;var G=Number.POSITIVE_INFINITY;let H=Number.NEGATIVE_INFINITY,I=null,D=null;var C=null;let F=null,K=0;const J=null==p.minValue?-Infinity:p.minValue,P=null==p.maxValue?Infinity:p.maxValue;for(const S of z)Number.isFinite(S)?S>=J&&S<=P&&(I+=S,G=Math.min(G,S),H=Math.max(H,S),K++):"string"===typeof S&&K++;if(K&&null!=I){D=I/K;C=0;for(const S of z)Number.isFinite(S)&&S>=J&&S<=P&&(C+=(S-D)**2);F=w?
1<K?C/(K-1):0:0<K?C/K:0;C=Math.sqrt(F)}else H=G=null;G={avg:D,count:K,max:H,min:G,stddev:C,sum:I,variance:F};y&&(G.nullcount=z.length-K);p.percentileParams&&(G.median=x(z,p.percentileParams));return G}function x(p,z){const {fieldType:w,value:y,orderBy:G,isDiscrete:H}=z,I=e(w,"desc"===G);p=[...p].filter(K=>null!=K).sort((K,J)=>I(K,J));if(0===p.length)return null;if(0>=y)return p[0];if(1<=y)return p[p.length-1];var D=(p.length-1)*y,C=Math.floor(D);z=C+1;D%=1;C=p[C];const F=p[z];return z>=p.length||
H||"string"===typeof C||"string"===typeof F?C:C*(1-D)+F*D}function e(p,z){const w=z?1:-1,y=d(z),G=h(z);if(!p||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...f].includes(p))return(H,I)=>"number"===typeof H&&"number"===typeof I?y(H,I):"string"===typeof H&&"string"===typeof I?G(H,I):w;if("esriFieldTypeDate"===p)return(H,I)=>{H=(new Date(H)).getTime();I=(new Date(I)).getTime();return isNaN(H)||isNaN(I)?w:y(H,I)};if(f.has(p))return(H,I)=>y(H,I);if("esriFieldTypeString"===
p)return(H,I)=>G(H,I);if("esriFieldTypeGUID"===p||"esriFieldTypeGlobalID"===p){const H=h(z);return(I,D)=>H(l(I),l(D))}return z?(H,I)=>1:(H,I)=>-1}function h(p){return p?(z,w)=>{z=z?.toUpperCase();w=w?.toUpperCase();return z>w?-1:z<w?1:0}:(z,w)=>{z=z?.toUpperCase();w=w?.toUpperCase();return z<w?-1:z>w?1:0}}function d(p){return p?(z,w)=>w-z:(z,w)=>z-w}function l(p){return p.substr(24,12)+p.substr(19,4)+p.substr(16,2)+p.substr(14,2)+p.substr(11,2)+p.substr(9,2)+p.substr(6,2)+p.substr(4,2)+p.substr(2,
2)+p.substr(0,2)}function m(p){return"coded-value"!==p?.type?[]:p.codedValues.map(z=>z.code)}function r(p,z){const w=c({field:z.field,normalizationType:z.normalizationType,normalizationField:z.normalizationField,classificationMethod:z.classificationMethod,standardDeviationInterval:z.standardDeviationInterval,breakCount:z.numClasses||5});p=k(p,z.minValue,z.maxValue);return E.createGenerateRendererClassBreaks({definition:w,values:p,normalizationTotal:z.normalizationTotal})}function k(p,z,w){z=null==
z?-Infinity:z;w=null==w?Infinity:w;return p.filter(y=>Number.isFinite(y)&&y>=z&&y<=w)}function c(p){const z=p.field,w=p.classificationMethod||"equal-interval",y=p.normalizationType,G=p.normalizationField,H=new t;H.classificationField=z;H.breakCount=p.breakCount;H.classificationMethod=w;H.standardDeviationInterval="standard-deviation"===w?p.standardDeviationInterval||1:void 0;H.normalizationType=y;H.normalizationField="field"===y?G:void 0;return H}function b(p,z){const {field:w,classificationMethod:y,
standardDeviationInterval:G,normalizationType:H,normalizationField:I,normalizationTotal:D,minValue:C,maxValue:F}=z,K=z.numBins||10;let J=z=null,P=null;y&&"equal-interval"!==y||H?({classBreaks:p}=r(p,{field:w,normalizationType:H,normalizationField:I,normalizationTotal:D,classificationMethod:y,standardDeviationInterval:G,minValue:C,maxValue:F,numClasses:K}),z=p[0].minValue,J=p[p.length-1].maxValue,P=p.map(S=>[S.minValue,S.maxValue])):(null!=C&&null!=F?(z=C,J=F):(p=A({values:p,minValue:C,maxValue:F,
useSampleStdDev:!H,supportsNullCount:u({normalizationType:H,normalizationField:I,minValue:C,maxValue:F})}),z=p.min,J=p.max),P=g(z,J,K));return{min:z,max:J,intervals:P}}function a(p,z){let w=-1;for(let y=p.length-1;0<=y;y--)if(z>=p[y][0]){w=y;break}return w}function g(p,z,w){const y=(z-p)/w,G=[];let H;for(let I=1;I<=w;I++)H=p+y,H=Number(H.toFixed(16)),G.push([p,I===w?z:H]),p=H;return G}const n=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,f=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"]),q="min max avg stddev count sum variance nullcount median".split(" ");v.calculateClassBreaks=r;v.calculateHistogram=function(p,z){const {min:w,max:y,intervals:G}=b(p,z),H=G.map((I,D)=>({minValue:G[D][0],maxValue:G[D][1],count:0}));for(const I of p)null!=I&&I>=w&&I<=y&&(p=a(G,I),-1<p&&H[p].count++);return{bins:H,minValue:w,maxValue:y,normalizationTotal:z.normalizationTotal}};v.calculatePercentile=x;v.calculateStatistics=A;v.calculateStringStatistics=function(p){const z=p.returnDistinct?
[...(new Set(p.values))]:p.values,w=z.filter(G=>null!=G).length,y={count:w};p.supportsNullCount&&(y.nullcount=z.length-w);p.percentileParams&&(y.median=x(z,p.percentileParams));return y};v.calculateUniqueValuesCount=function(p){const z={};for(let w of p){if(null==w||"string"===typeof w&&""===w.trim())w=null;null==z[w]?z[w]={count:1,data:w}:z[w].count++}return{count:z}};v.createClassBreaksDefinition=c;v.createUVResult=function(p,z,w,y){p=p.count;const G=[];if(w&&z){w=[];var H=m(z[0]);for(const I of H)if(z[1]){H=
m(z[1]);for(const D of H)if(z[2]){H=m(z[2]);for(const C of H)w.push(`${B(I)}${y}${B(D)}${y}${B(C)}`)}else w.push(`${B(I)}${y}${B(D)}`)}else w.push(I);for(const I of w)p.hasOwnProperty(I)||(p[I]={data:I,count:0})}for(const I in p)z=p[I],G.push({value:z.data,count:z.count,label:z.label});return{uniqueValueInfos:G}};v.getAttributeComparator=e;v.getEqualIntervalBins=g;v.getNormalizedValue=function(p,z,w,y){let G=null;switch(z){case "log":0!==p&&(G=Math.log(p)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(y)&&
0!==y&&(G=p/y*100);break;case "field":Number.isFinite(w)&&0!==w&&(G=p/w);break;case "natural-log":0<p&&(G=Math.log(p));break;case "square-root":0<p&&(G=p**.5)}return G};v.isNullCountSupported=u;v.processNullValue=B;v.processSummaryStatisticsResult=function(p,z){let w;for(w in p)q.includes(w)&&(Number.isFinite(p[w])||(p[w]=null));if(!z)return p;["avg","stddev","variance"].forEach(y=>{null!=p[y]&&(p[y]=Math.ceil(p[y]))});return p};v.resolveCBResult=function(p,z){let w=p.classBreaks;const y=w[0].minValue,
G=w[w.length-1].maxValue,H="standard-deviation"===z;w=w.map(I=>{const D=I.label;I={minValue:I.minValue,maxValue:I.maxValue,label:D};if(H&&D){const C=D.match(n).map(F=>+F.trim());2===C.length?(I.minStdDev=C[0],I.maxStdDev=C[1],0>C[0]&&0<C[1]&&(I.hasAvg=!0)):1===C.length&&(D.includes("\x3c")?(I.minStdDev=null,I.maxStdDev=C[0]):D.includes("\x3e")&&(I.minStdDev=C[0],I.maxStdDev=null))}return I});return{minValue:y,maxValue:G,classBreakInfos:w,normalizationTotal:p.normalizationTotal}};v.statisticTypes=
q;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),function(v,t,E,B,u,A,x,e){u=new E.JSONMap({esriClassifyEqualInterval:"equal-interval",
esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});E=new E.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});e=function(h){function d(){var l=h.apply(this,arguments)||this;l.breakCount=null;l.classificationField=null;l.classificationMethod=null;l.normalizationField=null;l.normalizationType=
null;l.type="class-breaks-definition";return l}v._inheritsLoose(d,h);v._createClass(d,[{key:"standardDeviationInterval",set:function(l){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",l)}},{key:"definedInterval",set:function(l){"defined-interval"===this.classificationMethod&&this._set("definedInterval",l)}}]);return d}(e);t.__decorate([B.property({json:{write:!0}})],e.prototype,"breakCount",void 0);t.__decorate([B.property({json:{write:!0}})],e.prototype,"classificationField",
void 0);t.__decorate([B.property({type:String,json:{read:u.read,write:u.write}})],e.prototype,"classificationMethod",void 0);t.__decorate([B.property({json:{write:!0}})],e.prototype,"normalizationField",void 0);t.__decorate([B.property({json:{read:E.read,write:E.write}})],e.prototype,"normalizationType",void 0);t.__decorate([B.property({value:null,json:{write:!0}})],e.prototype,"standardDeviationInterval",null);t.__decorate([B.property({value:null,json:{write:!0}})],e.prototype,"definedInterval",
null);t.__decorate([B.property()],e.prototype,"type",void 0);return e=t.__decorate([x.subclass("esri.rest.support.ClassBreaksDefinition")],e)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(v,t,E,B,u,A,x,e,h,d){E=new E.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});B=function(l){function m(){var r=l.apply(this,arguments)||this;r.baseSymbol=null;r.colorRamp=null;r.type=null;return r}v._inheritsLoose(m,l);return m}(B.JSONSupport);t.__decorate([u.property({type:d,json:{write:!0}})],B.prototype,"baseSymbol",void 0);t.__decorate([u.property({types:h.types,json:{read:{reader:h.fromJSON},write:!0}})],B.prototype,"colorRamp",void 0);t.__decorate([u.property({json:{read:E.read,
write:E.write}})],B.prototype,"type",void 0);return B=t.__decorate([e.subclass("esri.rest.support.ClassificationDefinition")],B)})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(v,t,E,B){E={key:"type",base:E,typeMap:{algorithmic:t,multipart:B}};v.fromJSON=function(u){return u&&u.type?"algorithmic"===u.type?t.fromJSON(u):"multipart"===u.type?B.fromJSON(u):null:null};v.types=E;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(v,t,E,B,u,A,x,e,h){var d;h=d=function(l){function m(r){r=l.call(this,r)||this;r.algorithm=null;
r.fromColor=null;r.toColor=null;r.type="algorithmic";return r}v._inheritsLoose(m,l);m.prototype.clone=function(){return new d({fromColor:B.clone(this.fromColor),toColor:B.clone(this.toColor),algorithm:this.algorithm})};return m}(h);t.__decorate([x.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],h.prototype,"algorithm",void 0);t.__decorate([u.property({type:E,json:{type:[A.Integer],write:!0}})],h.prototype,"fromColor",void 0);t.__decorate([u.property({type:E,
json:{type:[A.Integer],write:!0}})],h.prototype,"toColor",void 0);t.__decorate([u.property({type:["algorithmic"]})],h.prototype,"type",void 0);return h=d=t.__decorate([e.subclass("esri.rest.support.AlgorithmicColorRamp")],h)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(v,t,E){v.enumeration=function(B,u={}){B=B instanceof t.JSONMap?B:new t.JSONMap(B,u);B={type:u?.ignoreUnknown??!0?B.apiValues:String,json:{type:B.jsonValues,
read:u?.readOnly?!1:{reader:B.read},write:{writer:B.write}}};void 0!==u?.readOnly&&(B.readOnly=!!u.readOnly);void 0!==u?.default&&(B.json.default=u.default);void 0!==u?.name&&(B.json.name=u.name);return E.property(B)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x){E=function(e){function h(d){d=e.call(this,d)||this;d.type=null;return d}v._inheritsLoose(h,e);return h}(E.JSONSupport);t.__decorate([B.property({readOnly:!0,json:{read:!1,write:!0}})],E.prototype,"type",void 0);return E=t.__decorate([x.subclass("esri.rest.support.ColorRamp")],E)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(v,t,E,B,u,A,x,e){var h;u=h=function(d){function l(m){m=d.call(this,m)||this;m.colorRamps=null;m.type="multipart";return m}v._inheritsLoose(l,d);l.prototype.clone=function(){return new h({colorRamps:E.clone(this.colorRamps)})};return l}(e);t.__decorate([B.property({type:[x],json:{write:!0}})],u.prototype,"colorRamps",void 0);t.__decorate([B.property({type:["multipart"]})],u.prototype,"type",void 0);return u=h=t.__decorate([A.subclass("esri.rest.support.MultipartColorRamp")],u)})},"esri/symbols/Symbol":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e,h,d){B=new B.JSONMap({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let l=0;u=function(m){function r(c){c=m.call(this,c)||this;c.id=`sym${l++}`;c.type=null;c.color=new E([0,0,0,1]);return c}
v._inheritsLoose(r,m);var k=r.prototype;k.readColor=function(c){return c&&null!=c[0]?[c[0],c[1],c[2],c[3]/255]:c};k.collectRequiredFields=function(){var c=v._asyncToGenerator(function*(b,a){});return function(b,a){return c.apply(this,arguments)}}();k.hash=function(){return JSON.stringify(this.toJSON())};k.clone=function(){};return r}(u.JSONSupport);t.__decorate([A.property({type:B.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:B.write}}})],u.prototype,"type",void 0);t.__decorate([A.property({type:E,
json:{write:{allowNull:!0}}})],u.prototype,"color",void 0);t.__decorate([h.reader("color")],u.prototype,"readColor",null);return u=t.__decorate([d.subclass("esri.symbols.Symbol")],u)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(v,t){function E(r){const {classificationMethod:k,breakCount:c,normalizationType:b,definedInterval:a}=r.definition,g=[];var n=r.values;if(0===n.length)return[];n=n.sort((y,G)=>y-G);var f=n[0],q=n[n.length-1];if("equal-interval"===
k)if(n.length>=c){n=(q-f)/c;r=f;for(var p=1;p<c;p++){var z=Number((f+p*n).toFixed(6));g.push({minValue:r,maxValue:z,label:B(r,z,b)});r=z}g.push({minValue:r,maxValue:q,label:B(r,q,b)})}else n.forEach(y=>{g.push({minValue:y,maxValue:y,label:B(y,y,b)})});else if("natural-breaks"===k){n=u(n);r=A(n.uniqueValues,r.valueFrequency||n.valueFrequency,c);for(p=1;p<c;p++)n.uniqueValues.length>p&&(z=Number(n.uniqueValues[r[p]].toFixed(6)),g.push({minValue:f,maxValue:z,label:B(f,z,b)}),f=z);g.push({minValue:f,
maxValue:q,label:B(f,q,b)})}else if("quantile"===k)if(n.length>=c&&f!==q){r=Math.ceil(n.length/c);p=0;for(z=1;z<c;z++){var w=r+p-1;w>n.length&&(w=n.length-1);0>w&&(w=0);g.push({minValue:f,maxValue:n[w],label:B(f,n[w],b)});f=n[w];p+=r;r=Math.ceil((n.length-p)/(c-z))}g.push({minValue:f,maxValue:q,label:B(f,q,b)})}else for(q=-1,f=0;f<n.length;f++)r=n[f],r!==q&&(q=r,g.push({minValue:q,maxValue:r,label:B(q,r,b)}),q=r);else if("standard-deviation"===k)if(r=h(n),p=d(n,r),0===p)g.push({minValue:n[0],maxValue:n[0],
label:B(n[0],n[0],b)});else{n=e(f,q,c,r,p)*p;p=0;for(z=c;1<=z;z--)w=Number((r-(z-.5)*n).toFixed(6)),g.push({minValue:f,maxValue:w,label:B(f,w,b)}),f=w,p++;z=Number((r+.5*n).toFixed(6));g.push({minValue:f,maxValue:z,label:B(f,z,b)});f=z;p++;for(w=1;w<=c;w++)z=p===2*c?q:Number((r+(w+.5)*n).toFixed(6)),g.push({minValue:f,maxValue:z,label:B(f,z,b)}),f=z,p++}else if("defined-interval"===k){if(!a)return g;q=n[0];n=n[n.length-1];f=Math.ceil((n-q)/a);r=q;for(p=1;p<f;p++)z=Number((q+p*a).toFixed(6)),g.push({minValue:r,
maxValue:z,label:B(r,z,b)}),r=z;g.push({minValue:r,maxValue:n,label:B(r,n,b)})}return g}function B(r,k,c){let b=null;return b=r===k?c&&"percent-of-total"===c?r+"%":r.toString():c&&"percent-of-total"===c?r+"% - "+k+"%":r+" - "+k}function u(r){const k=[],c=[];let b=Number.MIN_VALUE,a=1,g=-1;for(let n=0;n<r.length;n++){const f=r[n];f===b?(a++,c[g]=a):null!==f&&(k.push(f),b=f,a=1,c.push(a),g++)}return{uniqueValues:k,valueFrequency:c}}function A(r,k,c){var b=r.length;const a=[];c>b&&(c=b);for(var g=0;g<
c;g++)a.push(Math.round(g*b/c-1));a.push(b-1);g=x(a,r,k,c);b=g.mean;g=g.sdcm;var n=c,f=0,q=0;let p=0,z=0,w=!0;for(let G=0;2>G&&w;G++){0===G&&(w=!1);for(var y=0;y<n-1;y++)for(;a[y+1]+1!==a[y+2];)if(a[y+1]+=1,f=l(y,a,r,k),p=f.sbMean,f=f.sbSdcm,q=l(y+1,a,r,k),z=q.sbMean,q=q.sbSdcm,f+q<g[y]+g[y+1])g[y]=f,g[y+1]=q,b[y]=p,b[y+1]=z,w=!0;else{--a[y+1];break}for(y=n-1;0<y;y--)for(;a[y]!==a[y-1]+1;)if(--a[y],f=l(y-1,a,r,k),p=f.sbMean,f=f.sbSdcm,q=l(y,a,r,k),z=q.sbMean,q=q.sbSdcm,f+q<g[y-1]+g[y])g[y-1]=f,g[y]=
q,b[y-1]=p,b[y]=z,w=!0;else{a[y]+=1;break}}w&&(g=x(a,r,k,c));return a}function x(r,k,c,b){let a=[];var g=[],n=[];let f=0;const q=[],p=[];for(var z=0;z<b;z++){var w=l(z,r,k,c);q.push(w.sbMean);p.push(w.sbSdcm);f+=p[z]}w=f;for(z=!0;z||f<w;){z=!1;a=[];for(g=0;g<b;g++)a.push(r[g]);for(n=0;n<b;n++)for(w=r[n]+1;w<=r[n+1];w++)if(g=k[w],0<n&&w!==r[n+1]&&Math.abs(g-q[n])>Math.abs(g-q[n-1]))r[n]=w;else if(n<b-1&&r[n]!==w-1&&Math.abs(g-q[n])>Math.abs(g-q[n+1])){r[n+1]=w-1;break}w=f;f=0;g=[];n=[];for(let y=0;y<
b;y++){g.push(q[y]);n.push(p[y]);const G=l(y,r,k,c);q[y]=G.sbMean;p[y]=G.sbSdcm;f+=p[y]}}if(f>w){for(k=0;k<b;k++)r[k]=a[k],q[k]=g[k],p[k]=n[k];f=w}return{mean:q,sdcm:p}}function e(r,k,c,b,a){r=Math.max(b-r,k-b)/a/c;return 1<=r?1:.5<=r?.5:.25}function h(r){let k=0;for(let c=0;c<r.length;c++)k+=r[c];return k/=r.length}function d(r,k){let c=0;for(let b=0;b<r.length;b++){const a=r[b];c+=(a-k)*(a-k)}c/=r.length;return Math.sqrt(c)}function l(r,k,c,b){var a=0,g=0;for(var n=k[r]+1;n<=k[r+1];n++){const f=
b[n];a+=c[n]*f;g+=f}0>=g&&m.warn("Exception in Natural Breaks calculation");a/=g;g=0;for(n=k[r]+1;n<=k[r+1];n++)g+=b[n]*(c[n]-a)**2;return{sbMean:a,sbSdcm:g}}const m=t.getLogger("esri.rest.support.generateRendererUtils");v.createGenerateRendererClassBreaks=function(r){const {normalizationTotal:k}=r;return{classBreaks:E(r),normalizationTotal:k}};v.createGenerateRendererUniqueValues=function(r){r=u(r);const k=[],c=r.uniqueValues.length;for(let b=0;b<c;b++){const a=r.uniqueValues[b];k.push({value:a,
count:r.valueFrequency[b],label:a.toString()})}return{uniqueValues:k}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(v){v.makeEdgeCandidate=function(t,E,B,u,A,x=!1){return{objectId:t,target:E,distance:B,type:"edge",start:u,end:A,draped:x}};v.makeVertexCandidate=function(t,E,B){return{objectId:t,target:E,distance:B,type:"vertex"}};Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),function(v,
t,E,B,u,A,x,e,h,d,l,m,r,k){function c(){c=E._asyncToGenerator(function*(C,F,K){const {outFields:J,orderByFields:P,groupByFieldsForStatistics:S,outStatistics:X}=C;if(J)for(var ha=0;ha<J.length;ha++)J[ha]=J[ha].trim();if(P)for(ha=0;ha<P.length;ha++)P[ha]=P[ha].trim();if(S)for(ha=0;ha<S.length;ha++)S[ha]=S[ha].trim();if(X)for(ha=0;ha<X.length;ha++)X[ha].onStatisticField&&(X[ha].onStatisticField=X[ha].onStatisticField.trim());C.geometry&&!C.outSR&&(C.outSR=C.geometry.spatialReference);return b(C,F,K)});
return c.apply(this,arguments)}function b(C,F,K){return a.apply(this,arguments)}function a(){a=E._asyncToGenerator(function*(C,F,K){if(!C)return null;var {where:J}=C;C.where=J=J&&J.trim();if(!J||/^1 *= *1$/.test(J)||F&&F===J)C.where=null;if(!C.geometry)return C;F=yield n(C);C.distance=0;C.units=null;"esriSpatialRelEnvelopeIntersects"===C.spatialRel&&({spatialReference:J}=C.geometry,F=e.getGeometryExtent(F),F.spatialReference=J);if(F){yield k.checkProjectionSupport(F.spatialReference,K);J=F.spatialReference;
F=g(F,K)&&h.isExtent(F)?{spatialReference:J,rings:[[[F.xmin,F.ymin],[F.xmin,F.ymax],[F.xmax,F.ymax],[F.xmax,F.ymin],[F.xmin,F.ymin]]]}:F;J=(yield d.normalizeCentralMeridian(h.fromJSON(F)))[0];if(u.isNone(J))throw w;const P="quantizationParameters"in C&&C.quantizationParameters?.tolerance||"maxAllowableOffset"in C&&C.maxAllowableOffset||0;F=P&&g(F,K)?{densificationStep:8*P}:void 0;J=J.toJSON();F=yield k.project(J,J.spatialReference,K,F);if(!F)throw w;F.spatialReference=K;C.geometry=F}return C});return a.apply(this,
arguments)}function g(C,F){if(!C)return!1;const K=C.spatialReference;return(h.isExtent(C)||h.isPolygon(C)||h.isPolyline(C))&&!l.equals(K,F)&&!x.canProjectWithoutEngine(K,F)}function n(C){return f.apply(this,arguments)}function f(){f=E._asyncToGenerator(function*(C){const {distance:F,units:K}=C,J=C.geometry;if(null==F||"vertexAttributes"in J)return J;var P=J.spatialReference;C=K?z.fromJSON(K):A.getUnitString(P);P=P&&(l.isGeographic(P)||l.isWebMercator(P))?J:yield k.checkProjectionSupport(P,l.WGS84).then(()=>
k.project(J,l.WGS84));return(yield q())(P.spatialReference,P,F,C)});return f.apply(this,arguments)}function q(){return p.apply(this,arguments)}function p(){p=E._asyncToGenerator(function*(){return(yield new Promise((C,F)=>v(["../../../geometry/geometryEngineJSON"],C,F))).geodesicBuffer});return p.apply(this,arguments)}const z=new B.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
w=Object.freeze({}),y=new r,G=new r,H=new r,I={esriGeometryPoint:m.convertToPoint,esriGeometryPolyline:m.convertToPolyline,esriGeometryPolygon:m.convertToPolygon,esriGeometryMultipoint:m.convertToMultipoint},D=(C,F)=>"_geVersion"!==C?F:void 0;t.QUERY_ENGINE_EMPTY_RESULT=w;t.cleanFromGeometryEngine=function(C){return C&&"_geVersion"in C?JSON.parse(JSON.stringify(C,D)):C};t.getGeometry=function(C,F,K,J,P,S,X=F,ha=K){const U=F&&X,Q=K&&ha;J=u.isSome(J)?"coords"in J?J:J.geometry:null;if(u.isNone(J))return null;
if(P)return F=m.generalizeOptimizedGeometry(G,J,F,K,C,P,X,ha),S&&(F=m.quantizeOptimizedGeometry(H,F,U,Q,C,S)),I[C]?.(F,U,Q)??null;if(S)return S=m.quantizeOptimizedGeometry(H,J,F,K,C,S,X,ha),I[C]?.(S,U,Q)??null;m.removeZMValues(y,J,F,K,X,ha);return I[C]?.(y,U,Q)??null};t.normalizeQuery=function(C,F,K){return c.apply(this,arguments)};t.normalizeQueryLike=b;t.transformCentroid=function(C,F,K,J=C.hasZ,P=C.hasM){if(u.isNone(F))return null;const S=C.hasZ&&J,X=C.hasM&&P;return K?(C=m.quantizeOptimizedGeometry(H,
F,C.hasZ,C.hasM,"esriGeometryPoint",K,J,P),m.convertToPoint(C,S,X)):m.convertToPoint(F,S,X)};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(v,t,E,B,u,A,x,e){function h(la,oa,va){if(la)for(const Ca of la)(la=(la=A.getDeepValue(Ca,oa))&&
"function"!==typeof la&&va.get(la))&&A.setDeepValue(Ca,la.name,oa)}function d(la,oa){if(!la||!oa)return[];Y.clear();l(Y,la,oa);return Array.from(Y).sort()}function l(la,oa,va){if(va)if(oa?.fields?.length)if(va.includes("*"))for(const {name:Ca}of oa.fields)la.add(Ca);else for(const Ca of va)m(la,oa,Ca);else if(va.includes("*"))la.clear(),la.add("*");else for(const Ca of va)null!=Ca&&la.add(Ca)}function m(la,oa,va){"string"===typeof va&&(oa?(oa=oa.get(va))&&la.add(oa.name):la.add(va))}function r(la,
oa,va){return k.apply(this,arguments)}function k(){k=E._asyncToGenerator(function*(la,oa,va){if(va){var {arcadeUtils:Ca}=yield e.loadArcade();va=Ca.extractFieldNames(va,oa?.fields?.map(Fa=>Fa.name));for(const Fa of va)m(la,oa,Fa)}});return k.apply(this,arguments)}function c(la,oa,va){return b.apply(this,arguments)}function b(){b=E._asyncToGenerator(function*(la,oa,va){if(va&&"1\x3d1"!==va){const Ca=(yield new Promise((Fa,Ja)=>v(["../../core/sql/WhereClause"],Fa,Ja))).WhereClause.create(va,oa);if(!Ca.isStandardized)throw new B("fieldUtils:collectFilterFields",
"Where clause is not standardized",{where:va});l(la,oa,Ca.fieldNames)}});return b.apply(this,arguments)}function a(la,oa){for(const va of la)if(va&&va.valueType&&va.valueType===oa)return va.name;return null}function g(){g=E._asyncToGenerator(function*(la){if(!la)return[];const oa=new Set;yield n(oa,la);return Array.from(oa).sort()});return g.apply(this,arguments)}function n(la,oa){return f.apply(this,arguments)}function f(){f=E._asyncToGenerator(function*(la,oa){if(oa){var va=A.getDeepValue("elevationInfo.featureExpressionInfo",
oa);if(va)return va.collectRequiredFields(la,oa.fieldsIndex)}});return f.apply(this,arguments)}function q(){q=E._asyncToGenerator(function*(la,oa,va){if(oa&&va&&"fields"in va){var Ca=[];Ca.push(p(la,oa,va.popupTemplate));va.fields&&Ca.push(...va.fields.map(function(){var Fa=E._asyncToGenerator(function*(Ja){Ja.onStatisticExpression?r(la,oa.fieldsIndex,Ja.onStatisticExpression.expression):la.add(Ja.onStatisticField)});return function(Ja){return Fa.apply(this,arguments)}}()));yield Promise.all(Ca)}});
return q.apply(this,arguments)}function p(la,oa,va){return z.apply(this,arguments)}function z(){z=E._asyncToGenerator(function*(la,oa,va){const Ca=[];va?.expressionInfos&&Ca.push(...va.expressionInfos.map(Fa=>r(la,oa.fieldsIndex,Fa.expression)));va=va?.content;if(Array.isArray(va))for(const Fa of va)"expression"===Fa.type&&Fa.expressionInfo&&Ca.push(r(la,oa.fieldsIndex,Fa.expressionInfo.expression));yield Promise.all(Ca)});return z.apply(this,arguments)}function w(){w=E._asyncToGenerator(function*(la,
oa,va){oa&&(oa.timeInfo&&u.isSome(va)&&va.timeExtent&&l(la,oa.fieldsIndex,[oa.timeInfo.startField,oa.timeInfo.endField]),oa.floorInfo&&l(la,oa.fieldsIndex,[oa.floorInfo.floorField]),u.isSome(va)&&u.isSome(va.where)&&(yield c(la,oa.fieldsIndex,va.where)))});return w.apply(this,arguments)}function y(){y=E._asyncToGenerator(function*(la,oa,va){oa&&va&&(yield Promise.all(va.map(Ca=>G(la,oa,Ca))))});return y.apply(this,arguments)}function G(la,oa,va){return H.apply(this,arguments)}function H(){H=E._asyncToGenerator(function*(la,
oa,va){oa&&va&&(va.valueExpression?yield r(la,oa.fieldsIndex,va.valueExpression):va.field&&m(la,oa.fieldsIndex,va.field))});return H.apply(this,arguments)}function I(){I=E._asyncToGenerator(function*(la){if(!la)return[];const oa="timeInfo"in la&&la.timeInfo;return oa?d(la.fieldsIndex,[la.trackIdField,oa.startField,oa.endField]):[]});return I.apply(this,arguments)}function D(){D=E._asyncToGenerator(function*(la){if(!la)return[];const oa=new Set;yield C(oa,la);return Array.from(oa).sort()});return D.apply(this,
arguments)}function C(la,oa){return F.apply(this,arguments)}function F(){F=E._asyncToGenerator(function*(la,oa){const {labelingInfo:va,fieldsIndex:Ca}=oa;va&&va.length&&(yield Promise.all(va.map(Fa=>K(la,Ca,Fa))))});return F.apply(this,arguments)}function K(la,oa,va){return J.apply(this,arguments)}function J(){J=E._asyncToGenerator(function*(la,oa,va){if(va){var Ca=va.getLabelExpression();va=va.where;"arcade"===Ca.type?yield r(la,oa,Ca.expression):(Ca=Ca.expression.match(/{[^}]*}/g))&&Ca.forEach(Fa=>
{m(la,oa,Fa.slice(1,-1))});yield c(la,oa,va)}});return J.apply(this,arguments)}function P(la){return"number"===typeof la&&!isNaN(la)&&isFinite(la)}function S(la){return null===la||P(la)}function X(la){return null===la||da(la)}function ha(la){return null!=la&&"string"===typeof la}function U(la){return null===la||ha(la)}function Q(){return!0}function O(la,oa){let va;switch(la.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":va=
la.nullable?X:da;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":va=la.nullable?S:P;break;case "string":case "esriFieldTypeString":va=la.nullable?U:ha;break;default:va=Q}return 1===arguments.length?va:va(oa)}function R(la){return null!=la&&pa.has(la.type)}function V(la,oa){return la.nullable&&null===oa?null:R(la)&&!Z(la.type,Number(oa))?t.NumericRangeValidationError.OUT_OF_RANGE:O(la,oa)?la.domain?x.validateDomainValue(la.domain,oa):null:t.TypeValidationError.INVALID_TYPE}
function Z(la,oa){la="string"===typeof la?ka(la):la;if(!la)return!1;const va=la.min,Ca=la.max;return la.isInteger?da(oa)&&oa>=va&&oa<=Ca:oa>=va&&oa<=Ca}function ka(la){switch(la){case "esriFieldTypeSmallInteger":case "small-integer":return sa;case "esriFieldTypeInteger":case "integer":return ta;case "esriFieldTypeSingle":case "single":return ya;case "esriFieldTypeDouble":case "double":return za}}function ia(la,oa,va){if(!oa||!oa.attributes||!la){if(u.isSome(va))for(var Ca of la??[])va.add(Ca);return!0}oa=
oa.attributes;Ca=!1;for(const Fa of la)if(!(Fa in oa))if(Ca=!0,u.isSome(va))va.add(Fa);else break;return Ca}function wa(){wa=E._asyncToGenerator(function*(la,oa){const va=new Set;for(const Ca of oa)yield r(va,la.fieldsIndex,Ca);return Array.from(va).sort()});return wa.apply(this,arguments)}const ea=/^([0-9])/,L=/[^A-Za-z0-9_\u0080-\uffff]/g,M=/_{2,}/g,ba=/^_/,ca=/_$/,ma="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),
W=["field","normalizationField"],Y=new Set,da=(()=>"isInteger"in Number?Number.isInteger:la=>"number"===typeof la&&isFinite(la)&&Math.floor(la)===la)(),ja=["integer","small-integer","single","double"],pa=new Set([...ja,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);t.NumericRangeValidationError=void 0;(t.NumericRangeValidationError||(t.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";t.TypeValidationError=
void 0;(t.TypeValidationError||(t.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const sa={min:-32768,max:32767,isInteger:!0},ta={min:-2147483648,max:2147483647,isInteger:!0},ya={min:-3.4E38,max:1.2E38,isInteger:!1},za={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};t.collectArcadeFieldNames=r;t.collectElevationFields=n;t.collectFeatureReductionFields=function(la,oa,va){return q.apply(this,arguments)};t.collectField=m;t.collectFields=l;t.collectFilterFields=
function(la,oa,va){return w.apply(this,arguments)};t.collectLabelingFields=C;t.collectOrderByInfos=function(la,oa,va){return y.apply(this,arguments)};t.collectPopupTemplateFields=p;t.doubleRange=za;t.featureHasFields=function(la,oa){return!ia(la,oa,null)};t.fixFields=d;t.fixRendererFields=function(la,oa){if(null!=la&&null!=oa)for(const va of Array.isArray(la)?la:[la])if(h(ma,va,oa),"visualVariables"in va&&va.visualVariables)for(const Ca of va.visualVariables)h(W,Ca,oa)};t.fixTimeInfoFields=function(la,
oa){if(null!=la&&oa?.fields?.length)if("startField"in la){var va=oa.get(la.startField);oa=oa.get(la.endField);la.startField=va?.name??null;la.endField=oa?.name??null}else va=oa.get(la.startTimeField),oa=oa.get(la.endTimeField),la.startTimeField=va?.name??null,la.endTimeField=oa?.name??null};t.getDisplayFieldName=function({displayField:la,fields:oa}){if(la)return la;if(!oa||!oa.length)return null;if(!(la=a(oa,"name-or-title")||a(oa,"unique-identifier")||a(oa,"type-or-category")))a:{for(const va of oa)if(va&&
va.name&&(oa=va.name.toLowerCase(),oa.includes("name")||oa.includes("title"))){la=va.name;break a}la=null}return la};t.getElevationFields=function(la){return g.apply(this,arguments)};t.getExpressionFields=function(la,oa){return wa.apply(this,arguments)};t.getFeatureEditFields=function(la){if(!la)return[];const oa="editFieldsInfo"in la&&la.editFieldsInfo;return oa?d(la.fieldsIndex,[oa&&oa.creatorField,oa&&oa.creationDateField,oa&&oa.editorField,oa&&oa.editDateField]):[]};t.getFeatureGeometryFields=
function(la){if(!la)return[];const oa=la.geometryFieldsInfo;return oa?d(la.fieldsIndex,[oa.shapeAreaField,oa.shapeLengthField]):[]};t.getFieldDefaultValue=function(la){const oa=la.defaultValue;if(void 0!==oa&&O(la,oa))return oa;if(la.nullable)return null};t.getFieldRange=function(la){const oa=x.getDomainRange(la.domain);if(oa)return oa;if(R(la))return ka(la.type)};t.getLabelingFields=function(la){return D.apply(this,arguments)};t.getNumericTypeForValue=function(la){if(!P(la))return null;if(da(la)){if(la>=
sa.min&&la<=sa.max)return"esriFieldTypeSmallInteger";if(la>=ta.min&&la<=ta.max)return"esriFieldTypeInteger"}return la>=ya.min&&la<=ya.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};t.getTimeFields=function(la){return I.apply(this,arguments)};t.integerRange=ta;t.isDateField=function(la){return null!=la&&("date"===la.type||"esriFieldTypeDate"===la.type)};t.isNumberInRange=Z;t.isNumericField=R;t.isRasterPixelValueField=function(la){return["raster.itempixelvalue","raster.servicepixelvalue"].some(oa=>
la.toLowerCase().startsWith(oa))};t.isStringField=function(la){return null!=la&&("string"===la.type||"esriFieldTypeString"===la.type)};t.isValidFieldValue=function(la,oa){return null===V(la,oa)};t.isValueMatchingFieldType=O;t.normalizeFieldName=function(la){return la?la.trim().replace(L,"_").replace(M,"_").replace(ba,"").replace(ca,"").replace(ea,"F$1"):null};t.numericTypes=ja;t.packFields=function(la,oa,va=1){if(!oa||!la)return[];if(oa.includes("*"))return["*"];oa=d(la,oa);return oa.length/la.fields.length>=
va?["*"]:oa};t.populateMissingFields=ia;t.rendererFields=ma;t.sanitizeNullFieldValue=function(la){return null==la||"number"===typeof la&&isNaN(la)?null:la};t.singleRange=ya;t.smallIntegerRange=sa;t.unpackFieldNames=function(la,oa){return u.isNone(oa)||u.isNone(la)?[]:oa.includes("*")?(la.fields??[]).map(va=>va.name):oa};t.validateFieldValue=V;t.validationErrorToString=function(la,oa,va){switch(la){case x.DomainValidationError.INVALID_CODED_VALUE:return`Value ${va} is not in the coded domain - field: ${oa.name}, domain: ${JSON.stringify(oa.domain)}`;
case x.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${va} is out of the range of valid values - field: ${oa.name}, domain: ${JSON.stringify(oa.domain)}`;case t.TypeValidationError.INVALID_TYPE:return`Value ${va} is not a valid value for the field type - field: ${oa.name}, type: ${oa.type}, nullable: ${oa.nullable}`;case t.NumericRangeValidationError.OUT_OF_RANGE:const {min:Ca,max:Fa}=ka(oa.type);return`Value ${va} is out of range for the number type - field: ${oa.name}, type: ${oa.type}, value range is ${Ca} to ${Fa}`}};
t.visualVariableFields=W;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(v){v.DomainValidationError=void 0;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(v.DomainValidationError||(v.DomainValidationError={}));v.getDomainRange=function(t){if(t&&"range"===t.type)return{min:"range"in
t?t.range[0]:t.minValue,max:"range"in t?t.range[1]:t.maxValue}};v.validateDomainValue=function(t,E){switch(t.type){case "range":const B="range"in t?t.range[0]:t.minValue;t="range"in t?t.range[1]:t.maxValue;if(null!=B&&+E<B||null!=t&&+E>t)return v.DomainValidationError.VALUE_OUT_OF_RANGE;break;case "coded-value":if(null==t.codedValues||t.codedValues.every(u=>null==u||u.code!==E))return v.DomainValidationError.INVALID_CODED_VALUE;break;case "codedValue":if(null==t.codedValues||t.codedValues.every(u=>
null==u||u.code!==E))return v.DomainValidationError.INVALID_CODED_VALUE}return null};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/Error ../core/Logger ../core/maybe ../geometry/SpatialReference".split(" "),function(v,t,E,B,u,A,x,e){function h(){l||(l=E._asyncToGenerator(function*(){const r=yield new Promise((k,c)=>v(["./arcadeUtils"],
k,c));return{arcade:r.arcade,arcadeUtils:r,Dictionary:r.Dictionary,Feature:r.arcadeFeature}})());return l}const d=A.getLogger("esri.support.arcadeOnDemand");let l;B=(r,k,c)=>m.create(r,k,c,null,["$feature","$view"]);let m=function(){function r(c,b,a,g,n,f,q,p){this.script=c;this.evaluate=n;this.fields=Array.isArray(q)?q:q.fields;this._syntaxTree=g;this._arcade=b;this._arcadeDictionary=a;this._arcadeFeature=f;this._spatialReference=p;this._referencesGeometry=b.scriptTouchesGeometry(this._syntaxTree);
this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}r.create=function(){var c=E._asyncToGenerator(function*(b,a,g,n,f,q){const {arcade:p,Feature:z,Dictionary:w}=yield h(),y=e.fromJSON(a);a=null;try{a=p.parseScript(b,q)}catch(K){return d.error(new u("arcade-bad-expression","Failed to parse arcade script",{script:b,error:K})),null}q=f.reduce((K,J)=>({...K,[J]:null}),{});let G=null;x.isSome(n)&&(G=new w(n),G.immutable=!0,q.$config=null);var H=(n=p.scriptUsesGeometryEngine(a))&&
p.enableGeometrySupport();const I=p.scriptUsesFeatureSet(a)&&p.enableFeatureSetSupport(),D=(f=p.scriptIsAsync(a))&&p.enableAsyncSupport();q={vars:q,spatialReference:y,useAsync:!!D};yield Promise.all([H,I,D]);H=new Set;yield p.loadDependentModules(H,a,null,f,n);const C=new w;C.immutable=!1;C.setField("scale",0);const F=p.compileScript(a,q);return new r(b,p,w,a,K=>{"$view"in K&&K.$view&&(C.setField("scale",K.$view.scale),K.$view=C);G&&(K.$config=G);return F({vars:K,spatialReference:y})},new z,g,y)});
return function(b,a,g,n,f,q){return c.apply(this,arguments)}}();var k=r.prototype;k.repurposeFeature=function(c){c.geometry&&!c.geometry.spatialReference&&(c.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(c.geometry,c.attributes,{fields:this.fields});return this._arcadeFeature};k.createDictionary=function(){return new this._arcadeDictionary};k.referencesMember=function(c){return this._arcade.referencesMember(this._syntaxTree,c)};k.referencesFunction=
function(c){return this._arcade.referencesFunction(this._syntaxTree,c)};k.referencesGeometry=function(){return this._referencesGeometry};k.referencesScale=function(){return this._referencesScale};k.extractFieldLiterals=function(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)};return r}();t.ArcadeExpression=m;t.createDictionaryExpression=(r,k,c,b)=>m.create(r,k,c,b,["$feature","$view"]);t.createLabelExpression=(r,k,c)=>m.create(r,k,c,null,["$feature"]);t.createRendererExpression=
B;t.createVVExpression=B;t.loadArcade=h;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){function k(){return new Promise((g,n)=>v(["../../../geometry/geometryEngineJSON"],g,n))}function c(){c=E._asyncToGenerator(function*(g,n,f){const {spatialRel:q,geometry:p}=g;if(p){if(null==q||!0!==a.spatialRelationship[q])throw new B("feature-store:unsupported-query","Unsupported query spatial relationship",{query:g});if(e.isValid(p.spatialReference)&&e.isValid(f)){if(null==p||!0!==a.queryGeometry[x.getJsonType(p)])throw new B("feature-store:unsupported-query",
"Unsupported query geometry type",{query:g});if(null==n||!0!==a.layerGeometry[n])throw new B("feature-store:unsupported-query","Unsupported layer geometry type",{query:g});if(g.outSR)return m.checkProjectionSupport(g.geometry&&g.geometry.spatialReference,g.outSR)}}});return c.apply(this,arguments)}const b={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,
esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},a={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.canQueryWithRBush=function(g){if(x.isExtent(g))return!0;if(x.isPolygon(g)){for(const n of g.rings)if(5!==n.length||n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1;return!0}return!1};t.checkSpatialQuerySupport=function(g,n,f){return c.apply(this,
arguments)};t.getSpatialQueryOperator=function(g,n,f,q,p){if(x.isPolygon(n)&&"esriGeometryPoint"===f&&("esriSpatialRelIntersects"===g||"esriSpatialRelContains"===g)){const z=d.convertFromPolygon(new l,n,!1,!1);return Promise.resolve(w=>h.polygonContainsPoint(z,!1,!1,w))}if(x.isPolygon(n)&&"esriGeometryMultipoint"===f){const z=d.convertFromPolygon(new l,n,!1,!1);if("esriSpatialRelContains"===g)return Promise.resolve(w=>h.polygonContainsMultipoint(z,!1,!1,w,q,p))}if(x.isExtent(n)&&"esriGeometryPoint"===
f&&("esriSpatialRelIntersects"===g||"esriSpatialRelContains"===g))return Promise.resolve(z=>u.extentContainsPoint(n,r.getGeometry(f,q,p,z)));if(x.isExtent(n)&&"esriGeometryMultipoint"===f&&"esriSpatialRelContains"===g)return Promise.resolve(z=>u.extentContainsMultipoint(n,r.getGeometry(f,q,p,z)));if(x.isExtent(n)&&"esriSpatialRelIntersects"===g){const z=A.getExtentIntersector(f);return Promise.resolve(w=>z(n,r.getGeometry(f,q,p,w)))}return k().then(z=>{const w=z[b[g]].bind(null,n.spatialReference,
n);return y=>w(r.getGeometry(f,q,p,y))})};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(v,t){v.extentIntersectsExtent=t.extentIntersectsExtent;v.extentIntersectsMultipoint=t.extentIntersectsMultipoint;v.extentIntersectsPoint=t.extentIntersectsPoint;v.extentIntersectsPolygon=t.extentIntersectsPolygon;v.extentIntersectsPolyline=t.extentIntersectsPolyline;v.extentIntersectsRings=
t.extentIntersectsRings;v.getFeatureExtentIntersector=t.getFeatureExtentIntersector;v.isSelfIntersecting=t.isSelfIntersecting;v.segmentIntersects=t.segmentIntersects;v.getExtentIntersector=function(E){return"mesh"===E?t.extentIntersectsExtent:t.getFeatureExtentIntersector(E)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/contains":function(){define(["exports"],function(v){function t(E,B,u,A,x){if(!E)return!1;B=B?u?4:3:u?3:2;const {coords:e,
lengths:h}=E;u=!1;E=0;for(const l of h){var d=E;for(let m=E,r=E+l*B;m<r;m+=B){d=m+B;d===r&&(d=E);const k=e[m],c=e[m+1],b=e[d];d=e[d+1];(c<x&&d>=x||d<x&&c>=x)&&k+(x-c)/(d-c)*(b-k)<A&&(u=!u)}E+=l*B}return u}v.polygonContainsCoords=t;v.polygonContainsMultipoint=function(E,B,u,A,x,e){x=x?e?4:3:e?3:2;const {coords:h,lengths:d}=A;if(!d)return!1;for(let l=0,m=0;l<d.length;l++,m+=x)if(!t(E,B,u,h[m],h[m+1]))return!1;return!0};v.polygonContainsPoint=function(E,B,u,A){return t(E,B,u,A.coords[0],A.coords[1])};
Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(v){function t(u,A,x,e,h){if(null!=e&&null!=h)return d=>{const l=u.getAttribute(d,A);d=u.getAttribute(d,x);return(null==l||l<=h)&&(null==d||d>=e)};if(null!=e)return d=>{d=u.getAttribute(d,x);return null==d||d>=e};if(null!=h)return d=>{d=u.getAttribute(d,A);return null==d||d<=h}}function E(u,A,x,e){if(null!=x&&null!=e&&x===e)return h=>
u.getAttribute(h,A)===x;if(null!=x&&null!=e)return h=>{h=u.getAttribute(h,A);return h>=x&&h<=e};if(null!=x)return h=>u.getAttribute(h,A)>=x;if(null!=e)return h=>u.getAttribute(h,A)<=e}function B(){return()=>!1}v.getTimeExtent=function(u,A){if(!u)return null;const x=A.featureAdapter,{startTimeField:e,endTimeField:h}=u;let d=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(e&&h)A.forEach(m=>{const r=x.getAttribute(m,e);m=x.getAttribute(m,h);null==r||isNaN(r)||(d=Math.min(d,r));null==m||isNaN(m)||
(l=Math.max(l,m))});else{const m=e||h;A.forEach(r=>{r=x.getAttribute(r,m);null==r||isNaN(r)||(d=Math.min(d,r),l=Math.max(l,r))})}return{start:d,end:l}};v.getTimeOperator=function(u,A,x){if(!A||!u)return null;const {startTimeField:e,endTimeField:h}=u;if(!e&&!h)return null;const {start:d,end:l}=A;return null===d&&null===l?null:void 0===d&&void 0===l?B():e&&h?t(x,e,h,d,l):E(x,e||h,d,l)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"./fieldUtils"],function(v,t){function E(u){return"oid"===u.type||"esriFieldTypeOID"===u.type}function B(u){return"global-id"===u.type||"esriFieldTypeGlobalID"===u.type}return function(){function u(x=[]){this.fields=[];this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=null;if(x){this.fields=x;var e=[];for(const h of x)if(x=h&&h.name){const d=x.trim().toLowerCase(),l=t.normalizeFieldName(x).toLowerCase();
this._fieldsMap.set(x,h);this._fieldsMap.set(d,h);this._normalizedFieldsMap.set(l,h);e.push(d);"date"===h.type||"esriFieldTypeDate"===h.type?(this.dateFields.push(h),this._dateFieldsSet.add(h)):t.isNumericField(h)&&(this._numericFieldsSet.add(h),this.numericFields.push(h));E(h)||B(h)||(h.editable=null==h.editable?!0:!!h.editable,h.nullable=null==h.nullable?!0:!!h.nullable)}e.sort();this.uid=e.join(",")}}var A=u.prototype;A.destroy=function(){this._fieldsMap.clear()};A.has=function(x){return null!=
this.get(x)};A.get=function(x){if(x){var e=this._fieldsMap.get(x);if(e)return e;(e=this._fieldsMap.get(x.trim().toLowerCase())??this._normalizedFieldsMap.get(t.normalizeFieldName(x).toLowerCase()))&&this._fieldsMap.set(x,e);return e}};A.isDateField=function(x){return this._dateFieldsSet.has(this.get(x))};A.isNumericField=function(x){return this._numericFieldsSet.has(this.get(x))};A.normalizeFieldName=function(x){if(x=this.get(x))return x.name??void 0};v._createClass(u,[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=
[];for(const x of this.fields)E(x)||B(x)||x.nullable||void 0!==t.getFieldDefaultValue(x)||this._requiredFields.push(x)}return this._requiredFields}}]);return u}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Handles ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/accessorSupport/tracking/ObservableValue ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k){function c(y){return b.has(y)?b.get(y):"number"===typeof y?y:1}v.TaskPriority=void 0;(function(y){y.RESOURCE_CONTROLLER="schedule";y.SLIDE="slide";y.STREAM_DATA_LOADER="stream loader";y.ELEVATION_QUERY="elevation query";y.TERRAIN_SURFACE="terrain";y.SURFACE_GEOMETRY_UPDATES="surface geometry updates";y.GRAPHICS_CORE="Graphics3D";y.I3S_CONTROLLER="I3S";y.POINT_CLOUD_LAYER="point cloud";y.FEATURE_TILE_FETCHER="feature fetcher";y.OVERLAY="overlay";y.STAGE="stage";
y.GRAPHICS_DECONFLICTOR="graphics deconflictor";y.FILTER_VISIBILITY="Graphics3D filter visibility";y.SCALE_VISIBILITY="Graphics3D scale visibility";y.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";y.POINT_OF_INTEREST_FREQUENT="POI frequent";y.POINT_OF_INTEREST_INFREQUENT="POI infrequent";y.LABELER="labeler";y.FEATURE_QUERY_ENGINE="feature query";y.FEATURE_TILE_TREE="feature tile tree";y.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";y.ELEVATION_ALIGNMENT="elevation alignment";y.TEXT_TEXTURE_ATLAS=
"text texture atlas";y.TEXTURE_UNLOAD="texture unload";y.LINE_OF_SIGHT_TOOL="line of sight tool";y.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";y.ELEVATION_PROFILE="elevation profile";y.SNAPPING="snapping";y.SHADOW_ACCUMULATOR="shadow accumulator";y.CLOUDS_GENERATOR="cloud generator";y[y.TEST_PRIO=1]="TEST_PRIO"})(v.TaskPriority||(v.TaskPriority={}));const b=new Map([[v.TaskPriority.RESOURCE_CONTROLLER,0],[v.TaskPriority.SLIDE,0],[v.TaskPriority.STREAM_DATA_LOADER,0],[v.TaskPriority.ELEVATION_QUERY,
0],[v.TaskPriority.TERRAIN_SURFACE,1],[v.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[v.TaskPriority.GRAPHICS_CORE,2],[v.TaskPriority.I3S_CONTROLLER,2],[v.TaskPriority.POINT_CLOUD_LAYER,2],[v.TaskPriority.FEATURE_TILE_FETCHER,2],[v.TaskPriority.OVERLAY,4],[v.TaskPriority.STAGE,4],[v.TaskPriority.GRAPHICS_DECONFLICTOR,4],[v.TaskPriority.FILTER_VISIBILITY,4],[v.TaskPriority.SCALE_VISIBILITY,4],[v.TaskPriority.FRUSTUM_VISIBILITY,4],[v.TaskPriority.CLOUDS_GENERATOR,4],[v.TaskPriority.POINT_OF_INTEREST_FREQUENT,
6],[v.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[v.TaskPriority.LABELER,8],[v.TaskPriority.FEATURE_QUERY_ENGINE,8],[v.TaskPriority.FEATURE_TILE_TREE,16],[v.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[v.TaskPriority.ELEVATION_ALIGNMENT,12],[v.TaskPriority.TEXT_TEXTURE_ATLAS,12],[v.TaskPriority.TEXTURE_UNLOAD,12],[v.TaskPriority.LINE_OF_SIGHT_TOOL,16],[v.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[v.TaskPriority.SNAPPING,0],[v.TaskPriority.SHADOW_ACCUMULATOR,30]]),a=d.Milliseconds(6.5),g=d.Milliseconds(1),
n=d.Milliseconds(30),f=d.Milliseconds(1E3/30),q=d.Milliseconds(100);var p;(function(y){let G=function(){function D(){this._updating=new l.ObservableValue(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new A("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new I;this._state=k.RenderState.INTERACTING;this._tasks=new x;this._runQueue=new x;this._load=0;this._idleStateCallbacks=new x;this._idleUpdatesStartFired=!1;this._maxReschedule=32;this._debug=this._forceTask=
!1;this._debugHandle=h.watch(()=>r.SCHEDULER_LOG_SLOW_TASKS,K=>this._debug=K,h.initial);for(const K of Object.keys(v.TaskPriority))this.performanceInfo.tasks.set(v.TaskPriority[K],new A(v.TaskPriority[K]));const F=this;this._test={FRAME_SAFETY_BUDGET:a,INTERACTING_BUDGET:f,IDLE_BUDGET:q,get availableBudget(){return F._budget.budget},usedBudget:0,getBudget:()=>F._budget,setBudget:K=>F._budget=K,updateTask:K=>this._updateTask(K),getState:K=>this._getState(K),getRuntime:K=>this._getRuntime(K),frameTaskTimes:this._frameTaskTimes,
resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}var C=D.prototype;C.destroy=function(){this._tasks.toArray().forEach(F=>F.remove());this._tasks.clear();u.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updating.set(!1)};C.activate=function(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=32,this._schedule(),this.frame()))}))};C.registerTask=
function(F,K){const J=c(F);K=new H(this,F,K,J);this._tasks.push(K);this.performanceInfo.tasks.has(F)||this.performanceInfo.tasks.set(F,new A(F));return K};C.registerIdleStateCallbacks=function(F,K){const J={idleBegin:F,idleEnd:K};this._idleStateCallbacks.push(J);this.state===k.RenderState.IDLE&&this._idleUpdatesStartFired&&J.idleBegin();const P=this;return{remove:()=>this._removeIdleStateCallbacks(J),set idleBegin(S){P._idleUpdatesStartFired&&(J.idleEnd(),P._state===k.RenderState.IDLE&&S());J.idleBegin=
S},set idleEnd(S){J.idleEnd=S}}};C.updateBudget=function(F){this._test.usedBudget=0;++this._frameNumber;let K=a,J=F.frameDuration,P=g;switch(this.state){case k.RenderState.IDLE:K=d.Milliseconds(0);J=d.Milliseconds(Math.max(q,F.frameDuration));P=n;break;case k.RenderState.INTERACTING:J=d.Milliseconds(Math.max(f,F.frameDuration))}J=d.Milliseconds(J-F.elapsedFrameTime-K);if(this.state!==k.RenderState.IDLE&&J<g&&!this._forceTask)return this._forceTask=!0,!1;J=d.Milliseconds(Math.max(J,P));this._budget.reset(J,
this.state);this._maxReschedule=32;this._updateLoad();return this._schedule()};C.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case k.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(F=>F.idleBegin()));this._runIdle();break;case k.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};C.stopFrame=function(){this._budget.reset(d.Milliseconds(0),
this._state);this._budget.madeProgress()};C._removeIdleStateCallbacks=function(F){this._idleUpdatesStartFired&&F.idleEnd();this._idleStateCallbacks.removeUnordered(F)};C.removeTask=function(F){this._tasks.removeUnordered(F);this._runQueue.removeUnordered(F)};C._updateTask=function(F){this._tasks.forAll(K=>{K.name===F&&K.setPriority(F)})};C._getState=function(F){if(this._runQueue.some(J=>J.name===F))return v.TaskState.SCHEDULED;let K=v.TaskState.IDLE;this._tasks.forAll(J=>{J.name===F&&J.needsUpdate&&
(1>=J.schedulePriority?K=v.TaskState.READY:K!==v.TaskState.READY&&(K=v.TaskState.WAITING))});return K};C._getRuntime=function(F){let K=0;this._tasks.forAll(J=>{J.name===F&&(K+=J.runtime)});return K};C._resetRuntimes=function(){this._tasks.forAll(F=>F.runtime=0)};C._getRunning=function(){const F=new Map;this._tasks.forAll(J=>{J.needsUpdate&&F.set(J.name,(F.get(J.name)||0)+1)});if(0===F.size)return null;let K="";F.forEach((J,P)=>{K=1<J?K+` ${J}x ${P}`:K+` ${P}`});return K};C._runIdle=function(){this._run()};
C._runInteracting=function(){this._run()};C._runAnimating=function(){this._run()};C._updateLoad=function(){const F=this._tasks.reduce((K,J)=>J.needsUpdate?++K:K,0);this._load=.9*this._load+F*(1-.9)};C._schedule=function(){if(0>=this._maxReschedule)return!1;this._runQueue.filterInPlace(F=>{if(F.needsUpdate)return!0;F.schedulePriority=F.basePriority;return!1});for(this._tasks.forAll(F=>{0===F.basePriority&&F.needsUpdate&&!this._runQueue.includes(F)&&this._runQueue.unshift(F)});0===this._runQueue.length;){let F=
!1;this._tasks.forAll(K=>{if(K.needsUpdate&&0!==K.schedulePriority&&0!==K.basePriority&&(!K.task.runOncePerFrame||K.lastFrameRun!==this._frameNumber))switch(F=!0,K.schedulePriority){case 1:K.schedulePriority=0;this._runQueue.push(K);break;default:--K.schedulePriority}});if(!F)return this._updating.set(!1),!1;--this._maxReschedule}this._updating.set(!0);return!0};C._run=function(){const F=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var K=this._budget.now();const J=
this._runQueue.pop();this._budget.resetProgress();try{J.task.runTask(this._budget)}catch(P){B.getLogger("esri.views.support.Scheduler").error(`Exception in task "${J.name}"`,P)}J.schedulePriority=J.basePriority;J.lastFrameRun=this._frameNumber;K=this._budget.now()-K;J.runtime+=K;this._frameTaskTimes.set(J.priority,this._frameTaskTimes.get(J.priority)+K);this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",J.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms");
if(0>=this._budget.remaining){this._updating.set(this._tasks.some(P=>P.needsUpdate));this._recordFrameTaskTimes(this._budget.now()-F);return}}while(this._schedule());this._updating.set(this._tasks.some(J=>J.needsUpdate));this._recordFrameTaskTimes(this._budget.now()-F)};C._startFrameTaskTimes=function(){for(const F of Object.keys(v.TaskPriority))this._frameTaskTimes.set(v.TaskPriority[F],0)};C._recordFrameTaskTimes=function(F){this._frameTaskTimes.forEach((K,J)=>this.performanceInfo.tasks.get(J).record(K));
this.performanceInfo.total.record(F)};t._createClass(D,[{key:"updating",get:function(){return this._updating.get()},set:function(F){this._updating.set(F)}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return this._state},set:function(F){this._state!==F&&(this._state=F,this.state!==k.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(K=>K.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return D}();
y.Scheduler=G;let H=function(){function D(F,K,J,P){this._scheduler=F;this.name=K;this._basePriority=P;this.runtime=this.lastFrameRun=0;this._queue=new m.PromiseQueue;this._handles=new E;this.schedulePriority=this._basePriority;this._task=new l.ObservableValue(u.isSome(J)?J:this._queue);this._handles.add(h.when(()=>this.task.running,()=>F.activate()))}var C=D.prototype;C.remove=function(){this.processQueue(z);this._scheduler.removeTask(this);this.schedule=w.schedule;this.reschedule=w.reschedule;this._handles.destroy()};
C.setPriority=function(F){this.name=F;F=c(F);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=F;this._basePriority=F};C.schedule=function(F,K,J){return this._queue.push(F,K,J)};C.reschedule=function(F,K,J){return this._queue.unshift(F,K,J)};C.processQueue=function(F){this._queue.runTask(F)};t._createClass(D,[{key:"task",get:function(){return this._task.get()}},{key:"updating",get:function(){return this._queue.running}},{key:"basePriority",get:function(){return this._basePriority}},
{key:"priority",get:function(){return this.name},set:function(F){this.setPriority(F)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return D}(),I=function(){function D(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=k.RenderState.IDLE;this._done=!1;this._enabled=!0}var C=D.prototype;C.run=function(F){if(this.done)return!1;!0===F()&&this.madeProgress();return!0};C.madeProgress=function(){this._done=this.elapsed>=this._budget&&
this._enabled};C.reset=function(F,K){this._begin=this.now();this._budget=F;this._state=K;this._done=!1};C.now=function(){return performance.now()};C.resetProgress=function(){this._done=!1};t._createClass(D,[{key:"done",get:function(){return this._done}},{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(F){this._enabled=F}},{key:"remaining",get:function(){return Math.max(this._budget-
this.elapsed,0)}},{key:"elapsed",get:function(){return performance.now()-this._begin}},{key:"hasProgressed",get:function(){return this._done}}]);return D}();y.Budget=I})(p||(p={}));v.TaskState=void 0;(function(y){y.SCHEDULED="s";y.READY="r";y.WAITING="w";y.IDLE="i"})(v.TaskState||(v.TaskState={}));const z=(()=>{const y=new p.Budget;y.enabled=!1;return y})(),w=new (function(){function y(){}var G=y.prototype;G.remove=function(){};G.processQueue=function(){};G.schedule=function(H,I,D){try{if(e.isAborted(I)){const C=
e.createAbortError();return D?Promise.resolve(D(C)):Promise.reject(C)}return e.when(H(z))}catch(C){return Promise.reject(C)}};G.reschedule=function(H,I,D){return this.schedule(H,I,D)};return y}());v.ImmediateTask=w;v.getTaskPriority=c;v.newScheduler=function(){return new p.Scheduler};v.noBudget=z;v.taskPriorities=b;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/tracking/ObservableValue":function(){define(["exports","../tracking",
"./SimpleObservable"],function(v,t,E){let B=function(){function u(x){this._observable=new E.SimpleObservable;this._value=x}var A=u.prototype;A.get=function(){t.trackAccess(this._observable);return this._value};A.set=function(x){x!==this._value&&(this._value=x,this._observable.notify())};return u}();v.ObservableValue=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers",
"../../core/promiseUtils","../../core/accessorSupport/tracking/ObservableValue"],function(v,t,E,B){let u=function(){function x(){this._tasks=[];this._running=new B.ObservableValue(!1)}var e=x.prototype;e.destroy=function(){this.cancelAll()};e.runTask=function(h){for(;!h.done&&this._process(h);)h.madeProgress()};e.push=function(h,d,l){this._running.set(!0);return new Promise((m,r)=>this._tasks.push(new A(m,r,h,d,l)))};e.unshift=function(h,d,l){this._running.set(!0);return new Promise((m,r)=>this._tasks.unshift(new A(m,
r,h,d,l)))};e._process=function(h){if(0===this._tasks.length)return!1;const d=this._tasks.shift();try{const l=E.isAborted(d.signal);if(l&&!d.abortCallback)d.reject(E.createAbortError());else{const m=l?d.abortCallback?.(E.createAbortError()):d.callback(h);E.isPromiseLike(m)?m.then(d.resolve,d.reject):d.resolve(m)}}catch(l){d.reject(l)}this._running.set(0<this._tasks.length);return!0};e.cancelAll=function(){const h=E.createAbortError();for(const d of this._tasks)if(d.abortCallback){const l=d.abortCallback(h);
d.resolve(l)}else d.reject(h);this._tasks.length=0;this._running.set(!1)};t._createClass(x,[{key:"length",get:function(){return this._tasks.length}},{key:"running",get:function(){return this._running.get()}}]);return x}(),A=function(x,e,h,d,l){this.resolve=x;this.reject=e;this.callback=h;this.signal=d;this.abortCallback=l};v.PromiseQueue=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x){E=function(e){function h(){var d=e.apply(this,arguments)||this;d.SCHEDULER_LOG_SLOW_TASKS=!1;d.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return d}v._inheritsLoose(h,e);return h}(E);t.__decorate([B.property()],E.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);t.__decorate([B.property()],E.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);E=t.__decorate([x.subclass("esri.views.support.DebugFlags")],E);return new E})},"esri/views/support/RenderState":function(){define(["exports"],
function(v){v.RenderState=void 0;var t=v.RenderState||(v.RenderState={});t[t.ANIMATING=0]="ANIMATING";t[t.INTERACTING=1]="INTERACTING";t[t.IDLE=2]="IDLE";Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),
function(v,t,E,B,u,A,x,e,h,d){const l={getObjectId(m){return m.getObjectId()},getAttributes(m){return m.readAttributes()},getAttribute(m,r){return m.readAttribute(r)},cloneWithGeometry(m,r){return m},getGeometry(m){return m.readHydratedGeometry()},getCentroid(m,r){return m.readCentroid()}};u=function(m){function r(c,b,a){var g=m.call(this,c,b)||this;g.featureAdapter=l;g.events=new B;g._featureSetsByInstance=new Map;g._objectIdToDisplayId=new Map;g._spatialIndexInvalid=!0;g._indexSearchCache=new E(50);
g._index=x.rbush(9,n=>({minX:g._storage.getXMin(n),minY:g._storage.getYMin(n),maxX:g._storage.getXMax(n),maxY:g._storage.getYMax(n)}));g.mode=a;return g}t._inheritsLoose(r,m);var k=r.prototype;k.hasInstance=function(c){return this._featureSetsByInstance.has(c)};k.onTileData=function(c,b){if(A.isNone(b.addOrUpdate))return b;b.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var a=b.addOrUpdate.getCursor();a.next();){const g=a.getDisplayId();this.setComputedAttributes(this._storage,
a,g,c.scale)}return b}this._featureSetsByInstance.set(b.addOrUpdate.instance,b.addOrUpdate);for(a=b.addOrUpdate.getCursor();a.next();)this._insertFeature(a,c.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return b};k.search=function(c){this._rebuildIndex();const b=c.id;var a=this._indexSearchCache.find(f=>f.tileId===b);if(A.isSome(a))return a.readers;a=new Map;c=this._searchIndex(c.bounds);const g=[];for(const f of c){var n=this._storage.getInstanceId(f);c=(4294901760&n)>>>16;n&=
65535;a.has(c)||a.set(c,[]);a.get(c).push(n)}a.forEach((f,q)=>{q=this._featureSetsByInstance.get(q);g.push(d.FeatureSetReaderIndirect.from(q,f))});this._indexSearchCache.enqueue({tileId:b,readers:g});return g};k.insert=function(c){const b=c.getCursor(),a=this._storage;for(;b.next();){var g=b.getIndex();g|=b.instance<<16;const n=b.getObjectId(),f=this._objectIdToDisplayId.get(n)??this._storage.createDisplayId();b.setDisplayId(f);a.setInstanceId(f,g);this._objectIdToDisplayId.set(n,f)}this._featureSetsByInstance.set(c.instance,
c);this._spatialIndexInvalid=!0};k.remove=function(c){const b=this._objectIdToDisplayId.get(c);if(b){var a=this._storage.getInstanceId(b),g=65535&a;a=(4294901760&a)>>>16;var n=this._featureSetsByInstance.get(a);this._objectIdToDisplayId.delete(c);this._storage.releaseDisplayId(b);n.removeAtIndex(g);n.isEmpty&&this._featureSetsByInstance.delete(a);this._spatialIndexInvalid=!0}};k.toArray=function(){const c=[];this.forEach(b=>c.push(b));return c};k.forEach=function(c){this._objectIdToDisplayId.forEach(b=>
{b=this._storage.getInstanceId(b);b=this._lookupFeature(b);c(b)})};k.forEachUnsafe=function(c){this._objectIdToDisplayId.forEach(b=>{var a=this._storage.getInstanceId(b);b=65535&a;a=this._getFeatureSet((4294901760&a)>>>16);a.setIndex(b);c(a)})};k.forEachInBounds=function(c,b){c=this._searchIndex(c);for(const a of c)c=this.lookupFeatureByDisplayId(a,this._storage),b(A.unwrap(c))};k.forEachBounds=function(c,b,a){this._rebuildIndex();const g=[0,0,0,0];for(const n of c)n.readGeometry()&&(c=n.getDisplayId(),
g[0]=this._storage.getXMin(c),g[1]=this._storage.getYMin(c),g[2]=this._storage.getXMax(c),g[3]=this._storage.getYMax(c),b(e.fromRect(a,g)))};k.sweepFeatures=function(c,b,a){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((g,n)=>{c.has(g)||(b.releaseDisplayId(g),a&&a.unsetAttributeData(g),this._objectIdToDisplayId.delete(n))});this.events.emit("changed")};k.sweepFeatureSets=function(c){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((b,a)=>{c.has(a)||this._featureSetsByInstance.delete(a)})};
k.lookupObjectId=function(c,b){c=this.lookupFeatureByDisplayId(c,b);return A.isNone(c)?null:c.getObjectId()};k.lookupDisplayId=function(c){return this._objectIdToDisplayId.get(c)};k.lookupFeatureByDisplayId=function(c,b){c=b.getInstanceId(c);return this._lookupFeature(c)};k.lookupByDisplayIdUnsafe=function(c){var b=this._storage.getInstanceId(c);c=65535&b;b=this._getFeatureSet((4294901760&b)>>>16);if(!b)return null;b.setIndex(c);return b};k._insertFeature=function(c,b){const a=this._storage,g=c.getObjectId();
var n=c.getIndex();n|=c.instance<<16;a.getInstanceId(c.getDisplayId());let f=this._objectIdToDisplayId.get(g);f||(f=a.createDisplayId(),this._objectIdToDisplayId.set(g,f),this._spatialIndexInvalid=!0);c.setDisplayId(f);a.setInstanceId(f,n);this.setComputedAttributes(a,c,f,b)};k._searchIndex=function(c){this._rebuildIndex();return this._index.search({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]})};k._rebuildIndex=function(){if(this._spatialIndexInvalid){var c=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(b=>
{for(b=b.getCursor();b.next();){const a=b.getDisplayId();this._storage.setBounds(a,b)&&c.push(a)}}):this._objectIdToDisplayId.forEach(b=>{const a=this._storage.getInstanceId(b);this._storage.setBounds(b,this._lookupFeature(a))&&c.push(b)});this._index.clear();this._index.load(c);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};k._lookupFeature=function(c){var b=this._getFeatureSet((4294901760&c)>>>16);if(!b)return null;b=b.getCursor();b.setIndex(65535&c);return b};k._getFeatureSet=function(c){return this._featureSetsByInstance.get(c)};
t._createClass(r,[{key:"storeStatistics",get:function(){let c=0,b=0,a=0;this.forEach(g=>{if(g=g.readGeometry())b+=g.isPoint?1:g.lengths.reduce((n,f)=>n+f,0),a+=g.isPoint?1:g.lengths.length,c+=1});return{featureCount:c,vertexCount:b,ringCount:a}}}]);return r}(h.Store2D);v.FeatureStore2D=u;v.featureAdapter=l;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(v,
t){return function(){function E(u){this._start=this.size=0;this.maxSize=u;this._buffer=Array(u)}var B=E.prototype;B.enqueue=function(u){if(this.size===this.maxSize){const A=this._buffer[this._start];this._buffer[this._start]=u;this._start=(this._start+1)%this.maxSize;return A}this._buffer[(this._start+this.size++)%this.maxSize]=u;return null};B.dequeue=function(){if(0===this.size)return null;const u=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;
return u};B.peek=function(){return 0===this.size?null:this._buffer[this._start]};B.find=function(u){if(0===this.size)return null;for(const A of this._buffer)if(t.isSome(A)&&u(A))return A;return null};B.clear=function(u){let A=this.dequeue();for(;t.isSome(A);)u&&u(A),A=this.dequeue()};v._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],
function(v,t,E,B,u){let A=function(){function x(){this._emitter=new x.EventEmitter(this)}var e=x.prototype;e.emit=function(h,d){return this._emitter.emit(h,d)};e.on=function(h,d){return this._emitter.on(h,d)};e.once=function(h,d){return this._emitter.once(h,d)};e.hasEventListener=function(h){return this._emitter.hasEventListener(h)};return x}();(function(x){let e=function(){function d(m=null){this._target=m;this._listenersMap=null}var l=d.prototype;l.clear=function(){this._listenersMap&&this._listenersMap.clear();
this._listenersMap=null};l.emit=function(m,r){m=this._listenersMap&&this._listenersMap.get(m);if(!m)return!1;const k=this._target||this;[...m].forEach(c=>{c.call(k,r)});return 0<m.length};l.on=function(m,r){if(Array.isArray(m)){var k=m.map(c=>this.on(c,r));return B.handlesGroup(k)}if(m.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);k=this._listenersMap.get(m)||[];k.push(r);this._listenersMap.set(m,
k);return{remove:()=>{const c=this._listenersMap&&this._listenersMap.get(m)||[],b=c.indexOf(r);0<=b&&c.splice(b,1)}}};l.once=function(m,r){const k=this.on(m,c=>{k.remove();r.call(null,c)});return k};l.hasEventListener=function(m){m=this._listenersMap&&this._listenersMap.get(m);return null!=m&&0<m.length};return d}();x.EventEmitter=e;x.EventedMixin=d=>{d=function(l){function m(){var k=l.apply(this,arguments)||this;k._emitter=new e;return k}v._inheritsLoose(m,l);var r=m.prototype;r.destroy=function(){this._emitter.clear()};
r.emit=function(k,c){return this._emitter.emit(k,c)};r.on=function(k,c){return this._emitter.on(k,c)};r.once=function(k,c){return this._emitter.once(k,c)};r.hasEventListener=function(k){return this._emitter.hasEventListener(k)};return m}(d);return d=t.__decorate([u.subclass("esri.core.Evented")],d)};let h=function(d){function l(){var r=d.apply(this,arguments)||this;r._emitter=new A.EventEmitter(v._assertThisInitialized(r));return r}v._inheritsLoose(l,d);var m=l.prototype;m.destroy=function(){this._emitter.clear()};
m.emit=function(r,k){return this._emitter.emit(r,k)};m.on=function(r,k){return this._emitter.on(r,k)};m.once=function(r,k){return this._emitter.once(r,k)};m.hasEventListener=function(r){return this._emitter.hasEventListener(r)};return l}(E);h=t.__decorate([u.subclass("esri.core.Evented")],h);x.EventedAccessor=h})(A||(A={}));return A})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(v,t){function E(c,b){if(!(this instanceof E))return new E(c,b);this._maxEntries=Math.max(4,
c||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));b&&("function"===typeof b?this.toBBox=b:this._initFormat(b));this.clear()}function B(c,b){u(c,0,c.children.length,b,c)}function u(c,b,a,g,n){n||(n=r(null));n.minX=Infinity;n.minY=Infinity;n.maxX=-Infinity;n.maxY=-Infinity;for(var f;b<a;b++)f=c.children[b],A(n,c.leaf?g(f):f);return n}function A(c,b){c.minX=Math.min(c.minX,b.minX);c.minY=Math.min(c.minY,b.minY);c.maxX=Math.max(c.maxX,b.maxX);c.maxY=Math.max(c.maxY,b.maxY);return c}function x(c,
b){return c.minX-b.minX}function e(c,b){return c.minY-b.minY}function h(c){return(c.maxX-c.minX)*(c.maxY-c.minY)}function d(c){return c.maxX-c.minX+(c.maxY-c.minY)}function l(c,b){return c.minX<=b.minX&&c.minY<=b.minY&&b.maxX<=c.maxX&&b.maxY<=c.maxY}function m(c,b){return b.minX<=c.maxX&&b.minY<=c.maxY&&b.maxX>=c.minX&&b.maxY>=c.minY}function r(c){return{children:c,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function k(c,b,a,g,n){for(var f=[b,a],q;f.length;)a=f.pop(),
b=f.pop(),a-b<=g||(q=b+Math.ceil((a-b)/g/2)*g,t.quickselect(c,q,b,a,n),f.push(b,q,q,a))}E.prototype={all:function(){return this._all(this.data,[])},search:function(c){var b=this.data,a=[],g=this.toBBox;if(!m(c,b))return a;for(var n=[],f,q,p,z;b;){f=0;for(q=b.children.length;f<q;f++)p=b.children[f],z=b.leaf?g(p):p,m(c,z)&&(b.leaf?a.push(p):l(c,z)?this._all(p,a):n.push(p));b=n.pop()}return a},collides:function(c){var b=this.data,a=this.toBBox;if(!m(c,b))return!1;for(var g=[],n,f,q,p;b;){n=0;for(f=b.children.length;n<
f;n++)if(q=b.children[n],p=b.leaf?a(q):q,m(c,p)){if(b.leaf||l(c,p))return!0;g.push(q)}b=g.pop()}return!1},load:function(c){if(!c||!c.length)return this;if(c.length<this._minEntries){for(var b=0,a=c.length;b<a;b++)this.insert(c[b]);return this}c=this._build(c.slice(),0,c.length-1,0);this.data.children.length?this.data.height===c.height?this._splitRoot(this.data,c):(this.data.height<c.height&&(b=this.data,this.data=c,c=b),this._insert(c,this.data.height-c.height-1,!0)):this.data=c;return this},insert:function(c){c&&
this._insert(c,this.data.height-1);return this},clear:function(){this.data=r([]);return this},remove:function(c,b){if(!c)return this;for(var a=this.data,g=this.toBBox(c),n=[],f=[],q,p,z,w;a||n.length;){a||(a=n.pop(),p=n[n.length-1],q=f.pop(),w=!0);if(a.leaf){a:{z=c;var y=a.children,G=b;if(G){for(var H=0;H<y.length;H++)if(G(z,y[H])){z=H;break a}z=-1}else z=y.indexOf(z)}if(-1!==z){a.children.splice(z,1);n.push(a);this._condense(n);break}}w||a.leaf||!l(a,g)?p?(q++,a=p.children[q],w=!1):a=null:(n.push(a),
f.push(q),q=0,p=a,a=a.children[0])}return this},toBBox:function(c){return c},compareMinX:x,compareMinY:e,toJSON:function(){return this.data},fromJSON:function(c){this.data=c;return this},_all:function(c,b){for(var a=[];c;)c.leaf?b.push.apply(b,c.children):a.push.apply(a,c.children),c=a.pop();return b},_build:function(c,b,a,g){var n=a-b+1,f=this._maxEntries;if(n<=f){var q=r(c.slice(b,a+1));B(q,this.toBBox);return q}g||(g=Math.ceil(Math.log(n)/Math.log(f)),f=Math.ceil(n/Math.pow(f,g-1)));q=r([]);q.leaf=
!1;q.height=g;n=Math.ceil(n/f);f=n*Math.ceil(Math.sqrt(f));var p;for(k(c,b,a,f,this.compareMinX);b<=a;b+=f){var z=Math.min(b+f-1,a);k(c,b,z,n,this.compareMinY);for(p=b;p<=z;p+=n){var w=Math.min(p+n-1,z);q.children.push(this._build(c,p,w,g-1))}}B(q,this.toBBox);return q},_chooseSubtree:function(c,b,a,g){for(var n,f,q,p,z,w,y,G;;){g.push(b);if(b.leaf||g.length-1===a)break;y=G=Infinity;n=0;for(f=b.children.length;n<f;n++)q=b.children[n],z=h(q),w=(Math.max(q.maxX,c.maxX)-Math.min(q.minX,c.minX))*(Math.max(q.maxY,
c.maxY)-Math.min(q.minY,c.minY))-z,w<G?(G=w,y=z<y?z:y,p=q):w===G&&z<y&&(y=z,p=q);b=p||b.children[0]}return b},_insert:function(c,b,a){var g=this.toBBox;a=a?c:g(c);g=[];var n=this._chooseSubtree(a,this.data,b,g);n.children.push(c);for(A(n,a);0<=b;)if(g[b].children.length>this._maxEntries)this._split(g,b),b--;else break;this._adjustParentBBoxes(a,g,b)},_split:function(c,b){var a=c[b],g=a.children.length,n=this._minEntries;this._chooseSplitAxis(a,n,g);g=this._chooseSplitIndex(a,n,g);g=r(a.children.splice(g,
a.children.length-g));g.height=a.height;g.leaf=a.leaf;B(a,this.toBBox);B(g,this.toBBox);b?c[b-1].children.push(g):this._splitRoot(a,g)},_splitRoot:function(c,b){this.data=r([c,b]);this.data.height=c.height+1;this.data.leaf=!1;B(this.data,this.toBBox)},_chooseSplitIndex:function(c,b,a){var g,n;var f=n=Infinity;for(g=b;g<=a-b;g++){var q=u(c,0,g,this.toBBox);var p=u(c,g,a,this.toBBox);var z=Math.max(0,Math.min(q.maxX,p.maxX)-Math.max(q.minX,p.minX))*Math.max(0,Math.min(q.maxY,p.maxY)-Math.max(q.minY,
p.minY));q=h(q)+h(p);if(z<f){f=z;var w=g;n=q<n?q:n}else z===f&&q<n&&(n=q,w=g)}return w},_chooseSplitAxis:function(c,b,a){var g=c.leaf?this.compareMinX:x,n=c.leaf?this.compareMinY:e,f=this._allDistMargin(c,b,a,g);b=this._allDistMargin(c,b,a,n);f<b&&c.children.sort(g)},_allDistMargin:function(c,b,a,g){c.children.sort(g);g=this.toBBox;var n=u(c,0,b,g),f=u(c,a-b,a,g),q=d(n)+d(f),p;for(p=b;p<a-b;p++){var z=c.children[p];A(n,c.leaf?g(z):z);q+=d(n)}for(p=a-b-1;p>=b;p--)z=c.children[p],A(f,c.leaf?g(z):z),
q+=d(f);return q},_adjustParentBBoxes:function(c,b,a){for(;0<=a;a--)A(b[a],c)},_condense:function(c){for(var b=c.length-1,a;0<=b;b--)0===c[b].children.length?0<b?(a=c[b-1].children,a.splice(a.indexOf(c[b]),1)):this.clear():B(c[b],this.toBBox)},_initFormat:function(c){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(c[0]));this.compareMinY=new Function("a","b",b.join(c[1]));this.toBBox=new Function("a","return {minX: a"+c[0]+", minY: a"+c[1]+", maxX: a"+c[2]+", maxY: a"+c[3]+
"};")}};v.rbush=E})},"esri/chunks/quickselect":function(){define(["exports"],function(v){var t={exports:{}};(function(E){(function(B){B=B();void 0!==B&&(E.exports=B)})(function(){function B(x,e,h,d,l){for(;d>h;){if(600<d-h){var m=d-h+1,r=e-h+1,k=Math.log(m),c=.5*Math.exp(2*k/3);k=.5*Math.sqrt(k*c*(m-c)/m)*(0>r-m/2?-1:1);B(x,e,Math.max(h,Math.floor(e-r*c/m+k)),Math.min(d,Math.floor(e+(m-r)*c/m+k)),l)}m=x[e];r=h;c=d;u(x,h,e);for(0<l(x[d],m)&&u(x,h,d);r<c;){u(x,r,c);r++;for(c--;0>l(x[r],m);)r++;for(;0<
l(x[c],m);)c--}0===l(x[h],m)?u(x,h,c):(c++,u(x,c,d));c<=e&&(h=c+1);e<=c&&(d=c-1)}}function u(x,e,h){var d=x[e];x[e]=x[h];x[h]=d}function A(x,e){return x<e?-1:x>e?1:0}return function(x,e,h,d,l){B(x,e,h||0,d||x.length-1,l||A)}})})(t);v.quickselect=t.exports})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),
function(v,t,E,B,u,A,x,e){const h=new Promise((l,m)=>v(["../../../../layers/support/labelFormatUtils"],l,m));let d=function(){function l(r,k){this._canCacheExpressionValue=!1;this._sourceInfo=r;this._storage=k;this._bitsets={computed:k.getBitset(k.createBitset())}}var m=l.prototype;m.invalidate=function(){this._bitsets.computed.clear()};m.updateSchema=function(){var r=E._asyncToGenerator(function*(k,c){var b=A.diff(this._schema,c);if((this._schema=c)&&!u.isNone(b)&&A.hasDiff(b,"attributes")){B("esri-2d-update-debug")&&
console.debug("Applying Update - Store:",b);this._bitsets.computed.clear();k.targets[c.name]=!0;k=c.attributes;c=[];b=[];for(const a in k){const g=k[a];switch(g.type){case "expression":c.push(this._createArcadeComputedField(g));break;case "label-expression":c.push(this._createLabelArcadeComputedField(g));break;case "statistic":b.push(g)}}this._computedFields=yield Promise.all(c);this._canCacheExpressionValue=!this._computedFields.some(a=>"expression"===a.type&&u.isSome(a.expression)&&a.expression.referencesScale());
this._statisticFields=b}});return function(k,c){return r.apply(this,arguments)}}();m.setComputedAttributes=function(r,k,c,b){var a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(c)){a.set(c);for(const g of this._computedFields)switch(a=this._evaluateField(k,g,b),g.resultType){case "numeric":r.setComputedNumericAtIndex(c,g.fieldIndex,a);break;case "string":r.setComputedStringAtIndex(c,g.fieldIndex,a)}}};m._createArcadeComputedField=function(){var r=E._asyncToGenerator(function*(k){return{...k,
expression:yield x.createRendererExpression(k.valueExpression,this._sourceInfo.spatialReference,this._sourceInfo.fieldsIndex)}});return function(k){return r.apply(this,arguments)}}();m._createLabelArcadeComputedField=function(){var r=E._asyncToGenerator(function*(k){var c=this._sourceInfo.spatialReference;const b=this._sourceInfo.fieldsIndex,{createLabelFunction:a}=yield h;c=yield a(k.label,b,c);return{...k,builder:c}});return function(k){return r.apply(this,arguments)}}();m._evaluateField=function(r,
k,c){switch(k.type){case "label-expression":return r=r.readArcadeFeature(),k.builder.evaluate(r)||"";case "expression":return{expression:k}=k,e(k,r,{$view:{scale:c}})}};E._createClass(l,[{key:"storage",get:function(){return this._storage}}]);return l}();t.Store2D=d;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(v,t,E,B,u){function A(k){return k instanceof
E?Object.keys(k.items):k instanceof t?u.getProperties(k).keys():k?Object.keys(k):[]}function x(k,c){return k instanceof E?k.items[c]:k[c]}function e(k,c){return Array.isArray(k)&&Array.isArray(c)?k.length!==c.length:!1}function h(k){return k?k.declaredClass:null}function d(k,c){const b=k.diff;if(b&&"function"===typeof b)return b(k,c);const a=A(k),g=A(c);if(0!==a.length||0!==g.length){if(!a.length||!g.length||e(k,c))return{type:"complete",oldValue:k,newValue:c};var n=g.filter(p=>!a.includes(p)),f=
a.filter(p=>!g.includes(p));f=a.filter(p=>g.includes(p)&&x(k,p)!==x(c,p)).concat(n,f).sort();if((n=h(k))&&r.includes(n)&&f.length)return{type:"complete",oldValue:k,newValue:c};var q;n=k instanceof t&&c instanceof t;for(const p of f){f=x(k,p);const z=x(c,p);if((n||"function"!==typeof f&&"function"!==typeof z)&&f!==z&&(null!=f||null!=z)){if(b&&b[p]&&"function"===typeof b[p])f=b[p](f,z);else if(f instanceof Date&&z instanceof Date){if(f.getTime()===z.getTime())continue;f={type:"complete",oldValue:f,
newValue:z}}else f="object"===typeof f&&"object"===typeof z&&h(f)===h(z)?d(f,z):{type:"complete",oldValue:f,newValue:z};B.isSome(f)&&(B.isSome(q)?q.diff[p]=f:q={type:"partial",diff:{[p]:f}})}}return q}}function l(k,c){if(B.isNone(k))return!1;c=c.split(".");for(const b of c){if("complete"===k.type)break;if("partial"===k.type){if(k=k.diff[b],!k)return!1}else return!1}return!0}function m(k){if(B.isNone(k))return!0;switch(k.type){case "complete":return!1;case "collection":for(const c of k.added)if(!m(c))return!1;
for(const c of k.removed)if(!m(c))return!1;for(const c of k.changed)if(!m(c))return!1;return!0;case "partial":for(const c in k.diff)if(!m(k.diff[c]))return!1;return!0}}const r=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];v.diff=function(k,c){if(!("function"===typeof k||"function"===typeof c||B.isNone(k)&&B.isNone(c)))return B.isNone(k)||B.isNone(c)||"object"===typeof k&&"object"===typeof c&&h(k)!==h(c)?{type:"complete",
oldValue:k,newValue:c}:d(k,c)};v.hasDiff=l;v.hasDiffAny=function(k,c){for(const b of c)if(l(k,b))return!0;return!1};v.isEmpty=m;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/decorators/property ./accessorSupport/ensureType ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking ./accessorSupport/tracking/SimpleObservable".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c){function b(D){return D?D instanceof I?D.toArray():D.length?Array.prototype.slice.apply(D):[]:[]}function a(D){if(D&&D.length)return D[0]}function g(D,C,F,K){C&&C.forEach((J,P,S)=>{D.push(J);g(D,F.call(K,J,P,S),F,K)})}var n;let f=function(){function D(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var C=D.prototype;C.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};C.reset=function(F){this.defaultPrevented=
!1;this.item=F};return D}();const q=new x(f,void 0,D=>{D.item=null;D.target=null;D.defaultPrevented=!1;D.cancellable=!1}),p=()=>{},z=new Set,w=new Set,y=new Set,G=new Map;let H=0,I=n=function(D,C){function F(J){J=D.call(this,J)||this;J._chgListeners=[];J._notifications=null;J._timer=null;J._observable=new c.SimpleObservable;J.length=0;J._items=[];Object.defineProperty(v._assertThisInitialized(J),"uid",{value:H++});return J}v._inheritsLoose(F,D);F.isCollection=function(J){return null!=J&&J instanceof
n};var K=F.prototype;K.normalizeCtorArgs=function(J){return J?Array.isArray(J)||J instanceof n?{items:J}:J:{}};K.destroy=function(){this.removeAll()};K[C]=function*(){yield*this.items};K.hasEventListener=function(J){return"change"===J?0<this._chgListeners.length:this._emitter.hasEventListener(J)};K.on=function(J,P){if("change"===J){const S=this._chgListeners,X={removed:!1,callback:P};S.push(X);this._notifications&&this._notifications.push({listeners:S.slice(),items:this._items.slice(),changes:[]});
return{remove(){this.remove=p;X.removed=!0;S.splice(S.indexOf(X),1)}}}return this._emitter.on(J,P)};K.once=function(J,P){const S=this.on(J,P);return{remove(){S.remove()}}};K.add=function(J,P){k.trackAccess(this._observable);if(this._emitBeforeChanges(e.ObservableChangesType.ADD))return this;P=this.getNextIndex(P??null);this._splice(P,0,[J]);this._emitAfterChanges(e.ObservableChangesType.ADD);return this};K.addMany=function(J,P=this._items.length){k.trackAccess(this._observable);if(!J||!J.length||
this._emitBeforeChanges(e.ObservableChangesType.ADD))return this;P=this.getNextIndex(P);this._splice(P,0,b(J));this._emitAfterChanges(e.ObservableChangesType.ADD);return this};K.at=function(J){k.trackAccess(this._observable);J=Math.trunc(J)||0;0>J&&(J+=this.length);if(!(0>J||J>=this.length))return this._items[J]};K.removeAll=function(){k.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(e.ObservableChangesType.REMOVE))return[];const J=this._splice(0,this.length)||[];this._emitAfterChanges(e.ObservableChangesType.REMOVE);
return J};K.clone=function(){k.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(u.clone)})};K.concat=function(...J){k.trackAccess(this._observable);J=J.map(b);return this._createNewInstance({items:this._items.concat(...J)})};K.drain=function(J,P){k.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(e.ObservableChangesType.REMOVE)){var S=A.assumeNonNull(this._splice(0,this.length)),X=S.length;for(let ha=0;ha<X;ha++)J.call(P,S[ha],ha,S);this._emitAfterChanges(e.ObservableChangesType.REMOVE)}};
K.every=function(J,P){k.trackAccess(this._observable);return this._items.every(J,P)};K.filter=function(J,P){k.trackAccess(this._observable);let S;S=2===arguments.length?this._items.filter(J,P):this._items.filter(J);return this._createNewInstance({items:S})};K.find=function(J,P){k.trackAccess(this._observable);return this._items.find(J,P)};K.findIndex=function(J,P){k.trackAccess(this._observable);return this._items.findIndex(J,P)};K.flatten=function(J,P){k.trackAccess(this._observable);const S=[];
g(S,this,J,P);return new n(S)};K.forEach=function(J,P){k.trackAccess(this._observable);return this._items.forEach(J,P)};K.getItemAt=function(J){k.trackAccess(this._observable);return this._items[J]};K.getNextIndex=function(J){k.trackAccess(this._observable);const P=this.length;J=null==J?P:J;0>J?J=0:J>P&&(J=P);return J};K.includes=function(J,P=0){k.trackAccess(this._observable);return this._items.includes(J,P)};K.indexOf=function(J,P=0){k.trackAccess(this._observable);return this._items.indexOf(J,
P)};K.join=function(J=","){k.trackAccess(this._observable);return this._items.join(J)};K.lastIndexOf=function(J,P=this.length-1){k.trackAccess(this._observable);return this._items.lastIndexOf(J,P)};K.map=function(J,P){k.trackAccess(this._observable);J=this._items.map(J,P);return new n({items:J})};K.reorder=function(J,P=this.length-1){k.trackAccess(this._observable);const S=this.indexOf(J);if(-1!==S){0>P?P=0:P>=this.length&&(P=this.length-1);if(S!==P){if(this._emitBeforeChanges(e.ObservableChangesType.MOVE))return J;
this._splice(S,1);this._splice(P,0,[J]);this._emitAfterChanges(e.ObservableChangesType.MOVE)}return J}};K.pop=function(){k.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(e.ObservableChangesType.REMOVE)){var J=a(this._splice(this.length-1,1));this._emitAfterChanges(e.ObservableChangesType.REMOVE);return J}};K.push=function(...J){k.trackAccess(this._observable);if(this._emitBeforeChanges(e.ObservableChangesType.ADD))return this.length;this._splice(this.length,0,J);this._emitAfterChanges(e.ObservableChangesType.ADD);
return this.length};K.reduce=function(J,P){k.trackAccess(this._observable);const S=this._items;return 2===arguments.length?S.reduce(J,P):S.reduce(J)};K.reduceRight=function(J,P){k.trackAccess(this._observable);const S=this._items;return 2===arguments.length?S.reduceRight(J,P):S.reduceRight(J)};K.remove=function(J){k.trackAccess(this._observable);return this.removeAt(this.indexOf(J))};K.removeAt=function(J){k.trackAccess(this._observable);if(!(0>J||J>=this.length||this._emitBeforeChanges(e.ObservableChangesType.REMOVE)))return J=
a(this._splice(J,1)),this._emitAfterChanges(e.ObservableChangesType.REMOVE),J};K.removeMany=function(J){k.trackAccess(this._observable);if(!J||!J.length||this._emitBeforeChanges(e.ObservableChangesType.REMOVE))return[];J=J instanceof n?J.toArray():J;const P=this._items,S=[],X=J.length;for(let O=0;O<X;O++){var ha=P.indexOf(J[O]);if(-1<ha){var U=O+1,Q=ha+1;const R=Math.min(J.length-U,P.length-Q);let V=0;for(;V<R&&J[U+V]===P[Q+V];)V++;U=1+V;(ha=this._splice(ha,U))&&0<ha.length&&S.push.apply(S,ha);O+=
U-1}}this._emitAfterChanges(e.ObservableChangesType.REMOVE);return S};K.reverse=function(){k.trackAccess(this._observable);if(this._emitBeforeChanges(e.ObservableChangesType.MOVE))return this;const J=this._splice(0,this.length);J&&(J.reverse(),this._splice(0,0,J));this._emitAfterChanges(e.ObservableChangesType.MOVE);return this};K.shift=function(){k.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(e.ObservableChangesType.REMOVE)){var J=a(this._splice(0,1));this._emitAfterChanges(e.ObservableChangesType.REMOVE);
return J}};K.slice=function(J=0,P=this.length){k.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(J,P)})};K.some=function(J,P){k.trackAccess(this._observable);return this._items.some(J,P)};K.sort=function(J){k.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(e.ObservableChangesType.MOVE))return this;const P=A.assumeNonNull(this._splice(0,this.length));arguments.length?P.sort(J):P.sort();this._splice(0,0,P);this._emitAfterChanges(e.ObservableChangesType.MOVE);
return this};K.splice=function(J,P,...S){k.trackAccess(this._observable);const X=(P?e.ObservableChangesType.REMOVE:0)|(S.length?e.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(X))return[];J=this._splice(J,P,S)||[];this._emitAfterChanges(X);return J};K.toArray=function(){k.trackAccess(this._observable);return this._items.slice()};K.toJSON=function(){k.trackAccess(this._observable);return this.toArray()};K.toLocaleString=function(){k.trackAccess(this._observable);return this._items.toLocaleString()};
K.toString=function(){k.trackAccess(this._observable);return this._items.toString()};K.unshift=function(...J){k.trackAccess(this._observable);if(!J.length||this._emitBeforeChanges(e.ObservableChangesType.ADD))return this.length;this._splice(0,0,J);this._emitAfterChanges(e.ObservableChangesType.ADD);return this.length};K._createNewInstance=function(J){return new this.constructor(J)};K._splice=function(J,P,S){const X=this._items;var ha=this.itemType;let U=void 0;!this._notifications&&this.hasEventListener("change")&&
(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=h.schedule(()=>this._dispatchChange()));if(P){U=X.splice(J,P);if(this.hasEventListener("before-remove")){var Q=q.acquire();Q.target=this;Q.cancellable=!0;for(let V=0,Z=U.length;V<Z;V++)P=U[V],Q.reset(P),this.emit("before-remove",Q),Q.defaultPrevented&&(U.splice(V,1),X.splice(J,0,P),J+=1,--V,--Z);q.release(Q)}this.length=this._items.length;if(this.hasEventListener("after-remove")){P=
q.acquire();P.target=this;P.cancellable=!1;Q=U.length;for(let V=0;V<Q;V++)P.reset(U[V]),this.emit("after-remove",P);q.release(P)}}if(S&&S.length){if(ha){P=[];for(var O of S)S=ha.ensureType(O),null==S&&null!=O||P.push(S);S=P}ha=this.hasEventListener("before-add");O=this.hasEventListener("after-add");P=J===this.length;if(ha||O){var R=q.acquire();R.target=this;R.cancellable=!0;Q=q.acquire();Q.target=this;Q.cancellable=!1;for(const V of S)ha?(R.reset(V),this.emit("before-add",R),R.defaultPrevented||(P?
X.push(V):X.splice(J++,0,V),this._set("length",X.length),O&&(Q.reset(V),this.emit("after-add",Q)))):(P?X.push(V):X.splice(J++,0,V),this._set("length",X.length),Q.reset(V),this.emit("after-add",Q));q.release(Q);q.release(R)}else{if(P)for(R of S)X.push(R);else X.splice(J,0,...S);this._set("length",X.length)}}(S&&S.length||U&&U.length)&&this._notifyChangeEvent(S,U);return U};K._emitBeforeChanges=function(J){let P=!1;if(this.hasEventListener("before-changes")){const S=q.acquire();S.target=this;S.cancellable=
!0;S.type=J;this.emit("before-changes",S);P=S.defaultPrevented;q.release(S)}return P};K._emitAfterChanges=function(J){if(this.hasEventListener("after-changes")){const P=q.acquire();P.target=this;P.cancellable=!1;P.type=J;this.emit("after-changes",P);q.release(P)}this._observable.notify()};K._notifyChangeEvent=function(J,P){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:J,removed:P})};K._dispatchChange=function(){this._timer&&
(this._timer.remove(),this._timer=null);if(this._notifications){var J=this._notifications;this._notifications=null;for(const P of J){J=P.changes;z.clear();w.clear();y.clear();for(const {added:O,removed:R}of J){if(O)if(0===y.size&&0===w.size)for(const V of O)z.add(V);else for(const V of O)w.has(V)?(y.add(V),w.delete(V)):y.has(V)||z.add(V);if(R)if(0===y.size&&0===z.size)for(const V of R)w.add(V);else for(const V of R)z.has(V)?z.delete(V):(y.delete(V),w.add(V))}const S=E.acquire();z.forEach(O=>{S.push(O)});
const X=E.acquire();w.forEach(O=>{X.push(O)});const ha=this._items,U=P.items,Q=E.acquire();y.forEach(O=>{U.indexOf(O)!==ha.indexOf(O)&&Q.push(O)});if(P.listeners&&(S.length||X.length||Q.length)){J={target:this,added:S,removed:X,moved:Q};const O=P.listeners.length;for(let R=0;R<O;R++){const V=P.listeners[R];V.removed||V.callback.call(this,J)}}E.release(S);E.release(X);E.release(Q)}z.clear();w.clear();y.clear()}};v._createClass(F,[{key:"items",get:function(){k.trackAccess(this._observable);return this._items},
set:function(J){this._emitBeforeChanges(e.ObservableChangesType.ADD)||(this._splice(0,this.length,b(J)),this._emitAfterChanges(e.ObservableChangesType.ADD))}}]);return F}(B.EventedAccessor,Symbol.iterator);I.ofType=D=>{if(!D)return n;if(G.has(D))return G.get(D);let C=null;if("function"===typeof D)C=D.prototype.declaredClass;else if(D.base)C=D.base.prototype.declaredClass;else for(var F in D.typeMap){const K=D.typeMap[F].prototype.declaredClass;C=C?C+` | ${K}`:K}F=function(K){function J(){return K.apply(this,
arguments)||this}v._inheritsLoose(J,K);return J}(n);t.__decorate([m.shared({Type:D,ensureType:"function"===typeof D?l.ensureType(D):l.ensureOneOfType(D)})],F.prototype,"itemType",void 0);F=t.__decorate([r.subclass(`esri.core.Collection<${C}>`)],F);G.set(D,F);return F};t.__decorate([d.property()],I.prototype,"length",void 0);t.__decorate([d.property()],I.prototype,"items",null);return I=n=t.__decorate([r.subclass("esri.core.Collection")],I)})},"esri/core/ObservableChangesType":function(){define(["exports"],
function(v){v.ObservableChangesType=void 0;var t=v.ObservableChangesType||(v.ObservableChangesType={});t[t.ADD=1]="ADD";t[t.REMOVE=2]="REMOVE";t[t.MOVE=4]="MOVE";Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],function(v){v.shared=function(t){return(E,B)=>{E[B]=t}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger",
"../../../core/maybe"],function(v,t){return function(E,B,u){if(t.isNone(E))return null;B=B.readArcadeFeature();try{return E.evaluate({...u,$feature:B})}catch(A){return v.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",A),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(v,t,E){let B=function(u){function A(e,h){var d=u.call(this,
E.FeatureSetReader.createInstance(),e.fullSchema())||this;d._currentIndex=-1;d._reader=e;d._indices=h;return d}t._inheritsLoose(A,u);A.from=function(e,h){return new A(e.copy(),h)};var x=A.prototype;x.getSize=function(){return this._indices.length};x.getCursor=function(){return this.copy()};x.copy=function(){const e=new A(this._reader.copy(),this._indices);e._currentIndex=this._currentIndex;return e};x.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};
x._nextIndex=function(){return++this._currentIndex<this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),!0):!1};x.setArcadeSpatialReference=function(e){this._reader.setArcadeSpatialReference(e)};x.attachStorage=function(e){this._reader.attachStorage(e)};x.getStorage=function(){return this._reader.getStorage()};x.getComputedNumeric=function(e){return this._reader.getComputedNumericAtIndex(0)};x.setComputedNumeric=function(e,h){return this._reader.setComputedNumericAtIndex(h,
0)};x.getComputedString=function(e){return this._reader.getComputedStringAtIndex(0)};x.setComputedString=function(e,h){return this._reader.setComputedStringAtIndex(0,h)};x.getComputedNumericAtIndex=function(e){return this._reader.getComputedNumericAtIndex(e)};x.setComputedNumericAtIndex=function(e,h){this._reader.setComputedNumericAtIndex(e,h)};x.getComputedStringAtIndex=function(e){return this._reader.getComputedStringAtIndex(e)};x.setComputedStringAtIndex=function(e,h){return this._reader.setComputedStringAtIndex(e,
h)};x.transform=function(e,h,d,l){const m=this.copy();m._reader=this._reader.transform(e,h,d,l);return m};x.readAttribute=function(e,h=!1){return this._reader.readAttribute(e,h)};x.readAttributes=function(){return this._reader.readAttributes()};x.joinAttributes=function(e){return this._reader.joinAttributes(e)};x.readArcadeFeature=function(){return this._reader.readArcadeFeature()};x.geometry=function(){return this._reader.geometry()};x.field=function(e){return this.readAttribute(e,!0)};x.hasField=
function(e){return this._reader.hasField(e)};x.setField=function(e,h){return this._reader.setField(e,h)};x.keys=function(){return this._reader.keys()};x.castToText=function(e=!1){return this._reader.castToText(e)};x.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};x.getFieldNames=function(){return this._reader.getFieldNames()};x.getAttributeHash=function(){return this._reader.getAttributeHash()};x.getObjectId=function(){return this._reader.getObjectId()};x.getDisplayId=
function(){return this._reader.getDisplayId()};x.setDisplayId=function(e){return this._reader.setDisplayId(e)};x.getGroupId=function(){return this._reader.getGroupId()};x.setGroupId=function(e){return this._reader.setGroupId(e)};x.getXHydrated=function(){return this._reader.getXHydrated()};x.getYHydrated=function(){return this._reader.getYHydrated()};x.getX=function(){return this._reader.getX()};x.getY=function(){return this._reader.getY()};x.setIndex=function(e){return this._reader.setIndex(e)};
x.getIndex=function(){return this._reader.getIndex()};x.readLegacyFeature=function(){return this._reader.readLegacyFeature()};x.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};x.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};x.readLegacyGeometry=function(){return this._reader.readLegacyGeometry()};x.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};x.readGeometryArea=function(){return this._reader.readGeometryArea()};
x.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};x.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};x.readGeometry=function(){return this._reader.readGeometry()};x.readCentroid=function(){return this._reader.readCentroid()};x._readAttribute=function(e,h){throw Error("Error: Should not be called. Underlying _reader should be used instead");};x._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");
};t._createClass(A,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",get:function(){return this._reader.hasM}}]);return A}(E.FeatureSetReader);v.FeatureSetReaderIndirect=B;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),function(v,t,E,B,
u,A,x,e,h,d){let l=0;E=B("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const m=E[0],r=E[1],k=E[2],c=E[3];E=B("featurelayer-simplify-payload-size-factors")??[1,2,4];const b=E[0],a=E[1],g=E[2],n=B("featurelayer-simplify-mobile-factor")??2,f=B("esri-mobile");B=function(){function q(z,w){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=null;this._level=
0;this.instance=z;this._layerSchema=w}q.createInstance=function(){l++;return l=65535<l?0:l};var p=q.prototype;p.getAreaSimplificationThreshold=function(z,w){let y=1;const G=f?n:1;4E6<w?y=g*G:1E6<w?y=a*G:5E5<w?y=b*G:1E5<w&&(y=G);w=0;4E3<z?w=c*y:2E3<z?w=k*y:100<z?w=r:15<z&&(w=m);z=8;4>this._level?z=1:5>this._level?z=2:6>this._level&&(z=4);return w*z};p.createQuantizedExtrudedQuad=function(z,w){return new e([5],[z-1,w,1,-1,1,1,-1,1,-1,-1])};p.setArcadeSpatialReference=function(z){this._arcadeSpatialReference=
z};p.attachStorage=function(z){this._storage=z};p.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};p.getStorage=function(){return this._storage};p.getComputedNumeric=function(z){return this.getComputedNumericAtIndex(0)};p.setComputedNumeric=function(z,w){return this.setComputedNumericAtIndex(w,0)};p.getComputedString=function(z){return this.getComputedStringAtIndex(0)};p.setComputedString=function(z,w){return this.setComputedStringAtIndex(0,w)};p.getComputedNumericAtIndex=
function(z){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),z)};p.setComputedNumericAtIndex=function(z,w){this._storage.setComputedNumericAtIndex(this.getDisplayId(),z,w)};p.getComputedStringAtIndex=function(z){return this._storage.getComputedStringAtIndex(this.getDisplayId(),z)};p.setComputedStringAtIndex=function(z,w){return this._storage.setComputedStringAtIndex(this.getDisplayId(),z,w)};p.transform=function(z,w,y,G){const H=this.copy();H._tx+=z;H._ty+=w;H._sx*=y;H._sy*=G;return H};
p.readAttribute=function(z,w=!1){var y=this._readAttribute(z,w);if(void 0!==y)return y;for(const G of this._joined)if(G.setIndex(this.getIndex()),y=G._readAttribute(z,w),void 0!==y)return y};p.readAttributes=function(){const z=this._readAttributes();for(const w of this._joined){w.setIndex(this.getIndex());const y=w._readAttributes();for(const G of Object.keys(y))z[G]=y[G]}return z};p.joinAttributes=function(z){this._joined.push(z)};p.readArcadeFeature=function(){return this};p.geometry=function(){var z=
this.readHydratedGeometry();z=x.convertToGeometry(z,this.geometryType,this.hasZ,this.hasM);if(z=d.fromJSON(z))z.spatialReference=this._arcadeSpatialReference;return z};p.field=function(z){if(this.hasField(z))return this.readAttribute(z,!0);for(const w of this._joined)if(w.setIndex(this.getIndex()),w.hasField(z))return w._readAttribute(z,!0);throw Error(`Field ${z} does not exist`);};p.setField=function(z,w){throw Error("Unable to update feature attribute values, feature is readonly");};p.keys=function(){return this.getFieldNames()};
p.castToText=function(z=!1){if(!z)return JSON.stringify(this.readLegacyFeature());z=this.readLegacyFeature();if(!z)return JSON.stringify(null);z={geometry:z.geometry,attributes:{...(z.attributes?z.attributes:{})}};for(const w in z.attributes){const y=z.attributes[w];y instanceof Date&&(z.attributes[w]=y.getTime())}return JSON.stringify(z)};p.gdbVersion=function(){return null};p.fullSchema=function(){return this._layerSchema};p.castAsJson=function(z=null){return{attributes:this._readAttributes(),geometry:!0===
z?.keepGeometryType?this.geometry():this.geometry().toJSON()}};p.castAsJsonAsync=function(z,w=null){return Promise.resolve(this.castAsJson(w))};p.removeIds=function(z){if(u.isNone(this._objectIdToIndex)){var w=new Map;const y=this.getCursor();for(;y.next();){const G=u.unwrapOrThrow(y.getObjectId());w.set(G,y.getIndex())}this._objectIdToIndex=w}w=this._objectIdToIndex;for(const y of z)w.has(y)&&this.removeAtIndex(w.get(y))};p.removeAtIndex=function(z){u.isNone(this._deleted)&&(this._deleted=h.StaticBitSet.create(this.getSize()));
this._deleted.set(z)};p.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};p.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};p.features=function*(){const z=this.getCursor();for(;z.next();)yield z.readOptimizedFeature()};p._getExists=function(){return u.isNone(this._deleted)||!this._deleted.has(this.getIndex())};p._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const z=this.readUnquantizedGeometry();if(!z||z.hasIndeterminateRingOrder)return null;
const w=u.unwrapOr(this.getQuantizationTransform(),null);return A.getCentroidOptimizedGeometry(new e,z,this.hasM,this.hasZ,w)};p.copyInto=function(z){z.seen=this.seen;z._storage=this._storage;z._arcadeSpatialReference=this._arcadeSpatialReference;z._joined=this._joined;z._tx=this._tx;z._ty=this._ty;z._sx=this._sx;z._sy=this._sy;z._deleted=this._deleted;z._objectIdToIndex=this._objectIdToIndex};t._createClass(q,[{key:"isEmpty",get:function(){return u.isSome(this._deleted)&&this._deleted.countSet()===
this.getSize()}},{key:"level",set:function(z){this._level=z}}]);return q}();v.FeatureSetReader=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(v,t){function E(u,A,x,e,h,d,l=1){d=h?d?4:3:d?3:2;let m=x,r=x+d,k=0,c=0,b=x=0,a=0;for(let g=0,n=e-1;g<n;g++,m+=d,r+=d){e=A[m];const f=A[m+1],q=A[m+2],p=A[r],z=A[r+1],w=A[r+2];let y=e*z-p*f;b+=y;k+=(e+p)*y;c+=(f+z)*y;h&&(y=e*
w-p*q,x+=(q+w)*y,a+=y);e<u[0]&&(u[0]=e);e>u[1]&&(u[1]=e);f<u[2]&&(u[2]=f);f>u[3]&&(u[3]=f);h&&(q<u[4]&&(u[4]=q),q>u[5]&&(u[5]=q))}0<b*l&&(b*=-1);0<a*l&&(a*=-1);if(!b)return null;u=[k,c,.5*b];h&&(u[3]=x,u[4]=.5*a);return u}function B(u,A,x,e,h){h=e?h?4:3:h?3:2;let d=A,l=A+h,m=0,r=0,k=0,c=0;for(let n=0,f=x-1;n<f;n++,d+=h,l+=h){var b=u[d];const q=u[d+1],p=u[d+2],z=u[l],w=u[l+1],y=u[l+2];if(e){var a=z-b;var g=w-q;const G=y-p;a=Math.sqrt(a*a+g*g+G*G)}else a=z-b,g=w-q,a=Math.sqrt(a*a+g*g);a&&(m+=a,e?(b=
[b+.5*(z-b),q+.5*(w-q),p+.5*(y-p)],r+=a*b[0],k+=a*b[1],c+=a*b[2]):(b=[b+.5*(z-b),q+.5*(w-q)],r+=a*b[0],k+=a*b[1]))}return 0<m?e?[r/m,k/m,c/m]:[r/m,k/m]:0<x?e?[u[A],u[A+1],u[A+2]]:[u[A],u[A+1]]:null}v.getCentroidOptimizedGeometry=function(u,A,x,e,h){if(t.isNone(A)||!A.lengths.length)return null;const d="upperLeft"===h?.originPosition?-1:1;u.lengths.length&&(u.lengths.length=0);u.coords.length&&(u.coords.length=0);h=u.coords;const l=[],m=x?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:r,coords:k}=A,c=x?e?4:3:e?3:2;let b=0;for(var a of r){const g=E(m,k,b,a,x,e,d);g&&l.push(g);b+=a*c}l.sort((g,n)=>{let f=d*g[2]-d*n[2];0===f&&x&&(f=g[4]-n[4]);return f});l.length&&(a=6*l[0][2],h[0]=l[0][0]/a,h[1]=l[0][1]/a,x&&(a=6*l[0][4],h[2]=0!==a?l[0][3]/a:0),h[0]<m[0]||h[0]>m[1]||h[1]<m[2]||h[1]>m[3]||x&&(h[2]<
m[4]||h[2]>m[5]))&&(h.length=0);if(!h.length)if(A=A.lengths[0]?B(k,0,r[0],x,e):null)h[0]=A[0],h[1]=A[1],x&&2<A.length&&(h[2]=A[2]);else return null;return u};v.lineCentroid=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(v){let t=function(){function E(u,A){this._mask=0;this._buf=u;this._mask=A}E.fromBuffer=function(u,A){return new E(u,A)};E.create=function(u,A=
4294967295){u=new Uint32Array(Math.ceil(u/32));return new E(u,A)};var B=E.prototype;B._getIndex=function(u){return Math.floor(u/32)};B.has=function(u){u&=this._mask;return!!(this._buf[this._getIndex(u)]&1<<u%32)};B.hasRange=function(u,A){for(;u%32&&u!==A;){if(this.has(u))return!0;u++}for(;A%32&&u!==A;){if(this.has(u))return!0;A--}if(u===A)return!1;for(u/=32;u!==A/32;u++)if(this._buf[u])return!0;return!1};B.set=function(u){u&=this._mask;const A=this._getIndex(u);this._buf[A]|=1<<u%32};B.setRange=function(u,
A){for(;u%32&&u!==A;)this.set(u++);for(;A%32&&u!==A;)this.set(A--);if(u!==A)for(u/=32;u!==A/32;u++)this._buf[u]=4294967295};B.unset=function(u){u&=this._mask;const A=this._getIndex(u);this._buf[A]&=4294967295^1<<u%32};B.resize=function(u){const A=this._buf;u=new Uint32Array(Math.ceil(u/32));u.set(A);this._buf=u};B.or=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]|=u._buf[A];return this};B.and=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]&=u._buf[A];return this};B.xor=function(u){for(let A=
0;A<this._buf.length;A++)this._buf[A]^=u._buf[A];return this};B.ior=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]|=~u._buf[A];return this};B.iand=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]&=~u._buf[A];return this};B.ixor=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]^=~u._buf[A];return this};B.any=function(){for(let u=0;u<this._buf.length;u++)if(this._buf[u])return!0;return!1};B.copy=function(u){for(let A=0;A<this._buf.length;A++)this._buf[A]=u._buf[A];
return this};B.clone=function(){return new E(this._buf.slice(),this._mask)};B.clear=function(){for(let u=0;u<this._buf.length;u++)this._buf[u]=0};B.forEachSet=function(u){for(let A=0;A<this._buf.length;A++){let x=this._buf[A],e=32*A;if(x)for(;x;)x&1&&u(e),x>>>=1,e++}};B.countSet=function(){let u=0;this.forEachSet(A=>{u++});return u};return E}();v.StaticBitSet=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./GeoEventSource ./PagedFeatureSource ./SnapshotFeatureSource".split(" "),
function(v,t,E,B,u,A,x){v.createSource=function(e,h,d,l,m,r){a:{switch(e.type){case "snapshot":e={type:"feature",origin:"snapshot",featureCount:t.unwrapOr(e.featureCount,0),serviceInfo:e,onMessage:l,outSR:h,tileInfoView:d,canAcceptRequest:m,store:r};break a;case "stream":e={type:"geoevent",serviceInfo:e,onMessage:l,outSR:h,canAcceptRequest:m};break a;case "memory":case "on-demand":r=e.source;r=Array.isArray(r)?"local":"path"in r&&E.isHostedAgolService(r.path)?"hosted":"unknown";e={type:"feature",
serviceInfo:e,onMessage:l,outSR:h,origin:r,tileInfoView:d,canAcceptRequest:m};break a}e=void 0}switch(e.type){case "feature":switch(e.origin){case "hosted":case "local":return new A.PagedFeatureSource(e);case "snapshot":return new x.SnapshotFeatureSource(e);case "unknown":return new B.DrillDownFeatureSource(e)}case "geoevent":return new u.GeoEventSource(e)}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports",
"../../core/maybe","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(v,t,E,B){function u(r){if(t.isNone(r))return null;r=E.urlToObject(r);r=r.path.match(d)||r.path.match(l);if(!r)return null;const [,k,c,b,a]=r;r=c.indexOf("/");return{title:x(-1!==r?c.slice(r+1):c),serverType:e[b.toLowerCase()],sublayer:null!=a&&""!==a?parseInt(a,10):null,url:{path:k}}}function A(r){return(r=E.urlToObject(r).path.match(m))?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function x(r){r=r.replace(/\s*[/_]+\s*/g,
" ");return r[0].toUpperCase()+r.slice(1)}const e={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},h=Object.values(e),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${h.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),l=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${h.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),m=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;
v.cleanTitle=x;v.isAGOLUrl=function(r){if(!r)return!1;r=(new E.Url(E.makeAbsolute(r))).authority?.toLowerCase();return null!=r&&r.includes("arcgis.com")};v.isArcGISUrl=function(r){return!!d.test(r)};v.isHostedAgolService=function(r){if(!r)return!1;r=r.toLowerCase();const k=r.includes(".arcgis.com/");r=r.includes("//services")||r.includes("//tiles")||r.includes("//features");return k&&r};v.isHostedSecuredProxyService=function(r,k){return null!=k&&null!=r&&r.toLowerCase().includes(k.toLowerCase())};
v.isServerOrServicesAGOLUrl=function(r){if(!r)return!1;r=(new E.Url(E.makeAbsolute(r))).authority?.toLowerCase();return"server.arcgisonline.com"===r||"services.arcgisonline.com"===r};v.isWmsServer=function(r){if(!r)return!1;var k=r.toLowerCase();r=k.includes("/services/");const c=k.includes("/mapserver/wmsserver"),b=k.includes("/imageserver/wmsserver");k=k.includes("/wmsserver");return r&&(c||b||k)};v.parse=u;v.parseNonStandardSublayerUrl=A;v.sanitizeUrl=function(r,k){return r?E.removeTrailingSlash(E.removeQueryParameters(r,
k)):r};v.sanitizeUrlWithLayerId=function(r){let {url:k}=r;if(!k)return{url:k};k=E.removeQueryParameters(k,r.logger);const c=E.urlToObject(k),b=u(c.path);let a=void 0;t.isSome(b)?(null!=b.sublayer&&null==r.layer.layerId&&(a=b.sublayer),k=b.url.path):r.nonStandardUrlAllowed&&(r=A(c.path),t.isSome(r)&&(k=r.serviceUrl,a=r.sublayerId));return{url:E.removeTrailingSlash(k),layerId:a}};v.serverTypes=h;v.titleFromUrlAndName=function(r,k){const c=[];r&&(r=u(r),t.isSome(r)&&r.title&&c.push(r.title));k&&(k=x(k),
c.push(k));if(2===c.length){if(c[0].toLowerCase().includes(c[1].toLowerCase()))return c[0];if(c[1].toLowerCase().includes(c[0].toLowerCase()))return c[1]}return c.join(" - ")};v.writeUrlWithLayerId=function(r,k,c,b,a){B.write(k,b,"url",a);b.url&&null!=r.layerId&&(b.url=E.join(b.url,c,r.layerId.toString()))};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(v,
t,E){function B(c,b){var a=b&&b.url&&b.url.path;c&&a&&(c=E.makeAbsolute(c,a,{preserveProtocolRelative:!0}),b.portalItem&&b.readResourcePaths&&(a=E.makeRelative(c,b.portalItem.itemUrl),null!=a&&r.test(a)&&b.readResourcePaths.push(b.portalItem.resourceFromPath(a).path)));return l(c,b&&b.portal)}function u(c,b,a=v.MarkKeep.YES){if(null==c)return c;!E.isAbsolute(c)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(c);let g=E.makeAbsolute(c);if(b){var n=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||
b.url&&b.url.path;n&&(n=l(n,b.portal),g=E.makeRelative(l(g,b.portal),n,n),null!=g&&g!==c&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(g))}g=d(g,b?.portal);E.isAbsolute(g)&&(g=E.normalize(g));b?.resources&&b?.portalItem&&!E.isAbsolute(g)&&!E.isDataProtocol(g)&&a===v.MarkKeep.YES&&b.resources.toKeep.push({resource:b.portalItem.resourceFromPath(g),compress:!1});return g}function A(c,b,a){return B(c,a)}function x(c,b,a,g){c=u(c,g);void 0!==c&&(b[a]=c)}function e(c){return(c?.match(m)??
null)?.[1]??null}function h(c){c=c?.match(m)??null;if(null==c)return null;c=c[2];const b=c.lastIndexOf("/");if(-1===b){const {path:n,extension:f}=E.splitPathExtension(c);return{prefix:null,filename:n,extension:t.unwrap(f)}}const {path:a,extension:g}=E.splitPathExtension(c.slice(b+1));return{prefix:c.slice(0,b),filename:a,extension:t.unwrap(g)}}function d(c,b){return b&&!b.isPortal&&b.urlKey&&b.customBaseUrl?E.changeDomain(c,`${b.urlKey}.${b.customBaseUrl}`,b.portalHostname):c}function l(c,b){if(!b||
b.isPortal||!b.urlKey||!b.customBaseUrl)return c;const a=`${b.urlKey}.${b.customBaseUrl}`,g=E.getAppUrl();return E.hasSameOrigin(g,`${g.scheme}://${a}`)?E.changeDomain(c,b.portalHostname,a):E.changeDomain(c,a,b.portalHostname)}const m=/\/items\/([^\/]+)\/resources\/(.*)/,r=/^\.\/resources\//;v.MarkKeep=void 0;(function(c){c[c.YES=0]="YES";c[c.NO=1]="NO"})(v.MarkKeep||(v.MarkKeep={}));const k=Object.freeze(Object.defineProperty({__proto__:null,fromJSON:B,toJSON:u,read:A,write:x,itemIdFromResourceUrl:e,
prefixAndFilenameFromResourceUrl:h,ensureMainOnlineDomain:d,get MarkKeep(){return v.MarkKeep}},Symbol.toStringTag,{value:"Module"}));v.ensureMainOnlineDomain=d;v.fromJSON=B;v.itemIdFromResourceUrl=e;v.persistableUrlUtils=k;v.prefixAndFilenameFromResourceUrl=h;v.read=A;v.toJSON=u;v.write=x})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],
function(v,t,E,B,u){var A=(E=E("esri-mobile"))?1:4,x=E?1:3;u=function(e){function h(d){return e.call(this,d)||this}t._inheritsLoose(h,e);h.prototype._fetchDataTile=function(){var d=t._asyncToGenerator(function*(l){var m=this;const r=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,k=this._subscriptions.get(l.key.id),c=k.signal,b=l.getQuantizationParameters();let a=0;const g=function(){var n=t._asyncToGenerator(function*(f,q){const p=m._queryInfo,z=m.createTileQuery(f,{maxRecordCountFactor:r?
x:void 0,returnExceededLimitFeatures:!1,quantizationParameters:b});a++;try{const y=yield m._queue.push({tile:l,query:z,signal:c,depth:q});a--;B.throwIfAborted(c);if(y)if(p!==m._queryInfo)g(f,q);else if(y.exceededTransferLimit&&q<A)for(const G of f.createChildTiles())g(G,q+1);else{var w={id:l.id,addOrUpdate:y,end:0===a,type:"append"};k.add({query:z,message:w});m._onMessage(w)}}catch(y){B.isAbortError(y)||m._onMessage({id:l.id,addOrUpdate:null,end:!0,type:"append"})}});return function(f,q){return n.apply(this,
arguments)}}();g(l,0)});return function(l){return d.apply(this,arguments)}}();return h}(u.BaseFeatureSource);v.DrillDownFeatureSource=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l){d=function(m){function r(c){var b=m.call(this,c)||this;b.type="feature";b.mode="on-demand";b._adapter=h.createSourceAdapter(c.serviceInfo);b._queue=new l.QueueProcessor({concurrency:8,process:function(){var a=t._asyncToGenerator(function*(g){e.throwIfAborted(g);if(x.isSome(g.tile)){var n=g.tile.key.id,{signal:f}=g;n=u("esri-tiles-debug")?{tile:n.replace(/\//g,"."),depth:g.depth}:void 0;f=yield b._adapter.executeQuery(g.query,{signal:f,query:{...n,...b._schema.customParameters}});
f.level=g.tile.key.level;return f}return b._adapter.executeQuery(g.query,{...g,query:b._schema.customParameters})});return function(g){return a.apply(this,arguments)}}()});b._patchQueue=new l.QueueProcessor({concurrency:8,process:function(){var a=t._asyncToGenerator(function*(g){e.throwIfAborted(g);if(x.isSome(g.tile)){var n=g.tile.key.id,{signal:f}=g;n=u("esri-tiles-debug")?{tile:n.replace(/\//g,"."),depth:g.depth}:void 0;f=yield b._adapter.executeQuery(g.query,{signal:f,query:{...n,...b._schema.customParameters}});
f.level=g.tile.key.level;return f}return b._adapter.executeQuery(g.query,{...g,query:b._schema.customParameters})});return function(g){return a.apply(this,arguments)}}()});return b}t._inheritsLoose(r,m);var k=r.prototype;k.destroy=function(){m.prototype.destroy.call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};k.enableEvent=function(c,b){};k.subscribe=function(c,b){m.prototype.subscribe.call(this,c,b);const a=this._subscriptions.get(c.id);this._fetchDataTile(c).catch(g=>
{e.isAbortError(g)||A.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource").error(new B("mapview-query-error","Encountered error when fetching tile",{tile:c,error:g}))}).then(()=>a.end())};k.unsubscribe=function(c){m.prototype.unsubscribe.call(this,c)};k.readers=function(c){return this._subscriptions.get(c).readers()};k.query=function(){var c=t._asyncToGenerator(function*(b){return this._adapter.executeQuery(b,{query:this._schema.customParameters})});return function(b){return c.apply(this,
arguments)}}();k.queryLastEditDate=function(){var c=t._asyncToGenerator(function*(){const b=this._serviceInfo.source;return(yield E(b.path,{query:{...b.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate});return function(){return c.apply(this,arguments)}}();k.createTileQuery=function(c,b={}){const a=this._serviceInfo.geometryType,g=this.createQuery(b);g.quantizationParameters=b.quantizationParameters??c.getQuantizationParameters();g.resultType="tile";g.geometry=c.extent;if(this._serviceInfo.capabilities.query.supportsQuantization)"esriGeometryPolyline"===
a&&(g.maxAllowableOffset=c.resolution*u("feature-polyline-generalization-factor"));else if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)g.maxAllowableOffset=c.resolution,"esriGeometryPolyline"===a&&(g.maxAllowableOffset*=u("feature-polyline-generalization-factor"));c=this._serviceInfo.capabilities.query;g.defaultSpatialReferenceEnabled=c.supportsDefaultSpatialReference;g.compactGeometryEnabled=c.supportsCompactGeometry;return g};k._executePatchQuery=function(){var c=t._asyncToGenerator(function*(b,
a,g,n){a=a.clone();a.outFields=[this._serviceInfo.objectIdField,...g];a.returnCentroid=!1;a.returnGeometry=!1;g=x.isSome(a.start)?a.start/8E3:0;return this._patchQueue.push({tile:b,query:a,signal:n.signal,depth:g})});return function(b,a,g,n){return c.apply(this,arguments)}}();k._resend=function(){var c=t._asyncToGenerator(function*(b,a){const {query:g,message:n}=b,f=x.isSome(g.outFields)?g.outFields:[];b=this._queryInfo.outFields;const q=b.filter(p=>!f.includes(p));if(x.isNone(n.addOrUpdate))this._onMessage({...n,
type:"append"});else if(q.length)try{const p=this._subscriptions.get(n.id).tile,z=yield this._executePatchQuery(p,g,q,a);e.throwIfAborted(a);g.outFields=b;n.addOrUpdate.joinAttributes(z);this._onMessage({...n,end:n.end,type:"append"})}catch(p){}else this._onMessage({...n,type:"append"})});return function(b,a){return c.apply(this,arguments)}}();k._resendSubscription=function(){var c=t._asyncToGenerator(function*(b){u("esri-2d-update-debug")&&console.debug(b.tile.id,"Resend Subscription");if(b.empty)return this._onMessage({id:b.tile.id,
addOrUpdate:null,end:!1,type:"append"});const a=b.signal;for(const g of b.requests.done)yield this._resend(g,{signal:a});if(x.isSome(b.edits))return this._onMessage(b.edits)});return function(b){return c.apply(this,arguments)}}();k.resend=function(){var c=t._asyncToGenerator(function*(){const b=Array.from(this._subscriptions.values());yield Promise.all(b.map(a=>this._resendSubscription(a)))});return function(){return c.apply(this,arguments)}}();t._createClass(r,[{key:"updating",get:function(){return!!this._queue.length||
Array.from(this._subscriptions.values()).some(c=>!c.done)}},{key:"maxRecordCountFactor",get:function(){const {query:c}=this._serviceInfo.capabilities;return c.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var {query:c}=this._serviceInfo.capabilities;c=c.maxRecordCount??8E3;const b=x.unwrapOr(this.maxRecordCountFactor,1);return c*b}},{key:"pageSize",get:function(){return Math.min(8E3,this.maxPageSize)}}]);return r}(d.DataTileSource);v.BaseFeatureSource=d;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l){function m(n){return r.apply(this,arguments)}function r(){r=t._asyncToGenerator(function*(n){const f=new u;yield f.open(n,{});return f});return r.apply(this,arguments)}let k=function(){function n(f){this.service=f}n.prototype.destroy=function(){};return n}(),c=function(n){function f(p){var z=n.call(this,p)||this;z._portsOpen=m(p.source).then(w=>z.client=w);return z}t._inheritsLoose(f,n);var q=f.prototype;q.destroy=function(){this.client.close();this.client=null};q.executeQuery=
function(){var p=t._asyncToGenerator(function*(z,w){yield this._portsOpen;z=yield this.client.invoke("queryFeatures",z.toJSON(),w);return d.FeatureSetReaderJSON.fromFeatureSet(z,this.service)});return function(z,w){return p.apply(this,arguments)}}();return f}(k),b=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.prototype.executeQuery=function(){var q=t._asyncToGenerator(function*(p,z){({data:z}=yield h.executeQueryPBFBuffer(this.service.source,p,z));return l.FeatureSetReaderPBF.fromBuffer(z,
this.service,!p.quantizationParameters)});return function(p,z){return q.apply(this,arguments)}}();return f}(k),a=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.prototype.executeQuery=function(){var q=t._asyncToGenerator(function*(p,z){const {source:w,capabilities:y,spatialReference:G,objectIdField:H,geometryType:I}=this.service;if(B.isSome(p.quantizationParameters)&&!y.query.supportsQuantization){const D=p.clone();p=A.toQuantizationTransform(B.unwrap(D.quantizationParameters));
D.quantizationParameters=null;({data:z}=yield h.executeQuery(w,D,G,z));z=x.convertFromFeatureSet(z,H);x.quantizeOptimizedFeatureSet(p,z);return d.FeatureSetReaderJSON.fromOptimizedFeatureSet(z,this.service)}({data:p}=yield h.executeQuery(w,p,this.service.spatialReference,z));"esriGeometryPoint"===I&&(p.features=p.features?.filter(D=>B.isSome(D.geometry)?(D=D.geometry,Number.isFinite(D.x)&&Number.isFinite(D.y)):!0));return d.FeatureSetReaderJSON.fromFeatureSet(p,this.service)});return function(p,z){return q.apply(this,
arguments)}}();return f}(k),g=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.prototype.executeQuery=function(){var q=t._asyncToGenerator(function*(p,z){var {capabilities:w}=this.service;if(p.quantizationParameters&&!w.query.supportsQuantization){const y=p.clone();w=A.toQuantizationTransform(B.unwrap(y.quantizationParameters));y.quantizationParameters=null;p=yield e.queryOptimizedFeatureSet(this.service.source,p,z);x.quantizeOptimizedFeatureSet(w,p);return d.FeatureSetReaderJSON.fromOptimizedFeatureSet(p,
this.service)}p=yield e.queryOptimizedFeatureSet(this.service.source,p,z);return d.FeatureSetReaderJSON.fromOptimizedFeatureSet(p,this.service)});return function(p,z){return q.apply(this,arguments)}}();return f}(k);v.SourceAdapter=k;v.createSourceAdapter=function(n){const {capabilities:f}=n;return"ogc-source"===n.source?.type?new g(n):Array.isArray(n.source)?new c(n):f.query.supportsFormatPBF&&E("featurelayer-pbf")?new b(n):new a(n)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/core/workers/Connection":function(){define("../../chunks/_rollupPluginBabelHelpers ../handleUtils ../Logger ../promiseUtils ../Queue ./RemoteClient".split(" "),function(v,t,E,B,u,A){return function(){function x(){this._inUseClients=[];this._clients=[];this._clientPromises=[];this._ongoingJobsQueue=new u}var e=x.prototype;e.destroy=function(){this.close()};e.open=function(h,d){return new Promise((l,m)=>{let r=!0;const k=c=>{B.throwIfAborted(d.signal);r&&(r=!1,c())};this._clients.length=h.length;
this._clientPromises.length=h.length;this._inUseClients.length=h.length;for(let c=0;c<h.length;++c){const b=h[c];B.isPromiseLike(b)?this._clientPromises[c]=b.then(a=>{this._clients[c]=new A(a,d,()=>this._ongoingJobsQueue.pop()??null);k(l);return this._clients[c]},()=>{k(m);return null}):(this._clients[c]=new A(b,d,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[c]=Promise.resolve(this._clients[c]),k(l))}})};e.broadcast=function(h,d,l){const m=Array(this._clientPromises.length);for(let r=
0;r<this._clientPromises.length;++r)m[r]=this._clientPromises[r].then(k=>k?.invoke(h,d,l));return m};e.close=function(){let h;for(;h=this._ongoingJobsQueue.pop();)h.deferred.reject(B.createAbortError(`Worker closing, aborting job calling '${h.methodName}'`));for(const d of this._clientPromises)d.then(l=>l?.close());this._clients.length=0;this._clientPromises.length=0};e.invoke=function(h,d,l){let m;Array.isArray(l)?(E.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),
m={transferList:l}):m=l;l=B.createDeferred();this._ongoingJobsQueue.push({methodName:h,data:d,invokeOptions:m,deferred:l});for(h=0;h<this._clientPromises.length;h++)(d=this._clients[h])?d.jobAdded():this._clientPromises[h].then(r=>r?.jobAdded());return l.promise};e.on=function(h,d){return Promise.all(this._clientPromises).then(()=>t.handlesGroup(this._clients.map(l=>l.on(h,d))))};e.openPorts=function(){return new Promise(h=>{const d=Array(this._clientPromises.length);let l=d.length;for(let m=0;m<
this._clientPromises.length;++m)this._clientPromises[m].then(r=>{r&&(d[m]=r.openPort());0===--l&&h(d)})})};v._createClass(x,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);return x}()})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(v,t){return function(){function E(u=A=>A.values().next().value){this._peeker=u;this._items=new Set}var B=E.prototype;B.clear=
function(){this._items.clear()};B.last=function(){if(0!==this._items.size){for(var u of this._items);return u}};B.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};B.push=function(u){this.contains(u)||this._items.add(u)};B.contains=function(u){return this._items.has(u)};B.pop=function(){if(0!==this.length){var u=this.peek();this._items.delete(t.assumeNonNull(u));return u}};B.popLast=function(){if(0!==this.length){var u=this.last();this._items.delete(t.assumeNonNull(u));return u}};
B.remove=function(u){this._items.delete(u)};B.filter=function(u){this._items.forEach(A=>{u(A)||this._items.delete(A)});return this};v._createClass(E,[{key:"length",get:function(){return this._items.size}}]);return E}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b){function a(){a=t._asyncToGenerator(function*(J,P,S={},X=5){var {links:ha}=J;ha=F(ha,"items","application/geo+json")||F(ha,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(ha))throw new u("ogc-feature-layer:missing-items-page","Missing items url");({data:S}=yield B(ha.href,{signal:S.signal,query:{limit:X,...S.customParameters,token:S.apiKey},headers:{accept:"application/geo+json"}}));yield m.validateGeoJSON(S);const U=m.inferLayerProperties(S,
{geometryType:P.geometryType});S=P.fields||U.fields||[];X=null!=P.hasZ?P.hasZ:U.hasZ;ha=U.geometryType;const Q=P.objectIdField||U.objectIdFieldName||"OBJECTID";P=P.timeInfo;var O=S.find(({name:V})=>V===Q);if(O)O.editable=!1,O.nullable=!1;else{if(!U.objectIdFieldType)throw new u("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");S.unshift({name:Q,alias:Q,type:"number"===U.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}Q!==
U.objectIdFieldName&&(O=S.find(({name:V})=>V===U.objectIdFieldName))&&(O.type="esriFieldTypeInteger");S===U.fields&&0<U.unknownFields.length&&K.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:U.unknownFields}});for(var R of S){null==R.name&&(R.name=R.alias);null==R.alias&&(R.alias=R.name);"esriFieldTypeOID"!==R.type&&"esriFieldTypeGlobalID"!==R.type&&(R.editable=null==R.editable?!0:!!R.editable,
R.nullable=null==R.nullable?!0:!!R.nullable);if(!R.name)throw new u("ogc-feature-layer:invalid-field-name","field name is missing",{field:R});if(!c.kebabDict.jsonValues.includes(R.type))throw new u("ogc-feature-layer:invalid-field-type",`invalid type for field "${R.name}"`,{field:R});}P&&(R=new k(S),P.startTimeField&&((O=R.get(P.startTimeField))?(P.startTimeField=O.name,O.type="esriFieldTypeDate"):P.startTimeField=null),P.endTimeField&&((O=R.get(P.endTimeField))?(P.endTimeField=O.name,O.type="esriFieldTypeDate"):
P.endTimeField=null),P.trackIdField&&((R=R.get(P.trackIdField))?P.trackIdField=R.name:(P.trackIdField=null,K.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:P}}))),P.startTimeField||P.endTimeField||(K.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:P}}),P=null));R=ha?r.createDrawingInfo(ha):null;J=C(J);return{drawingInfo:R,extent:J,geometryType:ha,fields:S,hasZ:!!X,
objectIdField:Q,timeInfo:P}});return a.apply(this,arguments)}function g(){g=t._asyncToGenerator(function*(J,P={}){({links:J}=J);J=F(J,"data","application/json")||F(J,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(x.isNone(J))throw new u("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:S,customParameters:X,signal:ha}=P;({data:P}=yield B(J.href,{signal:ha,headers:{accept:"application/json"},query:{...X,token:S}}));return P});return g.apply(this,
arguments)}function n(){n=t._asyncToGenerator(function*(J,P={}){({links:J}=J);J=F(J,"conformance","application/json")||F(J,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(x.isNone(J))throw new u("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:S,customParameters:X,signal:ha}=P;({data:P}=yield B(J.href,{signal:ha,headers:{accept:"application/json"},query:{...X,token:S}}));return P});return n.apply(this,arguments)}function f(){f=t._asyncToGenerator(function*(J,
P={}){const {apiKey:S,customParameters:X,signal:ha}=P;({data:J}=yield B(J,{signal:ha,headers:{accept:"application/json"},query:{...X,token:S}}));return J});return f.apply(this,arguments)}function q(){q=t._asyncToGenerator(function*(J,P={}){J=F(J.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(x.isNone(J))return K.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const {apiKey:S,customParameters:X,signal:ha}=
P;({data:P}=yield B(J.href,{signal:ha,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},query:{...X,token:S}}));return P});return q.apply(this,arguments)}function p(){p=t._asyncToGenerator(function*(J,P,S){J=yield z(J,P,S);return d.convertToFeatureSet(J)});return p.apply(this,arguments)}function z(J,P,S){return w.apply(this,arguments)}function w(){w=t._asyncToGenerator(function*(J,P,S){const {collection:X,layerDefinition:ha,maxRecordCount:U,queryParameters:{apiKey:Q,customParameters:O},
spatialReference:R,supportedCrs:V}=J;({links:J}=X);var Z=F(J,"items","application/geo+json")||F(J,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(x.isNone(Z))throw new u("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:ka,num:ia,start:wa,timeExtent:ea,where:L}=P;if(P.objectIds)throw new u("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");J=b.fromJSON(R);P=x.unwrapOr(P.outSpatialReference,J);J=P.isWGS84?
null:y(P,V);var M=D(ka,V);const ba=H(ea),ca=I(L);({data:Z}=yield B(Z.href,{...S,query:{...O,...M,crs:J,datetime:ba,query:ca,limit:ia??(null!=wa&&void 0!==wa?10:U),startindex:wa,token:Q},headers:{accept:"application/geo+json"}}));S=!1;Z.links&&(S=!!Z.links.find(sa=>"next"===sa.rel));!S&&Number.isInteger(Z.numberMatched)&&Number.isInteger(Z.numberReturned)&&(S=Z.numberReturned<Z.numberMatched);const {fields:ma,geometryType:W,hasZ:Y,objectIdField:da}=ha;Z=m.createOptimizedFeatures(Z,{geometryType:W,
hasZ:Y,objectIdField:da});if(!J&&P.isWebMercator)for(var ja of Z)x.isSome(ja.geometry)&&(M=d.convertToGeometry(ja.geometry,W,Y,!1),M.spatialReference=b.WGS84,ja.geometry=d.convertFromGeometry(h.project(M,P)));for(var pa of Z)pa.objectId=pa.attributes[da];ja=J||!J&&P.isWebMercator?P.toJSON():e.WGS84;pa=new l;pa.exceededTransferLimit=S;pa.features=Z;pa.fields=ma;pa.geometryType=W;pa.hasZ=Y;pa.objectIdFieldName=da;pa.spatialReference=ja;return pa});return w.apply(this,arguments)}function y(J,P){const {isWebMercator:S,
wkid:X}=J;return X?(J=S?P[3857]??P[102100]??P[102113]??P[900913]:P[J.wkid])?`${"http://www.opengis.net/def/crs/"}${J}`:null:null}function G(J){if(x.isNone(J))return"";const {xmin:P,ymin:S,xmax:X,ymax:ha}=J;return`${P},${S},${X},${ha}`}function H(J){if(x.isNone(J))return null;const {start:P,end:S}=J;return`${x.isSome(P)?P.toISOString():".."}/${x.isSome(S)?S.toISOString():".."}`}function I(J){return x.isNone(J)||!J||"1\x3d1"===J?null:J}function D(J,P){if(!x.isSome(J)||"extent"!==J.type)return null;
const {spatialReference:S}=J;if(!S||S.isWGS84)return{bbox:G(J)};P=y(S,P);return x.isSome(P)?{bbox:G(J),"bbox-crs":P}:S.isWebMercator?{bbox:G(h.project(J,b.WGS84))}:null}function C(J){J=J.extent?.spatial;if(!J)return null;var P=J.bbox[0],S=4===P.length;J=P[0];const X=P[1],ha=S?void 0:P[2],U=S?P[2]:P[3],Q=S?P[3]:P[4];P=S?void 0:P[5];S=b.WGS84.toJSON();return{xmin:J,ymin:X,xmax:U,ymax:Q,zmin:ha,zmax:P,spatialReference:S}}function F(J,P,S){return J.find(X=>X.rel===P&&X.type===S)||J.find(X=>X.rel===P&&
!X.type)}const K=A.getLogger("esri.layers.graphics.sources.ogcfeature");v.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";v.crsPrefix="http://www.opengis.net/def/crs/";v.getCollectionDefinition=function(J,P){return a.apply(this,arguments)};v.getServerCollections=function(J){return g.apply(this,arguments)};v.getServerConformance=function(J){return n.apply(this,arguments)};v.getServerLandingPage=function(J){return f.apply(this,arguments)};v.getServerOpenApi=function(J){return q.apply(this,
arguments)};v.getSpatialReferenceWkid=function(J){J=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(J)?.groups;if(!J)return null;const {authority:P,code:S}=J;switch(P.toLowerCase()){case "ogc":switch(S.toLowerCase()){case "crs27":return b.GCS_NAD_1927.wkid;case "crs83":return 4269;case "crs84":case "crs84h":return b.WGS84.wkid;default:return null}case "esri":case "epsg":return J=Number.parseInt(S,10),Number.isNaN(J)?null:J;default:return null}};v.queryFeatureSetJSON=
function(J,P,S){return p.apply(this,arguments)};v.queryOptimizedFeatureSet=z;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],function(v,t,E,B,u){function*A(n){switch(n.type){case "Feature":yield n;break;case "FeatureCollection":for(const f of n.features)f&&(yield f)}}function*x(n){if(!n)return null;
switch(n.type){case "Point":yield n.coordinates;break;case "LineString":case "MultiPoint":yield*n.coordinates;break;case "MultiLineString":case "Polygon":for(const f of n.coordinates)yield*f;break;case "MultiPolygon":for(const f of n.coordinates)for(const q of f)yield*q}}function*e(n,f={}){const {geometryType:q,objectIdField:p}=f;for(const z of n){const {geometry:w,properties:y,id:G}=z;if(w&&g[w.type]!==q)continue;n=y||{};let H=n[p]??null;p&&null!=G&&!n[p]&&(n[p]=H=G);yield new E.OptimizedFeature(w?
m(new B,w,f):null,n,null,H)}}function h(n){for(const f of n)if(2<f.length)return!0;return!1}function d(n){let f=0;for(let q=0;q<n.length;q++){const p=n[q],z=n[(q+1)%n.length];f+=p[0]*z[1]-z[0]*p[1]}return 0>=f}function l(n){const f=n[0],q=n[n.length-1];f[0]===q[0]&&f[1]===q[1]&&f[2]===q[2]||n.push(f);return n}function m(n,f,q){switch(f.type){case "LineString":return c(n,f.coordinates,q),n;case "MultiLineString":for(const z of f.coordinates)c(n,z,q);return n;case "MultiPoint":return c(n,f.coordinates,
q),n;case "MultiPolygon":for(var p of f.coordinates)for(r(n,p[0],q),f=1;f<p.length;f++)k(n,p[f],q);return n;case "Point":return a(n,f.coordinates,q),n;case "Polygon":p=f.coordinates;r(n,p[0],q);for(f=1;f<p.length;f++)k(n,p[f],q);return n}}function r(n,f,q){f=l(f);d(f)?c(n,f,q):b(n,f,q)}function k(n,f,q){f=l(f);d(f)?b(n,f,q):c(n,f,q)}function c(n,f,q){for(const p of f)a(n,p,q);n.lengths.push(f.length)}function b(n,f,q){for(let p=f.length-1;0<=p;p--)a(n,f[p],q);n.lengths.push(f.length)}function a(n,
f,q){const [p,z,w]=f;n.coords.push(p,z);q.hasZ&&n.coords.push(w||0)}const g={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};v.createOptimizedFeatures=function(n,f){return Array.from(e(A(n),f))};v.getGeometryType=function(n){return g[n]};v.inferLayerProperties=function(n,f={}){const q=[];var p=new Set;const z=new Set;var w=!1;let y=null,G=!1,H=void 0;
({geometryType:f=null}=f);var I=!1;for(const D of A(n)){const {geometry:C,properties:F,id:K}=D;if(C&&(f||(f=g[C.type]),g[C.type]!==f))continue;w||(w=x(C),w=h(w));!G&&(G=null!=K)&&(H=typeof K,y=Object.keys(F).filter(J=>F[J]===K));G&&null!=K&&(1<y.length?y=y.filter(J=>F[J]===K):1===y.length&&(y=F[y[0]]===K?y:[]));if(!I&&F){n=!0;for(const J in F)if(!p.has(J))if(I=F[J],null==I)n=!1,z.add(J);else{a:switch(typeof I){case "string":I="esriFieldTypeString";break a;case "number":I="esriFieldTypeDouble";break a;
default:I="unknown"}"unknown"===I?z.add(J):(z.delete(J),p.add(J),q.push({name:u.normalizeFieldName(J),alias:J,type:I}))}I=n}}if(p=u.normalizeFieldName(1===y?.length&&y[0]||null))for(const D of q)if(D.name===p&&u.isNumericField(D)){D.type="esriFieldTypeOID";break}return{fields:q,geometryType:f,hasZ:w,objectIdFieldName:p,objectIdFieldType:H,unknownFields:Array.from(z)}};v.validateGeoJSON=function(n){if(!n)throw new t("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==n.type&&"FeatureCollection"!==
n.type)throw new t("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:n});({crs:n}=n);if(n){var f="string"===typeof n?n:"name"===n.type?n.properties.name:"EPSG"===n.type?n.properties.code:null,q=RegExp(".*(CRS84H?|4326)$","i");if(!f||!q.test(f))throw new t("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:n});}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports",
"../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(v,t,E,B,u){const A=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let x=1;v.createCapabilities=function(e,h){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:h,supportsDelete:h,
supportsEditing:h,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:h,supportsExceedsLimitStatistics:!0},query:B.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:h,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,
supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};v.createDefaultAttributesFunction=function(e,h){if(t("esri-csp-restrictions"))return()=>({[h]:null,...e});try{let d=`this.${h} = null;`;for(const m in e){const r=A.test(m)?`.${m}`:`["${m}"]`;d+=`this${r} = ${JSON.stringify(e[m])};`}const l=(new Function(`\n      return class AttributesClass$${x++} {\n        constructor() {\n          ${d};\n        }\n      }\n    `))();
return()=>new l}catch(d){return()=>({[h]:null,...e})}};v.createDefaultTemplate=function(e={}){return[{name:"New Feature",description:"",prototype:{attributes:E.clone(e)}}]};v.createDrawingInfo=function(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?u.defaultPointSymbolJSON:"esriGeometryPolyline"===e?u.defaultPolylineSymbolJSON:u.defaultPolygonSymbolJSON}}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],
function(v){const t=[252,146,31,255],E={type:"esriSMS",style:"esriSMSCircle",size:6,color:t,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},B={type:"esriSLS",style:"esriSLSSolid",width:.75,color:t};v.defaultColor=t;v.defaultOutlineColor=[153,153,153,255];v.defaultPointSymbolJSON=E;v.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};v.defaultPolylineSymbolJSON=
B;v.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};v.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};v.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};v.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",
color:[0,0,0,255],width:1.5};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(v,t){t=new t.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",
esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});v.kebabDict=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/query":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(v,t,E,B,u,A,x,e,h,d){function l(a,g){if(g&&"extent"===a.type)return`${a.xmin},${a.ymin},${a.xmax},${a.ymax}`;if(g&&"point"===a.type)return`${a.x},${a.y}`;a=a.toJSON();delete a.spatialReference;return JSON.stringify(a)}function m(a,g){const n=a.geometry,f=a.toJSON();delete f.compactGeometryEnabled;delete f.defaultSpatialReferenceEnabled;let q,p,z;B.isSome(n)&&(p=n.spatialReference,z=n.spatialReference.wkid||JSON.stringify(n.spatialReference),f.geometryType=A.getJsonType(n),f.geometry=l(n,
a.compactGeometryEnabled),f.inSR=z);f.groupByFieldsForStatistics&&(f.groupByFieldsForStatistics=f.groupByFieldsForStatistics.join(","));f.objectIds&&(f.objectIds=f.objectIds.join(","));f.orderByFields&&(f.orderByFields=f.orderByFields.join(","));!f.outFields||!f.returnDistinctValues&&(g?.returnCountOnly||g?.returnExtentOnly||g?.returnIdsOnly)?delete f.outFields:f.outFields.includes("*")?f.outFields="*":f.outFields=f.outFields.join(",");f.outSR?(f.outSR=f.outSR.wkid||JSON.stringify(f.outSR),q=a.outSpatialReference):
n&&(f.returnGeometry||f.returnCentroid)&&(f.outSR=f.inSR,q=p);f.returnGeometry&&delete f.returnGeometry;f.outStatistics&&(f.outStatistics=JSON.stringify(f.outStatistics));f.fullText&&(f.fullText=JSON.stringify(f.fullText));f.pixelSize&&(f.pixelSize=JSON.stringify(f.pixelSize));f.quantizationParameters&&(a.defaultSpatialReferenceEnabled&&B.isSome(p)&&B.isSome(a.quantizationParameters)&&B.isSome(a.quantizationParameters.extent)&&p.equals(a.quantizationParameters.extent.spatialReference)&&delete f.quantizationParameters.extent.spatialReference,
f.quantizationParameters=JSON.stringify(f.quantizationParameters));f.parameterValues&&(f.parameterValues=JSON.stringify(f.parameterValues));f.rangeValues&&(f.rangeValues=JSON.stringify(f.rangeValues));f.dynamicDataSource&&(f.layer=JSON.stringify({source:f.dynamicDataSource}),delete f.dynamicDataSource);if(f.timeExtent){const {start:w,end:y}=f.timeExtent;if(null!=w||null!=y)f.time=w===y?w:`${null==w?"null":w},${null==y?"null":y}`;delete f.timeExtent}a.defaultSpatialReferenceEnabled&&B.isSome(p)&&B.isSome(q)&&
p.equals(q)&&(f.defaultSR=f.inSR,delete f.inSR,delete f.outSR);return f}function r(){r=t._asyncToGenerator(function*(a,g,n,f){a=B.isSome(g.timeExtent)&&g.timeExtent.isEmpty?{data:{features:[]}}:yield b(a,g,"json",f);d.applyFeatureSetZUnitScaling(g,n,a.data);return a});return r.apply(this,arguments)}function k(){k=t._asyncToGenerator(function*(a,g,n,f){if(B.isSome(g.timeExtent)&&g.timeExtent.isEmpty)return{data:n.createFeatureResult()};a=yield c(a,g,f);a.data=h.parsePBFFeatureQuery(a.data,n);return a});
return k.apply(this,arguments)}function c(a,g,n){return b(a,g,"pbf",n)}function b(a,g,n,f={},q={}){const p="string"===typeof a?u.urlToObject(a):a;a=g.geometry?[g.geometry]:[];f.responseType="pbf"===n?"array-buffer":"json";return x.normalizeCentralMeridian(a,null,f).then(z=>{z=z&&z[0];B.isSome(z)&&(g=g.clone(),g.geometry=z);z=e.mapParameters({...p.query,f:n,...q,...m(g,q)});return E(u.join(p.path,"query"),{...f,query:{...z,...f.query}})})}v.encodeGeometry=l;v.executeQuery=function(a,g,n,f){return r.apply(this,
arguments)};v.executeQueryForCount=function(a,g,n){return B.isSome(g.timeExtent)&&g.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):b(a,g,"json",n,{returnIdsOnly:!0,returnCountOnly:!0})};v.executeQueryForExtent=function(a,g,n){return B.isSome(g.timeExtent)&&g.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):b(a,g,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then(f=>{const q=f.data;if(q.hasOwnProperty("extent"))return f;if(q.features)throw Error("Layer does not support extent calculation.");
if(q.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return f})};v.executeQueryForIds=function(a,g,n){return B.isSome(g.timeExtent)&&g.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):b(a,g,"json",n,{returnIdsOnly:!0})};v.executeQueryPBF=function(a,g,n,f){return k.apply(this,arguments)};v.executeQueryPBFBuffer=c;v.queryToQueryStringParameters=m;v.runQuery=b;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/operations/urlUtils":function(){define(["exports"],
function(v){function t(E){const B={};for(const u in E){if("declaredClass"===u)continue;const A=E[u];if(null!=A&&"function"!==typeof A)if(Array.isArray(A)){B[u]=[];for(let x=0;x<A.length;x++)B[u][x]=t(A[x])}else"object"===typeof A?A.toJSON&&(B[u]=JSON.stringify(A)):B[u]=A}return B}v.mapParameters=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(v,
t){v.parsePBFFeatureQuery=function(E,B){var u=t.parseFeatureQuery(E,B);E=u.queryResult.featureResult;B=u.queryResult.queryGeometry;u=u.queryResult.queryGeometryType;if(E&&E.features&&E.features.length&&E.objectIdFieldName){const A=E.objectIdFieldName;for(const x of E.features)x.attributes&&(x.objectId=x.attributes[A])}E&&(E.queryGeometry=B,E.queryGeometryType=u);return E};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),
function(v,t,E,B,u,A){function x(y){return y>=p.length?null:p[y]}function e(y,G,H){y=y.asUnsafe();for(H=G.createPointGeometry(H);y.next();)switch(y.tag()){case 3:var I=y.getUInt32();I=y.pos()+I;let D=0;for(;y.pos()<I;)G.addCoordinatePoint(H,y.getSInt64(),D++);break;default:y.skip()}return H}function h(y,G,H){y=y.asUnsafe();const I=G.createGeometry(H);for(H=2+(H.hasZ?1:0)+(H.hasM?1:0);y.next();)switch(y.tag()){case 2:var D=y.getUInt32();D=y.pos()+D;for(var C=0;y.pos()<D;)G.addLength(I,y.getUInt32(),
C++);break;case 3:D=y.getUInt32();D=y.pos()+D;C=0;for(G.allocateCoordinates(I);y.pos()<D;)G.addCoordinate(I,y.getSInt64(),C),C++,C===H&&(C=0);break;default:y.skip()}return I}function d(y){y=y.asUnsafe();const G=new u;let H="esriGeometryPoint";for(;y.next();)switch(y.tag()){case 2:var I=y.getUInt32();for(I=y.pos()+I;y.pos()<I;)G.lengths.push(y.getUInt32());break;case 3:I=y.getUInt32();for(I=y.pos()+I;y.pos()<I;)G.coords.push(y.getSInt64());break;case 1:H=A.OPTIMIZED_GEOMETRY_TYPES[y.getEnum()];break;
default:y.skip()}return{queryGeometry:G,queryGeometryType:H}}function l(y){for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:return y.getString();case 2:return y.getFloat();case 3:return y.getDouble();case 4:return y.getSInt32();case 5:return y.getUInt32();case 6:return y.getInt64();case 7:return y.getUInt64();case 8:return y.getSInt64();case 9:return y.getBool();default:return y.skip(),null}return null}function m(y){y=y.asUnsafe();const G={type:x(0)};for(;y.next();)switch(y.tag()){case 1:G.name=
y.getString();break;case 2:G.type=x(y.getEnum());break;case 3:G.alias=y.getString();break;case 4:var H=y.getEnum();H=H>=z.length?null:z[H];G.sqlType=H;break;case 5:y.skip();break;case 6:G.defaultValue=y.getString();break;default:y.skip()}return G}function r(y){const G={};for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:G.name=y.getString();break;case 2:G.isSystemMaintained=y.getBool();break;default:y.skip()}return G}function k(y,G,H,I){const D=G.createFeature(H);let C=0;for(;y.next();)switch(y.tag()){case 1:const F=
I[C++].name;D.attributes[F]=y.processMessage(l);break;case 2:D.geometry=y.processMessageWithArgs(h,G,H);break;case 4:D.centroid=y.processMessageWithArgs(e,G,H);break;default:y.skip()}return D}function c(y){const G=[1,1,1,1];for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:G[0]=y.getDouble();break;case 2:G[1]=y.getDouble();break;case 4:G[2]=y.getDouble();break;case 3:G[3]=y.getDouble();break;default:y.skip()}return G}function b(y){const G=[0,0,0,0];for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:G[0]=
y.getDouble();break;case 2:G[1]=y.getDouble();break;case 4:G[2]=y.getDouble();break;case 3:G[3]=y.getDouble();break;default:y.skip()}return G}function a(y){const G={originPosition:0>=w.length?null:w[0]};for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:var H=y.getEnum();G.originPosition=H>=w.length?null:w[H];break;case 2:G.scale=y.processMessage(c);break;case 3:G.translate=y.processMessage(b);break;default:y.skip()}return G}function g(y){const G={};for(y=y.asUnsafe();y.next();)switch(y.tag()){case 1:G.shapeAreaFieldName=
y.getString();break;case 2:G.shapeLengthFieldName=y.getString();break;case 3:G.units=y.getString();break;default:y.skip()}return G}function n(y,G){for(G=G.createSpatialReference();y.next();)switch(y.tag()){case 1:G.wkid=y.getUInt32();break;case 5:G.wkt=y.getString();break;case 2:G.latestWkid=y.getUInt32();break;case 3:G.vcsWkid=y.getUInt32();break;case 4:G.latestVcsWkid=y.getUInt32();break;default:y.skip()}return G}function f(y,G){const H=G.createFeatureResult();y=y.asUnsafe();H.geometryType=0>=G.geometryTypes.length?
null:G.geometryTypes[0];let I=!1;for(;y.next();)switch(y.tag()){case 1:H.objectIdFieldName=y.getString();break;case 3:H.globalIdFieldName=y.getString();break;case 4:H.geohashFieldName=y.getString();break;case 5:H.geometryProperties=y.processMessage(g);break;case 7:var D=y.getEnum();H.geometryType=D>=G.geometryTypes.length?null:G.geometryTypes[D];break;case 8:H.spatialReference=y.processMessageWithArgs(n,G);break;case 10:H.hasZ=y.getBool();break;case 11:H.hasM=y.getBool();break;case 12:H.transform=
y.processMessage(a);break;case 9:D=y.getBool();H.exceededTransferLimit=D;break;case 13:G.addField(H,y.processMessage(m));break;case 15:I||(G.prepareFeatures(H),I=!0);G.addFeature(H,y.processMessageWithArgs(k,G,H,H.fields));break;case 2:H.uniqueIdField=y.processMessage(r);break;default:y.skip()}G.finishFeatureResult(H);return H}function q(y,G){const H={};let I=null;for(;y.next();)switch(y.tag()){case 4:I=y.processMessageWithArgs(d);break;case 1:H.featureResult=y.processMessageWithArgs(f,G);break;default:y.skip()}E.isSome(I)&&
H.featureResult&&G.addQueryGeometry(H,I);return H}const p="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),z="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),
w=["upperLeft","lowerLeft"];v.parseFeatureQuery=function(y,G){try{const H=new B(new Uint8Array(y),new DataView(y));for(y={};H.next();)switch(H.tag()){case 2:y.queryResult=H.processMessageWithArgs(q,G);break;default:H.skip()}return y}catch(H){throw new t("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:H});}};v.parseFieldType=x;v.parseTransform=a;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(v,t,E,B,u,A){const x=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let e=function(){function h(l){this._options=l;this.geometryTypes=x;this._vertexDimension=this._coordinatePtr=0}var d=h.prototype;d.createFeatureResult=function(){return new u};d.prepareFeatures=function(l){this._vertexDimension=2;l.hasZ&&this._vertexDimension++;l.hasM&&this._vertexDimension++};d.finishFeatureResult=function(l){if(l&&l.features&&l.hasZ&&this._options.sourceSpatialReference&&
l.spatialReference&&!E.equals(l.spatialReference,this._options.sourceSpatialReference)&&!l.spatialReference.vcsWkid){var m=t.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),r=t.getMetersPerVerticalUnitForSR(l.spatialReference);m/=r;if(1!==m)for(const k of l.features)if(B.hasGeometry(k))for(l=k.geometry.coords,r=2;r<l.length;r+=3)l[r]*=m}};d.addFeature=function(l,m){l.features.push(m)};d.createFeature=function(){return new B.OptimizedFeature};d.createSpatialReference=function(){return{wkid:0}};
d.createGeometry=function(){return new A};d.addField=function(l,m){l.fields.push(m)};d.allocateCoordinates=function(l){l.coords.length=l.lengths.reduce((m,r)=>m+r,0)*this._vertexDimension;this._coordinatePtr=0};d.addCoordinate=function(l,m){l.coords[this._coordinatePtr++]=m};d.addCoordinatePoint=function(l,m){l.coords.push(m)};d.addLength=function(l,m){l.lengths.push(m)};d.addQueryGeometry=function(l,m){l.queryGeometry=m.queryGeometry;l.queryGeometryType=m.queryGeometryType};d.createPointGeometry=
function(){return new A};return h}();v.OPTIMIZED_GEOMETRY_TYPES=x;v.OptimizedFeatureSetParserContext=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(v,t,E){v.applyFeatureSetZUnitScaling=function(B,u,A){if(A&&A.features&&A.hasZ&&(B=E.getGeometryZScaler(A.geometryType,u,B.outSpatialReference),!t.isNone(B)))for(const x of A.features)B(x.geometry)};
Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(v,t,E,B,u,A){function x({coords:h,lengths:d}){let l=0;for(const m of d){for(d=1;d<m;d++)h[2*(l+d)]+=h[2*(l+
d)-2],h[2*(l+d)+1]+=h[2*(l+d)-1];l+=m}}let e=function(h){function d(m,r,k){m=h.call(this,m,k)||this;m._exceededTransferLimit=!1;m._featureIndex=-1;m._dateFields=new Set;m._geometryType=k?.geometryType;m._features=r;return m}t._inheritsLoose(d,h);d.fromFeatures=function(m,r){const {objectIdField:k,geometryType:c}=r,b=B.convertFromFeatures([],m,c,!1,!1,k);for(let a=0;a<b.length;a++)b[a].displayId=m[a].displayId;return d.fromOptimizedFeatures(b,r)};d.fromFeatureSet=function(m,r){m=B.convertFromFeatureSet(m,
r.objectIdField);return d.fromOptimizedFeatureSet(m,r)};d.fromOptimizedFeatureSet=function(m,r){const {features:k}=m;r=d.fromOptimizedFeatures(k,r);r._exceededTransferLimit=m.exceededTransferLimit;r._transform=m.transform;for(const c of m.fields)"esriFieldTypeDate"===c.type&&r._dateFields.add(c.name);return r};d.fromOptimizedFeatures=function(m,r,k){const c=A.FeatureSetReader.createInstance();m=new d(c,m,r);m._transform=k;return m};var l=d.prototype;l.removeIds=function(m){const r=new Set(m);this._features=
this._features.filter(k=>!(k.objectId&&r.has(k.objectId)))};l.append=function(m){for(const r of m)this._features.push(r)};l.getSize=function(){return this._features.length};l.getCursor=function(){return this.copy()};l.getQuantizationTransform=function(){return this._transform};l.getAttributeHash=function(){let m="";for(const r in this._current.attributes)m+=this._current.attributes[r];return m};l.getIndex=function(){return this._featureIndex};l.setIndex=function(m){this._featureIndex=m};l.getObjectId=
function(){return this._current.objectId};l.getDisplayId=function(){return this._current.displayId};l.setDisplayId=function(m){this._current.displayId=m};l.getGroupId=function(){return this._current.groupId};l.setGroupId=function(m){this._current.groupId=m};l.copy=function(){const m=new d(this.instance,this._features,this.fullSchema());this.copyInto(m);return m};l.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};
l.readLegacyFeature=function(){return B.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};l.readOptimizedFeature=function(){return this._current};l.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};l.readLegacyGeometry=function(){const m=this.readGeometry();return B.convertToGeometry(m,this.geometryType,this.hasZ,this.hasM)};l.readLegacyCentroid=function(){const m=this.readCentroid();return E.isNone(m)?null:{x:m.coords[0]*this._sx+
this._tx,y:m.coords[1]*this._sy+this._ty}};l.readGeometryArea=function(){return u.hasGeometry(this._current)?B.getQuantizedArea(this._current.geometry,2):0};l.readUnquantizedGeometry=function(){var m=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!m)return m;m=m.clone();x(m);return m};l.readHydratedGeometry=function(){var m=this._current.geometry;if(E.isNone(m))return null;m=m.clone();E.isSome(this._transform)&&B.unquantizeOptimizedGeometry(m,m,this.hasZ,this.hasM,this._transform);
return m};l.getXHydrated=function(){if(!u.hasGeometry(this._current))return 0;const m=this._current.geometry.coords[0],r=this.getQuantizationTransform();return E.isNone(r)?m:m*r.scale[0]+r.translate[0]};l.getYHydrated=function(){if(!u.hasGeometry(this._current))return 0;const m=this._current.geometry.coords[1],r=this.getQuantizationTransform();return E.isNone(r)?m:r.translate[1]-m*r.scale[1]};l.getX=function(){return u.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:
0};l.getY=function(){return u.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};l.readGeometry=function(){if(!u.hasGeometry(this._current)){if(E.isSome(this._current.centroid)){const [k,c]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(k,c)}return null}const m=this._current.geometry.clone();if(m.isPoint)return m.coords[0]=m.coords[0]*this._sx+this._tx,m.coords[1]=m.coords[1]*this._sy+this._ty,m;let r=0;for(const k of m.lengths)m.coords[2*r]=m.coords[2*
r]*this._sx+this._tx,m.coords[2*r+1]=m.coords[2*r+1]*this._sy+this._ty,r+=k;return m};l.readCentroid=function(){return u.hasGeometry(this._current)?this._computeCentroid():this._current.centroid};l.hasField=function(m){return m in this._current.attributes?!0:this.getFieldNames().map(r=>r.toLowerCase()).includes(m.toLowerCase())};l.getFieldNames=function(){return Object.keys(this._current.attributes)};l._readAttribute=function(m,r){var k=this._current.attributes[m];if(void 0!==k)return null!=k&&r&&
this._dateFields.has(m)?new Date(k):k;k=this.readAttributes();m=m.toLocaleLowerCase().trim();for(const c in k)if(c.toLocaleLowerCase().trim()===m)return m=this._current.attributes[c],null!=m&&r&&this._dateFields.has(c)?new Date(m):m};l.copyInto=function(m){h.prototype.copyInto.call(this,m);m._featureIndex=this._featureIndex;m._transform=this._transform;m._dateFields=this._dateFields};l._readAttributes=function(){return this._current.attributes};t._createClass(d,[{key:"_current",get:function(){return this._features[this._featureIndex]}},
{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return d}(A.FeatureSetReader);v.FeatureSetReaderJSON=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),function(v,t,E,B,u,A,x,e,h,d,l){function m(a){if(a<=c.small.delta.length)return c.small;
if(a<=c.large.delta.length)return c.large;c.large.delta=new Int32Array(Math.round(1.25*a));c.large.decoded=new Int32Array(Math.round(1.25*a));return c.large}function r(a){var g=a.getLength();for(g=a.pos()+g;a.pos()<g&&a.next();)switch(a.tag()){case 1:return a.getString();case 2:return a.getFloat();case 3:return a.getDouble();case 4:return a.getSInt32();case 5:return a.getUInt32();case 6:return a.getInt64();case 7:return a.getUInt64();case 8:return a.getSInt64();case 9:return a.getBool();default:return a.skip(),
null}return null}function k(a,g,n,f){return 0===a*f-n*g&&0<a*n+g*f}const c={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};let b=function(a){function g(f,q,p,z){f=a.call(this,f,z)||this;f._hasNext=!1;f._isPoints=!1;f._featureIndex=-1;f._featureOffset=0;f._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};f._geometryType=z.geometryType;f._reader=q;f._header=p;
f._hasNext=p.hasFeatures;f._isPoints="esriGeometryPoint"===z.geometryType;return f}t._inheritsLoose(g,a);g.fromBuffer=function(f,q,p=!1){var z=q.geometryType;a:{try{const G=new A(new Uint8Array(f),new DataView(f));for(;G.next();)switch(G.tag()){case 2:b:{for(var w=G.getMessage();w.next();)switch(w.tag()){case 1:var y=w.getMessage();break b;default:w.skip()}y=null}break a;default:G.skip()}}catch(G){f=new E("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:G}),B.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF").error(f)}y=
null}f=y;p=l.parseHeader(f,"esriGeometryPoint"===z,p);z=d.FeatureSetReader.createInstance();return new g(z,f,p,q)};var n=g.prototype;n.hasField=function(f){return this._header.hasField(f)||this._header.hasField(f.toLowerCase().trim())};n.getFieldNames=function(){return this._header.fields.map(f=>f.fieldName)};n.getSize=function(){return this._size};n.getQuantizationTransform=function(){return this._header.transform};n.getCursor=function(){return this.copy()};n.getIndex=function(){return this._featureIndex};
n.setIndex=function(f){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=f};n.getAttributeHash=function(){let f="";this._header.fields.forEach(({index:q})=>{f+=this._readAttributeAtIndex(q)+"."});return f};n.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};n.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};
n.setDisplayId=function(f){this._header.displayIds[this._featureIndex]=f};n.getGroupId=function(){return this._header.groupIds[this._featureIndex]};n.setGroupId=function(f){this._header.groupIds[this._featureIndex]=f};n.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var f=this.readCentroid();f={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),centroid:(f&&{x:f.coords[0],y:f.coords[1]})??null};return this._cache.legacyFeature=
f}return this._cache.legacyFeature};n.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){const f=new e.OptimizedFeature(this.readGeometry(),this.readAttributes(),this.readCentroid());f.objectId=this.getObjectId();f.displayId=this.getDisplayId();return this._cache.optFeature=f}return this._cache.optFeature};n.getXHydrated=function(){const f=this._header.centroid[2*this._featureIndex],q=this.getQuantizationTransform();return u.isNone(q)?f:f*q.scale[0]+q.translate[0]};n.getYHydrated=
function(){const f=this._header.centroid[2*this._featureIndex+1],q=this.getQuantizationTransform();return u.isNone(q)?f:q.translate[1]-f*q.scale[1]};n.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};n.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};n.readLegacyPointGeometry=function(){const f=this.getX(),q=this.getY();return{x:f,y:q}};n.readLegacyGeometry=function(f){f=this.readGeometry(f);return x.convertToGeometry(f,this.geometryType,
!1,!1)};n.readLegacyCentroid=function(){const f=this.readCentroid();if(!f)return null;const [q,p]=f.coords;return{x:q,y:p}};n.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};n.readUnquantizedGeometry=function(f=!1){if(void 0===this._cache.unquantGeometry){f=this.readGeometry(f);if(!f)return this._cache.unquantGeometry=void 0,null;var q=m(f.coords.length).decoded;f=f.clone(q);q=f.coords;let p=0;for(const z of f.lengths){for(let w=1;w<z;w++){const y=2*(p+
w),G=2*(p+w-1);q[y]+=q[G];q[y+1]+=q[G+1]}p+=z}return this._cache.unquantGeometry=f}return this._cache.unquantGeometry};n.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var f=this.getXHydrated(),q=this.getYHydrated();return new h([],[f,q])}f=this.readGeometry();if(!f)return null;f=f.clone();q=this.getQuantizationTransform();u.isSome(q)&&x.unquantizeOptimizedGeometry(f,f,this.hasZ,this.hasM,q);return f};n.readGeometry=function(f=
!1){if(void 0===this._cache.geometry){var q=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;f=this.getX();q=this.getY();q=new h([],[f,q])}else{const p=this._header.offsets.geometry[this._featureIndex],z=this._reader;if(0===p){f=this._readServerCentroid();if(!f)return null;const [w,y]=f.coords;return this.createQuantizedExtrudedQuad(w,y)}z.move(p);try{if(q=f?this._parseGeometryForDisplay(z):this._parseGeometry(z),null===q){const w=this._readServerCentroid();
if(!w)return null;const [y,G]=w.coords;return this.createQuantizedExtrudedQuad(y,G)}}catch(w){return console.error("Failed to parse geometry!",w),null}}return this._cache.geometry=q}return this._cache.geometry};n.readCentroid=function(){if(void 0===this._cache.centroid){let f=void 0;(f=this._computeCentroid())||(f=this._readServerCentroid());this._cache.centroid=f??void 0;return f??null}return this._cache.centroid};n.copy=function(){var f=this._reader.clone();f=new g(this.instance,f,this._header,
this.fullSchema());this.copyInto(f);return f};n.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this._size&&!this._getExists(););return this._featureIndex<this._size};n._readAttribute=function(f,q){f=this._header.hasField(f)?f:f.toLowerCase().trim();var p=this._header.getFieldIndex(f);if(null!=p)return p=this._readAttributeAtIndex(p),
q&&null!=p?this._header.isDateField(f)?new Date(p):p:p};n._readAttributes=function(){const f={};this._header.fields.forEach(({fieldName:q,index:p})=>{f[q]=this._readAttributeAtIndex(p)});return f};n.copyInto=function(f){a.prototype.copyInto.call(this,f);f._featureIndex=this._featureIndex;f._featureOffset=this._featureOffset;f._hasNext=this._hasNext};n._readAttributeAtIndex=function(f){const q=this._reader;q.move(this._header.offsets.attributes[this._featureIndex*this._header.fieldCount+f]);return r(q)};
n._readServerCentroid=function(){const f=this._header.centroid[2*this._featureIndex]+this._tx;return 268435455===f?null:new h([],[f,this._header.centroid[2*this._featureIndex+1]+this._ty])};n._parseGeometry=function(f){f=f.asUnsafe();var q=f.getLength();q=f.pos()+q;const p=[],z=[];for(;f.pos()<q&&f.next();)switch(f.tag()){case 2:var w=f.getUInt32();for(w=f.pos()+w;f.pos()<w;)z.push(f.getUInt32());break;case 3:w=f.getUInt32();w=f.pos()+w;p.push(f.getSInt32()+this._tx);p.push(f.getSInt32()+this._ty);
this.hasZ&&f.getSInt32();for(this.hasM&&f.getSInt32();f.pos()<w;)p.push(f.getSInt32()),p.push(f.getSInt32()),this.hasZ&&f.getSInt32(),this.hasM&&f.getSInt32();break;default:f.skip()}return new h(z,p)};n._parseGeometryForDisplay=function(f){f=f.asUnsafe();var q=f.getLength();const p=f.pos()+q,z=[];q=[];let w=0,y=0;var G=null;let H=0;const I="esriGeometryPolygon"===this.geometryType;for(;f.pos()<p&&f.next();)switch(f.tag()){case 2:G=f.getUInt32();for(G=f.pos()+G;f.pos()<G;){var D=f.getUInt32();z.push(D);
w+=D}G=m(2*w).delta;break;case 3:f.getUInt32();D=2+(this.hasZ?1:0)+(this.hasM?1:0);u.assertIsSome(G);for(var C of z)if(y+D*C>G.length)for(var F=0;F<C;F++)f.getSInt32(),f.getSInt32(),this.hasZ&&f.getSInt32(),this.hasM&&f.getSInt32();else if(I){F=this.getAreaSimplificationThreshold(C,this._header.vertexCount);var K=2,J=1,P=f.getSInt32(),S=f.getSInt32();G[y++]=P;G[y++]=S;this.hasZ&&f.getSInt32();this.hasM&&f.getSInt32();var X=f.getSInt32(),ha=f.getSInt32();this.hasZ&&f.getSInt32();for(this.hasM&&f.getSInt32();K<
C;){var U=f.getSInt32();let Q=f.getSInt32();this.hasZ&&f.getSInt32();this.hasM&&f.getSInt32();const O=P+X,R=S+ha,V=O+U,Z=R+Q;.5*Math.abs(P*R+O*Z+V*S-P*Z-O*S-V*R)>=F?(H+=-.5*(O-P)*(R+S),1<J&&k(G[y-2],G[y-1],X,ha)?(G[y-2]+=X,G[y-1]+=ha):(G[y++]=X,G[y++]=ha,J++),P=O,S=R):(U+=X,Q+=ha);X=U;ha=Q;K++}3>J?y-=2*J:(H+=-.5*(P+X-P)*(S+ha+S),k(G[y-2],G[y-1],X,ha)?(G[y-2]+=X,G[y-1]+=ha,q.push(J)):(G[y++]=X,G[y++]=ha,q.push(++J)))}else{F=0;K=f.getSInt32();J=f.getSInt32();this.hasZ&&f.getSInt32();this.hasM&&f.getSInt32();
G[y++]=K;G[y++]=J;F+=1;for(P=1;P<C;P++)S=f.getSInt32(),X=f.getSInt32(),ha=K+S,U=J+X,H+=-.5*(ha-K)*(U+J),this.hasZ&&f.getSInt32(),this.hasM&&f.getSInt32(),2<P&&k(G[y-2],G[y-1],S,X)?(G[y-2]+=S,G[y-1]+=X):(G[y++]=S,G[y++]=X,F+=1),K=ha,J=U;q.push(F)}break;default:f.skip()}this._cache.area=H;if(!q.length)return null;if(this._tx||this._ty){C=0;u.assertIsSome(G);for(const Q of q)G[2*C]+=this._tx,G[2*C+1]+=this._ty,C+=Q}return new h(q,G)};t._createClass(g,[{key:"geometryType",get:function(){return this._geometryType}},
{key:"_size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);return g}(d.FeatureSetReader);v.FeatureSetReaderPBF=b;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../core/Error","../../../../../rest/query/operations/pbfFeatureServiceParser"],function(v,t,E){let B=function(){function u(){this.fieldMap=new Map;this.fields=[];this.exceededTransferLimit=this.hasFeatures=!1;this.vertexCount=this.objectIdFieldIndex=this.featureCount=this.fieldCount=0;this.offsets={attributes:[],geometry:[]};
this.centroid=[]}var A=u.prototype;A.hasField=function(x){return this.fieldMap.has(x)};A.isDateField=function(x){return this.fieldMap.get(x)?.isDate??!1};A.getFieldIndex=function(x){return this.fieldMap.get(x)?.index};return u}();v.FeatureSetHeader=B;v.parseHeader=function(u,A,x=!1){const e=u.asUnsafe(),h=e.pos(),d=new B;let l=0,m=0,r=null,k=null,c=null,b=!1;for(;e.next();)switch(e.tag()){case 1:r=e.getString();break;case 3:k=e.getString();break;case 12:c=e.processMessage(E.parseTransform);break;
case 9:d.exceededTransferLimit=e.getBool();if(d.exceededTransferLimit){d.offsets.geometry=x?new Float64Array(8E3):new Int32Array(8E3);d.centroid=x?new Float64Array(16E3):new Int32Array(16E3);for(var a=0;a<d.centroid.length;a++)d.centroid[a]=268435455}break;case 13:a=u.asUnsafe();var g=a.getLength();g=a.pos()+g;for(var n={name:"",isDate:!1};a.pos()<g&&a.next();)switch(a.tag()){case 1:n.name=a.getString();break;case 2:"esriFieldTypeDate"===E.parseFieldType(a.getEnum())&&(n.isDate=!0);break;default:a.skip()}a=
n;n=a.name;g=a.name.toLowerCase().trim();n={fieldName:n,index:l++,isDate:a.isDate};d.fields.push(n);d.fieldMap.set(a.name,n);d.fieldMap.set(g,n);break;case 15:a=e.getLength();a=e.pos()+a;d.exceededTransferLimit||(g=d.centroid,d.offsets.geometry.push(0),g.push(268435455),g.push(268435455));!b&&d.exceededTransferLimit&&(b=!0,d.offsets.attributes=x?new Float64Array(8E3*l):new Uint32Array(8E3*l));for(g=m*l;e.pos()<a&&e.next();)switch(e.tag()){case 1:b?d.offsets.attributes[g++]=e.pos():d.offsets.attributes.push(e.pos());
n=e.getLength();e.skipLen(n);break;case 2:if(A)for(n=e.getLength(),n=e.pos()+n;e.pos()<n&&e.next();)switch(e.tag()){case 3:e.getUInt32();var f=e.getSInt64(),q=e.getSInt64();d.centroid[2*m]=f;d.centroid[2*m+1]=q;break;default:e.skip()}else d.offsets.geometry[m]=e.pos(),n=e.getLength(),d.vertexCount+=n,e.skipLen(n);break;case 4:n=e.getLength();for(n=e.pos()+n;e.pos()<n&&e.next();)switch(e.tag()){case 3:e.getUInt32();f=e.getSInt64();q=e.getSInt64();d.centroid[2*m]=f;d.centroid[2*m+1]=q;break;default:e.skip()}break;
default:e.skip()}m++;d.hasFeatures=!0;break;default:e.skip()}u=r||k;if(!u)throw new t("FeatureSet has no objectId or globalId field name");d.featureCount=m;d.fieldCount=l;d.objectIdFieldIndex=d.getFieldIndex(u);d.transform=c;d.displayIds=new Uint32Array(d.featureCount);d.groupIds=new Uint16Array(d.featureCount);e.move(h);return d};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../rest/support/Query ./DataTileSubscription ../support/UpdateToken".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l){function m(k,c){const b=new Set;k&&k.forEach(a=>b.add(a));c&&c.forEach(a=>b.add(a));return b.has("*")?["*"]:Array.from(b)}let r=function(){function k(b){this.events=new B;this._resolver=x.createResolver();this._didEdit=!1;this._subscriptions=new Map;this._outSR=b.outSR;this._serviceInfo=b.serviceInfo;this._onTileUpdateMessage=b.onMessage}var c=k.prototype;c.destroy=function(){};c._onMessage=function(){var b=t._asyncToGenerator(function*(a){const g=this._subscriptions.get(a.id);
if(g)return a={...a,remove:a.remove??[],status:a.status??l.UpdateToken.empty()},x.ignoreAbortErrors(this._onTileUpdateMessage(a,g.options))});return function(a){return b.apply(this,arguments)}}();c.update=function(b,a){var g=a.fields.length;a.outFields=m(this._schema?.outFields,a.outFields);a.outFields=a.outFields.length>=.75*g?["*"]:a.outFields;a.outFields.sort();if(g=e.diff(this._schema,a)){u("esri-2d-update-debug")&&console.debug("Applying Update - Source:",g);var n={returnCentroid:"esriGeometryPolygon"===
this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:a.outFields,outSpatialReference:this._outSR,orderByFields:["orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC"],where:a.definitionExpression||"1\x3d1",gdbVersion:a.gdbVersion,historicMoment:a.historicMoment,timeExtent:E.fromJSON(a.timeExtent)},f=this._schema&&
e.hasDiff(g,"outFields");this._schema&&e.hasDiffAny(g,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(b.why.mesh.push("Layer filter and/or custom parameters changed"),b.why.source.push("Layer filter and/or custom parameters changed"),b.mesh=!0,b.source=!0,b.queryFilter=!0);f&&(b.why.source.push("Layer required fields changed"),b.source=!0);e.diff(n,this._queryInfo)&&(this._queryInfo=n);this._schema=a;this._resolver.resolve()}};c.whenInitialized=function(){return this._resolver.promise};
c.applyUpdate=function(){var b=t._asyncToGenerator(function*(a){a.queryFilter||a.source&&this._didEdit?(this.refresh(a.version),this._didEdit=!1):(this._subscriptions.forEach(g=>g.applyUpdate(a)),yield this.resend())});return function(a){return b.apply(this,arguments)}}();c.refresh=function(b,a){for(const g of this._tiles())this.unsubscribe(g),this.subscribe(g,b)};c.subscribe=function(b,a){a=new d.DataTileSubscription(b,a);this._subscriptions.set(b.id,a)};c.unsubscribe=function(b){const a=this.get(b.id);
A.isSome(a)&&a.abort();this._subscriptions.delete(b.id)};c.createQuery=function(b={}){return new h({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...b})};c.get=function(b){return this._subscriptions.has(b)?this._subscriptions.get(b):null};c.queryLastEditDate=function(){var b=t._asyncToGenerator(function*(){throw Error("Service does not support query type");});return function(){return b.apply(this,arguments)}}();c.query=function(){var b=
t._asyncToGenerator(function*(a){throw Error("Service does not support query");});return function(a){return b.apply(this,arguments)}}();c._tiles=function*(){const b=Array.from(this._subscriptions.values());for(const a of b)yield a.tile};c.edit=function(){var b=t._asyncToGenerator(function*(a,g){var n=this,f=Array.from(this._subscriptions.values());const q=f.map(({tile:p})=>p);for(const p of f)p.removeIds(g);a.length&&(f=q.map(p=>{const z=this.createTileQuery(p);z.objectIds=a;return{tile:p,query:z}}).map(function(){var p=
t._asyncToGenerator(function*({tile:z,query:w}){return{tile:z,result:yield n.query(w),query:w}});return function(z){return p.apply(this,arguments)}}()),f=(yield x.eachAlwaysValues(f)).map(function(){var p=t._asyncToGenerator(function*({tile:z,result:w}){(w.hasFeatures||g.length||a.length)&&(z=n._subscriptions.get(z.key.id))&&z.edit(w,a)});return function(z){return p.apply(this,arguments)}}()),yield x.eachAlways(f));this._didEdit=!0});return function(a,g){return b.apply(this,arguments)}}();return k}();
v.DataTileSource=r;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/arrayUtils ./core/accessorSupport/ensureType ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),function(v,t,E,B,u,
A,x,e,h,d,l){var m;E=m=function(c){function b(g){g=c.call(this,g)||this;g.end=null;g.start=null;return g}v._inheritsLoose(b,c);var a=b.prototype;a.readEnd=function(g,n){return null!=n.end?new Date(n.end):null};a.writeEnd=function(g,n){n.end=g?g.getTime():null};a.readStart=function(g,n){return null!=n.start?new Date(n.start):null};a.writeStart=function(g,n){n.start=g?g.getTime():null};a.clone=function(){return new m({end:this.end,start:this.start})};a.equals=function(g){if(!g)return!1;const n=B.isSome(this.start)?
this.start.getTime():this.start,f=B.isSome(this.end)?this.end.getTime():this.end,q=B.isSome(g.start)?g.start.getTime():g.start;g=B.isSome(g.end)?g.end.getTime():g.end;return n===q&&f===g};a.expandTo=function(g){if(this.isEmpty||this.isAllTime)return this.clone();const n=B.applySome(this.start,q=>u.truncateDate(q,g)),f=B.applySome(this.end,q=>{const p=u.truncateDate(q,g);return q.getTime()===p.getTime()?p:u.offsetDate(p,1,g)});return new m({start:n,end:f})};a.intersection=function(g){if(!g)return this.clone();
if(this.isEmpty||g.isEmpty)return m.empty;if(this.isAllTime)return g.clone();if(g.isAllTime)return this.clone();var n=B.mapOr(this.start,-Infinity,w=>w.getTime());const f=B.mapOr(this.end,Infinity,w=>w.getTime()),q=B.mapOr(g.start,-Infinity,w=>w.getTime());g=B.mapOr(g.end,Infinity,w=>w.getTime());let p,z;q>=n&&q<=f?p=q:n>=q&&n<=g&&(p=n);f>=q&&f<=g?z=f:g>=n&&g<=f&&(z=g);return null==p||null==z||isNaN(p)||isNaN(z)?m.empty:(n=new m,n.start=-Infinity===p?null:new Date(p),n.end=Infinity===z?null:new Date(z),
n)};a.offset=function(g,n){if(this.isEmpty||this.isAllTime)return this.clone();const f=new m,{start:q,end:p}=this;B.isSome(q)&&(f.start=u.offsetDate(q,g,n));B.isSome(p)&&(f.end=u.offsetDate(p,g,n));return f};a.union=function(g){if(!g||g.isEmpty)return this.clone();if(this.isEmpty)return g.clone();if(this.isAllTime||g.isAllTime)return r.clone();const n=B.isSome(this.start)&&B.isSome(g.start)?new Date(Math.min(this.start.getTime(),g.start.getTime())):null;g=B.isSome(this.end)&&B.isSome(g.end)?new Date(Math.max(this.end.getTime(),
g.end.getTime())):null;return new m({start:n,end:g})};v._createClass(b,[{key:"isAllTime",get:function(){return this.equals(m.allTime)}},{key:"isEmpty",get:function(){return this.equals(m.empty)}}],[{key:"allTime",get:function(){return r}},{key:"empty",get:function(){return k}}]);return b}(E.JSONSupport);t.__decorate([A.property({type:Date,json:{write:{allowNull:!0}}})],E.prototype,"end",void 0);t.__decorate([h.reader("end")],E.prototype,"readEnd",null);t.__decorate([l.writer("end")],E.prototype,"writeEnd",
null);t.__decorate([A.property({readOnly:!0,json:{read:!1}})],E.prototype,"isAllTime",null);t.__decorate([A.property({readOnly:!0,json:{read:!1}})],E.prototype,"isEmpty",null);t.__decorate([A.property({type:Date,json:{write:{allowNull:!0}}})],E.prototype,"start",void 0);t.__decorate([h.reader("start")],E.prototype,"readStart",null);t.__decorate([l.writer("start")],E.prototype,"writeStart",null);E=m=t.__decorate([d.subclass("esri.TimeExtent")],E);const r=new E,k=new E({start:void 0,end:void 0});return E})},
"esri/core/timeUtils":function(){define(["exports","./has"],function(v,t){function E(A,x,e){return 0===A?0:A*B[x]/B[e]}const B={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},u={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",
multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};v.convertTime=E;v.makeUTCTime=function(A,x,e="milliseconds"){x=new Date(E(x,e,"milliseconds"));x.setUTCFullYear(A.getUTCFullYear(),
A.getUTCMonth(),A.getUTCDate());return x};v.offsetDate=function(A,x,e){A=new Date(A.getTime());if(x&&e){const {getter:d,setter:l,multiplier:m}=u[e];if("months"===e){e=A.getFullYear();var h=A.getMonth()+x;e=new Date(e,h+1,1);e.setDate(0);e=e.getDate();A.getDate()>e&&A.setDate(e)}A[l](A[d]()+x*m)}return A};v.offsetDateUTC=function(A,x,e="milliseconds"){A=A.getTime();x=E(x,e,"milliseconds");return new Date(A+x)};v.resetUTCDate=function(A,x){A=new Date(A.getTime());A.setUTCFullYear(x.getFullYear(),x.getMonth(),
x.getDate());return A};v.timeSinceUTCMidnight=function(A,x="milliseconds"){const e=E(A.getUTCHours(),"hours","milliseconds"),h=E(A.getUTCMinutes(),"minutes","milliseconds"),d=E(A.getUTCSeconds(),"seconds","milliseconds");A=A.getUTCMilliseconds();return E(e+h+d+A,"milliseconds",x)};v.truncateDate=function(A,x){switch(x){case "milliseconds":return new Date(A.getTime());case "seconds":return new Date(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours(),A.getMinutes(),A.getSeconds());case "minutes":return new Date(A.getFullYear(),
A.getMonth(),A.getDate(),A.getHours(),A.getMinutes());case "hours":return new Date(A.getFullYear(),A.getMonth(),A.getDate(),A.getHours());case "days":return new Date(A.getFullYear(),A.getMonth(),A.getDate());case "weeks":return new Date(A.getFullYear(),A.getMonth(),A.getDate()-A.getDay());case "months":return new Date(A.getFullYear(),A.getMonth(),1);case "years":return new Date(A.getFullYear(),0,1);case "decades":return new Date(A.getFullYear()-A.getFullYear()%10,0,1);case "centuries":return new Date(A.getFullYear()-
A.getFullYear()%100,0,1);default:return new Date}};v.truncateLocalTime=function(A){const x=new Date(0);x.setHours(0);x.setMinutes(0);x.setSeconds(0);x.setMilliseconds(0);x.setFullYear(A.getUTCFullYear(),A.getUTCMonth(),A.getUTCDate());return x};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q){var p;const z=new u.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});u=new u.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});A=p=function(w){function y(H){H=w.call(this,H)||this;H.aggregateIds=null;H.cacheHint=void 0;H.compactGeometryEnabled=!1;H.datumTransformation=null;H.defaultSpatialReferenceEnabled=!1;H.distance=void 0;H.dynamicDataSource=void 0;H.formatOf3DObjects=null;H.fullText=null;H.gdbVersion=null;H.geometry=null;H.geometryPrecision=void 0;H.groupByFieldsForStatistics=
null;H.having=null;H.historicMoment=null;H.maxAllowableOffset=void 0;H.maxRecordCountFactor=1;H.multipatchOption=null;H.num=void 0;H.objectIds=null;H.orderByFields=null;H.outFields=null;H.outSpatialReference=null;H.outStatistics=null;H.parameterValues=null;H.pixelSize=null;H.quantizationParameters=null;H.rangeValues=null;H.relationParameter=null;H.resultType=null;H.returnCentroid=!1;H.returnDistinctValues=!1;H.returnExceededLimitFeatures=!0;H.returnGeometry=!1;H.returnQueryGeometry=!1;H.returnM=void 0;
H.returnZ=void 0;H.sourceSpatialReference=null;H.spatialRelationship="intersects";H.start=void 0;H.sqlFormat=null;H.text=null;H.timeExtent=null;H.timeReferenceUnknownClient=!1;H.units=null;H.where=null;return H}v._inheritsLoose(y,w);y.from=function(H){return k.ensureClass(p,H)};var G=y.prototype;G.castDatumTransformation=function(H){return"number"===typeof H||"object"===typeof H?H:null};G.writeHistoricMoment=function(H,I){I.historicMoment=H&&H.getTime()};G.writeParameterValues=function(H,I){if(H){const D=
{};for(const C in H){const F=H[C];Array.isArray(F)?D[C]=F.map(K=>K instanceof Date?K.getTime():K):D[C]=F instanceof Date?F.getTime():F}I.parameterValues=D}};G.writeStart=function(H,I){I.resultOffset=this.start;I.resultRecordCount=this.num||10;I.where="1\x3d1"};G.writeWhere=function(H,I){I.where=H||"1\x3d1"};G.clone=function(){return new p(x.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,
defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:e.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,
num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,
returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return y}(A.JSONSupport);A.MAX_MAX_RECORD_COUNT_FACTOR=
5;t.__decorate([h.property({json:{write:!0}})],A.prototype,"aggregateIds",void 0);t.__decorate([h.property({type:Boolean,json:{write:!0}})],A.prototype,"cacheHint",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"compactGeometryEnabled",void 0);t.__decorate([h.property({json:{write:!0}})],A.prototype,"datumTransformation",void 0);t.__decorate([d.cast("datumTransformation")],A.prototype,"castDatumTransformation",null);t.__decorate([h.property({type:Boolean,
json:{default:!1,write:!0}})],A.prototype,"defaultSpatialReferenceEnabled",void 0);t.__decorate([h.property({type:Number,json:{write:{overridePolicy(w){return{enabled:0<w}}}}})],A.prototype,"distance",void 0);t.__decorate([h.property({type:b.DataLayerSource,json:{write:!0}})],A.prototype,"dynamicDataSource",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],A.prototype,"formatOf3DObjects",void 0);t.__decorate([h.property({type:[a],json:{write:{enabled:!0,overridePolicy(){return{enabled:e.isSome(this.fullText)&&
0<this.fullText.length}}}}})],A.prototype,"fullText",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],A.prototype,"gdbVersion",void 0);t.__decorate([h.property({types:E.geometryTypes,json:{read:c.fromJSON,write:!0}})],A.prototype,"geometry",void 0);t.__decorate([h.property({type:Number,json:{write:!0}})],A.prototype,"geometryPrecision",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],A.prototype,"groupByFieldsForStatistics",void 0);t.__decorate([h.property({type:String,
json:{write:!0}})],A.prototype,"having",void 0);t.__decorate([h.property({type:Date})],A.prototype,"historicMoment",void 0);t.__decorate([r.writer("historicMoment")],A.prototype,"writeHistoricMoment",null);t.__decorate([h.property({type:Number,json:{write:!0}})],A.prototype,"maxAllowableOffset",void 0);t.__decorate([h.property({type:Number,cast(w){return 1>w?1:w>p.MAX_MAX_RECORD_COUNT_FACTOR?p.MAX_MAX_RECORD_COUNT_FACTOR:w},json:{write:{overridePolicy(w){return{enabled:1<w}}}}})],A.prototype,"maxRecordCountFactor",
void 0);t.__decorate([h.property({type:["xyFootprint"],json:{write:!0}})],A.prototype,"multipatchOption",void 0);t.__decorate([h.property({type:Number,json:{read:{source:"resultRecordCount"}}})],A.prototype,"num",void 0);t.__decorate([h.property({json:{write:!0}})],A.prototype,"objectIds",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],A.prototype,"orderByFields",void 0);t.__decorate([h.property({type:[String],json:{write:!0}})],A.prototype,"outFields",void 0);t.__decorate([h.property({type:f,
json:{name:"outSR",write:!0}})],A.prototype,"outSpatialReference",void 0);t.__decorate([h.property({type:[n],json:{write:{enabled:!0,overridePolicy(){return{enabled:e.isSome(this.outStatistics)&&0<this.outStatistics.length}}}}})],A.prototype,"outStatistics",void 0);t.__decorate([h.property({json:{write:!0}})],A.prototype,"parameterValues",void 0);t.__decorate([r.writer("parameterValues")],A.prototype,"writeParameterValues",null);t.__decorate([h.property({type:q,json:{write:!0}})],A.prototype,"pixelSize",
void 0);t.__decorate([h.property({type:g,json:{write:!0}})],A.prototype,"quantizationParameters",void 0);t.__decorate([h.property({type:[Object],json:{write:!0}})],A.prototype,"rangeValues",void 0);t.__decorate([h.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],A.prototype,"relationParameter",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],A.prototype,"resultType",
void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnCentroid",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnDistinctValues",void 0);t.__decorate([h.property({type:Boolean,json:{default:!0,write:!0}})],A.prototype,"returnExceededLimitFeatures",void 0);t.__decorate([h.property({type:Boolean,json:{write:!0}})],A.prototype,"returnGeometry",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],
A.prototype,"returnQueryGeometry",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnM",void 0);t.__decorate([h.property({type:Boolean,json:{write:{overridePolicy(w){return{enabled:w}}}}})],A.prototype,"returnZ",void 0);t.__decorate([h.property({type:f,json:{write:!0}})],A.prototype,"sourceSpatialReference",void 0);t.__decorate([l.enumeration(z,{ignoreUnknown:!1,name:"spatialRel"})],A.prototype,"spatialRelationship",void 0);t.__decorate([h.property({type:Number,
json:{read:{source:"resultOffset"}}})],A.prototype,"start",void 0);t.__decorate([r.writer("start"),r.writer("num")],A.prototype,"writeStart",null);t.__decorate([h.property({type:String,json:{write:!0}})],A.prototype,"sqlFormat",void 0);t.__decorate([h.property({type:String,json:{write:!0}})],A.prototype,"text",void 0);t.__decorate([h.property({type:B,json:{write:!0}})],A.prototype,"timeExtent",void 0);t.__decorate([h.property({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"timeReferenceUnknownClient",
void 0);t.__decorate([l.enumeration(u,{ignoreUnknown:!1}),h.property({json:{write:{overridePolicy(w){return{enabled:!!w&&null!=this.distance&&0<this.distance}}}}})],A.prototype,"units",void 0);t.__decorate([h.property({type:String,json:{write:{overridePolicy(w){return{enabled:null!=w||null!=this.start&&0<this.start}}}}})],A.prototype,"where",void 0);t.__decorate([r.writer("where")],A.prototype,"writeWhere",null);return A=p=t.__decorate([m.subclass("esri.rest.support.Query")],A)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g){function n(){z||(z=r.createTypeReader({types:f()}));return z}function f(){w||(w={key:"type",base:null,typeMap:{"data-layer":v.DataLayerSource,"map-layer":c.MapLayerSource}});return w}var q,p;B=B.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});v.JoinTableDataSource=q=function(y){function G(I){I=y.call(this,I)||this;I.type="join-table";return I}t._inheritsLoose(G,y);var H=G.prototype;H.readLeftTableSource=function(I,D,
C){return n()(I,D,C)};H.castLeftTableSource=function(I){return m.ensureOneOfType(f(),I)};H.readRightTableSource=function(I,D,C){return n()(I,D,C)};H.castRightTableSource=function(I){return m.ensureOneOfType(f(),I)};H.clone=function(){const {leftTableKey:I,rightTableKey:D,leftTableSource:C,rightTableSource:F,joinType:K}=this,J={leftTableKey:I,rightTableKey:D,leftTableSource:C?.clone()??void 0,rightTableSource:F?.clone()??void 0,joinType:K};return new q(J)};return G}(u.JSONSupport);E.__decorate([h.enumeration({joinTable:"join-table"})],
v.JoinTableDataSource.prototype,"type",void 0);E.__decorate([A.property({type:String,json:{write:!0}})],v.JoinTableDataSource.prototype,"leftTableKey",void 0);E.__decorate([A.property({type:String,json:{write:!0}})],v.JoinTableDataSource.prototype,"rightTableKey",void 0);E.__decorate([A.property({json:{write:!0}})],v.JoinTableDataSource.prototype,"leftTableSource",void 0);E.__decorate([d.reader("leftTableSource")],v.JoinTableDataSource.prototype,"readLeftTableSource",null);E.__decorate([e.cast("leftTableSource")],
v.JoinTableDataSource.prototype,"castLeftTableSource",null);E.__decorate([A.property({json:{write:!0}})],v.JoinTableDataSource.prototype,"rightTableSource",void 0);E.__decorate([d.reader("rightTableSource")],v.JoinTableDataSource.prototype,"readRightTableSource",null);E.__decorate([e.cast("rightTableSource")],v.JoinTableDataSource.prototype,"castRightTableSource",null);E.__decorate([h.enumeration(B)],v.JoinTableDataSource.prototype,"joinType",void 0);v.JoinTableDataSource=q=E.__decorate([l.subclass("esri.layers.support.source.JoinTableDataSource")],
v.JoinTableDataSource);let z=null,w=null;e={key:"type",base:null,typeMap:{"join-table":v.JoinTableDataSource,"query-table":b.QueryTableDataSource,raster:a.RasterDataSource,table:g.TableDataSource}};v.DataLayerSource=p=function(y){function G(H){H=y.call(this,H)||this;H.type="data-layer";return H}t._inheritsLoose(G,y);G.prototype.clone=function(){const {fields:H,dataSource:I}=this;return new p({fields:H,dataSource:I})};return G}(u.JSONSupport);E.__decorate([h.enumeration({dataLayer:"data-layer"})],
v.DataLayerSource.prototype,"type",void 0);E.__decorate([A.property({type:[k],json:{write:!0}})],v.DataLayerSource.prototype,"fields",void 0);E.__decorate([A.property({types:e,json:{write:!0}})],v.DataLayerSource.prototype,"dataSource",void 0);v.DataLayerSource=p=E.__decorate([l.subclass("esri.layers.support.source.DataLayerSource")],v.DataLayerSource);v.DataLayerSource.from=m.ensureType(v.DataLayerSource);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),function(v,t,E,B,u,A,x,e,h,d,l,m){var r;const k=new E.JSONMap({binary:"binary",
coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});E=r=function(c){function b(g){g=c.call(this,g)||this;g.alias=null;g.defaultValue=void 0;g.description=null;g.domain=null;g.editable=
!0;g.length=-1;g.name=null;g.nullable=!0;g.type=null;g.valueType=null;g.visible=!0;return g}v._inheritsLoose(b,c);var a=b.prototype;a.readDescription=function(g,{description:n}){g=null;try{g=n?JSON.parse(n):null}catch(f){}return g?.value??null};a.readValueType=function(g,{description:n}){g=null;try{g=n?JSON.parse(n):null}catch(f){}return g?k.fromJSON(g.fieldValueType):null};a.clone=function(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&
this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})};return b}(B.JSONSupport);t.__decorate([u.property({type:String,json:{write:!0}})],E.prototype,"alias",void 0);t.__decorate([u.property({type:[String,Number],json:{write:{allowNull:!0}}})],E.prototype,"defaultValue",void 0);t.__decorate([u.property()],E.prototype,"description",void 0);t.__decorate([h.reader("description")],E.prototype,
"readDescription",null);t.__decorate([u.property({types:l.types,json:{read:{reader:l.fromJSON},write:!0}})],E.prototype,"domain",void 0);t.__decorate([u.property({type:Boolean,json:{write:!0}})],E.prototype,"editable",void 0);t.__decorate([u.property({type:x.Integer,json:{write:!0}})],E.prototype,"length",void 0);t.__decorate([u.property({type:String,json:{write:!0}})],E.prototype,"name",void 0);t.__decorate([u.property({type:Boolean,json:{write:!0}})],E.prototype,"nullable",void 0);t.__decorate([e.enumeration(m.kebabDict)],
E.prototype,"type",void 0);t.__decorate([u.property()],E.prototype,"valueType",void 0);t.__decorate([h.reader("valueType",["description"])],E.prototype,"readValueType",null);t.__decorate([u.property({type:Boolean,json:{read:!1}})],E.prototype,"visible",void 0);return E=r=t.__decorate([d.subclass("esri.layers.support.Field")],E)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(v,t,E,B,u,A){t=
{key:"type",base:B,typeMap:{range:A,"coded-value":E,inherited:u}};v.CodedValueDomain=E;v.DomainBase=B;v.InheritedDomain=u;v.RangeDomain=A;v.fromJSON=function(x){if(!x||!x.type)return null;switch(x.type){case "range":return A.fromJSON(x);case "codedValue":return E.fromJSON(x);case "inherited":return u.fromJSON(x)}return null};v.types=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(v,t,E,B,u,A,x,e,h){var d;u=d=function(l){function m(k){k=l.call(this,k)||this;k.codedValues=null;k.type="coded-value";return k}v._inheritsLoose(m,l);var r=m.prototype;r.getName=function(k){let c=null;if(this.codedValues){const b=String(k);this.codedValues.some(a=>{String(a.code)===b&&(c=a.name);return!!c})}return c};r.clone=function(){return new d({codedValues:E.clone(this.codedValues),name:this.name})};return m}(h);t.__decorate([B.property({type:[e.CodedValue],json:{write:!0}})],u.prototype,
"codedValues",void 0);t.__decorate([A.enumeration({codedValue:"coded-value"})],u.prototype,"type",void 0);return u=d=t.__decorate([x.subclass("esri.layers.support.CodedValueDomain")],u)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(v,
t,E,B,u,A,x,e){var h;v.CodedValue=h=function(d){function l(m){m=d.call(this,m)||this;m.name=null;m.code=null;return m}t._inheritsLoose(l,d);l.prototype.clone=function(){return new h({name:this.name,code:this.code})};return l}(B.JSONSupport);E.__decorate([u.property({type:String,json:{write:!0}})],v.CodedValue.prototype,"name",void 0);E.__decorate([u.property({type:[String,Number],json:{write:!0}})],v.CodedValue.prototype,"code",void 0);v.CodedValue=h=E.__decorate([e.subclass("esri.layers.support.CodedValue")],
v.CodedValue);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(v,t,E,B,u,A,x,e,h){E=
new E.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});B=function(d){function l(m){m=d.call(this,m)||this;m.name=null;m.type=null;return m}v._inheritsLoose(l,d);return l}(B.JSONSupport);t.__decorate([u.property({type:String,json:{write:!0}})],B.prototype,"name",void 0);t.__decorate([e.enumeration(E)],B.prototype,"type",void 0);return B=t.__decorate([h.subclass("esri.layers.support.Domain")],B)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/Error ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(v,t,E,B,u,A,x,e,h,d){var l;E=l=function(m){function r(k){k=m.call(this,k)||this;k.type="inherited";return k}v._inheritsLoose(r,m);r.prototype.clone=function(){return new l};return r}(d);t.__decorate([e.enumeration({inherited:"inherited"})],E.prototype,"type",void 0);return E=l=t.__decorate([h.subclass("esri.layers.support.InheritedDomain")],E)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(v,t,E,B,u,A,x,e){var h;B=h=function(d){function l(m){m=d.call(this,m)||this;m.maxValue=null;m.minValue=null;m.type="range";return m}v._inheritsLoose(l,d);l.prototype.clone=function(){return new h({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return l}(e);t.__decorate([E.property({type:Number,json:{type:[Number],read:{source:"range",reader(d,l){return l.range&&l.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",
writer(d,l,m){l[m]=[this.minValue||0,d]}}}})],B.prototype,"maxValue",void 0);t.__decorate([E.property({type:Number,json:{type:[Number],read:{source:"range",reader(d,l){return l.range&&l.range[0]}},write:{target:"range",writer(d,l,m){l[m]=[d,this.maxValue||0]}}}})],B.prototype,"minValue",void 0);t.__decorate([A.enumeration({range:"range"})],B.prototype,"type",void 0);return B=h=t.__decorate([x.subclass("esri.layers.support.RangeDomain")],B)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e,h){var d;v.MapLayerSource=d=function(l){function m(r){r=l.call(this,r)||this;r.type="map-layer";return r}t._inheritsLoose(m,l);m.prototype.clone=function(){const {mapLayerId:r,gdbVersion:k}=this;return new d({mapLayerId:r,gdbVersion:k})};return m}(B.JSONSupport);E.__decorate([e.enumeration({mapLayer:"map-layer"})],v.MapLayerSource.prototype,"type",void 0);E.__decorate([u.property({type:x.Integer,json:{write:!0}})],v.MapLayerSource.prototype,"mapLayerId",void 0);E.__decorate([u.property({type:String,
json:{write:!0}})],v.MapLayerSource.prototype,"gdbVersion",void 0);v.MapLayerSource=d=E.__decorate([h.subclass("esri.layers.support.source.MapLayerSource")],v.MapLayerSource);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m){var r;v.QueryTableDataSource=r=function(k){function c(b){b=k.call(this,b)||this;b.type="query-table";return b}t._inheritsLoose(c,k);c.prototype.clone=function(){const {workspaceId:b,query:a,oidFields:g,spatialReference:n,geometryType:f}=this,q={workspaceId:b,query:a,oidFields:g,spatialReference:n?.clone()??void 0,geometryType:f};return new r(q)};return c}(u.JSONSupport);E.__decorate([h.enumeration({queryTable:"query-table"})],v.QueryTableDataSource.prototype,"type",
void 0);E.__decorate([A.property({type:String,json:{write:!0}})],v.QueryTableDataSource.prototype,"workspaceId",void 0);E.__decorate([A.property({type:String,json:{write:!0}})],v.QueryTableDataSource.prototype,"query",void 0);E.__decorate([A.property({type:String,json:{write:!0}})],v.QueryTableDataSource.prototype,"oidFields",void 0);E.__decorate([A.property({type:l,json:{write:!0}})],v.QueryTableDataSource.prototype,"spatialReference",void 0);E.__decorate([h.enumeration(m.featureGeometryTypeKebabDictionary)],
v.QueryTableDataSource.prototype,"geometryType",void 0);v.QueryTableDataSource=r=E.__decorate([d.subclass("esri.layers.support.source.QueryTableDataSource")],v.QueryTableDataSource);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e,h){var d;v.RasterDataSource=d=function(l){function m(r){r=l.call(this,r)||this;r.type="raster";return r}t._inheritsLoose(m,l);m.prototype.clone=function(){const {workspaceId:r,dataSourceName:k}=this;return new d({workspaceId:r,dataSourceName:k})};return m}(B.JSONSupport);E.__decorate([e.enumeration({raster:"raster"})],v.RasterDataSource.prototype,"type",void 0);E.__decorate([u.property({type:String,json:{write:!0}})],v.RasterDataSource.prototype,"dataSourceName",void 0);E.__decorate([u.property({type:String,
json:{write:!0}})],v.RasterDataSource.prototype,"workspaceId",void 0);v.RasterDataSource=d=E.__decorate([h.subclass("esri.layers.support.source.RasterDataSource")],v.RasterDataSource);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e,h){var d;v.TableDataSource=d=function(l){function m(r){r=l.call(this,r)||this;r.type="table";return r}t._inheritsLoose(m,l);m.prototype.clone=function(){const {workspaceId:r,gdbVersion:k,dataSourceName:c}=this;return new d({workspaceId:r,gdbVersion:k,dataSourceName:c})};return m}(B.JSONSupport);E.__decorate([e.enumeration({table:"table"})],v.TableDataSource.prototype,"type",void 0);E.__decorate([u.property({type:String,json:{write:!0}})],v.TableDataSource.prototype,"workspaceId",
void 0);E.__decorate([u.property({type:String,json:{write:!0}})],v.TableDataSource.prototype,"gdbVersion",void 0);E.__decorate([u.property({type:String,json:{write:!0}})],v.TableDataSource.prototype,"dataSourceName",void 0);v.TableDataSource=d=E.__decorate([h.subclass("esri.layers.support.source.TableDataSource")],v.TableDataSource);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e,h){E=function(d){function l(m){m=d.call(this,m)||this;m.onFields=null;m.operator=null;m.searchTerm=null;m.searchType=null;return m}v._inheritsLoose(l,d);return l}(E.ClonableMixin(B.JSONSupport));t.__decorate([A.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:u.isSome(this.onFields)&&0<this.onFields.length}}}}})],E.prototype,"onFields",void 0);t.__decorate([A.property({type:String,json:{write:!0}})],E.prototype,"operator",void 0);t.__decorate([A.property({type:String,
json:{write:!0}})],E.prototype,"searchTerm",void 0);t.__decorate([A.property({type:String,json:{write:!0}})],E.prototype,"searchType",void 0);return E=t.__decorate([h.subclass("esri.rest.support.FullTextSearch")],E)})},"esri/core/Clonable":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(v,t,E,B,u,A,x,e,h,d,l){u=
m=>{m=function(r){function k(){return r.apply(this,arguments)||this}t._inheritsLoose(k,r);k.prototype.clone=function(){var c=e.unwrapOrThrow(d.getProperties(this),"unable to clone instance of non-accessor class"),b=c.metadatas;const a=c.store,g={};c=new Map;for(var n in b){var f=b[n];const q=a?.originOf(n),p=f.clonable;if(f.readOnly||!1===p||q!==h.OriginId.USER&&q!==h.OriginId.DEFAULTS&&q!==h.OriginId.WEB_MAP&&q!==h.OriginId.WEB_SCENE)continue;f=this[n];let z=null;z="function"===typeof p?p(f):"reference"===
p?f:A.tryClone(f);if(null==f||null!=z)q===h.OriginId.DEFAULTS?c.set(n,z):g[n]=z}b=new (Object.getPrototypeOf(this).constructor)(g);if(c.size&&(n=d.getProperties(b)?.store))for(const [q,p]of c)n.set(q,p,h.OriginId.DEFAULTS);return b};return k}(m);return m=E.__decorate([l.subclass("esri.core.Clonable")],m)};v.Clonable=function(m){function r(){return m.apply(this,arguments)||this}t._inheritsLoose(r,m);return r}(u(B));v.Clonable=E.__decorate([l.subclass("esri.core.Clonable")],v.Clonable);v.ClonableMixin=
u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),function(v,t,E,B,u,A,x,e,h,d){var l;E=new B.JSONMap({upperLeft:"upper-left",
lowerLeft:"lower-left"});u=l=function(m){function r(k){k=m.call(this,k)||this;k.extent=null;k.mode="view";k.originPosition="upper-left";k.tolerance=1;return k}v._inheritsLoose(r,m);r.prototype.clone=function(){return new l(A.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return r}(u.JSONSupport);t.__decorate([x.property({type:d,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],u.prototype,"extent",void 0);t.__decorate([x.property({type:["view",
"edit"],json:{write:!0}})],u.prototype,"mode",void 0);t.__decorate([x.property({type:String,json:{read:E.read,write:E.write}})],u.prototype,"originPosition",void 0);t.__decorate([x.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],u.prototype,"tolerance",void 0);return u=l=t.__decorate([h.subclass("esri.rest.support.QuantizationParameters")],u)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(v,t,E,B,u,A,x,e,h){var d;E=new E.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});B=d=function(l){function m(k){k=l.call(this,k)||this;k.maxPointCount=void 0;k.maxRecordCount=void 0;k.maxVertexCount=void 0;k.onStatisticField=
null;k.outStatisticFieldName=null;k.statisticType=null;k.statisticParameters=null;return k}v._inheritsLoose(m,l);var r=m.prototype;r.writeStatisticParameters=function(k,c){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)c.statisticParameters=u.clone(k)};r.clone=function(){return new d({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,
statisticType:this.statisticType,statisticParameters:u.clone(this.statisticParameters)})};return m}(B.JSONSupport);t.__decorate([A.property({type:Number,json:{write:!0}})],B.prototype,"maxPointCount",void 0);t.__decorate([A.property({type:Number,json:{write:!0}})],B.prototype,"maxRecordCount",void 0);t.__decorate([A.property({type:Number,json:{write:!0}})],B.prototype,"maxVertexCount",void 0);t.__decorate([A.property({type:String,json:{write:!0}})],B.prototype,"onStatisticField",void 0);t.__decorate([A.property({type:String,
json:{write:!0}})],B.prototype,"outStatisticFieldName",void 0);t.__decorate([A.property({type:String,json:{read:{source:"statisticType",reader:E.read},write:{target:"statisticType",writer:E.write}}})],B.prototype,"statisticType",void 0);t.__decorate([A.property({type:Object})],B.prototype,"statisticParameters",void 0);t.__decorate([h.writer("statisticParameters")],B.prototype,"writeStatisticParameters",null);return B=d=t.__decorate([e.subclass("esri.rest.support.StatisticDefinition")],B)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/has ../../../../../core/maybe ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(v,t,E,B,u,A,x){let e=function(){function h(l,m){this.requests={done:[],stream:new E(10)};this._edits=null;this._abortController=new AbortController;this._version=0;this.didSend=this._done=!1;this.tile=l;this._version=m}var d=h.prototype;d.end=function(){this._done=!0};d.clear=function(){this.requests.done=[]};d.applyUpdate=function(l){this.requests.done.forEach(m=>m.message.status.unset(l));this._version=l.version;u.isSome(this._edits)&&this._edits.status.unset(l)};d.add=function(l){l.message.status=
l.message.status??x.UpdateToken.empty();l.message.status.version=this._version;B("esri-2d-update-debug")&&console.debug(this.tile.id,"DataTileSubscription:add",this._version);l.message.end&&this.requests.done.forEach(m=>{u.isSome(m.message)&&m.message.end&&(m.message.end=!1)});this.requests.done.push(l)};d.edit=function(l,m){const r=l.getQuantizationTransform(),k=l.fullSchema(),c=Array.from(l.features()),b=c.map(a=>a.objectId);m=[...m,...b];this.removeIds(m);this._invalidate();u.isNone(this._edits)?
this._edits={type:"append",addOrUpdate:A.FeatureSetReaderJSON.fromOptimizedFeatures(c,k,u.unwrap(r)),id:this.tile.id,status:x.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(a=>a.message.end=!1),u.unwrap(this._edits.addOrUpdate).append(l.features()))};d.readers=function*(){for(const {message:l}of this.requests.done)u.isSome(l.addOrUpdate)&&(yield l.addOrUpdate);u.isSome(this._edits)&&u.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};d._invalidate=function(){for(const l of this.requests.done)l.message.status=
x.UpdateToken.empty();u.isSome(this._edits)&&(this._edits.status=x.UpdateToken.empty())};d.removeIds=function(l){this._invalidate();for(const {message:m}of this.requests.done){const r=m.addOrUpdate;u.isSome(r)&&(r.removeIds(l),r.isEmpty&&(m.addOrUpdate=null))}u.isSome(this._edits)&&u.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(l);this.requests.done=this.requests.done.filter(m=>m.message.addOrUpdate||m.message.end)};d.abort=function(){this._abortController.abort()};t._createClass(h,
[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length}},{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._done}}]);return h}();v.DataTileSubscription=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports"],
function(v){let t=function(){function E(){this.version=0;this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}E.create=function(u){const A=new E;for(const x in u){const e=u[x];if("object"===typeof e)for(const h in e)A[x][h]=e[h];A[x]=e}return A};E.empty=function(){return E.create({})};E.all=function(){return E.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})};var B=
E.prototype;B.unset=function(u){this.version=u.version;u.source&&(this.source=!1);u.targets.feature&&(this.targets.feature=!1);u.targets.aggregate&&(this.targets.aggregate=!1);u.storage.filters&&(this.storage.filters=!1);u.storage.data&&(this.storage.data=!1);u.mesh&&(this.mesh=!1);u.queryFilter&&(this.queryFilter=!1)};B.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter};B.describe=function(){let u=
0,A="";if(this.mesh){u+=20;A+="-\x3e (20) Mesh needs update\n";for(const x of this.why.mesh)A+=`    + ${x}\n`}if(this.source){u+=10;A+="-\x3e (10) The source needs update\n";for(const x of this.why.source)A+=`    + ${x}\n`}this.targets.feature&&(u+=5,A+="-\x3e (5) Feature target parameters changed\n");this.storage.filters&&(u+=5,A+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(u+=4,A+="-\x3e (4) Aggregate target parameters changed\n");this.storage.data&&(u+=1,A+="-\x3e (1) Texture storage parameters changed");
console.debug(`Applying ${5>u?"Fastest":10>u?"Fast":15>u?"Moderate":20>u?"Slow":"Very Slow"} update of cost ${u}/45 `);console.debug(A)};B.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};return E}();v.UpdateToken=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(v,t,E,B,u,A){let x=function(h,d){this.item=h;this.controller=d;this.promise=null},e=function(){function h(l){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;l.concurrency&&(this.concurrency=l.concurrency);this._queue=new u(l.peeker);this.process=l.process;const m=l.scheduler;l.priority&&E.isSome(m)&&(this._task=m.registerTask(l.priority,this))}var d=h.prototype;d.destroy=function(){this.clear();
this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};d.abort=function(l){(l=this._controllers.get(l))&&l.abort()};d.clear=function(){this._queue.clear();const l=[];this._controllers.forEach(m=>l.push(m));this._controllers.clear();l.forEach(m=>m.abort());this._processingItems.clear();this._cancelNext()};d.forEach=function(l){this._deferreds.forEach((m,r)=>l(r))};d.get=function(l){return(l=this._deferreds.get(l))?l.promise:void 0};d.isOngoing=
function(l){return this._processingItems.has(l)};d.has=function(l){return this._deferreds.has(l)};d.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};d.push=function(l,m){const r=this.get(l);if(r)return r;const k=new AbortController;let c=null;m&&(c=B.onAbort(m,()=>k.abort()));const b=()=>{a.remove();E.isSome(c)&&c.remove();this._deferreds.delete(l);this._controllers.delete(l);this._queue.remove(l);this._processingItems.delete(l);this._scheduleNext()},a=B.onAbortOrThrow(k.signal,
()=>{const n=this._processingItems.get(l);n&&n.controller.abort();b();g.reject(B.createAbortError())}),g=B.createDeferred();this._deferreds.set(l,g);this._controllers.set(l,k);g.promise.then(b,b);this._queue.push(l);this._scheduleNext();return g.promise};d.last=function(){return this._queue.last()};d.peek=function(){return this._queue.peek()};d.popLast=function(){return this._queue.popLast()};d.reset=function(){const l=[];this._processingItems.forEach(m=>l.push(m));this._processingItems.clear();for(const m of l)this._queue.push(m.item),
m.controller.abort();this._scheduleNext()};d.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};d.takeAll=function(){const l=[];for(;this._queue.length;)l.push(this._queue.pop());this.clear();return l};d.runTask=function(l){for(;!l.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),l.madeProgress()};d._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=A.schedule(()=>{this._schedule=null;
this._next()}))};d._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};d._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};d._processResult=function(l,m){this._canProcessFulfillment(l)&&(this._scheduleNext(),this._deferreds.get(l.item).resolve(m))};d._processError=function(l,m){this._canProcessFulfillment(l)&&(this._scheduleNext(),this._deferreds.get(l.item).reject(m))};d._canProcessFulfillment=
function(l){return this._deferreds.get(l.item)&&this._processingItems.get(l.item)===l?!0:!1};d._process=function(l){if(!E.isNone(l)){var m=new AbortController,r=new x(l,m);this._processingItems.set(l,r);try{var k=this.process(l,m.signal)}catch(c){this._processError(r,c)}B.isPromiseLike(k)?(r.promise=k,k.then(c=>this._processResult(r,c),c=>this._processError(r,c))):this._processResult(r,k)}};t._createClass(h,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",
get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:l=>this.runTask(l)}}}]);return h}();v.QueueProcessor=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/GeoEventSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){function k(g,n){const f=g.weakClone();if(B.isSome(g.geometry)){const q=x.quantizeX(n,g.geometry.coords[0]);g=x.quantizeY(n,g.geometry.coords[1]);f.geometry=new e([],[q,g])}return f}function c(g){switch(g){case "esriGeometryPoint":return k;default:return(n,f)=>{const q=n.weakClone(),p=new e;n=x.quantizeOptimizedGeometry(p,n.geometry,!1,!1,g,f,!1,!1);q.geometry=n;return q}}}function b(g){switch(g){case "esriGeometryPoint":return n=>B.isSome(n.geometry)?{minX:n.geometry.coords[0],
minY:n.geometry.coords[1],maxX:n.geometry.coords[0],maxY:n.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return n=>{let f=Infinity,q=Infinity,p=-Infinity,z=-Infinity;B.isSome(n.geometry)&&n.geometry.forEachVertex((w,y)=>{f=Math.min(f,w);q=Math.min(q,y);p=Math.max(p,w);z=Math.max(z,y)});return{minX:f,minY:q,maxX:p,maxY:z}}}}let a=function(){function g(f,q){this.onUpdate=f;this._geometryType=q;this._objectIdToFeature=new Map}var n=g.prototype;n.add=function(f){this._objectIdToFeature.set(f.objectId,
f);this._index=null};n.get=function(f){return this._objectIdToFeature.has(f)?this._objectIdToFeature.get(f):null};n.forEach=function(f){this._objectIdToFeature.forEach(f)};n.search=function(f){if(!this._index){var q=this._features;const p=A.rbush(9,b(this._geometryType));p.load(q);this._index=p}return this._index.search({minX:f.bounds[0],minY:f.bounds[1],maxX:f.bounds[2],maxY:f.bounds[3]})};n.removeById=function(f){const q=this._objectIdToFeature.get(f);return q?(this._objectIdToFeature.delete(f),
this._index=null,q):null};n.update=function(f,q){this.onUpdate(f,q)};t._createClass(g,[{key:"_features",get:function(){const f=[];this._objectIdToFeature.forEach(q=>f.push(q));return f}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return g}();E=function(g){function n(q){var p=g.call(this,q)||this;p.type="geoevent";p._dataReceiveEventEnabled=!1;p._level=0;p._updateInfo={websocket:0,client:0};p._inUpdate=!1;const {outSR:z}=q,{geometryType:w,objectIdField:y,timeInfo:G,purgeOptions:H,
source:I,spatialReference:D,serviceFilter:C,maxReconnectionAttempts:F,maxReconnectionInterval:K,updateInterval:J,enableDataReceived:P,customParameters:S}=q.serviceInfo,X=new a(p._onUpdate.bind(t._assertThisInitialized(p)),w),ha=new h.StreamFeatureManager(X,y,G,H),U=d.createConnection(I,D,z,w,C,F,K,S);p._store=X;p._manager=ha;p._connection=U;p._quantize=c(w);p._dataReceiveEventEnabled=P;p._handles=[p._connection.on("data-received",Q=>p._onFeature(Q)),u.watch(()=>U.connectionStatus,Q=>p.events.emit("connectionStatus",
Q)),u.watch(()=>U.errorString,Q=>p.events.emit("errorString",Q))];p._initUpdateInterval=()=>{let Q=performance.now();p._updateIntervalId=setInterval(()=>{var O=performance.now(),R=O-Q;2500<R&&(Q=O,O=Math.round(p._updateInfo.client/(R/1E3)),R=Math.round(p._updateInfo.websocket/(R/1E3)),p._updateInfo.client=0,p._updateInfo.websocket=0,p.events.emit("updateRate",{client:O,websocket:R}));q.canAcceptRequest()&&!p._inUpdate&&p._manager.checkForUpdates()},J)};p._initUpdateInterval();return p}t._inheritsLoose(n,
g);var f=n.prototype;f.destroy=function(){g.prototype.destroy.call(this);this._clearUpdateInterval();this._handles.forEach(q=>q.remove());this._connection.destroy()};f._fetchDataTile=function(){};f.pauseStream=function(){this._clearUpdateInterval()};f.resumeStream=function(){this._initUpdateInterval()};f.enableEvent=function(q,p){"data-received"===q&&(this._dataReceiveEventEnabled=p)};f.subscribe=function(q,p){g.prototype.subscribe.call(this,q,p);p=this._subscriptions.get(q.id);this._level=q.level;
const z=this._getTileFeatures(q);this._onMessage({type:"append",id:q.key.id,addOrUpdate:z,end:!0});p.didSend=!0};f.unsubscribe=function(q){g.prototype.unsubscribe.call(this,q)};f.readers=function*(q){q=this._subscriptions.get(q);const {tile:p}=q;yield this._getTileFeatures(p);for(const z of q.requests.stream.entries)B.isSome(z)&&B.isSome(z.addOrUpdate)&&(yield z.addOrUpdate)};f.createTileQuery=function(q){throw Error("Service does not support tile  queries");};f.resend=function(){var q=t._asyncToGenerator(function*(){this._subscriptions.forEach(p=>
{({tile:p}=p);p={type:"append",id:p.id,addOrUpdate:this._getTileFeatures(p),end:!0};this._onMessage(p)})});return function(){return q.apply(this,arguments)}}();f._getTileFeatures=function(q){const p=this._store.search(q).map(z=>this._quantize(z,q.transform));return m.FeatureSetReaderJSON.fromOptimizedFeatures(p,this._serviceInfo,q.transform)};f._onFeature=function(q){this._updateInfo.websocket++;try{this._dataReceiveEventEnabled&&this.events.emit("data-received",q);const p=x.convertFromFeature(q,
this._serviceInfo.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(p)}catch(p){}};f._clearUpdateInterval=function(){clearInterval(this._updateIntervalId);this._updateIntervalId=0};f._onUpdate=function(){var q=t._asyncToGenerator(function*(p,z){this._inUpdate=!0;try{B.isSome(p)&&(this._updateInfo.client+=p.length);this._subscriptions.forEach((y,G)=>{y.didSend&&y.tile.level===this._level&&this._onMessage({type:"append",id:G,addOrUpdate:null,clear:!0,end:!1})});const w=[];this._subscriptions.forEach((y,
G)=>{if(y.didSend&&y.tile.level===this._level){var H=this._getTileFeatures(y.tile);G={type:"append",id:G,addOrUpdate:H,remove:[],end:!1,status:r.UpdateToken.empty()};y.requests.stream.enqueue(G);w.push(this._onMessage(G))}});yield Promise.all(w);this._subscriptions.forEach((y,G)=>{y.didSend&&y.tile.level===this._level&&this._onMessage({type:"append",id:G,addOrUpdate:null,end:!0})})}catch{}this._inUpdate=!1});return function(p,z){return q.apply(this,arguments)}}();t._createClass(n,[{key:"updating",
get:function(){return!1}}]);return n}(l.DataTileSource);v.GeoEventSource=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(v,t,E,B){let u=function(){function A(e,h,d,l,m=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=
[];this._maxAge=0;this._timeInfo=d;this._purgeOptions=l;this.store=e;this.objectIdField=h;this.purgeInterval=m;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var x=A.prototype;x.add=function(e){if(this._useGeneratedIds){var h=this._nextId();e.attributes[this.objectIdField]=h;e.objectId=h}else e.objectId=e.attributes[this.objectIdField];this._addOrUpdated.set(e.objectId,e);this._maxAge=Math.max(this._maxAge,e.attributes[this._timeInfo.startTimeField]);if(this._timeInfo.trackIdField){h=
e.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(h)){var d=B.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3;d=E.clamp(d,0,1E3);this._trackIdToObservations.set(h,new t(d))}e=this._trackIdToObservations.get(h).enqueue(e.objectId);B.isSome(e)&&(this._addOrUpdated.has(e)?this._addOrUpdated.delete(e):this._removed.push(e))}else B.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=new t(1E5)),this._trackIdLessObservations.enqueue(e.objectId)};
x.checkForUpdates=function(){const e=this._getToAdd();var h=this._getToRemove();const d=performance.now();d-this._lastPurge>=this.purgeInterval&&(this._purge(d),this._lastPurge=d);const l=[];if(B.isSome(h))for(const m of h)h=this.store.removeById(m),B.isSome(h)&&l.push(h);if(B.isSome(e))for(const m of e)m.attributes.__esri_timestamp__=d,this.store.add(m);(e||l?.length)&&this.store.update(e,l)};x._getToAdd=function(){if(!this._addOrUpdated.size)return null;const e=Array(this._addOrUpdated.size);let h=
0;this._addOrUpdated.forEach(d=>e[h++]=d);this._addOrUpdated.clear();return e};x._getToRemove=function(){const e=this._removed;if(!this._removed.length)return null;this._removed=[];return e};x._nextId=function(){const e=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return e};x._purge=function(e){const h=this._purgeOptions;B.isSome(h)&&(this._purgeSomeByDisplayCount(h),this._purgeByAge(h),this._purgeByAgeReceived(e,h),this._purgeTracks())};x._purgeSomeByDisplayCount=function(e){if(e.displayCount){var h=
this.store.size;if(h>e.displayCount){if(this._timeInfo.trackIdField)for(const d of this._trackIdToObservations.values())if(h>e.displayCount&&d.size){const l=B.unwrap(d.dequeue());this._removed.push(l);h--}if(B.isSome(this._trackIdLessObservations))for(e=h-e.displayCount;0<e--;)h=this._trackIdLessObservations.dequeue(),B.isSome(h)&&this._removed.push(h)}}};x._purgeByAge=function(e){if(e.age&&this._timeInfo?.startTimeField){var h=this._maxAge-6E4*e.age;this.store.forEach(d=>{d.attributes[this._timeInfo.startTimeField]<
h&&this._removed.push(d.objectId)})}};x._purgeByAgeReceived=function(e,h){if(h.ageReceived){var d=e-6E4*h.ageReceived;this.store.forEach(l=>{l.attributes.__esri_timestamp__<d&&this._removed.push(l.objectId)})}};x._purgeTracks=function(){this._trackIdToObservations.forEach((e,h)=>{0===e.size&&this._trackIdToObservations.delete(h)})};return A}();v.DEFAULT_STREAM_ID_FIELD="__esri_stream_id__";v.ESRI_TIMESTAMP="__esri_timestamp__";v.StreamFeatureManager=u;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection","./WebSocketConnection"],function(v,t,E){v.createConnection=function(B,u,A,x,e,h,d,l){const m=0===B.path.indexOf("wss://")||0===B.path.indexOf("ws://");B={source:B,sourceSpatialReference:u,spatialReference:A,geometryType:x,filter:e,maxReconnectionAttempts:h,maxReconnectionInterval:d,customParameters:l};return m?new E.WebSocketConnection(B):new t(B)};
Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n){const f={maxQueryDepth:5,maxRecordCountFactor:3};B=function(q){function p(w){return q.call(this,{...f,...w})||this}t._inheritsLoose(p,q);var z=p.prototype;z._open=function(){var w=t._asyncToGenerator(function*(){var y=yield this._fetchServiceDefinition(this._config.source);y.timeInfo.trackIdField||x.getLogger(this.declaredClass).warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
y=this._fetchWebSocketUrl(y.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());yield this._buddyServicesQuery;yield this._tryCreateWebSocket(y);const {filter:G,outFields:H}=this._config;this.destroyed||this._setFilter(G,H)});return function(){return w.apply(this,arguments)}}();z._onMessage=function(w){let y;try{y=this._enrich(JSON.parse(w.data)),e.isSome(this._featureZScaler)&&this._featureZScaler(y.geometry)}catch(G){x.getLogger(this.declaredClass).error(new A("geoevent-connection",
"Failed to parse message",G));return}this.onFeature(y)};z._fetchServiceDefinition=function(){var w=t._asyncToGenerator(function*(y){return this._serviceDefinition=y=(yield u(y.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data});return function(y){return w.apply(this,arguments)}}();z._fetchWebSocketUrl=function(w,y){const {urls:G,token:H}=w[0];w=this._inferWebSocketBaseUrl(G);return d.addQueryParameters(`${w}/subscribe`,{outSR:""+y.wkid,token:H})};z._inferWebSocketBaseUrl=
function(w){if(1===w.length)return w[0];for(const y of w)if(y.includes("wss"))return y;x.getLogger(this.declaredClass).error(new A("geoevent-connection","Unable to infer WebSocket url",w));return null};z._setFilter=function(){var w=t._asyncToGenerator(function*(y,G){const H=this._websocket;if(!(e.isNone(H)||e.isNone(y)&&e.isNone(G))){y=JSON.stringify({filter:this._serializeFilter(y,G)});var I=!1,D=h.createResolver();H.onmessage=C=>{C=JSON.parse(C.data);C.filter&&(C.error&&(x.getLogger(this.declaredClass).error(new A("geoevent-connection",
"Failed to set service filter",C.error)),this._set("errorString",`Could not set service filter - ${C.error}`),D.reject(C.error)),H.onmessage=this._onMessage.bind(this),I=!0,D.resolve())};H.send(y);setTimeout(()=>{I||(this.destroyed||this._websocket!==H||x.getLogger(this.declaredClass).error(new A("geoevent-connection","Server timed out when setting filter")),D.reject())},1E4);return D.promise}});return function(y,G){return w.apply(this,arguments)}}();z._serializeFilter=function(w,y){const G={};if(e.isNone(w)&&
e.isNone(y))return G;if(e.isSome(w)&&w.geometry)try{const H=g.fromJSON(w.geometry);if("extent"!==H.type)throw new A(`Expected extent but found type ${H.type}`);G.geometry=JSON.stringify(H.shiftCentralMeridian())}catch(H){x.getLogger(this.declaredClass).error(new A("geoevent-connection","Encountered an error when setting connection geometryDefinition",H))}e.isSome(w)&&w.where&&"1 \x3d 1"!==w.where&&(G.where=w.where);e.isSome(y)&&(G.outFields=y.join(","));return G};z._enrich=function(w){if(!this._relatedFeatures)return w;
const y=w.attributes[this._serviceDefinition.relatedFeatures.joinField];if(!this._relatedFeatures.has(y))return x.getLogger(this.declaredClass).warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",w),w;const {attributes:G,geometry:H}=this._relatedFeatures.get(y);for(const I in G)w.attributes[I]=G[I];H&&(w.geometry=H);w.geometry||w.centroid||x.getLogger(this.declaredClass).error(new A("geoevent-connection","Found malformed feature - no geometry found",w));return w};
z._queryBuddyServices=function(){var w=t._asyncToGenerator(function*(){try{const {relatedFeatures:y,keepLatestArchive:G}=this._serviceDefinition,H=this._queryRelatedFeatures(y),I=this._queryArchive(G);yield H;const D=yield I;if(D)for(const C of D.features)this.onFeature(this._enrich(C))}catch(y){x.getLogger(this.declaredClass).error(new A("geoevent-connection","Encountered an error when querying buddy services",{error:y}))}});return function(){return w.apply(this,arguments)}}();z._queryRelatedFeatures=
function(){var w=t._asyncToGenerator(function*(y){y&&(y=yield this._queryBuddy(y.featuresUrl),this._addRelatedFeatures(y))});return function(y){return w.apply(this,arguments)}}();z._queryArchive=function(){var w=t._asyncToGenerator(function*(y){if(y)return this._queryBuddy(y.featuresUrl)});return function(y){return w.apply(this,arguments)}}();z._queryBuddy=function(){var w=t._asyncToGenerator(function*(y){const G=new (yield new Promise((J,P)=>v(["../../../FeatureLayer"],S=>J(Object.freeze(Object.defineProperty({__proto__:null,
default:S},Symbol.toStringTag,{value:"Module"}))),P))).default({url:y});var {capabilities:H}=yield G.load();const I=H.query.supportsMaxRecordCountFactor,D=H.query.supportsPagination;H=H.query.supportsCentroid;const C=this._config.maxRecordCountFactor;var F=G.capabilities.query.maxRecordCount;F=I?F*C:F;const K=new a;K.outFields=e.unwrapOr(this._config.outFields,["*"]);K.where=e.unwrapOr(e.get(this._config.filter,"where"),"1\x3d1");K.returnGeometry=!0;K.returnExceededLimitFeatures=!0;K.outSpatialReference=
n.fromJSON(this._config.spatialReference);H&&(K.returnCentroid=!0);I&&(K.maxRecordCountFactor=C);if(D)return K.num=F,G.destroy(),this._queryPages(y,K);y=yield b.executeQuery(y,K,this._config.sourceSpatialReference);G.destroy();return y.data});return function(y){return w.apply(this,arguments)}}();z._queryPages=function(){var w=t._asyncToGenerator(function*(y,G,H=[],I=0){G.start=e.isSome(G.num)?I*G.num:null;const {data:D}=yield b.executeQuery(y,G,this._config.sourceSpatialReference);if(D.exceededTransferLimit&&
I<this._config.maxQueryDepth)return D.features.forEach(C=>H.push(C)),this._queryPages(y,G,H,I+1);H.forEach(C=>D.features.push(C));return D});return function(y,G){return w.apply(this,arguments)}}();z._addRelatedFeatures=function(w){const y=new Map;w=w.features;const G=this._serviceDefinition.relatedFeatures.joinField;for(const H of w)y.set(H.attributes[G],H);this._relatedFeatures=y};return p}(c.WebSocketConnection);return B=E.__decorate([k.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],
B)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ../../../support/StreamConnection".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k){var c;(function(b){b[b.CONNECTING=0]="CONNECTING";b[b.OPEN=1]="OPEN";b[b.CLOSING=2]="CLOSING";b[b.CLOSED=3]="CLOSED"})(c||(c={}));v.WebSocketConnection=function(b){function a(n){var f=b.call(this)||this;f.errorString=null;const {geometryType:q,spatialReference:p,sourceSpatialReference:z}=n;f._config=n;f._featureZScaler=r.getGeometryZScaler(q,z,p);f._open();return f}t._inheritsLoose(a,b);var g=a.prototype;g._open=function(){var n=t._asyncToGenerator(function*(){yield this._tryCreateWebSocket();
this.destroyed||(yield this._handshake())});return function(){return n.apply(this,arguments)}}();g.destroy=function(){A.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};g._tryCreateWebSocket=function(){var n=t._asyncToGenerator(function*(f=this._config.source.path,q=1E3,p=0){try{if(!this.destroyed){var z=e.addQueryParameters(f,this._config.customParameters);
this._websocket=yield this._createWebSocket(z);this.notifyChange("connectionStatus")}}catch(w){if(z=q/1E3,this._config.maxReconnectionAttempts&&p>=this._config.maxReconnectionAttempts)u.getLogger(this.declaredClass).error(new B("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return u.getLogger(this.declaredClass).error(new B("websocket-connection",`Failed to connect. Attempting to reconnect in ${z}s`,w)),yield x.after(q),this._tryCreateWebSocket(f,
Math.min(1.5*q,1E3*this._config.maxReconnectionInterval),p+1)}});return function(){return n.apply(this,arguments)}}();g._createWebSocket=function(n){return new Promise((f,q)=>{const p=new WebSocket(n);p.onopen=()=>{p.onopen=null;this.destroyed?(p.onclose=null,p.close()):(p.onclose=z=>this._onClose(z),p.onerror=z=>this._onError(z),p.onmessage=z=>this._onMessage(z),f(p))};p.onclose=z=>{p.onopen=p.onclose=null;q(z)}})};g._handshake=function(){var n=t._asyncToGenerator(function*(f=1E4){const q=this._websocket;
if(!A.isNone(q)){var p=x.createResolver(),z=q.onmessage,{filter:w,outFields:y,spatialReference:G}=this._config;p.timeout(f);q.onmessage=H=>{let I=null;try{I=JSON.parse(H.data)}catch(D){}I&&"object"===typeof I||(u.getLogger(this.declaredClass).error(new B("websocket-connection","Protocol violation. Handshake failed - malformed message",H.data)),p.reject(),this.destroy());I.spatialReference?.wkid!==G?.wkid&&(u.getLogger(this.declaredClass).error(new B("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${G.wkid}`,
H.data)),p.reject(),this.destroy());"json"!==I.format&&(u.getLogger(this.declaredClass).error(new B("websocket-connection","Protocol violation. Handshake failed - format is not set",H.data)),p.reject(),this.destroy());w&&I.filter!==w&&u.getLogger(this.declaredClass).error(new B("websocket-connection","Tried to set filter, but server doesn't support it"));y&&I.outFields!==y&&u.getLogger(this.declaredClass).error(new B("websocket-connection","Tried to set outFields, but server doesn't support it"));
q.onmessage=z;p.resolve()};q.send(JSON.stringify({filter:w,outFields:y,format:"json",spatialReference:{wkid:G.wkid}}));return p.promise}});return function(){return n.apply(this,arguments)}}();g._onMessage=function(n){try{const f=JSON.parse(n.data);if("featureResult"!==f.type)throw new B("websocket-connection","Protocol violation - Expected to find message of type 'featureResult'",f);for(const q of f.features)A.isSome(this._featureZScaler)&&this._featureZScaler(q.geometry),this.onFeature(q)}catch(f){u.getLogger(this.declaredClass).error(new B("websocket-connection",
"Failed to parse message",f)),this.destroy()}};g._onError=function(n){this._set("errorString","Encountered an error over WebSocket connection");u.getLogger(this.declaredClass).error("websocket-connection","Encountered an error over WebSocket connection")};g._onClose=function(n){this._websocket=null;this.notifyChange("connectionStatus");1E3!==n.code&&u.getLogger(this.declaredClass).error("websocket-connection",`WebSocket closed unexpectedly with error code ${n.code}`);this.destroyed||this._open()};
t._createClass(a,[{key:"connectionStatus",get:function(){if(A.isNone(this._websocket))return"disconnected";switch(this._websocket.readyState){case c.CONNECTING:case c.OPEN:return"connected";case c.CLOSING:case c.CLOSED:return"disconnected"}}}]);return a}(k);E.__decorate([h.property()],v.WebSocketConnection.prototype,"connectionStatus",null);E.__decorate([h.property()],v.WebSocketConnection.prototype,"errorString",void 0);v.WebSocketConnection=E.__decorate([m.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],
v.WebSocketConnection);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/StreamConnection":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(v,t,E,B,u,A,x,e){B=function(h){function d(){return h.apply(this,
arguments)||this}v._inheritsLoose(d,h);d.prototype.onFeature=function(l){this.emit("data-received",l)};v._createClass(d,[{key:"connectionError",get:function(){return this.errorString?new E("stream-connection",this.errorString):null}}]);return d}(B.EventedAccessor);t.__decorate([u.property({readOnly:!0})],B.prototype,"connectionError",null);return B=t.__decorate([e.subclass("esri.layers.support.StreamConnection")],B)})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(v,t,E,B,u,A,x){x=function(e){function h(l){return e.call(this,l)||this}t._inheritsLoose(h,e);var d=h.prototype;d._fetchDataTile=function(){var l=t._asyncToGenerator(function*(m){const r=this._subscriptions.get(m.key.id);let k=!1,c=0,b=0;const a=(f,q)=>{b--;A.throwIfAborted(r);const p=m.id,z=f.reader;f=f.query;z.exceededTransferLimit?(q={id:p,addOrUpdate:z,end:k&&0===b,type:"append"},r.add({message:q,query:f}),this._onMessage(q)):(k=!0,q={id:p,addOrUpdate:z,end:0===b,type:"append"},r.add({message:q,
query:f}),this._onMessage(q))};let g=0,n=0;for(;!k&&20>n++;){let f;for(let q=0;q<g+1;q++){const p=c++;b++;f=this._fetchDataTilePage(m,p,r).then(z=>z&&a(z,p)).catch(z=>{k=!0;A.isAbortError(z)||(B.getLogger("esri.views.2d.layers.features.sources.PagedFeatureSource").error(new E("mapview-query-error","Encountered error when fetching tile",{tile:m,error:z})),this._onMessage({id:m.id,addOrUpdate:null,end:k,type:"append"}))})}yield f;A.throwIfAborted(r);g=Math.min(g+2,6)}});return function(m){return l.apply(this,
arguments)}}();d._fetchDataTilePage=function(){var l=t._asyncToGenerator(function*(m,r,k){A.throwIfAborted(k);const c=this._queryInfo;var b={start:this.pageSize*r,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:m.getQuantizationParameters()};u.isSome(this.maxRecordCountFactor)&&(b.maxRecordCountFactor=this.maxRecordCountFactor);b=this.createTileQuery(m,b);try{const a=yield this._queue.push({tile:m,query:b,signal:k.signal,depth:r});A.throwIfAborted(k);return a?c!==this._queryInfo?
this._fetchDataTilePage(m,r,k):{reader:a,query:b}:null}catch(a){return A.throwIfNotAbortError(a),null}});return function(m,r,k){return l.apply(this,arguments)}}();return h}(x.BaseFeatureSource);v.PagedFeatureSource=x;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(v,t,E,B,u,A,x,e,h,d){function l(r,k,c){var b=r.getXHydrated();r=r.getYHydrated();b=k.getColumnForX(b);b=Math.floor(k.normalizeCol(b));k=Math.floor(k.getRowForY(r));return`${c}/${k}/${b}`}function m(r,k){if(u.isNone(r))return null;k=k.transform;const c=r.getQuantizationTransform();if(u.isNone(c)){const [w,y]=k.scale,[G,H]=k.translate;return r.transform(-G/w,H/y,1/w,1/-y)}const [b,a]=c.scale,[g,n]=c.translate,[f,q]=k.scale,[p,z]=k.translate;return r.transform((g-p)/f,(-n+z)/q,b/f,a/q)}E=function(r){function k(b){var a=
r.call(this,b)||this;a.mode="snapshot";a._loading=!0;a._controller=new AbortController;a._downloadPromise=null;a._didSendEnd=!1;a._queries=[];a._invalidated=!1;a._hasAggregates=!1;a._random=new x(1E3);a._store=b.store;a._markedIdsBufId=a._store.storage.createBitset();return a}t._inheritsLoose(k,r);var c=k.prototype;c.destroy=function(){r.prototype.destroy.call(this);this._controller.abort()};c.update=function(b,a){r.prototype.update.call(this,b,a);null==this._featureCount&&(this._featureCount=a.initialFeatureCount);
u.isSome(a.changedFeatureCount)&&(this._featureCount=a.changedFeatureCount);this._hasAggregates=b.targets.aggregate};c.resend=function(){var b=t._asyncToGenerator(function*(a=!1){yield this._downloadPromise;this._invalidated||a?(a=u.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(g=>g.clear()),this._downloadPromise=this._download(a),yield this._downloadPromise):(a=this._queries.map(({query:g,reader:n})=>this._sendPatchQuery(g,
n)),yield Promise.all(a),this._subscriptions.forEach(g=>{g.requests.done.forEach(n=>this._onMessage(n.message))}))});return function(){return b.apply(this,arguments)}}();c.refresh=function(){var b=t._asyncToGenerator(function*(a,g){g&&(this._featureCount=g.featureCount);yield this.resend(!0)});return function(a,g){return b.apply(this,arguments)}}();c._sendPatchQuery=function(){var b=t._asyncToGenerator(function*(a,g){const n=u.isSome(a.outFields)?a.outFields:[],f=this._queryInfo.outFields,q=f.filter(w=>
!n.includes(w));if(q.length){var p=a.clone(),z=this._signal;p.returnGeometry=!1;p.returnCentroid=!1;p.outFields=q;a.outFields=f;a=yield this._queue.push({query:p,depth:0,signal:z});A.throwIfAborted({signal:z});g.joinAttributes(a)}});return function(a,g){return b.apply(this,arguments)}}();c._fetchDataTile=function(){var b=t._asyncToGenerator(function*(a){if(!this._downloadPromise){var g=u.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(g)}var n=
this._store.search(a);g=this._subscriptions.get(a.key.id);const f=n.length-1;for(let p=0;p<f;p++){var q=m(n[p],a);q={type:"append",id:a.id,addOrUpdate:q,end:!1,status:d.UpdateToken.empty()};g.add({query:null,message:q});this._hasAggregates||(yield A.after(1));this._onMessage(q)}n=m(0<=f?n[f]:null,a);a={type:"append",id:a.id,addOrUpdate:n,end:this._didSendEnd,status:d.UpdateToken.empty()};g.add({query:null,message:a});this._onMessage(a)});return function(a){return b.apply(this,arguments)}}();c._download=
function(){var b=t._asyncToGenerator(function*(a){try{yield this.whenInitialized();const g=this._store.storage.getBitset(this._markedIdsBufId),n=new Set;g.clear();const f=Array.from({length:Math.ceil(a/this.pageSize)},(q,p)=>p).sort((q,p)=>this._random.getInt()-this._random.getInt()).map(q=>this._downloadPage(q,g,n));yield Promise.all(f);this._store.sweepFeatures(g,this._store.storage);this._store.sweepFeatureSets(n)}catch(g){B.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource").error("mapview-snapshot-source",
"Encountered and error when downloading feature snapshot",g)}this._sendEnd();this._loading=!1});return function(a){return b.apply(this,arguments)}}();c._downloadPage=function(){var b=t._asyncToGenerator(function*(a,g,n){var f=this.pageSize;f={start:a*f,num:f,cacheHint:!0};u.isSome(this.maxRecordCountFactor)&&(f.maxRecordCountFactor=this.maxRecordCountFactor);f=this.createQuery(f);const q=this._signal;a=yield this._queue.push({query:f,depth:a,signal:q});A.throwIfAborted({signal:q});this._queries.push({query:f,
reader:a});this._store.insert(a);n.add(a.instance);for(n=a.getCursor();n.next();)g.set(n.getDisplayId());this._send(a)});return function(a,g,n){return b.apply(this,arguments)}}();c._send=function(b){if(this._subscriptions.size){var a=null,g=new Map,n=new Set,f=new Map;this._subscriptions.forEach(p=>{var z=p.tile;g.set(z.key.id,null);a=z.tileInfoView;n.add(z.level);const {row:w,col:y}=z.key;z=`${z.level}/${w}/${y}`;const G=f.get(z)??[];G.push(p);f.set(z,G)});for(const p of n){const z=a.getLODInfoAt(p),
w=b.getCursor();for(;w.next();){var q=l(w,z,p);const y=w.getIndex();if(f.has(q))for(const G of f.get(q)){q=G.tile.id;let H=g.get(q);u.isNone(H)&&(H=[],g.set(q,H));H.push(y)}}}g.forEach((p,z)=>{if(u.isSome(p)){const w=this._subscriptions.get(z);p=m(h.FeatureSetReaderIndirect.from(b,p),w.tile);z={type:"append",id:z,addOrUpdate:p,end:!1,status:d.UpdateToken.empty()};w.add({query:null,message:z});this._onMessage(z)}})}};c._sendEnd=function(){this._subscriptions.forEach(b=>{const a={type:"append",id:b.tile.id,
addOrUpdate:null,end:!0,status:d.UpdateToken.empty()};b.add({query:null,message:a});this._onMessage(a)});this._didSendEnd=!0};t._createClass(k,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return k}(e.BaseFeatureSource);v.SnapshotFeatureSource=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b){function a(z,w){return y=>w(z(y))}const g=u.getLogger("esri.views.layers.2d.features.support.AttributeStore"),n=k.createDebugLogger(k.DEBUG_ATTR_UPDATES,g);var f=B("esri-shared-array-buffer"),q=B("esri-atomics");let p=function(){function z(y,G,H,I){this.size=0;this.texelSize=4;const {pixelType:D,layout:C,textureOnly:F}=I;this.textureOnly=F||!1;this.pixelType=D;this._ctype=G;this.layout=C;this._resetRange();this._shared=y;this.size=H;F||(this.data=this._initData(D,
H,y,G))}var w=z.prototype;w.unsetComponentAllTexels=function(y,G){const H=x.unwrap(this.data);for(let I=0;I<this.size*this.size;I++)H[I*this.texelSize+y]&=~G;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponentAllTexels=function(y,G){const H=x.unwrap(this.data);for(let I=0;I<this.size*this.size;I++)H[I*this.texelSize+y]|=255&G;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponent=function(y,G,H){const I=x.unwrap(this.data);for(const D of H)I[D*this.texelSize+y]|=G,
this.dirtyStart=Math.min(this.dirtyStart,D),this.dirtyEnd=Math.max(this.dirtyEnd,D)};w.setComponentTexel=function(y,G,H){x.unwrap(this.data)[H*this.texelSize+y]|=G;this.dirtyStart=Math.min(this.dirtyStart,H);this.dirtyEnd=Math.max(this.dirtyEnd,H)};w.unsetComponentTexel=function(y,G,H){x.unwrap(this.data)[H*this.texelSize+y]&=~G;this.dirtyStart=Math.min(this.dirtyStart,H);this.dirtyEnd=Math.max(this.dirtyEnd,H)};w.getData=function(y,G){y=m.getDisplayIdTexel(y);return x.unwrap(this.data)[y*this.texelSize+
G]};w.setData=function(y,G,H){y=m.getDisplayIdTexel(y);0===(this.layout&1<<G)?g.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[y*this.texelSize+G]=H,this.dirtyStart=Math.min(this.dirtyStart,y),this.dirtyEnd=Math.max(this.dirtyEnd,y))};w.lock=function(){this.pixelType===b.PixelType.UNSIGNED_BYTE&&this._shared&&q&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};w.unlock=function(){this.pixelType===b.PixelType.UNSIGNED_BYTE&&this._shared&&q&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};w.expand=function(y){this.size=y;if(!this.textureOnly){y=this._initData(this.pixelType,y,this._shared,this._ctype);const G=x.unwrap(this.data);y.set(G);this.data=y}};w.toMessage=function(){const y=this.dirtyStart,G=this.dirtyEnd;var H=this.texelSize;if(y>G)return null;this._resetRange();const I=!this._shared&&"local"!==this._ctype,D=this.pixelType,C=this.layout,F=x.unwrap(this.data);H=I&&F.slice(y*H,(G+1)*H)||null;return{start:y,end:G,data:H,pixelType:D,
layout:C}};w._initData=function(y,G,H,I){H=H&&"local"!==I?SharedArrayBuffer:ArrayBuffer;y=r.getPixelArrayCtor(y);G=new y(new H(G*G*4*y.BYTES_PER_ELEMENT));for(y=0;y<G.length;y+=4)G[y+1]=255;return G};w._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(z,[{key:"buffer",get:function(){return x.applySome(this.data,y=>y.buffer)}}]);return z}();return function(){function z(y,G,H=()=>{}){this._client=y;this.config=G;this._notifyChange=H;this._attributeComputeMap=new Map;
this._blocks=[];this._filters=Array(l.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;y=G.supportsTextureFloat?b.PixelType.FLOAT:b.PixelType.UNSIGNED_BYTE;n(`Creating AttributeStore ${f?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:b.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:b.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:b.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:y,layout:15},{pixelType:y,layout:15},{pixelType:y,layout:15},{pixelType:y,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var w=z.prototype;w.destroy=function(){this._abortController.abort()};w.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};w.update=function(y,G){this.config=G;G=G.schema.processors[0].storage;const H=h.diff(this._schema,G);if(y.targets.feature||y.targets.aggregate)y.storage.data=!0;if(H&&(B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
H),y.storage.data=!0,this._schema=G,this._attributeComputeMap.clear(),!x.isNone(G))){switch(G.target){case "feature":this._targetType=m.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=m.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===G.type)for(const I in G.mapping){if(y=G.mapping[I],x.isSome(y)&&x.isSome(y.vvMapping))for(const D of y.vvMapping)this._bindAttribute(D)}else{if(x.isSome(G.vvMapping))for(const I of G.vvMapping)this._bindAttribute(I);if(x.isSome(G.attributeMapping))for(const I of G.attributeMapping)this._bindAttribute(I)}}};
w.onTileData=function(y,G){if(!x.isNone(G.addOrUpdate))for(y=G.addOrUpdate.getCursor();y.next();)G=y.getDisplayId(),this.setAttributeData(G,y)};w.setHighlight=function(){var y=t._asyncToGenerator(function*(G,H){const I=this._getBlock(0);H=H.map(D=>m.getDisplayIdTexel(D));I.lock();I.unsetComponentAllTexels(0,1);I.setComponent(0,1,H);I.unlock();this._idsToHighlight.clear();for(const D of G)this._idsToHighlight.add(D);yield this.sendUpdates()});return function(G,H){return y.apply(this,arguments)}}();
w.updateFilters=function(){var y=t._asyncToGenerator(function*(G,H,I){const {service:D,spatialReference:C}=I;({filters:H}=H);H=H.map((F,K)=>this._updateFilter(F,K,D,C));(yield Promise.all(H)).some(F=>F)&&(G.storage.filters=!0,B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(G,H,I){return y.apply(this,arguments)}}();w.setData=function(y,G,H,I){const D=m.getDisplayIdTexel(y);this._ensureSizeForTexel(D);this._getBlock(G).setData(y,H,I)};
w.getData=function(y,G,H){return this._getBlock(G).getData(y,H)};w.getHighlightFlag=function(y){return this._idsToHighlight.has(y)?l.HIGHLIGHT_FLAG:0};w.unsetAttributeData=function(y){y=m.getDisplayIdTexel(y);this._getBlock(0).setData(y,0,0)};w.setAttributeData=function(y,G){const H=m.getDisplayIdTexel(y);this._ensureSizeForTexel(H);this._getBlock(0).setData(H,0,this.getFilterFlags(G));if(this._targetType===m.getDisplayIdType(y)){y=this._attributeComputeMap;var I=this.config.supportsTextureFloat?
1:2;y.size&&y.forEach((D,C)=>{const F=C*I%4;C=this._getBlock(Math.floor(C*I/4)+l.ATTRIBUTE_DATA_VV);D=D(G);if(this.config.supportsTextureFloat)C.setData(H,F,D);else if(D===l.NAN_MAGIC_NUMBER)C.setData(H,F,255),C.setData(H,F+1,255);else{D=A.clamp(Math.round(D),-32767,32766)+32768;const K=(D&65280)>>8;C.setData(H,F,D&255);C.setData(H,F+1,K)}})}};w.sendUpdates=function(){B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;
if(this._currUpdate)return this._nextUpdate=e.createResolver(),this._nextUpdate.promise;const y={blocks:this._blocks.map(G=>x.isSome(G)?G.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var G=()=>{this._currUpdate=null;if(this._nextUpdate){const H=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>H.resolve())}else B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};B("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate::client.update");G=this._client.update(y,this._signal).then(G).catch(G);this._client.render(this._signal);return G}).catch(G=>{if(e.isAbortError(G))return this._createResourcesPromise=null,this._createResources();this._notifyChange();g.error(new E("mapview-attribute-store","Encountered an error during client update",G))})};w._ensureSizeForTexel=function(y){for(;y>=this._size*this._size&&!this._expand(););};w._bindAttribute=function(y){function G(){return y.normalizationField?
D=>{const C=D.readAttribute(y.normalizationField);return C?D.readAttribute(y.field)/C:null}:D=>D.readAttribute(y.field)}function H(){y.normalizationField&&g.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return D=>D.getComputedNumericAtIndex(y.fieldIndex)}let I;if(null!=y.fieldIndex)I=H();else if(y.field)I=G();else return;y.valueRepresentation&&(I=a(I,D=>c.getVisualVariableSizeValueRepresentationRatio(D,y.valueRepresentation)));this._attributeComputeMap.set(y.binding,
a(I,D=>null===D||isNaN(D)||Infinity===D||-Infinity===D?l.NAN_MAGIC_NUMBER:D))};w._createResources=function(){if(x.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(l.ATTRIBUTE_DATA_ANIMATION);this._getBlock(l.ATTRIBUTE_DATA_GPGPU);n("Initializing AttributeStore");var y={shared:f&&"local"!==this._client.type,size:this._size,blocks:x.mapMany(this._blocks,G=>({textureOnly:G.textureOnly,buffer:G.buffer,pixelType:G.pixelType}))};this._createResourcesPromise=y=this._client.initialize(y,
this._signal).catch(G=>{e.isAbortError(G)?this._createResourcesPromise=null:g.error(new E("mapview-attribute-store","Encountered an error during client initialization",G))});y.then(()=>x.isNone(this._createResourcesPromise)?this._createResources():void 0);return y};w._getBlock=function(y){var G=this._blocks[y];if(x.isSome(G))return G;n(`Initializing AttributeBlock at index ${y}`);G=new p(f,this._client.type,this._size,this._blockDescriptors[y]);this._blocks[y]=G;this._createResourcesPromise=null;
return G};w._expand=function(){if(this._size<this.config.maxTextureSize){const y=this._size<<=1;n("Expanding block size to",y,this._blocks);x.forEachSome(this._blocks,G=>G.expand(y));this._createResourcesPromise=null;this._size=y;return 0}g.error(new E("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};w._updateFilter=function(){var y=t._asyncToGenerator(function*(G,H,I,D){const C=this._filters[H],F=x.isSome(C)&&C.hash;if(!C&&!G||F===JSON.stringify(G))return!1;if(x.isNone(G)){if(!C)return!1;
G=1<<H+1;I=this._getBlock(0);this._filters[H]=null;I.setComponentAllTexels(0,G);this.sendUpdates();return!0}yield(yield this._getFilter(H,I)).update(G,D);return!0});return function(G,H,I,D){return y.apply(this,arguments)}}();w._getFilter=function(){var y=t._asyncToGenerator(function*(G,H){var I=this._filters[G];if(x.isSome(I))return I;({default:I}=yield new Promise((D,C)=>v(["./FeatureFilter"],F=>D(Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}))),
C)));H=new I({geometryType:H.geometryType,hasM:!1,hasZ:!1,timeInfo:H.timeInfo,fieldsIndex:new d(H.fields)});return this._filters[G]=H});return function(G,H){return y.apply(this,arguments)}}();w.isVisible=function(y){return!!(this._getBlock(0).getData(y,0)&2)};w.getFilterFlags=function(y){let G=0;var H=m.getDisplayIdFilterMask(y.getDisplayId());for(let D=0;D<this._filters.length;D++){var I=this._filters[D];I=!(H&1<<D)||x.isNone(I)||I.check(y);G|=(I?1:0)<<D}H=0;this._idsToHighlight.size&&(y=y.getObjectId(),
H=this.getHighlightFlag(y));return G<<1|H};t._createClass(z,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return z}()})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(v){v.AGGREGATE_VALID_FILTERS_MASK=254;v.DISPLAY_ID_TEXEL_MASK=8388607;v.DISPLAY_ID_TYPE_AGGREGATE=1;v.DISPLAY_ID_TYPE_FEATURE=0;v.DISPLAY_ID_TYPE_MASK=
8388608;v.NONAGGREGATE_VALID_FILTERS_MASK=255;v.createDisplayId=function(t,E){return((E?8388608:0)|t)>>>0};v.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;v.getDisplayIdTexel=t=>t&8388607;v.getDisplayIdType=t=>(t&8388608)>>>23;v.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m){function r(ia){const wa={};for(const ea of ia)wa[ea.name]=ea.strideInBytes;return wa}function k(ia){switch(ia){case e.WGLGeometryType.MARKER:return P;case e.WGLGeometryType.FILL:return S;case e.WGLGeometryType.LINE:return X;case e.WGLGeometryType.TEXT:return ha;case e.WGLGeometryType.LABEL:return U}}function c(ia){switch(ia%4){case 0:case 2:return 4;case 1:case 3:return 1}}function b(ia){switch(ia){case d.DataType.BYTE:case d.DataType.UNSIGNED_BYTE:return 1;case d.DataType.SHORT:case d.DataType.UNSIGNED_SHORT:return 2;
case d.DataType.FLOAT:case d.DataType.INT:case d.DataType.UNSIGNED_INT:return 4}}function a(ia){const wa={};for(const ea in ia){let L=0;wa[ea]=ia[ea].map(M=>{const ba=new m.VertexElementDescriptor(M.name,M.count,M.type,L,0,M.normalized||!1);L+=M.count*b(M.type);return ba});wa[ea].forEach(M=>M.stride=L)}return wa}const g=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:36}];const n=[{name:"geometry",strideInBytes:12}],f=[{name:"geometry",strideInBytes:36}],q=[{name:"geometry",
strideInBytes:24}],p=[{name:"geometry",strideInBytes:12}],z=[{name:"geometry",strideInBytes:40}],w=[{name:"geometry",strideInBytes:36}],y=[{name:"geometry",strideInBytes:36}],G=r(E),H=r(n),I=r(f),D=r(q),C=r(p),F=r(z),K=r(w),J=r(y),P=["geometry"],S=["geometry"],X=["geometry"],ha=["geometry"],U=["geometry"],Q={geometry:d.Usage.STATIC_DRAW},O=new Map,R=ia=>ia.startsWith("data:image/gif"),V=ia=>ia.startsWith("data:image/png"),Z=ia=>{if(!ia)return!1;ia=ia.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(ia)&&
/[\dz]$/i.test(ia)&&4<ia.length?!0:!1},ka=ia=>"fill"===ia.type&&"CIMMarkerPlacementInsidePolygon"===ia?.cim?.markerPlacement?.type;v.C_FILL_STRIDE_SPEC=I;v.C_FILL_STRIDE_SPEC_DD=C;v.C_FILL_STRIDE_SPEC_SIMPLE=D;v.C_FILL_VERTEX_DEF=f;v.C_FILL_VERTEX_DEF_DD=p;v.C_FILL_VERTEX_DEF_SIMPLE=q;v.C_HEATMAP_STRIDE_SPEC=H;v.C_HEATMAP_VERTEX_DEF=n;v.C_ICON_STRIDE_SPEC=G;v.C_ICON_VERTEX_DEF=E;v.C_LABEL_STRIDE_SPEC=J;v.C_LABEL_VERTEX_DEF=y;v.C_LINE_STRIDE_SPEC=F;v.C_LINE_VERTEX_DEF=z;v.C_TEXT_STRIDE_SPEC=K;v.C_TEXT_VERTEX_DEF=
w;v.C_VBO_GEOMETRY="geometry";v.C_VBO_INFO=Q;v.C_VBO_PERINSTANCE="per_instance";v.C_VBO_PERINSTANCE_VV="per_instance_vv";v.allocateTypedArrayBuffer=function(ia,wa){switch(wa%4){case 0:case 2:return new Uint32Array(Math.floor(ia*wa/4));case 1:case 3:return new Uint8Array(ia*wa)}};v.allocateTypedArrayBufferwithData=function(ia,wa){switch(wa%4){case 0:case 2:return new Uint32Array(ia);case 1:case 3:return new Uint8Array(ia)}};v.charCodes=function(ia){const wa=[];for(let ea=0;ea<ia.length;ea++)wa.push(ia.charCodeAt(ea));
return wa};v.copyMeshData=function(ia,wa,ea,L,M,ba,ca){for(const Y in ba){var ma=ba[Y].stride,W=c(ma);const da=ba[Y].data,ja=ea[Y].data,pa=ma*M.vertexCount/W,sa=ma*ia/W;ma=ma*M.vertexFrom/W;for(W=0;W<pa;++W)ja[W+sa]=da[W+ma]}ea=M.indexCount;for(ba=0;ba<ea;++ba)L[ba+wa]=ca[ba+M.indexFrom]-M.vertexFrom+ia};v.createGeometryData=function(ia,wa){const ea=[];for(let L=0;5>L;++L){const M=k(L),ba={};for(const ca of M)ba[ca]={data:wa(L,ca)};ea.push({data:ia(L),buffers:ba})}return ea};v.createProgramDescriptor=
(ia,wa)=>{if(!O.has(ia)){const M=a(wa);var ea=M;var L={};for(const ba in ea){const ca=ea[ba];L[ba]=ca.length?ca[0].stride:0}ea=L;L=new Map;for(const ba in wa)for(const ca of wa[ba])L.set(ca.name,ca.location);O.set(ia,{strides:ea,bufferLayouts:M,attributes:L})}return O.get(ia)};v.createTextureFromTexelData=function(ia,wa){let ea,L;B.isPowerOfTwo(wa.width)&&B.isPowerOfTwo(wa.height)?(ea=!0,L=d.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(ea=!1,L=d.TextureSamplingMode.LINEAR);return new l.Texture(ia,{target:d.TextureType.TEXTURE_2D,
pixelFormat:d.PixelFormat.RGBA,internalFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,hasMipmap:ea,samplingMode:L,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},wa)};v.forEachGeometryType=function(ia){ia(e.WGLGeometryType.FILL);ia(e.WGLGeometryType.LINE);ia(e.WGLGeometryType.MARKER);ia(e.WGLGeometryType.TEXT);ia(e.WGLGeometryType.LABEL)};v.geometryToMappedGeometry=function(ia){return{vertexFrom:void 0,vertexTo:void 0,geometry:ia}};v.getBytes=b;v.getCapType=function(ia){switch(ia){case "butt":return A.CapType.BUTT;
case "round":return A.CapType.ROUND;case "square":return A.CapType.SQUARE;default:return g.error(new t("mapview-invalid-type",`Cap type ${ia} is not a valid option. Defaulting to round`)),A.CapType.ROUND}};v.getJoinType=function(ia){switch(ia){case "miter":return A.JoinType.MITER;case "bevel":return A.JoinType.BEVEL;case "round":return A.JoinType.ROUND;default:return g.error(new t("mapview-invalid-type",`Join type ${ia} is not a valid option. Defaulting to round`)),A.JoinType.ROUND}};v.getNamedBuffers=
k;v.getPMSResourceSize=function(ia){const wa="maxVVSize"in ia&&ia.maxVVSize;ia="width"in ia&&ia.width||"size"in ia&&ia.size||0;return wa?wa:ia};v.getPixelArrayCtor=function(ia){switch(ia){case d.PixelType.UNSIGNED_BYTE:return Uint8Array;case d.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case d.PixelType.FLOAT:return Float32Array;default:g.error(new t("webgl-utils",`Unable to handle type ${ia}`))}};v.getPixelBytes=function(ia){switch(ia){case d.PixelType.UNSIGNED_BYTE:return 1;case d.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;
case d.PixelType.FLOAT:return 4;default:g.error(new t("webgl-utils",`Unable to handle type ${ia}`))}};v.getStrides=function(ia,wa){switch(ia){case e.WGLGeometryType.MARKER:switch(wa){case e.WGLSymbologyType.HEATMAP:return H;default:return G}case e.WGLGeometryType.FILL:switch(wa){case e.WGLSymbologyType.DOT_DENSITY:return C;case e.WGLSymbologyType.SIMPLE:case e.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return D;default:return I}case e.WGLGeometryType.LINE:return F;case e.WGLGeometryType.TEXT:return K;case e.WGLGeometryType.LABEL:return J}};
v.getTextProperties=function(ia){return h.TextProperties.pool.acquire(ia.color?x.copyAndPremultiply(ia.color):[255,255,255,255],ia.haloColor?x.copyAndPremultiply(ia.haloColor):[255,255,255,255],u.pt2px(ia.haloSize),u.pt2px(ia.font.size),ia.angle*Math.PI/180,ia.xoffset/ia.font.size,ia.yoffset/ia.font.size,"left"===ia.horizontalAlignment?0:"right"===ia.horizontalAlignment?1:.5,"top"===ia.verticalAlignment?0:"bottom"===ia.verticalAlignment?1:.5)};v.getTransformParams=function(ia){const {transform:wa,
hasZ:ea,hasM:L}=ia;return{transform:wa,hasZ:ea,hasM:L}};v.getUrl=ia=>"imageData"in ia&&ia.imageData&&"contentType"in ia&&ia.contentType?`data:${ia.contentType};base64,${ia.imageData}`:"url"in ia?ia.url:null;v.getVVType=function(ia){switch(ia){case "opacity":return e.VVType.OPACITY;case "color":return e.VVType.COLOR;case "rotation":return e.VVType.ROTATION;case "size":return e.VVType.SIZE;default:return g.error(`Cannot interpret unknown vv: ${ia}`),null}};v.is3D=ia=>ia.type&&ia.type.toLowerCase().includes("3d");
v.isDefined=function(ia){return null!=ia};v.isGIF=ia=>"url"in ia&&ia.url&&(ia.url.includes(".gif")||R(ia.url))||"contentType"in ia&&"image/gif"===ia.contentType||"imageData"in ia&&R(ia.imageData);v.isGIFDataUri=R;v.isImageResource=ia=>"url"in ia&&ia.url||"imageData"in ia&&ia.imageData;v.isMarkerPlacementInsidePolygon=ka;v.isNumber=function(ia){return"number"===typeof ia};v.isPNG=ia=>"url"in ia&&ia.url&&(ia.url.includes(".png")||V(ia.url))||"contentType"in ia&&"image/png"===ia.contentType||"imageData"in
ia&&V(ia.imageData);v.isPNGDataUri=V;v.isSVGImage=ia=>ia.includes("data:image/svg+xml");v.isSVGResource=ia=>"path"in ia&&Z(ia.path);v.isSimple=function(ia){switch(ia.type){case "line":return"CIMSolidStroke"===ia.cim.type&&!ia.dashTemplate;case "fill":return"CIMSolidFill"===ia.cim.type;case "esriSFS":return"esriSFSSolid"===ia.style||"esriSFSNull"===ia.style;case "esriSLS":return"esriSLSSolid"===ia.style||"esriSLSNull"===ia.style;default:return!1}};v.isValidSVG=Z;v.shouldRepeat=function(ia){switch("cim"in
ia?ia.cim.type:ia.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return ka(ia);default:return!0}};v.strideToPackingFactor=c;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/screenUtils":function(){define(["exports"],function(v){function t(B){return B?72*B/96:0}const E=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;v.castRenderScreenPointArray=function(B){return B};
v.castRenderScreenPointArray3=function(B){return B};v.castScreenPointArray=function(B){return B};v.createRenderScreenPoint=function(B=0,u=0){return{x:B,y:u}};v.createRenderScreenPointArray=function(B=0,u=0){return[B,u]};v.createRenderScreenPointArray3=function(B=0,u=0,A=0){return[B,u,A]};v.createScreenPoint=function(B=0,u=0){return{x:B,y:u}};v.createScreenPointArray=function(B=0,u=0){return[B,u]};v.pt2px=function(B){return B?B/72*96:0};v.px2pt=t;v.screenPointArrayToObject=function(B,u){return u?(u.x=
B[0],u.y=B[1],u):{x:B[0],y:B[1]}};v.screenPointObjectToArray=function(B,u){return u?(u[0]=B.x,u[1]=B.y,2<u.length&&(u[2]=0),u):[B.x,B.y]};v.toPt=function(B){if("string"===typeof B){var u=B.match(E);if(u){var A=Number(u[1]);u=u[3]&&u[3].toLowerCase();B="-"===B.charAt(0);A="px"===u?t(A):A;return B?-A:A}console.warn("screenUtils.toPt: input not recognized!");return null}return B};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/color":function(){define(["exports",
"../../../../core/maybe","./number"],function(v,t,E){function B(x,e){Array.isArray(e)?(x[0]=e[0],x[1]=e[1],x[2]=e[2],x[3]=e[3]):(x[0]=e.r,x[1]=e.g,x[2]=e.b,x[3]=e.a);return x}function u(x,e=0,h=!1){const d=x[e+3];x[e+0]*=d;x[e+1]*=d;x[e+2]*=d;h||(x[e+3]*=255);return x}const A=[0,0,0,0];v.copyAndPremultiply=function(x){return u(B([],x))};v.premultiplyAlpha=u;v.premultiplyAlphaRGBA=function(x){if(!x)return 0;const {r:e,g:h,b:d,a:l}=x;return E.i8888to32(e*l,h*l,d*l,255*l)};v.premultiplyAlphaRGBAArray=
function(x){if(!x)return 0;const [e,h,d,l]=x;return E.i8888to32(l/255*e,l/255*h,l/255*d,l)};v.premultiplyAlphaUint32=function(x){u(B(A,x));return E.i8888to32(A[0],A[1],A[2],A[3])};v.white=[255,255,255,1];v.writeColor=function(x,e,h=0){if(t.isNone(e))x[h+0]=0,x[h+1]=0,x[h+2]=0,x[h+3]=0;else{var {r:d,g:l,b:m,a:r}=e;x[h+0]=d*r/255;x[h+1]=l*r/255;x[h+2]=m*r/255;x[h+3]=r}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],
function(v){function t(u,A,x){return Math.round(Math.max(Math.min(u,x),A))}const E=new Float32Array(1),B=new Uint32Array(E.buffer);v.i16=function(u){return t(u,-32768,32767)};v.i1616to32=function(u,A){return 65535&u|A<<16};v.i32=function(u){return t(u,-2147483648,2147483647)};v.i8=function(u){return t(u,-128,127)};v.i8816to32=function(u,A,x){return u&255|(A&255)<<8|x<<16};v.i8888to32=function(u,A,x,e){return u&255|(A&255)<<8|(x&255)<<16|e<<24};v.numTo32=function(u){return u|0};v.toFloat32=function(u){B[0]=
u;return E[0]};v.toUint32=function(u){E[0]=u;return B[0]};v.u16=function(u){return t(u,0,65535)};v.u32=function(u){return t(u,0,4294967295)};v.u32to4Xu8=function(u){return[u&255,(u&65280)>>>8,(u&16711680)>>>16,(u&4278190080)>>>24]};v.u4u4to8=function(u,A){return 15&u|(15&A)<<4};v.u8=function(u){return t(u,0,255)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(v){v.WGLGeometryType=
void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(v.WGLGeometryType||(v.WGLGeometryType={}));v.WGLGeometryTransactionStatus=void 0;(function(t){t[t.SUCCEEDED=0]="SUCCEEDED";t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(v.WGLGeometryTransactionStatus||(v.WGLGeometryTransactionStatus={}));v.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=4]="LABEL_ALPHA";t[t.HITTEST=
8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]="CLIP";t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(v.WGLDrawPhase||(v.WGLDrawPhase={}));v.VVType=void 0;(function(t){t[t.SIZE=0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(v.VVType||(v.VVType={}));v.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";t[t.SIZE_SCALE_STOPS=
16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(v.WGLVVFlag||(v.WGLVVFlag={}));v.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(v.WGLVVTarget||(v.WGLVVTarget={}));v.MosaicType=void 0;(function(t){t[t.SPRITE=0]="SPRITE";t[t.GLYPH=1]=
"GLYPH"})(v.MosaicType||(v.MosaicType={}));v.WGLSymbologyType=void 0;(function(t){t[t.DEFAULT=0]="DEFAULT";t[t.SIMPLE=1]="SIMPLE";t[t.DOT_DENSITY=2]="DOT_DENSITY";t[t.OUTLINE_FILL=3]="OUTLINE_FILL";t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";t[t.HEATMAP=5]="HEATMAP";t[t.PIE_CHART=6]="PIE_CHART"})(v.WGLSymbologyType||(v.WGLSymbologyType={}));Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports",
"../../../../core/ObjectPool"],function(v,t){let E=function(){function B(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var u=B.prototype;u.acquire=function(A,x,e,h,d,l,m,r,k){this.color=A;this.haloColor=x;this.haloSize=e;this.size=h;this.angle=d;this.offsetX=l;this.offsetY=m;this.hAnchor=r;this.vAnchor=k};u.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=
this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return B}();E.pool=new t(E);v.TextProperties=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/Texture":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/maybe ./checkWebGLError ./context-util ./enums ./capabilities/isWebGL2Context".split(" "),
function(v,t,E,B,u,A,x,e,h){function d(c){return u.isSome(c)&&"type"in c&&"compressed"===c.type}function l(c){var b;if(b=u.isSome(c)&&!d(c))b=!(u.isSome(c)&&"byteLength"in c);return b}function m(c){return c===e.TextureType.TEXTURE_3D||c===e.TextureType.TEXTURE_2D_ARRAY}function r(c,b,a,g=1){b=Math.max(b,a);c===e.TextureType.TEXTURE_3D&&(b=Math.max(b,g));return Math.round(Math.log(b)/Math.LN2)+1}const k={target:e.TextureType.TEXTURE_2D,samplingMode:e.TextureSamplingMode.LINEAR,wrapMode:e.TextureWrapMode.REPEAT,
flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,isImmutable:!1};E=function(){function c(a,g,n=null){this._context=a;this.type="texture";this._glName=null;this._wasImmutablyAllocated=this._wrapModeDirty=this._samplingModeDirty=!1;a.instanceCounter.increment(e.ResourceType.Texture,this);this._descriptor={...k,...g};for(const f in k)void 0===this._descriptor[f]&&(this._descriptor[f]=k[f]);if(a.type!==x.ContextType.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=
!1),m(this._descriptor.target)))throw Error("3D and array textures are not supported in WebGL1");this._descriptor.target===e.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(n):this.setData(n)}var b=c.prototype;b.dispose=function(){this._context.gl&&this._glName&&(this._context.unbindTexture(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(e.ResourceType.Texture,this))};b.release=function(){this.dispose()};b.resize=function(a,g){const n=
this._descriptor;if(n.width!==a||n.height!==g){if(this._wasImmutablyAllocated)throw Error("Immutable textures can't be resized!");n.width=a;n.height=g;this._descriptor.target===e.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}};b._setDataCubeMap=function(a=null){for(let g=e.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X;g<=e.TextureType.TEXTURE_CUBE_MAP_NEGATIVE_Z;g++)this._setData(a,g)};b.setData=function(a){this._setData(a)};b._setData=function(a,g){if(this._context&&this._context.gl){var n=
this._context.gl;this._glName||(this._glName=n.createTexture());void 0===a&&(a=null);var f=this._descriptor,q=g??f.target,p=m(q);null===a&&(f.width=f.width||4,f.height=f.height||4,p&&(f.depth=f.depth??1));g=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);c._validateTexture(this._context,f);this._configurePixelStorage();A.checkWebGLError(n);var z=f.pixelFormat,w=f.internalFormat??this._deriveInternalFormat(z,f.dataType);if(l(a)){z=
a.width;let y=a.height;a instanceof HTMLVideoElement&&(z=a.videoWidth,y=a.videoHeight);f.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(q,w,f.hasMipmap,z,y,1);this._texImage(q,0,w,z,y,1,a);A.checkWebGLError(n);f.hasMipmap&&this.generateMipmap();void 0===f.width&&(f.width=z);void 0===f.height&&(f.height=y);p&&void 0===f.depth&&(f.depth=1)}else{const {width:y,height:G,depth:H}=f;if(null==y||null==G)throw Error("Width and height must be specified!");if(p&&null==H)throw Error("Depth must be specified!");
f.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(q,w,f.hasMipmap,y,G,H);n.DEPTH24_STENCIL8&&w===n.DEPTH_STENCIL&&(w=n.DEPTH24_STENCIL8);if(d(a)){const I=a.levels;a=r(q,y,G,H);p=Math.min(a-1,I.length-1);h(n)?n.texParameteri(f.target,n.TEXTURE_MAX_LEVEL,p):f.hasMipmap=f.hasMipmap&&a===I.length;const D=w;if(!(D in e.CompressedTextureFormat))throw Error("Attempting to use compressed data with an umcompressed format!");this._forEachMipmapLevel((C,F,K,J)=>{this._compressedTexImage(q,C,D,F,
K,J,I[Math.min(C,I.length-1)])},p)}else u.isSome(a)?(this._texImage(q,0,w,y,G,H,a),A.checkWebGLError(n),f.hasMipmap&&this.generateMipmap()):this._forEachMipmapLevel((I,D,C,F)=>{this._texImage(q,I,w,D,C,F,null);A.checkWebGLError(n)})}c._applySamplingMode(n,this._descriptor);c._applyWrapMode(n,this._descriptor);c._applyAnisotropicFilteringParameters(this._context,this._descriptor);A.checkWebGLError(n);this._context.bindTexture(g,c.TEXTURE_UNIT_FOR_UPDATES)}};b.updateData=function(a,g,n,f,q,p,z=0){p||
console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const w=this._context.gl,y=this._descriptor,{pixelFormat:G,dataType:H,target:I,isImmutable:D}=y,C=y.internalFormat??this._deriveInternalFormat(G,H);if(D&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");const F=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES,!0);(0>g||0>n||f>y.width||q>y.height||g+f>y.width||n+q>y.height)&&
console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();if(z){if(!h(w)){console.error("Webgl2 must be enabled to use dataRowOffset!");return}w.pixelStorei(w.UNPACK_SKIP_ROWS,z)}l(p)?h(w)?w.texSubImage2D(I,a,g,n,f,q,G,H,p):w.texSubImage2D(I,a,g,n,G,H,p):d(p)?w.compressedTexSubImage2D(I,a,g,n,f,q,C,p.levels[a]):w.texSubImage2D(I,a,g,n,f,q,G,H,p);if(z){if(!h(w)){console.error("Webgl2 must be enabled to use dataRowOffset!");return}w.pixelStorei(w.UNPACK_SKIP_ROWS,
0)}this._context.bindTexture(F,c.TEXTURE_UNIT_FOR_UPDATES)};b.updateData3D=function(a,g,n,f,q,p,z,w){w||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const y=this._context.gl;if(!h(y))throw Error("3D textures are not supported in WebGL1");const G=this._descriptor,{pixelFormat:H,dataType:I,isImmutable:D,target:C}=G,F=G.internalFormat??this._deriveInternalFormat(H,I);if(D&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");
m(C)||console.warn("Attempting to set 3D texture data on a non-3D texture");const K=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);(0>g||0>n||0>f||q>G.width||p>G.height||z>G.depth||g+q>G.width||n+p>G.height||f+z>G.depth)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();d(w)?(w=w.levels[a],y.compressedTexSubImage3D(C,a,g,n,f,q,p,z,F,w)):y.texSubImage3D(C,a,g,n,f,q,p,z,H,I,w);this._context.bindTexture(K,
c.TEXTURE_UNIT_FOR_UPDATES)};b.generateMipmap=function(){const a=this._descriptor;if(!a.hasMipmap){if(this._wasImmutablyAllocated)throw Error("Cannot add mipmaps to immutable texture after allocation");this._samplingModeDirty=a.hasMipmap=!0;c._validateTexture(this._context,a)}a.samplingMode===e.TextureSamplingMode.LINEAR?(this._samplingModeDirty=!0,a.samplingMode=e.TextureSamplingMode.LINEAR_MIPMAP_NEAREST):a.samplingMode===e.TextureSamplingMode.NEAREST&&(this._samplingModeDirty=!0,a.samplingMode=
e.TextureSamplingMode.NEAREST_MIPMAP_NEAREST);const g=this._context.bindTexture(this,c.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(c.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(a.target);this._context.bindTexture(g,c.TEXTURE_UNIT_FOR_UPDATES)};b.setSamplingMode=function(a){a!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=a,this._samplingModeDirty=!0)};b.setWrapMode=function(a){a!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=a,c._validateTexture(this._context,
this._descriptor),this._wrapModeDirty=!0)};b.applyChanges=function(){const a=this._context.gl,g=this._descriptor;this._samplingModeDirty&&(c._applySamplingMode(a,g),this._samplingModeDirty=!1);this._wrapModeDirty&&(c._applyWrapMode(a,g),this._wrapModeDirty=!1)};b._deriveInternalFormat=function(a,g){if(this._context.type===x.ContextType.WEBGL1)return a;switch(g){case e.PixelType.FLOAT:switch(a){case e.PixelFormat.RGBA:return e.SizedPixelFormat.RGBA32F;case e.PixelFormat.RGB:return e.SizedPixelFormat.RGB32F;
default:throw Error("Unable to derive format");}case e.PixelType.UNSIGNED_BYTE:switch(a){case e.PixelFormat.RGBA:return e.SizedPixelFormat.RGBA8;case e.PixelFormat.RGB:return e.SizedPixelFormat.RGB8}default:return a}};b._configurePixelStorage=function(){const a=this._context.gl,{unpackAlignment:g,flipped:n,preMultiplyAlpha:f}=this._descriptor;a.pixelStorei(a.UNPACK_ALIGNMENT,g);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n?1:0);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f?1:0)};b._texStorage=function(a,
g,n,f,q,p){const z=this._context.gl;if(!h(z))throw Error("Immutable textures are not supported in WebGL1");if(!(g in e.SizedPixelFormat))throw Error("Immutable textures must have a sized internal format");if(this._descriptor.isImmutable){n=n?r(a,f,q,p):1;if(m(a)){if(null==p)throw Error("Missing depth dimension for 3D texture upload");z.texStorage3D(a,n,g,f,q,p)}else z.texStorage2D(a,n,g,f,q);this._wasImmutablyAllocated=!0}};b._texImage=function(a,g,n,f,q,p,z){const w=this._context.gl;let y=null;const G=
this._context.type===x.ContextType.WEBGL2,H=m(a),{isImmutable:I,pixelFormat:D,dataType:C}=this._descriptor;G&&(y=w);if(!G&&l(z))w.texImage2D(a,0,n,D,C,z);else if(I){if(u.isSome(z))if(H){if(null==p)throw Error("Missing depth dimension for 3D texture upload");y.texSubImage3D(a,g,0,0,0,f,q,p,D,C,z)}else w.texSubImage2D(a,g,0,0,f,q,D,C,z)}else if(z=u.unwrap(z),H){if(null==p)throw Error("Missing depth dimension for 3D texture upload");y.texImage3D(a,g,n,f,q,p,0,D,C,z)}else w.texImage2D(a,g,n,f,q,0,D,C,
z)};b._compressedTexImage=function(a,g,n,f,q,p,z){const w=this._context.gl;let y=null;const G=m(a),H=this._descriptor.isImmutable;if(G){if(this._context.type!==x.ContextType.WEBGL2)throw Error("3D textures are not supported in WebGL1");y=w}if(H){if(u.isSome(z))if(G){if(null==p)throw Error("Missing depth dimension for 3D texture upload");y.compressedTexSubImage3D(a,g,0,0,0,f,q,p,n,z)}else w.compressedTexSubImage2D(a,g,0,0,f,q,n,z)}else if(G){if(null==p)throw Error("Missing depth dimension for 3D texture upload");
y.compressedTexImage3D(a,g,n,f,q,p,0,z)}else w.compressedTexImage2D(a,g,n,f,q,0,z)};b._forEachMipmapLevel=function(a,g=Infinity){let {width:n,height:f,depth:q,hasMipmap:p,target:z}=this._descriptor;const w=z===e.TextureType.TEXTURE_3D;if(null==n||null==f||w&&null==q)throw Error("Missing texture dimensions for mipmap calculation");for(let y=0;;++y){a(y,n,f,q);if(!p||1===n&&1===f&&(!w||1===q)||y>=g)break;n=Math.max(1,n>>1);f=Math.max(1,f>>1);w&&(q=Math.max(1,q>>1))}};c._validateTexture=function(a,g){(null!=
g.width&&0>g.width||null!=g.height&&0>g.height||null!=g.depth&&0>g.depth)&&console.error("Negative dimension parameters are not allowed!");a=h(a.gl);const n=null!=g.width&&B.isPowerOfTwo(g.width)&&null!=g.height&&B.isPowerOfTwo(g.height);a||!g.isImmutable&&!m(g.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!");a||n||("number"===typeof g.wrapMode?g.wrapMode!==e.TextureWrapMode.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):
(g.wrapMode.s!==e.TextureWrapMode.CLAMP_TO_EDGE||g.wrapMode.t!==e.TextureWrapMode.CLAMP_TO_EDGE)&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),g.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};c._applySamplingMode=function(a,g){let n=g.samplingMode,f=g.samplingMode;if(n===e.TextureSamplingMode.LINEAR_MIPMAP_NEAREST||n===e.TextureSamplingMode.LINEAR_MIPMAP_LINEAR)n=e.TextureSamplingMode.LINEAR,g.hasMipmap||(f=e.TextureSamplingMode.LINEAR);
else if(n===e.TextureSamplingMode.NEAREST_MIPMAP_NEAREST||n===e.TextureSamplingMode.NEAREST_MIPMAP_LINEAR)n=e.TextureSamplingMode.NEAREST,g.hasMipmap||(f=e.TextureSamplingMode.NEAREST);a.texParameteri(g.target,a.TEXTURE_MAG_FILTER,n);a.texParameteri(g.target,a.TEXTURE_MIN_FILTER,f)};c._applyWrapMode=function(a,g){"number"===typeof g.wrapMode?(a.texParameteri(g.target,a.TEXTURE_WRAP_S,g.wrapMode),a.texParameteri(g.target,a.TEXTURE_WRAP_T,g.wrapMode)):(a.texParameteri(g.target,a.TEXTURE_WRAP_S,g.wrapMode.s),
a.texParameteri(g.target,a.TEXTURE_WRAP_T,g.wrapMode.t))};c._applyAnisotropicFilteringParameters=function(a,g){const n=a.capabilities.textureFilterAnisotropic;n&&a.gl.texParameterf(g.target,n.TEXTURE_MAX_ANISOTROPY,g.maxAnisotropy??1)};t._createClass(c,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}}]);return c}();E.TEXTURE_UNIT_FOR_UPDATES=0;v.Texture=
E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/checkWebGLError":function(){define(["exports","../../core/Error","../../core/has","../../core/Logger"],function(v,t,E,B){function u(e,h){switch(h){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";
case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const A=B.getLogger("esri.views.webgl.checkWebGLError"),x=!!E("enable-feature:webgl-debug");v.checkWebGLError=function(e){if(x){const h=
e.getError();h&&(e=u(e,h),A.error(new t("webgl-error","WebGL error occured",{message:e,stack:Error().stack})))}};v.hasFeatureFlagWebGLDebug=x;v.webglDebugEnabled=function(){return x};v.webglValidateShadersEnabled=function(){return x};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/context-util":function(){define(["exports","../../core/has","../../core/maybe"],function(v,t,E){function B(e){const h=t("esri-force-webgl");if(h===v.ContextType.WEBGL1||
h===v.ContextType.WEBGL2)return[h];switch(e){case "2d":return t("mac")&&t("chrome")?[v.ContextType.WEBGL1,v.ContextType.WEBGL2]:[v.ContextType.WEBGL2,v.ContextType.WEBGL1];case "3d":return[v.ContextType.WEBGL2,v.ContextType.WEBGL1]}}function u(e,h,d={}){if(!window.WebGLRenderingContext)return x(e,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),null;h=A(e,h,d);E.isNone(h)&&x(e,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e');
return h}function A(e,h,d={}){h=h===v.ContextType.WEBGL1?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let l=null;for(const m of h){try{l=e.getContext(m,d)}catch(r){}if(l)break}return l}function x(e,h){(e=e.parentNode)&&(e.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+h+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}
v.ContextType=void 0;(function(e){e[e.WEBGL1=1]="WEBGL1";e[e.WEBGL2=2]="WEBGL2"})(v.ContextType||(v.ContextType={}));v.createContext=A;v.createContextOrErrorHTML=function(e,h,d={}){for(e=B(e);1<e.length;){const l=A(h,e.shift(),d);if(E.isSome(l))return l}return u(h,e.shift(),d)};v.getContextTypes=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(v){return window.WebGL2RenderingContext&&
v instanceof window.WebGL2RenderingContext}})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(v){v.DEBUG_ATTR_UPDATES=!1;v.createDebugLogger=(t,E)=>t&&((...B)=>E.warn("DEBUG:",...B))||(()=>null);Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(v,t,E,B,u,A,x){function e(c){return{value:c.value,size:E.toPt(c.size)}}function h(c){return c.map(b=>e(b))}function d(c){return"string"===typeof c||"number"===typeof c?E.toPt(c):{type:"size",expression:c.expression,stops:h(c.stops)}}function l(c){const b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof c.field)if(c.stops){if(8<c.stops.length)return null;c=c.stops;for(var a=0;8>a;++a){const g=c[Math.min(a,c.length-1)];b.values[a]=g.value;b.opacities[a]=g.opacity}}else return null;
else if(c.stops&&0<=c.stops.length)for(c=c.stops&&0<=c.stops.length&&c.stops[0].opacity,a=0;8>a;a++)b.values[a]=Infinity,b.opacities[a]=c;else return null;return b}function m(c,b,a){c[4*b]=a.r/255;c[4*b+1]=a.g/255;c[4*b+2]=a.b/255;c[4*b+3]=a.a}function r(c){if(t.isNone(c)||c.normalizationField)return null;const b={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof c.field)if(c.stops){if(8<c.stops.length)return null;b.field=
c.field;c=c.stops;for(var a=0;8>a;++a){const g=c[Math.min(a,c.length-1)];b.values[a]=g.value;m(b.colors,a,g.color)}}else return null;else if(c.stops&&0<=c.stops.length)for(c=c.stops&&0<=c.stops.length&&c.stops[0].color,a=0;8>a;a++)b.values[a]=Infinity,m(b.colors,a,c);else return null;for(c=0;32>c;c+=4)B.premultiplyAlpha(b.colors,c,!0);return b}const k=c=>{const b=[],a=[];c=h(c);const g=c.length;for(let n=0;6>n;n++){const f=c[Math.min(n,g-1)];b.push(f.value);a.push(null==f.size?u.NAN_MAGIC_NUMBER:
E.pt2px(f.size))}return{values:new Float32Array(b),sizes:new Float32Array(a)}};v.convertColorVariable=r;v.convertVisualVariables=function(c){const b=c&&0<c.length?{}:null,a=b?{}:null;if(!b)return{vvFields:b,vvRanges:a};for(const g of c)if(g.field&&(b[g.type]=g.field),"size"===g.type)switch(a.size||(a.size={}),c=g,x.getTypeOfSizeVisualVariable(c)){case A.WGLVVFlag.SIZE_MINMAX_VALUE:a.size.minMaxValue={minDataValue:c.minDataValue,maxDataValue:c.maxDataValue,minSize:d(c.minSize),maxSize:d(c.maxSize)};
break;case A.WGLVVFlag.SIZE_SCALE_STOPS:a.size.scaleStops={stops:h(c.stops)};break;case A.WGLVVFlag.SIZE_FIELD_STOPS:if(c.levels){const n={};for(const f in c.levels)n[f]=k(c.levels[f]);a.size.fieldStops={type:"level-dependent",levels:n}}else a.size.fieldStops={type:"static",...k(c.stops)};break;case A.WGLVVFlag.SIZE_UNIT_VALUE:a.size.unitValue={unit:c.valueUnit,valueRepresentation:c.valueRepresentation}}else"color"===g.type?a.color=r(g):"opacity"===g.type?a.opacity=l(g):"rotation"===g.type&&(a.rotation=
{type:g.rotationType});return{vvFields:b,vvRanges:a}};v.getVisualVariableSizeValueRepresentationRatio=function(c,b){if(!c||!b)return c;switch(b){case "radius":case "distance":return 2*c;case "area":return Math.sqrt(c)}return c};v.normalizeSizeElement=d;v.normalizeSizeStops=h;v.stopToSizeStop=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger",
"./enums","./Utils"],function(v,t,E,B,u){v.getTypeOfSizeVisualVariable=function(A){if(u.isNumber(A.minDataValue)&&u.isNumber(A.maxDataValue)&&null!=A.minSize&&null!=A.maxSize)return B.WGLVVFlag.SIZE_MINMAX_VALUE;if((A.expression&&"view.scale"===A.expression||A.valueExpression&&"$view.scale"===A.valueExpression)&&Array.isArray(A.stops))return B.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=A.field||A.expression&&"view.scale"!==A.expression||A.valueExpression&&"$view.scale"!==A.valueExpression)&&(Array.isArray(A.stops)||
"levels"in A&&A.levels))return B.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=A.field||A.expression&&"view.scale"!==A.expression||A.valueExpression&&"$view.scale"!==A.valueExpression)&&null!=A.valueUnit)return B.WGLVVFlag.SIZE_UNIT_VALUE;E.getLogger("esri.views.2d.engine.webgl").error(new t("mapview-bad-type","Found invalid size VisualVariable",A));return B.WGLVVFlag.NONE};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/BinStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z,w){const y=A.getLogger("esri.view.2d.layers.features.support.BinStore");E=function(G){function H(D,C,F,K){var J=G.call(this,D,F)||this;J.type="bin";J.events=new B;J.objectIdField="aggregateId";J.featureAdapter=n.featureAdapter;J._geohashLevel=5;J._geohashBuf=[];J._serviceInfo=K;J.geometryInfo=D.geometryInfo;J._spatialReference=C;J._projectionSupportCheck=a.checkProjectionSupport(C,p.WGS84);J._bitsets.geohash=F.getBitset(F.createBitset());J._bitsets.inserted=
F.getBitset(F.createBitset());return J}t._inheritsLoose(H,G);var I=H.prototype;I.destroy=function(){this._tree&&this._tree.destroy()};I.updateSchema=function(){var D=t._asyncToGenerator(function*(C,F){const K=this._schema;try{yield G.prototype.updateSchema.call(this,C,F),yield this._projectionSupportCheck}catch(P){}this._fields=this._schema.params.fields;const J=e.diff(K,F);if(!F||x.isNone(J)&&!C.source&&!C.storage.filters)K&&(C.mesh=!0);else{if(e.hasDiff(J,"params.fields")||e.hasDiff(J,"params")||
!this._tree||C.source)this._tree&&this._tree.destroy(),this._tree=new h.GeohashTree(this._statisticFields,this._serviceInfo),this._tree.onRelease=P=>P.displayId&&this._storage.releaseDisplayId(P.displayId),this._geohashLevel=this._schema.params.fixedBinLevel,this._rebuildTree(),u("esri-2d-update-debug")&&y.info("Aggregate mesh needs update due to tree changing");u("esri-2d-update-debug")&&y.info("Aggregate mesh needs update due to tree changing");C.targets[F.name]=!0;C.mesh=!1}});return function(C,
F){return D.apply(this,arguments)}}();I.clear=function(){this._rebuildTree()};I.sweepFeatures=function(D,C){this._bitsets.inserted.forEachSet(F=>{D.has(F)||(F=C.lookupByDisplayIdUnsafe(F),this._remove(F))})};I.sweepAggregates=function(D,C,F){};I.onTileData=function(D,C,F,K,J=!0){if(!this._schema||x.isNone(C.addOrUpdate))return C;this.events.emit("changed");var P=this._getTransforms(D,this._spatialReference);const S=C.addOrUpdate.getCursor();for(;S.next();)this._update(S,K);if(C.status.mesh||!J)return C;
K=[];this._getBinsForTile(K,D,P,F);C.addOrUpdate=q.FeatureSetReaderJSON.fromOptimizedFeatures(K,{...this._serviceInfo,geometryType:"esriGeometryPolygon"});C.addOrUpdate.attachStorage(F);C.end=!0;C.isRepush||(C.clear=!0);for(P=C.addOrUpdate.getCursor();P.next();)K=P.getDisplayId(),this._bitsets.computed.unset(K),this.setComputedAttributes(F,P,K,D.scale);return C};I.forEachBin=function(D){this._tree.forEach(D)};I.forEach=function(D){this._tree.forEach(C=>{C.depth===this._geohashLevel&&(C=this._toFeatureJSON(C),
C=q.FeatureSetReaderJSON.fromFeatures([C],{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),C.next(),D(C))})};I.forEachInBounds=function(D,C){};I.forEachBounds=function(D,C,F){const {hasM:K,hasZ:J}=this.geometryInfo;for(const P of D)D=k.getBoundsOptimizedGeometry([0,0,0,0],P.readGeometry(),J,K),x.isNone(D)||C(l.fromRect(F,D))};I.toArray=function(){const D=[];this.forEach(C=>D.push(C));return D};I.onTileUpdate=function(D){};
I.getAggregate=function(D){const C=g.createDisplayId(D,!0);D=this._tree.findIf(F=>F.displayId===C);return x.applySome(D,F=>this._toFeatureJSON(F))};I.getAggregates=function(){return this._tree.findAllIf(D=>D.depth===this._geohashLevel).map(this._toFeatureJSON.bind(this))};I.getDisplayId=function(D){const C=this._tree.findIf(F=>F.id===D);return x.applySome(C,F=>F.displayId)};I.getFeatureDisplayIdsForAggregate=function(D){const C=this._tree.findIf(F=>F.id===D);return x.mapOr(C,[],F=>Array.from(F.displayIds))};
I.getDisplayIdForReferenceId=function(D){const C=this._tree.findIf(F=>1===F.displayIds.size&&F.displayIds.has(D));return x.applySome(C,F=>F.displayId)};I._toFeatureJSON=function(D){const C=this._spatialReference;return{displayId:D.displayId,attributes:D.getAttributes(),geometry:k.convertToGeometry(D.getGeometry(C),"esriGeometryPolygon",!1,!1),centroid:null}};I._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};I._remove=function(D){const C=
D.getDisplayId(),F=D.getXHydrated(),K=D.getYHydrated(),J=this._geohashBuf[2*C],P=this._geohashBuf[2*C+1];this._bitsets.inserted.has(C)&&(this._bitsets.inserted.unset(C),this._tree.removeCursor(D,F,K,J,P,this._geohashLevel))};I._update=function(D,C){const F=D.getDisplayId(),K=this._bitsets.inserted;C=C.isVisible(F);var J=K.has(F);C!==J&&(C?(C=D.getXHydrated(),J=D.getYHydrated(),this._setGeohash(F,C,J)&&(this._tree.insertCursor(D,F,C,J,this._geohashBuf[2*F],this._geohashBuf[2*F+1],this._geohashLevel),
K.set(F))):this._remove(D))};I._setGeohash=function(D,C,F){if(this._bitsets.geohash.has(D))return!0;const K=this._geohashBuf;if(this._spatialReference.isWebMercator)C=C/m.earth.radius*57.29577951308232,d.setGeohashBuf(K,D,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-F/m.earth.radius))),C-360*Math.floor((C+180)/360),12);else{F=a.project({x:C,y:F},this._spatialReference,p.WGS84);if(!F)return!1;d.setGeohashBuf(K,D,F.y,F.x,12)}this._bitsets.geohash.set(D);return!0};I._getBinsForTile=function(D,
C,F,K){try{var J=this._getGeohashBounds(C);const P=this._tree.getBins(J);for(const S of P){S.displayId||(S.displayId=K.createDisplayId(!0));J=null;const X=S.getGeometry(this._spatialReference,F.tile);X||(J=S.getGeometryCentroid(this._spatialReference,F.tile));const ha=new c.OptimizedFeature(X,S.getAttributes(),J);ha.objectId=S.id;ha.displayId=S.displayId;D.push(ha)}}catch(P){y.error("Unable to get bins for tile",C.key.id)}};I._getGeohash=function(D,C,F){const K={geohashX:0,geohashY:0};d.setGeohashXY(K,
C,D,F);return K};I._getGeohashBounds=function(D){const C=this._getGeohashLevel(D.key.level),F=[D.extent.xmin,D.extent.ymin,D.extent.xmax,D.extent.ymax];var K=z.fromExtent(w.fromBounds(F,this._spatialReference));D=a.project(K,this._spatialReference,p.WGS84,{densificationStep:64*D.resolution});D=k.convertFromPolygon(new b,D,!1,!1);var J=D.coords.filter((S,X)=>!(X%2)),P=D.coords.filter((S,X)=>X%2);D=Math.min(...J);K=Math.min(...P);J=Math.max(...J);P=Math.max(...P);D=this._getGeohash(D,K,C);K=this._getGeohash(J,
P,C);return{bounds:F,geohashBounds:{xLL:D.geohashX,yLL:D.geohashY,xTR:K.geohashX,yTR:K.geohashY},level:C}};I._getGeohashLevel=function(D){return this._schema.params.fixedBinLevel};I._getTransforms=function(D,C){const F={originPosition:"upperLeft",scale:[D.resolution,D.resolution],translate:[D.bounds[0],D.bounds[3]]};C=r.getInfo(C);if(!C)return{tile:F,left:null,right:null};const [K,J]=C.valid;return{tile:F,left:{...F,translate:[J,D.bounds[3]]},right:{...F,translate:[K-J+D.bounds[0],D.bounds[3]]}}};
t._createClass(H,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},{key:"fields",get:function(){return this._fields}}]);return H}(f.Store2D);v.BinStore=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../geometry/SpatialReference ../layers/graphics/featureConversionUtils ../layers/graphics/OptimizedGeometry ../layers/graphics/data/projectionSupport ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),
function(v,t,E,B,u,A,x,e,h,d){let l=function(){function r(c=[],b,a=8096){this.onRelease=g=>{};this._nodes=0;this._root=new m(this,0,0,0);this._statisticFields=c;this._pool=a?new E(8096):null;this._serviceInfo=b}var k=r.prototype;k.destroy=function(){this.clear()};k._acquire=function(c,b,a){this._nodes++;let g=null;B.isSome(this._pool)&&(g=this._pool.dequeue());B.isSome(g)?g.realloc(c,b,a):g=new m(this,c,b,a);return g};k._release=function(c){this.onRelease(c);this._nodes--;B.isSome(this._pool)&&this._pool.enqueue(c)};
k.dropLevels=function(c){this.forEach(b=>{if(b.depth>=c)for(let a=0;a<b.children.length;a++){const g=b.children[a];g&&this._release(g)}});this.forEach(b=>{if(b.depth>=c)for(let a=0;a<b.children.length;a++)b.children[a]=null})};k.clear=function(){this.forEach(c=>this._release(c));this._root=new m(this,0,0,0)};k.insert=function(c,b,a=0){const g=d.FeatureSetReaderJSON.fromOptimizedFeatures([c],this._serviceInfo).getCursor();g.next();const n=g.readGeometry();if(n){var [f,q]=n.coords;this.insertCursor(g,
c.displayId,f,q,c.geohashX,c.geohashY,b,a)}};k.insertCursor=function(c,b,a,g,n,f,q,p=0){let z=this._root,w=0,y=0,G=0;for(;null!==z;){z.depth>=p&&(z.count+=1,z.xTotal+=a,z.yTotal+=g,z.xGeohashTotal+=n,z.yGeohashTotal+=f,z.referenceId=b,this._updateStatisticsCursor(c,z,1));if(w>=q){z.add(b);break}var H=Math.ceil((w+1)/2),I=Math.floor((w+1)/2);const C=1-w%2;var D=30-(3*H+2*I);H=30-(2*H+3*I);D=(n&7*C+3*(1-C)<<D)>>D;H=(f&3*C+7*(1-C)<<H)>>H;I=D+H*(8*C+4*(1-C));const F=2*C+3*(1-C);y=y<<3*C+2*(1-C)|D;G=G<<
F|H;null==z.children[I]&&(z.children[I]=this._acquire(y,G,w+1));w+=1;z=z.children[I]}};k.remove=function(c,b){const a=d.FeatureSetReaderJSON.fromOptimizedFeatures([c],this._serviceInfo).getCursor();a.next();const g=a.readGeometry();if(g){var [n,f]=g.coords;this.removeCursor(a,n,f,c.geohashX,c.geohashY,b)}};k.removeCursor=function(c,b,a,g,n,f){let q=this._root,p=0;for(;null!==q;){--q.count;q.xTotal-=b;q.yTotal-=a;q.xGeohashTotal-=g;q.yGeohashTotal-=n;this._updateStatisticsCursor(c,q,-1);if(p>=f){q.remove(c.getDisplayId());
break}var z=Math.ceil((p+1)/2);const G=Math.floor((p+1)/2);var w=1-p%2,y=30-(3*z+2*G);z=30-(2*z+3*G);w=((g&7*w+3*(1-w)<<y)>>y)+((n&3*w+7*(1-w)<<z)>>z)*(8*w+4*(1-w));y=q.children[w];1===y?.count&&(this._release(y),q.children[w]=null);p+=1;q=y}};k.forEach=function(c){let b=this._root;for(;null!==b;){const a=this._linkChildren(b)||b.next;c(b);b=a}};k.find=function(c,b,a){return this._root.find(c,b,a,0,0,0)};k.findIf=function(c){let b=null;this.forEach(a=>{c(a)&&(b=a)});return b};k.findAllIf=function(c){const b=
[];this.forEach(a=>{c(a)&&b.push(a)});return b};k.findSingleOccupancyNode=function(c,b,a,g,n){let f=this._root;for(;null!==f;){var q=f.depth,p=f.xNode,z=f.yNode;const D=1-q%2;var w=f.xGeohashTotal/f.count,y=f.yGeohashTotal/f.count;if(1===f.count&&c<w&&w<=a&&b<y&&y<=g)return f;if(q>=n)f=f.next;else{y=Math.ceil((q+1)/2);q=Math.floor((q+1)/2);w=30-(3*y+2*q);var G=30-(2*y+3*q),H=~((1<<w)-1),I=~((1<<G)-1);p<<=3*D+2*(1-D);z<<=2*D+3*(1-D);q=Math.max(p,(c&H)>>w);y=Math.max(z,(b&I)>>G);w=Math.min(p+8*D+4*
(1-D),(a&H)>>w);G=Math.min(z+4*D+8*(1-D),(g&I)>>G);for(H=I=null;y<=G;y++)for(let C=q;C<=w;C++){const F=f.children[C-p+(y-z)*(8*D+4*(1-D))];F&&(I||(I=F,I.next=f.next),H&&(H.next=F),H=F,F.next=f.next)}f=I||f.next}}return null};k.getRegionDisplayIds=function(c){let b=this._root;const {bounds:a,geohashBounds:g,level:n}=c,[f,q,p,z]=a,w=[];for(;null!==b;){c=b.depth;var y=b.xNode,G=b.yNode;if(c>=n)c=b.xTotal/b.count,y=b.yTotal/b.count,c>=f&&c<=p&&y>=q&&y<=z&&b.displayIds.forEach(J=>w.push(J)),b=b.next;else{var H=
Math.ceil((c+1)/2),I=Math.floor((c+1)/2);c=1-c%2;var D=30-(3*H+2*I),C=30-(2*H+3*I),F=~((1<<D)-1),K=~((1<<C)-1);y<<=3*c+2*(1-c);G<<=2*c+3*(1-c);H=Math.max(y,(g.xLL&F)>>D);I=Math.max(G,(g.yLL&K)>>C);D=Math.min(y+8*c+4*(1-c),(g.xTR&F)>>D);C=Math.min(G+4*c+8*(1-c),(g.yTR&K)>>C);for(F=K=null;I<=C;I++)for(let J=H;J<=D;J++){const P=b.children[J-y+(I-G)*(8*c+4*(1-c))];P&&(K||(K=P,K.next=b.next),F&&(F.next=P),F=P,P.next=b.next)}b=K||b.next}}return w};k.getRegionStatistics=function(c){var b=this._root;let a=
0,g=0,n=0;const f={},{bounds:q,geohashBounds:p,level:z}=c,[w,y,G,H]=q;for(c=0;null!==b;){var I=b.depth,D=b.xNode,C=b.yNode;if(I>=z)I=b.xTotal/b.count,D=b.yTotal/b.count,I>w&&I<=G&&D>y&&D<=H&&(a+=b.count,g+=b.xTotal,n+=b.yTotal,1===b.count&&(c=b.referenceId),this._aggregateStatistics(f,b.statistics)),b=b.next;else{var F=Math.ceil((I+1)/2),K=Math.floor((I+1)/2);I=1-I%2;var J=30-(3*F+2*K),P=30-(2*F+3*K),S=~((1<<J)-1),X=~((1<<P)-1);D<<=3*I+2*(1-I);C<<=2*I+3*(1-I);F=Math.max(D,(p.xLL&S)>>J);K=Math.max(C,
(p.yLL&X)>>P);J=Math.min(D+8*I+4*(1-I),(p.xTR&S)>>J);P=Math.min(C+4*I+8*(1-I),(p.yTR&X)>>P);S=X=null;for(let ha=K;ha<=P;ha++)for(let U=F;U<=J;U++){const Q=b.children[U-D+(ha-C)*(8*I+4*(1-I))];if(Q)if(ha!==K&&ha!==P&&U!==F&&U!==J){const O=Q.xTotal/Q.count,R=Q.yTotal/Q.count;O>w&&O<=G&&R>y&&R<=H&&(a+=Q.count,g+=Q.xTotal,n+=Q.yTotal,1===Q.count&&(c=Q.referenceId),this._aggregateStatistics(f,Q.statistics))}else X||(X=Q,X.next=b.next),S&&(S.next=Q),S=Q,Q.next=b.next}b=X||b.next}}b=this.normalizeStatistics(f,
a);return{count:a,attributes:b,xTotal:g,yTotal:n,referenceId:c}};k.getBins=function(c){const b=[],{geohashBounds:a,level:g}=c;for(c=this._root;null!==c;){var n=c.depth,f=c.xNode,q=c.yNode;if(n>=g)b.push(c),c=c.next;else{var p=Math.ceil((n+1)/2),z=Math.floor((n+1)/2);n=1-n%2;var w=30-(3*p+2*z),y=30-(2*p+3*z),G=~((1<<w)-1),H=~((1<<y)-1);f<<=3*n+2*(1-n);q<<=2*n+3*(1-n);p=Math.max(f,(a.xLL&G)>>w);z=Math.max(q,(a.yLL&H)>>y);w=Math.min(f+8*n+4*(1-n),(a.xTR&G)>>w);y=Math.min(q+4*n+8*(1-n),(a.yTR&H)>>y);
for(G=H=null;z<=y;z++)for(let I=p;I<=w;I++){const D=c.children[I-f+(z-q)*(8*n+4*(1-n))];D&&(H||(H=D,H.next=c.next),G&&(G.next=D),G=D,D.next=c.next)}c=H||c.next}}return b};k._linkChildren=function(c){let b=null,a=null;for(let g=0;g<=c.children.length;g++){const n=c.children[g];n&&(b||(b=n,b.next=c.next),a&&(a.next=n),a=n,n.next=c.next)}return b};k._updateStatisticsCursor=function(c,b,a){for(const f of this._statisticFields){const q=f.name,p=f.inField?c.readAttribute(f.inField):c.getComputedNumericAtIndex(f.inFieldIndex);
switch(f.statisticType){case "min":if(isNaN(p))break;if(!b.statistics[q]){b.statistics[q]={value:p};break}b.statistics[q].value=Math.min(b.statistics[q].value,p);break;case "max":if(isNaN(p))break;if(!b.statistics[q]){b.statistics[q]={value:p};break}b.statistics[q].value=Math.max(b.statistics[q].value,p);break;case "sum":case "avg":b.statistics[q]||(b.statistics[q]={value:0,nanCount:0});var g=b.statistics[q].value,n=b.statistics[q].nanCount??0;null==p||isNaN(p)?b.statistics[q].nanCount=n+a:b.statistics[q].value=
g+a*p;break;case "avg_angle":b.statistics[q]||(b.statistics[q]={x:0,y:0,nanCount:0});g=b.statistics[q].x;n=b.statistics[q].y;const z=b.statistics[q].nanCount??0,w=Math.PI/180;null==p||isNaN(p)?b.statistics[q].nanCount=z+a:(b.statistics[q].x=g+a*Math.cos(p*w),b.statistics[q].y=n+a*Math.sin(p*w));break;case "mode":b.statistics[q]||(b.statistics[q]={}),b.statistics[q][p]=(b.statistics[q][p]||0)+a}}};k._aggregateStatistics=function(c,b){for(const a of this._statisticFields){const g=a.name;switch(a.statisticType){case "min":if(!c[g]){c[g]=
{value:b[g].value};break}c[g].value=Math.min(c[g].value,b[g].value);break;case "max":if(!c[g]){c[g]={value:b[g].value};break}c[g].value=Math.max(c[g].value,b[g].value);break;case "sum":case "avg":case "avg_angle":case "mode":c[g]||(c[g]={});for(const n in b[g])c[g][n]=(c[g][n]||0)+b[g][n]}}};k.normalizeStatistics=function(c,b){const a={};for(const n of this._statisticFields){const f=n.name;switch(n.statisticType){case "min":case "max":var g=c[f];if(!b||!g)break;a[f]=g.value;break;case "count":if(!b)break;
a[f]=b;break;case "sum":if(!b)break;const {value:q,nanCount:p}=c[f];if(!(b-p))break;a[f]=q;break;case "avg":if(!b)break;const {value:z,nanCount:w}=c[f];if(!(b-w))break;a[f]=z/(b-w);break;case "avg_angle":if(!b)break;const {x:y,y:G,nanCount:H}=c[f];if(!(b-H))break;a[f]=180/Math.PI*Math.atan2(G/(b-H),y/(b-H));break;case "mode":g=c[f];let I=0,D=0,C=null;for(const F in g){const K=g[F];K===I?D+=1:K>I&&(I=K,D=1,C=F)}a[f]="null"===C||1<D?null:C}}return a};t._createClass(r,[{key:"count",get:function(){return this._root.count}},
{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return B.mapOr(this._pool,0,c=>c.size)}},{key:"depth",get:function(){let c=0;this.forEach(b=>c=Math.max(c,b.depth));return c}}]);return r}(),m=function(){function r(c,b,a,g){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.referenceId=this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this._tree=c;this.children=Array(32);for(c=0;c<
this.children.length;c++)this.children[c]=null;this.xNode=b;this.yNode=a;this.depth=g}var k=r.prototype;k.realloc=function(c,b,a){for(let g=0;g<this.children.length;g++)this.children[g]=null;this.xNode=c;this.yNode=b;this.depth=a;this.next=null;this.count=this.yTotal=this.xTotal=this.referenceId=this.displayId=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};k.add=function(c){this.displayIds.add(c)};k.remove=function(c){this.displayIds.delete(c)};k.getAttributes=
function(){const c=this._tree.normalizeStatistics(this.statistics,this.count);c.referenceId=null;c.aggregateId=this.id;c.aggregateCount=this.count;return c};k.getGeometry=function(c,b){const a=this.getLngLatBounds(),[g,n,f,q]=a;c=h.project({rings:[[[g,n],[g,q],[f,q],[f,n],[g,n]]]},A.WGS84,c);c=x.convertFromPolygon(new e,c,!1,!1);return B.isSome(b)?x.quantizeOptimizedGeometry(new e,c,!1,!1,"esriGeometryPolygon",b,!1,!1):c};k.getGeometryCentroid=function(c,b){const a=this.getLngLatBounds(),[g,n,f,q]=
a;c=h.project({x:(g+f)/2,y:(n+q)/2},A.WGS84,c);c=x.convertFromPoint(new e,c);return B.isSome(b)?x.quantizeOptimizedGeometry(new e,c,!1,!1,"esriGeometryPoint",b,!1,!1):c};k.getLngLatBounds=function(){var c=this.depth;const b=Math.ceil(c/2);c=Math.floor(c/2);return u.decodeGeohashXY({geohashX:this.xNode<<30-(3*b+2*c),geohashY:this.yNode<<30-(2*b+3*c)},this.depth)};k.find=function(c,b,a,g,n,f){if(g>=a)return this;var q=1-g%2;const p=3*q+2*(1-q),z=2*q+3*(1-q),w=30-n-p,y=30-f-z;q=this.children[((c&7*q+
3*(1-q)<<w)>>w)+((b&3*q+7*(1-q)<<y)>>y)*(8*q+4*(1-q))];return null==q?null:q.find(c,b,a,g+1,n+p,f+z)};t._createClass(r,[{key:"id",get:function(){return`${this.xNode}.${this.yNode}`}}]);return r}();v.GeohashNode=m;v.GeohashTree=l;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(v){function t(l){return 57>=l?l-48:104>=l?l-88:107>=l?l-89:110>=l?l-90:l-91}function E(l,m,r){l[0]=m;l[1]=r;return l}
function B(l,m){const r=(l[0]+l[1])/2,k=!m;l[0]=k*l[0]+m*r;l[1]=k*r+m*l[1]}function u(l,m){m=m>(l[0]+l[1])/2;B(l,m);return m}function A(l,m){return m?1&l|(4&l)>>1|(16&l)>>2:(2&l)>>1|(8&l)>>2}function x(l,m){return m?(2&l)>>1|(8&l)>>2:1&l|(4&l)>>1|(16&l)>>2}function e(l,m,r){var k=!((l.length-1)%2);const c=l.substring(0,l.length-1);var b=t(l.charCodeAt(l.length-1)),a=0,g=0;let n=0;var f=0;k?(a=8,g=4,n=1&b|(4&b)>>1|(16&b)>>2,f=(2&b)>>1|(8&b)>>2):(a=4,g=8,f=1&b|(4&b)>>1|(16&b)>>2,n=(2&b)>>1|(8&b)>>2);
m=n+m;b=f+r;r=Math.floor(m/a);f=Math.floor(b/g);a=m-r*a;g=b-f*g;k="0123456789bcdefghjkmnpqrstuvwxyz"[k?a&1|(g&1)<<1|(a&2)<<1|(g&2)<<2|(a&4)<<2:g&1|(a&1)<<1|(g&2)<<1|(a&2)<<2|(g&4)<<2];return 1<l.length&&(r||f)?e(c,r,f)+k:c+k}const h=new Float64Array(2),d=new Float64Array(2);v.convertGeohash32ToXY=function(l,m){let r=l=0,k=30,c=30;for(let g=0;g<m.length;g++){var b=m.charCodeAt(g),a=t(b);b=0===g%2;const n=A(a,b);a=x(a,b);k-=b?3:2;c-=b?2:3;l|=n<<k;r|=a<<c}return{geohashX:l,geohashY:r}};v.decodeBase32Char=
t;v.decodeGeohash=function(l,m){const r=E(h,-90,90),k=E(d,-180,180);for(let b=0;b<m.length;b++){var c=m.charCodeAt(b);c=t(c);0===b%2?(B(k,!!(16&c)),B(k,!!(4&c)),B(k,!!(1&c)),B(r,!!(8&c)),B(r,!!(2&c))):(B(r,!!(16&c)),B(r,!!(4&c)),B(r,!!(1&c)),B(k,!!(8&c)),B(k,!!(2&c)))}l[0]=(r[0]+r[1])/2;l[1]=(k[0]+k[1])/2;return l};v.decodeGeohashXY=function(l,m){let r=-90,k=90,c=-180,b=180;for(let p=0;p<m;p++){var a=Math.ceil((p+1)/2),g=Math.floor((p+1)/2),n=1-p%2,f=30-(3*a+2*g),q=30-(2*a+3*g);g=3*n+2*(1-n);a=2*
n+3*(1-n);f=(7*n+3*(1-n)<<f&l.geohashX)>>f;n=(3*n+7*(1-n)<<q&l.geohashY)>>q;for(--g;0<=g;g--){q=(c+b)/2;const z=f&1<<g?1:0;c=(1-z)*c+z*q;b=(1-z)*q+z*b}for(--a;0<=a;a--)f=(r+k)/2,g=n&1<<a?1:0,r=(1-g)*r+g*f,k=(1-g)*f+g*k}return[c,r,b,k]};v.encodeBase32Char=function(l){return"0123456789bcdefghjkmnpqrstuvwxyz"[l]};v.encodeGeohash=function(l,m,r){let k="";const c=E(h,-90,90),b=E(d,-180,180);for(let a=0;a<r;a++){let g=0;a%2?(g|=u(c,l)<<4,g|=u(b,m)<<3,g|=u(c,l)<<2,g|=u(b,m)<<1,g|=u(c,l)<<0):(g|=u(b,m)<<
4,g|=u(c,l)<<3,g|=u(b,m)<<2,g|=u(c,l)<<1,g|=u(b,m)<<0);k+="0123456789bcdefghjkmnpqrstuvwxyz"[g]}return k};v.getRelativeGeohash=e;v.latDistPerGeohash=function(l){return 180/2**Math.floor(5*l/2)};v.lonDistPerGeohash=function(l){return 360/2**Math.ceil(5*l/2)};v.setGeohashBuf=function(l,m,r,k,c){c%2&&(c+=1);let b=0,a=0,g=-90,n=90,f=-180,q=180;for(let y=0;y<c/2;y++){for(var p=0;5>p;p++){var z=(f+q)/2,w=k>z?1:0;b|=w<<29-(p+5*y);f=(1-w)*f+w*z;q=(1-w)*z+w*q}for(p=0;5>p;p++)z=(g+n)/2,w=r>z?1:0,a|=w<<29-(p+
5*y),g=(1-w)*g+w*z,n=(1-w)*z+w*n}l[2*m]=b;l[2*m+1]=a};v.setGeohashXY=function(l,m,r,k){k%2&&(k+=1);let c=0,b=0,a=-90,g=90,n=-180,f=180;for(let w=0;w<k/2;w++){for(var q=0;5>q;q++){var p=(n+f)/2,z=r>p?1:0;c|=z<<29-(q+5*w);n=(1-z)*n+z*p;f=(1-z)*p+z*f}for(q=0;5>q;q++)p=(a+g)/2,z=m>p?1:0,b|=z<<29-(q+5*w),a=(1-z)*a+z*p,g=(1-z)*p+z*g}l.geohashX=c;l.geohashY=b};v.unpackXBits=A;v.unpackYBits=x;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z,w){let y=function(G){function H(D,C,F,K,J){C=new c([],[C,F]);D=G.call(this,C,K,null,D)||this;D.geohashBoundsInfo=J;return D}t._inheritsLoose(H,G);H.create=function(D,C,F,K,J,P,S,X){C=new H(C,F,K,P,S);C.displayId=D.createDisplayId(!0);C.referenceId=X;C.tileLevel=J;return C};var I=H.prototype;I.update=function(D,C,F,K,J,P){this.geometry.coords[0]=D;this.geometry.coords[1]=C;this.tileLevel=F;this.attributes=K;this.geohashBoundsInfo=J;this.referenceId=
null;this.referenceId=P;return this};I.toJSON=function(){return{attributes:{...this.attributes,aggregateId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};t._createClass(H,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return H}(k.OptimizedFeatureWithGeometry);E=function(G){function H(D,C,F,K){var J=G.call(this,D,F)||this;J.type="cluster";J.events=new B;J.objectIdField="aggregateId";
J.featureAdapter=n.featureAdapter;J._geohashLevel=0;J._tileLevel=0;J._aggregateValueRanges={};J._aggregateValueRangesChanged=!1;J._geohashBuf=[];J._clusters=new Map;J._tiles=new Map;J._serviceInfo=K;J.geometryInfo=D.geometryInfo;J._spatialReference=C;J._projectionSupportCheck=b.checkProjectionSupport(C,p.WGS84);J._bitsets.geohash=F.getBitset(F.createBitset());J._bitsets.inserted=F.getBitset(F.createBitset());return J}t._inheritsLoose(H,G);var I=H.prototype;I.destroy=function(){this._tree.destroy()};
I.updateSchema=function(){var D=t._asyncToGenerator(function*(C,F){const K=this._schema;try{yield G.prototype.updateSchema.call(this,C,F),yield this._projectionSupportCheck}catch(P){}this._fields=this._schema.params.fields;const J=x.diff(K,F);if(!F||A.isNone(J)&&!C.source&&!C.storage.filters)K&&(C.mesh=!0);else{if(x.hasDiff(J,"params.fields")||!this._tree||C.source)this._tree&&this._tree.destroy(),this._tree=new e.GeohashTree(this._statisticFields,this._serviceInfo),this._rebuildTree(),u("esri-2d-update-debug")&&
console.debug("Aggregate mesh needs update due to tree changing");u("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",J);C.targets[F.name]=!0;C.mesh=!1;this._aggregateValueRanges={}}});return function(C,F){return D.apply(this,arguments)}}();I.clear=function(){this._rebuildTree()};I.sweepFeatures=function(D,C){this._bitsets.inserted.forEachSet(F=>{D.has(F)||(F=C.lookupByDisplayIdUnsafe(F),this._remove(F))})};I.sweepAggregates=function(D,C,F){this._clusters.forEach((K,J)=>{K&&
K.tileLevel!==F&&(D.releaseDisplayId(K.displayId),C.unsetAttributeData(K.displayId),this._clusters.delete(J))})};I.onTileData=function(D,C,F,K,J=!0){if(!this._schema||A.isNone(C.addOrUpdate))return C;this.events.emit("changed");var P=this._getTransforms(D,this._spatialReference);const S=C.addOrUpdate.getCursor();for(;S.next();)this._update(S,K);if(C.status.mesh||!J)return C;K=[];this._getClustersForTile(K,D,this._schema.params.clusterRadius,F,P);C.addOrUpdate=q.FeatureSetReaderJSON.fromOptimizedFeatures(K,
this._serviceInfo);C.addOrUpdate.attachStorage(F);C.clear=!0;C.end=!0;for(P=C.addOrUpdate.getCursor();P.next();)K=P.getDisplayId(),this._bitsets.computed.unset(K),this.setComputedAttributes(F,P,K,D.scale);this._aggregateValueRangesChanged&&C.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return C};I.onTileUpdate=function({added:D,removed:C}){D.length&&(this._tileLevel=D=D[0].level,this._setGeohashLevel(D));if(this._schema){var F=
this._schema.params.clusterRadius;C.forEach(K=>{this._tiles.delete(K.key.id);this._markTileClustersForDeletion(K,F)})}};I.getAggregate=function(D){for(const C of this._clusters.values())if((C?.displayId&g.DISPLAY_ID_TEXEL_MASK)===(D&g.DISPLAY_ID_TEXEL_MASK))return C.toJSON();return null};I.getAggregates=function(){const D=[];for(const C of this._clusters.values())C?.tileLevel===this._tileLevel&&D.push(C.toJSON());return D};I.getDisplayId=function(D){return(D=this._clusters.get(D))?D.displayId:null};
I.getFeatureDisplayIdsForAggregate=function(D){return(D=this._clusters.get(D))?this._tree.getRegionDisplayIds(D.geohashBoundsInfo):[]};I.getDisplayIdForReferenceId=function(D){for(const C of this._clusters.values())if(C?.referenceId===D)return C.displayId;return null};I.getAggregateValueRanges=function(){return this._aggregateValueRanges};I.forEach=function(D){this._clusters.forEach(C=>{C&&(C=C.toJSON(),C=q.FeatureSetReaderJSON.fromFeatures([C],{objectIdField:this.objectIdField,globalIdField:null,
geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),C.next(),D(C))})};I.forEachInBounds=function(D,C){};I.forEachBounds=function(D,C,F){const {hasM:K,hasZ:J}=this.geometryInfo;for(const P of D)D=r.getBoundsOptimizedGeometry([0,0,0,0],P.readGeometry(),J,K),A.isNone(D)||C(d.fromRect(F,D))};I.toArray=function(){const D=[];this.forEach(C=>D.push(C));return D};I.size=function(){let D=0;this.forEach(C=>D++);return D};I._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();
this._tree&&this._tree.clear()};I._remove=function(D){const C=D.getDisplayId(),F=D.getXHydrated(),K=D.getYHydrated(),J=this._geohashBuf[2*C],P=this._geohashBuf[2*C+1];this._bitsets.inserted.has(C)&&(this._bitsets.inserted.unset(C),this._tree.removeCursor(D,F,K,J,P,this._geohashLevel))};I._update=function(D,C){const F=D.getDisplayId(),K=this._bitsets.inserted;C=C.isVisible(F);var J=K.has(F);C!==J&&(C?(C=D.getXHydrated(),J=D.getYHydrated(),this._setGeohash(F,C,J)&&(this._tree.insertCursor(D,F,C,J,this._geohashBuf[2*
F],this._geohashBuf[2*F+1],this._geohashLevel),K.set(F))):this._remove(D))};I._setGeohash=function(D,C,F){if(this._bitsets.geohash.has(D))return!0;const K=this._geohashBuf;if(this._spatialReference.isWebMercator)C=C/l.earth.radius*57.29577951308232,h.setGeohashBuf(K,D,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-F/l.earth.radius))),C-360*Math.floor((C+180)/360),12);else{F=b.project({x:C,y:F},this._spatialReference,p.WGS84);if(!F)return!1;h.setGeohashBuf(K,D,F.y,F.x,12)}this._bitsets.geohash.set(D);
return!0};I._getClustersForTile=function(D,C,F,K,J,P=!0){var S=2*F;F=Math.ceil(2**C.key.level*a.TILE_SIZE/S)+1;var X=Math.ceil(this._schema.params.clusterPixelBuffer/S)+0,ha=Math.ceil(a.TILE_SIZE/S);const {row:U,col:Q}=C.key;var O=Math.floor(Q*a.TILE_SIZE/S)-X;S=Math.floor(U*a.TILE_SIZE/S)-X;const R=O+ha+2*X;X=S+ha+2*X;for(ha=C.tileInfoView.getLODInfoAt(C.key.level);O<=R;O++)for(let ka=S;ka<=X;ka++){var V=O;ha.wrap&&(V=0>O?O+F:O%F);const ia=ha.wrap&&0>O,wa=ha.wrap&&O%F!==O;V=this._lookupCluster(K,
ha,C.key.level,V,ka,C);if(A.isSome(V)){var Z=A.applySome(J,ea=>ia?ea.left:wa?ea.right:ea.tile);if((!P||!A.isNone(Z))&&V.count&&A.isSome(Z)&&P){const ea=V.geometry.clone();let L=V.attributes;ea.coords[0]=r.quantizeX(Z,ea.coords[0]);ea.coords[1]=r.quantizeY(Z,ea.coords[1]);1===V.count&&A.isSome(V.referenceId)&&(L={...V.attributes,referenceId:V.referenceId});Z=new k.OptimizedFeature(ea,L);Z.displayId=V.displayId;D.push(Z)}}}};I._getGeohashLevel=function(D){return Math.min(Math.ceil(D/2+2),12)};I._setGeohashLevel=
function(D){D=this._getGeohashLevel(D);D=1*(Math.floor(D/1)+1)-1;this._geohashLevel!==D&&(this._geohashLevel=D,this._rebuildTree(),this._bitsets.geohash.clear())};I._getTransforms=function(D,C){const F={originPosition:"upperLeft",scale:[D.resolution,D.resolution],translate:[D.bounds[0],D.bounds[3]]};C=m.getInfo(C);if(!C)return{tile:F,left:null,right:null};const [K,J]=C.valid;return{tile:F,left:{...F,translate:[J,D.bounds[3]]},right:{...F,translate:[K-J+D.bounds[0],D.bounds[3]]}}};I._getClusterId=
function(D,C,F){return(D&15)<<28|(C&16383)<<14|F&16383};I._markForDeletion=function(D,C,F){D=this._getClusterId(D,C,F);this._clusters.delete(D)};I._getClusterBounds=function(D,C,F){var K=this._schema.params.clusterRadius,J=2*K;C=F%2?C*J:C*J-K;const P=F*J;K=C+J;F=2**D.level*a.TILE_SIZE;D.wrap&&0>C&&(C=0);D.wrap&&K>F&&(K=F);F=P/a.TILE_SIZE;K/=a.TILE_SIZE;J=(P-J)/a.TILE_SIZE;C=D.getXForColumn(C/a.TILE_SIZE);F=D.getYForRow(F);K=D.getXForColumn(K);D=D.getYForRow(J);return[C,F,K,D]};I._getGeohash=function(D,
C,F){const K={geohashX:0,geohashY:0};h.setGeohashXY(K,C,D,F);return K};I._getGeohashBounds=function(D,C){const F=this._getGeohashLevel(D.key.level);if(this._spatialReference.isWebMercator){const [ha,U,Q,O]=C;var K=U,J=Q,P=O,S=D=C=0,X=0;C=ha/l.earth.radius*57.29577951308232;C-=360*Math.floor((C+180)/360);D=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-K/l.earth.radius)));S=J/l.earth.radius*57.29577951308232;S-=360*Math.floor((S+180)/360);X=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-P/
l.earth.radius)));P={geohashX:0,geohashY:0};K={geohashX:0,geohashY:0};h.setGeohashXY(P,D,C,F);h.setGeohashXY(K,X,S,F);return{bounds:[ha,U,Q,O],geohashBounds:{xLL:P.geohashX,yLL:P.geohashY,xTR:K.geohashX,yTR:K.geohashY},level:F}}P=z.fromExtent(w.fromBounds(C,this._spatialReference));D=b.project(P,this._spatialReference,p.WGS84,{densificationStep:64*D.resolution});if(!D)return null;D=r.convertFromPolygon(new c,D,!1,!1);S=D.coords.filter((ha,U)=>!(U%2));X=D.coords.filter((ha,U)=>U%2);D=Math.min(...S);
P=Math.min(...X);S=Math.max(...S);X=Math.max(...X);D=this._getGeohash(D,P,F);P=this._getGeohash(S,X,F);return{bounds:C,geohashBounds:{xLL:D.geohashX,yLL:D.geohashY,xTR:P.geohashX,yTR:P.geohashY},level:F}};I._lookupCluster=function(D,C,F,K,J,P){const S=this._getClusterId(F,K,J),X=this._clusters.get(S);C=this._getClusterBounds(C,K,J);P=this._getGeohashBounds(P,C);if(A.isNone(P))return null;var ha=this._tree.getRegionStatistics(P);const {count:U,xTotal:Q,yTotal:O,referenceId:R}=ha;K=U?Q/U:0;J=U?O/U:
0;if(0===U)return this._clusters.set(S,null),null;ha={cluster_count:U,...ha.attributes};D=A.isSome(X)?X.update(K,J,F,ha,P,R):y.create(D,S,K,J,F,ha,P,R);if(0===U){const [V,Z,ka,ia]=C;D.geometry.coords[0]=(V+ka)/2;D.geometry.coords[1]=(Z+ia)/2}this._clusters.set(S,D);this._updateAggregateValueRangeForCluster(D,D.tileLevel);return D};I._updateAggregateValueRangeForCluster=function(D,C){const F=this._aggregateValueRanges[C]||{minValue:Infinity,maxValue:0},K=F.minValue,J=F.maxValue;F.minValue=Math.min(K,
D.count);F.maxValue=Math.max(J,D.count);this._aggregateValueRanges[C]=F;if(K!==F.minValue||J!==F.maxValue)this._aggregateValueRangesChanged=!0};I._markTileClustersForDeletion=function(D,C){var F=2*C;C=Math.ceil(a.TILE_SIZE/F);const {row:K,col:J}=D.key,P=Math.floor(J*a.TILE_SIZE/F);F=Math.floor(K*a.TILE_SIZE/F);for(let S=P;S<P+C;S++)for(let X=F;X<F+C;X++)this._markForDeletion(D.key.level,S,X)};t._createClass(H,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},{key:"fields",
get:function(){return this._fields}}]);return H}(f.Store2D);v.ClusterInfo=y;v.ClusterStore=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(v,t,E,B){function u(x,e,h){if(!(x.length>e))for(;x.length<=e;)x.push(h)}let A=function(){function x(){this._numerics=[];this._strings=[];this._idGenerator=
new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var e=x.prototype;e.createBitset=function(){const h=this._bitsets.length;this._bitsets.push(B.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));return h+1};e.getBitset=function(h){return this._bitsets[h-1]};e._expand=function(){this._allocatedSize<<=1;for(const h of this._bitsets)h.resize(this._allocatedSize)};e._ensureNumeric=function(h,d){this._numerics[h]||(this._numerics[h]=[]);
u(this._numerics[h],d,0)};e._ensureInstanceId=function(h){u(this._instanceIds,h,0)};e._ensureString=function(h,d){this._strings[h]||(this._strings[h]=[]);u(this._strings[h],d,null)};e.createDisplayId=function(h=!1){const d=this._idGenerator.createId();d>this._allocatedSize&&this._expand();return t.createDisplayId(d,h)};e.releaseDisplayId=function(h){for(const d of this._bitsets)d.unset(h);return this._idGenerator.releaseId(h&t.DISPLAY_ID_TEXEL_MASK)};e.getComputedNumeric=function(h,d){return this.getComputedNumericAtIndex(h&
t.DISPLAY_ID_TEXEL_MASK,0)};e.setComputedNumeric=function(h,d,l){return this.setComputedNumericAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,l,0)};e.getComputedString=function(h,d){return this.getComputedStringAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,0)};e.setComputedString=function(h,d,l){return this.setComputedStringAtIndex(h&t.DISPLAY_ID_TEXEL_MASK,0,l)};e.getComputedNumericAtIndex=function(h,d){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(d,h);return this._numerics[d][h]};e.setComputedNumericAtIndex=function(h,
d,l){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(d,h);this._numerics[d][h]=l};e.getInstanceId=function(h){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(h);return this._instanceIds[h]};e.setInstanceId=function(h,d){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(h);this._instanceIds[h]=d};e.getComputedStringAtIndex=function(h,d){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(d,h);return this._strings[d][h]};e.setComputedStringAtIndex=function(h,d,l){h&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(d,
h);this._strings[d][h]=l};e.getXMin=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)]};e.getYMin=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+1]};e.getXMax=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+2]};e.getYMax=function(h){return this._bounds[4*(h&t.DISPLAY_ID_TEXEL_MASK)+3]};e.setBounds=function(h,d){d=d.readHydratedGeometry();if(!d||!d.coords.length)return!1;let l=Infinity,m=Infinity,r=-Infinity,k=-Infinity;d.forEachVertex((c,b)=>{l=Math.min(l,
c);m=Math.min(m,b);r=Math.max(r,c);k=Math.max(k,b)});h&=t.DISPLAY_ID_TEXEL_MASK;u(this._bounds,4*h+4,0);this._bounds[4*h]=l;this._bounds[4*h+1]=m;this._bounds[4*h+2]=r;this._bounds[4*h+3]=k;return!0};return x}();v.ComputedAttributeStorage=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(v,t){let E=function(){function B(){this._freeIds=
[];this._idCounter=1}var u=B.prototype;u.createId=function(A=!1){return t.createDisplayId(this._getFreeId(),A)};u.releaseId=function(A){this._freeIds.push(A)};u._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return B}();v.DisplayIdGenerator=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(v,t,E,B,u,A,x){const e={added:[],removed:[]},h=new Set,d=new x(0,0,0,0);return function(l){function m(k){var c=l.call(this)||this;c._tiles=new Map;c._index=B.rbush(9,E("esri-csp-restrictions")?b=>({minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);c.tiles=[];c.tileScheme=k;return c}v._inheritsLoose(m,l);var r=m.prototype;r.destroy=function(){this.clear()};r.clear=function(){this.tiles.length=0;this._tiles.clear();
this._index.clear()};r.has=function(k){return this._tiles.has(k)};r.get=function(k){return this._tiles.get(k)};r.boundsIntersections=function(k){return this._index.search({minX:k[0],minY:k[1],maxX:k[2],maxY:k[3]})};r.updateTiles=function(k){const c={added:[],removed:[]};for(const b of k.added)if(!this.has(b)){const a=new u.Tile(this.tileScheme,b);this._tiles.set(b,a);this._index.insert(a);c.added.push(a)}for(const b of k.removed)this.has(b)&&(k=this.get(b),this._tiles.delete(b),this._index.remove(k),
c.removed.push(k));this.tiles.length=0;this._tiles.forEach(b=>this.tiles.push(b));(c.added.length||c.removed.length)&&this.emit("update",c)};r.setViewState=function(k){if(k=this.tileScheme.getTileCoverage(k,0)){var {spans:c,lodInfo:b}=k,{level:a}=b;if(0<c.length)for(const {row:n,colFrom:f,colTo:q}of c)for(var g=f;g<=q;g++){const p=d.set(a,n,b.normalizeCol(g),b.getWorldForColumn(g)).id;h.add(p);if(!this.has(p)){const z=new u.Tile(this.tileScheme,p);this._tiles.set(p,z);this._index.insert(z);this.tiles.push(z);
e.added.push(z)}}for(a=this.tiles.length-1;0<=a;a--)g=this.tiles[a],h.has(g.id)||(this._tiles.delete(g.id),this.tiles.splice(a,1),this._index.remove(g),e.removed.push(g));(e.added.length||e.removed.length)&&this.emit("update",e);A.pool.release(k);h.clear();e.added.length=0;e.removed.length=0}};return m}(t)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(v,t,E,B,u,A,x){let e=function(){function h(l,m){this.key=new x(0,0,0,0);this.bounds=u.create();this.objectIds=new Set;this.key.set(m);m=l.getLODInfoAt(this.key);this.tileInfoView=l;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=m.resolution;this.scale=m.scale;this.level=m.level}var d=h.prototype;d.createChildTiles=function(){const l=this.key.getChildKeys(),m=E.acquire();for(let r=0;r<l.length;r++)m[r]=new h(this.tileInfoView,l[r]);return m};d.getQuantizationParameters=
function(){return A.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};t._createClass(h,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return B.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,
this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return h}();v.Tile=e;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(v,t){let E=function(){function B(A,x,e,h){this.set(A,x,e,h)}B.getId=function(A,x,e,h){return"object"===typeof A?`${A.level}/${A.row}/${A.col}/${A.world}`:`${A}/${x}/${e}/${h}`};var u=B.prototype;
u.acquire=function(A,x,e,h){this.set(A,x,e,h)};u.contains=function(A){const x=A.level-this.level;return 0<=x&&this.row===A.row>>x&&this.col===A.col>>x&&this.world===A.world};u.equals=function(A){return this.level===A.level&&this.row===A.row&&this.col===A.col&&this.world===A.world};u.clone=function(){return new B(this)};u.release=function(){this.world=this.col=this.row=this.level=0};u.set=function(A,x,e,h){if(null==A)this.world=this.col=this.row=this.level=0;else if("object"===typeof A)this.level=
A.level||0,this.row=A.row||0,this.col=A.col||0,this.world=A.world||0;else if("string"===typeof A){const [d,l,m,r]=A.split("/");this.level=parseFloat(d);this.row=parseFloat(l);this.col=parseFloat(m);this.world=parseFloat(r)}else this.level=+A,this.row=+x,this.col=+e,this.world=+h||0;return this};u.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};u.getParentKey=function(){return 0>=this.level?null:new B(this.level-1,this.row>>1,this.col>>1,this.world)};u.getChildKeys=
function(){const A=this.level+1,x=this.row<<1,e=this.col<<1,h=this.world;return[new B(A,x,e,h),new B(A,x,e+1,h),new B(A,x+1,e,h),new B(A,x+1,e+1,h)]};u.compareRowMajor=function(A){return this.row<A.row?-1:this.row>A.row?1:this.col<A.col?-1:this.col>A.col?1:0};v._createClass(B,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(A){this.set(A)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);
return B}();E.pool=new t(E,null,null,25,50);return E})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../core/ObjectPool"],function(v){let t=function(){function E(){this.spans=[]}var B=E.prototype;B.acquire=function(u){this.lodInfo=u};B.release=function(){this.lodInfo=null;this.spans.length=0};B.forEach=function(u,A){const {spans:x,lodInfo:e}=this,{level:h}=e;if(0!==x.length)for(const {row:d,colFrom:l,colTo:m}of x)for(let r=l;r<=m;r++)u.call(A,h,d,e.normalizeCol(r),e.getWorldForColumn(r))};
return E}();t.pool=new v(t);return t})},"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(v,t,E,B,u,A){const x=new u("0/0/0/0");let e=function(){function d(m,r,k,c,b,a,g,n){this.x=m;this.ymin=r;this.ymax=k;this.invM=c;this.leftAdjust=b;this.rightAdjust=a;this.leftBound=g;this.rightBound=n}d.create=function(m,r){m[1]>r[1]&&([m,r]=[r,m]);const [k,
c]=m,[b,a]=r;m=b-k;r=a-c;r=0!==r?m/r:0;const g=(Math.ceil(c)-c)*r,n=(Math.floor(c)-c)*r;return new d(k,Math.floor(c),Math.ceil(a),r,0>m?g:n,0>m?n:g,0>m?b:k,0>m?k:b)};var l=d.prototype;l.incrRow=function(){this.x+=this.invM};l.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};l.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return d}();const h=[[0,0],[0,0],[0,0],[0,0]];return function(){function d(m,r=null){this.tileInfo=m;this.fullExtent=
r;this.scales=[];this._infoByScale={};this._infoByLevel={};const k=m.lods.slice();k.sort((b,a)=>a.scale-b.scale);const c=this._lodInfos=k.map(b=>E.create(m,b,r));k.forEach((b,a)=>{this._infoByLevel[b.level]=c[a];this._infoByScale[b.scale]=c[a];this.scales[a]=b.scale},this);this._wrap=m.isWrappable}var l=d.prototype;l.getLODInfoAt=function(m){return this._infoByLevel["number"===typeof m?m:m.level]};l.getTileBounds=function(m,r,k=!1){x.set(r);return(r=this._infoByLevel[x.level])?r.getTileBounds(m,x,
k):m};l.getTileCoords=function(m,r,k=!1){x.set(r);return(r=this._infoByLevel[x.level])?r.getTileCoords(m,x,k):m};l.getTileCoverage=function(m,r=192,k="closest"){k="closest"===k?this.getClosestInfoForScale(m.scale):this.getSmallestInfoForScale(m.scale);const c=B.pool.acquire(k),b=this._wrap;var a=Infinity;let g=-Infinity;const n=c.spans;h[0][0]=h[0][1]=h[1][1]=h[3][0]=-r;h[1][0]=h[2][0]=m.size[0]+r;h[2][1]=h[3][1]=m.size[1]+r;for(f of h)m.toMap(f,f),f[0]=k.getColumnForX(f[0]),f[1]=k.getRowForY(f[1]);
m=[];var f=3;for(r=0;4>r;r++)h[r][1]===h[f][1]?f=r:(f=e.create(h[r],h[f]),a=Math.min(f.ymin,a),g=Math.max(f.ymax,g),void 0===m[f.ymin]&&(m[f.ymin]=[]),m[f.ymin].push(f),f=r);if(null==a||null==g||100<g-a)return null;for(r=[];a<g;){null!=m[a]&&(r=r.concat(m[a]));f=Infinity;var q=-Infinity;for(var p=r.length-1;0<=p;p--){var z=r[p];f=Math.min(f,z.getLeftCol());q=Math.max(q,z.getRightCol())}f=Math.floor(f);q=Math.floor(q);if(a>=k.first[1]&&a<=k.last[1])if(b)if(k.size[0]<k.worldSize[0])for(p=Math.floor(q/
k.worldSize[0]),z=Math.floor(f/k.worldSize[0]);z<=p;z++)n.push(new A(a,Math.max(k.getFirstColumnForWorld(z),f),Math.min(k.getLastColumnForWorld(z),q)));else n.push(new A(a,f,q));else f>k.last[0]||q<k.first[0]||(f=Math.max(f,k.first[0]),q=Math.min(q,k.last[0]),n.push(new A(a,f,q)));a+=1;for(f=r.length-1;0<=f;f--)q=r[f],q.ymax>=a?q.incrRow():r.splice(f,1)}return c};l.getTileParentId=function(m){x.set(m);m=this._lodInfos.indexOf(this._infoByLevel[x.level])-1;if(0>m)return null;this._getTileIdAtLOD(x,
this._lodInfos[m],x);return x.id};l.getTileResolution=function(m){return(m=this._infoByLevel["object"===typeof m?m.level:m])?m.resolution:-1};l.getTileScale=function(m){return(m=this._infoByLevel[m.level])?m.scale:-1};l.intersects=function(m,r){x.set(r);r=this._infoByLevel[x.level];const k=m.lodInfo;if(k.resolution>r.resolution){this._getTileIdAtLOD(x,k,x);var c=k.denormalizeCol(x.col,x.world);for(var b of m.spans)if(b.row===x.row&&b.colFrom<=c&&b.colTo>=c)return!0}if(k.resolution<r.resolution){const [g,
n,f,q]=m.spans.reduce((p,z)=>{p[0]=Math.min(p[0],z.row);p[1]=Math.max(p[1],z.row);p[2]=Math.min(p[2],z.colFrom);p[3]=Math.max(p[3],z.colTo);return p},[Infinity,-Infinity,Infinity,-Infinity]);c=r.denormalizeCol(x.col,x.world);m=k.getColumnForX(r.getXForColumn(c));b=k.getRowForY(r.getYForRow(x.row));c=k.getColumnForX(r.getXForColumn(c+1))-1;r=k.getRowForY(r.getYForRow(x.row+1))-1;return!(m>q||c<f||b>n||r<g)}const a=k.denormalizeCol(x.col,x.world);return m.spans.some(g=>g.row===x.row&&g.colFrom<=a&&
g.colTo>=a)};l.normalizeBounds=function(m,r,k){m[0]=r[0];m[1]=r[1];m[2]=r[2];m[3]=r[3];this._wrap&&(r=t.getInfo(this.tileInfo.spatialReference),k=-k*(r.valid[1]-r.valid[0]),m[0]+=k,m[2]+=k);return m};l.getSmallestInfoForScale=function(m){const r=this.scales;if(this._infoByScale[m])return this._infoByScale[m];if(m>r[0])return this._infoByScale[r[0]];for(let k=1;k<r.length-1;k++)if(m>r[k]+1E-6)return this._infoByScale[r[k-1]];return this._infoByScale[r[r.length-1]]};l.getClosestInfoForScale=function(m){const r=
this.scales;if(this._infoByScale[m])return this._infoByScale[m];m=r.reduce((k,c)=>Math.abs(c-m)<Math.abs(k-m)?c:k,r[0]);return this._infoByScale[m]};l.scaleToLevel=function(m){const r=this.scales;if(this._infoByScale[m])return this._infoByScale[m].level;for(let k=r.length-1;0<=k;k--)if(m<r[k])return k===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[k]].level+(r[k]-m)/(r[k]-r[k+1]);return this._infoByScale[r[0]].level};l.scaleToZoom=function(m){return this.tileInfo.scaleToZoom(m)};
l._getTileIdAtLOD=function(m,r,k){const c=this._infoByLevel[k.level];m.set(k);if(r.resolution<c.resolution)return null;if(r.resolution===c.resolution)return m;m.level=r.level;m.col=Math.floor(k.col*c.resolution/r.resolution+.01);m.row=Math.floor(k.row*c.resolution/r.resolution+.01);return m};v._createClass(d,[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return d}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../core/maybe","../../../geometry/support/spatialReferenceUtils",
"./TileKey"],function(v,t,E){function B(A,x,e){A[0]=x;A[1]=e;return A}const u=new E("0/0/0/0");return function(){function A(e,h,d,l,m,r,k,c,b,a,g,n){this.level=e;this.resolution=h;this.scale=d;this.origin=l;this.first=m;this.last=r;this.size=k;this.norm=c;this.worldStart=b;this.worldEnd=a;this.worldSize=g;this.wrap=n}A.create=function(e,h,d=null){var l=t.getInfo(e.spatialReference);const m=h.origin||[e.origin.x,e.origin.y],r=[e.size[0]*h.resolution,e.size[1]*h.resolution],k=[-Infinity,-Infinity],
c=[Infinity,Infinity],b=[Infinity,Infinity];v.isSome(d)&&(B(k,Math.max(0,Math.floor((d.xmin-m[0])/r[0])),Math.max(0,Math.floor((m[1]-d.ymax)/r[1]))),B(c,Math.max(0,Math.floor((d.xmax-m[0])/r[0])),Math.max(0,Math.floor((m[1]-d.ymin)/r[1]))),B(b,c[0]-k[0]+1,c[1]-k[1]+1));const {cols:a,rows:g}=h;!d&&a&&g&&(B(k,a[0],g[0]),B(c,a[1],g[1]),B(b,a[1]-a[0]+1,g[1]-g[0]+1));let n;e.isWrappable?(e=[Math.ceil(Math.round((l.valid[1]-l.valid[0])/h.resolution)/e.size[0]),b[1]],l=[Math.floor((l.origin[0]-m[0])/r[0]),
k[1]],d=[e[0]+l[0]-1,c[1]],n=!0):(l=k,d=c,e=b,n=!1);return new A(h.level,h.resolution,h.scale,m,k,c,b,r,l,d,e,n)};var x=A.prototype;x.normalizeCol=function(e){if(!this.wrap)return e;const h=this.worldSize[0];return 0>e?h-1-Math.abs((e+1)%h):e%h};x.denormalizeCol=function(e,h){return this.wrap?this.worldSize[0]*h+e:e};x.getWorldForColumn=function(e){return this.wrap?Math.floor(e/this.worldSize[0]):0};x.getFirstColumnForWorld=function(e){return e*this.worldSize[0]+this.first[0]};x.getLastColumnForWorld=
function(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1};x.getColumnForX=function(e){return(e-this.origin[0])/this.norm[0]};x.getXForColumn=function(e){return this.origin[0]+e*this.norm[0]};x.getRowForY=function(e){return(this.origin[1]-e)/this.norm[1]};x.getYForRow=function(e){return this.origin[1]-e*this.norm[1]};x.getTileBounds=function(e,h,d=!1){u.set(h);var l=d?u.col:this.denormalizeCol(u.col,u.world),m=u.row;h=this.getXForColumn(l);d=this.getYForRow(m+1);l=this.getXForColumn(l+1);
m=this.getYForRow(m);e[0]=h;e[1]=d;e[2]=l;e[3]=m;return e};x.getTileCoords=function(e,h,d=!1){u.set(h);h=d?u.col:this.denormalizeCol(u.col,u.world);Array.isArray(e)?B(e,this.getXForColumn(h),this.getYForRow(u.row)):(e.x=this.getXForColumn(h),e.y=this.getYForRow(u.row));return e};return A}()})},"esri/views/2d/tiling/TileSpan":function(){define(function(){return function(v,t,E){this.row=v;this.colFrom=t;this.colTo=E}})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/enums ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p){function z(y,G){return(!y.minScale||y.minScale>=G)&&(!y.maxScale||y.maxScale<=G)}function w(y){y=y.message;const G={message:{data:{},tileKey:y.tileKey,tileKeyOrigin:y.tileKeyOrigin,version:y.version},transferList:[]};for(const D in y.data){var H=y.data[D];G.message.data[D]=null;if(x.isSome(H)){var I=H.stride;const C=H.indices.slice(0),F=H.vertices.slice(0),K=H.records.slice(0);H=x.applySome(H.metrics,J=>J.slice(0));I={stride:I,indices:C,vertices:F,
records:K,metrics:H};G.transferList.push(C,F,K);G.message.data[D]=I}}return G}B=function(y){function G(){var I=y.apply(this,arguments)||this;I.type="symbol";I._matchers={feature:null,aggregate:null};I._bufferData=new Map;I._bufferIds=new Map;return I}v._inheritsLoose(G,y);var H=G.prototype;H.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new p(this.remoteClient)};H.destroy=function(){this._resourceManagerProxy.destroy()};
H.forEachBufferId=function(I){this._bufferIds.forEach(D=>{D.forEach(I)})};H.update=function(){var I=v._asyncToGenerator(function*(D,C){C=C.schema.processors[0];if("symbol"===C.type){var F=m.diff(this._schema,C);if(m.hasDiff(F,"mesh")||m.hasDiff(F,"target"))D.mesh=!0,D.why.mesh.push("Symbology changed"),this._schema=C,this._factory=this._createFactory(C),this._factory.update(C,this.tileStore.tileScheme.tileInfo)}});return function(D,C){return I.apply(this,arguments)}}();H.onTileMessage=function(I,
D,C,F){e.throwIfAborted(F);return this._onTileData(I,D,C,F)};H.onTileClear=function(I){this._bufferData.delete(I.key.id);this._bufferIds.delete(I.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:I.id,data:{clear:!0}})};H.onTileError=function(I,D,C){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:I.id,error:D},{signal:C.signal})};H.onTileUpdate=function(I){for(const D of I.removed)this._bufferData.has(D.key.id)&&this._bufferData.delete(D.key.id),this._bufferIds.has(D.key.id)&&
this._bufferIds.delete(D.key.id);for(const D of I.added)this._bufferData.forEach(C=>{for(const F of C)F.message.tileKey===D.id&&this._updateTileMesh("append",D,w(F),[],!1,!1,null)})};H._addBufferData=function(I,D){this._bufferData.has(I)||this._bufferData.set(I,[]);this._bufferData.get(I).push(w(D))};H._createFactory=function(I){const {geometryType:D,objectIdField:C,fields:F}=this.service,K=r.fromJSON(this.spatialReference),J={geometryType:D,fields:F,spatialReference:K},P=new g.WGLTemplateStore((ha,
U)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",ha,U),this.tileStore.tileScheme.tileInfo),{matcher:S,aggregateMatcher:X}=I.mesh;this._store=P;this._matchers.feature=n.createMatcher(S,P,J,this._resourceManagerProxy);this._matchers.aggregate=x.applySome(X,ha=>n.createMatcher(ha,P,J,this._resourceManagerProxy));return new a.WGLMeshFactory(D,C,P)};H._onTileData=function(){var I=v._asyncToGenerator(function*(D,C,F,K){e.throwIfAborted(K);const {type:J,addOrUpdate:P,remove:S,clear:X,end:ha}=
C;var U=!!this._schema.mesh.sortKey;if(!P)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:D.id,data:{type:J,addOrUpdate:null,remove:S,clear:X,end:ha,sort:U}},K);F=this._processFeatures(D,P,F,K,C.status.version);try{var Q=yield F;if(x.isNone(Q))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:D.id,data:{type:J,addOrUpdate:null,remove:S,clear:X,end:ha,sort:U}},K);U=[];for(const O of Q){Q=!1;const R=O.message.bufferIds,V=D.key.id,Z=O.message.tileKey;if(V!==Z&&x.isSome(R)){if(!this.tileStore.get(Z)){this._addBufferData(V,
O);U.push(O);continue}let ka=this._bufferIds.get(Z);ka||(ka=new Set,this._bufferIds.set(Z,ka));const ia=Array.from(R);for(const wa of ia)if(ka.has(wa)){Q=!0;break}else ka.add(wa)}Q||(this._addBufferData(V,O),U.push(O))}yield Promise.all(U.map(O=>{const R=D.key.id===O.message.tileKey;return this._updateTileMesh(J,D,O,R?C.remove:[],R&&C.end,C.clear,K.signal)}))}catch(O){this._handleError(D,O,K)}});return function(D,C,F,K){return I.apply(this,arguments)}}();H._updateTileMesh=function(){var I=v._asyncToGenerator(function*(D,
C,F,K,J,P,S){const X=F.message.tileKey,ha=!!this._schema.mesh.sortKey;X!==C.key.id&&(J=!1);C=x.applySome(F,U=>U.message);F=x.applySome(F,U=>U.transferList)||[];D={type:D,addOrUpdate:C,remove:K,clear:P,end:J,sort:ha};S={transferList:x.unwrap(F)||[],signal:S};e.throwIfAborted(S);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:X,data:D},S)});return function(D,C,F,K,J,P,S){return I.apply(this,arguments)}}();H._processFeatures=function(){var I=v._asyncToGenerator(function*(D,C,F,K,J){if(x.isNone(C)||
!C.hasFeatures)return null;const P={transform:D.transform,hasZ:!1,hasM:!1},S=this._factory,X={viewingMode:"",scale:D.scale},ha=yield this._matchers.feature,U=yield this._matchers.aggregate;e.throwIfAborted(K);const Q=this._getLabelInfos(D,C);yield S.analyze(C.getCursor(),this._resourceManagerProxy,ha,U,P,X);e.throwIfAborted(K);return this._writeFeatureSet(D,C,P,Q,S,F,J)});return function(D,C,F,K,J){return I.apply(this,arguments)}}();H._writeFeatureSet=function(I,D,C,F,K,J,P){const S=D.getSize(),X=
this._schema.mesh.matcher.symbologyType;J=new b.MeshData(I.key.id,{features:S,records:S,metrics:0},X,J,X!==c.WGLSymbologyType.HEATMAP,P);P={viewingMode:"",scale:I.scale};for(D=D.getCursor();D.next();)try{const ha=D.getDisplayId(),U=x.isSome(F)?F.get(ha):null;K.writeCursor(J,D,C,P,I.level,U,this._resourceManagerProxy)}catch(ha){}return J.serialize(I.tileInfoView.tileInfo.isWrappable)};H._handleError=function(I,D,C){if(!e.isAbortError(D))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:I.id,
error:D.message},{signal:C.signal})};H._getLabelingSchemaForScale=function(I){var D=this._schema.mesh.labels;if(x.isNone(D))return null;if("subtype"===D.type){const C={type:"subtype",classes:{}};let F=!1;for(const K in D.classes){const J=D.classes[K].filter(P=>z(P,I.scale));F=F||!!J.length;C.classes[K]=J}return F?C:null}D=D.classes.filter(C=>z(C,I.scale));return D.length?{type:"simple",classes:D}:null};H._getLabels=function(I,D){if("subtype"===D.type){const C=x.unwrapOrThrow(this.service.subtypeField,
"Expected to find subtype Field");I=I.readAttribute(C);return null==I?[]:D.classes[I]??[]}return D.classes};H._getLabelInfos=function(I,D){I=this._getLabelingSchemaForScale(I);if(x.isNone(I))return null;const C=new Map;for(D=D.getCursor();D.next();){const K=D.getDisplayId(),J=[],P=k.isAggregateId(K),S=P&&1!==D.readAttribute("cluster_count")?"aggregate":"feature";var F=this._getLabels(D,I);for(const X of F){if(X.target!==S)continue;F=D.getStorage();F=P&&"feature"===S?F.getComputedStringAtIndex(D.readAttribute("referenceId"),
X.fieldIndex):F.getComputedStringAtIndex(K,X.fieldIndex);if(!F)continue;F=E.bidiText(F.toString());const ha=F[1];this._store.getMosaicItem(X.symbol,f.codepoints(F[0])).then(U=>{J[X.index]={glyphs:U.glyphMosaicItems,rtl:ha,index:X.index}})}C.set(K,J)}return C};v._createClass(G,[{key:"supportsTileUpdates",get:function(){return!0}}]);return G}(q);return B=t.__decorate([l.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],B)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],
function(v,t){const E=new t;v.bidiText=function(B){if(!E.hasBidiChar(B))return[B,!1];let u;u="rtl"===E.checkContextual(B)?"IDNNN":"ICNNN";return[E.bidiTransform(B,u,"VLYSN"),!0]};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){function k(b){switch(b){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function c(b){switch(b){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}E=function(){function b(g,n,f,q,p,z=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=n;this.tileKey=g;this._hasAggregate=q;this._pixelBufferEnabled=p;this._version=z;this._symbologyType=f}var a=b.prototype;a.serialize=function(g){const n=[];n.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((f,q)=>{var p=1<<q;q=k(p);p=c(p);q=r.getPow2NeighborKey(new u(this.tileKey),q,p,g);q=this._serializeTileVertexData(this.tileKey,q.id,f.vertexData);q.message.bufferIds=
f.displayIds;n.push(q)});return n};a._serializeTileVertexData=function(g,n,f){const q=[];f={[d.WGLGeometryType.MARKER]:f.get(d.WGLGeometryType.MARKER)?.serialize(q),[d.WGLGeometryType.FILL]:f.get(d.WGLGeometryType.FILL)?.serialize(q),[d.WGLGeometryType.LINE]:f.get(d.WGLGeometryType.LINE)?.serialize(q),[d.WGLGeometryType.TEXT]:f.get(d.WGLGeometryType.TEXT)?.serialize(q),[d.WGLGeometryType.LABEL]:f.get(d.WGLGeometryType.LABEL)?.serialize(q)};return{message:{tileKeyOrigin:g,tileKey:n,data:f,version:this._version},
transferList:q}};a.featureStart=function(g,n){this._current.insertAfter=g;this._current.sortKey=n};a.featureEnd=function(){};a.recordStart=function(g,n,f,q){this._current.writer=this._getVertexWriter(f);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=q;this._current.id=g;this._current.materialKey=n;this._current.geometryType=f;this._current.isDotDensity=!1;this._current.writer.recordStart()};
a.recordCount=function(){return this._current.writer.recordCount};a.vertexCount=function(){return this._current.writer.vertexCount};a.indexCount=function(){return this._current.writer.indexCount};a.vertexEnsureSize=function(g){this._current.writer.vertexEnsureSize(g)};a.indexEnsureSize=function(g){this._current.writer.indexEnsureSize(g)};a.vertexBounds=function(g,n,f,q){this._current.bufferingEnabled&&this._addOverlap(g,n,f,q)};a.vertexWrite=function(g){this._current.writer.writeVertex(g)};a.vertexWriteF32=
function(g){this._current.writer.writeVertexF32(g)};a.vertexEnd=function(){};a.vertexWriter=function(){return this._current.writer.vertexWriter};a.indexWrite=function(g){this._current.writer.writeIndex(g)};a.indexWriter=function(){return this._current.writer.indexWriter};a.metricWriter=function(){return this._current.writer.metricWriter};a.metricStart=function(g,n,f,q,p,z,w,y){this._current.writer=this._getVertexWriter(d.WGLGeometryType.LABEL);const G=this._current.writer.metricWriter;G.push(h.getDisplayIdTexel(g));
G.push(n);G.push(f);G.push(q);G.push(p);G.push(z);G.push(w);G.push(y);G.push(255);this._current.metricBoxLenPointer=G.push(0)};a.metricEnd=function(){const g=this._current.writer.metricWriter;0===g.getValue(this._current.metricBoxLenPointer)&&g.seek(g.length-10)};a.metricBoxWrite=function(g,n,f,q){const p=this._current.writer.metricWriter;p.incr(this._current.metricBoxLenPointer);p.push(0);p.push(0);p.push(g);p.push(n);p.push(f);p.push(q)};a.recordEnd=function(){var g=this._current.vertStart,n=this._current.writer.vertexCount-
g;if(!n)return!1;this.hasRecords=!0;var f=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,f,this._current.writer.indexCount-f,g,n,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===d.WGLGeometryType.LABEL)return!0;g=this._current.writer;for(n=0;8>n;n++){var q=1<<n;if(this._current.overlaps&q){this._data.neighbors[n]||(this._data.neighbors[n]={vertexData:new Map,
displayIds:new Set});f=this._data.neighbors[n];var p=this._current.geometryType;if(!f.vertexData.has(p)){var z=l.getStrides(p,this._symbologyType).geometry;z=new m.VertexDataWriter(p,z,e.PATCH_PIXEL_BUFFER_ALLOC_SIZE);f.vertexData.set(p,z)}p=f.vertexData.get(this._current.geometryType);z=4096*-k(q);q=4096*-c(q);p.copyLastFrom(g,z,q);f.displayIds.add(this._current.id)}}return!0};a._addOverlap=function(g,n,f,q){this._current.overlaps|=255^((g<0+f?148:g>=e.TILE_SIZE-f?41:189)|(n<0+q?224:n>=e.TILE_SIZE-
q?7:231))};a._getVertexWriter=function(g){if(!this._data.self.has(g)){const n=this._data.self,f=l.getStrides(g,this._symbologyType).geometry;n.set(g,new m.VertexDataWriter(g,f,this.hint.records))}return this._data.self.get(g)};t._createClass(b,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return b}();v.MeshData=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),function(v,t,E,B,u,A,x,e,h,d){function l(b,a){b.length=0;a.forEach(g=>b.push(g));return b}const m=new Set,
r=[],k=new Map,c=[0,0];E=function(b){function a(n){n=b.call(this,n)||this;n._keyToItem=new Map;n.concurrency=6;n.strategy="scale-first";n.tileInfoView=null;return n}v._inheritsLoose(a,b);var g=a.prototype;g.initialize=function(){const {concurrency:n,process:f}=this;this._queue=new d.QueueProcessor({concurrency:n,process:(q,p)=>{q=this._keyToItem.get(q);return f(q,{signal:p})},peeker:q=>q.values().next().value})};g.destroy=function(){this.clear();this._queue=B.destroyMaybe(this._queue)};g.abort=function(n){this._queue.abort("string"===
typeof n?n:n.id)};g.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};g.has=function(n){return"string"===typeof n?this._keyToItem.has(n):this._keyToItem.has(n.id)};g.isOngoing=function(n){n="string"===typeof n?n:n.id;return this.has(n)&&this._queue.isOngoing(n)};g.pause=function(){this._queue.pause()};g.push=function(n,f){const q=n.key.id+"-"+f;if(this.has(q))return this.get(q);f=this._queue.push(q);const p=()=>{this._keyToItem.delete(q);this.notifyChange("updating")};
this._keyToItem.set(q,n);f.then(p,p);this.notifyChange("updating");return f};g.reset=function(){this._queue.reset();this.notifyChange("updating")};g.resume=function(){this._queue.resume()};g._peekByScaleFirst=function(n){if(!this.state)return n.values().next().value;const f=this.tileInfoView;let q=Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY;n.forEach(H=>{H=this._keyToItem.get(H);const I=this.tileInfoView.getTileScale(H.key);k.has(I)||(k.set(I,[]),q=Math.max(I,q),p=Math.min(I,p));k.get(I).push(H.key);
m.add(I)});let z=this.state.scale;k.has(z)||(l(r,m),r.sort((H,I)=>H-I),z=r.reduce((H,I)=>Math.abs(I-z)<Math.abs(H-z)?I:H,r[0]));z=Math.min(z,q);z=Math.max(z,p);n=k.get(z);const w=f.getClosestInfoForScale(z),y=w.getColumnForX(this.state.center[0]),G=w.getRowForY(this.state.center[1]);n.sort((H,I)=>{const D=w.denormalizeCol(H.col,H.world),C=w.denormalizeCol(I.col,I.world);return Math.sqrt((y-D)*(y-D)+(G-H.row)*(G-H.row))-Math.sqrt((y-C)*(y-C)+(G-I.row)*(G-I.row))});m.clear();k.clear();return n[0].id};
g._peekByCenterFirst=function(n){if(!this.state)return n.values().next().value;const f=this.tileInfoView,q=this.state.center;let p=Number.POSITIVE_INFINITY,z;n.forEach(w=>{w=this._keyToItem.get(w);f.getTileCoords(c,w.key);const y=h.distance(c,q);y<p&&(p=y,z=w.key)});return z.id};v._createClass(a,[{key:"length",get:function(){return this._queue?this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);
return a}(E);t.__decorate([u.property({constructOnly:!0})],E.prototype,"concurrency",void 0);t.__decorate([u.property({constructOnly:!0})],E.prototype,"process",void 0);t.__decorate([u.property()],E.prototype,"state",void 0);t.__decorate([u.property({constructOnly:!0})],E.prototype,"strategy",void 0);t.__decorate([u.property({constructOnly:!0})],E.prototype,"tileInfoView",void 0);t.__decorate([u.property({readOnly:!0})],E.prototype,"updating",null);return E=t.__decorate([e.subclass("esri.views.2d.tiling.PagedTileQueue")],
E)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(v,t){function E(U,Q){U[0]=Q[0];U[1]=Q[1];return U}function B(U,Q,O){U[0]=Q;U[1]=O;return U}function u(U,Q,O){U[0]=Q[0]+O[0];U[1]=Q[1]+O[1];return U}function A(U,Q,O){U[0]=Q[0]-O[0];U[1]=Q[1]-O[1];return U}function x(U,Q,O){U[0]=Q[0]*O[0];U[1]=Q[1]*O[1];return U}function e(U,Q,O){U[0]=Q[0]/O[0];U[1]=Q[1]/O[1];return U}function h(U,Q){U[0]=Math.ceil(Q[0]);U[1]=Math.ceil(Q[1]);return U}function d(U,Q){U[0]=Math.floor(Q[0]);U[1]=
Math.floor(Q[1]);return U}function l(U,Q,O){U[0]=Math.min(Q[0],O[0]);U[1]=Math.min(Q[1],O[1]);return U}function m(U,Q,O){U[0]=Math.max(Q[0],O[0]);U[1]=Math.max(Q[1],O[1]);return U}function r(U,Q){U[0]=Math.round(Q[0]);U[1]=Math.round(Q[1]);return U}function k(U,Q,O){U[0]=Q[0]*O;U[1]=Q[1]*O;return U}function c(U,Q,O,R){U[0]=Q[0]+O[0]*R;U[1]=Q[1]+O[1]*R;return U}function b(U,Q){const O=Q[0]-U[0];U=Q[1]-U[1];return Math.sqrt(O*O+U*U)}function a(U,Q){const O=Q[0]-U[0];U=Q[1]-U[1];return O*O+U*U}function g(U){const Q=
U[0];U=U[1];return Math.sqrt(Q*Q+U*U)}function n(U){const Q=U[0];U=U[1];return Q*Q+U*U}function f(U,Q){U[0]=-Q[0];U[1]=-Q[1];return U}function q(U,Q){U[0]=1/Q[0];U[1]=1/Q[1];return U}function p(U,Q){var O=Q[0];const R=Q[1];O=O*O+R*R;0<O&&(O=1/Math.sqrt(O),U[0]=Q[0]*O,U[1]=Q[1]*O);return U}function z(U,Q){return U[0]*Q[0]+U[1]*Q[1]}function w(U,Q,O){Q=Q[0]*O[1]-Q[1]*O[0];U[0]=U[1]=0;U[2]=Q;return U}function y(U,Q,O,R){const V=Q[0];Q=Q[1];U[0]=V+R*(O[0]-V);U[1]=Q+R*(O[1]-Q);return U}function G(U,Q){Q=
Q||1;const O=2*t.RANDOM()*Math.PI;U[0]=Math.cos(O)*Q;U[1]=Math.sin(O)*Q;return U}function H(U,Q,O){const R=Q[0];Q=Q[1];U[0]=O[0]*R+O[2]*Q;U[1]=O[1]*R+O[3]*Q;return U}function I(U,Q,O){const R=Q[0];Q=Q[1];U[0]=O[0]*R+O[2]*Q+O[4];U[1]=O[1]*R+O[3]*Q+O[5];return U}function D(U,Q,O){const R=Q[0];Q=Q[1];U[0]=O[0]*R+O[3]*Q+O[6];U[1]=O[1]*R+O[4]*Q+O[7];return U}function C(U,Q,O){const R=Q[0];Q=Q[1];U[0]=O[0]*R+O[4]*Q+O[12];U[1]=O[1]*R+O[5]*Q+O[13];return U}function F(U,Q,O,R){const V=Q[0]-O[0];Q=Q[1]-O[1];
const Z=Math.sin(R);R=Math.cos(R);U[0]=V*R-Q*Z+O[0];U[1]=V*Z+Q*R+O[1];return U}function K(U,Q){var O=U[0];U=U[1];const R=Q[0];Q=Q[1];let V=O*O+U*U;0<V&&(V=1/Math.sqrt(V));let Z=R*R+Q*Q;0<Z&&(Z=1/Math.sqrt(Z));O=(O*R+U*Q)*V*Z;return 1<O?0:-1>O?Math.PI:Math.acos(O)}function J(U){return"vec2("+U[0]+", "+U[1]+")"}function P(U,Q){return U[0]===Q[0]&&U[1]===Q[1]}function S(U,Q){const O=U[0];U=U[1];const R=Q[0];Q=Q[1];const V=t.getEpsilon();return Math.abs(O-R)<=V*Math.max(1,Math.abs(O),Math.abs(R))&&Math.abs(U-
Q)<=V*Math.max(1,Math.abs(U),Math.abs(Q))}function X(U,Q,O,R,V){let Z=Q[0]-O[0];O=Q[1]-O[1];V=(R[0]*Z+R[1]*O)*(V-1);Z=R[0]*V;O=R[1]*V;U[0]=Q[0]+Z;U[1]=Q[1]+O;return U}const ha=Object.freeze(Object.defineProperty({__proto__:null,copy:E,set:B,add:u,subtract:A,multiply:x,divide:e,ceil:h,floor:d,min:l,max:m,round:r,scale:k,scaleAndAdd:c,distance:b,squaredDistance:a,length:g,squaredLength:n,negate:f,inverse:q,normalize:p,dot:z,cross:w,lerp:y,random:G,transformMat2:H,transformMat2d:I,transformMat3:D,transformMat4:C,
rotate:F,angle:K,str:J,exactEquals:P,equals:S,projectAndScale:X,len:g,sub:A,mul:x,div:e,dist:b,sqrDist:a,sqrLen:n},Symbol.toStringTag,{value:"Module"}));v.add=u;v.angle=K;v.ceil=h;v.copy=E;v.cross=w;v.dist=b;v.distance=b;v.div=e;v.divide=e;v.dot=z;v.equals=S;v.exactEquals=P;v.floor=d;v.inverse=q;v.len=g;v.length=g;v.lerp=y;v.max=m;v.min=l;v.mul=x;v.multiply=x;v.negate=f;v.normalize=p;v.projectAndScale=X;v.random=G;v.rotate=F;v.round=r;v.scale=k;v.scaleAndAdd=c;v.set=B;v.sqrDist=a;v.sqrLen=n;v.squaredDistance=
a;v.squaredLength=n;v.str=J;v.sub=A;v.subtract=A;v.transformMat2=H;v.transformMat2d=I;v.transformMat3=D;v.transformMat4=C;v.vec2=ha})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(v,t,E,B,u,A,x,e,h,d){function l(b,a){b.length=0;a.forEach(g=>b.push(g));return b}const m=new Set,r=[],k=new Map,c=[0,0];E=function(b){function a(n){n=b.call(this,n)||this;n._keyToItem=new Map;n.concurrency=6;n.strategy="scale-first";n.tileInfoView=null;return n}v._inheritsLoose(a,b);var g=a.prototype;g.initialize=function(){const {concurrency:n,process:f,strategy:q}=this;this._queue=new d.QueueProcessor({concurrency:n,process:(p,z)=>{p=this._keyToItem.get(p);return f(p,{signal:z})},peeker:"scale-first"===
q?p=>this._peekByScaleFirst(p):p=>this._peekByCenterFirst(p)})};g.destroy=function(){this.clear();this._queue=B.destroyMaybe(this._queue)};g.abort=function(n){this._queue.abort("string"===typeof n?n:n.id)};g.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};g.has=function(n){return"string"===typeof n?this._keyToItem.has(n):this._keyToItem.has(n.id)};g.isOngoing=function(n){n="string"===typeof n?n:n.id;return this.has(n)&&this._queue.isOngoing(n)};g.pause=
function(){this._queue.pause()};g.push=function(n){const f=n.key.id;if(this._queue.has(f))return this._queue.get(f);const q=this._queue.push(f),p=()=>{this._keyToItem.delete(f);this.notifyChange("updating")};this._keyToItem.set(f,n);q.then(p,p);this.notifyChange("updating");return q};g.reset=function(){this._queue.reset()};g.resume=function(){this._queue.resume()};g._peekByScaleFirst=function(n){if(!this.state)return n.values().next().value;const f=this.tileInfoView;let q=Number.NEGATIVE_INFINITY,
p=Number.POSITIVE_INFINITY;n.forEach(H=>{H=this._keyToItem.get(H);const I=this.tileInfoView.getTileScale(H.key);k.has(I)||(k.set(I,[]),q=Math.max(I,q),p=Math.min(I,p));k.get(I).push(H.key);m.add(I)});let z=this.state.scale;k.has(z)||(l(r,m),r.sort((H,I)=>H-I),z=r.reduce((H,I)=>Math.abs(I-z)<Math.abs(H-z)?I:H,r[0]));z=Math.min(z,q);z=Math.max(z,p);n=k.get(z);const w=f.getClosestInfoForScale(z),y=w.getColumnForX(this.state.center[0]),G=w.getRowForY(this.state.center[1]);n.sort((H,I)=>{const D=w.denormalizeCol(H.col,
H.world),C=w.denormalizeCol(I.col,I.world);return Math.sqrt((y-D)*(y-D)+(G-H.row)*(G-H.row))-Math.sqrt((y-C)*(y-C)+(G-I.row)*(G-I.row))});m.clear();k.clear();return n[0].id};g._peekByCenterFirst=function(n){if(!this.state)return n.values().next().value;const f=this.tileInfoView,q=this.state.center;let p=Number.POSITIVE_INFINITY,z;n.forEach(w=>{w=this._keyToItem.get(w);f.getTileCoords(c,w.key);const y=h.distance(c,q);y<p&&(p=y,z=w.key)});return z.id};v._createClass(a,[{key:"length",get:function(){return this._queue?
this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return a}(E);t.__decorate([u.property({constructOnly:!0})],E.prototype,"concurrency",void 0);t.__decorate([u.property({constructOnly:!0})],E.prototype,"process",void 0);t.__decorate([u.property()],E.prototype,"state",void 0);t.__decorate([u.property({constructOnly:!0})],E.prototype,"strategy",void 0);t.__decorate([u.property({constructOnly:!0})],
E.prototype,"tileInfoView",void 0);t.__decorate([u.property({readOnly:!0})],E.prototype,"updating",null);return E=t.__decorate([e.subclass("esri.views.2d.tiling.TileQueue")],E)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(v,t,E,B){const u=new B(0,0,0,0),A=new Map,x=[],e=[];return function(){function h(l){this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy=
"closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=l.acquireTile;this.releaseTile=l.releaseTile;this.tileInfoView=l.tileInfoView;this.resampling=null==l.resampling||!!l.resampling;l.cachePolicy&&(this.cachePolicy=l.cachePolicy);l.coveragePolicy&&(this.coveragePolicy=l.coveragePolicy);null!=l.buffer&&(this.buffer=l.buffer);l.cacheSize&&(this._tileCache=new t(l.cacheSize,this.tileInfoView,m=>{this.releaseTile(m)}))}var d=h.prototype;d.destroy=function(){this.tileIndex.clear()};
d.update=function(l){const {resampling:m,tileIndex:r}=this,k=this.tileInfoView.getTileCoverage(l.state,this.buffer,this.coveragePolicy);e.length=0;x.length=0;A.clear();if(k){var {minScale:c,maxScale:b}=this.tileInfoView.tileInfo,{spans:a,lodInfo:g}=k,{level:n}=g,{scale:f,center:q,resolution:p}=l.state,z=!l.stationary&&f>this._previousScale;this._previousScale=f;this.tiles.length=0;if(!m&&(f>c||f<b))return this.tiles.length=0,A.clear(),r.forEach(I=>{this.releaseTile(I)}),r.clear(),e.length=0,x.length=
0,A.clear(),E.pool.release(k),!0;r.forEach(I=>I.visible=!0);var w=l=0;if(0<a.length)for(const {row:I,colFrom:D,colTo:C}of a)for(let F=D;F<=C;F++){l++;const K=u.set(n,I,g.normalizeCol(F),g.getWorldForColumn(F)).id;if(r.has(K)){var y=r.get(K);y.isReady?(A.set(K,y),w++):z||this._addParentTile(K,A)}else{if(this._tileCache&&this._tileCache.has(K)){if(y=this._tileCache.pop(K),this.tileIndex.set(K,y),y.isReady){A.set(K,y);w++;continue}}else y=this.acquireTile(u),this.tileIndex.set(K,y);z||this._addParentTile(K,
A)}}var G=w===l;r.forEach((I,D)=>{u.set(D);if(!A.has(D)){var C=this.tileInfoView.intersects(k,u),F="purge"===this.cachePolicy?u.level!==n:u.level>n;!C||!z&&G?!F&&C||x.push(D):I.isReady?F&&"purge"===this.cachePolicy&&this._hasReadyAncestor(u,n)?x.push(D):e.push(D):F&&x.push(D)}});for(var H of e)(l=r.get(H))&&l.isReady&&A.set(H,l);for(const I of x)H=r.get(I),this._tileCache?this._tileCache.add(H):this.releaseTile(H),r.delete(I);A.forEach(I=>this.tiles.push(I));r.forEach(I=>{A.has(I.key.id)||(I.visible=
!1)});this._tileCache&&this._tileCache.prune(n,q,p);E.pool.release(k);A.clear();return G}};d.clear=function(l=!0){const {tileIndex:m}=this;l&&m.forEach(r=>{this.releaseTile(r)});m.clear()};d.updateCacheSize=function(l){this._tileCache&&(this._tileCache.maxSize=l)};d._addParentTile=function(l,m){let r=null;for(;;){l=this.tileInfoView.getTileParentId(l);if(!l)break;if(this.tileIndex.has(l)){if((r=this.tileIndex.get(l))&&r.isReady){m.has(r.key.id)||m.set(r.key.id,r);break}}else if(this._tileCache&&this._tileCache.has(l)&&
(r=this._tileCache.pop(l),this.tileIndex.set(l,r),r&&r.isReady)){m.has(r.key.id)||m.set(r.key.id,r);break}}};d._hasReadyAncestor=function(l,m){const r=v.create();this.tileInfoView.getTileBounds(r,l,!0);for(const k of this.tileIndex.values())if(k.isReady&&k.key.level>=m&&k.key.level<l.level){const c=v.create();this.tileInfoView.getTileBounds(c,k.key,!0);if(v.contains(c,r))return!0}return!1};return h}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/vec2"],function(v){return function(){function t(B,
u,A){this.maxSize=B;this._tileInfoView=u;this._removedFunc=A;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var E=t.prototype;E.has=function(B){return this._tilePerId.has(B)};E.get=function(B){return this._tilePerId.get(B)};E.pop=function(B){const u=this._tilePerId.get(B);if(u){var A=this._tileKeysPerLevel[u.key.level];this._tilePerId["delete"](B);for(let x=0;x<A.length;x++)if(A[x].id===B){A.splice(x,1);break}u.visible=!0;return u}};E.add=function(B){B.visible=!1;const u=B.key,A=u.id;this._tilePerId.has(A)||
(this._tilePerId.set(A,B),B=u.level,this._tileKeysPerLevel[B]||(this._tileKeysPerLevel[B]=[]),this._tileKeysPerLevel[B].push(u))};E.prune=function(B,u,A){let x=this._tilePerId.size;if(!(x<=this.maxSize)){for(var e=this._tileKeysPerLevel.length-1;x>this.maxSize&&0<=e;)e!==B&&(x=this._pruneAroundCenterTile(x,u,A,e)),e--;x>this.maxSize&&(x=this._pruneAroundCenterTile(x,u,A,B))}};E._pruneAroundCenterTile=function(B,u,A,x){x=this._tileKeysPerLevel[x];if(!x||0===x.length)return B;const {size:e,origin:h}=
this._tileInfoView.tileInfo,d=A*e[0],l=A*e[1],m=[0,0],r=[0,0];for(x.sort((k,c)=>{m[0]=h.x+d*(k.col+.5);m[1]=h.y-l*(k.row+.5);r[0]=h.x+d*(c.col+.5);r[1]=h.y-l*(c.row+.5);return v.squaredDistance(m,u)-v.squaredDistance(r,u)});0<x.length&&(A=x.pop(),this._removeTile(A.id),B--,B!==this.maxSize););return B};E._removeTile=function(B){const u=this._tilePerId.get(B);this._removedFunc&&u&&this._removedFunc(u);this._tilePerId["delete"](B)};return t}()})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(v,t,E,B,u){let A=function(){function x(h,d,l){this._start={index:0,vertex:0};l=B.getMeshSizeHint(h,d,l);d/=4;this.geometryType=h;this._records=new u(Int32Array,l.recordBytes);this._indices=new u(Uint32Array,l.indexBytes);this._vertices=new u(Uint32Array,l.vertexBytes);this._metrics=new u(Float32Array,0);this._strideInt=d}var e=x.prototype;e.serialize=function(h){const d=this._records.buffer(),
l=this._indices.buffer(),m=this._vertices.buffer(),r=this._metrics.length?this._metrics.buffer():null,k=4*this._strideInt;h.push(d,l,m);return{stride:k,records:d,indices:l,vertices:m,metrics:r}};e.vertexEnsureSize=function(h){this._vertices.ensureSize(h)};e.indexEnsureSize=function(h){this._indices.ensureSize(h)};e.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};e.recordEnd=function(h,d,l,m,r,k,c,b){this._records.push(h);this._records.push(d);
this._records.push(l);this._records.push(m);this._records.push(r);this._records.push(k);this._records.push(c);this._records.writeF32(b)};e.writeIndex=function(h){this._indices.push(h)};e.writeVertex=function(h){this._vertices.push(h)};e.writeVertexF32=function(h){this._vertices.writeF32(h)};e.copyLastFrom=function(h,d,l){var m=h._records.length-E.DISPLAY_RECORD_INT_PER_ELEMENT;const r=h._records.getValue(m),k=h._records.getValue(m+1),c=h._records.getValue(m+2),b=h._records.getValue(m+4),a=h._records.getValue(m+
6);m=h._records.getValue(m+7);const g=this._vertices.length;var n=(h._start.vertex-this._vertices.length)/this._strideInt;const f=this._indices.length,q=this.vertexCount;for(var p=h._start.index;p!==h._indices.length;p++){const z=h._indices.getValue(p);this._indices.push(z-n)}for(n=h._start.vertex;n!==h._vertices.length;n++)p=h._vertices.getValue(n),this._vertices.push(p);for(h=g;h<=this._vertices.length;h+=this._strideInt)this._vertices.i1616Add(h,d,l);this._records.push(r);this._records.push(k);
this._records.push(c);this._records.push(f);this._records.push(b);this._records.push(q);this._records.push(a);this._records.push(m)};t._createClass(x,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},
{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return x}();v.VertexDataWriter=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(v,t,E){const B=new Map;B.set(E.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});B.set(E.WGLGeometryType.LINE,{multiplier:1,
indicesPerRecord:24,verticesPerRecord:8});B.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});B.set(E.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});B.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});v.getMeshSizeHint=function(u,A,x){const {indicesPerRecord:e,multiplier:h,verticesPerRecord:d}=B.get(u);return{recordBytes:x*t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:h*e*x*
Uint32Array.BYTES_PER_ELEMENT,vertexBytes:h*d*x*A}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(v){return function(){function t(B,u){this._pos=0;u=u?this._roundToNearest(u,B.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(u);this._buffer=new B(this._array);this._ctor=B;this._i16View=new Int16Array(this._array)}var E=t.prototype;E._roundToNearest=
function(B,u){B=Math.round(B);return B+(u-B%u)};E._ensureSize=function(B){if(this._pos+B>=this._buffer.length){B=this._roundToNearest(1.25*(this._array.byteLength+B*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);B=new ArrayBuffer(B);const u=new this._ctor(B);u.set(this._buffer,0);this._array=B;this._buffer=u;this._i16View=new Int16Array(this._array)}};E.ensureSize=function(B){this._ensureSize(B)};E.writeF32=function(B){this._ensureSize(1);const u=this._pos;(new Float32Array(this._array,
4*this._pos,1))[0]=B;this._pos++;return u};E.push=function(B){this._ensureSize(1);const u=this._pos;this._buffer[this._pos++]=B;return u};E.writeFixed=function(B){this._buffer[this._pos++]=B};E.setValue=function(B,u){this._buffer[B]=u};E.i1616Add=function(B,u,A){this._i16View[2*B]+=u;this._i16View[2*B+1]+=A};E.getValue=function(B){return this._buffer[B]};E.incr=function(B){if(this._buffer.length<B)throw Error("Increment index overflows the target buffer");this._buffer[B]++};E.decr=function(B){this._buffer[B]--};
E.writeRegion=function(B){this._ensureSize(B.length);const u=this._pos;this._buffer.set(B,this._pos);this._pos+=B.length;return u};E.writeManyFrom=function(B,u,A){for(this._ensureSize(A-u);u!==A;u++)this.writeFixed(B._buffer[u])};E.buffer=function(){const B=this._array.slice(0,4*this._pos);this.destroy();return B};E.toArray=function(){const B=this._array,u=[];for(let A=0;A<B.byteLength/4;A++)u.push(B[A]);return u};E.seek=function(B){this._pos=B};E.destroy=function(){this._buffer=this._array=null};
v._createClass(t,[{key:"length",get:function(){return this._pos}}]);return t}()})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(v,t){function E(B,u,A,x){B=B.clone();const e=1<<B.level;u=B.col+u;A=B.row+A;x&&0>u?(B.col=u+e,--B.world):u>=e?(B.col=u-e,B.world+=1):B.col=u;B.row=A;return B}v.getPow2NeighborKey=E;v.getPow2NeighborTile=function(B,u,A){u=E(B.key,u,A,B.tileInfoView.tileInfo.isWrappable);return new t.Tile(B.tileInfoView,u)};Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),function(v,t,E,B,u,A,x,e,h,d){E=function(){function l(r,
k,c){this._loadPromise=A.loadLibtess();this._geometryType=r;this._idField=k;this._templateStore=c}var m=l.prototype;m.update=function(r,k){B.isSome(r.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(r.mesh.labels,k));this._schema=r};m._createLabelTemplates=function(r,k){const c=new Map;if("simple"===r.type){for(var b of r.classes)r=e.fromLabelClass(b,k),c.set(b.index,r);return c}for(const a in r.classes){b=r.classes[a];for(const g of b)b=e.fromLabelClass(g,k),c.set(g.index,b)}return c};
m.analyze=function(){var r=t._asyncToGenerator(function*(k,c,b,a,g,n,f){if(!u.isAborted(f)){var q;"dictionary"===b.type&&(q=yield b.analyze(this._idField,k.copy(),c,g,n,f));for(c=0;k.next();){var p=void 0;p=q?q[c++]:B.isSome(a)&&x.isAggregateId(k.getDisplayId())&&1!==k.readAttribute("cluster_count")?a.match(this._idField,k,this._geometryType,g,n):b.match(this._idField,k,this._geometryType,g,n);k.setGroupId(p);if(d.isDynamicId(p)){p=this._templateStore.getDynamicTemplateGroup(p);for(const z of p)z&&
z.analyze&&z.analyze(this._templateStore,k,g,n)}}yield this._loadPromise;return this._templateStore.finalize(f)}});return function(k,c,b,a,g,n,f){return r.apply(this,arguments)}}();m.analyzeGraphics=function(){var r=t._asyncToGenerator(function*(k,c,b,a,g,n){if(!u.isAborted(n)){k=k.getCursor();for(b&&(yield b.analyze(this._idField,k.copy(),c,a,g,n));k.next();){c=k.getGroupId();if(null==c||-1===c)c=b.match(this._idField,k,k.geometryType,a,g),k.setGroupId(c);if(d.isDynamicId(c)){const f=this._templateStore.getDynamicTemplateGroup(c);
for(const q of f)q&&q.analyze&&q.analyze(this._templateStore,k,a,g)}k.setGroupId(c)}yield this._loadPromise;return this._templateStore.finalize(n)}});return function(k,c,b,a,g,n){return r.apply(this,arguments)}}();m.writeGraphic=function(r,k,c,b){const a=k.getGroupId(),g=k.getDisplayId(),n=this._templateStore.getTemplateGroup(a);r.featureStart(k.insertAfter,0);if(null!=g){if(d.isDynamicId(a))for(const f of n)f&&f.bindFeature(k,null,null);if(n){for(const f of n)f&&f.write(r,k,c,b);r.featureEnd()}}};
m.writeCursor=function(r,k,c,b,a,g,n){const f=k.getGroupId(),q=k.getDisplayId(),p=this._templateStore.getTemplateGroup(f),z=this._schema.mesh.sortKey;let w=0;B.isSome(z)&&(w=null!=z.fieldIndex?k.getComputedNumericAtIndex(z.fieldIndex):null!=z.field?k.readAttribute(z.field):k.readAttribute(this._idField),w*="asc"===z.order?1:-1);r.featureStart(0,null==w||isNaN(w)?0:w);if(null!=q&&p){if(d.isDynamicId(f))for(const y of p)y.bindFeature(k,c,b);for(const y of p)y.write(r,k,a,n);B.isSome(g)&&r.hasRecords&&
(c=g&&this._findLabelRef(p),this._writeLabels(r,k,g,c,a,n));r.featureEnd()}};m._findLabelRef=function(r){for(const k of r)if(k instanceof h)return k;return null};m._writeLabels=function(r,k,c,b,a,g){for(const n of c)if(B.isSome(n)&&n){const {glyphs:f,rtl:q,index:p}=n;c=this._labelTemplates.get(p);c.setZoomLevel(a);c.bindReferenceTemplate(b);c.bindTextInfo(f,q);c.write(r,k,null,g)}};t._createClass(l,[{key:"templates",get:function(){return this._templateStore}}]);return l}();v.WGLMeshFactory=E;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c){const b=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),a=(n,f="mapview-labeling")=>b.error(new t(f,n)),g=function(n){const f=new Map;return q=>{f.has(q)||f.set(q,n(q));return f.get(q)}}(n=>{let f=0;if(0===n)return Infinity;for(;!(n%2);)f++,n/=2;return f});return function(n){function f(p,z,w,y){var G=n.call(this,p,w.font.size,w.haloSize||0,w.font.size,w.color&&h.premultiplyAlphaRGBAArray(w.color)||0,w.haloColor&&h.premultiplyAlphaRGBAArray(w.haloColor)||
0,w.horizontalAlignment,w.verticalAlignment,e.isMapAligned(z.labelPlacement)?x.Alignment.MAP:x.Alignment.SCREEN,w.font.decoration,!1,w.angle||0,w.xoffset,w.yoffset,w.lineWidth,w.lineHeight,null,null,null,null,null)||this;G._outLineLabelAngle=0;G._refPlacementPadding=0;G._refPlacementDirX=0;G._refPlacementDirY=0;G._refOffsetX=0;G._refOffsetY=0;G._zoomLevel=0;G.geometryType=l.WGLGeometryType.LABEL;G._allowOverrun=z.allowOverrun??!1;G._repeatLabel=z.repeatLabel??!0;G._labelPosition=z.labelPosition??
"curved";var H=!!z.minScale&&y.scaleToZoom(z.minScale)||0;H=B.clamp(H,0,25.5);y=!!z.maxScale&&y.scaleToZoom(z.maxScale)||255;y=B.clamp(y,0,25.5);const [I,D]=e.getAlignmentFromPlacement(z.labelPlacement);G._xAlignD=I;G._yAlignD=D;G._minZoom=H;G._maxZoom=y;G._refPlacementPadding=A.pt2px(w.haloSize)+d.TEXT_PLACEMENT_PADDING;G._repeatLabelDistance=z.repeatLabelDistance?A.pt2px(z.repeatLabelDistance):128;p=r.LabelMaterialKey.load(p);p.sdf=!0;G._materialKey=p.data;return G}v._inheritsLoose(f,n);f.fromLabelClass=
function(p,z){if("esriServerLinePlacementCenterAlong"===p.labelPlacement){const w=p.symbol;w.xoffset=0;w.yoffset=0;w.angle=0;w.font.decoration="none"}return new f(p.materialKey,p,p.symbol,z)};var q=f.prototype;q.setZoomLevel=function(p){this._zoomLevel=p};q.bindReferenceTemplate=function(p){let z=e.getXDirection(this._xAlignD),w=e.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(u.isNone(p))this._refSymbolAndPlacementOffset=m.i8888to32(0,0,Math.floor(127*z+127),Math.floor(127*w+
127));else{if("circle"===p.boundsType&&(z||w)){var y=Math.sqrt(z*z+w*w);z/=y;w/=y}y=Math.max(p.height,p.width);this._refSymbolAndPlacementOffset=m.i8888to32(4*this._refPlacementPadding,y,Math.floor(127*z+127),Math.floor(127*w+127));this._referenceSize=y;this._refPlacementDirX=z;this._refPlacementDirY=w;this._refOffsetX=p.xOffset;this._refOffsetY=p.yOffset}};q._write=function(p,z){if(!u.isNone(this._shapingInfo)){var w=this._shapingInfo,y=z.getDisplayId(),G="esriGeometryPolygon"===z.geometryType?z.readLegacyCentroid():
z.readLegacyGeometry();if(G)switch(this._current={out:p,inId:y,inShaping:w,zoomLevel:this._zoomLevel},z.geometryType){case "esriGeometryPolyline":this._placeLineLabels(G);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(G);break;default:a("mapview-labeling",`Geometry of type ${z.geometryType} is not supported`)}}};q._isVisible=function(p,z){const w=Math.floor(10*this._current.zoomLevel);return Math.floor(10*p)<=w&&w<=Math.floor(10*z)};q._placePointLabels=function(p){const {out:z,
inId:w,inShaping:y}=this._current;this._writeGlyphs(z,w,p,y)};q._placeLineLabels=function(p){p=k.smoothPaths(p.paths,this._current.inShaping.bounds.width);const z=this._placeSubdivGlyphs.bind(this),w=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const y of p)k.pathDivide(y,w,z,this._repeatLabel)};q._placeSubdivGlyphs=function(p,z,w,y){var G=g(z),H=this._shapedBox.width/2,I=Math.sqrt(this._repeatLabelDistance)/2;w=Math.min(w,y-w);H=this._current.inShaping.isMultiline?25:Math.log2(w/(I+H/
2));G=Math.max(this._minZoom,this._current.zoomLevel+1-(0===z?H:Math.min(G,H)));H=this._current.zoomLevel-G;I=this._shapedBox.width/2*2**H;this._current.inShaping.isMultiline?0===z&&this._placeStraight(p,G):this._allowOverrun&&0>H?this._placeStraightAlong(p,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(p,G):"curved"===this._labelPosition&&this._placeCurved(p,G,I)};q._placeStraight=function(p,z){const {out:w,inId:y,inShaping:G}=this._current,H=Math.ceil((180/Math.PI*p.angle+
180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*p.angle%360));this._writeGlyphs(w,y,p,G,z);this._outLineLabelAngle=Math.round(254/360*H);this._writeGlyphs(w,y,p,G,z)};q._placeCurved=function(p,z,w){const {out:y,inId:G}=this._current;y.metricStart(G,z,p.x,p.y,0,0,0,0);const H=p.clone(),I=(180/Math.PI*p.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*p.angle%360*(254/360));this._placeFirst(H,z,1);this._placeBack(p,H,z,w,1);this._placeForward(p,H,z,w,1);this._outLineLabelAngle=
Math.round(254/360*I);this._placeFirst(H,z,0);this._placeBack(p,H,z,w,0);this._placeForward(p,H,z,w,0);y.metricEnd()};q._placeStraightAlong=function(p,z){const {out:w,inId:y}=this._current;w.metricStart(y,z,p.x,p.y,0,0,0,0);const G=p.clone(),H=(180/Math.PI*p.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*p.angle%360*(254/360));this._placeFirst(G,z,1,!0);this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,z,0,!0);w.metricEnd()};q._placeBack=function(p,z,w,y,G){const H=p.clone();
for(p=p.backwardLength+0;H.prev()&&!(p>=y);)this._placeOnSegment(H,z,p,w,-1,G),p+=H.length+0};q._placeForward=function(p,z,w,y,G){const H=p.clone();for(p=p.remainingLength+0;H.next()&&!(p>=y);)this._placeOnSegment(H,z,p,w,1,G),p+=H.length+0};q._placeFirst=function(p,z,w,y=!1){const G=this._current.inShaping;var H=G.glyphs;const I=this._current.zoomLevel,{out:D,inId:C}=this._current;for(const F of H)H=F.x>G.bounds.x?w:1-w,H=Math.max(0,I+Math.log2(Math.abs(F.x+F.width/2-G.bounds.x)/(H*p.remainingLength+
(1-H)*p.backwardLength))),H=Math.max(z,y?0:H),F.maxZoom=25,F.angle=p.angle+(1-w)*Math.PI,F.minZoom=H,this._writeGlyph(D,C,p.x,p.y,F),w&&this._isVisible(F.minZoom,F.maxZoom)&&(H=F.bounds,D.metricBoxWrite(H.center[0],H.center[1],H.width,H.height))};q._placeOnSegment=function(p,z,w,y,G,H){var I=this._current.inShaping.glyphs;const {out:D,inId:C}=this._current,F=this._current.inShaping,K=this._current.zoomLevel;var J=p.x+p.dx/p.length*-G*w,P=p.y+p.dy/p.length*-G*w;for(const X of I)if((I=X.x>F.bounds.x?
H:1-H)&&1===G||!I&&-1===G){var S=Math.abs(X.x+X.width/2-F.bounds.x);I=Math.max(0,K+Math.log2(S/w)-.1);S=Math.max(y,K+Math.log2(S/(w+p.length+0)));0!==I&&(X.angle=p.angle+(1-H)*Math.PI,X.minZoom=S,X.maxZoom=I,this._writeGlyph(D,C,J,P,X),H&&this._isVisible(X.minZoom,X.maxZoom)&&(I=X.bounds,D.metricBoxWrite(I.center[0]+(p.x-z.x),I.center[1]+(p.y-z.y),I.width,I.height)))}};q._writeGlyphs=function(p,z,w,y,G=this._minZoom){if(!(0>w.x||512<=w.x||0>w.y||512<=w.y)){var H=w.x+this._refOffsetX;w=w.y-this._refOffsetY;
for(const I of y.glyphs)I.minZoom=G,I.maxZoom=this._maxZoom,this._writeGlyph(p,z,H,w,I);y=y.boundsT;p.metricStart(z,G,H,w,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);p.metricBoxWrite(y.center[0],y.center[1],y.width,y.height);p.metricEnd()}};q._writeVertexCommon=function(p,z,w,y){const G=this._color,H=this._haloColor,I=m.i8888to32(0,0,this._size,this._haloSize);y=m.i8888to32(Math.floor(10*Math.max(y.minZoom,this._minZoom)),Math.floor(10*Math.min(y.maxZoom,this._maxZoom)),
this._outLineLabelAngle,0);p.vertexWrite(w);p.vertexWrite(z);p.vertexWrite(G);p.vertexWrite(H);p.vertexWrite(I);p.vertexWrite(this._refSymbolAndPlacementOffset);p.vertexWrite(y)};v._createClass(f,[{key:"_shapedBox",get:function(){return u.unwrap(this._shapingInfo).bounds}}]);return f}(c)})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(v){v.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(v.HAlign||(v.HAlign={}));v.VAlign=
void 0;(function(t){t[t.Top=1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(v.VAlign||(v.VAlign={}));v.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[v.HAlign.Right,v.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[v.HAlign.Center,v.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[v.HAlign.Left,
v.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[v.HAlign.Right,v.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[v.HAlign.Center,v.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[v.HAlign.Left,v.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[v.HAlign.Right,v.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[v.HAlign.Center,
v.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[v.HAlign.Left,v.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[v.HAlign.Center,v.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),[v.HAlign.Center,v.VAlign.Center]}};v.getJustification=function(t){switch(t){case "left":return v.HAlign.Left;case "right":return v.HAlign.Right;case "center":return v.HAlign.Center}};v.getXAnchorDirection=
function(t){switch(t){case "left":return v.HAlign.Left;case "right":return v.HAlign.Right;case "center":return v.HAlign.Center}};v.getXDirection=function(t){switch(t){case v.HAlign.Right:return-1;case v.HAlign.Center:return 0;case v.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}};v.getYAnchorDirection=function(t){switch(t){case "top":return v.VAlign.Top;case "middle":return v.VAlign.Center;case "baseline":return v.VAlign.Baseline;case "bottom":return v.VAlign.Bottom}};
v.getYDirection=function(t){switch(t){case v.VAlign.Top:return 1;case v.VAlign.Center:return 0;case v.VAlign.Bottom:case v.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}};v.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(v,t,E,B,u){function A(n){return n===u.WGLSymbologyType.SIMPLE||n===u.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function x(n){return n===u.WGLSymbologyType.OUTLINE_FILL||n===u.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const e=Object.keys(u.WGLSymbologyType).filter(n=>
"number"===typeof u.WGLSymbologyType[n]).reduce((n,f)=>({...n,[f]:u.WGLSymbologyType[f]}),{});let h=function(){function n(q){this._data=0;this._data=q}n.load=function(q){const p=this.shared;p.data=q;return p};var f=n.prototype;f.setBit=function(q,p){q=1<<q;this._data=p?this._data|q:this._data&~q};f.bit=function(q){return(this._data&1<<q)>>q};f.setBits=function(q,p,z){for(let w=p,y=0;w<z;w++,y++)this.setBit(w,0!==(q&1<<y))};f.bits=function(q,p){let z=0;for(let w=q,y=0;w<p;w++,y++)z|=this.bit(w)<<y;
return z};f.hasVV=function(){return!1};f.setVV=function(q,p){};f.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:u.WGLSymbologyType[this.symbologyType],options:e,namespace:"SYMBOLOGY_TYPE"}}};f.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(n,[{key:"data",get:function(){return this._data},set:function(q){this._data=q}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(q){this.setBits(q,
8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(q){this.setBit(20,q)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(q){this.setBit(11,q)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(q){this.setBit(12,q)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(q){this.setBits(q,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(q){this.setBits(q,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case u.WGLGeometryType.FILL:return"fill";
case u.WGLGeometryType.MARKER:return"marker";case u.WGLGeometryType.LINE:return"line";case u.WGLGeometryType.TEXT:return"text";case u.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return n}();h.shared=new h(0);const d=n=>function(f){function q(){return f.apply(this,arguments)||this}t._inheritsLoose(q,f);var p=q.prototype;p.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};p.setVV=function(z,w){f.prototype.setVV.call(this,z,w);{var y=this.geometryType;const G=u.WGLVVFlag.SIZE_FIELD_STOPS|u.WGLVVFlag.SIZE_MINMAX_VALUE|u.WGLVVFlag.SIZE_SCALE_STOPS|u.WGLVVFlag.SIZE_UNIT_VALUE,H=(z&(u.WGLVVTarget.FIELD_TARGETS_OUTLINE|u.WGLVVTarget.MINMAX_TARGETS_OUTLINE|u.WGLVVTarget.SCALE_TARGETS_OUTLINE|u.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;w=y===u.WGLGeometryType.LINE&&w.isOutline||y===u.WGLGeometryType.FILL&&x(w.symbologyType)?G&H:G&
~H}z&=w;this.vvSizeMinMaxValue=!!(z&u.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(z&u.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(z&u.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(z&u.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(q,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(z){this.setBit(16,z)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(z){this.setBit(17,z)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(z){this.setBit(18,z)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(z){this.setBit(19,z)}}]);return q}(n),l=n=>function(f){function q(){return f.apply(this,arguments)||this}t._inheritsLoose(q,f);var p=q.prototype;p.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvRotation};p.setVV=function(z,w){f.prototype.setVV.call(this,z,w);this.vvRotation=!w.isOutline&&!!(z&u.WGLVVFlag.ROTATION)};t._createClass(q,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(z){this.setBit(15,z)}}]);return q}(n),m=n=>function(f){function q(){return f.apply(this,arguments)||this}t._inheritsLoose(q,f);var p=q.prototype;p.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvColor};p.setVV=function(z,w){f.prototype.setVV.call(this,z,w);this.vvColor=!w.isOutline&&!!(z&u.WGLVVFlag.COLOR)};t._createClass(q,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(z){this.setBit(13,z)}}]);return q}(n),r=n=>function(f){function q(){return f.apply(this,
arguments)||this}t._inheritsLoose(q,f);var p=q.prototype;p.hasVV=function(){return f.prototype.hasVV.call(this)||this.vvOpacity};p.setVV=function(z,w){f.prototype.setVV.call(this,z,w);this.vvOpacity=!w.isOutline&&!!(z&u.WGLVVFlag.OPACITY)};t._createClass(q,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(z){this.setBit(14,z)}}]);return q}(n);let k=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.load=function(q){const p=this.shared;p.data=
q;return p};f.from=function(q){const {symbologyType:p,vvFlags:z}=q,w=this.load(0);w.geometryType=u.WGLGeometryType.FILL;w.symbologyType=p;p!==u.WGLSymbologyType.DOT_DENSITY&&w.setVV(z,q);return w.data};f.prototype.getVariation=function(){return{...n.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(m(r(d(h))));
k.shared=new k(0);let c=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.load=function(q){const p=this.shared;p.data=q;return p};f.from=function(q){const {symbologyType:p,vvFlags:z}=q,w=this.load(0);w.geometryType=u.WGLGeometryType.MARKER;w.symbologyType=p;p!==u.WGLSymbologyType.HEATMAP&&w.setVV(z,q);return w.data};f.prototype.getVariation=function(){return{...n.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(m(r(l(d(h)))));c.shared=new c(0);let b=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.load=function(q){const p=this.shared;p.data=q;return p};f.from=function(q){const p=this.load(0);p.geometryType=u.WGLGeometryType.LINE;p.symbologyType=q.symbologyType;p.setVV(q.vvFlags,q);return p.data};f.prototype.getVariation=
function(){return{...n.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(m(r(d(h))));b.shared=new b(0);let a=function(n){function f(){return n.apply(this,arguments)||this}t._inheritsLoose(f,n);f.load=function(q){const p=this.shared;p.data=q;return p};f.from=function(q){const p=this.load(0);p.geometryType=
u.WGLGeometryType.TEXT;p.symbologyType=q.symbologyType;p.setVV(q.vvFlags,q);return p.data};f.prototype.getVariation=function(){return{...n.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return f}(m(r(l(d(h)))));a.shared=new a(0);let g=function(n){function f(){return n.apply(this,arguments)||
this}t._inheritsLoose(f,n);f.load=function(q){const p=this.shared;p.data=q;return p};f.from=function(q){const p=this.load(0);p.geometryType=u.WGLGeometryType.LABEL;p.symbologyType=q.symbologyType;p.setVV(q.vvFlags,q);p.mapAligned=B.isMapAligned(q.placement);return p.data};f.prototype.getVariation=function(){return{...n.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return f}(d(h));g.shared=new g(0);v.FillMaterialKey=k;v.LabelMaterialKey=g;v.LineMaterialKey=b;v.MarkerMaterialKey=c;v.MaterialKeyBase=h;v.TextMaterialKey=a;v.createMaterialKey=function(n,f){switch(n){case u.WGLGeometryType.FILL:return k.from(f);case u.WGLGeometryType.LINE:return b.from(f);case u.WGLGeometryType.MARKER:return c.from(f);case u.WGLGeometryType.TEXT:return a.from(f);case u.WGLGeometryType.LABEL:return g.from(f);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${n}`);
}};v.hasOutlineFillSymbology=function(n){return x(n.symbologyType)};v.hasSimpleSymbology=function(n){return A(n.symbologyType)};v.hydrateMaterialKey=function(n){switch(h.load(n).geometryType){case u.WGLGeometryType.MARKER:return new c(n);case u.WGLGeometryType.FILL:return new k(n);case u.WGLGeometryType.LINE:return new b(n);case u.WGLGeometryType.TEXT:return new a(n);case u.WGLGeometryType.LABEL:return new g(n)}};v.isOutlineFillSymbology=x;v.isSimpleSymbology=A;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(v,t,E,B){function u(d){return d.length-1}function A(d){let l=0;for(let m=0;m<u(d);m++)l+=x(d,m);return l}function x(d,l,m=1){const [r,k]=d[l+1];return Math.sqrt(r*r+k*k)*m}function e(d,l,m,r,k){if(!(m<l)){var c=r.clone().seek(m/2);E.isNone(c)||(d(c.clone(),m,k),m=(m-l)/
2,c=E.unwrap(c.seek(l/2)),e(d,l,m,r,k+1),e(d,l,m,c,k+1))}}let h=function(){function d(m,r,k,c,b){this._segments=m;this._index=r;this._distance=k;this._xStart=c;this._yStart=b;this._done=!1}d.create=function(m){return new d(m,0,0,m[0][0],m[0][1])};var l=d.prototype;l.clone=function(){return new d(this._segments,this._index,this._distance,this.xStart,this.yStart)};l.equals=function(m){return this._index===m._index||m._index===this._index-1&&(0===this._distance||1===m._distance)||m._index===this._index+
1&&(1===this._distance||0===m._distance)};l.leq=function(m){return this._index<m._index||this._index===m._index&&this._distance<=m._distance};l.geq=function(m){return this._index>m._index||this._index===m._index&&this._distance>=m._distance};l.hasPrev=function(){return 0<=this._index-1};l.hasNext=function(){return this._index+1<u(this._segments)};l.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};l.prev=function(){if(!this.hasPrev())return this._done=
!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};l._seekBackwards=function(m,r){var k=this.backwardLength;if(m<=k)return this._distance=(k-m)/this.length,this;for(k=this.backwardLength;this.prev();){if(k+this.length>m)return this._seekBackwards(m-k);k+=this.length}this._distance=0;return r?this:null};l.seek=function(m,r=!1){if(0>m)return this._seekBackwards(Math.abs(m),r);if(m<=this.remainingLength)return this._distance=(this.backwardLength+m)/this.length,
this;let k=this.remainingLength;for(;this.next();){if(k+this.length>m)return this.seek(m-k,r);k+=this.length}this._distance=1;return r?this:null};t._createClass(d,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const m=this.dy;let r=Math.acos((0*m+-1*-this.dx)/(1*this.length));0<m&&(r=2*Math.PI-r);return r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+
this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:m,dy:r}=this;return Math.sqrt(m*
m+r*r)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return d}();v.SegmentCursor=h;v.pathDivide=function(d,l,m,r=!0){const k=A(d);d=h.create(d);const c=k/2;if(r){r=Math.floor(Math.max((k-l)/2,0)/l);d.seek(c-r*l);for(let b=-r;b<=r;b++)512>d.x&&0<=d.x&&512>d.y&&0<=d.y&&m(d.clone(),b,c+b*l,k),
d.seek(l)}else d.seek(c),m(d.clone(),0,c+0*l,k)};v.pathLength=A;v.pathSubdivide=function(d,l,m){e(m,l,A(d),h.create(d),0)};v.segmentAt=function(d,l){return d[l+1]};v.segmentCount=u;v.segmentLength=x;v.smoothPaths=function(d,l){for(let H=0;H<d.length;H++){var m=d[H];const I=[];I.push(m[0]);for(var r=1;r<m.length;r++){let [D,C]=I[r-1];D+=m[r][0];C+=m[r][1];I.push([D,C])}a:{m=I;r=l;if(0>=r)break a;const D=m.length;if(3>D)break a;const C=[];var k=0;C.push(0);for(var c=1;c<D;c++)k+=B.dist(m[c],m[c-1]),
C.push(k);r=Math.min(r,.2*k);k=[];k.push(m[0][0]);k.push(m[0][1]);c=m[D-1][0];const F=m[D-1][1];var b=B.sub([0,0],m[0],m[1]);B.normalize(b);m[0][0]+=r*b[0];m[0][1]+=r*b[1];B.sub(b,m[D-1],m[D-2]);B.normalize(b);m[D-1][0]+=r*b[0];m[D-1][1]+=r*b[1];for(b=1;b<D;b++)C[b]+=r;C[D-1]+=r;b=.5*r;for(let K=1;K<D-1;K++){let J=0,P=0,S=0;for(var a=K-1;0<=a&&!(C[a+1]<C[K]-b);a--){var g=b+C[a+1]-C[K],n=C[a+1]-C[a],f=C[K]-C[a]<b?1:g/n;if(1E-6>Math.abs(f))break;var q=f*f,p=f*g-.5*q*n,z=f*n/r,w=m[a+1],y=m[a][0]-w[0],
G=m[a][1]-w[1];J+=z/p*(w[0]*f*g+.5*q*(g*y-n*w[0])-q*f*n*y/3);P+=z/p*(w[1]*f*g+.5*q*(g*G-n*w[1])-q*f*n*G/3);S+=z}for(a=K+1;a<D&&!(C[a-1]>C[K]+b);a++){g=b-C[a-1]+C[K];n=C[a]-C[a-1];f=C[a]-C[K]<b?1:g/n;if(1E-6>Math.abs(f))break;q=f*f;p=f*g-.5*q*n;z=f*n/r;w=m[a-1];y=m[a][0]-w[0];G=m[a][1]-w[1];J+=z/p*(w[0]*f*g+.5*q*(g*y-n*w[0])-q*f*n*y/3);P+=z/p*(w[1]*f*g+.5*q*(g*G-n*w[1])-q*f*n*G/3);S+=z}k.push(J/S);k.push(P/S)}k.push(c);k.push(F);for(let K=0,J=0;K<D;K++)m[K][0]=k[J++],m[K][1]=k[J++]}m=[];m.push(I[0]);
for(r=1;r<I.length;r++){const [D,C]=I[r-1],[F,K]=I[r];m.push([Math.round(F-D),Math.round(K-C)])}d[H]=m}return d};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(v){function t(E,B){return Math.sqrt(E*E+B*B)}v.DEFAULT_MAX_ZOOM=100;v.DEFAULT_MIN_ZOOM=0;v.dist=function(E,B){return t(E[0]-B[0],E[1]-B[1])};v.getLimitCosine=function(E=2){return 1/Math.max(E,1)};v.getMinMaxZoom=
function(E,B){const u=!!E.minScale&&B.scaleToZoom(E.minScale)||0;E=!!E.maxScale&&B.scaleToZoom(E.maxScale)||100;return[u,E]};v.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};v.isFunction=function(E){return"function"===typeof E};v.isMultipoint=function(E){return void 0!==E.points};v.isPoint=function(E){return void 0!==E.x&&void 0!==E.y};v.isPolygon=function(E){return void 0!==E.rings};v.isPolyline=function(E){return void 0!==E.paths};v.len=t;v.normalize=
function(E){const B=t(E[0],E[1]);E[0]/=B;E[1]/=B};v.sub=function(E,B,u){E[0]=B[0]-u[0];E[1]=B[1]-u[1];return E};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m){return function(r){function k(c,b,a,g,n,f,q,p,z,w,y,G,H,I,D,C,F,K,J=!1,P,S){var X=r.call(this)||this;X._xOffset=E.pt2px(H);X._yOffset=E.pt2px(I);X._decoration=w||"none";X._color=n;X._haloColor=f;X._haloSize=Math.min(Math.floor(5*E.pt2px(E.toPt(a))),127);X._size=Math.min(Math.round(E.pt2px(b)),127);b=Math.min(Math.round(E.pt2px(g||b)),127);X._referenceSize=Math.round(Math.sqrt(256*b));X._scale=X._size/x.GLYPH_SIZE;X._angle=G;X._justify=u.getJustification(q||"center");
X._xAlignD=u.getXAnchorDirection(q||"center");X._yAlignD=u.getYAnchorDirection(p||"baseline");X._baseline="baseline"===(p||"baseline");X._bitset=(z===B.Alignment.MAP?1:0)|(y?1:0)<<1;c=h.MaterialKeyBase.load(c);c.sdf=!0;X._materialKey=c.data;X._lineWidth=E.pt2px(D)||512;X._lineHeight=C||1;X._textPlacement=F;X._effects=K;X._isCIM=J;X._minMaxZoom=e.i1616to32(Math.round(P*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(S*x.MIN_MAX_ZOOM_PRECISION_FACTOR));return X}v._inheritsLoose(k,r);k.fromText=function(c,
b){const a=new k(c.materialKey,c.font.size,c.haloSize||0,c.font.size,c.color&&A.premultiplyAlphaRGBAArray(c.color)||0,c.haloColor&&A.premultiplyAlphaRGBAArray(c.haloColor)||0,c.horizontalAlignment,c.verticalAlignment,B.Alignment.SCREEN,c.font.decoration,!1,c.angle||0,c.xoffset,c.yoffset,c.lineWidth,c.lineHeight,null,null,!1,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM),[,g]=t.bidiText(c.text);a.bindTextInfo(b,g);a._vertexBoundsScale=c.maxVVSize?c.maxVVSize/c.font.size:1;return a};k.fromCIMText=function(c,
b,a){var g=c.scaleFactor||1;const n=c.size*c.sizeRatio*g,[f,q]=d.getMinMaxZoom(c.scaleInfo,a);a=new k(c.materialKey,n,c.outlineSize*c.sizeRatio,c.referenceSize,A.premultiplyAlphaRGBA(c.color),A.premultiplyAlphaRGBA(c.outlineColor),c.horizontalAlignment,c.verticalAlignment,c.alignment,c.decoration,c.colorLocked,c.angle,c.offsetX*c.sizeRatio*g,c.offsetY*c.sizeRatio*g,512,1,c.markerPlacement,c.effects,!0,f,q);[,g]=t.bidiText(c.text);a.bindTextInfo(b,g);a._vertexBoundsScale=c.maxVVSize?c.maxVVSize/n:
1;return a};return k}(l(m))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(v,t,E,B,u,A,x,e,h,d){return l=>function(m){function r(...c){c=
m.call(this,...c)||this;c._isCIM=!1;c._vertexBoundsScale=1;c.geometryType=x.WGLGeometryType.TEXT;c._aux=e.i8888to32(0,0,c._referenceSize,c._bitset);return c}v._inheritsLoose(r,m);var k=r.prototype;k.bindTextInfo=function(c,b){this._shapingInfo=c&&c.length?t.applySome(c,a=>d.shapeGlyphs(a,b,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:A.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};k._write=function(c,b,a,g){const n=b.getDisplayId();this._writeGeometry(c,b,n,a,g)};k._writeGeometry=function(c,b,a,g,n){const f=this._shapingInfo;if(!t.isNone(f)){if(t.isSome(this._textPlacement))return b=n??b.readLegacyGeometryForDisplay(),this._writePlacedText(c,a,b,f,g);g=n?B.deltaDecodeGeometry(B.convertFromGeometry(n),2):"esriGeometryPolygon"===b.geometryType?b.readCentroid():b.readGeometryForDisplay();
if(!t.isNone(g)){if(g.isPoint){const [q,p]=g.coords;return!c.hasAggregates&&c.hasPixelBufferEnabled&&(0>q||512<=q||0>p||512<=p)?void 0:this._writeGlyphs(c,a,{x:q,y:p},f)}g.forEachVertex((q,p)=>this._writeGlyphs(c,a,{x:q,y:p},f))}}};k._writePlacedText=function(c,b,a,g,n){var f=t.unwrap(this._textPlacement);if(a=u.CIMMarkerPlacementHelper.getPlacement(a,f,E.pt2px(1),n.geometryEngine))for(var q=a.next();null!=q;)n=-q.getAngle(),g.setRotation(n),f=q.tx,q=-q.ty,0>f||512<=f||0>q||512<=q||(this._writeGlyphs(c,
b,{x:f,y:q},g),g.setRotation(-n)),q=a.next()};k._writeGlyphs=function(c,b,a,g){const n=h.MaterialKeyBase.load(this._materialKey),f=e.i1616to32(Math.round(8*a.x),Math.round(8*a.y)),q=this._vertexBoundsScale,p=g.bounds,z=2*Math.max(p.width,p.height);for(const w of g.glyphs)n.textureBinding=w.textureBinding,c.recordStart(b,n.data,this.geometryType,!0),c.vertexBounds(a.x+p.x+this._xOffset,a.y+p.y-this._yOffset,z*q,z*q),this._writeVertices(c,b,f,w),c.recordEnd()};k._writeGlyph=function(c,b,a,g,n){var f=
h.MaterialKeyBase.load(this._materialKey);const q=e.i1616to32(Math.round(8*a),Math.round(8*g));f.textureBinding=n.textureBinding;c.recordStart(b,f.data,this.geometryType,!0);f=n.bounds;const p=this._vertexBoundsScale;c.vertexBounds(a+f.x*p,g+f.y*p,f.width*p,f.height*p);this._writeVertices(c,b,q,n);c.recordEnd()};k._writeVertices=function(c,b,a,g){const n=c.vertexCount();this._writeVertexCommon(c,b,a,g);c.vertexWrite(g.offsets.upperLeft);c.vertexWrite(g.texcoords.upperLeft);c.vertexEnd();this._writeVertexCommon(c,
b,a,g);c.vertexWrite(g.offsets.upperRight);c.vertexWrite(g.texcoords.upperRight);c.vertexEnd();this._writeVertexCommon(c,b,a,g);c.vertexWrite(g.offsets.lowerLeft);c.vertexWrite(g.texcoords.lowerLeft);c.vertexEnd();this._writeVertexCommon(c,b,a,g);c.vertexWrite(g.offsets.lowerRight);c.vertexWrite(g.texcoords.lowerRight);c.vertexEnd();c.indexWrite(n+0);c.indexWrite(n+1);c.indexWrite(n+2);c.indexWrite(n+1);c.indexWrite(n+3);c.indexWrite(n+2)};k._writeVertexCommon=function(c,b,a,g){g=this._color;const n=
this._haloColor,f=e.i8888to32(0,0,this._referenceSize,this._bitset),q=e.i8888to32(0,0,this._size,this._haloSize);c.vertexWrite(a);c.vertexWrite(b);c.vertexWrite(g);c.vertexWrite(n);c.vertexWrite(q);c.vertexWrite(f);c.vertexWrite(this._minMaxZoom)};return r}(l)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(v,t,E){let B=function(){function u(){}u.getPlacement=function(A,x,e,h){const d=E.getPlacementOperator(x);if(!d)return null;
A=t.cloneAndDecodeGeometry(A);return d.execute(A,x,e,h)};return u}();v.CIMMarkerPlacementHelper=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(v,t,E,B){function u(a){a&&(E.isPoint(a)?a.y=-a.y:E.isPolygon(a)?x(a.rings):E.isPolyline(a)?x(a.paths):E.isMultipoint(a)&&A(a.points))}function A(a){if(a){const g=a.length;for(let n=
0;n<g;n++)a[n][1]=-a[n][1]}}function x(a){if(a)for(const g of a)A(g)}function e(a){if(a){var g=a.length;for(--g;0<g;--g)a[g][0]-=a[g-1][0],a[g][1]-=a[g-1][1]}}function h(a){if(a)for(const g of a)e(g)}function d(a){if(a){const g=a.length;for(let n=1;n<g;++n)a[n][0]+=a[n-1][0],a[n][1]+=a[n-1][1]}}function l(a){if(a)for(const g of a)d(g)}function m(a){a&&(E.isPolygon(a)?l(a.rings):E.isPolyline(a)?l(a.paths):E.isMultipoint(a)&&d(a.points),u(a))}function r(a){a&&a.reverse()}function k(a){return{rings:[[[a.xmin,
a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]}}let c=function(){function a(g,n,f,q=0){this.isClosed=!1;this.multiPath=null;this.acceptPolygon=n;this.acceptPolyline=f;this.geomUnitsPerPoint=q;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;g&&(E.isPolygon(g)?n&&(this.multiPath=g.rings,this.isClosed=!0):E.isPolyline(g)?f&&(this.multiPath=g.paths,this.isClosed=!1):E.isExtent(g)&&n&&(this.multiPath=k(g).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));
this.internalPlacement=new B.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const g=this.processPath(this.multiPath[this.pathIndex]);if(g)return g}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}(),b=function(){function a(g,n,f,q=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=g;this.acceptPolygon=n;this.acceptPolyline=f;this.geomUnitsPerPoint=q;this.pathIndex=
this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var g=this.inputGeometries.next();g;)if(E.isPolygon(g)?this.acceptPolygon&&(this.multiPath=g.rings,this.isClosed=!0):E.isPolyline(g)?this.acceptPolyline&&(this.multiPath=g.paths,this.isClosed=!1):E.isExtent(g)&&this.acceptPolygon&&(this.multiPath=k(g).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else g=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||
this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,g=this.processPath(this.multiPath[this.pathIndex]))return g;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();v.PathGeometryCursor=b;v.PathTransformationCursor=c;v.cloneAndDecodeGeometry=function(a){a=t.clone(a);m(a);return a};v.deltaDecodeGeometry=m;v.deltaEncodeGeometry=function(a){a&&(u(a),E.isPolygon(a)?h(a.rings):E.isPolyline(a)?h(a.paths):E.isMultipoint(a)&&e(a.points))};v.getCoord2D=function(a,g,n){return[a[0]+
(g[0]-a[0])*n,a[1]+(g[1]-a[1])*n]};v.getId=function(a){return a[4]};v.isClosedPath=function(a){return a&&0!==a.length?a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]:!1};v.reverseMultipath=function(a){if(a)for(const g of a)r(g)};v.reversePath=r;v.setId=function(a,g){a[4]=g};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(v){let t=function(){function B(){this.setIdentity()}var u=
B.prototype;u.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};u.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};u.setTranslate=function(A,x){this.tx=A;this.ty=x};u.setTranslateZ=function(A){this.tz=A};u.setRotateCS=function(A,x){this.rz=void 0;this.rzCos=A;this.rzSin=x};u.setRotate=function(A){this.rz=A;this.rzSin=this.rzCos=void 0};u.setRotateY=
function(A){this.ry=A};u.setScale=function(A){this.s=A};u.setMeasure=function(A){this.m=A};return B}(),E=function(){function B(){}B.prototype.next=function(){return null};return B}();v.EmptyPlacementCursor=E;v.Placement=t;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p){v.getEffectOperator=function(z){if(!z)return null;switch(z.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return B.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return u.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return A.EffectCut.local();case "CIMGeometricEffectDashes":return x.EffectDashes.local();
case "CIMGeometricEffectDonut":return e.EffectDonut.local();case "CIMGeometricEffectJog":return h.EffectJog.local();case "CIMGeometricEffectMove":return d.EffectMove.local();case "CIMGeometricEffectOffset":return l.EffectOffset.local();case "CIMGeometricEffectReverse":return m.EffectReverse.local();case "CIMGeometricEffectRotate":return r.EffectRotate.local();case "CIMGeometricEffectScale":return k.EffectScale.local();case "CIMGeometricEffectWave":return c.EffectWave.local()}return null};v.getPlacementOperator=
function(z){if(!z)return null;switch(z.type){case "CIMMarkerPlacementAlongLineSameSize":return b.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return a.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return g.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return n.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return f.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return q.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return p.PlacementPolygonCenter.local()}return null};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,
h,d)};return x}();u.instance=null;let A=function(){function x(h,d,l){this._inputGeometries=h;this._angleTolerance=void 0!==d.angleTolerance?d.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var e=x.prototype;e.next=function(){for(var h=this._inputGeometries.next();h;){if(E.isPolygon(h))return this._isClosed=!0,h=t.clone(h),this._processMultipath(h.rings),h;if(E.isPolyline(h))return this._isClosed=!1,h=t.clone(h),this._processMultipath(h.paths),h;if(E.isExtent(h)){if(this._maxCosAngle)return h;
this._isClosed=!0;h=[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]];this._processPath(h);return{rings:[h]}}h=this._inputGeometries.next()}return null};e._processMultipath=function(h){if(h)for(const d of h)this._processPath(d)};e._processPath=function(h){if(h){let d=h.length,l=h[0],m,r,k,c,b,a;this._isClosed&&++d;for(let g=1;g<d;++g){let n;n=this._isClosed&&g===d-1?h[0]:h[g];const f=n[0]-l[0],q=n[1]-l[1],p=Math.sqrt(f*f+q*q);1<g&&0<p&&0<k&&(m*f+r*q)/p/k<=this._maxCosAngle&&
B.setId(l,1);1===g&&(c=f,b=q,a=p);0<p&&(l=n,m=f,r=q,k=p)}this._isClosed&&0<k&&0<a&&(m*c+r*b)/a/k<=this._maxCosAngle&&B.setId(h[0],1)}};return x}();v.EffectAddControlPoints=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(v,t,E,B,u){const A=u.GeometricEffectArrowType.OpenEnded;let x=function(){function h(){}
h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(d,l,m,r){return new e(d,l,m)};return h}();x.instance=null;let e=function(h){function d(m,r,k){m=h.call(this,m,!1,!0)||this;m._curveHelper=new B.CurveHelper;m._width=(void 0!==r.width?r.width:5)*k;m._arrowType=void 0!==r.geometricEffectArrowType?r.geometricEffectArrowType:void 0!==r.arrowType?r.arrowType:A;m._offsetFlattenError=B.PIXEL_TOLERANCE*k;return m}t._inheritsLoose(d,h);var l=d.prototype;
l.processPath=function(m){switch(this._arrowType){default:return this._constructSimpleArrow(m,!0);case u.GeometricEffectArrowType.Block:return this._constructSimpleArrow(m,!1);case u.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(m)}};l._constructSimpleArrow=function(m,r){var k=this._curveHelper.calculatePathLength(m),c=this._width;k<2*c&&(c=k/2);k=this._curveHelper.getSubCurve(m,0,k-c);if(!k)return null;var b=c/2;if(this._curveHelper.isEmpty(k,!1))return null;c=this._constructOffset(k,
-b);if(!c)return null;k=this._constructOffset(k,b);if(!k)return null;const a=this._constructArrowBasePoint(c,-b/2);if(!a)return null;b=this._constructArrowBasePoint(k,b/2);if(!b)return null;m=m[m.length-1];r||(this._makeControlPoint(k,!0),this._makeControlPoint(c,!0));const g=new B.PathHelper;g.addPath(k,!0);g.lineTo(b);this._makeControlPoint(g.path());g.lineTo(m);this._makeControlPoint(g.path());g.lineTo(a);this._makeControlPoint(g.path());g.addPath(c,!1);return r?{paths:[g.path()]}:(g.close(),{rings:[g.path()]})};
l._constructCrossedArrow=function(m){var r=this._curveHelper.calculatePathLength(m),k=this._width;r<3.732050807568877*k&&(k=r/3.732050807568877);var c=this._curveHelper.getSubCurve(m,0,r-2.732050807568877*k);if(!c)return null;var b=k/2;if(this._curveHelper.isEmpty(c,!1))return null;const a=this._constructOffset(c,b);if(!a)return null;c=this._constructOffset(c,-b);if(!c)return null;r=this._curveHelper.getSubCurve(m,0,r-k);if(!r||this._curveHelper.isEmpty(r,!1))return null;k=this._constructOffset(r,
b);if(!k)return null;var g=this._constructOffset(r,-b);if(!g)return null;r=k[k.length-1];k=this._constructArrowBasePoint(k,b/2);if(!k)return null;const n=g[g.length-1];b=this._constructArrowBasePoint(g,-b/2);if(!b)return null;m=m[m.length-1];this._makeControlPoint(a,!1);this._makeControlPoint(c,!1);g=new B.PathHelper;g.addPath(a,!0);this._makeControlPoint(g.path());g.lineTo(n);g.lineTo(b);this._makeControlPoint(g.path());g.lineTo(m);this._makeControlPoint(g.path());g.lineTo(k);this._makeControlPoint(g.path());
g.lineTo(r);this._makeControlPoint(g.path());g.addPath(c,!1);return{paths:[g.path()]}};l._constructOffset=function(m,r){return this._curveHelper.offset(m,r,u.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};l._constructArrowBasePoint=function(m,r){if(!m||2>m.length)return null;var k=m[m.length-2];m=m[m.length-1];k=[m[0]-k[0],m[1]-k[1]];this._curveHelper.normalize(k);return[m[0]+k[1]*r,m[1]-k[0]*r]};l._makeControlPoint=function(m,r=!1){r?E.setId(m[0],1):E.setId(m[m.length-1],1)};return d}(E.PathGeometryCursor);
v.EffectArrow=x;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(v,t){let E=function(){function u(){this._path=[]}var A=u.prototype;A.path=function(){return this._path};A.addPath=function(x,e){e||x.reverse();Array.prototype.push.apply(this._path,x);e||x.reverse()};u.mergePath=function(x,e){e&&Array.prototype.push.apply(x,e)};A.startPath=function(x){this._path.push(x)};A.lineTo=
function(x){this._path.push(x)};A.close=function(){const x=this._path;1<x.length&&(x[0][0]!==x[x.length-1][0]||x[0][1]!==x[x.length-1][1])&&x.push([x[0][0],x[0][1]])};return u}(),B=function(){function u(x,e){}var A=u.prototype;A.normalize=function(x){const e=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==e&&(x[0]/=e,x[1]/=e)};A.calculateLength=function(x,e){const h=e[0]-x[0];x=e[1]-x[1];return Math.sqrt(h*h+x*x)};A.calculateSegLength=function(x,e){return this.calculateLength(x[e],x[e+1])};A.calculatePathLength=
function(x){let e=0;const h=x?x.length:0;for(let d=0;d<h-1;++d)e+=this.calculateSegLength(x,d);return e};A.calculatePathArea=function(x){let e=0;const h=x?x.length:0;for(let d=0;d<h-1;++d)e+=(x[d+1][0]-x[d][0])*(x[d+1][1]+x[d][1]);return e/2};A.getCoord2D=function(x,e,h){return[x[0]+(e[0]-x[0])*h,x[1]+(e[1]-x[1])*h]};A.getSegCoord2D=function(x,e,h){return this.getCoord2D(x[e],x[e+1],h)};A.getAngle=function(x,e,h){return Math.atan2(e[1]-x[1],e[0]-x[0])};A.getSegAngle=function(x,e,h){return this.getAngle(x[e],
x[e+1],h)};A.getAngleCS=function(x,e,h){h=e[0]-x[0];x=e[1]-x[1];e=Math.sqrt(h*h+x*x);return 0<e?[h/e,x/e]:[1,0]};A.getSegAngleCS=function(x,e,h){return this.getAngleCS(x[e],x[e+1],h)};A.cut=function(x,e,h,d){h=0>=h?x[e]:this.getSegCoord2D(x,e,h);x=1<=d?x[e+1]:this.getSegCoord2D(x,e,d);return[h,x]};A.addSegment=function(x,e,h){h&&x.push(e[0]);x.push(e[1])};A.getSubCurve=function(x,e,h){const d=[];return this.appendSubCurve(d,x,e,h)?d:null};A.appendSubCurve=function(x,e,h,d){const l=e?e.length-1:0;
let m=0,r=!0,k=0;for(;k<l;){const b=this.calculateSegLength(e,k);if(0!==b){if(r){if(m+b>h){var c=(h-m)/b;let a=1,g=!1;m+b>=d&&(a=(d-m)/b,g=!0);(c=this.cut(e,k,c,a))&&this.addSegment(x,c,r);if(g)break;r=!1}}else{if(m+b>d){(e=this.cut(e,k,0,(d-m)/b))&&this.addSegment(x,e,r);break}this.addSegment(x,[e[k],e[k+1]],r)}m+=b}++k}return!0};A.getCIMPointAlong=function(x,e){const h=x?x.length-1:0;let d=0,l=-1;for(;l<h;){++l;const m=this.calculateSegLength(x,l);if(0!==m){if(d+m>e)return this.getCoord2D(x[l],
x[l+1],(e-d)/m);d+=m}}return null};A.isEmpty=function(x,e){if(!x||1>=x.length)return!0;const h=x?x.length-1:0;let d=-1;for(;d<h;)if(++d,x[d+1][0]!==x[d][0]||x[d+1][1]!==x[d][1]||e&&x[d+1][2]!==x[d][2])return!1;return!0};A.offset=function(x,e,h,d,l){if(!x||2>x.length)return null;var m=0,r=x[m++];for(l=m;m<x.length;){var k=x[m];if(k[0]!==r[0]||k[1]!==r[1])m!==l&&(x[l]=x[m]),r=x[l++];m++}(m=x[0][0]===x[l-1][0]&&x[0][1]===x[l-1][1])&&--l;if(l<(m?3:2))return null;k=[];r=m?x[l-1]:null;let c=x[0];for(let f=
0;f<l;f++){const q=f===l-1?m?x[0]:null:x[f+1];if(r)if(q){var b=[q[0]-c[0],q[1]-c[1]];this.normalize(b);var a=[c[0]-r[0],c[1]-r[1]];this.normalize(a);var g=a[0]*b[1]-a[1]*b[0],n=a[0]*b[0]+a[1]*b[1];if(0===g&&1===n){c=q;continue}if(0<=g===0>=e)1>n&&(b=[b[0]-a[0],b[1]-a[1]],this.normalize(b),a=Math.sqrt((1+n)/2),a>1/d&&(a=-Math.abs(e)/a,k.push([c[0]-b[0]*a,c[1]-b[1]*a])));else switch(h){case t.GeometricEffectOffsetMethod.Mitered:if(r=Math.sqrt((1+n)/2),0<r&&1/r<d){b=[b[0]-a[0],b[1]-a[1]];this.normalize(b);
a=Math.abs(e)/r;k.push([c[0]-b[0]*a,c[1]-b[1]*a]);break}case t.GeometricEffectOffsetMethod.Bevelled:k.push([c[0]+a[1]*e,c[1]-a[0]*e]);k.push([c[0]+b[1]*e,c[1]-b[0]*e]);break;case t.GeometricEffectOffsetMethod.Rounded:if(1>n){k.push([c[0]+a[1]*e,c[1]-a[0]*e]);r=Math.floor(2.5*(1-n));if(0<r){g=n=1/r;for(let p=1;p<r;p++,g+=n){const z=[a[1]*(1-g)+b[1]*g,-a[0]*(1-g)-b[0]*g];this.normalize(z);k.push([c[0]+z[0]*e,c[1]+z[1]*e])}}k.push([c[0]+b[1]*e,c[1]-b[0]*e])}break;default:0>g?(k.push([c[0]+(a[1]+a[0])*
e,c[1]+(a[1]-a[0])*e]),k.push([c[0]+(b[1]-b[0])*e,c[1]-(b[0]+b[1])*e])):(r=Math.sqrt((1+Math.abs(n))/2),b=[b[0]-a[0],b[1]-a[1]],this.normalize(b),a=e/r,k.push([c[0]-b[0]*a,c[1]-b[1]*a]))}}else b=[c[0]-r[0],c[1]-r[1]],this.normalize(b),k.push([c[0]+b[1]*e,c[1]-b[0]*e]);else b=[q[0]-c[0],q[1]-c[1]],this.normalize(b),k.push([c[0]+b[1]*e,c[1]-b[0]*e]);r=c;c=q}if(k.length<(m?3:2))return null;m&&k.push([k[0][0],k[0][1]]);return k};return u}();v.CurveHelper=B;v.PIXEL_TOLERANCE=.03;v.PathHelper=E;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d,l)};return x}();u.instance=null;let A=function(){function x(e,h,d,l){this._inputGeometries=e;this._curveHelper=new E.CurveHelper;
this._size=(void 0!==h.size?h.size:1)*d;this._offsetFlattenError=E.PIXEL_TOLERANCE*d}x.prototype.next=function(){let e=this._inputGeometries.next();for(;e;){if(t.isExtent(e))if(0<this._size){var h=this._curveHelper.offset([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]],this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(h)return{rings:[h]}}else if(0>this._size){if(0<Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size)return{xmin:e.xmin-
this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size}}else return e;if(t.isPolygon(e)){if(0===this._size)return e;h=[];for(const l of e.rings){var d=this._curveHelper.offset(l,this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);d&&h.push(d)}if(h.length)return{rings:h}}if(t.isPolyline(e)&&0<this._size){h=[];for(const l of e.paths)if(l&&1<l.length){d=this._curveHelper.offset(l,this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);
const m=this._curveHelper.offset(l,-this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(d&&m){for(let r=m.length-1;0<=r;r--)d.push(m[r]);d.push([d[0][0],d[0][1]]);h.push(d)}}if(h.length)return{rings:h}}t.isPoint(e);e=this._inputGeometries.next()}return null};return x}();v.EffectBuffer=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils",
"../CIMCursor","../enums"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();u.instance=null;let A=function(){function x(h,d,l){this._defaultPointSize=20;this._inputGeometries=h;this._geomUnitsPerPoint=l;this._rule=d.rule??B.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*l}var e=x.prototype;e.next=function(){let h;
for(;h=this._inputGeometries.next();){let d;t.isPoint(h)?d=this._processGeom([[[h.x,h.y]]]):t.isMultipoint(h)?d=this._processGeom([h.points]):t.isPolyline(h)?d=this._processGeom(h.paths):t.isPolygon(h)&&(d=this._processGeom(h.rings));if(d&&d.length)return{paths:d}}return null};e._clone=function(h){return[h[0],h[1]]};e._mid=function(h,d){return[(h[0]+d[0])/2,(h[1]+d[1])/2]};e._mix=function(h,d,l,m){return[h[0]*d+l[0]*m,h[1]*d+l[1]*m]};e._add=function(h,d){return[h[0]+d[0],h[1]+d[1]]};e._add2=function(h,
d,l){return[h[0]+d,h[1]+l]};e._sub=function(h,d){return[h[0]-d[0],h[1]-d[1]]};e._dist=function(h,d){return Math.sqrt((h[0]-d[0])*(h[0]-d[0])+(h[1]-d[1])*(h[1]-d[1]))};e._norm=function(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])};e._normalize=function(h,d=1){d/=this._norm(h);h[0]*=d;h[1]*=d};e._leftPerpendicular=function(h){const d=h[0];h[0]=-h[1];h[1]=d};e._leftPerp=function(h){return[-h[1],h[0]]};e._rightPerpendicular=function(h){const d=-h[0];h[0]=h[1];h[1]=d};e._rightPerp=function(h){return[h[1],
-h[0]]};e._dotProduct=function(h,d){return h[0]*d[0]+h[1]*d[1]};e._crossProduct=function(h,d){return h[0]*d[1]-h[1]*d[0]};e._rotateDirect=function(h,d,l){const m=h[0]*l+h[1]*d;h[0]=h[0]*d-h[1]*l;h[1]=m};e._makeCtrlPt=function(h){h=[h[0],h[1]];E.setId(h,1);return h};e._addAngledTicks=function(h,d,l,m){const r=this._sub(l,d);this._normalize(r);var k=this._crossProduct(r,this._sub(m,d));m=0<k?this._rightPerp(r):this._leftPerp(r);k=Math.abs(k)/2;const c=[];c.push([d[0]+(m[0]-r[0])*k,d[1]+(m[1]-r[1])*
k]);c.push(d);c.push(l);c.push([l[0]+(m[0]+r[0])*k,l[1]+(m[1]+r[1])*k]);h.push(c)};e._addBezier2=function(h,d,l,m,r){if(0===r--)h.push(m);else{var k=this._mid(d,l);l=this._mid(l,m);var c=this._mid(k,l);this._addBezier2(h,d,k,c,r);this._addBezier2(h,c,l,m,r)}};e._addBezier3=function(h,d,l,m,r,k){if(0===k--)h.push(r);else{var c=this._mid(d,l),b=this._mid(l,m);m=this._mid(m,r);l=this._mid(c,b);b=this._mid(b,m);var a=this._mid(l,b);this._addBezier3(h,d,c,l,a,k);this._addBezier3(h,a,b,m,r,k)}};e._add90DegArc=
function(h,d,l,m,r){m=r??0<this._crossProduct(this._sub(l,d),this._sub(m,d));r=this._mid(d,l);const k=this._sub(r,d);m?this._leftPerpendicular(k):this._rightPerpendicular(k);r[0]+=k[0];r[1]+=k[1];this._addBezier3(h,d,this._mix(d,.33333,r,.66667),this._mix(l,.33333,r,.66667),l,4)};e._addArrow=function(h,d,l){var m=d[0],r=d[1],k=d[d.length-1],c=this._sub(m,r);this._normalize(c);const b=this._crossProduct(c,this._sub(k,r));r=.5*b;var a=this._leftPerp(c);const g=[k[0]-a[0]*b,k[1]-a[1]*b];var n=d.length-
1;k=[];k.push(l?[-a[0],-a[1]]:a);var f=[-c[0],-c[1]];for(l=1;l<n-1;l++){c=this._sub(d[l+1],d[l]);this._normalize(c);var q=this._dotProduct(c,f);a=this._crossProduct(c,f);q=Math.sqrt((1+q)/2);f=this._sub(c,f);this._normalize(f);f[0]/=q;f[1]/=q;k.push(0>a?[-f[0],-f[1]]:f);f=c}k.push(this._rightPerp(f));for(n=k.length-1;0<n;n--)h.push([d[n][0]+k[n][0]*r,d[n][1]+k[n][1]*r]);h.push([g[0]+k[0][0]*r,g[1]+k[0][1]*r]);h.push([g[0]+k[0][0]*b,g[1]+k[0][1]*b]);h.push(m);h.push([g[0]-k[0][0]*b,g[1]-k[0][1]*b]);
h.push([g[0]-k[0][0]*r,g[1]-k[0][1]*r]);for(m=1;m<k.length;m++)h.push([d[m][0]-k[m][0]*r,d[m][1]-k[m][1]*r])};e._cp2=function(h,d,l){return 2<=h.length?h[1]:this._add2(h[0],d*this._defaultSize,l*this._defaultSize)};e._cp3=function(h,d,l,m){if(3<=h.length)return h[2];l=this._mix(h[0],1-l,d,l);h=this._sub(d,h[0]);this._normalize(h);this._rightPerpendicular(h);return[l[0]+h[0]*m*this._defaultSize,l[1]+h[1]*m*this._defaultSize]};e._arrowPath=function(h){if(2<h.length)return h;const d=h[0];h=this._cp2(h,
-4,0);const l=this._sub(d,h);this._normalize(l);const m=this._rightPerp(l);return[d,h,[d[0]+(m[0]-l[0])*this._defaultSize,d[1]+(m[1]-l[1])*this._defaultSize]]};e._arrowLastSeg=function(h){var d=h[0];const l=this._cp2(h,-4,0);if(3<=h.length)d=h[h.length-1];else{h=this._sub(d,l);this._normalize(h);const m=this._rightPerp(h);d=[d[0]+(m[0]-h[0])*this._defaultSize,d[1]+(m[1]-h[1])*this._defaultSize]}return[l,d]};e._processGeom=function(h){if(!h)return null;const d=[];for(const l of h){if(!l||0===l.length)continue;
const m=l.length;let r=l[0];switch(this._rule){case B.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const k=this._cp2(l,0,-1),c=this._cp3(l,k,.5,4),b=[];b.push(c);b.push(this._mid(r,k));d.push(b);break;case B.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const a=this._cp2(l,0,-1);d.push([a,r]);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const g=this._cp2(l,-4,1),n=this._cp3(l,g,.882353,-1.94),f=[];f.push(this._mid(g,n));f.push(r);
d.push(f);break;case B.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const q=this._cp2(l,-4,1),p=this._cp3(l,q,.882353,-1.94),z=this._sub(p,q);let w;w=0<this._crossProduct(z,this._sub(r,q))?this._rightPerp(w):this._leftPerp(z);const y=[];y.push([q[0]+(w[0]-z[0])/3,q[1]+(w[1]-z[1])/3]);y.push(q);y.push(p);y.push([p[0]+(w[0]+z[0])/3,p[1]+(w[1]+z[1])/3]);d.push(y);break;case B.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const G=this._cp2(l,0,-1),H=this._cp3(l,G,.5,3),I=this._mid(r,
G),D=this._sub(I,H);this._normalize(D);const C=this._crossProduct(D,this._sub(r,H));this._leftPerpendicular(D);const F=[];F.push(r);F.push([H[0]+D[0]*C,H[1]+D[1]*C]);d.push(F);const K=[];K.push([H[0]-D[0]*C,H[1]-D[1]*C]);K.push(G);d.push(K);break;case B.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const J=this._cp2(l,0,-1),P=this._cp3(l,J,.5,3),S=this._mid(r,J),X=this._sub(S,P);this._normalize(X);const ha=this._crossProduct(X,this._sub(r,P));this._leftPerpendicular(X);const U=[];U.push([P[0]+
X[0]*ha,P[1]+X[1]*ha]);U.push([P[0]-X[0]*ha,P[1]-X[1]*ha]);d.push(U);break;case B.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const Q=this._cp2(l,0,-1),O=this._cp3(l,Q,.5,4),R=this._mid(r,Q),V=this._sub(R,O);this._normalize(V);const Z=this._crossProduct(V,this._sub(r,O));this._leftPerpendicular(V);const ka=[];ka.push([O[0]+V[0]*Z*.8,O[1]+V[1]*Z*.8]);ka.push([R[0]+.8*(r[0]-R[0]),R[1]+.8*(r[1]-R[1])]);d.push(ka);d.push([O,R]);const ia=[];ia.push([O[0]-V[0]*Z*.8,O[1]-V[1]*Z*.8]);ia.push([R[0]+
.8*(Q[0]-R[0]),R[1]+.8*(Q[1]-R[1])]);d.push(ia);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const wa=this._cp2(l,0,-1),ea=this._cp3(l,wa,.5,4),L=this._mid(r,wa);let M=this._sub(wa,r);const ba=Math.cos(Math.PI/18),ca=Math.sin(Math.PI/18),ma=Math.sqrt((1+ba)/2),W=Math.sqrt((1-ba)/2),Y=[];let da;0<this._crossProduct(M,this._sub(ea,r))?(Y.push(r),M=this._sub(r,L),da=wa):(Y.push(wa),M=this._sub(wa,L),da=r);this._rotateDirect(M,ma,W);M[0]/=ma;M[1]/=ma;for(let Qa=1;18>=Qa;Qa++)Y.push(this._add(L,
M)),this._rotateDirect(M,ba,ca);Y.push(da);d.push(Y);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const ja=this._cp2(l,0,-1),pa=this._cp3(l,ja,1,-1);let sa=this._sub(r,ja);this._normalize(sa);const ta=this._crossProduct(sa,this._sub(pa,ja))/2;this._leftPerpendicular(sa);const ya=[ja[0]+sa[0]*ta,ja[1]+sa[1]*ta];sa=this._sub(ja,ya);const za=Math.cos(Math.PI/18);let la=Math.sin(Math.PI/18);0<ta&&(la=-la);const oa=[ja];for(let Qa=1;18>=Qa;Qa++)this._rotateDirect(sa,za,la),
oa.push(this._add(ya,sa));d.push(oa);break;case B.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const va=this._cp2(l,0,-2),Ca=this._cp3(l,va,1,-1);let Fa;if(4<=m)Fa=l[3];else{const Qa=this._sub(r,va);Fa=this._add(Ca,Qa)}const Ja=this._dist(va,Ca)/2/.75,Ka=this._sub(va,r);this._normalize(Ka,Ja);const Ia=this._sub(Ca,Fa);this._normalize(Ia,Ja);d.push([Fa,Ca]);const Ma=[this._clone(Ca)];this._addBezier3(Ma,Ca,this._add(Ca,Ia),this._add(va,Ka),va,4);Ma.push(r);d.push(Ma);break;case B.GeometricEffectControlMeasureLineRule.OpenCircle:const Ba=
this._cp2(l,-2,0),Oa=this._sub(Ba,r),Za=Math.cos(Math.PI/18),$a=-Math.sin(Math.PI/18),N=[Ba];for(let Qa=1;33>=Qa;Qa++)this._rotateDirect(Oa,Za,$a),N.push(this._add(r,Oa));d.push(N);break;case B.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const Wa=this._cp2(l,0,-1);let Ra;if(3<=m)Ra=l[2];else{const Qa=this._sub(Wa,r),aa=this._leftPerp(Qa);Ra=[r[0]+aa[0]-.25*Qa[0],r[1]+aa[1]-.25*Qa[1]]}let bb;if(4<=m)bb=l[3];else{const Qa=this._mid(r,Wa),aa=this._sub(r,Wa);this._normalize(aa);this._leftPerpendicular(aa);
const fa=this._crossProduct(aa,this._sub(Ra,Qa));this._rightPerpendicular(aa);bb=[Ra[0]+aa[0]*fa*2,Ra[1]+aa[1]*fa*2]}const cb=this._sub(Wa,r);let Sa,jb;Sa=0<this._crossProduct(cb,this._sub(Ra,r))?this._rightPerp(cb):this._leftPerp(cb);jb=[];jb.push(Ra);jb.push(r);jb.push([r[0]+(Sa[0]-cb[0])/3,r[1]+(Sa[1]-cb[1])/3]);d.push(jb);Sa=0<this._crossProduct(cb,this._sub(bb,Wa))?this._rightPerp(Sa):this._leftPerp(cb);jb=[];jb.push([Wa[0]+(Sa[0]+cb[0])/3,Wa[1]+(Sa[1]+cb[1])/3]);jb.push(Wa);jb.push(bb);d.push(jb);
break;case B.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const ob=this._cp2(l,0,2),Bb=this._cp3(l,ob,0,1);let xa;if(4<=m)xa=l[3];else{const Qa=this._sub(ob,r);xa=this._add(Bb,Qa)}this._addAngledTicks(d,r,ob,this._mid(Bb,xa));this._addAngledTicks(d,Bb,xa,this._mid(r,ob));break;case B.GeometricEffectControlMeasureLineRule.GapExtentMidline:const ac=this._cp2(l,2,0),Cb=this._cp3(l,ac,0,1);let lb;if(4<=m)lb=l[3];else{const Qa=this._sub(ac,r);lb=this._add(Cb,Qa)}const ub=[];ub.push(this._mid(r,
Cb));ub.push(this._mid(ac,lb));d.push(ub);break;case B.GeometricEffectControlMeasureLineRule.Chevron:const hc=this._cp2(l,-1,-1);let Sb;if(3<=m)Sb=l[2];else{const Qa=this._sub(hc,r);this._leftPerpendicular(Qa);Sb=this._add(r,Qa)}d.push([hc,this._makeCtrlPt(r),Sb]);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const Ob=this._cp2(l,0,-2),qb=this._cp3(l,Ob,.5,-1);let db=this._sub(Ob,r);const Xa=this._norm(db);db[0]/=Xa;db[1]/=Xa;const kb=this._crossProduct(db,this._sub(qb,r));
let pb=this._dotProduct(db,this._sub(qb,r));pb<.05*Xa?pb=.05*Xa:pb>.95*Xa&&(pb=.95*Xa);const Ta=[r[0]+db[0]*pb,r[1]+db[1]*pb];this._leftPerpendicular(db);let zb=[];zb.push([Ta[0]-db[0]*kb,Ta[1]-db[1]*kb]);zb.push([Ta[0]+db[0]*kb,Ta[1]+db[1]*kb]);d.push(zb);const na=[Ob[0]+db[0]*kb,Ob[1]+db[1]*kb];db=this._sub(Ob,na);const ua=Math.cos(Math.PI/18);let qa=Math.sin(Math.PI/18);0>kb&&(qa=-qa);zb=[r,Ob];for(let Qa=1;9>=Qa;Qa++)this._rotateDirect(db,ua,qa),zb.push(this._add(na,db));d.push(zb);break;case B.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Aa=
this._cp2(l,2,0),Ga=this._mid(r,Aa),Ha=this._sub(Aa,Ga),Na=Math.cos(Math.PI/18),Pa=Math.sin(Math.PI/18),eb=[r,Aa];for(let Qa=1;18>=Qa;Qa++)this._rotateDirect(Ha,Na,Pa),eb.push(this._add(Ga,Ha));d.push(eb);break;case B.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const Ya=this._cp2(l,0,-2),ab=this._cp3(l,Ya,1,-2),fb=this._mid(r,Ya),ib=this._sub(ab,Ya);this._normalize(ib);const Jd=Math.abs(this._crossProduct(ib,this._sub(fb,Ya)))/2,cc=this._dist(Ya,ab),Cd=[Ya,r];Cd.push([r[0]+ib[0]*
cc*.5,r[1]+ib[1]*cc*.5]);d.push(Cd);const ec=[];ec.push([fb[0]-ib[0]*Jd,fb[1]-ib[1]*Jd]);ec.push([fb[0]+ib[0]*cc*.375,fb[1]+ib[1]*cc*.375]);E.setId(ec[ec.length-1],1);ec.push([fb[0]+ib[0]*cc*.75,fb[1]+ib[1]*cc*.75]);d.push(ec);d.push([Ya,ab]);break;case B.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const nc=this._cp2(l,3,0),ld=this._cp3(l,nc,.5,-1),oc=this._sub(ld,nc);this._normalize(oc);const de=this._crossProduct(oc,this._sub(ld,r));this._leftPerpendicular(oc);this._addAngledTicks(d,
r,nc,ld);this._addAngledTicks(d,this._mix(r,1,oc,de),this._mix(nc,1,oc,de),this._mid(r,nc));break;case B.GeometricEffectControlMeasureLineRule.Parallel:const sc=this._cp2(l,3,0),Ae=this._cp3(l,sc,.5,-1),pd=this._sub(sc,r);this._normalize(pd);const Qc=this._leftPerp(pd),Rc=this._crossProduct(pd,this._sub(Ae,r));let uc=[r,sc];d.push(uc);uc=[];uc.push([r[0]+Qc[0]*Rc,r[1]+Qc[1]*Rc]);uc.push([sc[0]+Qc[0]*Rc,sc[1]+Qc[1]*Rc]);d.push(uc);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const sd=
this._cp2(l,3,0),Be=this._cp3(l,sd,.5,-1),Tc=this._mid(r,sd),Zb=this._sub(sd,r);this._normalize(Zb);const Mc=this._crossProduct(Zb,this._sub(Be,r));this._leftPerpendicular(Zb);const td=[];td.push([Tc[0]-Zb[0]*Mc*.25,Tc[1]-Zb[1]*Mc*.25]);td.push([Tc[0]+Zb[0]*Mc*1.25,Tc[1]+Zb[1]*Mc*1.25]);d.push(td);break;case B.GeometricEffectControlMeasureLineRule.ParallelOffset:const gc=this._cp2(l,3,0),Ee=this._cp3(l,gc,.5,-1),yb=this._sub(gc,r);this._normalize(yb);const Lb=this._crossProduct(yb,this._sub(Ee,r));
this._leftPerpendicular(yb);const id=[];id.push([r[0]-yb[0]*Lb,r[1]-yb[1]*Lb]);id.push([gc[0]-yb[0]*Lb,gc[1]-yb[1]*Lb]);d.push(id);const jd=[];jd.push([r[0]+yb[0]*Lb,r[1]+yb[1]*Lb]);jd.push([gc[0]+yb[0]*Lb,gc[1]+yb[1]*Lb]);d.push(jd);break;case B.GeometricEffectControlMeasureLineRule.OffsetOpposite:const pc=this._cp2(l,3,0),we=this._cp3(l,pc,.5,-1),Yb=this._sub(pc,r);this._normalize(Yb);const Nc=this._crossProduct(Yb,this._sub(we,r));this._leftPerpendicular(Yb);const ud=[];ud.push([r[0]-Yb[0]*Nc,
r[1]-Yb[1]*Nc]);ud.push([pc[0]-Yb[0]*Nc,pc[1]-Yb[1]*Nc]);d.push(ud);break;case B.GeometricEffectControlMeasureLineRule.OffsetSame:const mc=this._cp2(l,3,0),ge=this._cp3(l,mc,.5,-1),Hb=this._sub(mc,r);this._normalize(Hb);const wc=this._crossProduct(Hb,this._sub(ge,r));this._leftPerpendicular(Hb);const Vc=[];Vc.push([r[0]+Hb[0]*wc,r[1]+Hb[1]*wc]);Vc.push([mc[0]+Hb[0]*wc,mc[1]+Hb[1]*wc]);d.push(Vc);break;case B.GeometricEffectControlMeasureLineRule.CircleWithArc:let Ib=this._cp2(l,3,0);const Wc=this._cp3(l,
Ib,.5,-1);let bc,xc;if(4<=m)bc=l[3],xc=0<this._crossProduct(this._sub(bc,Ib),this._sub(Wc,Ib));else{bc=Ib;xc=0<this._crossProduct(this._sub(bc,r),this._sub(Wc,r));const Qa=24*this._geomUnitsPerPoint,aa=this._sub(bc,r);this._normalize(aa,Qa);const fa=Math.sqrt(2)/2;this._rotateDirect(aa,fa,xc?fa:-fa);Ib=this._add(r,aa)}const yc=this._sub(Ib,r),Xc=Math.cos(Math.PI/18),he=Math.sin(Math.PI/18),ic=[Ib];for(let Qa=1;36>=Qa;Qa++)this._rotateDirect(yc,Xc,he),ic.push(this._add(r,yc));this._add90DegArc(ic,
Ib,bc,Wc,xc);E.setId(ic[ic.length-8],1);d.push(ic);break;case B.GeometricEffectControlMeasureLineRule.DoubleJog:let Mb=this._cp2(l,-3,1),Nb;Nb=3<=m?l[2]:this._add(r,this._sub(r,Mb));let Fb;if(4<=m)Fb=l[3];else{const Qa=r;r=Mb;Fb=Nb;const aa=this._dist(r,Qa),fa=this._dist(Fb,Qa);let ra=30*this._geomUnitsPerPoint;.5*aa<ra&&(ra=.5*aa);.5*fa<ra&&(ra=.5*fa);Mb=this._mix(r,ra/aa,Qa,(aa-ra)/aa);Nb=this._mix(Fb,ra/fa,Qa,(fa-ra)/fa)}const Vd=this._mid(r,Mb),md=this._mid(Fb,Nb),ve=this._dist(r,Mb),Xd=this._dist(Nb,
Fb);let qc=Math.min(ve,Xd)/8;qc=Math.min(qc,24*this._geomUnitsPerPoint);const Pb=Math.cos(Math.PI/4);let sb=this._sub(r,Mb);this._normalize(sb,qc);0<this._crossProduct(sb,this._sub(Fb,Mb))?this._rotateDirect(sb,Pb,-Pb):this._rotateDirect(sb,Pb,Pb);let Ab=[];Ab.push(Mb);Ab.push(this._add(Vd,sb));Ab.push(this._sub(Vd,sb));Ab.push(r);d.push(Ab);sb=this._sub(Fb,Nb);this._normalize(sb,qc);0>this._crossProduct(sb,this._sub(r,Nb))?this._rotateDirect(sb,Pb,Pb):this._rotateDirect(sb,Pb,-Pb);Ab=[];Ab.push(Nb);
Ab.push(this._add(md,sb));Ab.push(this._sub(md,sb));Ab.push(Fb);d.push(Ab);break;case B.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Oc=this._cp2(l,-4,1),Bd=this._cp3(l,Oc,.882353,-1.94),jc=this._sub(Bd,Oc);0<this._crossProduct(jc,this._sub(r,Oc))?this._rightPerpendicular(jc):this._leftPerpendicular(jc);const ie=[jc[0]/8,jc[1]/8],xe=this._sub(this._mid(Oc,Bd),ie);d.push([xe,r]);break;case B.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Yd=this._arrowPath(l),
Zd=[];let wd=Yd.length-2;for(;wd--;)Zd.push(Yd[wd]);d.push(Zd);break;case B.GeometricEffectControlMeasureLineRule.MultivertexArrow:const ye=this._arrowPath(l),$d=[];this._addArrow($d,ye,!1);d.push($d);break;case B.GeometricEffectControlMeasureLineRule.CrossedArrow:const ze=this._arrowPath(l),ae=[];this._addArrow(ae,ze,!0);d.push(ae);break;case B.GeometricEffectControlMeasureLineRule.ChevronArrow:const [be,lc]=this._arrowLastSeg(l),Jc=10*this._geomUnitsPerPoint,Ub=this._sub(r,be);this._normalize(Ub);
const ce=this._crossProduct(Ub,this._sub(lc,be)),Kd=this._leftPerp(Ub),Ed=[lc[0]-Kd[0]*ce*2,lc[1]-Kd[1]*ce*2],Ec=[];Ec.push([lc[0]+Ub[0]*Jc,lc[1]+Ub[1]*Jc]);Ec.push(r);Ec.push([Ed[0]+Ub[0]*Jc,Ed[1]+Ub[1]*Jc]);d.push(Ec);break;case B.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Wd,kd]=this._arrowLastSeg(l),Gb=this._sub(r,Wd);this._normalize(Gb);const fc=this._crossProduct(Gb,this._sub(kd,Wd));this._leftPerpendicular(Gb);const rc=[kd[0]-Gb[0]*fc,kd[1]-Gb[1]*fc],Pc=[];Pc.push([rc[0]+
Gb[0]*fc*.5,rc[1]+Gb[1]*fc*.5]);Pc.push(this._mid(rc,r));Pc.push([rc[0]-Gb[0]*fc*.5,rc[1]-Gb[1]*fc*.5]);d.push(Pc);break;case B.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [od,qd]=this._arrowLastSeg(l),tc=this._sub(r,od);this._normalize(tc);const ee=this._crossProduct(tc,this._sub(qd,od));this._leftPerpendicular(tc);d.push([od,[qd[0]-tc[0]*ee,qd[1]-tc[1]*ee]]);break;case B.GeometricEffectControlMeasureLineRule.Arch:const rd=this._cp2(l,0,-1),Sc=this._cp3(l,rd,.5,1),fe=this._sub(r,
rd),Ce=this._mix(Sc,1,fe,.55),De=this._mix(Sc,1,fe,-.55),nd=[r];this._addBezier2(nd,r,Ce,Sc,4);this._addBezier2(nd,Sc,De,rd,4);d.push(nd);break;case B.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const Qb=this._cp2(l,-4,1),vc=this._cp3(l,Qb,.882353,-1.94),$b=this._sub(vc,Qb);0<this._crossProduct($b,this._sub(r,Qb))?this._rightPerpendicular($b):this._leftPerpendicular($b);const vd=[$b[0]/8,$b[1]/8],ed=this._sub(this._mid(Qb,vc),vd),Od=this._sub(this._mix(Qb,.75,vc,.25),vd),T=this._sub(this._mix(Qb,
.25,vc,.75),vd),Rb=[Qb];this._addBezier2(Rb,Qb,Od,ed,3);this._addBezier2(Rb,ed,T,vc,3);d.push(Rb);for(let Qa=0;8>Qa;Qa++){const aa=Rb[2*Qa+1],fa=[this._clone(aa)];fa.push(this._add(aa,[$b[0]/4,$b[1]/4]));d.push(fa)}break;case B.GeometricEffectControlMeasureLineRule.Arc90Degrees:const tb=this._cp2(l,0,-1),Uc=this._cp3(l,tb,.5,1),Da=[tb];this._add90DegArc(Da,tb,r,Uc);d.push(Da);break;default:d.push(l)}}return d};return x}();v.EffectControlMeasureLine=u;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();u.instance=null;let A=function(x){function e(h,d,l){h=x.call(this,h,!0,!0)||this;h._curveHelper=new B.CurveHelper;h._beginCut=
(void 0!==d.beginCut?d.beginCut:1)*l;h._endCut=(void 0!==d.endCut?d.endCut:1)*l;h._middleCut=(void 0!==d.middleCut?d.middleCut:0)*l;h._invert=void 0!==d.invert?d.invert:!1;0>h._beginCut&&(h._beginCut=0);0>h._endCut&&(h._endCut=0);0>h._middleCut&&(h._middleCut=0);return h}t._inheritsLoose(e,x);e.prototype.processPath=function(h){var d=this._beginCut;const l=this._endCut,m=this._middleCut,r=this._curveHelper.calculatePathLength(h),k=[];if(!this._invert)0===d&&0===l&&0===m?k.push(h):d+l+m>=r||(0===m?
(h=this._curveHelper.getSubCurve(h,d,r-l))&&k.push(h):((d=this._curveHelper.getSubCurve(h,d,.5*(r-m)))&&k.push(d),(d=this._curveHelper.getSubCurve(h,.5*(r+m),r-l))&&k.push(d)));else if(0!==d||0!==l||0!==m)d+l+m>=r?k.push(h):((d=this._curveHelper.getSubCurve(h,0,d))&&k.push(d),(d=this._curveHelper.getSubCurve(h,.5*(r-m),.5*(r+m)))&&k.push(d),(d=this._curveHelper.getSubCurve(h,r-l,l))&&k.push(d));return 0===k.length?null:{paths:k}};return e}(E.PathGeometryCursor);v.EffectCut=u;Object.defineProperties(v,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),function(v,t,E,B,u,A){let x=function(){function h(){}h.local=function(){null===h.instance&&(h.instance=new h);return h.instance};h.prototype.execute=function(d,l,m,r){return new e(d,l,m)};return h}();x.instance=null;let e=function(h){function d(l,m,r){l=h.call(this,
l,!0,!0)||this;l._firstCurve=null;l._walker=new A.GeometryWalker;l._walker.updateTolerance(r);l._endings=m.lineDashEnding;l._customDashPos=-(m.offsetAlongLine??0)*r;l._offsetAtEnd=(m.customEndingOffset??0)*r;l._pattern=new A.DashPattern;l._pattern.init(m.dashTemplate,!0);l._pattern.scale(r);return l}t._inheritsLoose(d,h);d.prototype.processPath=function(l){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[l]};if(!this.iteratePath){var m=!0;switch(this._endings){default:this._pattern.extPtGap=
0;break;case u.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case u.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case u.LineDashEnding.NoConstraint:this.isClosed||(m=!1);break;case u.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var r=this._walker.calculatePathLength(l);if(this._pattern.isEmpty()||r<.1*this._pattern.length()||!this._walker.init(l,this._pattern,
m))return{paths:[l]}}if(this.iteratePath)l=this._pattern.nextValue();else{switch(this._endings){default:m=.5*this._pattern.firstValue();break;case u.LineDashEnding.HalfGap:m=.5*-this._pattern.lastValue();break;case u.LineDashEnding.FullGap:m=-this._pattern.lastValue();break;case u.LineDashEnding.FullPattern:m=0;break;case u.LineDashEnding.NoConstraint:case u.LineDashEnding.Custom:m=-this._customDashPos}l=m/this._pattern.length();l-=Math.floor(l);m=l*this._pattern.length();this._pattern.reset();l=
this._pattern.nextValue();for(r=!1;m>=l;)m-=l,l=this._pattern.nextValue(),r=!r;l-=m;r?(this._walker.nextPosition(l),l=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(l),l=this._pattern.nextValue(),this._walker.nextPosition(l),l=this._pattern.nextValue())}(m=this._walker.nextCurve(l))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),B.PathHelper.mergePath(m,this._firstCurve),this._firstCurve=null)):(l=this._pattern.nextValue(),
!this._walker.nextPosition(l)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(m=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,m=this._firstCurve,this._firstCurve=null);return{paths:[m]}};return d}(E.PathGeometryCursor);v.EffectDashes=x;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor",
"./CurveHelper"],function(v,t,E,B){let u=function(){function e(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var h=e.prototype;h.isEmpty=function(){return 0===this._values.length};h.size=function(){return this._values.length};h.init=function(d,l,m=!0){this._setEmpty();if(!d||0===d.length)return!1;for(let r=0;r<d.length;r++){let k=Math.abs(d[r]);m&&1E-7>k&&(k=1E-7);this._values.push(k);this._length+=k}l&&d.length&1&&(this._length*=2);if(0===this._length)return!1;
this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};h.scale=function(d){const l=this._values?this._values.length:0;for(let m=0;m<l;++m)this._values[m]*=d;this._length*=d;this.extPtGap*=d;this.ctrlPtGap*=d};h.addValue=function(d){this._length+=d;this._values.push(d)};h.firstValue=function(){return this._values[0]};h.lastValue=function(){return this._values[this._values.length-1]};h.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);
return this._values[this._currentValue]};h.reset=function(){this._currentValue=-1};h.length=function(){return this._length};h._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return e}();v.EndType=void 0;(function(e){e[e.FAIL=0]="FAIL";e[e.END=1]="END";e[e.CONTINUE=2]="CONTINUE"})(v.EndType||(v.EndType={}));let A=function(){function e(){this.reset()}var h=e.prototype;h.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;
this.isPartEnd=this.isPathEnd=!1};h.isValid=function(){return-1!==this.segment};h.copyTo=function(d){d.segment=this.segment;d.segmentLength=this.segmentLength;d.abscissa=this.abscissa;d.isPathEnd=this.isPathEnd;d.isPartEnd=this.isPartEnd};return e}(),x=function(e){function h(l=0,m=!1){l=e.call(this,l,m)||this;l._tolerance=B.PIXEL_TOLERANCE;l._currentPosition=new A;return l}t._inheritsLoose(h,e);var d=h.prototype;d.updateTolerance=function(l){this._tolerance=B.PIXEL_TOLERANCE*l};d.init=function(l,
m,r=!0){r?(this._patternLength=m.length(),this._partExtPtGap=m.extPtGap,this._partCtrlPtGap=m.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=l;this._seg=-1;return this._setPosAtNextPart()};d.curPositionIsValid=function(){return this._currentPosition.isValid()};d.nextPosition=function(l,m=v.EndType.FAIL){const r=new A;if(!this._nextPosition(l,r,null,m))return!1;r.copyTo(this._currentPosition);return!0};d.curPointAndAngle=
function(l){l.pt=this._getPoint(this._currentPosition);const [m,r]=this._getAngle(this._currentPosition);l.ca=m;l.sa=r};d.nextPointAndAngle=function(l,m,r=v.EndType.FAIL){const k=new A;if(!this._nextPosition(l,k,null,r))return!1;k.copyTo(this._currentPosition);m.pt=this._getPoint(k);const [c,b]=this._getAngle(k);m.ca=c;m.sa=b;return!0};d.nextCurve=function(l){if(0===l)return null;const m=[],r=new A;if(!this._nextPosition(l,r,m,v.EndType.END))return null;r.copyTo(this._currentPosition);return m};d.isPathEnd=
function(){return this._currentPosition.isPathEnd};d.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};d._nextPosition=function(l,m,r,k){if(this._currentPosition.isPathEnd)return!1;var c=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(c/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(m);m.abscissa+l*this._partLengthRatio>m.segmentLength+this._tolerance;)if(r&&
(0===r.length&&(0===c?(c=this._path[m.segment],r.push([c[0],c[1]])):r.push(this.getSegCoord2D(this._path,m.segment,c))),c=this._path[m.segment+1],r.push([c[0],c[1]])),c=0,l-=(m.segmentLength-m.abscissa)/this._partLengthRatio,this._partSegCount)m.segment=this._nextSegment(),m.segmentLength=this.calculateSegLength(this._path,m.segment),m.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(k===v.EndType.FAIL)return!1;m.segmentLength=this.calculateSegLength(this._path,m.segment);m.isPartEnd=
!0;k===v.EndType.END?(m.abscissa=m.segmentLength,m.isPathEnd=!0):m.abscissa=m.segmentLength+l;return!0}this._currentPosition.copyTo(m)}m.abscissa+=l*this._partLengthRatio;r&&(0===r.length&&(0===c?(l=this._path[m.segment],r.push([l[0],l[1]])):r.push(this.getSegCoord2D(this._path,m.segment,c))),l=m.abscissa/m.segmentLength,1===l?(l=this._path[m.segment+1],r.push([l[0],l[1]])):r.push(this.getSegCoord2D(this._path,m.segment,l)));!this._partSegCount&&Math.abs(m.abscissa-m.segmentLength)<this._tolerance&&
(m.isPathEnd=this._partIsLast,m.isPartEnd=!0);return!0};d._getPoint=function(l){if(-1===l.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,l.segment,0>=l.segmentLength?0:l.abscissa/l.segmentLength)};d._getAngle=function(l){if(-1===l.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,l.segment,0>=l.segmentLength?0:l.abscissa/l.segmentLength)};d._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;
if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===E.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var l=this._partSegCount;l;)this._previousSegment(),--l;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,
this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;l=this._getStartPointIndex();this._ctrlPtBegin=1===E.getId(this._path[l]);l=l+this._partSegCount+1;l>=this._path.length&&(l=0);this._ctrlPtEnd=1===E.getId(this._path[l]);if(0<this._patternLength){l=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const m=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let r=Math.round((this._partLength-
(l+m))/this._patternLength);0>=r&&(r=0<l+m?0:1);this._partLengthRatio=this._partLength/(l+m+r*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};d._hasNextSegment=function(){return this._seg<this._path.length-2};d._previousSegment=function(){return--this._seg};d._nextSegment=function(){return++this._seg};d._getStartPointIndex=function(){return this._seg};d._getEndPointIndex=function(){return this._seg+1};return h}(B.CurveHelper);v.DashPattern=
u;v.GeometryWalker=x;v.Pos=function(){this.pt=null;this.sa=this.ca=0};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();u.instance=
null;let A=function(){function x(e,h,d){this._inputGeometries=e;this._curveHelper=new E.CurveHelper;this._width=(void 0!==h.width?h.width:2)*d;switch(h.method){default:this._method=B.GeometricEffectOffsetMethod.Mitered;break;case B.GeometricEffectDonutMethod.Bevelled:this._method=B.GeometricEffectOffsetMethod.Bevelled;break;case B.GeometricEffectDonutMethod.Rounded:case B.GeometricEffectDonutMethod.TrueBuffer:this._method=B.GeometricEffectOffsetMethod.Rounded;break;case B.GeometricEffectDonutMethod.Square:this._method=
B.GeometricEffectOffsetMethod.Square}this._option=h.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*d}x.prototype.next=function(){for(var e=this._inputGeometries.next();e;){if(t.isExtent(e)&&0<this._width){if(0>Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width)return e;var h=[];h.push([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]);h.push([[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],
[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]]);return{rings:h}}if(t.isPolygon(e)&&0<this._width){h=[];for(const d of e.rings){e=this._curveHelper.calculatePathLength(d);const l=this._curveHelper.offset(d,this._width,this._method,4,this._offsetFlattenError);l&&(0>e&&l.reverse(),h.push(l))}if(h.length)return{rings:h}}e=this._inputGeometries.next()}return null};return x}();v.EffectDonut=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();u.instance=null;let A=function(x){function e(h,d,l){h=x.call(this,h,!1,!0)||this;h._curveHelper=new B.CurveHelper;h._length=(void 0!==d.length?d.length:20)*l;h._angle=
void 0!==d.angle?d.angle:225;h._position=void 0!==d.position?d.position:50;0>h._length&&(h._length=-h._length);20>h._position&&(h._position=20);80<h._position&&(h._position=80);h._mirror=!1;return h}t._inheritsLoose(e,x);e.prototype.processPath=function(h){if(this._curveHelper.isEmpty(h,!1))return null;const d=h[0];h=h[h.length-1];this._curveHelper.normalize([h[0]-d[0],h[1]-d[1]]);const l=[d[0]+(h[0]-d[0])*this._position/100,d[1]+(h[1]-d[1])*this._position/100],m=Math.cos((90-this._angle)/180*Math.PI);
let r=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(r=-r);this._mirror=!this._mirror;return{paths:[[d,[l[0]-this._length/2*m,l[1]-this._length/2*r],[l[0]+this._length/2*m,l[1]+this._length/2*r],h]]}};return e}(E.PathGeometryCursor);v.EffectJog=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(v,t,E){let B=function(){function A(){}
A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=function(x,e,h,d){return new u(x,e,h)};return A}();B.instance=null;let u=function(){function A(e,h,d){this._inputGeometries=e;this._offsetX=void 0!==h.offsetX?h.offsetX*d:0;this._offsetY=void 0!==h.offsetY?-h.offsetY*d:0}var x=A.prototype;x.next=function(){for(var e=this._inputGeometries.next();e;){if(E.isExtent(e))return{xmin:e.xmin+this._offsetX,xmax:e.xmax+this._offsetX,ymin:e.ymin+this._offsetY,ymax:e.ymax+
this._offsetY};if(E.isPolygon(e))return e=t.clone(e),this._moveMultipath(e.rings,this._offsetX,this._offsetY),e;if(E.isPolyline(e))return e=t.clone(e),this._moveMultipath(e.paths,this._offsetX,this._offsetY),e;if(E.isMultipoint(e))return e=t.clone(e),this._movePath(e.points,this._offsetX,this._offsetY),e;if(E.isPoint(e))return{x:e.x+this._offsetX,y:e.y+this._offsetY};e=this._inputGeometries.next()}return null};x._moveMultipath=function(e,h,d){if(e)for(const l of e)this._movePath(l,h,d)};x._movePath=
function(e,h,d){if(e)for(const l of e)l[0]+=h,l[1]+=d};return A}();v.EffectMove=B;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();
u.instance=null;let A=function(){function x(e,h,d){this._inputGeometries=e;this._curveHelper=new E.CurveHelper;this._offset=(h.offset??1)*d;this._method=h.method;this._option=h.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*d}x.prototype.next=function(){for(var e=this._inputGeometries.next();e;){if(0===this._offset)return e;if(t.isExtent(e)){if(this._method===B.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var h=this._curveHelper.offset([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,
e.ymin],[e.xmin,e.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return h?{rings:[h]}:null}if(0<Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._offset)return{xmin:e.xmin-this._offset,xmax:e.xmax+this._offset,ymin:e.ymin-this._offset,ymax:e.ymax+this._offset}}if(t.isPolygon(e)){var d=[];for(h of e.rings){const l=this._curveHelper.offset(h,-this._offset,this._method,4,this._offsetFlattenError);l&&d.push(l)}if(d.length)return{rings:d}}if(t.isPolyline(e)){d=[];for(const l of e.paths)(e=this._curveHelper.offset(l,
-this._offset,this._method,4,this._offsetFlattenError))&&d.push(e);if(d.length)return{paths:d}}e=this._inputGeometries.next()}return null};return x}();v.EffectOffset=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=
new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,h,d)};return x}();u.instance=null;let A=function(){function x(e,h,d){this._inputGeometries=e;this._reverse=void 0!==h.reverse?h.reverse:!0}x.prototype.next=function(){for(var e=this._inputGeometries.next();e;){if(!this._reverse)return e;if(E.isPolyline(e))return e=t.clone(e),B.reverseMultipath(e.paths),e;e=this._inputGeometries.next()}return null};return x}();v.EffectReverse=u;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=function(){function e(d,l,
m){this._inputGeometries=d;this._rotateAngle=void 0!==l.angle?l.angle*Math.PI/180:0}var h=e.prototype;h.next=function(){for(var d=this._inputGeometries.next();d;){if(0===this._rotateAngle)return d;var l=E.create();B.getBoundsXY(l,d);const m=(l[2]+l[0])/2;l=(l[3]+l[1])/2;if(u.isExtent(d))return d={rings:[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]]},this._rotateMultipath(d.rings,m,l),d;if(u.isPolygon(d))return d=t.clone(d),this._rotateMultipath(d.rings,m,l),d;
if(u.isPolyline(d))return d=t.clone(d),this._rotateMultipath(d.paths,m,l),d;if(u.isMultipoint(d))return d=t.clone(d),this._rotatePath(d.points,m,l),d;if(u.isPoint(d))return d;d=this._inputGeometries.next()}return null};h._rotateMultipath=function(d,l,m){if(d)for(const r of d)this._rotatePath(r,l,m)};h._rotatePath=function(d,l,m){if(d){const r=Math.cos(this._rotateAngle),k=Math.sin(this._rotateAngle);for(const c of d){d=c[0]-l;const b=c[1]-m;c[0]=l+d*r-b*k;c[1]=m+d*k+b*r}}};return e}();v.EffectRotate=
A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();
A.instance=null;let x=function(){function e(d,l,m){this._inputGeometries=d;this._xFactor=void 0!==l.xScaleFactor?l.xScaleFactor:1.15;this._yFactor=void 0!==l.yScaleFactor?l.yScaleFactor:1.15}var h=e.prototype;h.next=function(){for(var d=this._inputGeometries.next();d;){if(1===this._xFactor&&1===this._yFactor)return d;var l=E.create();B.getBoundsXY(l,d);const m=(l[2]+l[0])/2;l=(l[3]+l[1])/2;if(u.isExtent(d))return d={rings:[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]]},
this._scaleMultipath(d.rings,m,l),d;if(u.isPolygon(d))return d=t.clone(d),this._scaleMultipath(d.rings,m,l),d;if(u.isPolyline(d))return d=t.clone(d),this._scaleMultipath(d.paths,m,l),d;if(u.isMultipoint(d))return d=t.clone(d),this._scalePath(d.points,m,l),d;if(u.isPoint(d))return d;d=this._inputGeometries.next()}return null};h._scaleMultipath=function(d,l,m){if(d)for(const r of d)this._scalePath(r,l,m)};h._scalePath=function(d,l,m){if(d)for(const r of d)d=(r[1]-m)*this._yFactor,r[0]=l+(r[0]-l)*this._xFactor,
r[1]=m+d};return e}();v.EffectScale=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=
function(){function e(d,l,m){this._inputGeometries=d;this._height=(void 0!==l.amplitude?l.amplitude:2)*m;this._period=(void 0!==l.period?l.period:3)*m;this._style=l.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new u.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new u.GeometryWalker;this._walker.updateTolerance(m)}var h=e.prototype;h.next=function(){for(var d=
this._inputGeometries.next();d;){if(0===this._height||0===this._period)return d;if(t.isPolyline(d)){const l=this._processGeom(d.paths);if(l.length)return{paths:l}}if(t.isPolygon(d)&&(d=this._processGeom(d.rings),d.length))return{rings:d};d=this._inputGeometries.next()}return null};h._processGeom=function(d){const l=[];for(const m of d)if(this._walker.init(m,this._pattern))switch(this._style){default:l.push(this._constructCurve(m,!1));break;case B.GeometricEffectWaveform.Square:l.push(this._constructSquare(m));
break;case B.GeometricEffectWaveform.Triangle:l.push(this._constructTriangle(m));break;case B.GeometricEffectWaveform.Random:l.push(this._constructCurve(m,!0))}else l.push(m);return l};h._constructCurve=function(d,l){const m=new E.PathHelper;var r=this._walker.calculatePathLength(d),k=Math.round(r/this._period);0===k&&(k=1);const c=this._period/16,b=1/(16*k+1);r=2*Math.PI*r/(r/k);k=2*Math.PI*Math.random();const a=2*Math.PI*Math.random(),g=2*Math.PI*Math.random(),n=.75-Math.random()/2,f=.75-Math.random()/
2,q=new u.Pos;this._walker.curPointAndAngle(q);m.startPath(q.pt);let p=0;for(;;)if(this._walker.nextPointAndAngle(c,q)){const z=p;p+=b;let w;if(l){const y=this._height/2*(1+.3*Math.sin(n*r*z+k));w=y*Math.sin(r*z+a);w+=y*Math.sin(f*r*z+g);w/=2}else w=.5*this._height*Math.sin(.5*r*z);m.lineTo([q.pt[0]-w*q.sa,q.pt[1]+w*q.ca])}else{m.lineTo(d[d.length-1]);break}return m.path()};h._constructSquare=function(d){const l=new E.PathHelper;d=this._walker.calculatePathLength(d);Math.round(d/this._period);for(d=
!0;;){let m=!1;if(this._walker.curPositionIsValid()){const r=new u.Pos;this._walker.curPointAndAngle(r);const k=new u.Pos;if(this._walker.nextPointAndAngle(this._period,k)){const c=new u.Pos;this._walker.nextPointAndAngle(this._period,c)&&(d?(l.startPath(r.pt),d=!1):l.lineTo(r.pt),l.lineTo([r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca]),l.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),l.lineTo([k.pt[0]+this._height/2*k.sa,k.pt[1]-this._height/2*k.ca]),l.lineTo([c.pt[0]+
this._height/2*c.sa,c.pt[1]-this._height/2*c.ca]),m=!0)}}if(!m){l.lineTo(this._walker.getPathEnd());break}}return l.path()};h._constructTriangle=function(d){const l=new E.PathHelper;d=this._walker.calculatePathLength(d);Math.round(d/this._period);for(d=!0;;){let m=!1;if(this._walker.curPositionIsValid()){const r=new u.Pos;this._walker.curPointAndAngle(r);const k=new u.Pos;if(this._walker.nextPointAndAngle(this._period/2,k)){const c=new u.Pos;this._walker.nextPointAndAngle(this._period,c)&&(this._walker.nextPosition(this._period/
2)&&(d?(l.startPath(r.pt),d=!1):l.lineTo(r.pt),l.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),l.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca])),m=!0)}}if(!m){l.lineTo(this._walker.getPathEnd());break}}return l.path()};return e}();v.EffectWave=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../enums","../GeometryWalker"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=function(e){function h(l,m,r){l=e.call(this,l,!0,!0)||this;l._geometryWalker=new u.GeometryWalker;l._geometryWalker.updateTolerance(r);l._angleToLine=m.angleToLine??!0;l._offset=(m.offset?m.offset:0)*r;l._originalEndings=m.endings;l._offsetAtEnd=
(m.customEndingOffset?m.customEndingOffset:0)*r;l._position=-(m.offsetAlongLine?m.offsetAlongLine:0)*r;l._pattern=new u.DashPattern;l._pattern.init(m.placementTemplate,!1);l._pattern.scale(r);l._endings=l._originalEndings;return l}t._inheritsLoose(h,e);var d=h.prototype;d.processPath=function(l){if(this._pattern.isEmpty())return null;if(this.iteratePath)var m=this._pattern.nextValue();else{this._endings=this._originalEndings===B.PlacementEndings.WithFullGap&&this.isClosed?B.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let r=!0;switch(this._endings){case B.PlacementEndings.NoConstraint:m=-this._position;m=this._adjustPosition(m);r=!1;break;default:m=-this._pattern.lastValue()/2;break;case B.PlacementEndings.WithFullGap:m=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case B.PlacementEndings.WithMarkers:m=0;break;case B.PlacementEndings.Custom:m=-this._position,m=this._adjustPosition(m),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(l,
this._pattern,r))return null;this._pattern.reset();for(l=0;m>l;)m-=l,l=this._pattern.nextValue();m=l-m;this.iteratePath=!0}l=new u.Pos;if(!this._geometryWalker.nextPointAndAngle(m,l)||this._endings===B.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===B.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(l.pt[0]-this._offset*l.sa,l.pt[1]+this._offset*
l.ca);this._angleToLine&&this.internalPlacement.setRotateCS(l.ca,l.sa);return this.internalPlacement};d._adjustPosition=function(l){l/=this._pattern.length();l-=Math.floor(l);return l*this._pattern.length()};return h}(E.PathTransformationCursor);v.PlacementAlongLineSameSize=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=function(e){function h(l,m,r){l=e.call(this,l,!1,!0)||this;l._curveHelper=new B.CurveHelper;l._angleToLine=void 0!==m.angleToLine?m.angleToLine:!0;l._offset=void 0!==m.offset?m.offset*r:0;l._type=m.extremityPlacement;l._position=void 0!==m.offsetAlongLine?
m.offsetAlongLine*r:0;l._beginProcessed=!1;return l}t._inheritsLoose(h,e);var d=h.prototype;d.processPath=function(l){let m;switch(this._type){default:this._beginProcessed?(m=this._atExtremities(l,this._position,!1),this.iteratePath=this._beginProcessed=!1):(m=this._atExtremities(l,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case u.ExtremityPlacement.JustBegin:m=this._atExtremities(l,this._position,!0);break;case u.ExtremityPlacement.JustEnd:m=this._atExtremities(l,this._position,
!1);case u.ExtremityPlacement.None:}return m};d._atExtremities=function(l,m,r){var k=l.length;if(2>k)return null;var c=r?1:k-2;const b=r?k:-1,a=r?1:-1;let g=0;r=r?l[0]:l[k-1];for(k=c;k!==b;k+=a){c=r;r=l[k];const n=this._curveHelper.calculateLength(c,r);if(g+n>m){l=(m-g)/n;const [f,q]=this._curveHelper.getAngleCS(c,r,l);l=E.getCoord2D(c,r,l);this.internalPlacement.setTranslate(l[0]-this._offset*q,l[1]+this._offset*f);this._angleToLine&&this.internalPlacement.setRotateCS(-f,-q);return this.internalPlacement}g+=
n}return null};return h}(E.PathTransformationCursor);v.PlacementAtExtremities=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(e,h,d,l){return new A(e,
h,d)};return x}();u.instance=null;let A=function(x){function e(h,d,l){h=x.call(this,h,!0,!0)||this;h._walker=new B.GeometryWalker;h._walker.updateTolerance(l);h._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;h._offset=void 0!==d.offset?d.offset*l:0;h._beginGap=void 0!==d.beginPosition?d.beginPosition*l:0;h._endGap=void 0!==d.endPosition?d.endPosition*l:0;h._flipFirst=void 0!==d.flipFirst?d.flipFirst:!0;h._pattern=new B.DashPattern;h._pattern.init(d.positionArray,!1,!1);h._subPathLen=0;h._posCount=
h._pattern.size();h._isFirst=!0;h._prevPos=0;return h}t._inheritsLoose(e,x);e.prototype.processPath=function(h){if(this._pattern.isEmpty())return null;if(this.iteratePath){h=this._pattern.nextValue()*this._subPathLen;var d=this._beginGap+h;h=d-this._prevPos;this._prevPos=d}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(h)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(h,
this._pattern,!1))return null;this._pattern.reset();h=this._pattern.nextValue()*this._subPathLen;d=this._beginGap+h;h=d-this._prevPos;this._prevPos=d;this.iteratePath=!0}d=new B.Pos;if(!this._walker.nextPointAndAngle(h,d,B.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(d.pt[0]-this._offset*d.sa,d.pt[1]+this._offset*d.ca);h=this._isFirst&&this._flipFirst;let l;this._angleToLine?(l=d.ca,d=d.sa):(l=1,d=0);h&&(l=-l,d=-d);this.internalPlacement.setRotateCS(l,d);this._isFirst=
!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return e}(E.PathTransformationCursor);v.PlacementAtRatioPositions=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/RandomLCG","../CIMPlacements","../enums"],function(v,t,E,B){let u=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};
x.prototype.execute=function(e,h,d,l){return new A(e,h,d,l)};return x}();u.instance=null;let A=function(){function x(h,d,l,m){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=Math.abs(d.stepX??16)*l;this._stepY=Math.abs(d.stepY??16)*l;if(0!==this._stepX&&0!==this._stepY&&h&&void 0!==h.rings&&h.rings){this._gridType=d.gridType??B.PlacementGridType.Fixed;if(this._gridType===B.PlacementGridType.Random)this._randomLCG=new t(1*(d.seed??13)),this._randomness=(d.randomness??
100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=d.gridAngle??0;this._shiftOddRows=d.shiftOddRows??!1;this._offsetX=(d.offsetX??0)*l;this._offsetY=(d.offsetY??0)*l;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=
this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new E.Placement;this._calculateMinMax(h);this._geometry=h}}var e=x.prototype;e.next=function(){return this._geometry?this._nextInside():null};e._calculateMinMax=function(h){this._yMax=this._yMin=this._xMax=this._xMin=0;let d,l,m,r,k;l=m=Number.MAX_VALUE;r=
k=-Number.MAX_VALUE;for(const b of h.rings){const a=b?b.length:0;for(let g=0;g<a;++g){var c=b[g][0]-this._graphicOriginX-this._offsetX;d=b[g][1]-this._graphicOriginY-this._offsetY;h=this._cosAngle*c-this._sinAngle*d;c=this._sinAngle*c+this._cosAngle*d;l=Math.min(l,h);r=Math.max(r,h);m=Math.min(m,c);k=Math.max(k,c)}}l+=this._graphicOriginX;r+=this._graphicOriginX;m+=this._graphicOriginY;k+=this._graphicOriginY;this._xMin=Math.round(l/this._stepX);this._xMax=Math.round(r/this._stepX);this._yMin=Math.round(m/
this._stepY);this._yMax=Math.round(k/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};e._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var h=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(h+=.5*this._stepX);const d=this._currentY*this._stepY+this._offsetY;this._currentX++;let l;this._gridType===
B.PlacementGridType.Random?(l=this._graphicOriginX+h+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,h=this._graphicOriginY+d+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(l=this._graphicOriginX+this._cosAngle*h+this._sinAngle*d,h=this._graphicOriginY-this._sinAngle*h+this._cosAngle*d);this._internalPlacement.setTranslate(l,h);return this._internalPlacement}};return x}();v.PlacementInsidePolygon=u;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(v,t,E,B,u){let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=function(e){function h(l,m,r){l=e.call(this,l,!0,!0)||this;l._curveHelper=new B.CurveHelper;l._angleToLine=void 0!==m.angleToLine?
m.angleToLine:!0;l._offset=void 0!==m.offset?m.offset*r:0;l._relativeTo=m.relativeTo;l._position=void 0!==m.startPointOffset?m.startPointOffset*r:0;l._epsilon=.001*r;return l}t._inheritsLoose(h,e);var d=h.prototype;d.processPath=function(l){var m=this._position;if(this._relativeTo===u.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=l.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var r=this._curSegment;this._curSegment++;
m=l[r-1];r=l[r];const k=this._curveHelper.calculateLength(m,r);if(k<this._epsilon)continue;l=.5+this._position/k;const [c,b]=this._curveHelper.getAngleCS(m,r,l);l=E.getCoord2D(m,r,l);this.internalPlacement.setTranslate(l[0]-this._offset*b,l[1]+this._offset*c);this._angleToLine&&this.internalPlacement.setRotateCS(c,b);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===u.PlacementOnLineRelativeTo.LineEnd&&E.reversePath(l);m=this.onLine(l,m);this._relativeTo===u.PlacementOnLineRelativeTo.LineEnd&&
E.reversePath(l);return m};d.onLine=function(l,m){let r,k=!1;switch(this._relativeTo){default:r=this._curveHelper.calculatePathLength(l)/2+m;break;case u.PlacementOnLineRelativeTo.LineBeginning:r=m;break;case u.PlacementOnLineRelativeTo.LineEnd:r=m,k=!0}const c=l.length;let b=0,a=l[0];for(let g=1;g<c;++g){m=a;a=l[g];const n=this._curveHelper.calculateLength(m,a);if(b+n>r){l=(r-b)/n;const [f,q]=this._curveHelper.getAngleCS(m,a,l);l=E.getCoord2D(m,a,l);m=k?-this._offset:this._offset;this.internalPlacement.setTranslate(l[0]-
m*q,l[1]+m*f);this._angleToLine&&(k?this.internalPlacement.setRotateCS(-f,-q):this.internalPlacement.setRotateCS(f,q));return this.internalPlacement}b+=n}return null};return h}(E.PathTransformationCursor);v.PlacementOnLine=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(v,t,E,B){function u(e,
h){const d=Math.PI;for(;Math.abs(h-e)>d+2E-15;)h=h-e>d?h-2*d:h+2*d;return(e+h)/2}let A=function(){function e(){}e.local=function(){null===e.instance&&(e.instance=new e);return e.instance};e.prototype.execute=function(h,d,l,m){return new x(h,d,l)};return e}();A.instance=null;let x=function(e){function h(l,m,r){l=e.call(this,l,!0,!0)||this;l._curveHelper=new B.CurveHelper;l._angleToLine=void 0!==m.angleToLine?m.angleToLine:!0;l._offset=void 0!==m.offset?m.offset*r:0;l._endPoints=void 0!==m.placeOnEndPoints?
m.placeOnEndPoints:!0;l._controlPoints=void 0!==m.placeOnControlPoints?m.placeOnControlPoints:!0;l._regularVertices=void 0!==m.placeOnRegularVertices?m.placeOnRegularVertices:!0;l._tags=[];l._tagIterator=0;return l}t._inheritsLoose(h,e);var d=h.prototype;d.processPath=function(l){this.iteratePath||(this._preparePath(l),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;l=this._tags[this._tagIterator];this._angleToLine&&
this.internalPlacement.setRotate(l[2]);let m=l[0],r=l[1];if(0!==this._offset){const k=Math.cos(l[2]);m-=this._offset*Math.sin(l[2]);r+=this._offset*k}this.internalPlacement.setTranslate(m,r);this._tagIterator++;return this.internalPlacement};d._preparePath=function(l){this._tagIterator=this._tags.length=0;const m=E.isClosedPath(l),r=l.length-1;let k=0,c=0,b=0,a=0,g=0,n,f;for(;k<r;){k++;n=l[k-1];f=l[k];const q=E.getId(n),p=E.getId(f);if(this._angleToLine||0!==this._offset)a=this._curveHelper.getAngle(n,
f,0);1===k?m?(c=a,b=q):(this._endPoints||this._controlPoints&&1===q)&&this._tags.push([n[0],n[1],a]):1===q?this._controlPoints&&this._tags.push([n[0],n[1],u(g,a)]):this._regularVertices&&this._tags.push([n[0],n[1],u(g,a)]);if(this._angleToLine||0!==this._offset)g=this._curveHelper.getAngle(n,f,1);k===r&&(m?1===p||1===b?this._controlPoints&&this._tags.push([f[0],f[1],u(g,c)]):this._regularVertices&&this._tags.push([f[0],f[1],u(g,c)]):(this._endPoints||this._controlPoints&&1===p)&&this._tags.push([f[0],
f[1],g]))}this._tagIterator=0};return h}(E.PathTransformationCursor);v.PlacementOnVertices=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../core/has ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(v,t,E,B,u,A,x,e){let h=
function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(m,r,k,c){return new d(m,r,k)};return l}();h.instance=null;let d=function(){function l(r,k,c){this._geometry=r;this._offsetX=void 0!==k.offsetX?k.offsetX*c:0;this._offsetY=void 0!==k.offsetY?k.offsetY*c:0;this._method=void 0!==k.method?k.method:e.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new x.Placement}var m=l.prototype;m.next=function(){const r=this._geometry;
this._geometry=null;return r&&void 0!==r.rings?this._polygonCenter(r):null};m._polygonCenter=function(r){let k=!1;switch(this._method){case e.PlacementPolygonCenterMethod.CenterOfMass:if(r=u.weightedAreaCentroid(r))this._internalPlacement.setTranslate(r[0]+this._offsetX,r[1]+this._offsetY),k=!0;break;case e.PlacementPolygonCenterMethod.BoundingBoxCenter:const c=E.create();B.getBoundsXY(c,r);c&&(this._internalPlacement.setTranslate((c[2]+c[0])/2+this._offsetX,(c[3]+c[1])/2+this._offsetY),k=!0);break;
default:r=t("polylabel-placement-enabled")?A.getPolylabelPoint(r):A.getLabelPoint(r),null!==r&&(this._internalPlacement.setTranslate(r[0]+this._offsetX,r[1]+this._offsetY),k=!0)}return k?this._internalPlacement:null};return l}();v.PlacementPolygonCenter=h;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/labelPoint":function(){define("exports ../../core/maybe ../../core/PriorityQueue ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(v,t,E,B,u,A,x,e){function h(b,a){var {rings:g}=a;a=0;for(const n of g){g=n.length;for(let f=1;f<g;++f){const q=n[f-1],p=n[f];q[1]>b[1]!==p[1]>b[1]&&(0<(p[0]-q[0])*(b[1]-q[1])-(p[1]-q[1])*(b[0]-q[0])?a++:a--)}}return 0!==a}function d(b,a,g){if(g&&h(b,a))return{coord:b,distance:0};g=Infinity;let n=0,f=0;const q=[0,0];({rings:a}=a);for(const p of a)if(!(2>p.length))for(a=0;a<p.length-1;a++){x.projectPointOnLine(q,b,p,a);const z=r(b,q);z<g&&(g=z,n=q[0],f=q[1])}return{coord:[n,f],distance:Math.sqrt(g)}}
function l(b,a,g,n){g=[a,0];let f=Infinity,q=Infinity,p=!1,z=!1;a=[[a,n[1]-1],[a,n[3]+1]];n=[0,0];const w=[0,0],y=[0,0],G=[[0,0],[0,0]],H=B.create();({rings:b}=b);for(const F of b)if(!(2>F.length))for(b=1;b<F.length;b++){G[0][0]=F[b-1][0];G[0][1]=F[b-1][1];G[1][0]=F[b][0];G[1][1]=F[b][1];a:{var I=H;var D=G;if(2>D.length){I=null;break a}I||(I=B.create());const [K,J]=D[0],[P,S]=D[1];I[0]=Math.min(K,P);I[1]=Math.min(J,S);I[2]=Math.max(K,P);I[3]=Math.max(J,S)}if(null!==I){w[0]=a[0][0];w[1]=a[0][1];y[0]=
a[1][0];y[1]=a[1][1];a:{I=H;D=w;var C=y;let K=m(D,I),J=m(C,I);const P=I[0],S=I[1],X=I[2],ha=I[3];if(K&J){I=0;break a}if(!(K|J)){I=4;break a}const U=(K?1:0)|(J?2:0);do{const Q=C[0]-D[0],O=C[1]-D[1];if(Q>O)K&3?(K&1?(D[1]+=O*(P-D[0])/Q,D[0]=P):(D[1]+=O*(X-D[0])/Q,D[0]=X),K=m(D,I)):J&3?(J&1?(C[1]+=O*(P-C[0])/Q,C[0]=P):(C[1]+=O*(X-C[0])/Q,C[0]=X),J=m(C,I)):K?(K&4?(D[0]+=Q*(S-D[1])/O,D[1]=S):(D[0]+=Q*(ha-D[1])/O,D[1]=ha),K=m(D,I)):(J&4?(C[0]+=Q*(S-C[1])/O,C[1]=S):(C[0]+=Q*(ha-C[1])/O,C[1]=ha),J=m(C,I));
else if(K&12?(K&4?(D[0]+=Q*(S-D[1])/O,D[1]=S):(D[0]+=Q*(ha-D[1])/O,D[1]=ha),K=m(D,I)):J&12?(J&4?(C[0]+=Q*(S-C[1])/O,C[1]=S):(C[0]+=Q*(ha-C[1])/O,C[1]=ha),J=m(C,I)):K?(K&1?(D[1]+=O*(P-D[0])/Q,D[0]=P):(D[1]+=O*(X-D[0])/Q,D[0]=X),K=m(D,I)):(J&1?(C[1]+=O*(P-C[0])/Q,C[0]=P):(C[1]+=O*(X-C[0])/Q,C[0]=X),J=m(C,I)),K&J){I=0;break a}}while(K|J);I=U}0!==I&&e.segmentIntersects(a[0],a[1],G[0],G[1],n)&&(I=n[1],f>q?I<f&&(f=I,p=!0):I<q&&(q=I,z=!0))}}p&&z?g[1]=(f+q)/2:g[0]=g[1]=NaN;return g}function m(b,a){return(b[0]<
a[0]?1:0)|(b[0]>a[2]?1:0)<<1|(b[1]<a[1]?1:0)<<2|(b[1]>a[3]?1:0)<<3}function r(b,a){return(b[0]-a[0])*(b[0]-a[0])+(b[1]-a[1])*(b[1]-a[1])}function k(b,a){if(b<a)return-1;if(b>a)return 1;if(b===a)return 0;b=isNaN(b);a=isNaN(a);return b<a?-1:b>a?1:0}let c=function(b,a,g,n){this.x=b;this.y=a;this.cellSize=g;this.distancefromCellCenter=x.distanceFromPointToPolygon(b,a,n);this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2};v.getLabelPoint=function(b){var {rings:a}=b;if(!a||0===
a.length)return null;var g=u.getBoundsXY(B.create(),b);if(!g)return null;var n=8.8818E-14*(Math.abs(g[0])+Math.abs(g[2])+Math.abs(g[1])+Math.abs(g[3])+1),f=0,q=0;for(var p=0;p<a.length;p++){var z=x.getRingArea(a[p]);z>q&&(q=z,f=p)}if(Math.abs(q)<=2*n*n)return q=u.getPointsBounds(B.create(),a[f]),[(q[0]+q[2])/2,(q[1]+q[3])/2];var w=A.ringCentroid(a[f],!1,B.create());if(null===w)return null;if(1===a.length&&4>a[0].length)return w;q=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];p=[NaN,NaN,NaN,NaN];z=[NaN,
NaN,NaN,NaN];var y=!1,G=d(w,b,!0);0===G.distance&&(y=!0,q[0][0]=w[0],q[0][1]=w[1],G=d(w,b,!1));p[0]=G.distance;z[0]=0;var H=[NaN,NaN],I=!1;let D=.25,C=-1;a=u.getPointsBounds(B.create(),a[f]);f=NaN;do if(f=NaN,G=a[0],q[1]=l(b,G+(a[2]-G)*D,n,g),isNaN(q[1][0])||isNaN(q[1][1])||(G=d(q[1],b,!1),f=G.distance),!isNaN(f)&&f>n&&h(q[1],b))I=!0,p[1]=f,z[1]=r(q[1],w);else if(!isNaN(f)&&f>C&&(C=f,H[0]=q[1][0],H[1]=q[1][1]),D-=.01,.1>D)if(0<=C)I=!0,p[1]=C,q[1][0]=H[0],q[1][1]=H[1],z[1]=r(q[1],w);else break;while(!I);
I=!1;D=.5;C=-1;let F=.01,K=1;do if(f=NaN,G=a[0],q[2]=l(b,G+(a[2]-G)*D,n,g),isNaN(q[2][0])||isNaN(q[2][1])||(G=d(q[2],b,!1),f=G.distance),!isNaN(f)&&f>n&&h(q[2],b))I=!0,p[2]=f,z[2]=r(q[2],w);else if(!isNaN(f)&&f>C)C=f,H[0]=q[2][0],H[1]=q[2][1];else if(f>C&&(C=f,H[0]=q[2][0],H[1]=q[2][1]),D=.5+F*K,F+=.01,K*=-1,.3>D||.7<D)if(0<=C)I=!0,p[2]=C,q[2][0]=H[0],q[2][1]=H[1],z[2]=r(q[2],w);else break;while(!I);I=!1;D=.75;C=-1;do if(f=NaN,G=a[0],q[3]=l(b,G+(a[2]-G)*D,n,g),isNaN(q[3][0])||isNaN(q[3][1])||(G=d(q[3],
b,!1),f=G.distance),!isNaN(f)&&f>n&&h(q[3],b))I=!0,p[3]=f,z[3]=r(q[3],w);else if(f>C&&(C=f,H[0]=q[3][0],H[1]=q[3][1]),D+=.01,.9<D)if(0<=C)I=!0,p[3]=C,q[3][0]=H[0],q[3][1]=H[1],z[3]=r(q[3],w);else break;while(!I);b=[0,1,2,3];g=y?0:1;for(y=g;4>y;y++)for(w=g;3>w;w++)H=z[w],I=z[w+1],0<k(H,I)&&(n=b[w],b[w]=b[w+1],b[w+1]=n,z[w]=I,z[w+1]=H);z=g;for(y=n=0;4>g;g++){switch(g){case 0:y=2*p[b[g]];break;case 1:y=1.66666666*p[b[g]];break;case 2:y=1.33333333*p[b[g]];break;case 3:y=p[b[g]]}y>n&&(n=y,z=b[g])}return q[z]};
v.getPolylabelPoint=function(b){if(!b||!b.rings||0===b.rings.length)return null;var a=u.getPointsBounds(B.create(),b.rings[0]);if(!a)return null;var g=a[2]-a[0],n=a[3]-a[1];if(0===g||0===n)return[a[0]+g/2,a[1]+n/2];const f=Math.max(Math.min(g,n)/100,1),q=new E((w,y)=>y.maxDistanceToPolygon-w.maxDistanceToPolygon);n=Math.min(g,n);g=n/2;let p=0,z=0;for(p=a[0];p<a[2];p+=n)for(z=a[1];z<a[3];z+=n)q.enqueue(new c(p+g,z+g,g,b));a=A.ringsCentroid(b.rings,!1);if(null===a)return null;for(a=new c(a[0],a[1],
0,b);0<q.size;)n=t.unwrap(q.dequeue()),n.distancefromCellCenter>a.distancefromCellCenter&&(a=n),n.maxDistanceToPolygon-a.distancefromCellCenter<=f||(g=n.cellSize/2,q.enqueue(new c(n.x-g,n.y-g,g,b)),q.enqueue(new c(n.x+g,n.y-g,g,b)),q.enqueue(new c(n.x-g,n.y+g,g,b)),q.enqueue(new c(n.x+g,n.y+g,g,b)));return[a.x,a.y]};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],function(v){const t=
(E,B)=>E<B?-1:E>B?1:0;return function(){function E(u=t){this._data=[];this._compare=u}var B=E.prototype;B.enqueue=function(u){if(null!=u){var {_data:A,_compare:x}=this;A.push(u);u=A.length-1>>>0;for(var e=A[u];0<u;){const h=u-1>>1,d=A[h];if(0>=x(d,e))A[h]=e,A[u]=d,u=h;else break}}};B.dequeue=function(){const {_data:u,_compare:A}=this,x=u[0];var e=u.pop();if(0===u.length)return x;u[0]=e;e=0;const h=u.length,d=u[0];let l;let m=null;for(;;){var r=2*e+1;const k=2*e+2;m=null;r<h&&(l=u[r],0<A(l,d)&&(m=
r));k<h&&(r=u[k],null===m&&0>=A(r,d)||null!==m&&0>=A(r,l))&&(m=k);if(null===m)break;u[e]=u[m];u[m]=d;e=m}return x};v._createClass(E,[{key:"size",get:function(){return this._data.length}}]);return E}()})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(v,t,E,B,u,A,x,e,h,d){const l=Math.PI/180;let m=function(){function c(a,g,n,f){this._rotationT=B.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const q=n.rect,p=new Float32Array(8);a*=f;g*=f;const z=n.code?q.width*f:n.metrics.width,w=n.code?q.height*f:n.metrics.height;p[0]=a;p[1]=g;p[2]=a+z;p[3]=g;p[4]=a;p[5]=g+w;p[6]=a+z;p[7]=g+w;this._data=p;this._setTextureCoords(q);this._scale=f;this._mosaic=n;this.x=a;this.y=g;this.maxOffset=Math.max(a+z,g+w)}var b=
c.prototype;b.setTransform=function(a){this._transform=a;this._offsets=null};b._setOffsets=function(a){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const g=this._offsets,n=new Float32Array(8),f=E.multiply(B.create(),this._rotationT,this._transform);B.transformMany(n,a,f);g.upperLeft=e.i1616to32(8*n[0],8*n[1]);g.upperRight=e.i1616to32(8*n[2],8*n[3]);g.lowerLeft=e.i1616to32(8*n[4],8*n[5]);g.lowerRight=e.i1616to32(8*n[6],8*n[7])};b._setTextureCoords=function({x:a,
y:g,width:n,height:f}){this._texcoords={upperLeft:e.i1616to32(a,g),upperRight:e.i1616to32(a+n,g),lowerLeft:e.i1616to32(a,g+f),lowerRight:e.i1616to32(a+n,g+f)}};t._createClass(c,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(a){this._angle=a;E.fromRotation(this._rotationT,-a);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},
{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},
{key:"bounds",get:function(){if(!this._bounds){const {height:q,width:p}=this._mosaic.metrics;var a=p*this._scale,g=Math.abs(q)*this._scale,n=new Float32Array(8);n[0]=this.x;n[1]=this.y;n[2]=this.x+a;n[3]=this.y;n[4]=this.x;n[5]=this.y+g;n[6]=this.x+a;n[7]=this.y+g;a=E.multiply(B.create(),this._rotationT,this._transform);B.transformMany(n,n,a);g=a=Infinity;let z=0;var f=0;for(let w=0;4>w;w++){const y=n[2*w],G=n[2*w+1];a=Math.min(a,y);g=Math.min(g,G);z=Math.max(z,y);f=Math.max(f,G)}n=z-a;f-=g;this._bounds=
new d(a+n/2,g+f/2,n,f)}return this._bounds}}]);return c}(),r=function(){function c(a,g,n){this._rotation=0;this._decorate(a,g,n);this.glyphs=a;this.bounds=this._createBounds(a);this.isMultiline=1<g.length;this._hasRotation=0!==n.angle;this._transform=this._createGlyphTransform(this.bounds,n);for(const f of a)f.setTransform(this._transform)}var b=c.prototype;b.setRotation=function(a){if(0!==a||0!==this._rotation){this._rotation=a;var g=this._transform;a=E.fromRotation(B.create(),a);E.multiply(g,a,
g);for(const n of this.glyphs)n.setTransform(this._transform)}};b._decorate=function(a,g,n){if(n.decoration&&"none"!==n.decoration&&a.length){var f=n.scale;n="underline"===n.decoration?30:20;var q=a[0].textureBinding;for(const y of g){const G=y.startX*f,H=y.startY*f;g=a;var p=g.push;var z=(y.width+y.glyphWidthEnd)*f;var w=q;z={code:0,page:0,sdf:!0,rect:new h(0,0,11,8),textureBinding:w,metrics:{advance:0,height:4,width:z,left:0,top:0}};p.call(g,new m(G,H+n*f,z,1))}}};b._createBounds=function(a){let g=
Infinity,n=Infinity,f=0;var q=0;for(const p of a)g=Math.min(g,p.xTopLeft),n=Math.min(n,p.yTopLeft),f=Math.max(f,p.xTopLeft+p.width),q=Math.max(q,p.yBottomRight);a=f-g;q-=n;return new d(g+a/2,n+q/2,a,q)};b._createGlyphTransform=function(a,g){const n=l*g.angle,f=B.create(),q=A.create();E.translate(f,f,u.set(q,g.xOffset,-g.yOffset));g.isCIM?E.rotate(f,f,n):(E.translate(f,f,u.set(q,a.x,a.y)),E.rotate(f,f,n),E.translate(f,f,u.set(q,-a.x,-a.y)));return f};t._createClass(c,[{key:"boundsT",get:function(){var a=
this.bounds;const g=u.set(A.create(),a.x,a.y);u.transformMat2d(g,g,this._transform);return this._hasRotation?(a=Math.max(a.width,a.height),new d(g[0],g[1],a,a)):new d(g[0],g[1],a.width,a.height)}}]);return c}(),k=function(c,b,a,g,n,f){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(b,a));this.end=Math.max(0,Math.max(b,a));this.end<c.length&&(this.glyphWidthEnd=c[this.end].metrics.width);this.width=g;this.yMin=n;this.yMax=f};v.ShapedGlyph=m;v.ShapingInfo=r;v.shapeGlyphs=
function(c,b,a){const g=a.scale,n=[],f=[];var q=1/a.scale*a.maxLineWidth;var p=b?c.length-1:0,z=b?-1:c.length;b=b?-1:1;var w=p,y=0,G=0;let H=w,I=H,D=0,C=Infinity,F=0;for(;w!==z;){const {code:S,metrics:X}=c[w];var K=Math.abs(X.top);10!==S&&32!==S&&(C=Math.min(C,K),F=Math.max(F,K+X.height));10===S?(w!==p&&(f.push(new k(c,H,w-b,y,C,F)),C=Infinity,F=0),y=0,H=w+b,I=w+b,G=0):32===S?(I=w+b,G=0,D=X.advance,y+=X.advance):(y>q&&(I!==H?(K=I-2*b,y-=D,f.push(new k(c,H,K,y-G,C,F)),C=Infinity,F=0,H=I,y=G):(f.push(new k(c,
H,w-b,y,C,F)),C=Infinity,F=0,I=H=w,y=0)),y+=X.advance,G+=X.advance);w+=b}q=new k(c,H,w-b,y,C,F);0<=q.start&&q.end<c.length&&f.push(q);for(q=0;q<f.length;q++);p=f[0].yMin;q=f[f.length-1].yMax+a.lineHeight*(f.length-1)+("underline"===a.decoration?4:0)-p;const {vAlign:J,hAlign:P}=a;z=J===x.VAlign.Baseline?1:0;q=(1-z)*-p+q/2*(z?0:J-1)+-26*(z?1:0);for(p=0;p<f.length;p++){const {start:S,end:X,width:ha}=f[p];z=ha/2*(P+1)*-1-3;b=p*a.lineHeight+q-3;f[p].startX=z;f[p].startY=b;for(w=S;w<=X;w++)y=c[w],10!==
y.code&&(G=new m(z+y.metrics.left,b-y.metrics.top,y,g),z+=y.metrics.advance,n.push(G))}return new r(n,f,a)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(v,t){function E(w,y){w[0]=y[0];w[1]=y[1];w[2]=y[2];w[3]=y[3];w[4]=y[4];w[5]=y[5];return w}function B(w){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=0;w[5]=0;return w}function u(w,y,G,H,I,D,C){w[0]=y;w[1]=G;w[2]=H;w[3]=I;w[4]=D;w[5]=C;return w}
function A(w,y){const G=y[0],H=y[1],I=y[2],D=y[3],C=y[4];y=y[5];let F=G*D-H*I;if(!F)return null;F=1/F;w[0]=D*F;w[1]=-H*F;w[2]=-I*F;w[3]=G*F;w[4]=(I*y-D*C)*F;w[5]=(H*C-G*y)*F;return w}function x(w){return w[0]*w[3]-w[1]*w[2]}function e(w,y,G){const H=y[0],I=y[1],D=y[2],C=y[3],F=y[4];y=y[5];const K=G[0],J=G[1],P=G[2],S=G[3],X=G[4];G=G[5];w[0]=H*K+D*J;w[1]=I*K+C*J;w[2]=H*P+D*S;w[3]=I*P+C*S;w[4]=H*X+D*G+F;w[5]=I*X+C*G+y;return w}function h(w,y,G){const H=y[0],I=y[1],D=y[2],C=y[3],F=y[4];y=y[5];const K=
Math.sin(G);G=Math.cos(G);w[0]=H*G+D*K;w[1]=I*G+C*K;w[2]=H*-K+D*G;w[3]=I*-K+C*G;w[4]=F;w[5]=y;return w}function d(w,y,G){const H=y[1],I=y[2],D=y[3],C=y[4],F=y[5],K=G[0];G=G[1];w[0]=y[0]*K;w[1]=H*K;w[2]=I*G;w[3]=D*G;w[4]=C;w[5]=F;return w}function l(w,y,G){const H=y[0],I=y[1],D=y[2],C=y[3],F=y[4];y=y[5];const K=G[0];G=G[1];w[0]=H;w[1]=I;w[2]=D;w[3]=C;w[4]=H*K+D*G+F;w[5]=I*K+C*G+y;return w}function m(w,y){const G=Math.sin(y);y=Math.cos(y);w[0]=y;w[1]=G;w[2]=-G;w[3]=y;w[4]=0;w[5]=0;return w}function r(w,
y){w[0]=y[0];w[1]=0;w[2]=0;w[3]=y[1];w[4]=0;w[5]=0;return w}function k(w,y){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=y[0];w[5]=y[1];return w}function c(w){return"mat2d("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+")"}function b(w){return Math.sqrt(w[0]**2+w[1]**2+w[2]**2+w[3]**2+w[4]**2+w[5]**2+1)}function a(w,y,G){w[0]=y[0]+G[0];w[1]=y[1]+G[1];w[2]=y[2]+G[2];w[3]=y[3]+G[3];w[4]=y[4]+G[4];w[5]=y[5]+G[5];return w}function g(w,y,G){w[0]=y[0]-G[0];w[1]=y[1]-G[1];w[2]=y[2]-G[2];w[3]=y[3]-G[3];w[4]=
y[4]-G[4];w[5]=y[5]-G[5];return w}function n(w,y,G){w[0]=y[0]*G;w[1]=y[1]*G;w[2]=y[2]*G;w[3]=y[3]*G;w[4]=y[4]*G;w[5]=y[5]*G;return w}function f(w,y,G,H){w[0]=y[0]+G[0]*H;w[1]=y[1]+G[1]*H;w[2]=y[2]+G[2]*H;w[3]=y[3]+G[3]*H;w[4]=y[4]+G[4]*H;w[5]=y[5]+G[5]*H;return w}function q(w,y){return w[0]===y[0]&&w[1]===y[1]&&w[2]===y[2]&&w[3]===y[3]&&w[4]===y[4]&&w[5]===y[5]}function p(w,y){const G=w[0],H=w[1],I=w[2],D=w[3],C=w[4];w=w[5];const F=y[0],K=y[1],J=y[2],P=y[3],S=y[4];y=y[5];const X=t.getEpsilon();return Math.abs(G-
F)<=X*Math.max(1,Math.abs(G),Math.abs(F))&&Math.abs(H-K)<=X*Math.max(1,Math.abs(H),Math.abs(K))&&Math.abs(I-J)<=X*Math.max(1,Math.abs(I),Math.abs(J))&&Math.abs(D-P)<=X*Math.max(1,Math.abs(D),Math.abs(P))&&Math.abs(C-S)<=X*Math.max(1,Math.abs(C),Math.abs(S))&&Math.abs(w-y)<=X*Math.max(1,Math.abs(w),Math.abs(y))}const z=Object.freeze(Object.defineProperty({__proto__:null,copy:E,identity:B,set:u,invert:A,determinant:x,multiply:e,rotate:h,scale:d,translate:l,fromRotation:m,fromScaling:r,fromTranslation:k,
str:c,frob:b,add:a,subtract:g,multiplyScalar:n,multiplyScalarAndAdd:f,exactEquals:q,equals:p,mul:e,sub:g},Symbol.toStringTag,{value:"Module"}));v.add=a;v.copy=E;v.determinant=x;v.equals=p;v.exactEquals=q;v.frob=b;v.fromRotation=m;v.fromScaling=r;v.fromTranslation=k;v.identity=B;v.invert=A;v.mat2d=z;v.mul=e;v.multiply=e;v.multiplyScalar=n;v.multiplyScalarAndAdd=f;v.rotate=h;v.scale=d;v.set=u;v.str=c;v.sub=g;v.subtract=g;v.translate=l})},"esri/chunks/mat2df32":function(){define(["exports"],function(v){function t(){const h=
new Float32Array(6);h[0]=1;h[3]=1;return h}function E(h){const d=new Float32Array(6);d[0]=h[0];d[1]=h[1];d[2]=h[2];d[3]=h[3];d[4]=h[4];d[5]=h[5];return d}function B(h,d,l,m,r,k){const c=new Float32Array(6);c[0]=h;c[1]=d;c[2]=l;c[3]=m;c[4]=r;c[5]=k;return c}function u(h,d){return new Float32Array(h,d,6)}function A(h,d,l,m){const r=d[m];d=d[m+1];h[m]=l[0]*r+l[2]*d+l[4];h[m+1]=l[1]*r+l[3]*d+l[5]}function x(h,d,l,m=0,r=0,k=2){for(r=r||d.length/k;m<r;m++)A(h,d,l,m*k)}const e=Object.freeze(Object.defineProperty({__proto__:null,
create:t,clone:E,fromValues:B,createView:u,transform:A,transformMany:x},Symbol.toStringTag,{value:"Module"}));v.clone=E;v.create=t;v.createView=u;v.fromValues=B;v.mat2df32=e;v.transform=A;v.transformMany=x})},"esri/chunks/vec2f32":function(){define(["exports"],function(v){function t(){return new Float32Array(2)}function E(c){const b=new Float32Array(2);b[0]=c[0];b[1]=c[1];return b}function B(c,b){const a=new Float32Array(2);a[0]=c;a[1]=b;return a}function u(c,b){return new Float32Array(c,b,2)}function A(){return t()}
function x(){return B(1,1)}function e(){return B(1,0)}function h(){return B(0,1)}const d=t(),l=x(),m=e(),r=h(),k=Object.freeze(Object.defineProperty({__proto__:null,create:t,clone:E,fromValues:B,createView:u,zeros:A,ones:x,unitX:e,unitY:h,ZEROS:d,ONES:l,UNIT_X:m,UNIT_Y:r},Symbol.toStringTag,{value:"Module"}));v.ONES=l;v.UNIT_X=m;v.UNIT_Y=r;v.ZEROS=d;v.clone=E;v.create=t;v.createView=u;v.fromValues=B;v.ones=x;v.unitX=e;v.unitY=h;v.vec2f32=k;v.zeros=A})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../chunks/vec2f32"],function(v,t){return function(){function E(u,A,x,e){this.center=t.fromValues(u,A);this.centerT=t.create();this.halfWidth=x/2;this.halfHeight=e/2;this.width=x;this.height=e}var B=E.prototype;B.clone=function(){return new E(this.x,this.y,this.width,this.height)};B.serialize=function(u){u.writeF32(this.center[0]);u.writeF32(this.center[1]);u.push(this.width);u.push(this.height);return u};B.findCollisionDelta=function(u,A=4){return Math.log2(Math.min((u.halfWidth+this.halfWidth+
A)/Math.abs(u.centerT[0]-this.centerT[0]),(u.halfHeight+this.halfHeight+A)/Math.abs(u.centerT[1]-this.centerT[1])))};B.extend=function(u){const A=Math.min(this.xmin,u.xmin),x=Math.min(this.ymin,u.ymin),e=Math.max(this.xmax,u.xmax)-A;u=Math.max(this.ymax,u.ymax)-x;this.width=e;this.height=u;this.halfWidth=e/2;this.halfHeight=u/2;this.x=A+e/2;this.y=x+u/2};E.deserialize=function(u){const A=u.readF32(),x=u.readF32(),e=u.readInt32();u=u.readInt32();return new E(A,x,e,u)};v._createClass(E,[{key:"x",get:function(){return this.center[0]},
set:function(u){this.center[0]=u}},{key:"y",get:function(){return this.center[1]},set:function(u){this.center[1]=u}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return E}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(v,t){return function(){function E(){}var B=E.prototype;B.bindFeature=function(u,A,x){};B.write=function(u,A,x,e){if(v.isNone(this._effects)||0===this._effects?.length)return this._write(u,A,e);x=t.CIMEffectHelper.executeEffects(this._effects,
A.readLegacyGeometryForDisplay(),e.geometryEngine);let h=t.CIMEffectHelper.next(x);for(;h;)this._write(u,A,e,h),h=t.CIMEffectHelper.next(x)};B._write=function(u,A,x,e){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(v,t,E,B,u){const A=96/72;let x=function(){function e(){}e.executeEffects=function(h,d,l){d=E.cloneAndDecodeGeometry(d);d=new B.SimpleGeometryCursor(d);
for(const m of h)(h=u.getEffectOperator(m))&&(d=h.execute(d,m,A,l));return d};e.next=function(h){h=h.next();E.deltaEncodeGeometry(h);return h};e.applyEffects=function(h,d,l){if(!h)return d;d=new B.SimpleGeometryCursor(d);for(var m of h)(h=u.getEffectOperator(m))&&(d=h.execute(d,m,1,l));for(l=null;m=d.next();)l?t.isPolyline(l)?t.isPolyline(m)&&l.paths.push(...m.paths):t.isPolygon(l)&&t.isPolygon(m)&&l.rings.push(...m.rings):l=m;return l};return e}();v.CIMEffectHelper=x;Object.defineProperties(v,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(v,t){let E=function(){function B(u){this._geometry=u}B.prototype.next=function(){const u=this._geometry;this._geometry=null;return u};return B}();v.SimpleGeometryCursor=E;v.clone=function(B){return t.clone(B)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k){return function(c){function b(a,g,n,f,q,p,z,w,y,G,H,I,D,C,F,K,J,P,S,X,ha,U,Q){var O=c.call(this)||this;O.angle=f;O.height=z;O.width=p;O.xOffset=g*S;O.yOffset=n*S;O._markerPlacement=X;O._effects=ha;O._anchorX=K;O._anchorY=J;O._minMaxZoom=d.i1616to32(Math.round(U*e.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(Q*e.MIN_MAX_ZOOM_PRECISION_FACTOR));g=(C===A.Alignment.MAP?e.BITSET_MARKER_ALIGNMENT_MAP:e.BITSET_MARKER_ALIGNMENT_SCREEN)|(H?e.BITSET_GENERIC_LOCK_COLOR:0)|
(D?e.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(I?e.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);n=F&&F.sdf;a=l.MarkerMaterialKey.load(a);a.sdf=n;a.pattern=!0;a.textureBinding=F.textureBinding;O._materialKey=a.data;O._fillColor=q;O._outlineColor=y;O._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*z),255)),Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*w),255)));q=F.rect.x+e.SPRITE_PADDING;w=F.rect.y+e.SPRITE_PADDING;
y=q+F.width;F=w+F.height;O._offsets.xUpperLeft=q;O._offsets.yUpperLeft=w;O._offsets.xUpperRight=y;O._offsets.yUpperRight=w;O._offsets.xBottomLeft=q;O._offsets.yBottomLeft=F;O._offsets.xBottomRight=y;O._offsets.yBottomRight=F;a.symbologyType===h.WGLSymbologyType.PIE_CHART?(O._texUpperLeft=d.i1616to32(0,1),O._texUpperRight=d.i1616to32(1,1),O._texBottomLeft=d.i1616to32(0,0),O._texBottomRight=d.i1616to32(1,0)):(O._texUpperLeft=d.i1616to32(q,w),O._texUpperRight=d.i1616to32(y,w),O._texBottomLeft=d.i1616to32(q,
F),O._texBottomRight=d.i1616to32(y,F));p=p*P*S;z=z*P*S;O._bitestAndDistRatio=d.i1616to32(g,Math.round(64*P));O._computedWidth=p;O._computedHeight=z;p=u.create();z=B.create();O._applyTransformation(z,p);return O}v._inheritsLoose(b,c);b.fromCIMMarker=function(a,g,n){const f=a.size,q=(g&&g.width||1)/(g&&g.height||1)*a.scaleX;var p=a.scaleSymbolsProportionally&&a.frameHeight?f/a.frameHeight:1;let z=x.premultiplyAlphaRGBA(a.color);const w=x.premultiplyAlphaRGBA(a.outlineColor),y=E.pt2px(f),G=y*q,H=E.pt2px(a.offsetX||
0),I=E.pt2px(a.offsetY||0);p*=E.pt2px(a.outlineWidth||0);const D=a.alignment||A.Alignment.SCREEN,C=E.pt2px(a.referenceSize),[F,K]=m.getMinMaxZoom(a.scaleInfo,n);g.sdf||0!==z||(z=-1);n=a.rotation||0;a.rotateClockwise||(n=-n);let J=0,P=0;const S=a.anchorPoint;S&&(a.isAbsoluteAnchorPoint?f&&(J=S.x/(f*q),P=S.y/f):(J=S.x,P=S.y));g=new b(a.materialKey,H,I,n,z,G,y,C,w,p,a.colorLocked,a.scaleSymbolsProportionally,!1,D,g,J,P,a.sizeRatio,t.unwrapOr(a.scaleFactor,1),a.markerPlacement,a.effects,F,K);g._vertexBoundsScaleX=
a.maxVVSize?a.maxVVSize/G:1;g._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/y:1;return g};b.fromPictureMarker=function(a,g){const n=Math.round(E.pt2px(a.width)),f=Math.round(E.pt2px(a.height)),q=e.PICTURE_FILL_COLOR,p=Math.round(E.pt2px(a.xoffset||0)),z=Math.round(E.pt2px(a.yoffset||0));g=new b(a.materialKey,p,z,a.angle,q,n,f,f,0,0,!1,!1,!1,A.Alignment.SCREEN,g,0,0,1,1,null,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM);g._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.width:1;g._vertexBoundsScaleY=a.maxVVSize?
a.maxVVSize/a.height:1;return g};b.fromSimpleMarker=function(a,g){const n=x.premultiplyAlphaRGBAArray(a.color),f=Math.round(E.pt2px(a.size)),q=Math.round(E.pt2px(a.xoffset||0)),p=Math.round(E.pt2px(a.yoffset||0)),z=a.style;var w=a.outline;const y=(w&&w.color&&x.premultiplyAlphaRGBAArray(w.color))|0;w=(w&&w.width&&Math.round(E.pt2px(w.width)))|0;g=new b(a.materialKey,q,p,a.angle,n,f,f,f,y,w,!1,!1,"esriSMSCross"===z||"esriSMSX"===z,A.Alignment.SCREEN,g,0,0,1.96875,1,null,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM);
g.boundsType="esriSMSCircle"===z?"circle":"square";g._vertexBoundsScaleX=a.maxVVSize?a.maxVVSize/a.size:1;g._vertexBoundsScaleY=a.maxVVSize?a.maxVVSize/a.size:1;return g};b.fromLineSymbolMarker=function(a,g){const n=x.premultiplyAlphaRGBAArray(a.color),f=Math.round(E.pt2px(6*a.lineWidth)),q="cross"===a.style||"x"===a.style;switch(a.placement){case "begin-end":var p=A.ExtremityPlacement.Both;break;case "begin":p=A.ExtremityPlacement.JustBegin;break;case "end":p=A.ExtremityPlacement.JustEnd;break;default:p=
A.ExtremityPlacement.None}p={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:p,offsetAlongLine:0};g=new b(a.materialKey,0,0,0,n,f,f,f/6,n,q?Math.round(E.pt2px(a.lineWidth)):0,!1,!1,q,A.Alignment.MAP,g,0,0,1.96875,1,p,null,m.DEFAULT_MIN_ZOOM,m.DEFAULT_MAX_ZOOM);g.boundsType="circle"===a.style?"circle":"square";return g};return b}(r(k))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){const k=3.14159265359/180;return c=>function(b){function a(...n){n=b.call(this,...n)||this;n.angle=0;n.xOffset=0;n.yOffset=0;n.width=0;n.height=0;n.boundsType="square";n._anchorX=0;n._anchorY=0;n._computedWidth=0;n._computedHeight=0;n._vertexBoundsScaleX=1;n._vertexBoundsScaleY=1;n._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};n.geometryType=l.WGLGeometryType.MARKER;return n}v._inheritsLoose(a,
b);var g=a.prototype;g._write=function(n,f,q,p){const z=f.getDisplayId();n.recordStart(z,this._materialKey,this.geometryType,!0);this._writeGeometry(n,f,z,q,p);n.recordEnd()};g._writeGeometry=function(n,f,q,p,z){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(n,f,p,z);if(!z&&"esriGeometryPoint"===f.geometryType)return p=f.getX(),f=f.getY(),!n.hasAggregates&&n.hasPixelBufferEnabled&&(0>p||513<=p||0>f||513<=f)?void 0:this._writeVertices(n,q,this._getPos(p,f),p,f);f=z?e.deltaDecodeGeometry(e.convertFromGeometry(z),
2):"esriGeometryPolygon"===f.geometryType?f.readCentroid():f.readGeometryForDisplay();if(!t.isNone(f)){if(f.isPoint){const [w,y]=f.coords;return!n.hasAggregates&&n.hasPixelBufferEnabled&&(0>w||512<=w||0>y||512<=y)?void 0:this._writeVertices(n,q,this._getPos(w,y),w,y)}f.forEachVertex((w,y)=>{const G=2*d.TILE_SIZE;w<-G||w>=G||y<-G||y>=G||this._writeVertices(n,q,this._getPos(w,y),w,y)})}};g._writePlacedMarkers=function(n,f,q,p){p=p??f.readLegacyGeometryForDisplay();if(q=h.CIMMarkerPlacementHelper.getPlacement(p,
t.unwrap(this._markerPlacement),E.pt2px(1),q.geometryEngine)){f=f.getDisplayId();p=x.create();for(var z=u.create(),w=q.next();null!=w;){const y=w.tx,G=-w.ty;-128<=y&&640>=y&&-128<=G&&640>=G&&(this._applyTransformation(z,p,-w.getAngle()/k),this._writeVertices(n,f,this._getPos(y,G),y,G));w=q.next()}}};g._writeVertices=function(n,f,q,p,z){const w=r.MarkerMaterialKey.load(this._materialKey);switch(w.symbologyType){case l.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(n,f,q);default:return this._writeMarkerVertices(n,
f,w,q,p,z)}};g._writeMarkerVertices=function(n,f,q,p,z,w){var y=q.vvRotation;q=n.vertexCount();let G=this._computedWidth*this._vertexBoundsScaleX;var H=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(G=H=Math.max(G,H));y&&(y=Math.max(this.xOffset,this.yOffset),G+=y,H+=y);n.vertexBounds(z+this.xOffset,w-this.yOffset,G,H);n.vertexWrite(p);n.vertexWrite(this._offsetUpperLeft);n.vertexWrite(this._texUpperLeft);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(f);n.vertexWrite(this._fillColor);
n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.vertexWrite(p);n.vertexWrite(this._offsetUpperRight);n.vertexWrite(this._texUpperRight);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(f);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.vertexWrite(p);n.vertexWrite(this._offsetBottomLeft);n.vertexWrite(this._texBottomLeft);
n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(f);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();n.vertexWrite(p);n.vertexWrite(this._offsetBottomRight);n.vertexWrite(this._texBottomRight);n.vertexWrite(this._bitestAndDistRatio);n.vertexWrite(f);n.vertexWrite(this._fillColor);n.vertexWrite(this._outlineColor);n.vertexWrite(this._sizeOutlineWidth);n.vertexWrite(this._minMaxZoom);n.vertexEnd();
this._writeIndices(n,q)};g._writeHeatmapVertices=function(n,f,q){const p=n.vertexCount();n.vertexWrite(q);n.vertexWrite(this._offsetUpperLeft);n.vertexWrite(f);n.vertexEnd();n.vertexWrite(q);n.vertexWrite(this._offsetUpperRight);n.vertexWrite(f);n.vertexEnd();n.vertexWrite(q);n.vertexWrite(this._offsetBottomLeft);n.vertexWrite(f);n.vertexEnd();n.vertexWrite(q);n.vertexWrite(this._offsetBottomRight);n.vertexWrite(f);n.vertexEnd();this._writeIndices(n,p)};g._writeIndices=function(n,f){n.indexWrite(f+
0);n.indexWrite(f+1);n.indexWrite(f+2);n.indexWrite(f+1);n.indexWrite(f+3);n.indexWrite(f+2)};g._applyTransformation=function(n,f,q=0){B.fromTranslation(n,x.fromValues(this.xOffset,-this.yOffset));0!==this.angle+q&&B.rotate(n,n,k*(this.angle+q));q=this._computedWidth;const p=this._computedHeight,z=-(.5+this._anchorX)*q,w=-(.5-this._anchorY)*p;A.set(f,z,w);A.transformMat2d(f,f,n);this._offsetUpperLeft=m.i1616to32(16*f[0],16*f[1]);this._offsets.xUpperLeft=f[0];this._offsets.yUpperLeft=f[1];A.set(f,
z+q,w);A.transformMat2d(f,f,n);this._offsetUpperRight=m.i1616to32(16*f[0],16*f[1]);this._offsets.xUpperRight=f[0];this._offsets.yUpperRight=f[1];A.set(f,z,w+p);A.transformMat2d(f,f,n);this._offsetBottomLeft=m.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomLeft=f[0];this._offsets.yBottomLeft=f[1];A.set(f,z+q,w+p);A.transformMat2d(f,f,n);this._offsetBottomRight=m.i1616to32(16*f[0],16*f[1]);this._offsets.xBottomRight=f[0];this._offsets.yBottomRight=f[1]};g._getPos=function(n,f){return m.i1616to32(Math.round(8*
n),Math.round(8*f))};return a}(c)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f){function q(I,D){const C=I.length;I.push(null);D.then(F=>I[C]=F);return I}function p(I){return!!(I&1)}const z=B.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),w=[];B={isOutline:!1,placement:null,symbologyType:x.WGLSymbologyType.DEFAULT,vvFlags:0};const y={...A.errorPointSymbolJSON,hash:JSON.stringify(A.errorPointSymbolJSON),materialKey:e.createMaterialKey(x.WGLGeometryType.MARKER,B)},G={...A.errorPolylineSymbolJSON,hash:JSON.stringify(A.errorPolylineSymbolJSON),
materialKey:e.createMaterialKey(x.WGLGeometryType.LINE,B)},H={...A.errorPolygonSymbolJSON,hash:JSON.stringify(A.errorPolygonSymbolJSON),materialKey:e.createMaterialKey(x.WGLGeometryType.FILL,B)};A=function(){function I(C,F){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new a.Lock;this._fetchResource=C;this._tileInfo=F}var D=I.prototype;
D.createTemplateGroup=function(C,F){this._initErrorTemplates();const K=C.hash;if(this._symbolToTemplate.has(K))return this._symbolToTemplate.get(K);const J=[];F&&this._createMeshTemplates(J,F,!0);this._createMeshTemplates(J,C,!1);F=this._createGroupId;var P;if(P="expanded-cim"===C.type)a:{if(C.layers)for(const S of C.layers)if("function"===typeof S.materialHash){P=!0;break a}P=!1}C=F.call(this,P);this._idToTemplateGroup.set(C,J);this._symbolToTemplate.set(K,C);return C};D.getTemplateGroup=function(C){return this._idToTemplateGroup.has(C)?
this._idToTemplateGroup.get(C):w};D.getDynamicTemplateGroup=function(C){if(!this._idToTemplateGroup.has(C))return w;p(C)||z.error("mapview-template-store",`Id ${C} does not refer to a dynamic template`);return this._idToTemplateGroup.get(C)};D.getMosaicItem=function(C,F){const K=this._createTemplateId(),J=new Promise(P=>this._idToResolver.set(K,P));this._fetchQueue.push({symbol:C,id:K,glyphIds:F});return J};D.finalize=function(C){return this._fetchQueue.length||this._lock.isHeld()?a.withLock(this._lock,
this._fetchAllQueuedResources.bind(this),C):Promise.resolve()};D._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],H,!1),marker:this._createMeshTemplates([],y,!1),line:this._createMeshTemplates([],G,!1)})};D._fetchAllQueuedResources=function(C){if(!this._fetchQueue.length)return Promise.resolve();const F=this._fetchQueue,K=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(K).then(()=>this._fetchResource(F,C).then(J=>
{for(const {id:P,mosaicItem:S}of J)this._idToResolver.get(P)(S),this._idToResolver.delete(P)})).catch(J=>{u.isAbortError(J)?this._fetchQueue=this._fetchQueue.concat(F):"worker:port-closed"!==J.name&&z.error(new E("mapview-template-store","Unable to fetch requested texture resources",J))})};D._createGroupId=function(C){return this._idCounter++<<1|(C?1:0)};D._createTemplateId=function(){return this._templateIdCounter++};D._createSMS=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=
yield this.getMosaicItem(F);return g.ok(K,z)?c.fromSimpleMarker(F,K):this._markerError});return function(F){return C.apply(this,arguments)}}();D._createPMS=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=yield this.getMosaicItem(F);return g.ok(K,z)?c.fromPictureMarker(F,K):this._markerError});return function(F){return C.apply(this,arguments)}}();D._createSFS=function(){var C=t._asyncToGenerator(function*(F,K){const {spriteMosaicItem:J}=yield this.getMosaicItem(F);return g.ok(J,
z)?r.fromSimpleFill(F,J,K):this._fillError});return function(F,K){return C.apply(this,arguments)}}();D._createPFS=function(){var C=t._asyncToGenerator(function*(F,K){const {spriteMosaicItem:J}=yield this.getMosaicItem(F);return g.ok(J,z)?r.fromPictureFill(F,J,K):this._fillError});return function(F,K){return C.apply(this,arguments)}}();D._createSLS=function(){var C=t._asyncToGenerator(function*(F,K){({spriteMosaicItem:K}=yield this.getMosaicItem(F));return g.ok(K,z)?k.fromSimpleLine(F,K):this._lineError});
return function(F,K){return C.apply(this,arguments)}}();D._createLMS=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=yield this.getMosaicItem(F);return g.ok(K,z)?c.fromLineSymbolMarker(F,K):this._markerError});return function(F){return C.apply(this,arguments)}}();D._createTS=function(){var C=t._asyncToGenerator(function*(F){const {glyphMosaicItems:K}=yield this.getMosaicItem(F);return b.fromText(F,K)});return function(F){return C.apply(this,arguments)}}();D._createCIMText=
function(){var C=t._asyncToGenerator(function*(F){const {glyphMosaicItems:K}=yield this.getMosaicItem(f.cimLayerToRasterizationInfo(F),n.codepoints(F.text));return g.ok(K,z)?b.fromCIMText(F,K,this._tileInfo):this._textError});return function(F){return C.apply(this,arguments)}}();D._createCIMFill=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=yield this.getMosaicItem(f.cimLayerToRasterizationInfo(F));return g.ok(K,z)?r.fromCIMFill(F,K,this._tileInfo):this._fillError});
return function(F){return C.apply(this,arguments)}}();D._createCIMLine=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=yield this.getMosaicItem(f.cimLayerToRasterizationInfo(F));return g.ok(K,z)?k.fromCIMLine(F,K,this._tileInfo):this._lineError});return function(F){return C.apply(this,arguments)}}();D._createCIMMarker=function(){var C=t._asyncToGenerator(function*(F){const {spriteMosaicItem:K}=yield this.getMosaicItem(f.cimLayerToRasterizationInfo(F));return g.ok(K,z)?
c.fromCIMMarker(F,K,this._tileInfo):this._markerError});return function(F){return C.apply(this,arguments)}}();D._createCIM=function(){var C=t._asyncToGenerator(function*(F){const K=F.templateHash;if(this._cimTemplateCache.has(K))return this._cimTemplateCache.get(K);let J;switch(F.type){case "marker":J=yield this._createCIMMarker(F);break;case "line":J=yield this._createCIMLine(F);break;case "fill":J=yield this._createCIMFill(F);break;case "text":J=yield this._createCIMText(F)}this._cimTemplateCache.set(K,
J);return J});return function(F){return C.apply(this,arguments)}}();D._createDynamicCIM=function(){var C=t._asyncToGenerator(function*(F){const K=F.templateHash;if(this._cimTemplateCache.has(K))return this._cimTemplateCache.get(K);let J;switch(F.type){case "marker":J=l.fromCIMMarker(F,this._tileInfo);break;case "line":J=d.fromCIMLine(F,this._tileInfo);break;case "fill":J=h.fromCIMFill(F,this._tileInfo);break;case "text":J=m.fromCIMText(F,this._tileInfo)}this._cimTemplateCache.set(K,J);return J});
return function(F){return C.apply(this,arguments)}}();D._createPrimitiveMeshTemplates=function(C,F,K){switch(F.type){case "esriSMS":return q(C,this._createSMS(F));case "esriPMS":return q(C,this._createPMS(F));case "esriSFS":return q(C,this._createSFS(F,K));case "line-marker":return q(C,this._createLMS(F));case "esriPFS":return q(C,this._createPFS(F,K));case "esriSLS":return q(C,this._createSLS(F,!1));case "esriTS":return q(C,this._createTS(F));default:return z.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
C}};D._createMeshTemplates=function(C,F,K){if(F.type.includes("3d"))return z.error("3D symbols are not supported with MapView"),C;if("expanded-cim"===F.type){for(const J of F.layers)"function"===typeof J.materialHash?q(C,this._createDynamicCIM(J)):q(C,this._createCIM(J));return C}if("composite-symbol"===F.type){for(const J of F.layers)this._createPrimitiveMeshTemplates(C,J,K);return C}return"cim"===F.type||"label"===F.type||"web-style"===F.type?C:this._createPrimitiveMeshTemplates(C,F,K)};t._createClass(I,
[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return I}();v.WGLTemplateStore=A;v.errorPointSchema2D=y;v.errorPolygonSchema2D=H;v.errorPolylineSchema2D=G;v.isDynamicId=p;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(v,t,E,B,u,A,x,e,h,d,l,m){return function(r){function k(c,b,a){var g=r.call(this,c)||this;g._minMaxZoom=x.i1616to32(Math.round(b*
u.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(a*u.MIN_MAX_ZOOM_PRECISION_FACTOR));h.isFunction(c.color)?g._dynamicPropertyMap.set("fillColor",(w,y,G)=>(w=c.color(w,y,G))&&B.premultiplyAlphaRGBA(w)||0):(b=c.color,g.fillColor=b&&B.premultiplyAlphaRGBA(b)||0);const n="CIMMarkerPlacementInsidePolygon"===c.cim.placement?.type&&c.cim.placement.shiftOddRows?2:1,f=c.height;h.isFunction(f)?g._dynamicPropertyMap.set("_height",(w,y,G)=>f(w,y,G)*n):g._height=(f||0)*n;const q=c.offsetX;h.isFunction(q)?g._dynamicPropertyMap.set("_offsetX",
(w,y,G)=>E.pt2px(q(w,y,G))):g._offsetX=E.pt2px(q||0);const p=c.offsetY;h.isFunction(p)?g._dynamicPropertyMap.set("_offsetY",(w,y,G)=>E.pt2px(-p(w,y,G))):g._offsetY=E.pt2px(-p||0);b=c.scaleX;h.isFunction(b)?g._dynamicPropertyMap.set("_scaleX",b):g._scaleX=b||1;const z=c.angle;h.isFunction(z)?g._dynamicPropertyMap.set("_angle",(w,y,G)=>A.degToByte(z(w,y,G))):g._angle=A.degToByte(z)||0;t.isSome(c.effects)&&(b=c.effects,h.isFunction(b)?g._dynamicPropertyMap.set("_effects",b):g._effects=b);g._cimFillLayer=
c;g._bitset=(c.colorLocked?u.BITSET_GENERIC_LOCK_COLOR:0)|(c.applyRandomOffset?u.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(c.sampleAlphaOnly?u.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);g._fillMaterialKey=c.materialKey;return g}v._inheritsLoose(k,r);k.fromCIMFill=function(c,b){const [a,g]=h.getMinMaxZoom(c.scaleInfo,b);return new k(c,a,g)};k.prototype.bindFeature=function(c,b,a){const g=c.readLegacyFeature();this._dynamicPropertyMap.forEach((q,p)=>{this[p]=q(g,b,a)});c=e.FillMaterialKey.load(this._fillMaterialKey);
var n=this._materialCache,f=this._cimFillLayer.materialHash;f=f(g,b,a);f=n.get(f);n=null;f&&m.ok(f.spriteMosaicItem)&&(n=f.spriteMosaicItem);if(n){const {rect:q,width:p,height:z}=n;f=q.x+u.SPRITE_PADDING;const w=q.y+u.SPRITE_PADDING,y=f+p,G=w+z;let H=Math.round(E.pt2px(this._height));0>=H&&(H=G-w);let I=Math.round(E.pt2px(this._height/z*p||0));0>=I&&(I=y-f);const D=this._scaleX;this.tl=x.i1616to32(f,w);this.br=x.i1616to32(y,G);this.aux21=x.i1616to32(I,H);this.aux22=x.i1616to32(this._offsetX,this._offsetY);
this.aux3=x.i8888to32(128*D,128,this._angle,0);c.sdf=n.sdf;c.pattern=!0;c.textureBinding=n.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,c.sdf=!1,c.pattern=!1,c.textureBinding=0;this._materialKey=c.data};return k}(d(l))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h){return d=>function(l){function m(...k){k=l.call(this,...k)||this;k.forceLibtess=!1;k._bitset=0;k._lineTemplate=null;k.geometryType=B.WGLGeometryType.FILL;return k}v._inheritsLoose(m,l);var r=m.prototype;r._maybeAddLineTemplate=function(k){this._lineTemplate=h.fromFillOutline(k)};r._write=function(k,c,b,a){b="esriGeometryPoint"===c.geometryType;const g=x.FillMaterialKey.load(this._materialKey);k.recordStart(c.getDisplayId(),this._materialKey,this.geometryType,b);this._writeGeometry(k,
c,g,a,b);x.hasOutlineFillSymbology(g)&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(k,c,a,b);k.recordEnd()};r._writeGeometry=function(k,c,b,a,g){a=this._getGeometry(c,a,g);t.isNone(a)||(g=[],100<a.maxLength||this.forceLibtess||!e.triangulate(g,a)?(a=e.triangulateLibtess(a),this._writeVertices(k,c,a,[a.length/2],b)):g.length&&this._writeVertices(k,c,a.coords,a.lengths,b,g))};r._writeVertex=function(k,c,b,a,g,n){const f=u.i1616to32(1*a,1*g);k.vertexBounds(a,g,0,0);k.vertexWrite(f);
k.vertexWrite(c);b.symbologyType===B.WGLSymbologyType.DOT_DENSITY?k.vertexWriteF32(1/Math.abs(n.readGeometryArea())):(k.vertexWrite(this.fillColor),c=x.hasSimpleSymbology(b),c||(k.vertexWrite(this.tl),k.vertexWrite(this.br)),k.vertexWrite(this.aux21),k.vertexWrite(this.aux22),k.vertexWrite(this.aux3),c||k.vertexWrite(this._minMaxZoom))};r._writeVertices=function(k,c,b,a,g,n){var f=c.getDisplayId();f|=this._bitset<<24;var q=a.reduce((z,w)=>z+w);const p=A.getStrides(g.geometryType,g.symbologyType).geometry/
4;a=k.vertexCount();k.vertexEnsureSize(p*q);q=0;if(n)for(const z of n)this._writeVertex(k,f,g,b[2*z],b[2*z+1],c),q++;else for(n=0;n<b.length;n+=2)this._writeVertex(k,f,g,Math.round(b[n]),Math.round(b[n+1]),c),q++;k.indexEnsureSize(q);for(c=0;c<q;c++)k.indexWrite(c+a)};r._getGeometry=function(k,c,b){return(k=c?E.deltaDecodeGeometry(E.convertFromGeometry(c),2):k.readGeometryForDisplay())?e.clipMarshall(k,b?256:8):null};return m}(d)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(v,t,E,B,u,A,x,e,h){function d(k,c,b){let a=0;for(let g=1;g<b;g++)a+=(k[2*(c+g)]-k[2*(c+g-1)])*(k[2*(c+g)+1]+k[2*(c+g-1)+1]);return a}function l(k,c,b,a,g){let n=0;for(;b<a;b+=3){const f=2*(k[b]-g),q=2*(k[b+1]-g),p=2*(k[b+2]-g);n+=Math.abs((c[f]-c[p])*(c[q+1]-c[f+1])-(c[f]-c[q])*(c[p+1]-c[f+1]))}return n}const m=new e.TileClipper(0,0,0,1,0),r=new e.TileClipper(0,0,0,1,0);m.setExtent(A.TILE_SIZE);r.setExtent(A.TILE_SIZE);v.area=d;v.clipLinesMarshall=function(k,c){r.setPixelMargin(c);const b=
-c;c=A.TILE_SIZE+c;let a=[];var g=!1;let n=0;for(;n<k.length;){const f=[],q=k[n];if(!q)return null;r.reset(x.GeometryType.LineString);let [p,z]=q[0];if(g)r.moveTo(p,z);else{if(p<b||p>c||z<b||z>c){g=!0;continue}f.push({x:p,y:z})}let w=!1;const y=q.length;for(let G=1;G<y;++G)if(p+=q[G][0],z+=q[G][1],g)r.lineTo(p,z);else{if(p<b||p>c||z<b||z>c){w=!0;break}f.push({x:p,y:z})}if(w)g=!0;else{if(g){if(g=r.resultWithStarts())for(const G of g)a.push(G)}else a.push({line:f,start:0});n++;g=!1}}a=a.filter(f=>1<
f.line.length);return 0===a.length?null:a};v.clipMarshall=function(k,c){if(t.isNone(k))return null;a:{var b=A.TILE_SIZE+128;var a=0;for(var g=0;g<k.lengths.length;g++){var n=k.lengths[g];for(var f=0;f<n;f++){const q=k.coords[2*(f+a)],p=k.coords[2*(f+a)+1];if(-128>q||q>b||-128>p||p>b){b=!0;break a}}a+=n}b=!1}if(!b)return k;m.setPixelMargin(c);m.reset(x.GeometryType.Polygon);c=0;for(b=0;b<k.lengths.length;b++){a=k.lengths[b];g=k.coords[2*(0+c)];n=k.coords[2*(0+c)+1];m.moveTo(g,n);for(f=1;f<a;f++)g=
k.coords[2*(f+c)],n=k.coords[2*(f+c)+1],m.lineTo(g,n);m.close();c+=a}b=m.result(!1);if(!b)return null;k=[];c=[];for(const q of b){b=0;for(const p of q)c.push(p.x),c.push(p.y),b++;k.push(b)}return new u(k,c)};v.triangleAreaArray=l;v.triangulate=function(k,c){const {coords:b,lengths:a,hasIndeterminateRingOrder:g}=c;if(g)return!1;c=0;for(var n=0;n<a.length;){let p=n,z=a[n];n=d(b,c,z);for(var f=[];++p<a.length;){var q=a[p];const w=d(b,c+z,q);if(!(0<w))break;n+=w;f.push(c+z);z+=q}q=k.length;h.bufcut(k,
b,c,c+z,f,2,0);f=l(k,b,q,k.length,0);n=Math.abs(n);if(1E-5<Math.abs((f-n)/Math.max(1E-7,n)))return k.length=0,!1;n=p;c+=z}return!0};v.triangulateEarcut=function(k,c,b){const {coords:a,lengths:g,hasIndeterminateRingOrder:n}=c;if(n)return!1;let f=0;for(var q=0;q<g.length;){let z=q,w=g[q];for(q=[];++z<g.length;){var p=g[z];if(!(0<d(a,f+w,p)))break;q.push(f+w-f);w+=p}p=c.coords.slice(2*f,2*(f+w));q=E.earcut(p,q,2);for(const y of q)k.push(y+b+f);q=z;f+=w}return!0};v.triangulateLibtess=function(k){const {coords:c,
lengths:b}=k;({buffer:k}=B.triangulate(c,b));return k};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(v){function t(q,p,z,w,y,G,H){let I;z=0;for(let D=w,C=y-G;D<y;D+=G)z+=(q[C+p*G]-q[D+p*G])*(q[D+1+p*G]+q[C+1+p*G]),C=D;if(H===0<z)for(;w<y;w+=G)I=A(w+p*G,q[w+p*G],q[w+1+p*G],I);else for(y-=G;y>=w;y-=G)I=A(y+p*G,q[y+p*G],q[y+1+p*G],I);I&&c(I,I.next)&&(x(I),I=I.next);return I}function E(q,
p=q){if(!q)return q;let z;do if(z=!1,q.steiner||!c(q,q.next)&&0!==d(q.prev,q,q.next))q=q.next;else{x(q);q=p=q.prev;if(q===q.next)break;z=!0}while(z||q!==p);return p}function B(q,p,z,w,y,G,H,I){if(q){!I&&G&&(q=h(q,w,y,G));for(var D=q;q.prev!==q.next;){var C=q.prev,F=q.next;if(G)var K=u(q,w,y,G);else a:{K=q;var J=K.prev,P=K;const S=K.next;if(0<=d(J,P,S)){K=!1;break a}let X=K.next.next;const ha=X;let U=0;for(;X!==K.prev&&(0===U||X!==ha);){U++;if(m(J.x,J.y,P.x,P.y,S.x,S.y,X.x,X.y)&&0<=d(X.prev,X,X.next)){K=
!1;break a}X=X.next}K=!0}if(K)p.push(C.index/z+H),p.push(q.index/z+H),p.push(F.index/z+H),x(q),D=q=F.next;else if(q=F,q===D){if(!I)B(E(q),p,z,w,y,G,H,1);else if(1===I){I=p;D=z;C=H;F=q;do K=F.prev,J=F.next.next,!c(K,J)&&l(K,F,F.next,J)&&r(K,J)&&r(J,K)&&(I.push(K.index/D+C),I.push(F.index/D+C),I.push(J.index/D+C),x(F),x(F.next),F=q=J),F=F.next;while(F!==q);q=F;B(q,p,z,w,y,G,H,2)}else if(2===I)a:{I=q;do{for(D=I.next.next;D!==I.prev;){if(C=I.index!==D.index){K=K=K=void 0;C=I;F=D;if(K=C.next.index!==F.index&&
C.prev.index!==F.index){b:{K=C;do{if(K.index!==C.index&&K.next.index!==C.index&&K.index!==F.index&&K.next.index!==F.index&&l(K,K.next,C,F)){K=!0;break b}K=K.next}while(K!==C);K=!1}K=!K}if(K=K&&r(C,F)&&r(F,C)){K=C;J=!1;P=(C.x+F.x)/2;F=(C.y+F.y)/2;do K.y>F!==K.next.y>F&&K.next.y!==K.y&&P<(K.next.x-K.x)*(F-K.y)/(K.next.y-K.y)+K.x&&(J=!J),K=K.next;while(K!==C);K=J}C=K}if(C){q=a(I,D);I=E(I,I.next);q=E(q,q.next);B(I,p,z,w,y,G,H,0);B(q,p,z,w,y,G,H,0);break a}D=D.next}I=I.next}while(I!==q)}break}}}}function u(q,
p,z,w){const y=q.prev,G=q.next;if(0<=d(y,q,G))return!1;const H=y.x>q.x?y.x>G.x?y.x:G.x:q.x>G.x?q.x:G.x,I=y.y>q.y?y.y>G.y?y.y:G.y:q.y>G.y?q.y:G.y,D=k(y.x<q.x?y.x<G.x?y.x:G.x:q.x<G.x?q.x:G.x,y.y<q.y?y.y<G.y?y.y:G.y:q.y<G.y?q.y:G.y,p,z,w);p=k(H,I,p,z,w);z=q.prevZ;for(w=q.nextZ;z&&z.z>=D&&w&&w.z<=p;){if(z!==q.prev&&z!==q.next&&m(y.x,y.y,q.x,q.y,G.x,G.y,z.x,z.y)&&0<=d(z.prev,z,z.next))return!1;z=z.prevZ;if(w!==q.prev&&w!==q.next&&m(y.x,y.y,q.x,q.y,G.x,G.y,w.x,w.y)&&0<=d(w.prev,w,w.next))return!1;w=w.nextZ}for(;z&&
z.z>=D;){if(z!==q.prev&&z!==q.next&&m(y.x,y.y,q.x,q.y,G.x,G.y,z.x,z.y)&&0<=d(z.prev,z,z.next))return!1;z=z.prevZ}for(;w&&w.z<=p;){if(w!==q.prev&&w!==q.next&&m(y.x,y.y,q.x,q.y,G.x,G.y,w.x,w.y)&&0<=d(w.prev,w,w.next))return!1;w=w.nextZ}return!0}function A(q,p,z,w){q=g.create(q,p,z);w?(q.next=w.next,q.prev=w,w.next.prev=q,w.next=q):(q.prev=q,q.next=q);return q}function x(q){q.next.prev=q.prev;q.prev.next=q.next;q.prevZ&&(q.prevZ.nextZ=q.nextZ);q.nextZ&&(q.nextZ.prevZ=q.prevZ)}function e(q,p){let z=p;
const w=q.x,y=q.y;let G=-Infinity,H;do{if(y<=z.y&&y>=z.next.y&&z.next.y!==z.y){var I=z.x+(y-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(I<=w&&I>G){G=I;if(I===w){if(y===z.y)return z;if(y===z.next.y)return z.next}H=z.x<z.next.x?z:z.next}}z=z.next}while(z!==p);if(!H)return null;if(w===G)return H.prev;p=H;I=H.x;const D=H.y;let C=Infinity,F;for(z=H.next;z!==p;)w>=z.x&&z.x>=I&&w!==z.x&&m(y<D?w:G,y,I,D,y<D?G:w,y,z.x,z.y)&&(F=Math.abs(y-z.y)/(w-z.x),(F<C||F===C&&z.x>H.x)&&r(z,q)&&(H=z,C=F)),z=z.next;return H}function h(q,
p,z,w){for(var y;y!==q;y=y.next){y=y||q;null===y.z&&(y.z=k(y.x,y.y,p,z,w));if(y.prev.next!==y||y.next.prev!==y)return y.prev.next=y,y.next.prev=y,h(q,p,z,w);y.prevZ=y.prev;y.nextZ=y.next}q.prevZ.nextZ=null;q.prevZ=null;a:for(z=1;;){w=q;p=q=null;let G=0;for(;w;){G++;y=w;let H=0;for(;H<z&&y;H++)y=y.nextZ;let I=z;for(;0<H||0<I&&y;){let D;0===H?(D=y,y=y.nextZ,I--):0!==I&&y?w.z<=y.z?(D=w,w=w.nextZ,H--):(D=y,y=y.nextZ,I--):(D=w,w=w.nextZ,H--);p?p.nextZ=D:q=D;D.prevZ=p;p=D}w=y}p.nextZ=null;z*=2;if(2>G)break a}return q}
function d(q,p,z){return(p.y-q.y)*(z.x-p.x)-(p.x-q.x)*(z.y-p.y)}function l(q,p,z,w){return c(q,p)&&c(z,w)||c(q,w)&&c(z,p)?!0:0<d(q,p,z)!==0<d(q,p,w)&&0<d(z,w,q)!==0<d(z,w,p)}function m(q,p,z,w,y,G,H,I){return 0<=(y-H)*(p-I)-(q-H)*(G-I)&&0<=(q-H)*(w-I)-(z-H)*(p-I)&&0<=(z-H)*(G-I)-(y-H)*(w-I)}function r(q,p){return 0>d(q.prev,q,q.next)?0<=d(q,p,q.next)&&0<=d(q,q.prev,p):0>d(q,p,q.prev)||0>d(q,q.next,p)}function k(q,p,z,w,y){q=32767*(q-z)*y;p=32767*(p-w)*y;q=(q|q<<8)&16711935;q=(q|q<<4)&252645135;q=
(q|q<<2)&858993459;p=(p|p<<8)&16711935;p=(p|p<<4)&252645135;p=(p|p<<2)&858993459;return(q|q<<1)&1431655765|((p|p<<1)&1431655765)<<1}function c(q,p){return q.x===p.x&&q.y===p.y}function b(q,p){return q.x-p.x}function a(q,p){const z=g.create(q.index,q.x,q.y),w=g.create(p.index,p.x,p.y),y=q.next,G=p.prev;q.next=p;p.prev=q;z.next=y;y.prev=z;w.next=z;z.prev=w;G.next=w;w.prev=G;return w}let g=function(){function q(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=
!1}q.create=function(p,z,w){const y=f<n.length?n[f++]:new q;y.index=p;y.x=z;y.y=w;y.prev=null;y.next=null;y.z=null;y.prevZ=null;y.nextZ=null;y.steiner=!1;return y};return q}();const n=[];let f=0;for(let q=0;8096>q;q++)n.push(new g);v.bufcut=function(q,p,z,w,y,G,H){f=0;var I=(w-z)*G,D=y&&y.length;const C=D?(y[0]-z)*G:I;var F=t(p,z,w,0,C,G,!0);if(F&&F.next!==F.prev){var K;if(D){const ha=[];for(let U=0,Q=y.length;U<Q;U++){const O=t(p,z,w,y[U]*G,U<Q-1?y[U+1]*G:w*G,G,!1);O===O.next&&(O.steiner=!0);D=ha;
var J=D.push;let R=O,V=O;do{if(R.x<V.x||R.x===V.x&&R.y<V.y)V=R;R=R.next}while(R!==O);J.call(D,V)}ha.sort(b);for(var P of ha)if(w=P,y=e(w,F))w=a(y,w),E(w,w.next),F=E(y,y.next)}if(I>80*G){var S=I=p[z*G];var X=K=p[1+z*G];for(P=G;P<C;P+=G)w=p[P+z*G],y=p[P+1+z*G],S=Math.min(S,w),X=Math.min(X,y),I=Math.max(I,w),K=Math.max(K,y);K=Math.max(I-S,K-X);K=0!==K?1/K:0}B(F,q,G,S,X,K,H,0)}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m){return function(r){function k(c,b,a,g,n,f,q,p,z,w,y,G,H,I,D,C,F,K,J,P){var S=r.call(this)||this;c=h.LineMaterialKey.load(c);b&&(c.sdf=b.sdf,c.pattern=!0,c.textureBinding=b.textureBinding);S._capType=g;S._joinType=n;S._miterLimitCosine=d.getLimitCosine(f);S.tessellationProperties._fillColor=q;S.tessellationProperties._tl=p;S.tessellationProperties._br=z;S._hasPattern=w;S._isDashed=y;S._zOrder=F;S._effects=K;S._minMaxZoom=x.i1616to32(Math.round(J*A.MIN_MAX_ZOOM_PRECISION_FACTOR),
Math.round(P*A.MIN_MAX_ZOOM_PRECISION_FACTOR));S._materialKey=c.data;S.tessellationProperties._bitset=(H?A.BITSET_GENERIC_LOCK_COLOR:0)|(I?A.BITSET_TYPE_FILL_OUTLINE:0)|(G?A.BITSET_LINE_SCALE_DASH:0)|(D?A.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);S.tessellationProperties._halfWidth=.5*a;S.tessellationProperties._halfReferenceWidth=.5*C;S.tessellationProperties.offset=0;S._initializeTessellator(!1);return S}v._inheritsLoose(k,r);k.fromCIMLine=function(c,b,a){var g=c.color,n=c.scaleFactor||1;const f=!!c.dashTemplate;
let q=c.cap;f&&q===B.CapType.ROUND&&(q=B.CapType.SQUARE);const p=c.join;n*=E.pt2px(c.width);const z=E.pt2px(c.referenceWidth),w=E.pt2px(c.miterLimit);g=g&&u.premultiplyAlphaRGBA(g)||0;const [y,G]=d.getMinMaxZoom(c.scaleInfo,a);if(!b)return new k(c.materialKey,b,n,q,p,w,g,0,0,!1,f,c.scaleDash,c.colorLocked,!1,c.sampleAlphaOnly,z,c.zOrder,c.effects,y,G);const {rect:H,width:I,height:D}=b;var C=H.x+A.SPRITE_PADDING;const F=H.y+A.SPRITE_PADDING;a=C+I;const K=F+D;C=x.i1616to32(C,F);a=x.i1616to32(a,K);return new k(c.materialKey,
b,n,q,p,w,g,C,a,!0,f,c.scaleDash,c.colorLocked,!1,c.sampleAlphaOnly,z,c.zOrder,c.effects,y,G)};k.fromFillOutline=function(c){const b=h.FillMaterialKey.load(c.materialKey);return h.hasOutlineFillSymbology(b)&&c.outline&&"esriSLSSolid"===c.outline?.style?k.fromSimpleLine({hash:"",materialKey:c.materialKey,...c.outline},null,!0):null};k.fromSimpleLine=function(c,b,a=!1){var {color:g}=c;const n="esriSLSSolid"!==c.style&&"esriSLSNull"!==c.style,f=e.getCapType(c.cap||"round"),q=e.getJoinType(c.join||"round");
g=g&&"esriSLSNull"!==c.style&&u.premultiplyAlphaRGBAArray(g)||0;"esriSLSNull"===c.style&&(g=0);const p=E.pt2px(c.width),z=c.miterLimit;if(!b)return new k(c.materialKey,b,p,f,q,z,g,0,0,!1,n,!0,!1,a,!1,p,0,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM);const {rect:w,width:y,height:G}=b;var H=w.x+A.SPRITE_PADDING;const I=w.y+A.SPRITE_PADDING;var D=H+y;const C=I+G;H=x.i1616to32(H,I);D=x.i1616to32(D,C);return new k(c.materialKey,b,p,f,q,z,g,H,D,!0,n,!0,!1,a,!1,p,0,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM)};
k.fromPictureLineSymbol=function(c,b,a,g){t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");return null};return k}(l(m))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(v,t,E,B,u,A,x,e){const h=(m,r,
k)=>(c,b,a,g,n,f,q,p,z,w,y)=>{a=u.i1616to32(y,Math.ceil(16*m._halfWidth));q=u.i8888to32(Math.round(16*q),Math.round(16*p),Math.round(16*z),Math.round(16*w));n=u.i8888to32(16*n,16*f,0,m._bitset);f=m.out;f.vertexBounds(c,b,r,k);f.vertexWrite(u.i1616to32(8*c,8*b));f.vertexWrite(m.id);f.vertexWrite(m._fillColor);f.vertexWrite(q);f.vertexWrite(a);f.vertexWrite(m._tl);f.vertexWrite(m._br);f.vertexWrite(n);f.vertexWrite(u.i1616to32(Math.ceil(16*m._halfReferenceWidth),0));f.vertexWrite(m.minMaxZoom);f.vertexEnd();
return m.offset+m.vertexCount++},d=(m,r,k)=>(c,b,a,g,n,f,q,p,z,w,y)=>{a=u.i1616to32(16*m._halfWidth,16*m._halfReferenceWidth);q=u.i8888to32(16*q+128,16*p+128,16*z+128,16*w+128);p=m.out;z=m._bitset<<24|m.id;p.vertexBounds(c,b,r,k);p.vertexWrite(u.i1616to32(8*c,8*b));p.vertexWrite(z);p.vertexWrite(m._fillColor);c=x.hasSimpleSymbology(m.key);c||(p.vertexWrite(0),p.vertexWrite(0));p.vertexWrite(0);p.vertexWrite(a);p.vertexWrite(q);c||p.vertexWrite(m.minMaxZoom);p.vertexEnd();return m.offset+m.vertexCount++},
l=m=>(r,k,c)=>{const b=m.out;b.indexWrite(r);b.indexWrite(k);b.indexWrite(c);m.indexCount+=3};return m=>function(r){function k(...b){b=r.call(this,...b)||this;b.tessellationProperties={};b._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};b.geometryType=B.WGLGeometryType.LINE;return b}v._inheritsLoose(k,r);var c=k.prototype;c.writeGeometry=function(b,a,g,n){this._writeGeometry(b,a,g,n)};c._initializeTessellator=function(b){var a=x.LineMaterialKey.load(this._materialKey),g=x.FillMaterialKey.load(this._materialKey),
n=this._tessellationOptions;a=a.vvSizeFieldStops||a.vvSizeMinMaxValue||a.vvSizeScaleStops||a.vvSizeUnitValue;b=this.tessellationProperties._halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD&&!b&&!a;this.tessellationProperties.minMaxZoom=this._minMaxZoom;n.wrapDistance=65535;n.textured=this._isDashed||this._hasPattern;n.offset=this.tessellationProperties.offset;n.halfWidth=this.tessellationProperties._halfWidth;n=b?0:1;g=x.hasOutlineFillSymbology(g)?d:h;this._lineTessellator=new A.LineTessellation(g(this.tessellationProperties,
n,n),l(this.tessellationProperties),b)};c._write=function(b,a,g,n){g="esriGeometryPoint"===a.geometryType;b.recordStart(a.getDisplayId(),this._materialKey,this.geometryType,g);this._writeGeometry(b,a,n,g);b.recordEnd()};c._writeGeometry=function(b,a,g,n){g=g??a.readLegacyGeometryForDisplay();n=this._getLines(g,n);t.isNone(n)||this._writeVertices(b,a,n)};c._getLines=function(b,a){if(t.isNone(b))return null;b=b.paths||b.rings;return t.isNone(b)?null:e.clipLinesMarshall(b,a?256:16)};c._writeVertices=
function(b,a,g){const n=a.getDisplayId(),f=b.vertexCount(),q=this.tessellationProperties;a=this._tessellationOptions;q.out=b;q.id=n;q.indexCount=0;q.vertexCount=0;q.offset=f;a.capType=this._capType;a.joinType=this._joinType;b=x.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=x.hasOutlineFillSymbology(b)?b:x.LineMaterialKey.load(this._materialKey);for(const {line:p,start:z}of g)a.initialDistance=z%65535,this._lineTessellator.tessellate(p,a)};return k}(m)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(v,t,E,B,u){const A=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(x){function e(h){var d=x.call(this)||this;d._ongoingMaterialRequestMap=new Map;d._materialCache=new Map;d._dynamicPropertyMap=new Map;d._cimLayer=h;return d}v._inheritsLoose(e,x);e.prototype.analyze=function(h,d,l,m,r){if(r&&0===r.length)return null;const k=
r&&0<r.length,c=d.readLegacyFeature();d=d.getObjectId();const b=this._materialCache;var a=this._cimLayer.materialHash;if(!a)return A.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const g="function"===typeof a?a(c,l,m,d):a;if(b.has(g))return h=b.get(g),Promise.resolve(h);if(a=this._ongoingMaterialRequestMap.get(g))return a;a=this._cimLayer;const n=E.analyzeCIMResource(a.cim,this._cimLayer.materialOverrides);n.mosaicHash=g;const {type:f,url:q}=a;
d={cim:n,type:f,mosaicHash:g,url:q,size:null,dashTemplate:null,text:null,fontName:null,objectId:d,animatedSymbolProperties:null};switch(f){case "marker":d.size=B.evaluateValueOrFunction(a.size,c,l,m);d.animatedSymbolProperties=B.evaluateValueOrFunction(a.animatedSymbolProperties,c,l,m);break;case "line":d.dashTemplate=a.dashTemplate;break;case "text":d.text=B.evaluateValueOrFunction(a.text,c,l,m),d.fontName=B.evaluateValueOrFunction(a.fontName,c,l,m)}h=h.getMosaicItem(d,r).then(p=>{k||(this._ongoingMaterialRequestMap.delete(g),
b.set(g,p));return p}).catch(p=>{this._ongoingMaterialRequestMap.delete(g);A.error(".analyze()",p.message);return null});k||this._ongoingMaterialRequestMap.set(g,h);return h};return e}(u)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n){function f(ea){switch(ea){case "Butt":return m.CapType.BUTT;case "Square":return m.CapType.SQUARE;default:return m.CapType.ROUND}}function q(ea){switch(ea){case "Bevel":return m.JoinType.BEVEL;case "Miter":return m.JoinType.MITER;default:return m.JoinType.ROUND}}function p(ea,L,M,ba){let ca;ea[L]?ca=ea[L]:(ca={},ea[L]=ca);ca[M]=ba}function z(ea){return(ea=ea.markerPlacement)&&ea.angleToLine?m.Alignment.MAP:m.Alignment.SCREEN}function w(){w=t._asyncToGenerator(function*(ea,
L,M,ba,ca){ba=ba??[];if(!ea)return ba;let ma;const W={};if("CIMSymbolReference"===ea.type){if(ma=ea.symbol,ea=ea.primitiveOverrides){var Y=[];for(const ja of ea){var da=ja.valueExpressionInfo;da&&L?(da=d.createRendererExpression(da.expression,L.spatialReference,L.fields).then(pa=>{x.isNone(pa)||p(W,ja.primitiveName,ja.propertyName,pa)}),Y.push(da)):null!=ja.value&&p(W,ja.primitiveName,ja.propertyName,ja.value)}0<Y.length&&(yield Promise.all(Y))}}else return wa.error("Expect cim type to be 'CIMSymbolReference'"),
ba;Y=[];l.CIMSymbolHelper.fetchResources(ma,M,Y);0<Y.length&&(yield Promise.all(Y));switch(ma.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":y(ma,ea,W,L,ba,M,ca)}return ba});return w.apply(this,arguments)}function y(ea,L,M,ba,ca,ma,W){if(ea){var Y=ea.symbolLayers;if(Y){var da=ea.effects,ja=l.CIMSymbolHelper.getSize(ea);if("CIMPointSymbol"===ea.type&&"Map"===ea.angleAlignment)var pa=m.Alignment.MAP;for(var sa=Y.length;sa--;){var ta=Y[sa];if(!ta||!1===ta.enable)continue;let Oa;
da&&da.length&&(Oa=[...da]);var ya=ta.effects;ya&&ya.length&&(da?Oa.push(...ya):Oa=[...ya]);ya=[];l.OverrideHelper.findEffectOverrides(Oa,L,ya);ya=0<ya.length?R(Oa,ya,M,ba):Oa;var za=[];l.OverrideHelper.findApplicableOverrides(ta,L,za);switch(ta.type){case "CIMSolidFill":G(ta,ya,M,za,ba,ca);break;case "CIMPictureFill":H(ta,ya,M,za,ba,ma,ca);break;case "CIMHatchFill":I(ta,ya,M,za,ba,ca);break;case "CIMGradientFill":var la=M,oa=ba,va=ca;const [Za,$a]=ia(za,ta.primitiveName,ya,null,null);var Ca=h.numericHash(JSON.stringify(ta)+
$a).toString();va.push({type:"fill",templateHash:Ca,materialHash:Za?ka(Ca,la,za,oa):Ca,cim:ta,materialOverrides:null,colorLocked:ta.colorLocked,effects:ya,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1});break;case "CIMSolidStroke":D(ta,ya,M,za,ba,ca,"CIMPolygonSymbol"===ea.type,ja);break;case "CIMPictureStroke":C(ta,ya,M,za,ba,ca,"CIMPolygonSymbol"===ea.type,ja);break;case "CIMGradientStroke":la=M;oa=ba;va=ca;Ca="CIMPolygonSymbol"===
ea.type;var Fa=ja,Ja=ta.primitiveName,Ka=void 0!==ta.width?ta.width:4,Ia=f(ta.capStyle),Ma=q(ta.joinStyle),Ba=ta.miterLimit;const [N,Wa]=ia(za,Ja,ya,null,null),Ra=h.numericHash(JSON.stringify(ta)+Wa).toString();va.push({type:"line",templateHash:Ra,materialHash:N?ka(Ra,la,za,oa):Ra,cim:ta,materialOverrides:null,isOutline:Ca,colorLocked:ta.colorLocked,effects:ya,color:{r:128,g:128,b:128,a:1},width:Q(Ja,la,"Width",oa,Ka),cap:Q(Ja,la,"CapStyle",oa,Ia),join:Q(Ja,la,"JoinStyle",oa,Ma),miterLimit:Q(Ja,la,
"MiterLimit",oa,Ba),referenceWidth:Fa,zOrder:ha(ta.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":F(ta,ya,M,za,ba,ca);break;case "CIMPictureMarker":if(F(ta,ya,M,za,ba,ca))break;"CIMLineSymbol"===ea.type&&(pa=z(ta));K(ta,ya,M,za,ba,ma,ca,pa,ja);break;case "CIMVectorMarker":if(F(ta,ya,M,za,ba,ca))break;"CIMLineSymbol"===ea.type&&(pa=z(ta));la=M;oa=ba;va=ca;Ca=ma;Fa=pa;Ja=ja;Ka=W;if(Ma=ta.markerGraphics){Ia=0;ta.scaleSymbolsProportionally&&(Ba=ta.frame)&&(Ia=
Ba.ymax-Ba.ymin);Ba=V(ta.markerPlacement,za,la,oa);for(const bb of Ma)if(bb&&(Ma=bb.symbol))switch(Ma.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":P(ta,ya,Ba,null,bb,za,la,oa,va,Ca,Fa,Ja,Ia,Ka);break;case "CIMTextSymbol":J(ta,ya,Ba,bb,la,za,oa,va,Fa,Ja,Ia)}}break;default:wa.error("Cannot analyze CIM layer",ta.type)}}}}}function G(ea,L,M,ba,ca,ma){const W=ea.primitiveName,Y=c.fromCIMColor(ea.color),[da,ja]=ia(ba,W,L,null,null),pa=h.numericHash(JSON.stringify(ea)+ja).toString();
ma.push({type:"fill",templateHash:pa,materialHash:da?()=>pa:pa,cim:ea,materialOverrides:null,colorLocked:ea.colorLocked,color:Q(W,M,"Color",ca,Y,U),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:L,applyRandomOffset:!1,sampleAlphaOnly:!0})}function H(ea,L,M,ba,ca,ma,W){const Y=ea.primitiveName,da=ea.tintColor?c.fromCIMColor(ea.tintColor):{r:255,g:255,b:255,a:1},[ja,pa]=ia(ba,Y,L,null,null);ba=h.numericHash(JSON.stringify(ea)+pa).toString();const sa=h.numericHash(`${ea.url}${JSON.stringify(ea.colorSubstitutions)}`).toString();
let ta=c.getValue(ea.scaleX);if("width"in ea){const ya=ea.width;let za=1;ma=ma.getResource(ea.url);x.isSome(ma)&&(za=ma.width/ma.height);ta/=ea.height/ya*za}W.push({type:"fill",templateHash:ba,materialHash:ja?()=>sa:sa,cim:ea,materialOverrides:null,colorLocked:ea.colorLocked,effects:L,color:Q(Y,M,"TintColor",ca,da,U),height:Q(Y,M,"Height",ca,ea.height),scaleX:Q(Y,M,"ScaleX",ca,ta),angle:Q(Y,M,"Rotation",ca,c.getValue(ea.rotation)),offsetX:Q(Y,M,"OffsetX",ca,c.getValue(ea.offsetX)),offsetY:Q(Y,M,"OffsetY",
ca,c.getValue(ea.offsetY)),url:ea.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function I(ea,L,M,ba,ca,ma){const W=["Rotation","OffsetX","OffsetY"],Y=ba.filter(ya=>ya.primitiveName!==ea.primitiveName||!W.includes(ya.propertyName)),da=ea.primitiveName,[ja,pa]=ia(ba,da,L,null,null);ba=h.numericHash(JSON.stringify(ea)+pa).toString();const sa=h.numericHash(`${ea.separation}${JSON.stringify(ea.lineSymbol)}`).toString();let ta={r:255,g:255,b:255,a:1};if(ea.lineSymbol){const ya=ea.lineSymbol?.symbolLayers.find(za=>
"CIMSolidStroke"===za.type);ya&&(ta=c.fromCIMColor(ya.color))}ma.push({type:"fill",templateHash:ba,materialHash:ja?ka(sa,M,Y,ca):sa,cim:ea,materialOverrides:Y,colorLocked:ea.colorLocked,effects:L,color:ta,height:Q(da,M,"Separation",ca,ea.separation),scaleX:1,angle:Q(da,M,"Rotation",ca,c.getValue(ea.rotation)),offsetX:Q(da,M,"OffsetX",ca,c.getValue(ea.offsetX)),offsetY:Q(da,M,"OffsetY",ca,c.getValue(ea.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function D(ea,L,M,ba,ca,ma,W,Y){const da=ea.primitiveName,
ja=c.fromCIMColor(ea.color),pa=void 0!==ea.width?ea.width:4,sa=f(ea.capStyle),ta=q(ea.joinStyle),ya=ea.miterLimit,[za,la]=ia(ba,da,L,null,null),oa=h.numericHash(JSON.stringify(ea)+la).toString();let va;if(L&&L instanceof Array&&0<L.length&&(ba=L[L.length-1],"CIMGeometricEffectDashes"===ba.type&&"NoConstraint"===ba.lineDashEnding&&null===ba.offsetAlongLine)){L=[...L];var Ca=L.pop();va=Ca.dashTemplate;Ca=Ca.scaleDash}ma.push({type:"line",templateHash:oa,materialHash:za?()=>oa:oa,cim:ea,materialOverrides:null,
isOutline:W,colorLocked:ea.colorLocked,effects:L,color:Q(da,M,"Color",ca,ja,U),width:Q(da,M,"Width",ca,pa),cap:Q(da,M,"CapStyle",ca,sa),join:Q(da,M,"JoinStyle",ca,ta),miterLimit:Q(da,M,"MiterLimit",ca,ya),referenceWidth:Y,zOrder:ha(ea.name),dashTemplate:va,scaleDash:Ca,sampleAlphaOnly:!0})}function C(ea,L,M,ba,ca,ma,W,Y){const da=h.numericHash(`${ea.url}${JSON.stringify(ea.colorSubstitutions)}`).toString(),ja=ea.primitiveName,pa=c.fromCIMColor(ea.tintColor),sa=void 0!==ea.width?ea.width:4,ta=f(ea.capStyle),
ya=q(ea.joinStyle),za=ea.miterLimit,[la,oa]=ia(ba,ja,L,null,null);ba=h.numericHash(JSON.stringify(ea)+oa).toString();ma.push({type:"line",templateHash:ba,materialHash:la?()=>da:da,cim:ea,materialOverrides:null,isOutline:W,colorLocked:ea.colorLocked,effects:L,color:Q(ja,M,"TintColor",ca,pa,U),width:Q(ja,M,"Width",ca,sa),cap:Q(ja,M,"CapStyle",ca,ta),join:Q(ja,M,"JoinStyle",ca,ya),miterLimit:Q(ja,M,"MiterLimit",ca,za),referenceWidth:Y,zOrder:ha(ea.name),dashTemplate:null,scaleDash:!1,url:ea.url,sampleAlphaOnly:!1})}
function F(ea,L,M,ba,ca,ma){const W=ea.markerPlacement;if(!W||"CIMMarkerPlacementInsidePolygon"!==W.type)return!1;var Y=Math.abs(W.stepX),da=Math.abs(W.stepY);if(0===Y||0===da)return!0;const ja=["Rotation","OffsetX","OffsetY"],pa=ba.filter(oa=>oa.primitiveName!==ea.primitiveName||!ja.includes(oa.propertyName)),sa="url"in ea?ea.url:null,[ta,ya]=ia(ba,W.primitiveName,L,null,null);ba=h.numericHash(JSON.stringify(ea)+ya).toString();let za=null;if("Random"===W.gridType){var la=e.px2pt(g.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);
const oa=Math.max(Math.floor(la/Y),1),va=Math.max(Math.floor(la/da),1);la=da*va;za=Ca=>Ca?Ca*va:0;Y=oa*Y/la}else W.shiftOddRows?(la=2*da,za=oa=>oa?2*oa:0,Y=Y/da*.5):(la=da,za=null,Y/=da);da={r:255,g:255,b:255,a:1};"tintColor"in ea&&(da=c.fromCIMColor(ea.tintColor));ma.push({type:"fill",templateHash:ba,materialHash:ta?ka(ba,M,pa,ca):ba,cim:ea,materialOverrides:pa,colorLocked:ea.colorLocked,effects:L,color:Q(W.primitiveName,M,"TintColor",ca,da,U),height:Q(W.primitiveName,M,"StepY",ca,la,za),scaleX:Y,
angle:Q(W.primitiveName,M,"GridAngle",ca,W.gridAngle),offsetX:Q(W.primitiveName,M,"OffsetX",ca,c.getValue(W.offsetX)),offsetY:Q(W.primitiveName,M,"OffsetY",ca,c.getValue(W.offsetY)),url:sa,applyRandomOffset:"Random"===W.gridType,sampleAlphaOnly:!sa});return!0}function K(ea,L,M,ba,ca,ma,W,Y,da){const ja=ea.primitiveName,pa=c.getValue(ea.size);let sa=c.getValue(ea.scaleX,1);const ta=c.getValue(ea.rotation),ya=c.getValue(ea.offsetX),za=c.getValue(ea.offsetY),la=ea.tintColor?c.fromCIMColor(ea.tintColor):
{r:255,g:255,b:255,a:1},oa=h.numericHash(`${ea.url}${JSON.stringify(ea.colorSubstitutions)}${JSON.stringify(ea.animatedSymbolProperties)}`).toString(),va=V(ea.markerPlacement,ba,M,ca),Ca=Z(ea.animatedSymbolProperties,ba,M,ca),[Fa,Ja]=ia(ba,ja,L,va,Ca);ba=h.numericHash(JSON.stringify(ea)+Ja).toString();const Ka=ea.anchorPoint??{x:0,y:0};if("width"in ea){const Ia=ea.width;let Ma=1;ma=ma.getResource(ea.url);x.isSome(ma)&&(Ma=ma.width/ma.height);sa/=pa/Ia*Ma}W.push({type:"marker",templateHash:ba,materialHash:ea.animatedSymbolProperties&&
!0===ea.animatedSymbolProperties.randomizeStartTime?(Ia,Ma,Ba,Oa)=>{Ba=n.getMaterialGroup(Oa);Ia=c.evaluateValueOrFunction(Ca,Ia,Ma);return oa+`-MATERIALGROUP(${Ba})`+`-ASP(${JSON.stringify(Ia)})`}:Fa?(Ia,Ma)=>{Ia=c.evaluateValueOrFunction(Ca,Ia,Ma);return oa+`-ASP(${JSON.stringify(Ia)})`}:oa,cim:ea,materialOverrides:null,colorLocked:ea.colorLocked,effects:L,scaleSymbolsProportionally:!1,alignment:Y,size:Q(ja,M,"Size",ca,pa),scaleX:Q(ja,M,"ScaleX",ca,sa),rotation:Q(ja,M,"Rotation",ca,ta),offsetX:Q(ja,
M,"OffsetX",ca,ya),offsetY:Q(ja,M,"OffsetY",ca,za),color:Q(ja,M,"TintColor",ca,la,U),anchorPoint:{x:Ka.x,y:-Ka.y},isAbsoluteAnchorPoint:"Relative"!==ea.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:ea.rotateClockwise,referenceSize:da,sizeRatio:1,markerPlacement:va,url:ea.url,animatedSymbolProperties:Ca})}function J(ea,L,M,ba,ca,ma,W,Y,da,ja,pa){l.OverrideHelper.findApplicableOverrides(ba,ma,[]);var sa=ba.geometry;if("x"in sa&&"y"in sa){var ta=ba.symbol,
ya=c.fromCIMFontDecoration(ta),za=c.fromCIMFontStyle(ta.fontStyleName),la=B.getFontFamily(ta.fontFamilyName);ta.font={family:la,decoration:ya,...za};var oa=ea.frame,va=sa.x-.5*(oa.xmin+oa.xmax),Ca=sa.y-.5*(oa.ymin+oa.ymax),Fa=ea.size/pa;pa=ea.primitiveName;sa=c.getValue(ta.height)*Fa;oa=c.getValue(ta.angle);va=c.getValue(ea.offsetX)+(c.getValue(ta.offsetX)+va)*Fa;Ca=c.getValue(ea.offsetY)+(c.getValue(ta.offsetY)+Ca)*Fa;var Ja=c.fromCIMColor(c.getFillColor(ta)),Ka=c.fromCIMColor(c.getStrokeColor(ta)),
Ia=c.getStrokeWidth(ta);Ia||(Ka=c.fromCIMColor(c.getFillColor(ta.haloSymbol)),Ia=ta.haloSize*Fa);var [Ma,Ba]=ia(ma,pa,L,M,null);ma=JSON.stringify(ea.effects)+Number(ea.colorLocked).toString()+JSON.stringify(ea.anchorPoint)+ea.anchorPointUnits+JSON.stringify(ea.markerPlacement)+ea.size.toString();ma=h.numericHash(JSON.stringify(ba)+ma+Ba).toString();var Oa=Q(ba.primitiveName,ca,"TextString",W,ba.textString,c.adjustTextCase,ta.textCase);if(null!=Oa){({fontStyleName:ba}=ta);var Za=la+(ba?"-"+ba.toLowerCase():
"-regular");"string"===typeof Oa&&Oa.includes("[")&&ta.fieldMap&&(Oa=c.createLabelOverrideFunction(ta.fieldMap,Oa,ta.textCase));Y.push({type:"text",templateHash:ma,materialHash:Ma||"function"===typeof Oa||Oa.match(/\[(.*?)\]/)?($a,N,Wa)=>Za+"-"+c.evaluateValueOrFunction(Oa,$a,N,Wa):Za+"-"+h.numericHash(Oa),cim:ta,materialOverrides:null,colorLocked:ea.colorLocked,effects:L,alignment:da,anchorPoint:{x:ea.anchorPoint?ea.anchorPoint.x:0,y:ea.anchorPoint?ea.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==
ea.anchorPointUnits,fontName:Za,decoration:ya,weight:Q(pa,ca,"Weight",W,za.weight),style:Q(pa,ca,"Size",W,za.style),size:Q(pa,ca,"Size",W,sa),angle:Q(pa,ca,"Rotation",W,oa),offsetX:Q(pa,ca,"OffsetX",W,va),offsetY:Q(pa,ca,"OffsetY",W,Ca),horizontalAlignment:c.fromCIMHorizontalAlignment(ta.horizontalAlignment),verticalAlignment:c.fromCIMVerticalAlignment(ta.verticalAlignment),text:Oa,color:Ja,outlineColor:Ka,outlineSize:Ia,referenceSize:ja,sizeRatio:1,markerPlacement:M})}}}function P(ea,L,M,ba,ca,ma,
W,Y,da,ja,pa,sa,ta,ya){var za=ca.symbol;const la=za.symbolLayers;if(la)if(ya)X(ea,L,M,ba,ca,W,ma,Y,da,ja,pa,sa,ta);else if(ya=la.length,la&&2===la.length&&la[0].enable&&la[1].enable&&"CIMSolidStroke"===la[0].type&&"CIMSolidFill"===la[1].type&&!la[0].effects&&!la[1].effects)S(ea,L,M,ba,ca,la,ma,W,Y,da,pa,sa,ta);else if(za=b.CIMEffectHelper.applyEffects(za.effects,ca.geometry,ja.geometryEngine))for(;ya--;){var oa=la[ya];if(oa&&!1!==oa.enable)switch(oa.type){case "CIMSolidFill":case "CIMSolidStroke":var va=
b.CIMEffectHelper.applyEffects(oa.effects,za,ja.geometryEngine),Ca=k.getExtent(va);if(!Ca)continue;const Ka="Relative"!==ea.anchorPointUnits,[Ia,Ma,Ba]=k.getSDFMetrics(Ca,ea.frame,ea.size,ea.anchorPoint,Ka);var Fa="CIMSolidFill"===oa.type;va={type:"sdf",geom:va,asFill:Fa};var Ja=ea.primitiveName;Ca=c.getValue(ea.size)??10;const Oa=c.getValue(ea.rotation),Za=c.getValue(ea.offsetX),$a=c.getValue(ea.offsetY),N=oa.path,Wa=oa.primitiveName,Ra=Fa?c.fromCIMColor(c.getFillColor(oa)):c.fromCIMColor(c.getStrokeColor(oa)),
bb=Fa?{r:0,g:0,b:0,a:0}:c.fromCIMColor(c.getStrokeColor(oa)),cb=c.getStrokeWidth(oa);if(!Fa&&!cb)break;Fa=!1;let Sa="";for(const ob of ma)if(ob.primitiveName===Wa||ob.primitiveName===Ja)void 0!==ob.value?Sa+=`-${ob.primitiveName}-${ob.propertyName}-${JSON.stringify(ob.value)}`:ob.valueExpressionInfo&&(Fa=!0);x.isSome(L)&&"function"===typeof L&&(Fa=!0);Ja=JSON.stringify({...ea,markerGraphics:null});const jb=h.numericHash(JSON.stringify(va)+N).toString();oa={type:"marker",templateHash:h.numericHash(JSON.stringify(ca)+
JSON.stringify(oa)+Ja+Sa).toString(),materialHash:Fa?()=>jb:jb,cim:va,materialOverrides:null,colorLocked:ea.colorLocked,effects:L,scaleSymbolsProportionally:ea.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:Ma,y:Ba},isAbsoluteAnchorPoint:Ka,size:Q(ea.primitiveName,W,"Size",Y,Ca),rotation:Q(ea.primitiveName,W,"Rotation",Y,Oa),offsetX:Q(ea.primitiveName,W,"OffsetX",Y,Za),offsetY:Q(ea.primitiveName,W,"OffsetY",Y,$a),scaleX:1,frameHeight:ta,rotateClockwise:ea.rotateClockwise,referenceSize:sa,
sizeRatio:Ia,color:Q(Wa,W,"Color",Y,Ra,U),outlineColor:Q(Wa,W,"Color",Y,bb,U),outlineWidth:Q(Wa,W,"Width",Y,cb),markerPlacement:M,animatedSymbolProperties:ba,path:N};da.push(oa);break;default:X(ea,L,M,ba,ca,W,ma,Y,da,ja,pa,sa,ta)}}}function S(ea,L,M,ba,ca,ma,W,Y,da,ja,pa,sa,ta){var ya=ca.geometry;const za=ma[0];ma=ma[1];var la=k.getExtent(ya);if(la){var oa="Relative"!==ea.anchorPointUnits,[va,Ca,Fa]=k.getSDFMetrics(la,ea.frame,ea.size,ea.anchorPoint,oa);ya={type:"sdf",geom:ya,asFill:!0};var Ja=ea.primitiveName;
la=c.getValue(ea.size);var Ka=c.getValue(ea.rotation),Ia=c.getValue(ea.offsetX),Ma=c.getValue(ea.offsetY),Ba=ma.path,Oa=ma.primitiveName,Za=za.primitiveName,$a=c.fromCIMColor(c.getFillColor(ma)),N=c.fromCIMColor(c.getStrokeColor(za)),Wa=c.getStrokeWidth(za),Ra=!1,bb="";for(const Sa of W)if(Sa.primitiveName===Oa||Sa.primitiveName===Za||Sa.primitiveName===Ja)void 0!==Sa.value?bb+=`-${Sa.primitiveName}-${Sa.propertyName}-${JSON.stringify(Sa.value)}`:Sa.valueExpressionInfo&&(Ra=!0);W=JSON.stringify({...ea,
markerGraphics:null});var cb=h.numericHash(JSON.stringify(ya)+Ba).toString();ea={type:"marker",templateHash:h.numericHash(JSON.stringify(ca)+JSON.stringify(ma)+JSON.stringify(za)+W+bb).toString(),materialHash:Ra?()=>cb:cb,cim:ya,materialOverrides:null,colorLocked:ea.colorLocked,effects:L,scaleSymbolsProportionally:ea.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:Ca,y:Fa},isAbsoluteAnchorPoint:oa,size:Q(ea.primitiveName,Y,"Size",da,la),rotation:Q(ea.primitiveName,Y,"Rotation",da,Ka),offsetX:Q(ea.primitiveName,
Y,"OffsetX",da,Ia),offsetY:Q(ea.primitiveName,Y,"OffsetY",da,Ma),scaleX:1,frameHeight:ta,rotateClockwise:ea.rotateClockwise,referenceSize:sa,sizeRatio:va,color:Q(Oa,Y,"Color",da,$a,U),outlineColor:Q(Za,Y,"Color",da,N,U),outlineWidth:Q(Za,Y,"Width",da,Wa),markerPlacement:M,path:Ba,animatedSymbolProperties:ba};ja.push(ea)}}function X(ea,L,M,ba,ca,ma,W,Y,da,ja,pa,sa,ta){ca={type:ea.type,enable:!0,name:ea.name,colorLocked:ea.colorLocked,primitiveName:ea.primitiveName,anchorPoint:ea.anchorPoint,anchorPointUnits:ea.anchorPointUnits,
offsetX:0,offsetY:0,rotateClockwise:ea.rotateClockwise,rotation:0,size:ea.size,billboardMode3D:ea.billboardMode3D,depth3D:ea.depth3D,frame:ea.frame,markerGraphics:[ca],scaleSymbolsProportionally:ea.scaleSymbolsProportionally,respectFrame:ea.respectFrame,clippingPath:ea.clippingPath};const ya=["Rotation","OffsetX","OffsetY"],za=W.filter(Ia=>Ia.primitiveName!==ea.primitiveName||!ya.includes(Ia.propertyName));var la="";for(var oa of W)void 0!==oa.value&&(la+=`-${oa.primitiveName}-${oa.propertyName}-${JSON.stringify(oa.value)}`);
const [va,Ca,Fa]=l.CIMSymbolHelper.getTextureAnchor(ca,ja);W=ea.primitiveName;ja=c.getValue(ea.rotation);oa=c.getValue(ea.offsetX);const Ja=c.getValue(ea.offsetY);la=h.numericHash(JSON.stringify(ca)+la).toString();const Ka=0<za.length||x.isSome(L)&&"function"===typeof L;L={type:"marker",templateHash:la,materialHash:Ka?ka(la,ma,za,Y):la,cim:ca,materialOverrides:za,colorLocked:ea.colorLocked,effects:L,scaleSymbolsProportionally:ea.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:va,y:Ca},isAbsoluteAnchorPoint:!1,
size:ea.size,rotation:Q(W,ma,"Rotation",Y,ja),offsetX:Q(W,ma,"OffsetX",Y,oa),offsetY:Q(W,ma,"OffsetY",Y,Ja),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ta,rotateClockwise:ea.rotateClockwise,referenceSize:sa,sizeRatio:Fa/e.pt2px(ea.size),markerPlacement:M,animatedSymbolProperties:ba};da.push(L)}function ha(ea){return ea&&0===ea.indexOf("Level_")&&(ea=parseInt(ea.substr(6),10),!isNaN(ea))?ea:0}function U(ea){if(!ea||0===ea.length)return null;ea=(new E(ea)).toRgba();
return{r:ea[0],g:ea[1],b:ea[2],a:ea[3]}}function Q(ea,L,M,ba,ca,ma,W){if(ea=L[ea]){const Y=ea[M];if("string"===typeof Y||"number"===typeof Y||Y instanceof Array)return ma?ma.call(null,Y,W):Y;if(null!=Y&&Y instanceof d.ArcadeExpression)return(da,ja,pa)=>{da=a(Y,da,{$view:pa},ba.geometryType,ja);null!==da&&ma&&(da=ma.call(null,da,W));return null!==da?da:ca}}return ca}function O(ea){return ea?ea.charAt(0).toLowerCase()+ea.substr(1):ea}function R(ea,L,M,ba){for(const ca of L)if(ca.valueExpressionInfo){const ma=
M[ca.primitiveName]&&M[ca.primitiveName][ca.propertyName];ma instanceof d.ArcadeExpression&&(ca.fn=(W,Y,da)=>a(ma,W,{$view:da},ba.geometryType,Y))}return(ca,ma,W)=>{for(var Y of L)Y.fn&&(Y.value=Y.fn(ca,ma,W));ca=[];for(let da of ea){if(ma=da?.primitiveName){W=!1;for(const ja of L)ja.primitiveName===ma&&(Y=O(ja.propertyName),null!=ja.value&&ja.value!==da[Y]&&(W||(da=u.clone(da),W=!0),da[Y]=ja.value))}ca.push(da)}return ca}}function V(ea,L,M,ba){const ca=[];l.OverrideHelper.findApplicableOverrides(ea,
L,ca);if(0===ca.length)return ea;for(const ma of ca)if(ma.valueExpressionInfo){const W=M[ma.primitiveName]&&M[ma.primitiveName][ma.propertyName];W instanceof d.ArcadeExpression&&(ma.fn=(Y,da,ja)=>a(W,Y,{$view:ja},ba.geometryType,da))}return(ma,W,Y)=>{for(const da of ca)da.fn&&(da.value=da.fn(ma,W,Y));ma=u.clone(ea);W=ea.primitiveName;for(const da of ca)da.primitiveName===W&&(Y=O(da.propertyName),null!=da.value&&da.value!==ma[Y]&&(ma[Y]=da.value));return ma}}function Z(ea,L,M,ba){const ca=[];l.OverrideHelper.findApplicableOverrides(ea,
L,ca);if(0===ca.length)return ea;for(const ma of ca)if(ma.valueExpressionInfo){const W=M[ma.primitiveName]&&M[ma.primitiveName][ma.propertyName];W instanceof d.ArcadeExpression&&(ma.fn=(Y,da,ja)=>a(W,Y,{$view:ja},ba.geometryType,da))}return(ma,W,Y)=>{for(var da of ca)da.fn&&(da.value=da.fn(ma,W,Y));ma=u.clone(ea);W=ea.primitiveName;for(const ja of ca)ja.primitiveName===W&&(Y=O(ja.propertyName),null!=ja.value&&(da=r.quantizeIfNeeded(ja.value,ja.propertyName),da!==ma[Y]&&(ma[Y]=da)));return ma}}function ka(ea,
L,M,ba){for(const ca of M)if(ca.valueExpressionInfo){const ma=L[ca.primitiveName]&&L[ca.primitiveName][ca.propertyName];ma instanceof d.ArcadeExpression&&(ca.fn=(W,Y,da)=>a(ma,W,{$view:da},ba.geometryType,Y))}return(ca,ma,W)=>{for(const Y of M)Y.fn&&(Y.value=Y.fn(ca,ma,W));return h.numericHash(ea+l.OverrideHelper.buildOverrideKey(M)).toString()}}function ia(ea,L,M,ba,ca){let ma=!1,W="";for(const Y of ea)Y.primitiveName===L&&(void 0!==Y.value?W+=`-${Y.primitiveName}-${Y.propertyName}-${JSON.stringify(Y.value)}`:
Y.valueExpressionInfo&&(ma=!0));x.isSome(M)&&"function"===typeof M&&(ma=!0);x.isSome(ba)&&"function"===typeof ba&&(ma=!0);x.isSome(ca)&&"function"===typeof ca&&(ma=!0);return[ma,W]}const wa=A.getLogger("esri.symbols.cim.cimAnalyzer");v.analyzeCIMResource=function(ea,L){if(!L||0===L.length)return ea;ea=u.clone(ea);l.OverrideHelper.applyOverrides(ea,L);return ea};v.analyzeCIMSymbol=function(ea,L,M,ba,ca){return w.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/core/fontUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../config"],function(v,t,E){function B(){B=t._asyncToGenerator(function*(e){const h=A(e);let d=x.get(h);if(d)return d;e=new FontFace(e.family,`url('${E.fontsUrl}/woff2/${h}.${"woff2"}') format('${"woff2"}')`);const l=document.fonts;if(l.has(e)&&"loading"===e.status)return e.loaded;d=e.load();x.set(h,d);l.add(e);return d});return B.apply(this,arguments)}function u(e){if(!e)return"arial-unicode-ms";e=e.toLowerCase().split(" ").join("-");
switch(e){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return e}}function A(e){a:{if(e.weight)switch(e.weight.toLowerCase()){case "bold":case "bolder":var h="-bold";break a}h=""}a:{if(e.style)switch(e.style.toLowerCase()){case "italic":case "oblique":var d="-italic";break a}d=""}h+=d;return u(e.family)+(0<h.length?h:"-regular")}const x=new Map;v.getFontDecorationTop=
function(e){switch(e){case "underline":return-26;case "line-through":return-18}return NaN};v.getFontFamily=u;v.getFullyQualifiedFontName=A;v.loadFont=function(e){return B.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f){function q(R,V,Z){switch(V.type){case "CIMSymbolReference":return q(R,V.symbol,Z);case "CIMPointSymbol":null==Z&&(Z={x:0,y:0});R.drawSymbol(V,Z);break;case "CIMLineSymbol":null==Z&&(Z={paths:[[[0,0],[10,0]]]});R.drawSymbol(V,Z);break;case "CIMPolygonSymbol":null==Z&&(Z={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});R.drawSymbol(V,Z);break;case "CIMTextSymbol":R.drawSymbol(V,{x:0,y:0});break;case "CIMVectorMarker":Z=new r.Placement,R.drawMarker(V,Z)}return R.envelope()}
function p(R){if(!R)return 0;switch(R.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(R.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(R.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(R.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(R.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(R.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(R.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(R.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function z(R){if(!R)return 0;switch(R.type){case "CIMGeometricEffectArrow":return Math.abs(.5*R.width);case "CIMGeometricEffectBuffer":return Math.abs(R.size);case "CIMGeometricEffectExtension":return Math.abs(R.length);case "CIMGeometricEffectJog":return Math.abs(.5*R.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(b.getValue(R.offsetX)),Math.abs(b.getValue(R.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(R.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(R.offset);case "CIMGeometricEffectRadial":return Math.abs(R.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(R.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(R.fromWidth),Math.abs(R.toWidth));case "CIMGeometricEffectWave":return Math.abs(R.amplitude);default:return 0}}function w(R){if(!R)return 0;let V=0;for(const Z of R)V+=
z(Z);return V}function y(R,V,Z){R.effects&&!x.isSome(V.geometryEngine)&&(O?Z.push(O):b.isGeometryEngineRequired(R.effects)&&(O=b.importGeometryEngine(),Z.push(O),O.then(ka=>V.geometryEngine=ka)))}const G=Math.PI,H=G/2,I=96/72,D=Math.PI/180,C=A.getLogger("esri.symbols.cim.CIMSymbolHelper");A=function(){function R(){}var V=R.prototype;V.getSymbolInflateSize=function(Z,ka,ia,wa,ea){Z||(Z=[0,0,0,0]);return ka?this._getInflateSize(Z,ka,ia,wa,ea):Z};R.safeSize=function(Z){const ka=Math.max(Math.abs(Z[0]),
Math.abs(Z[2]));Z=Math.max(Math.abs(Z[1]),Math.abs(Z[3]));return Math.sqrt(ka*ka+Z*Z)};V._vectorMarkerBounds=function(Z,ka,ia,wa){let ea=!0;const L=d.create();if(ka&&ka.markerGraphics)for(const M of ka.markerGraphics)ka=[0,0,0,0],M.geometry&&(l.getBoundsXY(L,M.geometry),ka[0]=0,ka[1]=0,ka[2]=0,ka[3]=0,this.getSymbolInflateSize(ka,M.symbol,ia,0,wa),L[0]+=ka[0],L[1]+=ka[1],L[2]+=ka[2],L[3]+=ka[3],ea?(Z[0]=L[0],Z[1]=L[1],Z[2]=L[2],Z[3]=L[3],ea=!1):(Z[0]=Math.min(Z[0],L[0]),Z[1]=Math.min(Z[1],L[1]),Z[2]=
Math.max(Z[2],L[2]),Z[3]=Math.max(Z[3],L[3])));return Z};V._getInflateSize=function(Z,ka,ia,wa,ea){return void 0!==ka.symbolLayers?(Z=this._getLayersInflateSize(Z,ka.symbolLayers,ia,wa,ea),ka=w(ka.effects),0<ka&&(Z[0]-=ka,Z[1]-=ka,Z[2]+=ka,Z[3]+=ka),Z):this._getTextInflatedSize(Z,ka,ea)};V._getLayersInflateSize=function(Z,ka,ia,wa,ea){let L=!0;if(!ka)return Z;for(const Y of ka)if(Y){var M=[0,0,0,0];switch(Y.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":ka=Y;var ba=ka.width;
ba=ka.capStyle===c.LineCapStyle.Square||ka.joinStyle===c.LineJoinStyle.Miter?ba/1.4142135623730951:ba/2;M[0]=-ba;M[1]=-ba;M[2]=ba;M[3]=ba;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":ka=Y;if("CIMVectorMarker"===Y.type){if(ba=Y,M=this._vectorMarkerBounds(M,ba,ia,ea),ba.frame){var ca=(ba.frame.xmin+ba.frame.xmax)/2,ma=(ba.frame.ymin+ba.frame.ymax)/2;M[0]-=ca;M[1]-=ma;M[2]-=ca;M[3]-=ma;ba=ba.size/(ba.frame.ymax-ba.frame.ymin);M[0]*=ba;M[1]*=ba;M[2]*=ba;M[3]*=ba}}else"CIMPictureMarker"===
Y.type?(M=Y,ca=ia.getResource(M.url),ba=1,x.isSome(ca)&&ca.height&&(ba=ca.width/ca.height),ca=ka.size/2,M=ka.size*ba*M.scaleX/2,M=[-M,-ca,M,ca]):(M=ka.size/2,M=[-M,-M,M,M]);ka.anchorPoint&&("Absolute"===ka.anchorPointUnits?(ba=ka.anchorPoint.x,ca=ka.anchorPoint.y):(ba=ka.anchorPoint.x*(M[2]-M[0]),ca=ka.anchorPoint.y*(M[3]-M[1])),M[0]-=ba,M[1]-=ca,M[2]-=ba,M[3]-=ca);ba=b.getValue(ka.rotation);ka.rotateClockwise&&(ba=-ba);wa&&(ba-=wa);ba&&(ca=D*ba,ba=Math.cos(ca),ca=Math.sin(ca),ma=d.create([g.C_INFINITY,
g.C_INFINITY,-g.C_INFINITY,-g.C_INFINITY]),d.expandPointInPlace(ma,[M[0]*ba-M[1]*ca,M[0]*ca+M[1]*ba]),d.expandPointInPlace(ma,[M[0]*ba-M[3]*ca,M[0]*ca+M[3]*ba]),d.expandPointInPlace(ma,[M[2]*ba-M[1]*ca,M[2]*ca+M[1]*ba]),d.expandPointInPlace(ma,[M[2]*ba-M[3]*ca,M[2]*ca+M[3]*ba]),M=ma);ba=b.getValue(ka.offsetX);ca=b.getValue(ka.offsetY);if(wa){var W=D*wa;ma=Math.cos(W);W=Math.sin(W);const da=ba*W+ca*ma;ba=ba*ma-ca*W;ca=da}M[0]+=ba;M[1]+=ca;M[2]+=ba;M[3]+=ca;ka=p(ka.markerPlacement);0<ka&&(M[0]-=ka,
M[1]-=ka,M[2]+=ka,M[3]+=ka)}ka=w(Y.effects);0<ka&&(M[0]-=ka,M[1]-=ka,M[2]+=ka,M[3]+=ka);L?(Z[0]=M[0],Z[1]=M[1],Z[2]=M[2],Z[3]=M[3],L=!1):(Z[0]=Math.min(Z[0],M[0]),Z[1]=Math.min(Z[1],M[1]),Z[2]=Math.max(Z[2],M[2]),Z[3]=Math.max(Z[3],M[3]))}return Z};V._getTextInflatedSize=function(Z,ka,ia){const wa=ka.height??10;Z[0]=-wa/2;Z[1]=-wa/2;Z[2]=wa/2;Z[3]=wa/2;if(!ia)return Z;ia=ia.get(ka);if(!ia)return Z;const {text:ea,mosaicItem:L}=ia;if(!L||0===L.glyphMosaicItems.length)return Z;ia=k.lineGapType2LineHeight(ka.lineGapType,
ka.lineGap??0,wa);const M=B.bidiText(ea)[1];ka=f.shapeGlyphs(L.glyphMosaicItems,M,{scale:wa/n.GLYPH_SIZE,angle:b.getValue(ka.angle),xOffset:b.getValue(ka.offsetX),yOffset:b.getValue(ka.offsetY),hAlign:k.horizontalAlignment2HAlign(ka.horizontalAlignment),vAlign:k.verticalAlignment2VAlign(ka.verticalAlignment),maxLineWidth:512,lineHeight:n.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(ia||1,4)),decoration:ka.font.decoration||"none",isCIM:!0}).boundsT;Z[0]=ka.x-ka.halfWidth;Z[1]=-ka.y-ka.halfHeight;
Z[2]=ka.x+ka.halfWidth;Z[3]=-ka.y+ka.halfHeight;return Z};return R}();let F=function(){function R(){}R.getEnvelope=function(V,Z,ka){ka=new k.EnvDrawHelper(ka);if(Array.isArray(V)){let ia;for(const wa of V)ia?ia.union(q(ka,wa,Z)):ia=q(ka,wa,Z);return ia}return q(ka,V,Z)};R.getTextureAnchor=function(V,Z){V=this.getEnvelope(V,null,Z);if(!V)return[0,0,0];Z=V.height*I+2;return[-((V.x+.5*V.width)*I)/(V.width*I+2),-((V.y+.5*V.height)*I)/Z,Z]};R.rasterize=function(V,Z,ka,ia,wa=!0){var ea=ka||this.getEnvelope(Z,
null,ia);if(!ea)return[null,0,0,0,0];const L=(ea.x+.5*ea.width)*I,M=(ea.y+.5*ea.height)*I;V.width=ea.width*I;V.height=ea.height*I;ka||(V.width+=2,V.height+=2);ka=V.getContext("2d");ea=k.Transformation.createScale(I,-I);ea.translate(.5*V.width-L,.5*V.height+M);ia=new k.CanvasDrawHelper(ka,ia,ea);switch(Z.type){case "CIMPointSymbol":ia.drawSymbol(Z,{type:"point",x:0,y:0});break;case "CIMVectorMarker":ea=new r.Placement,ia.drawMarker(Z,ea)}Z=ka.getImageData(0,0,V.width,V.height);Z=new Uint8Array(Z.data);
if(wa)for(ia=0;ia<Z.length;ia+=4)wa=Z[ia+3]/255,Z[ia]*=wa,Z[ia+1]*=wa,Z[ia+2]*=wa;return[Z,V.width,V.height,-L/V.width,-M/V.height]};R.fromTextSymbol=function(V){const {angle:Z,color:ka,font:ia,haloColor:wa,haloSize:ea,horizontalAlignment:L,kerning:M,text:ba,verticalAlignment:ca,xoffset:ma,yoffset:W}=V;let Y,da;if(ia){var ja=ia.family;var pa=ia.style;var sa=ia.weight;Y=ia.size;da=ia.decoration}V=!1;ba&&(V=B.bidiText(ba)[1]);var ta=c.BlockProgression.BTT,ya=c.FontEffects.Normal,za=c.FontEncoding.Unicode;
ja=ja||"Arial";b:{if(sa)switch(sa.toLowerCase()){case "bold":case "bolder":sa="bold";break b}sa=""}b:{if(pa)switch(pa.toLowerCase()){case "italic":case "oblique":pa="italic";break b}pa=""}sa=sa&&pa?`${sa}-${pa}`:`${sa}${pa}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",
angle:Z,blockProgression:ta,depth3D:1,extrapolateBaselines:!0,fontEffects:ya,fontEncoding:za,fontFamilyName:ja,fontStyleName:sa,fontType:c.FontType.Unspecified,haloSize:ea,height:Y,hinting:c.GlyphHinting.Default,horizontalAlignment:S(L??"center"),kerning:M,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:b.getValue(ma),offsetY:b.getValue(W),strikethrough:"line-through"===da,underline:"underline"===da,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ha(ka)}]},
haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ha(wa)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:V?c.TextReadingDirection.RTL:c.TextReadingDirection.LTR,verticalAlignment:X(ca??"baseline"),verticalGlyphOrientation:c.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:c.BillBoardMode.FaceNearPlane},textString:ba}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};R.fromPictureFillSymbol=
function(V){const {height:Z,outline:ka,width:ia,xoffset:wa,xscale:ea,yoffset:L,yscale:M}=V,ba=[],ca={type:"CIMPolygonSymbol",symbolLayers:ba};if(ka){const {cap:W,join:Y,miterLimit:da,width:ja}=ka;ba.push({type:"CIMSolidStroke",color:ha(ka.color),capStyle:J(W),joinStyle:P(Y),miterLimit:da,width:ja})}let ma=V.url;"esriPFS"===V.type&&V.imageData&&(ma=V.imageData);V="angle"in V?V.angle:0;ba.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,
url:ma,height:Z*(M||1),width:ia*(ea||1),offsetX:b.getValue(wa),offsetY:b.getValue(L),rotation:b.getValue(-V),colorSubstitutions:null});return ca};R.fromSimpleFillSymbol=function(V){const {color:Z,style:ka,outline:ia}=V;V=[];const wa={type:"CIMPolygonSymbol",symbolLayers:V};var ea=null;if(ia){const {cap:L,join:M,style:ba}=ia;"solid"!==ba&&"none"!==ba&&"esriSLSSolid"!==ba&&"esriSLSNull"!==ba&&(ea=[{type:"CIMGeometricEffectDashes",dashTemplate:U(ba,L),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);
V.push({type:"CIMSolidStroke",color:ha(ia.color),capStyle:J(L),joinStyle:P(M),miterLimit:ia.miterLimit,width:ia.width,effects:ea})}if(ka&&"solid"!==ka&&"none"!==ka&&"esriSFSSolid"!==ka&&"esriSFSNull"!==ka){ea={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:ha(Z),capStyle:c.LineCapStyle.Butt,joinStyle:c.LineJoinStyle.Miter,width:.75}]};let L=0;const M=h.px2pt("vertical"===ka||"horizontal"===ka||"cross"===ka||"esriSFSCross"===ka||"esriSFSVertical"===ka||"esriSFSHorizontal"===ka?8:10);
switch(ka){case "vertical":case "esriSFSVertical":L=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":L=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":L=45;break;case "cross":case "esriSFSCross":L=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":L=-45}V.push({type:"CIMHatchFill",lineSymbol:ea,offsetX:0,offsetY:0,rotation:L,separation:M});"cross"===ka||"esriSFSCross"===ka?V.push({type:"CIMHatchFill",lineSymbol:u.clone(ea),offsetX:0,offsetY:0,rotation:90,separation:M}):
("diagonal-cross"===ka||"esriSFSDiagonalCross"===ka)&&V.push({type:"CIMHatchFill",lineSymbol:u.clone(ea),offsetX:0,offsetY:0,rotation:45,separation:M})}else!ka||"solid"!==ka&&"esriSFSSolid"!==ka||V.push({type:"CIMSolidFill",enable:!0,color:ha(Z)});return wa};R.fromSimpleLineSymbol=function(V){const {cap:Z,color:ka,join:ia,marker:wa,miterLimit:ea,style:L,width:M}=V;V=null;"solid"!==L&&"none"!==L&&"esriSLSSolid"!==L&&"esriSLSNull"!==L&&(V=[{type:"CIMGeometricEffectDashes",dashTemplate:U(L,Z),lineDashEnding:"NoConstraint",
scaleDash:!0,offsetAlongLine:null}]);const ba=[];if(wa){let ca;switch(wa.placement){case "begin-end":ca=c.ExtremityPlacement.Both;break;case "begin":ca=c.ExtremityPlacement.JustBegin;break;case "end":ca=c.ExtremityPlacement.JustEnd;break;default:ca=c.ExtremityPlacement.None}const ma=R.fromSimpleMarker(wa,M,ka).symbolLayers[0];ma.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:ca,offsetAlongLine:0};ba.push(ma)}"none"!==L&&"esriSLSNull"!==L&&ba.push({type:"CIMSolidStroke",
color:ha(ka),capStyle:J(Z),joinStyle:P(ia),miterLimit:ea,width:M,effects:V});return{type:"CIMLineSymbol",symbolLayers:ba}};R.fromPictureMarker=function(V){const {angle:Z,height:ka,width:ia,xoffset:wa,yoffset:ea}=V;let L=V.url;"esriPMS"===V.type&&V.imageData&&(L=V.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:c.TextureFilter.Picture,tintColor:null,url:L,size:ka,width:ia,offsetX:b.getValue(wa),offsetY:b.getValue(ea),rotation:b.getValue(-Z)}]}};
R.fromSimpleMarker=function(V,Z,ka){var {style:ia}=V;ka=V.color??ka;if("path"===ia){Z=[];"outline"in V&&V.outline&&(ia=V.outline,Z.push({type:"CIMSolidStroke",enable:!0,width:h.pt2px(Math.round(h.px2pt(ia.width))),color:ha(ia.color)}));Z.push({type:"CIMSolidFill",enable:!0,color:ha(ka),path:V.path});const [M,ba]=Q("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:b.getValue(-V.angle),size:b.getValue(V.size||6),offsetX:b.getValue(V.xoffset),offsetY:b.getValue(V.yoffset),
frame:M,markerGraphics:[{type:"CIMMarkerGraphic",geometry:ba,symbol:{type:"CIMPolygonSymbol",symbolLayers:Z}}]}]}}const [wa,ea]=Q(ia);if(ea&&wa){ia=[];if("outline"in V&&V.outline){var L=V.outline;ia.push({type:"CIMSolidStroke",enable:!0,width:.667<L.width?h.pt2px(Math.round(h.px2pt(L.width))):L.width,color:ha(L.color)})}else!Z||"line-marker"!==V.type||"cross"!==V.style&&"x"!==V.style||ia.push({type:"CIMSolidStroke",enable:!0,width:Z,color:ha(ka)});ia.push({type:"CIMSolidFill",enable:!0,color:ha(ka)});
ka={type:"CIMPolygonSymbol",symbolLayers:ia};L={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:b.getValue(-V.angle),size:b.getValue(V.size||6*Z),offsetX:b.getValue(V.xoffset),offsetY:b.getValue(V.yoffset),frame:wa,markerGraphics:[{type:"CIMMarkerGraphic",geometry:ea,symbol:ka}]}]}}return L};R.fromCIMHatchFill=function(V,Z){const ka=Z*(V.separation??4);var ia=ka/2;V=u.clone(V.lineSymbol);for(var wa=this._getLineSymbolPeriod(V)||4;4>wa;)wa*=2;wa/=2;ia={xmin:-wa,xmax:wa,
ymin:-ia,ymax:ia};const ea=V.symbolLayers.find(L=>"CIMSolidStroke"===L.type);ea&&(ea.width*=Z);return{type:"CIMVectorMarker",frame:ia,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-wa,0],[wa,0]]]},symbol:V}],size:ka}};R.fetchResources=function(V,Z,ka){if(V&&Z)switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(V=V.symbolLayers)for(const ia of V)switch(y(ia,Z,ka),ia.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in
ia&&ia.url&&ka.push(Z.fetchResource(ia.url,null));break;case "CIMVectorMarker":if(V=ia.markerGraphics)for(const wa of V)wa&&(V=wa.symbol)&&R.fetchResources(V,Z,ka)}}};R._getLineSymbolPeriod=function(V){if(V){const Z=this._getEffectsRepeat(V.effects);if(Z)return Z;if(V.symbolLayers)for(const ka of V.symbolLayers)if(ka){if(V=this._getEffectsRepeat(ka.effects))return V;switch(ka.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(V=
this._getPlacementRepeat(ka.markerPlacement))return V}}}return 0};R._getEffectsRepeat=function(V){if(V)for(var Z of V)if(Z)switch(Z.type){case "CIMGeometricEffectDashes":if((V=Z.dashTemplate)&&V.length){Z=0;for(const ka of V)Z+=ka;V.length&1&&(Z*=2);return Z}break;case "CIMGeometricEffectWave":return Z.period;default:C.error(`unsupported geometric effect type ${Z.type}`)}return 0};R._getPlacementRepeat=function(V){if(V)switch(V.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((V=
V.placementTemplate)&&V.length){let Z=0;for(const ka of V)Z+=ka;V.length&1&&(Z*=2);return Z}}return 0};R.fromCIMInsidePolygon=function(V){var Z=V.markerPlacement;const ka={type:V.type,...V,markerPlacement:null,anchorPoint:null};V=Math.abs(Z.stepX);const ia=Math.abs(Z.stepY);var wa=(Z.randomness??100)/100;let ea,L;if("Random"===Z.gridType){var M=h.px2pt(n.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const ba=Math.max(Math.floor(M/V),1),ca=Math.max(Math.floor(M/ia),1);M=ba*V/2;ea=ca*ia/2;L=2*ea;Z=new e(Z.seed);
const ma=wa*V/1.5,W=wa*ia/1.5;wa=[];for(let Y=0;Y<ba;Y++)for(let da=0;da<ca;da++){const ja=Y*V-M+ma*(.5-Z.getFloat()),pa=da*ia-ea+W*(.5-Z.getFloat());wa.push({x:ja,y:pa});0===Y&&wa.push({x:ja+2*M,y:pa});0===da&&wa.push({x:ja,y:pa+2*ea})}}else!0===Z.shiftOddRows?(M=V/2,ea=ia,L=2*ia,wa=[{x:-M,y:0},{x:M,y:0},{x:0,y:ea},{x:0,y:-ea}]):(M=V/2,ea=ia/2,L=ia,wa=[{x:-V,y:0},{x:0,y:-ia},{x:-V,y:-ia},{x:0,y:0},{x:V,y:0},{x:0,y:ia},{x:V,y:ia},{x:-V,y:ia},{x:V,y:-ia}]);V=wa.map(ba=>({type:"CIMMarkerGraphic",geometry:ba,
symbol:{type:"CIMPointSymbol",symbolLayers:[ka]}}));return{type:"CIMVectorMarker",frame:{xmin:-M,xmax:M,ymin:-ea,ymax:ea},markerGraphics:V,size:L}};R.getSize=function(V){if(V)switch(V.type){case "CIMTextSymbol":return V.height;case "CIMPointSymbol":var Z=0;if(V.symbolLayers)for(var ka of V.symbolLayers)if(ka)switch(ka.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":V=ka.size,V>Z&&(Z=V)}return Z;case "CIMLineSymbol":case "CIMPolygonSymbol":ka=
0;if(V.symbolLayers)for(Z of V.symbolLayers)if(Z)switch(Z.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":V=Z.width;V>ka&&(ka=V);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":b.isCIMMarkerStrokePlacement(Z.markerPlacement)&&(V=Z.size,V>ka&&(ka=V))}return ka}};R.getMarkerScaleRatio=function(V){if(V)switch(V.type){case "CIMVectorMarker":if(!1!==V.scaleSymbolsProportionally&&V.frame)return V.size/
(V.frame.ymax-V.frame.ymin)}return 1};return R}(),K=function(){function R(){}R.findApplicableOverrides=function(V,Z,ka){if(V&&Z){if(V.primitiveName){let ia=!1;for(const wa of ka)if(wa.primitiveName===V.primitiveName){ia=!0;break}if(!ia)for(const wa of Z)wa.primitiveName===V.primitiveName&&ka.push(wa)}switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(V.effects)for(const ia of V.effects)R.findApplicableOverrides(ia,Z,ka);if(V.symbolLayers)for(const ia of V.symbolLayers)R.findApplicableOverrides(ia,
Z,ka);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(V.effects)for(const ia of V.effects)R.findApplicableOverrides(ia,Z,ka);V.markerPlacement&&R.findApplicableOverrides(V.markerPlacement,Z,ka);if("CIMVectorMarker"===V.type){if(V.markerGraphics)for(const ia of V.markerGraphics)R.findApplicableOverrides(ia,Z,ka),
R.findApplicableOverrides(ia.symbol,Z,ka)}else"CIMCharacterMarker"===V.type?R.findApplicableOverrides(V.symbol,Z,ka):"CIMHatchFill"===V.type?R.findApplicableOverrides(V.lineSymbol,Z,ka):"CIMPictureMarker"===V.type&&R.findApplicableOverrides(V.animatedSymbolProperties,Z,ka)}}};R.findEffectOverrides=function(V,Z,ka){if(Z&&V){var ia=V.length;for(let wa=0;wa<ia;wa++){const ea=V[wa]?.primitiveName;if(ea){let L=!1;for(const M of ka)if(M.primitiveName===ea){L=!0;break}if(!L)for(const M of Z)M.primitiveName===
ea&&ka.push(M)}}}};R.resolveSymbolOverrides=function(){var V=t._asyncToGenerator(function*(Z,ka,ia,wa,ea,L,M){if(!Z||!Z.symbol)return null;let {symbol:ba,primitiveOverrides:ca}=Z;Z=!!ca;if(!Z&&!wa)return ba;ba=u.clone(ba);let ma=!0;ka||(ka={attributes:{}},ma=!1);Z&&(ma||(ca=ca.filter(W=>!W.valueExpressionInfo?.expression.includes("$feature"))),M||(ca=ca.filter(W=>!W.valueExpressionInfo?.expression.includes("$view"))),0<ca.length&&(Z=b.attributesToFields(ka.attributes),yield R.evaluateOverrides(ca,
ka,{spatialReference:ia,fields:Z,geometryType:ea},L,M)),R.applyOverrides(ba,ca));wa&&R.applyDictionaryTextOverrides(ba,ka,wa);return ba});return function(Z,ka,ia,wa,ea,L,M){return V.apply(this,arguments)}}();R.evaluateOverrides=function(){var V=t._asyncToGenerator(function*(Z,ka,ia,wa,ea){if(ka){var L;for(const M of Z)(Z=M.valueExpressionInfo)&&ia&&(L||(L=[]),M.value=void 0,Z=m.createRendererExpression(Z.expression,ia.spatialReference,ia.fields).then(ba=>{M.value=a(ba,ka,{$view:ea},ia.geometryType,
wa)}),L.push(Z));void 0!==L&&0<L.length&&(yield Promise.all(L))}});return function(Z,ka,ia,wa,ea){return V.apply(this,arguments)}}();R.applyDictionaryTextOverrides=function(V,Z,ka,ia="Normal"){if(V&&V.type)switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var wa=V.symbolLayers;if(!wa)break;for(var ea of wa)ea&&"CIMVectorMarker"===ea.type&&R.applyDictionaryTextOverrides(ea,Z,ka,"CIMTextSymbol"===V.type?V.textCase:ia);break;case "CIMVectorMarker":V=
V.markerGraphics;if(!V)break;for(wa of V)wa&&R.applyDictionaryTextOverrides(wa,Z,ka);break;case "CIMMarkerGraphic":(ea=V.textString)&&ea.includes("[")&&(ka=b.analyzeTextParts(ea,ka),V.textString=b.assignTextValuesFromFeature(Z,ka,ia))}};R.applyOverrides=function(V,Z,ka,ia){if(V.primitiveName)for(const ea of Z)if(ea.primitiveName===V.primitiveName){var wa=(wa=ea.propertyName)?wa.charAt(0).toLowerCase()+wa.substr(1):wa;ia&&ia.push({cim:V,nocapPropertyName:wa,value:V[wa]});ea.expression&&(ea.value=R.toValue(ea.propertyName,
ea.expression));if(ka){let L=!1;for(const M of ka)M.primitiveName===V.primitiveName&&(L=!0);L||ka.push(ea)}x.isSome(ea.value)&&(V[wa]=ea.value)}switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(V.effects)for(const ea of V.effects)R.applyOverrides(ea,Z,ka,ia);if(V.symbolLayers)for(const ea of V.symbolLayers)R.applyOverrides(ea,Z,ka,ia);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(V.effects)for(const ea of V.effects)R.applyOverrides(ea,
Z,ka,ia);if("CIMVectorMarker"===V.type&&V.markerGraphics)for(const ea of V.markerGraphics)R.applyOverrides(ea,Z,ka,ia),R.applyOverrides(ea.symbol,Z,ka,ia)}};R.restoreOverrides=function(V){for(const Z of V)Z.cim[Z.nocapPropertyName]=Z.value};R.buildOverrideKey=function(V){let Z="";for(const ka of V)void 0!==ka.value&&(Z+=`${ka.primitiveName}${ka.propertyName}${JSON.stringify(ka.value)}`);return Z};R.toValue=function(V,Z){return"DashTemplate"===V?Z.split(" ").map(ka=>Number(ka)):"Color"===V?(V=(new E(Z)).toRgba(),
V[3]*=255,V):Z};return R}();const J=R=>{if(!R)return c.LineCapStyle.Butt;switch(R){case "butt":return c.LineCapStyle.Butt;case "square":return c.LineCapStyle.Square;case "round":return c.LineCapStyle.Round}},P=R=>{if(!R)return c.LineJoinStyle.Miter;switch(R){case "miter":return c.LineJoinStyle.Miter;case "round":return c.LineJoinStyle.Round;case "bevel":return c.LineJoinStyle.Bevel}},S=R=>{if(x.isNone(R))return"Center";switch(R){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},
X=R=>{if(x.isNone(R))return"Center";switch(R){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},ha=R=>{if(!R)return[0,0,0,0];const {r:V,g:Z,b:ka,a:ia}=R;return[V,Z,ka,255*ia]},U=(R,V)=>{V="butt"===V;switch(R){case "dash":case "esriSLSDash":return V?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return V?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return V?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return V?[8,3]:[7,
4];case "long-dash-dot":case "esriSLSLongDashDot":return V?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return V?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return V?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return V?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return V?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return V?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return C.error("Unexpected: style does not require rasterization"),
[0,0];default:return C.error(`Tried to rasterize SLS, but found an unexpected style: ${R}!`),[0,0]}},Q=R=>{if("circle"===R||"esriSMSCircle"===R){var V=Math.acos(.995);R=Math.ceil(G/V/4);0===R&&(R=1);V=H/R;R*=4;var Z=[];Z.push([50,0]);for(let ka=1;ka<R;ka++)Z.push([50*Math.cos(ka*V),-50*Math.sin(ka*V)]);Z.push([50,0]);V={rings:[Z]};Z={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===R||"esriSMSCross"===R?(V={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],
[-0,50],[0,50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===R||"esriSMSDiamond"===R?(V={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===R||"esriSMSSquare"===R?(V={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===R||"esriSMSX"===R?(V={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50}):
"triangle"===R||"esriSMSTriangle"===R?(R=2/3*100,Z=R-100,V={rings:[[[-57.735026918962575,Z],[0,R],[57.735026918962575,Z],[-57.735026918962575,Z]]]},Z={xmin:-57.735026918962575,ymin:Z,xmax:57.735026918962575,ymax:R}):"arrow"===R&&(V={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},Z={xmin:-50,ymin:-50,xmax:50,ymax:50});return[Z,V]};let O;v.CIMSymbolHelper=F;v.CIMSymbolInflatedSizeHelper=A;v.OverrideHelper=K;v.slsDashToTemplateArray=U;v.symbolToCIM=function(R){if(!R||!R.type)return null;
let V;switch(R.type){case "cim":return R.data;case "web-style":return R;case "simple-marker":V=F.fromSimpleMarker(R);break;case "picture-marker":V=F.fromPictureMarker(R);break;case "simple-line":V=F.fromSimpleLineSymbol(R);break;case "simple-fill":V=F.fromSimpleFillSymbol(R);break;case "picture-fill":V=F.fromPictureFillSymbol(R);break;case "text":V=F.fromTextSymbol(R)}return{type:"CIMSymbolReference",symbol:V}};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p,z,w,y){function G(ha,U=1){const Q=p.fromCIMFontDecoration(ha);var O=p.fromCIMFontStyle(ha.fontStyleName);const R=B.getFontFamily(ha.fontFamilyName),{weight:V,style:Z}=O;O=U*(ha.height||5);const ka=p.fromCIMHorizontalAlignment(ha.horizontalAlignment),ia=p.fromCIMVerticalAlignment(ha.verticalAlignment),wa=p.getFillColor(ha),ea=p.getStrokeColor(ha.haloSymbol);ha=ea?U*(ha.haloSize|0):0;return{color:wa,size:O,horizontalAlignment:ka,verticalAlignment:ia,
font:{family:R,style:p.getFontStyle(Z),weight:p.getFontWeight(V),decoration:Q},halo:{size:ha||0,color:ea,style:Z},pixelRatio:1,premultiplyColors:!0}}const H=Math.PI/180,I=A.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let D=function(){function ha(Q){this._t=Q}ha.createIdentity=function(){return new ha([1,0,0,0,1,0])};var U=ha.prototype;U.clone=function(){return new ha(this._t.slice())};U.transform=function(Q){const O=this._t;return[O[0]*Q[0]+O[1]*Q[1]+O[2],O[3]*Q[0]+O[4]*Q[1]+O[5]]};ha.createScale=
function(Q,O){return new ha([Q,0,0,0,O,0])};U.scale=function(Q,O){const R=this._t;R[0]*=Q;R[1]*=Q;R[2]*=Q;R[3]*=O;R[4]*=O;R[5]*=O;return this};U.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};ha.createTranslate=function(Q,O){return new ha([0,0,Q,0,0,O])};U.translate=function(Q,O){const R=this._t;R[2]+=Q;R[5]+=O;return this};ha.createRotate=function(Q){const O=Math.cos(Q);Q=Math.sin(Q);return new ha([O,-Q,0,Q,O,0])};U.rotate=function(Q){return ha.multiply(this,
ha.createRotate(Q),this)};U.angle=function(){const Q=this._t[0],O=this._t[3],R=Math.sqrt(Q*Q+O*O);return[Q/R,O/R]};ha.multiply=function(Q,O,R){Q=Q._t;O=O._t;const V=Q[1]*O[0]+Q[4]*O[1],Z=Q[2]*O[0]+Q[5]*O[1]+O[2],ka=Q[0]*O[3]+Q[3]*O[4],ia=Q[1]*O[3]+Q[4]*O[4],wa=Q[2]*O[3]+Q[5]*O[4]+O[5],ea=R._t;ea[0]=Q[0]*O[0]+Q[3]*O[1];ea[1]=V;ea[2]=Z;ea[3]=ka;ea[4]=ia;ea[5]=wa;return R};U.invert=function(){const Q=this._t;let O=Q[0]*Q[4]-Q[1]*Q[3];if(0===O)return new ha([0,0,0,0,0,0]);O=1/O;return new ha([Q[4]*O,
-Q[1]*O,(Q[1]*Q[5]-Q[2]*Q[4])*O,-Q[3]*O,Q[0]*O,(Q[2]*Q[3]-Q[0]*Q[5])*O])};return ha}();A=function(){function ha(Q,O){this._resourceManager=Q;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new e(a.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(O||D.createIdentity());this._sizeTransfos.push(O?O.scaleRatio():1)}var U=ha.prototype;U.setTransform=function(Q,O){this._transfos=[Q||D.createIdentity()];this._sizeTransfos=[O?
O:Q?Q.scaleRatio():1]};U.setGeomUnitsPerPoint=function(Q){this._geomUnitsPerPoint=Q};U.transformPt=function(Q){return this._transfos[this._transfos.length-1].transform(Q)};U.transformSize=function(Q){return Q*this._sizeTransfos[this._sizeTransfos.length-1]};U.reverseTransformPt=function(Q){return this._transfos[this._transfos.length-1].invert().transform(Q)};U.reverseTransformSize=function(Q){return Q/this._sizeTransfos[this._sizeTransfos.length-1]};U.getTransformAngle=function(){return this._transfos[this._transfos.length-
1].angle()};U.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};U.isEmbedded=function(){return 1<this._transfos.length};U.back=function(){return this._transfos[this._transfos.length-1]};U.push=function(Q,O){O=O?Q.scaleRatio():1;D.multiply(Q,this.back(),Q);this._transfos.push(Q);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*O)};U.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};U.drawSymbol=function(Q,O,R){if(Q)switch(Q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(Q,
O);break;case "CIMTextSymbol":this.drawTextSymbol(Q,O,R)}};U.drawMultiLayerSymbol=function(Q,O){if(Q){var R=Q.symbolLayers;if(R)if((Q=Q.effects)&&0<Q.length){if(O=this.executeEffects(Q,O))for(Q=O.next();Q;)this.drawSymbolLayers(R,Q),Q=O.next()}else this.drawSymbolLayers(R,O)}};U.executeEffects=function(Q,O){const R=this._resourceManager.geometryEngine;O=new k.SimpleGeometryCursor(O);for(const V of Q)(Q=b.getEffectOperator(V))&&(O=Q.execute(O,V,this.geomUnitsPerPoint(),R));return O};U.drawSymbolLayers=
function(Q,O){let R=Q.length;for(;R--;){const Z=Q[R];if(Z&&!1!==Z.enable){var V=Z.effects;if(V&&0<V.length){if(V=this.executeEffects(V,O)){let ka=null;for(;(ka=V.next())&&(this.drawSymbolLayer(Z,ka),!this._earlyReturn););}}else this.drawSymbolLayer(Z,O);if(this._earlyReturn)break}}};U.drawSymbolLayer=function(Q,O){switch(Q.type){case "CIMSolidFill":this.drawSolidFill(O,Q.color);break;case "CIMHatchFill":this.drawHatchFill(O,Q);break;case "CIMPictureFill":this.drawPictureFill(O,Q);break;case "CIMGradientFill":this.drawGradientFill(O,
Q);break;case "CIMSolidStroke":this.drawSolidStroke(O,Q.color,Q.width,Q.capStyle,Q.joinStyle,Q.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(O,Q);break;case "CIMGradientStroke":this.drawGradientStroke(O,Q);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(Q,O)}};U.drawHatchFill=function(Q,O){const R=this._buildHatchPolyline(O,Q,this.geomUnitsPerPoint());R&&(this.pushClipPath(Q),this.drawMultiLayerSymbol(O.lineSymbol,R),this.popClipPath())};
U.drawPictureFill=function(Q,O){};U.drawGradientFill=function(Q,O){};U.drawPictureStroke=function(Q,O){};U.drawGradientStroke=function(Q,O){};U.drawMarkerLayer=function(Q,O){var R=Q.markerPlacement;if(R){const Z=b.getPlacementOperator(R);if(Z){var V="CIMMarkerPlacementInsidePolygon"===R.type||"CIMMarkerPlacementPolygonCenter"===R.type&&R.clipAtBoundary;V&&this.pushClipPath(O);if(O=Z.execute(O,R,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(R=null;(R=O.next())&&(this.drawMarker(Q,
R),!this._earlyReturn););V&&this.popClipPath()}}else{R=this._placementPool.acquire();if(r.isPoint(O))R.tx=O.x,R.ty=O.y,this.drawMarker(Q,R);else if(r.isPolygon(O))[R.tx,R.ty]=m.polygonCentroid(O),this.drawMarker(Q,R);else for(V of O.points)if(R.tx=V[0],R.ty=V[1],this.drawMarker(Q,R),this._earlyReturn)break;this._placementPool.release(R)}};U.drawMarker=function(Q,O){switch(Q.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(Q,O);break;case "CIMVectorMarker":this.drawVectorMarker(Q,
O)}};U.drawPictureMarker=function(Q,O){if(Q){var R=this._resourceManager.getResource(Q.url),V=Q.size??10;if(!(x.isNone(R)||0>=V)){var Z=R.width;R=R.height;if(Z&&R){R=Z/R;var ka=Q.scaleX??1;Z=D.createIdentity();var ia=Q.anchorPoint;if(ia){var wa=ia.x;ia=ia.y;"Absolute"!==Q.anchorPointUnits&&(wa*=V*R*ka,ia*=V);Z.translate(-wa,-ia)}R=Q.rotation??0;Q.rotateClockwise&&(R=-R);this._mapRotation&&(R+=this._mapRotation);R&&Z.rotate(R*H);R=Q.offsetX??0;ka=Q.offsetY??0;if(R||ka){if(this._mapRotation){ia=H*this._mapRotation;
wa=Math.cos(ia);ia=Math.sin(ia);const ea=R*ia+ka*wa;R=R*wa-ka*ia;ka=ea}Z.translate(R,ka)}R=this.geomUnitsPerPoint();1!==R&&Z.scale(R,R);(R=O.getAngle())&&Z.rotate(R);Z.translate(O.tx,O.ty);this.push(Z,!1);this.drawImage(Q,V);this.pop()}}}};U.drawVectorMarker=function(Q,O){if(Q){var R=Q.markerGraphics;if(R){var V=Q.size??10,Z=Q.frame,ka=Z?Z.ymax-Z.ymin:0;ka=V&&ka?V/ka:1;V=D.createIdentity();Z&&V.translate(.5*-(Z.xmax+Z.xmin),.5*-(Z.ymax+Z.ymin));var ia=Q.anchorPoint;if(ia){var wa=ia.x;ia=ia.y;"Absolute"!==
Q.anchorPointUnits?Z&&(wa*=Z.xmax-Z.xmin,ia*=Z.ymax-Z.ymin):(wa/=ka,ia/=ka);V.translate(-wa,-ia)}1!==ka&&V.scale(ka,ka);Z=Q.rotation??0;Q.rotateClockwise&&(Z=-Z);this._mapRotation&&(Z+=this._mapRotation);Z&&V.rotate(Z*H);Z=Q.offsetX??0;ka=Q.offsetY??0;if(Z||ka){if(this._mapRotation){ia=H*this._mapRotation;wa=Math.cos(ia);ia=Math.sin(ia);const ea=Z*ia+ka*wa;Z=Z*wa-ka*ia;ka=ea}V.translate(Z,ka)}Z=this.geomUnitsPerPoint();1!==Z&&V.scale(Z,Z);(Z=O.getAngle())&&V.rotate(Z);V.translate(O.tx,O.ty);this.push(V,
Q.scaleSymbolsProportionally);for(const ea of R)if(ea&&ea.symbol&&ea.geometry||I.error("Invalid marker graphic",ea),this.drawSymbol(ea.symbol,ea.geometry,ea.textString),this._earlyReturn)break;this.pop()}}};U.drawTextSymbol=function(Q,O,R){if(Q&&r.isPoint(O)&&!(0>=(Q.height??10))){var V=D.createIdentity(),Z=Q.angle??0;(Z=-Z)&&V.rotate(Z*H);Z=Q.offsetX??0;var ka=Q.offsetY??0;(Z||ka)&&V.translate(Z,ka);Z=this.geomUnitsPerPoint();1!==Z&&V.scale(Z,Z);V.translate(O.x,O.y);this.push(V,!1);this.drawText(Q,
R);this.pop()}};U._buildHatchPolyline=function(Q,O,R){var V=(void 0!==Q.separation?Q.separation:4)*R,Z=void 0!==Q.rotation?Q.rotation:0;if(0===V)return null;0>V&&(V=-V);for(var ka=0,ia=.5*V;ka>ia;)ka-=V;for(;ka<-ia;)ka+=V;ka=d.create();l.getBoundsXY(ka,O);ka[0]-=ia;ka[1]-=ia;ka[2]+=ia;ka[3]+=ia;for(var wa=[[ka[0],ka[1]],[ka[0],ka[3]],[ka[2],ka[3]],[ka[2],ka[1]]];180<Z;)Z-=180;for(;0>Z;)Z+=180;ia=Math.cos(Z*H);var ea=Math.sin(Z*H);Z=-V*ea;O=V*ia;ka=(void 0!==Q.offsetX?Q.offsetX*R:0)*ea-(void 0!==Q.offsetY?
Q.offsetY*R:0)*ia;let L;var M=Q=Number.MAX_VALUE;L=R=-Number.MAX_VALUE;for(var ba of wa){var ca=ba[0];const ma=ba[1];wa=ia*ca+ea*ma;ca=-ea*ca+ia*ma;M=Math.min(M,wa);Q=Math.min(Q,ca);L=Math.max(L,wa);R=Math.max(R,ca)}Q=Math.floor(Q/V)*V;ba=ia*M-ea*Q-Z*ka/V;M=ea*M+ia*Q-O*ka/V;wa=ia*L-ea*Q-Z*ka/V;ka=ea*L+ia*Q-O*ka/V;V=1+Math.round((R-Q)/V);ia=[];for(ea=0;ea<V;ea++)ba+=Z,M+=O,wa+=Z,ka+=O,ia.push([[ba,M],[wa,ka]]);return{paths:ia}};return ha}();let C=function(ha){function U(O,R){O=ha.call(this,O,R)||this;
O.reset();return O}t._inheritsLoose(U,ha);var Q=U.prototype;Q.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};Q.envelope=function(){return new f(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};Q.bounds=function(){return d.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};Q.drawSolidFill=function(O){!O||0<this._clipCount||(r.isPolygon(O)?this._processPath(O.rings,0):r.isPolyline(O)?this._processPath(O.paths,0):r.isExtent(O)?
(O=J(O))&&this._processPath(O.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};Q.drawSolidStroke=function(O,R,V){!O||0<this._clipCount||(R=.5*this.transformSize(V),r.isPolygon(O)?this._processPath(O.rings,R):r.isPolyline(O)?this._processPath(O.paths,R):r.isExtent(O)?(O=J(O))&&this._processPath(O.rings,R):console.error("drawSolidStroke unexpected geometry type!"))};Q.drawMarkerLayer=function(O,R){r.isPolygon(R)&&O.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===O.markerPlacement.type||
"CIMMarkerPlacementPolygonCenter"===O.markerPlacement.type&&O.markerPlacement.clipAtBoundary)?this._processPath(R.rings,0):ha.prototype.drawMarkerLayer.call(this,O,R)};Q.drawHatchFill=function(O,R){this.drawSolidFill(O)};Q.drawPictureFill=function(O,R){this.drawSolidFill(O)};Q.drawGradientFill=function(O,R){this.drawSolidFill(O)};Q.drawPictureStroke=function(O,R){this.drawSolidStroke(O,null,R.width)};Q.drawGradientStroke=function(O,R){this.drawSolidStroke(O,null,R.width)};Q.pushClipPath=function(O){this.drawSolidFill(O);
this._clipCount++};Q.popClipPath=function(){this._clipCount--};Q.drawImage=function(O,R){var {url:V}=O;O=O.scaleX??1;let Z=O*R,ka=R;V=this._resourceManager.getResource(V);!R&&x.isSome(V)&&(Z=O*V.width,ka=V.height);this._merge(this.transformPt([-Z/2,-ka/2]),0);this._merge(this.transformPt([-Z/2,ka/2]),0);this._merge(this.transformPt([Z/2,-ka/2]),0);this._merge(this.transformPt([Z/2,ka/2]),0)};Q.drawText=function(O,R){if(R&&0!==R.length){this._textRasterizer||(this._textRasterizer=new q);var V=G(O),
[Z,ka]=this._textRasterizer.computeTextSize(R,V);R=0;switch(O.horizontalAlignment){case "Left":R=Z/2;break;case "Right":R=-Z/2}V=0;switch(O.verticalAlignment){case "Bottom":V=ka/2;break;case "Top":V=-ka/2;break;case "Baseline":V=ka/6}this._merge(this.transformPt([-Z/2+R,-ka/2+V]),0);this._merge(this.transformPt([-Z/2+R,ka/2+V]),0);this._merge(this.transformPt([Z/2+R,-ka/2+V]),0);this._merge(this.transformPt([Z/2+R,ka/2+V]),0)}};Q._processPath=function(O,R){if(O)for(const V of O)if(O=V?V.length:0,
1<O){this._merge(this.transformPt(V[0]),R);for(let Z=1;Z<O;Z++)this._merge(this.transformPt(V[Z]),R)}};Q._merge=function(O,R){O[0]-R<this._xmin&&(this._xmin=O[0]-R);O[0]+R>this._xmax&&(this._xmax=O[0]+R);O[1]-R<this._ymin&&(this._ymin=O[1]-R);O[1]+R>this._ymax&&(this._ymax=O[1]+R)};return U}(A),F=function(ha){function U(){var O=ha.apply(this,arguments)||this;O._searchPoint=[0,0];O._searchDistPoint=0;return O}t._inheritsLoose(U,ha);var Q=U.prototype;Q.hitTest=function(O,R,V,Z,ka,ia){ia*=h.pt2px(1);
this.setTransform();this.setGeomUnitsPerPoint(ia);this._searchPoint=[(O[0]+O[2])/2,(O[1]+O[3])/2];this._searchDistPoint=(O[2]-O[0])/2/ia;this._textInfo=Z;this._mapRotation=R&&("CIMPointSymbol"===R.type&&"Map"!==R.angleAlignment||"CIMTextSymbol"===R.type)?ka:0;this._earlyReturn=!1;this.drawSymbol(R,V);return this._earlyReturn};Q.drawSolidFill=function(O,R){this._hitTestFill(O)};Q.drawHatchFill=function(O,R){this._hitTestFill(O)};Q.drawPictureFill=function(O,R){this._hitTestFill(O)};Q.drawGradientFill=
function(O,R){this._hitTestFill(O)};Q.drawSolidStroke=function(O,R,V,Z,ka,ia){this._hitTestStroke(O,V)};Q.drawPictureStroke=function(O,R){this._hitTestStroke(O,R.width)};Q.drawGradientStroke=function(O,R){this._hitTestStroke(O,R.width)};Q.drawMarkerLayer=function(O,R){O.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===O.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===O.markerPlacement.type&&O.markerPlacement.clipAtBoundary)?this._hitTestFill(R):ha.prototype.drawMarkerLayer.call(this,
O,R)};Q.pushClipPath=function(O){};Q.popClipPath=function(){};Q.drawImage=function(O,R){var {url:V}=O;O=O.scaleX??1;V=this._resourceManager.getResource(V);if(!x.isNone(V)&&0!==V.height&&0!==R){R*=this.geomUnitsPerPoint();O=V.width/V.height*O*R;V=this.reverseTransformPt(this._searchPoint);var Z=this._searchDistPoint;Math.abs(V[0])<O/2+Z&&Math.abs(V[1])<R/2+Z&&(this._earlyReturn=!0)}};Q.drawText=function(O,R){if(R=this._textInfo)if(R=R.get(O)){var {text:V,mosaicItem:Z}=R;if(Z&&0!==Z.glyphMosaicItems.length){R=
O.height??10;var ka=X(O.lineGapType,O.lineGap??0,R),ia=E.bidiText(V)[1];O=y.shapeGlyphs(Z.glyphMosaicItems,ia,{scale:R/w.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:P(O.horizontalAlignment),vAlign:S(O.verticalAlignment),maxLineWidth:512,lineHeight:w.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(ka||1,4)),decoration:O.font.decoration||"none",isCIM:!0});ka=this.reverseTransformPt(this._searchPoint);R=ka[0];ka=ka[1];for(const wa of O.glyphs)if(R>wa.xTopLeft&&R<wa.xBottomRight&&ka>-wa.yBottomRight&&
ka<-wa.yTopLeft){this._earlyReturn=!0;break}}}};Q._hitTestFill=function(O){let R=null;if(r.isExtent(O))R=[[[O.xmin,O.ymin],[O.xmin,O.ymax],[O.xmax,O.ymax],[O.xmax,O.ymin],[O.xmin,O.ymin]]];else if(r.isPolygon(O))R=O.rings;else if(r.isPolyline(O))R=O.paths;else return;O=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(O,R)&&(this._earlyReturn=!0);if(!this._earlyReturn){const V=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(O,R,V)&&(this._earlyReturn=
!0)}};Q._hitTestStroke=function(O,R){let V=null;if(r.isExtent(O))V=[[[O.xmin,O.ymin],[O.xmin,O.ymax],[O.xmax,O.ymax],[O.xmax,O.ymin],[O.xmin,O.ymin]]];else if(r.isPolygon(O))V=O.rings;else if(r.isPolyline(O))V=O.paths;else return;O=this.reverseTransformPt(this._searchPoint);R*=this.geomUnitsPerPoint();const Z=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(O,V,R/2+Z)&&(this._earlyReturn=!0)};Q._pointInPolygon=function(O,R){let V=0;for(const Z of R){R=Z.length;
for(let ka=1;ka<R;ka++){const ia=Z[ka-1],wa=Z[ka];ia[1]>O[1]!==wa[1]>O[1]&&(0<(wa[0]-ia[0])*(O[1]-ia[1])-(wa[1]-ia[1])*(O[0]-ia[0])?V++:V--)}}return 0!==V};Q._nearLine=function(O,R,V){for(const ka of R){R=ka.length;for(let ia=1;ia<R;ia++){var Z=ka[ia-1];const wa=ka[ia];let ea=(wa[0]-Z[0])*(wa[0]-Z[0])+(wa[1]-Z[1])*(wa[1]-Z[1]);if(0!==ea&&(ea=Math.sqrt(ea),Math.abs(((wa[0]-Z[0])*(O[1]-Z[1])-(wa[1]-Z[1])*(O[0]-Z[0]))/ea)<V&&(Z=((wa[0]-Z[0])*(O[0]-Z[0])+(wa[1]-Z[1])*(O[1]-Z[1]))/ea,Z>-V&&Z<ea+V)))return!0}}return!1};
return U}(A),K=function(ha){function U(O,R,V,Z){R=ha.call(this,R,V)||this;R._applyAdditionalRenderProps=Z;R._colorSubstitutionHelper=new c;R._ctx=O;return R}t._inheritsLoose(U,ha);var Q=U.prototype;Q.drawSolidFill=function(O,R){if(O){if(r.isPolygon(O))this._buildPath(O.rings,!0);else if(r.isPolyline(O))this._buildPath(O.paths,!0);else if(r.isExtent(O))this._buildPath(J(O).rings,!0);else if(r.isMultipoint(O))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;O=this._ctx;
O.fillStyle="string"===typeof R?R:"rgba("+Math.round(R[0])+","+Math.round(R[1])+","+Math.round(R[2])+","+R[3]/255+")";O.fill("evenodd")}};Q.drawSolidStroke=function(O,R,V,Z,ka,ia){if(O&&R&&0!==V){if(r.isPolygon(O))this._buildPath(O.rings,!0);else if(r.isPolyline(O))this._buildPath(O.paths,!1);else if(r.isExtent(O))this._buildPath(J(O).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}O=this._ctx;O.strokeStyle="string"===typeof R?R:"rgba("+Math.round(R[0])+","+
Math.round(R[1])+","+Math.round(R[2])+","+R[3]/255+")";O.lineWidth=Math.max(this.transformSize(V),.5);this._setCapStyle(Z);this._setJoinStyle(ka);O.miterLimit=ia;O.stroke()}};Q.pushClipPath=function(O){this._ctx.save();if(r.isPolygon(O))this._buildPath(O.rings,!0);else if(r.isPolyline(O))this._buildPath(O.paths,!0);else if(r.isExtent(O))this._buildPath(J(O).rings,!0);else return;this._ctx.clip("evenodd")};Q.popClipPath=function(){this._ctx.restore()};Q.drawImage=function(O,R){const {colorSubstitutions:V,
url:Z,tintColor:ka}=O;O=O.scaleX??1;var ia=this._resourceManager.getResource(Z);if(!x.isNone(ia)){var wa=ia.width/ia.height*R,ea=R;R||(wa=ia.width,ea=ia.height);var L=p.isSVGImage(Z)||"src"in ia&&p.isSVGImage(ia.src);R="getFrame"in ia?n.getFirstFrame(ia):ia;V&&(R=this._colorSubstitutionHelper.applyColorSubstituition(R,V));this._applyAdditionalRenderProps&&!L&&ka&&(R=this._colorSubstitutionHelper.tintImageData(R,ka));ia=this.transformPt([0,0]);var [M,ba]=this.getTransformAngle();L=this.transformSize(1);
var ca=this._ctx;ca.save();ca.setTransform({m11:O*L*M,m12:O*L*ba,m21:-L*ba,m22:L*M,m41:ia[0],m42:ia[1]});ca.drawImage(R,-wa/2,-ea/2,wa,ea);ca.restore()}};Q.drawText=function(O,R){if(R&&0!==R.length&&(this._textRasterizer||(this._textRasterizer=new q),O=G(O),O.size*=this.transformSize(h.px2pt(1)),R=this._textRasterizer.rasterizeText(R,O))){var {size:V,anchorX:Z,anchorY:ka,canvas:ia}=R;R=V[0]*(Z+.5);O=V[1]*(ka-.5);var wa=this._ctx,ea=this.transformPt([0,0]),[L,M]=this.getTransformAngle();wa.save();
wa.setTransform({m11:1*L,m12:1*M,m21:-1*M,m22:1*L,m41:ea[0]-1*R,m42:ea[1]+1*O});wa.drawImage(ia,0,0);wa.restore()}};Q.drawPictureFill=function(O,R){if(O){var {colorSubstitutions:V,height:Z,offsetX:ka,offsetY:ia,rotation:wa,scaleX:ea,tintColor:L,url:M}=R;R=this._resourceManager.getResource(M);if(!x.isNone(R)){if(r.isPolygon(O))this._buildPath(O.rings,!0);else if(r.isPolyline(O))this._buildPath(O.paths,!0);else if(r.isExtent(O))this._buildPath(J(O).rings,!0);else if(r.isMultipoint(O))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");
else return;O=this._ctx;var ba=p.isSVGImage(M)||"src"in R&&p.isSVGImage(R.src),ca="getFrame"in R?n.getFirstFrame(R):R;V&&(ca=this._colorSubstitutionHelper.applyColorSubstituition(ca,V));if(this._applyAdditionalRenderProps){if(ba||L&&(ca=this._colorSubstitutionHelper.tintImageData(ca,L)),ba=O.createPattern(ca,"repeat"),ca=this.transformSize(1),wa||(wa=0),ka=ka?ca*ka:0,ia=ia?ca*ia:0,Z&&(Z*=ca),ca=Z?Z/R.height:1,R=ea&&Z?ea*Z/R.width:1,0!==wa||1!==ca||1!==R||0!==ka||0!==ia){const ma=new DOMMatrix;ma.rotateSelf(0,
0,-wa).translateSelf(ka,ia).scaleSelf(R,ca,1);ba.setTransform(ma)}}else ba=O.createPattern(ca,"repeat");O.save();O.fillStyle=ba;O.fill("evenodd");O.restore()}}};Q.drawPictureStroke=function(O,R){if(O){var {colorSubstitutions:V,capStyle:Z,joinStyle:ka,miterLimit:ia,tintColor:wa,url:ea,width:L}=R;R=this._resourceManager.getResource(ea);if(!x.isNone(R)){if(r.isPolygon(O))var M=O.rings;else if(r.isPolyline(O))M=O.paths;else if(r.isExtent(O))M=J(O).rings;else if(r.isMultipoint(O))console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");
else return;L||(L=R.width);O=p.isSVGImage(ea)||"src"in R&&p.isSVGImage(R.src);var ba="getFrame"in R?n.getFirstFrame(R):R;V&&(ba=this._colorSubstitutionHelper.applyColorSubstituition(ba,V));this._applyAdditionalRenderProps&&(O||wa&&(ba=this._colorSubstitutionHelper.tintImageData(ba,wa)));O=Math.max(this.transformSize(h.pt2px(L)),.5);R=O/ba.width;var ca=this._ctx;ba=ca.createPattern(ba,"repeat-y");ca.save();this._setCapStyle(Z);this._setJoinStyle(ka);ca.miterLimit=ia;ca.lineWidth=O;var ma;for(let pa of M){pa=
u.clone(pa);var W=ma=void 0,Y=void 0;let sa=W=void 0;M=pa;for(var da=M[0],ja=1;ja<M.length;)sa=M[ja][0]-da[0],W=M[ja][1]-da[1],W=0!==sa?W/sa:Math.PI/2,void 0!==Y&&1E-4>=W-Y?(M.splice(ja-1,1),da=ma):(ma=da,da=M[ja],ja++),Y=W;if(pa&&!(1>=pa.length))for(M=this.transformPt(pa[0]),Y=1;Y<pa.length;Y++)ma=this.transformPt(pa[Y]),da=180/Math.PI*Math.atan2(ma[1]-M[1],ma[0]-M[0]),ja=new DOMMatrix,ja.translateSelf(0,M[1]-O/2).scaleSelf(R,R,1).rotateSelf(0,0,90-da),ba.setTransform(ja),ca.strokeStyle=ba,ca.beginPath(),
ca.moveTo(M[0],M[1]),ca.lineTo(ma[0],ma[1]),ca.stroke(),M=ma}ca.restore()}}};Q._buildPath=function(O,R){const V=this._ctx;V.beginPath();if(O)for(const Z of O)if(O=Z?Z.length:0,1<O){let ka=this.transformPt(Z[0]);V.moveTo(ka[0],ka[1]);for(let ia=1;ia<O;ia++)ka=this.transformPt(Z[ia]),V.lineTo(ka[0],ka[1]);R&&V.closePath()}};Q._setCapStyle=function(O){switch(O){case g.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case g.LineCapStyle.Round:this._ctx.lineCap="round";break;case g.LineCapStyle.Square:this._ctx.lineCap=
"square"}};Q._setJoinStyle=function(O){switch(O){case g.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case g.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case g.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return U}(A);const J=ha=>ha?{spatialReference:ha.spatialReference,rings:[[[ha.xmin,ha.ymin],[ha.xmin,ha.ymax],[ha.xmax,ha.ymax],[ha.xmax,ha.ymin],[ha.xmin,ha.ymin]]]}:null,P=ha=>{switch(ha){case "Left":return z.HAlign.Left;case "Right":return z.HAlign.Right;case "Center":return z.HAlign.Center;
case "Justify":return I.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),z.HAlign.Center}},S=ha=>{switch(ha){case "Top":return z.VAlign.Top;case "Center":return z.VAlign.Center;case "Bottom":return z.VAlign.Bottom;case "Baseline":return z.VAlign.Baseline}},X=(ha,U,Q)=>{switch(ha){case "ExtraLeading":return 1+U/Q;case "Multiple":return U;case "Exact":return U/Q}};v.CIMSymbolDrawHelper=A;v.C_DEG_TO_RAD=H;v.CanvasDrawHelper=K;v.EnvDrawHelper=C;v.HittestDrawHelper=
F;v.Transformation=D;v.horizontalAlignment2HAlign=P;v.lineGapType2LineHeight=X;v.verticalAlignment2VAlign=S;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(["../../Color"],function(v){return function(){function t(){}var E=t.prototype;E.applyColorSubstituition=function(B,u){if(!u)return B;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:A,
height:x}=B,e=this._rasterizationCanvas,h=e.getContext("2d");B!==e&&(e.width=A,e.height=x,h.drawImage(B,0,0,A,x));B=h.getImageData(0,0,A,x).data;if(u)for(var d of u)if(d&&d.oldColor&&4===d.oldColor.length&&d.newColor&&4===d.newColor.length){const [l,m,r,k]=d.oldColor,[c,b,a,g]=d.newColor;if(l!==c||m!==b||r!==a||k!==g)for(u=0;u<B.length;u+=4)l===B[u]&&m===B[u+1]&&r===B[u+2]&&k===B[u+3]&&(B[u]=c,B[u+1]=b,B[u+2]=a,B[u+3]=g)}d=new ImageData(B,A,x);h.putImageData(d,0,0);return e};E.tintImageData=function(B,
u){if(!u)return B;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:A,height:x}=B,e=this._rasterizationCanvas,h=e.getContext("2d");B!==e&&(e.width=A,e.height=x,h.drawImage(B,0,0,A,x));B=h.getImageData(0,0,A,x);B=new Uint8Array(B.data);u=new v(u);u=[u.r/255,u.g/255,u.b/255,u.a];for(let d=0;d<B.length;d+=4)B[d+0]*=u[0],B[d+1]*=u[1],B[d+2]*=u[2],B[d+3]*=u[3];B=new ImageData(new Uint8ClampedArray(B.buffer),A,x);h.putImageData(B,0,0);return e};return t}()})},
"esri/symbols/cim/imageUtils":function(){define(["exports"],function(v){v.getFirstFrame=function(t){const E=t.getFrame(0);if(E instanceof HTMLImageElement||E instanceof HTMLCanvasElement)return E;const B=document.createElement("canvas");B.width=t.width;B.height=t.height;t=B.getContext("2d");E instanceof ImageData?t.putImageData(E,0,0):t.drawImage(E,0,0);return B};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(v){return function(){function t(E=0,B=0,u=0,A=0){this.x=E;this.y=B;this.width=u;this.height=A}t.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};v._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(v){return function(){function t(B){B&&
(this._textRasterizationCanvas=B)}var E=t.prototype;E.rasterizeText=function(B,u){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const A=this._textRasterizationCanvas;var x=A.getContext("2d");this._setFontProperties(x,u);this._parameters=u;this._textLines=B.split(/\r?\n/);this._lineHeight=this._computeLineHeight();B=this._computeTextWidth(x,u);const {decoration:e,weight:h}=u.font;this._lineThroughWidthOffset=e&&"line-through"===e?.1*this._lineHeight:
0;var d=this._lineHeight*this._textLines.length;A.width=B+2*this._lineThroughWidthOffset;A.height=d;this._renderedLineHeight=Math.round(this._lineHeight*u.pixelRatio);this._renderedHaloSize=u.halo.size*u.pixelRatio;this._renderedWidth=B*u.pixelRatio;this._renderedHeight=d*u.pixelRatio;this._lineThroughWidthOffset*=u.pixelRatio;B=u.halo&&u.halo.color?u.halo.color:[0,0,0,0];d=u.color??[0,0,0,0];this._fillStyle=`rgba(${d.slice(0,3).toString()},${d[3]})`;this._haloStyle=`rgb(${B.slice(0,3).toString()})`;
B=this._renderedLineHeight;d=this._renderedHaloSize;x.save();x.clearRect(0,0,A.width,A.height);this._setFontProperties(x,u);var l=x.textAlign,m=this._renderedWidth;l=("center"===l?.5*m:"right"===l?m:0)+d;m=0<d;let r=this._lineThroughWidthOffset,k=0;m&&this._renderHalo(x,l,d,r,k,u);k+=d;r+=l;for(var c of this._textLines)m&&(x.globalCompositeOperation="destination-out",x.fillStyle="rgb(0, 0, 0)",x.fillText(c,r,k),x.globalCompositeOperation="source-over"),x.fillStyle=this._fillStyle,x.fillText(c,r,k),
e&&"none"!==e&&this._renderDecoration(x,r,k,e,h),k+=B;x.restore();c=this._renderedWidth+2*this._lineThroughWidthOffset;B=this._renderedHeight;x=x.getImageData(0,0,c,B);x=new Uint8Array(x.data);if(u.premultiplyColors)for(l=0;l<x.length;l+=4)d=x[l+3]/255,x[l]*=d,x[l+1]*=d,x[l+2]*=d;switch(u.horizontalAlignment){case "left":d=-.5;break;case "right":d=.5;break;default:d=0}switch(u.verticalAlignment){case "bottom":u=-.5;break;case "top":u=.5;break;default:u=0}return{size:[c,B],image:new Uint32Array(x.buffer),
sdf:!1,simplePattern:!1,anchorX:d,anchorY:u,canvas:A}};E._renderHalo=function(B,u,A,x,e,h){const d=this._renderedWidth,l=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=d;this._haloRasterizationCanvas.height=l;const m=this._haloRasterizationCanvas,r=m.getContext("2d");r.clearRect(0,0,d,l);this._setFontProperties(r,h);const {decoration:k,weight:c}=h.font;r.fillStyle=this._haloStyle;r.strokeStyle=
this._haloStyle;r.lineJoin="round";this._renderHaloNative(r,u,A,k,c);B.globalAlpha=this._parameters.halo.color[3];B.drawImage(m,0,0,d,l,x,e,d,l);B.globalAlpha=1};E._renderHaloNative=function(B,u,A,x,e){const h=this._renderedLineHeight,d=this._renderedHaloSize;for(const l of this._textLines){const m=2*d;for(let r=0;5>r;r++){const k=(.6+.1*r)*m;B.lineWidth=k;B.strokeText(l,u,A);x&&"none"!==x&&this._renderDecoration(B,u,A,x,e,k)}A+=h}};E._setFontProperties=function(B,u){var A=u.font;A=`${A.style} ${A.weight} ${v.pt2px(Math.max(u.size,
.5)*u.pixelRatio).toFixed(1)}px ${A.family}, sans-serif`;B.font=A;B.textBaseline="top";switch(u.horizontalAlignment){case "left":u="left";break;case "right":u="right";break;case "center":u="center";break;default:u="left"}B.textAlign=u};E.computeTextSize=function(B,u){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const A=this._textRasterizationCanvas;var x=A.getContext("2d");this._setFontProperties(x,u);this._parameters=u;this._textLines=B.split(/\r?\n/);
this._lineHeight=this._computeLineHeight();B=this._computeTextWidth(x,u);x=this._lineHeight*this._textLines.length;A.width=B;A.height=x;return[B*u.pixelRatio,x*u.pixelRatio]};E._computeTextWidth=function(B,u){let A=0;for(const x of this._textLines)A=Math.max(A,B.measureText(x).width);u=u.font;if("italic"===u.style||"oblique"===u.style||"string"===typeof u.weight&&("bold"===u.weight||"bolder"===u.weight)||"number"===typeof u.weight&&600<u.weight)A+=.3*B.measureText("w").width;A+=2*this._parameters.halo.size;
return Math.round(A)};E._computeLineHeight=function(){let B=1.275*this._parameters.size;const u=this._parameters.font.decoration;u&&"underline"===u&&(B*=1.3);return Math.round(B+2*this._parameters.halo.size)};E._renderDecoration=function(B,u,A,x,e,h){const d=.9*this._lineHeight;switch(B.textAlign){case "center":u-=this._renderedWidth/2;break;case "right":u-=this._renderedWidth}const l=B.textBaseline;if("underline"===x)switch(l){case "top":A+=d;break;case "middle":A+=d/2}else if("line-through"===x)switch(l){case "top":A+=
d/1.5;break;case "middle":A+=d/3}x=h?1.5*h:Math.ceil(d*("bold"===e?.06:"bolder"===e?.09:.04));B.save();B.beginPath();B.strokeStyle=B.fillStyle;B.lineWidth=x;B.moveTo(u-this._lineThroughWidthOffset,A);B.lineTo(u+this._renderedWidth+2*this._lineThroughWidthOffset,A);B.stroke();B.restore()};return t}()})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(v,t){function E(d){let l=d.length;for(;l--;)if(!" /-,\n".includes(d.charAt(l)))return!1;return!0}function B(d,l){const m=[];
var r=0;let k=-1;do k=d.indexOf("[",r),k>=r&&(k>r&&(r=d.substr(r,k-r),m.push([r,null,E(r)])),r=k+1,k=d.indexOf("]",r),k>=r&&(k>r&&(r=d.substr(r,k-r),(r=l[r])&&m.push([null,r,!1])),r=k+1));while(-1!==k);r<d.length-1&&(d=d.substr(r),m.push([d,null,E(d)]));return m}function u(d,l,m){let r="",k=null;for(const c of l){const [b,a,g]=c;if(b)g?k=b:(k&&(r+=k,k=null),r+=b);else if(l=d.attributes[a])k&&(r+=k,k=null),r+=l}return A(r,m)}function A(d,l){"string"!==typeof d&&(d=String(d));switch(l){case "LowerCase":return d.toLowerCase();
case "Allcaps":return d.toUpperCase();default:return d}}function x(d){if(!d)return null;switch(d.type){case "CIMPolygonSymbol":if(d.symbolLayers)for(const l of d.symbolLayers)if(d=x(l),null!=d)return d;break;case "CIMTextSymbol":return x(d.symbol);case "CIMSolidFill":return d.color}}function e(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d.symbolLayers)for(const l of d.symbolLayers)if(d=e(l),void 0!==d)return d;break;case "CIMTextSymbol":return e(d.symbol);case "CIMSolidStroke":case "CIMSolidFill":return d.color}}
function h(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d.symbolLayers)for(const l of d.symbolLayers)if(d=h(l),void 0!==d)return d;break;case "CIMTextSymbol":return h(d.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return d.width}}t.adjustTextCase=A;t.analyzeTextParts=B;t.assignTextValuesFromFeature=u;t.attributesToFields=function(d){return(d?Object.keys(d):[]).map(l=>({name:l,alias:l,type:"string"===typeof d[l]?"esriFieldTypeString":"esriFieldTypeDouble"}))};
t.colorToArray=function(d){return[d.r,d.g,d.b,d.a]};t.createLabelOverrideFunction=function(d,l,m){const r=B(l,d);return k=>u(k,r,m)};t.evaluateValueOrFunction=function(d,l,m,r){return"function"===typeof d?d(l,m,r):d};t.fromCIMColor=function(d){return d?{r:d[0],g:d[1],b:d[2],a:d[3]/255}:{r:0,g:0,b:0,a:0}};t.fromCIMFontDecoration=function(d){return d.underline?"underline":d.strikethrough?"line-through":"none"};t.fromCIMFontStyle=function(d){let l="",m="";d&&(d=d.toLowerCase(),d.includes("italic")?l=
"italic":d.includes("oblique")&&(l="oblique"),d.includes("bold")?m="bold":d.includes("light")&&(m="lighter"));return{style:l,weight:m}};t.fromCIMHorizontalAlignment=function(d){switch(d){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};t.fromCIMVerticalAlignment=function(d){switch(d){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};t.getFillColor=x;t.getFontStyle=function(d){if(!d)return"normal";
switch(d.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};t.getFontWeight=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};t.getStrokeColor=e;t.getStrokeWidth=h;t.getValue=(d,l=0)=>isNaN(d)||null==d?l:d;t.importGeometryEngine=function(){return new Promise((d,l)=>v(["../../geometry/geometryEngineJSON"],d,l))};t.isCIMFill=function(d){return"CIMGradientFill"===
d.type||"CIMHatchFill"===d.type||"CIMPictureFill"===d.type||"CIMSolidFill"===d.type||"CIMWaterFill"===d.type};t.isCIMMarker=function(d){return"CIMVectorMarker"===d.type||"CIMPictureMarker"===d.type||"CIMBarChartMarker"===d.type||"CIMCharacterMarker"===d.type||"CIMPieChartMarker"===d.type||"CIMStackedBarChartMarker"===d.type};t.isCIMMarkerStrokePlacement=function(d){return"CIMMarkerPlacementAlongLineRandomSize"===d.type||"CIMMarkerPlacementAlongLineSameSize"===d.type||"CIMMarkerPlacementAlongLineVariableSize"===
d.type||"CIMMarkerPlacementAtExtremities"===d.type||"CIMMarkerPlacementAtMeasuredUnits"===d.type||"CIMMarkerPlacementAtRatioPositions"===d.type||"CIMMarkerPlacementOnLine"===d.type||"CIMMarkerPlacementOnVertices"===d.type};t.isCIMStroke=function(d){return"CIMGradientStroke"===d.type||"CIMPictureStroke"===d.type||"CIMSolidStroke"===d.type};t.isGeometryEngineRequired=d=>{if(!d)return!1;for(const l of d)switch(l.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};
t.isSVGImage=d=>d.includes("data:image/svg+xml");t.mapCIMSymbolToGeometryType=function(d){if(!d)return null;switch(d.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};t.resampleHermite=function(d,l,m,r,k,c,b=!0){const a=l/k;m/=c;const g=Math.ceil(a/2),n=Math.ceil(m/2);for(let p=0;p<c;p++)for(let z=0;z<k;z++){const w=4*(z+(b?c-p-1:p)*k);var f=0;let y=
0,G=0,H=0,I=0,D=0,C=0;const F=(p+.5)*m;for(let K=Math.floor(p*m);K<(p+1)*m;K++){var q=Math.abs(F-(K+.5))/n;const J=(z+.5)*a;q*=q;for(let P=Math.floor(z*a);P<(z+1)*a;P++){let S=Math.abs(J-(P+.5))/g;f=Math.sqrt(q+S*S);-1<=f&&1>=f&&(f=2*f*f*f-3*f*f+1,0<f&&(S=4*(P+K*l),C+=f*d[S+3],G+=f,255>d[S+3]&&(f=f*d[S+3]/250),H+=f*d[S],I+=f*d[S+1],D+=f*d[S+2],y+=f))}}r[w]=H/y;r[w+1]=I/y;r[w+2]=D/y;r[w+3]=C/G}};t.toCIMSymbolJSON=function(d){return d.data?.symbol??null};Object.defineProperties(t,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(v,t,E,B){function u(x){const e={};switch(x){case "esriGeometryPoint":return(h,d,l,m)=>B.unquantizePoint(d,e,h,l,m);case "esriGeometryPolygon":return(h,d,l,m)=>B.unquantizePolygon(d,e,h,l,m);case "esriGeometryPolyline":return(h,d,l,m)=>B.unquantizePolyline(d,e,h,l,m);
case "esriGeometryMultipoint":return(h,d,l,m)=>B.unquantizeMultipoint(d,e,h,l,m);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new v("mapview-arcade",`Unable to handle geometryType: ${x}`)),h=>h}}const A=new Map;return function(x,e,h,d,l){if(E.isNone(x))return null;if(x.referencesGeometry()&&l){const {transform:m,hasZ:r,hasM:k}=l;A.has(d)||A.set(d,u(d));d=A.get(d)(e.geometry,m,r,k);e={...e,geometry:d}}e=x.repurposeFeature(e);try{return x.evaluate({...h,$feature:e})}catch(m){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
m),null}}})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(v){const t=new Set(["StartTimeOffset","Duration","RepeatDelay"]);v.quantizeIfNeeded=function(E,B){return t.has(B)?.05*Math.max(Math.round(E/.05),1):E};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(v,t,E,B){function u(x){if(!x)return null;
switch(x.type){case "CIMPointSymbol":x=x.symbolLayers;if(!x||1!==x.length)break;return u(x[0]);case "CIMVectorMarker":x=x.markerGraphics;if(!x||1!==x.length)break;var e=x[0];if(!e)break;x=e.geometry;if(!x)break;e=e.symbol;if(!e||"CIMPolygonSymbol"!==e.type&&"CIMLineSymbol"!==e.type||e.symbolLayers?.some(h=>!!h.effects))break;return{geom:x,asFill:"CIMPolygonSymbol"===e.type};case "sdf":return{geom:x.geom,asFill:x.asFill}}return null}function A(x){let e=Infinity,h=-Infinity,d=Infinity,l=-Infinity;for(const m of x)for(const r of m)r[0]<
e&&(e=r[0]),r[0]>h&&(h=r[0]),r[1]<d&&(d=r[1]),r[1]>l&&(l=r[1]);return[e,d,h,l]}v.buildSDF=function(x){var e=x.geom;var h=e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null;e=Infinity;var d=-Infinity;var l=Infinity,m=-Infinity;for(var r of h)for(var k of r)k[0]<e&&(e=k[0]),k[0]>d&&(d=k[0]),k[1]<l&&(l=k[1]),k[1]>m&&(m=k[1]);d=new B(e,l,d-e,m-l);l=64/Math.max(d.width,
d.height);r=Math.round(d.width*l)+62;k=Math.round(d.height*l)+62;e=[];for(var c of h)if(c&&1<c.length){h=[];for(var b of c){let [G,H]=b;G-=d.x;H-=d.y;G*=l;H*=l;G+=30.5;H+=30.5;x.asFill?h.push([G,H]):h.push([Math.round(G),Math.round(H)])}x.asFill&&(m=h.length-1,h[0][0]===h[m][0]&&h[0][1]===h[m][1]||h.push(h[0]));e.push(h)}b=r*k;c=Array(b);for(h=0;h<b;++h)c[h]=962;for(var a of e)for(h=a.length,d=1;d<h;++d){l=a[d-1];m=a[d];var g=void 0,n=void 0;l[0]<m[0]?(g=l[0],n=m[0]):(g=m[0],n=l[0]);var f=void 0,
q=void 0;l[1]<m[1]?(f=l[1],q=m[1]):(f=m[1],q=l[1]);var p=Math.floor(g)-31;n=Math.floor(n)+31;f=Math.floor(f)-31;q=Math.floor(q)+31;0>p&&(p=0);n>r&&(n=r);0>f&&(f=0);q>k&&(q=k);g=m[0]-l[0];const G=m[1]-l[1],H=g*g+G*G;for(;p<n;p++)for(let I=f;I<q;I++){var z=(p-l[0])*g+(I-l[1])*G,w=void 0;0>z?(w=l[0],z=l[1]):z>H?(w=m[0],z=m[1]):(z/=H,w=l[0]+z*g,z=l[1]+z*G);w=(p-w)*(p-w)+(I-z)*(I-z);z=(k-I-1)*r+p;w<c[z]&&(c[z]=w)}}for(a=0;a<b;++a)c[a]=Math.sqrt(c[a]);if(x.asFill)for(var y of e)for(x=y.length,a=1;a<x;++a)for(e=
y[a-1],b=y[a],e[0]<b[0]?(h=e[0],d=b[0]):(h=b[0],d=e[0]),e[1]<b[1]?(m=e[1],l=b[1]):(m=b[1],l=e[1]),h=Math.floor(h),d=Math.floor(d)+1,m=Math.floor(m),l=Math.floor(l)+1,31>h&&(h=31),d>r-31&&(d=r-31),31>m&&(m=31),l>k-31&&(l=k-31);m<l;++m)if(e[1]>m!==b[1]>m){n=(k-m-1)*r;for(f=h;f<d;++f)f<(b[0]-e[0])*(m-e[1])/(b[1]-e[1])+e[0]&&(c[n+f]=-c[n+f]);for(f=31;f<h;++f)c[n+f]=-c[n+f]}y=c.length;x=new Uint8Array(4*y);for(a=0;a<y;++a)t.packFloatRGBA(.5-c[a]/62,x,4*a);return[x,r,k]};v.getExtent=function(x){return x?
x.rings?A(x.rings):x.paths?A(x.paths):E.isExtent(x)?[x.xmin,x.ymin,x.xmax,x.ymax]:null:null};v.getSDFInfo=u;v.getSDFMetrics=function(x,e,h,d,l){const [m,r,k,c]=x;if(k<m||c<r)return[0,0,0];var b=k-m,a=c-r;x=64/Math.max(b,a);const g=Math.round(b*x),n=Math.round(a*x)+62;a=1;e&&(a=n/x/(e.ymax-e.ymin));let f=0,q=0;b=1;d&&(l?e&&h&&0<e.ymax-e.ymin&&(b=(e.xmax-e.xmin)/(e.ymax-e.ymin),f=d.x/(h*b),q=d.y/h):(f=d.x,q=d.y));f=.5*(e.xmax+e.xmin)+f*(e.xmax-e.xmin);q=.5*(e.ymax+e.ymin)+q*(e.ymax-e.ymin);f=(f-m)*
x+31;q=(q-r)*x+31;e=f/(g+62)-.5;d=q/n-.5;l&&(e*=h*b,d*=h);return[a,e,d]};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(v,t){function E(x,e=0){let h=0;for(let d=0;4>d;d++)h+=x[e+d]*u[d];return h}const B=[1,256,65536,16777216],u=[1/256,1/65536,1/16777216,1/4294967296],A=E(new Uint8ClampedArray([255,255,255,255]));v.packFloatRGBA=function(x,e,h=0){x=t.clamp(x,0,A);for(let m=0;4>m;m++){var d=
Math,l=x*B[m];e[h+m]=d.floor.call(d,256*(l-Math.floor(l)))}};v.unpackFloatRGBA=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(v,t){function E(B,u){if("string"===typeof B)B=t.numericHash(B+`-seed(${u})`);else{let A=12;B^=u;do B=107*(B>>8^B)+A|0;while(0!==--A)}return(1+B/-2147483648)/2}v.getMaterialGroup=function(B){return Math.floor(10*E(B,53290320))};
v.getRandomValue=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(v,t){v.ok=function(E,B){return E&&"name"in E?(B&&B.error(new t(E.name,E.message,E.details)),!1):!0};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l){return function(m){function r(k,c,b){var a=m.call(this,k)||this;a._minMaxZoom=A.i1616to32(Math.round(c*u.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(b*u.MIN_MAX_ZOOM_PRECISION_FACTOR));a._cimLineLayer=k;let g=0;e.isFunction(k.width)||(g=.5*E.pt2px(k.width));a._dynamicPropertyMap.set("_halfWidth",(q,p,z)=>e.isFunction(k.width)?.5*E.pt2px(k.width(q,p,z)):g);e.isFunction(k.cap)?a._dynamicPropertyMap.set("_capType",k.cap):a._capType=k.cap;e.isFunction(k.join)?a._dynamicPropertyMap.set("_joinType",
k.join):a._joinType=k.join;const n=k.color;e.isFunction(n)?a._dynamicPropertyMap.set("_fillColor",(q,p,z)=>B.premultiplyAlphaRGBA(n(q,p,z))):a._fillColor=n&&B.premultiplyAlphaRGBA(n)||0;const f=k.miterLimit;e.isFunction(f)?a._dynamicPropertyMap.set("_miterLimitCosine",(q,p,z)=>e.getLimitCosine(f(q,p,z))):a._miterLimitCosine=e.getLimitCosine(f);t.isSome(k.effects)&&(c=k.effects,e.isFunction(c)?a._dynamicPropertyMap.set("_effects",c):a._effects=c);a._scaleFactor=k.scaleFactor||1;a._isDashed=null!=k.dashTemplate;
a.tessellationProperties._bitset=(k.colorLocked?u.BITSET_GENERIC_LOCK_COLOR:0)|(k.scaleDash?u.BITSET_LINE_SCALE_DASH:0)|(k.sampleAlphaOnly?u.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);a._materialKey=k.materialKey;a._initializeTessellator(!0);return a}v._inheritsLoose(r,m);r.fromCIMLine=function(k,c){const [b,a]=e.getMinMaxZoom(k.scaleInfo,c);return new r(k,b,a)};r.prototype.bindFeature=function(k,c,b){const a=k.readLegacyFeature();this._dynamicPropertyMap.forEach((n,f)=>{this[f]=n(a,c,b)});this._halfWidth*=
this._scaleFactor;k=this._materialCache;var g=this._cimLineLayer.materialHash;g=g(a,c,b);g=k.get(g);k=null;g&&l.ok(g.spriteMosaicItem)&&(k=g.spriteMosaicItem);if(k){this._hasPattern=!0;const {rect:n,width:f,height:q}=k;g=n.x+u.SPRITE_PADDING;const p=n.y+u.SPRITE_PADDING,z=g+f,w=p+q;this.tessellationProperties._tl=A.i1616to32(g,p);this.tessellationProperties._br=A.i1616to32(z,w)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;g=x.LineMaterialKey.load(this._materialKey);k&&(g.sdf=k.sdf,g.pattern=!0,g.textureBinding=k.textureBinding);this._materialKey=g.data};return r}(h(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b){const a=x.create(),g=A.create();return function(n){function f(q,p,z){var w=n.call(this,q)||this;w._cimMarkerLayer=q;w._minMaxZoom=l.i1616to32(Math.round(p*d.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(z*d.MIN_MAX_ZOOM_PRECISION_FACTOR));const y=q.color;r.isFunction(y)?w._dynamicPropertyMap.set("_fillColor",(F,K,J)=>h.premultiplyAlphaRGBA(y(F,K,J))):w._fillColor=h.premultiplyAlphaRGBA(y);const G=q.outlineColor;r.isFunction(G)?w._dynamicPropertyMap.set("_outlineColor",
(F,K,J)=>h.premultiplyAlphaRGBA(G(F,K,J))):w._outlineColor=h.premultiplyAlphaRGBA(G);const H=q.size;r.isFunction(H)?w._dynamicPropertyMap.set("_size",(F,K,J)=>u.pt2px(H(F,K,J))):w._size=u.pt2px(H)||0;p=q.scaleX;r.isFunction(p)?w._dynamicPropertyMap.set("_scaleX",p):w._scaleX=p;const I=q.offsetX;r.isFunction(I)?w._dynamicPropertyMap.set("xOffset",(F,K,J)=>u.pt2px(I(F,K,J))):w.xOffset=u.pt2px(I)||0;const D=q.offsetY;r.isFunction(D)?w._dynamicPropertyMap.set("yOffset",(F,K,J)=>u.pt2px(D(F,K,J))):w.yOffset=
u.pt2px(D)||0;const C=q.outlineWidth;r.isFunction(C)?w._dynamicPropertyMap.set("_outlineWidth",(F,K,J)=>u.pt2px(C(F,K,J))):w._outlineWidth=u.pt2px(C)||0;p=q.rotation;r.isFunction(p)?w._dynamicPropertyMap.set("_angle",p):w._angle=p||0;B.isSome(q.effects)&&(p=q.effects,r.isFunction(p)?w._dynamicPropertyMap.set("_effects",p):w._effects=p);B.isSome(q.markerPlacement)&&(p=q.markerPlacement,r.isFunction(p)?w._dynamicPropertyMap.set("_markerPlacement",p):w._markerPlacement=p);w._scaleFactor=B.unwrapOr(q.scaleFactor,
1);w._bitSet=(q.alignment===e.Alignment.MAP?1:0)|(q.colorLocked?1:0)<<1|(q.scaleSymbolsProportionally?1:0)<<3;w._materialKey=q.materialKey;return w}v._inheritsLoose(f,n);f.fromCIMMarker=function(q,p){const [z,w]=r.getMinMaxZoom(q.scaleInfo,p);return new f(q,z,w)};f.prototype.bindFeature=function(q,p,z){const w=q.readLegacyFeature();q=q.getObjectId();this._dynamicPropertyMap.forEach((ha,U)=>{this[U]=ha(w,p,z)});var y=this._cimMarkerLayer.materialHash;q="function"===typeof y?y(w,p,z,q):y;if((q=this._materialCache.get(q))&&
b.ok(q.spriteMosaicItem)&&q.spriteMosaicItem){q=q.spriteMosaicItem;y=this._cimMarkerLayer.sizeRatio;var G=q.width/q.height*this._scaleX,H=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,I=this._size,D=I*G,C=this.xOffset,F=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var K=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/u.pt2px(this._cimMarkerLayer.frameHeight):1;K*=this._outlineWidth;var J=u.pt2px(this._cimMarkerLayer.referenceSize),
P=0,S=0,X=this._cimMarkerLayer.anchorPoint;X&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(P=u.pt2px(X.x)/(this._size*G),S=u.pt2px(X.y)/this._size):(P=X.x,S=X.y));this._anchorX=P;this._anchorY=S;this._sizeOutlineWidth=l.i8888to32(Math.round(Math.min(Math.sqrt(128*D),255)),Math.round(Math.min(Math.sqrt(128*I),255)),Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*J),255)));this.angle=H;this._bitestAndDistRatio=l.i1616to32(this._bitSet,Math.round(64*y));G=q.rect.x+
d.SPRITE_PADDING;H=q.rect.y+d.SPRITE_PADDING;K=G+q.width;J=H+q.height;this._texUpperLeft=l.i1616to32(G,H);this._texUpperRight=l.i1616to32(K,H);this._texBottomLeft=l.i1616to32(G,J);this._texBottomRight=l.i1616to32(K,J);G=m.MarkerMaterialKey.load(this._materialKey);G.sdf=q.sdf;G.pattern=!0;G.textureBinding=q.textureBinding;this._materialKey=G.data;D=D*y*this._scaleFactor;I=I*y*this._scaleFactor;D*=q.rect.width/q.width;I*=q.rect.height/q.height;this._computedWidth=D;this._computedHeight=I;this._applyTransformation(g,
a);this.xOffset=C;this.yOffset=F}else E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new t("mapview-cim","Encountered an error when binding feature"))};return f}(k(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r){return function(k){function c(a,g,n){var f=k.call(this,a)||this;f._horizontalAlignment="center";f._verticalAlignment="middle";f._textToGlyphs=new Map;f._minMaxZoom=e.i1616to32(Math.round(g*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*x.MIN_MAX_ZOOM_PRECISION_FACTOR));g=a.scaleFactor||1;f._cimTextLayer=a;const q=a.color;d.isFunction(q)?f._dynamicPropertyMap.set("_color",(G,H,I)=>A.premultiplyAlphaRGBA(q(G,H,I))):f._color=A.premultiplyAlphaRGBA(q);const p=a.outlineColor;
d.isFunction(p)?f._dynamicPropertyMap.set("_haloColor",(G,H,I)=>A.premultiplyAlphaRGBA(p(G,H,I))):f._haloColor=A.premultiplyAlphaRGBA(p);let z;d.isFunction(a.size)||(z=Math.min(Math.round(E.pt2px(a.size*a.sizeRatio)),127));f._dynamicPropertyMap.set("_size",(G,H,I)=>d.isFunction(a.size)?Math.min(Math.round(E.pt2px(a.size(G,H,I)*a.sizeRatio)),127):z);d.isFunction(a.outlineSize)?f._dynamicPropertyMap.set("_haloSize",(G,H,I)=>Math.min(Math.floor(5*E.pt2px(a.outlineSize(G,H,I)*a.sizeRatio)),127)):f._haloSize=
Math.min(Math.floor(5*E.pt2px(a.outlineSize*a.sizeRatio)),127);let w;d.isFunction(a.offsetX)||(w=Math.round(E.pt2px(a.offsetX*a.sizeRatio)));f._dynamicPropertyMap.set("_xOffset",(G,H,I)=>d.isFunction(a.offsetX)?Math.round(E.pt2px(a.offsetX(G,H,I)*a.sizeRatio)):w);let y;d.isFunction(a.offsetY)||(y=Math.round(E.pt2px(a.offsetY*a.sizeRatio)));f._dynamicPropertyMap.set("_yOffset",(G,H,I)=>d.isFunction(a.offsetY)?Math.round(E.pt2px(a.offsetY(G,H,I)*a.sizeRatio)):y);d.isFunction(a.angle)?f._dynamicPropertyMap.set("_angle",
a.angle):f._angle=a.angle;d.isFunction(a.horizontalAlignment)?f._dynamicPropertyMap.set("_horizontalAlignment",a.horizontalAlignment):f._horizontalAlignment=a.horizontalAlignment;d.isFunction(a.verticalAlignment)?f._dynamicPropertyMap.set("_verticalAlignment",a.verticalAlignment):f._verticalAlignment=a.verticalAlignment;t.isSome(a.effects)&&(n=a.effects,d.isFunction(n)?f._dynamicPropertyMap.set("_effects",n):f._effects=n);t.isSome(a.markerPlacement)&&(n=a.markerPlacement,d.isFunction(n)?f._dynamicPropertyMap.set("_markerPlacement",
n):f._textPlacement=n);d.isFunction(a.text)?f._dynamicPropertyMap.set("_text",a.text):f._text=a.text;f._scaleFactor=g;g=Math.min(Math.round(E.pt2px(a.referenceSize*a.sizeRatio)),127);f._referenceSize=Math.round(Math.sqrt(256*g));f._materialKey=a.materialKey;g=h.TextMaterialKey.load(f._materialKey);g.sdf=!0;f._bitset=(a.alignment===B.Alignment.MAP?1:0)|(a.colorLocked?1:0)<<1;f._materialKey=g.data;f._decoration="none";f._lineHeight=1;f._lineWidth=512;f._isCIM=!0;return f}v._inheritsLoose(c,k);c.fromCIMText=
function(a,g){const [n,f]=d.getMinMaxZoom(a.scaleInfo,g);return new c(a,n,f)};var b=c.prototype;b.analyze=function(){var a=v._asyncToGenerator(function*(g,n,f,q){var p=n.readLegacyFeature();var z=this._cimTextLayer;p="string"===typeof z.text?z.text:"function"===typeof z.text?z.text(p,f,q):"";(g=yield k.prototype.analyze.call(this,g,n,f,q,r.codepoints(p)))&&g.glyphMosaicItems&&this._textToGlyphs.set(p,g.glyphMosaicItems);return g});return function(g,n,f,q){return a.apply(this,arguments)}}();b.bindFeature=
function(a,g,n){const f=a.readLegacyFeature();this._dynamicPropertyMap.forEach((q,p)=>{this[p]=q(f,g,n)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/x.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=u.getXAnchorDirection(t.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=u.getYAnchorDirection(t.unwrapOr(this._verticalAlignment,"baseline")),a=this._textToGlyphs.get(this._text),this.bindTextInfo(a,!1)):
this._shapingInfo=null};return c}(l(m))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(v){v.codepoints=function(t){const E=Array(t.length);for(let B=0;B<t.length;B++)E[B]=t.charCodeAt(B);return E};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(v,t,E,B,u,A,x,e,h,d){return function(l){function m(r,k,c,b,a,g,n,f,q,p,z,w,y,G,H,I){var D=l.call(this)||this;D._effects=G;r=x.FillMaterialKey.load(r);k&&(r.sdf=k.sdf,r.pattern=!0,r.textureBinding=k.textureBinding);D.fillColor=c;D.tl=b;D.br=a;D.aux21=A.i1616to32(g,n);D.aux22=A.i1616to32(f,q);D.aux3=A.i8888to32(p,z,w,0);D._bitset=y;D._minMaxZoom=A.i1616to32(Math.round(H*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(I*B.MIN_MAX_ZOOM_PRECISION_FACTOR));D._materialKey=r.data;return D}v._inheritsLoose(m,
l);m.fromCIMFill=function(r,k,c){var b=r.color;b=b&&E.premultiplyAlphaRGBA(b)||0;const a=r.materialKey,[g,n]=e.getMinMaxZoom(r.scaleInfo,c);c=(r.colorLocked?B.BITSET_GENERIC_LOCK_COLOR:0)|(r.applyRandomOffset?B.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(r.sampleAlphaOnly?B.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!k)return new m(a,null,b,0,0,0,0,0,0,0,0,0,c,r.effects,g,n);const {rect:f,width:q,height:p}=k;var z=r.scaleX||1,w=f.x+B.SPRITE_PADDING;const y=f.y+B.SPRITE_PADDING;var G=w+q;const H=y+p;var I=
t.pt2px(r.height);let D=Math.round(I);0>=D&&(D=H-y);z=Math.round(z*I);0>=z&&(z=G-w);I=t.pt2px(r.offsetX||0);const C=t.pt2px(-r.offsetY||0);w=A.i1616to32(w,y);G=A.i1616to32(G,H);return new m(a,k,b,w,G,z,D,I,C,128,128,u.degToByte(r.angle),c,r.effects,g,n)};m.fromSimpleFill=function(r,k,c=!1){var {color:b}=r;b=b&&"esriSFSNull"!==r.style&&E.premultiplyAlphaRGBAArray(b)||0;c=c?B.BITSET_GENERIC_LOCK_COLOR:0;const a=r.materialKey;if(k){const {rect:f,width:q,height:p,pixelRatio:z}=k;var g=f.x+B.SPRITE_PADDING;
const w=f.y+B.SPRITE_PADDING;var n=g+q;const y=w+p;g=A.i1616to32(g,w);n=A.i1616to32(n,y);k=new m(a,k,b,g,n,q/z,p/z,0,0,128,128,0,c,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM)}else k=new m(a,null,b,0,0,0,0,0,0,0,0,0,c,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(r);return k};m.fromPictureFill=function(r,k,c=!1){const b=B.PICTURE_FILL_COLOR,{rect:a,width:g,height:n}=k;var f=a.x+B.SPRITE_PADDING,q=a.y+B.SPRITE_PADDING,p=f+g,z=q+n;f=A.i1616to32(f,q);p=A.i1616to32(p,z);z=Math.round(t.pt2px(r.width));
q=Math.round(t.pt2px(r.height));const w=t.pt2px(r.xoffset),y=t.pt2px(-r.yoffset);k=new m(r.materialKey,k,b,f,p,z,q,w,y,128*r.xscale,128*r.yscale,0,c?B.BITSET_GENERIC_LOCK_COLOR:0,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(r);return k};return m}(h(d))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(v,t,E){function B(){B=t._asyncToGenerator(function*(A,x,e){try{yield A.acquire(),
yield x(e),A.release()}catch(h){throw A.release(),h;}});return B.apply(this,arguments)}let u=function(){function A(){this._resolver=null}var x=A.prototype;x.isHeld=function(){return!!this._resolver};x.acquire=function(){var e=t._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=E.createResolver()});return function(){return e.apply(this,arguments)}}();x.release=function(){const e=this._resolver;this._resolver=null;e?.resolve()};return A}();
v.Lock=u;v.withLock=function(A,x,e){return B.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(v,t,E,B,u){const A=function(){var h=t._asyncToGenerator(function*(d,l,m,r){return Promise.all(d.map(k=>e(k,l,m,r)))});
return function(d,l,m,r){return h.apply(this,arguments)}}(),x=function(){var h=t._asyncToGenerator(function*(d,l,m){return new B.ExpandedCIM(yield E.analyzeCIMSymbol(d.data,l,m),d.data,d.rendererKey,d.maxVVSize)});return function(d,l,m){return h.apply(this,arguments)}}(),e=function(){var h=t._asyncToGenerator(function*(d,l,m,r){return d?"cim"===d.type?x(d,l,m):"web-style"===d.type?(d={type:"cim",data:yield u.fetchCIMSymbolReference(d,null,r),rendererKey:d.rendererKey,maxVVSize:d.maxVVSize},x(d,l,
m)):d:null});return function(d,l,m,r){return h.apply(this,arguments)}}();v.cimLayerToRasterizationInfo=function(h){if(!h)return null;const {type:d,cim:l,url:m,materialHash:r}=h,k={cim:l,type:d,mosaicHash:r,url:m,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(d){case "marker":k.size=h.size;k.path=h.path;k.animatedSymbolProperties=h.animatedSymbolProperties;break;case "line":k.dashTemplate=h.dashTemplate;break;case "text":k.text=h.text,k.fontName=
h.fontName}return k};v.expandSymbol=e;v.expandSymbols=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(v,t,E,B){const u={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};let A=function(){function x(e,
h,d,l){const m={minScale:h?.minScale,maxScale:h?.maxScale};var r=m.minScale||m.maxScale?m.minScale+"-"+m.maxScale:"";this.layers=e;this.data=h;this.hash=this._createHash()+r;this.rendererKey=d;h={isOutline:!1,placement:null,symbologyType:E.WGLSymbologyType.DEFAULT,vvFlags:d};for(const k of e)e=u[k.type],h.isOutline="line"===k.type&&k.isOutline,k.materialKey=B.createMaterialKey(e,h),k.maxVVSize=l,k.scaleInfo=m,k.templateHash+=r}x.prototype._createHash=function(){let e="";for(const h of this.layers)e+=
h.templateHash;return e};t._createClass(x,[{key:"type",get:function(){return"expanded-cim"}}]);return x}();v.ExpandedCIM=A;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d){function l(){l=t._asyncToGenerator(function*(b,a,g){if(!b.name)throw new B("style-symbol-reference-name-missing","Missing name in style symbol reference");if(b.styleName&&"Esri2DPointSymbolsStyle"===b.styleName)return m(b,g);try{const n=yield d.fetchStyle(b,a,g);return k(n,b.name,a,g)}catch(n){return A.throwIfAborted(n),null}});return l.apply(this,arguments)}function m(b,a){return r.apply(this,arguments)}function r(){r=t._asyncToGenerator(function*(b,a){b=d.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
b.name);try{const g=yield d.requestJSON(b,a);return d.makeCIMSymbolRef(g.data)}catch(g){return A.throwIfAborted(g),null}});return r.apply(this,arguments)}function k(b,a,g,n){return c.apply(this,arguments)}function c(){c=t._asyncToGenerator(function*(b,a,g,n){var f=b.data;b={portal:g&&u.isSome(g.portal)?g.portal:e.getDefault(),url:x.urlToObject(b.baseUrl),origin:"portal-item"};f=f.items.find(q=>q.name===a);if(!f)throw new B("symbolstyleutils:symbol-name-not-found",`The symbol name '${a}' could not be found`,
{symbolName:a});f=h.fromJSON(d.symbolUrlFromStyleItem(f,"cimRef"),b);E.isDevEnvironment()&&(f=E.adjustStaticAGOUrl(f));try{const q=yield d.requestJSON(f,n);return d.makeCIMSymbolRef(q.data)}catch(q){return A.throwIfAborted(q),null}});return c.apply(this,arguments)}v.fetchCIMSymbolReference=function(b,a,g){return l.apply(this,arguments)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(v){const t=
/^devext.arcgis.com$/,E=/^qaext.arcgis.com$/,B=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,A=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,t,E,/^jsapps.esri.com$/,B,u];v.adjustStaticAGOUrl=function(x,e){return x?(e=e||globalThis.location.hostname)?null!=e.match(t)||null!=e.match(B)?x.replace("static.arcgis.com","staticdev.arcgis.com"):null!=e.match(E)||null!=e.match(u)?x.replace("static.arcgis.com","staticqa.arcgis.com"):x:x:x};v.isDevEnvironment=function(x){x=x||globalThis.location.hostname;
return A.some(e=>null!=x?.match(e))};v.isTelemetryDevEnvironment=function(x){x=x||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(A).some(e=>null!=x?.match(e))};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m,r,k,c,b,a,g,n,f,q,p){const z=H=>Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));var w;let y;const G={PortalGroup:()=>new Promise((H,I)=>v(["./PortalGroup"],D=>H(z(D)),I)),PortalItem:()=>new Promise((H,I)=>v(["./PortalItem"],D=>H(z(D)),I)),PortalUser:()=>new Promise((H,I)=>v(["./PortalUser"],D=>H(z(D)),I))};e=w=function(H){function I(C){C=H.call(this,C)||this;C._esriIdCredentialCreateHandle=null;C.access=null;C.allSSL=
!1;C.authMode="auto";C.authorizedCrossOriginDomains=null;C.basemapGalleryGroupQuery=null;C.bingKey=null;C.canListApps=!1;C.canListData=!1;C.canListPreProvisionedItems=!1;C.canProvisionDirectPurchase=!1;C.canSearchPublic=!0;C.canShareBingPublic=!1;C.canSharePublic=!1;C.canSignInArcGIS=!1;C.canSignInIDP=!1;C.colorSetsGroupQuery=null;C.commentsEnabled=!1;C.created=null;C.culture=null;C.customBaseUrl=null;C.defaultBasemap=null;C.defaultDevBasemap=null;C.defaultExtent=null;C.defaultVectorBasemap=null;
C.description=null;C.devBasemapGalleryGroupQuery=null;C.eueiEnabled=null;C.featuredGroups=null;C.featuredItemsGroupQuery=null;C.galleryTemplatesGroupQuery=null;C.livingAtlasGroupQuery=null;C.hasCategorySchema=!1;C.helperServices=null;C.homePageFeaturedContent=null;C.homePageFeaturedContentCount=null;C.httpPort=null;C.httpsPort=null;C.id=null;C.ipCntryCode=null;C.isPortal=!1;C.isReadOnly=!1;C.layerTemplatesGroupQuery=null;C.maxTokenExpirationMinutes=null;C.modified=null;C.name=null;C.portalHostname=
null;C.portalMode=null;C.portalProperties=null;C.region=null;C.rotatorPanels=null;C.showHomePageDescription=!1;C.sourceJSON=null;C.supportsHostedServices=!1;C.symbolSetsGroupQuery=null;C.templatesGroupQuery=null;C.units=null;C.url=B.portalUrl;C.urlKey=null;C.user=null;C.useStandardizedQuery=!1;C.useVectorBasemaps=!1;C.vectorBasemapGalleryGroupQuery=null;return C}t._inheritsLoose(I,H);var D=I.prototype;D.normalizeCtorArgs=function(C){return"string"===typeof C?{url:C}:C};D.destroy=function(){this._esriIdCredentialCreateHandle=
d.removeMaybe(this._esriIdCredentialCreateHandle)};D.readAuthorizedCrossOriginDomains=function(C){if(C)for(const F of C)B.request.trustedServers.includes(F)||B.request.trustedServers.push(F);return C};D.readDefaultBasemap=function(C){return this._readBasemap(C)};D.readDefaultDevBasemap=function(C){return this._readBasemap(C)};D.readDefaultVectorBasemap=function(C){return this._readBasemap(C)};D.readUrlKey=function(C){return C?C.toLowerCase():C};D.readUser=function(C){let F=null;C&&(F=q.fromJSON(C),
F.portal=this);return F};D.load=function(C){const F=(new Promise((K,J)=>v(["../Basemap"],P=>K(z(P)),J))).then(({default:K})=>{l.throwIfAborted(C);y=K}).then(()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,C)).then(K=>{if(u.id){const J=u.id;this.credential=J.findCredential(this.restUrl);this.credential||this.authMode!==w.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle=J.on("credential-create",()=>{J.findCredential(this.restUrl)&&this._signIn().catch(()=>{})}))}this.sourceJSON=
K;this.read(K)});this.addResolvingPromise(F);return Promise.resolve(this)};D.createElevationLayers=function(){var C=t._asyncToGenerator(function*(){yield this.load();const F=this._getHelperService("defaultElevationLayers"),K=(yield new Promise((J,P)=>v(["../layers/ElevationLayer"],S=>J(z(S)),P))).default;return F?F.map(J=>new K({id:J.id,url:J.url})):[]});return function(){return C.apply(this,arguments)}}();D.fetchBasemaps=function(C,F){const K=new n;K.query=C||(B.apiKey&&p.supportsApiKey(this.url)?
this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);K.disableExtraQuery=!0;return this.queryGroups(K,F).then(J=>{K.num=100;K.query='type:"Web Map" -type:"Web Application"';return J.total?(J=J.results[0],K.sortField=J.sortField||"name",K.sortOrder=J.sortOrder||"desc",J.queryItems(K,F)):null}).then(J=>J&&J.total?J.results.filter(P=>"Web Map"===P.type).map(P=>new y({portalItem:P})):[])};D.fetchCategorySchema=function(C){return this.hasCategorySchema?
this._request(this.restUrl+"/portals/self/categorySchema",C).then(F=>F.categorySchema):l.isAborted(C)?Promise.reject(l.createAbortError()):Promise.resolve([])};D.fetchFeaturedGroups=function(C){const F=this.featuredGroups,K=new n;K.num=100;K.sortField="title";if(F&&F.length){const J=[];for(const P of F)J.push(`(title:"${P.title}" AND owner:${P.owner})`);K.query=J.join(" OR ");return this.queryGroups(K,C).then(P=>P.results)}return l.isAborted(C)?Promise.reject(l.createAbortError()):Promise.resolve([])};
D.fetchRegions=function(C){const F=this.user?.culture||this.culture||g.getLocale();return this._request(this.restUrl+"/portals/regions",{...C,query:{culture:F}})};D.fetchSettings=function(C){const F=this.user?.culture||this.culture||g.getLocale();return this._request(this.restUrl+"/portals/self/settings",{...C,query:{culture:F}})};I.getDefault=function(){if(!w._default||w._default.destroyed)w._default=new w;return w._default};D.queryGroups=function(C,F){return this._queryPortal("/community/groups",
C,"PortalGroup",F)};D.queryItems=function(C,F){return this._queryPortal("/search",C,"PortalItem",F)};D.queryUsers=function(C,F){C.sortField||(C.sortField="username");return this._queryPortal("/community/users",C,"PortalUser",F)};D.toJSON=function(){throw new x("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};I.fromJSON=function(C){if(!C)return null;if(C.declaredClass)throw Error("JSON object is already hydrated");return new w({sourceJSON:C})};D._getHelperService=function(C){const F=
this.helperServices&&this.helperServices[C];if(!F)throw new x("portal:service-not-found",`The \`helperServices\` do not include an entry named "${C}"`);return F};D._getHelperServiceUrl=function(C){const F=this._getHelperService(C);if(!F?.url)throw new x("portal:service-url-not-found",`The \`helperServices\` entry "${C}" does not include a \`url\` value`);return F.url};D._fetchSelf=function(C=this.authMode,F=!1,K){const J=this.restUrl+"/portals/self";C={authMode:C,query:{culture:g.getLocale().toLowerCase()},
...K};"auto"===C.authMode&&(C.authMode="no-prompt");F&&(C.query.default=!0);return this._request(J,C)};D._queryPortal=function(C,F,K,J){const P=k.ensureType(n,F),S=X=>this._request(this.restUrl+C,{...P.toRequestOptions(this),...J}).then(ha=>{const U=P.clone();U.start=ha.nextStart;return new f({nextQueryParams:U,queryParams:P,total:ha.total,results:w._resultsToTypedArray(X,{portal:this},ha,J)})}).then(ha=>Promise.all(ha.results.map(U=>"function"===typeof U.when?U.when():ha)).then(()=>ha,U=>{l.throwIfAbortError(U);
return ha}));return K&&G[K]?G[K]().then(({default:X})=>{l.throwIfAborted(J);return S(X)}):S()};D._signIn=function(){if(this.authMode===w.AUTH_MODE_ANONYMOUS)return Promise.reject(new x("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const C=F=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return F||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>
{if(this.credential)return null;this.credential=F;return this._fetchSelf("immediate")});if(this.user&&this.credential===F)return null;this.credential=F;return this._fetchSelf("immediate")}).then(K=>{K&&(this.sourceJSON=K,this.read(K))});return u.id?u.id.getCredential(this.restUrl).then(F=>C(F)):C(this.credential)};D._normalizeSSL=function(C){return C.replace(/^http:/i,"https:").replace(":7080",":7443")};D._normalizeUrl=function(C){const F=this.credential&&this.credential.token;return this._normalizeSSL(F?
C+(C.includes("?")?"\x26":"?")+"token\x3d"+F:C)};D._requestToTypedArray=function(C,F,K){return this._request(C,F).then(J=>{const P=w._resultsToTypedArray(K,{portal:this},J);return Promise.all(P.map(S=>"function"===typeof S.when?S.when():J)).then(()=>P,()=>P)})};D._readBasemap=function(C){return C?(C=y.fromJSON(C),C.portalItem={portal:this},C):null};D._request=function(C,F={}){const K={f:"json",...F.query},{authMode:J=this.authMode===w.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:P=null,cacheBust:S=
!1,method:X="auto",responseType:ha="json",signal:U}=F;F={authMode:J,body:P,cacheBust:S,method:X,query:K,responseType:ha,timeout:0,signal:U};return A(this._normalizeSSL(C),F).then(Q=>Q.data)};I._resultsToTypedArray=function(C,F,K,J){if(K){const P=d.isSome(J)?J.signal:null;K=K.listings||K.notifications||K.userInvitations||K.tags||K.items||K.groups||K.comments||K.provisions||K.results||K.relatedItems||K;if(C||F)K=K.map(S=>{S=Object.assign(C?C.fromJSON(S):S,F);"function"===typeof S.load&&S.load(P);return S})}else K=
[];return K};t._createClass(I,[{key:"extraQuery",get:function(){const C=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!C?` AND orgid:${this.id}`:null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"itemPageUrl",get:function(){return this.url?`${this.url}/home/item.html`:null}},{key:"restUrl",get:function(){let C=this.url;if(C){const F=C.indexOf("/sharing");C=0<F?C.substring(0,F):this.url.replace(/\/+$/,"");C+="/sharing/rest"}return C}},{key:"thumbnailUrl",
get:function(){const C=this.restUrl,F=this.thumbnail;return C&&F?this._normalizeSSL(C+"/portals/self/resources/"+F):null}}]);return I}(e.JSONSupportMixin(h));e.AUTH_MODE_ANONYMOUS="anonymous";e.AUTH_MODE_AUTO="auto";e.AUTH_MODE_IMMEDIATE="immediate";E.__decorate([m.property()],e.prototype,"access",void 0);E.__decorate([m.property()],e.prototype,"allSSL",void 0);E.__decorate([m.property()],e.prototype,"authMode",void 0);E.__decorate([m.property()],e.prototype,"authorizedCrossOriginDomains",void 0);
E.__decorate([c.reader("authorizedCrossOriginDomains")],e.prototype,"readAuthorizedCrossOriginDomains",null);E.__decorate([m.property()],e.prototype,"basemapGalleryGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"bingKey",void 0);E.__decorate([m.property()],e.prototype,"canListApps",void 0);E.__decorate([m.property()],e.prototype,"canListData",void 0);E.__decorate([m.property()],e.prototype,"canListPreProvisionedItems",void 0);E.__decorate([m.property()],e.prototype,"canProvisionDirectPurchase",
void 0);E.__decorate([m.property()],e.prototype,"canSearchPublic",void 0);E.__decorate([m.property()],e.prototype,"canShareBingPublic",void 0);E.__decorate([m.property()],e.prototype,"canSharePublic",void 0);E.__decorate([m.property()],e.prototype,"canSignInArcGIS",void 0);E.__decorate([m.property()],e.prototype,"canSignInIDP",void 0);E.__decorate([m.property()],e.prototype,"colorSetsGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"commentsEnabled",void 0);E.__decorate([m.property({type:Date})],
e.prototype,"created",void 0);E.__decorate([m.property()],e.prototype,"credential",void 0);E.__decorate([m.property()],e.prototype,"culture",void 0);E.__decorate([m.property()],e.prototype,"currentVersion",void 0);E.__decorate([m.property()],e.prototype,"customBaseUrl",void 0);E.__decorate([m.property()],e.prototype,"defaultBasemap",void 0);E.__decorate([c.reader("defaultBasemap")],e.prototype,"readDefaultBasemap",null);E.__decorate([m.property()],e.prototype,"defaultDevBasemap",void 0);E.__decorate([c.reader("defaultDevBasemap")],
e.prototype,"readDefaultDevBasemap",null);E.__decorate([m.property({type:a})],e.prototype,"defaultExtent",void 0);E.__decorate([m.property()],e.prototype,"defaultVectorBasemap",void 0);E.__decorate([c.reader("defaultVectorBasemap")],e.prototype,"readDefaultVectorBasemap",null);E.__decorate([m.property()],e.prototype,"description",void 0);E.__decorate([m.property()],e.prototype,"devBasemapGalleryGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"eueiEnabled",void 0);E.__decorate([m.property({readOnly:!0})],
e.prototype,"extraQuery",null);E.__decorate([m.property()],e.prototype,"featuredGroups",void 0);E.__decorate([m.property()],e.prototype,"featuredItemsGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"galleryTemplatesGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"livingAtlasGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"hasCategorySchema",void 0);E.__decorate([m.property()],e.prototype,"helpBase",void 0);E.__decorate([m.property()],e.prototype,"helperServices",
void 0);E.__decorate([m.property()],e.prototype,"helpMap",void 0);E.__decorate([m.property()],e.prototype,"homePageFeaturedContent",void 0);E.__decorate([m.property()],e.prototype,"homePageFeaturedContentCount",void 0);E.__decorate([m.property()],e.prototype,"httpPort",void 0);E.__decorate([m.property()],e.prototype,"httpsPort",void 0);E.__decorate([m.property()],e.prototype,"id",void 0);E.__decorate([m.property()],e.prototype,"ipCntryCode",void 0);E.__decorate([m.property({readOnly:!0})],e.prototype,
"isOrganization",null);E.__decorate([m.property()],e.prototype,"isPortal",void 0);E.__decorate([m.property()],e.prototype,"isReadOnly",void 0);E.__decorate([m.property({readOnly:!0})],e.prototype,"itemPageUrl",null);E.__decorate([m.property()],e.prototype,"layerTemplatesGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"maxTokenExpirationMinutes",void 0);E.__decorate([m.property({type:Date})],e.prototype,"modified",void 0);E.__decorate([m.property()],e.prototype,"name",void 0);E.__decorate([m.property()],
e.prototype,"portalHostname",void 0);E.__decorate([m.property()],e.prototype,"portalMode",void 0);E.__decorate([m.property()],e.prototype,"portalProperties",void 0);E.__decorate([m.property()],e.prototype,"region",void 0);E.__decorate([m.property({readOnly:!0})],e.prototype,"restUrl",null);E.__decorate([m.property()],e.prototype,"rotatorPanels",void 0);E.__decorate([m.property()],e.prototype,"showHomePageDescription",void 0);E.__decorate([m.property()],e.prototype,"sourceJSON",void 0);E.__decorate([m.property()],
e.prototype,"staticImagesUrl",void 0);E.__decorate([m.property({json:{name:"2DStylesGroupQuery"}})],e.prototype,"stylesGroupQuery2d",void 0);E.__decorate([m.property({json:{name:"stylesGroupQuery"}})],e.prototype,"stylesGroupQuery3d",void 0);E.__decorate([m.property()],e.prototype,"supportsHostedServices",void 0);E.__decorate([m.property()],e.prototype,"symbolSetsGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"templatesGroupQuery",void 0);E.__decorate([m.property()],e.prototype,"thumbnail",
void 0);E.__decorate([m.property({readOnly:!0})],e.prototype,"thumbnailUrl",null);E.__decorate([m.property()],e.prototype,"units",void 0);E.__decorate([m.property()],e.prototype,"url",void 0);E.__decorate([m.property()],e.prototype,"urlKey",void 0);E.__decorate([c.reader("urlKey")],e.prototype,"readUrlKey",null);E.__decorate([m.property()],e.prototype,"user",void 0);E.__decorate([c.reader("user")],e.prototype,"readUser",null);E.__decorate([m.property()],e.prototype,"useStandardizedQuery",void 0);
E.__decorate([m.property()],e.prototype,"useVectorBasemaps",void 0);E.__decorate([m.property()],e.prototype,"vectorBasemapGalleryGroupQuery",void 0);return e=w=E.__decorate([b.subclass("esri.portal.Portal")],e)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(v,t,E,B,u,A,x,e){const h=d=>{d=function(l){function m(...k){var c=
l.call(this,...k)||this;c._loadController=null;c.loadError=null;c.loadStatus="not-loaded";c._set("loadWarnings",[]);c.addResolvingPromise(new Promise(b=>{const a=c.load.bind(v._assertThisInitialized(c));c.load=g=>{const n=new Promise((f,q)=>{const p=u.onAbortOrThrow(g,q);c.destroyed&&q(new E("load:instance-destroyed",`Instance of '${c.declaredClass||c.constructor.name}' is already destroyed`,{instance:v._assertThisInitialized(c)}));c._promiseProps.when(f,q).finally(()=>{p&&p.remove()})});if("not-loaded"===
c.loadStatus){c._set("loadStatus","loading");const f=c._loadController=new AbortController;a({signal:f.signal});u.onAbort(f.signal,()=>{c._promiseProps.abort()})}b();return n}}));c.when(()=>{c._set("loadStatus","loaded");c._loadController=null},b=>{c._set("loadStatus","failed");c._set("loadError",b);c._loadController=null});return c}v._inheritsLoose(m,l);var r=m.prototype;r.load=function(){return null};r.cancelLoad=function(){if(this.isFulfilled())return this;this._set("loadError",new E("load:cancelled",
"Cancelled"));this._loadController?.abort();return this};v._createClass(m,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]);return m}(d);t.__decorate([x.property({readOnly:!0})],d.prototype,"loaded",null);t.__decorate([x.property({readOnly:!0})],d.prototype,"loadError",void 0);t.__decorate([x.property({clonable:!1})],d.prototype,"loadStatus",void 0);t.__decorate([x.property({type:[A],readOnly:!0})],d.prototype,
"loadWarnings",null);return d=t.__decorate([e.subclass("esri.core.Loadable")],d)};B=function(d){function l(){return d.apply(this,arguments)||this}v._inheritsLoose(l,d);return l}(h(B.EsriPromise));B=t.__decorate([e.subclass("esri.core.Loadable")],B);(function(d){d.LoadableMixin=h;d.isLoadable=function(l){return!(!l||!l.load)}})(B||(B={}));return B})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x){var e;(function(l){l[l.PENDING=0]="PENDING";l[l.RESOLVED=1]="RESOLVED";l[l.REJECTED=2]="REJECTED"})(e||(e={}));let h=function(){function l(r){this.instance=r;this._resolver=A.createDeferred();this._status=e.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=e.RESOLVED;this._cleanUp()},()=>{this._status=e.REJECTED;this._cleanUp()})}var m=l.prototype;m.addResolvingPromise=function(r){this._resolvingPromises.push(r);this._tryResolve()};m.isResolved=
function(){return this._status===e.RESOLVED};m.isRejected=function(){return this._status===e.REJECTED};m.isFulfilled=function(){return this._status!==e.PENDING};m.abort=function(){this._resolver.reject(A.createAbortError())};m.when=function(r,k){return this._resolver.promise.then(r,k)};m._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};m._tryResolve=function(){if(!this.isFulfilled()){var r=A.createDeferred(),k=[...this._resolvingPromises,u.assumeNonNull(r.promise)],
c=this._allPromise=Promise.all(k);c.then(()=>{this.isFulfilled()||this._allPromise!==c||this._resolver.resolve(this.instance)},b=>{this.isFulfilled()||this._allPromise!==c||A.isAbortError(b)||this._resolver.reject(b)});r.resolve()}};return l}();const d=l=>{l=function(m){function r(...c){c=m.call(this,...c)||this;c._promiseProps=new h(t._assertThisInitialized(c));c.addResolvingPromise(Promise.resolve());return c}t._inheritsLoose(r,m);var k=r.prototype;k.isResolved=function(){return this._promiseProps.isResolved()};
k.isRejected=function(){return this._promiseProps.isRejected()};k.isFulfilled=function(){return this._promiseProps.isFulfilled()};k.when=function(c,b){return(new Promise((a,g)=>{this._promiseProps.when(a,g)})).then(c,b)};k.catch=function(c){return this.when(null,c)};k.addResolvingPromise=function(c){c&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in c?c.when():c)};return r}(l);return l=E.__decorate([x.subclass("esri.core.Promise")],l)};v.EsriPromise=function(l){function m(){return l.apply(this,
arguments)||this}t._inheritsLoose(m,l);return m}(d(B));v.EsriPromise=E.__decorate([x.subclass("esri.core.Promise")],v.EsriPromise);v.EsriPromiseMixin=d;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/intl/locale":function(){define(["exports"],function(v){function t(){return e??globalThis.navigator?.language??"en"}function E(){void 0===x&&(x=t());return x}function B(m=E()){return/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(m)?.[1].toLowerCase()}function u(){const m=
A??t();x!==m&&(x=m,[...l].forEach(r=>{r.call(null,m)}),[...d].forEach(r=>{r.call(null,m)}))}let A=void 0,x=void 0;const e=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,h={he:!0,ar:!0},d=[],l=[];globalThis.addEventListener?.("languagechange",u);v.beforeLocaleChange=function(m){l.push(m);return{remove(){d.splice(l.indexOf(m),1)}}};v.getDefaultLocale=t;v.getLanguage=B;v.getLocale=E;v.onLocaleChange=function(m){d.push(m);return{remove(){d.splice(d.indexOf(m),1)}}};v.prefersRTL=function(m=
E()){m=B(m);return void 0!==m&&(h[m]||!1)};v.setLocale=function(m){A=m?m:void 0;u()};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l,m){var r;const k=new B.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});E=r=function(c){function b(g){g=c.call(this,g)||this;g.categories=null;g.disableExtraQuery=!1;g.extent=null;g.filter=null;g.num=10;g.query=null;g.sortField=null;g.start=1;return g}v._inheritsLoose(b,c);var a=b.prototype;a.clone=function(){return new r({categories:this.categories?u.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};a.toRequestOptions=function(g,n){let f;this.categories&&(f=this.categories.map(z=>Array.isArray(z)?JSON.stringify(z):z));let q;if(this.extent){var p=m.project(this.extent,l.WGS84);A.isSome(p)&&(q=`${p.xmin},${p.ymin},${p.xmax},${p.ymax}`)}p=this.query;!this.disableExtraQuery&&g.extraQuery&&(p="("+p+")"+g.extraQuery);g={categories:f,bbox:q,
q:p,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(g.sortField=this.sortField.split(",").map(z=>k.toJSON(z.trim())).join(","),g.sortOrder=this.sortOrder);return{query:{...n,...g}}};v._createClass(b,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(g){"asc"!==g&&"desc"!==g||this._set("sortOrder",g)}}]);return b}(E);t.__decorate([x.property()],E.prototype,"categories",void 0);t.__decorate([x.property()],E.prototype,
"disableExtraQuery",void 0);t.__decorate([x.property({type:d})],E.prototype,"extent",void 0);t.__decorate([x.property()],E.prototype,"filter",void 0);t.__decorate([x.property()],E.prototype,"num",void 0);t.__decorate([x.property()],E.prototype,"query",void 0);t.__decorate([x.property()],E.prototype,"sortField",void 0);t.__decorate([x.property()],E.prototype,"sortOrder",null);t.__decorate([x.property()],E.prototype,"start",void 0);return E=r=t.__decorate([h.subclass("esri.portal.PortalQueryParams")],
E)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),function(v,t,E,B,u,A,x){E=function(e){function h(d){d=e.call(this,d)||this;d.nextQueryParams=null;d.queryParams=null;d.results=null;d.total=null;return d}v._inheritsLoose(h,e);return h}(E);t.__decorate([B.property()],
E.prototype,"nextQueryParams",void 0);t.__decorate([B.property()],E.prototype,"queryParams",void 0);t.__decorate([B.property()],E.prototype,"results",void 0);t.__decorate([B.property()],E.prototype,"total",void 0);return E=t.__decorate([x.subclass("esri.portal.PortalQueryResult")],E)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(v,t,E,B,u,A,x,e,h,d,l){var m;u=m=function(r){function k(...b){b=r.call(this,...b)||this;b.access=null;b.created=null;b.culture=null;b.description=null;b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.sourceJSON=null;b.units=null;b.username=null;b.userType=null;return b}t._inheritsLoose(k,r);var c=k.prototype;c.addItem=function(b){const a=b&&b.item;var g=b&&b.data;b=b&&b.folder;const n=
{method:"post"};a&&(n.query=a.createPostQuery(),null!=g&&("string"===typeof g?n.query.text=g:"object"===typeof g&&(n.query.text=JSON.stringify(g))));g=this.userContentUrl;b&&(g+="/"+("string"===typeof b?b:b.id));return this.portal._request(g+"/addItem",n).then(f=>{a.id=f.id;a.portal=this.portal;return a.loaded?a.reload():a.load()})};c.deleteItem=function(b){let a=this.userContentUrl;b.ownerFolder&&(a+="/"+b.ownerFolder);return this.portal._request(a+`/items/${b.id}/delete`,{method:"post"}).then(()=>
{b.id=null;b.portal=null})};c.deleteItems=function(b){const a=this.userContentUrl+"/deleteItems";var g=b.map(n=>n.id);return g.length?(g={method:"post",query:{items:g.join(",")}},this.portal._request(a,g).then(()=>{b.forEach(n=>{n.id=null;n.portal=null})})):Promise.resolve(void 0)};c.fetchFolders=function(){return this.portal._request(this.userContentUrl??"",{query:{num:1}}).then(b=>b&&b.folders?b.folders.map(a=>{a=d.fromJSON(a);a.portal=this.portal;return a}):[])};c.fetchGroups=function(){return this.portal._request(this.url??
"").then(b=>b&&b.groups?b.groups.map(a=>{a=l.fromJSON(a);a.portal=this.portal;return a}):[])};c.fetchItems=function(b){const a=b??{};let g=this.userContentUrl??"";a.folder&&(g+="/"+a.folder.id);let n;return(new Promise((f,q)=>v(["./PortalItem"],p=>f(Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}))),q))).then(({default:f})=>{n=f;return this.portal._request(g,{query:{folders:!1,num:a.num||10,start:a.start||1,sortField:a.sortField||"created",sortOrder:a.sortOrder||
"asc"}})}).then(f=>{let q;return f&&f.items?(q=f.items.map(p=>{p=n.fromJSON(p);p.portal=this.portal;return p}),Promise.all(q.map(p=>p.load())).catch(p=>p).then(()=>({items:q,nextStart:f.nextStart,total:f.total}))):{items:[],nextStart:-1,total:0}})};c.fetchTags=function(){return this.portal._request(this.url+"/tags").then(b=>b.tags)};c.getThumbnailUrl=function(b){let a=this.thumbnailUrl;a&&b&&(a+=`&w=${b}`);return a};c.queryFavorites=function(b){return this.favGroupId?(this._favGroup||(this._favGroup=
new l({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(b)):Promise.reject(new B("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};c.toJSON=function(){throw new B("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};k.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");const a=new m;a.sourceJSON=b;a.read(b);return a};t._createClass(k,[{key:"thumbnailUrl",get:function(){const b=
this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(`${b}/info/${a}?f=json`):null}},{key:"userContentUrl",get:function(){const b=this.get("portal.restUrl");return b?`${b}/content/users/${this.username}`:null}},{key:"url",get:function(){const b=this.get("portal.restUrl");return b?`${b}/community/users/${this.username}`:null}}]);return k}(u.JSONSupport);E.__decorate([A.property()],u.prototype,"access",void 0);E.__decorate([A.property({type:Date})],u.prototype,"created",void 0);E.__decorate([A.property()],
u.prototype,"culture",void 0);E.__decorate([A.property()],u.prototype,"description",void 0);E.__decorate([A.property()],u.prototype,"email",void 0);E.__decorate([A.property()],u.prototype,"favGroupId",void 0);E.__decorate([A.property()],u.prototype,"fullName",void 0);E.__decorate([A.property({type:Date})],u.prototype,"modified",void 0);E.__decorate([A.property()],u.prototype,"orgId",void 0);E.__decorate([A.property()],u.prototype,"portal",void 0);E.__decorate([A.property()],u.prototype,"preferredView",
void 0);E.__decorate([A.property()],u.prototype,"privileges",void 0);E.__decorate([A.property()],u.prototype,"region",void 0);E.__decorate([A.property()],u.prototype,"role",void 0);E.__decorate([A.property()],u.prototype,"roleId",void 0);E.__decorate([A.property()],u.prototype,"sourceJSON",void 0);E.__decorate([A.property()],u.prototype,"thumbnail",void 0);E.__decorate([A.property({readOnly:!0})],u.prototype,"thumbnailUrl",null);E.__decorate([A.property()],u.prototype,"units",void 0);E.__decorate([A.property({readOnly:!0})],
u.prototype,"userContentUrl",null);E.__decorate([A.property({readOnly:!0})],u.prototype,"url",null);E.__decorate([A.property()],u.prototype,"username",void 0);E.__decorate([A.property()],u.prototype,"userType",void 0);return u=m=E.__decorate([h.subclass("esri.portal.PortalUser")],u)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x,e){B=function(h){function d(l){l=h.call(this,l)||this;l.created=null;l.id=null;l.portal=null;l.title=null;l.username=null;return l}v._inheritsLoose(d,h);d.prototype.toJSON=function(){throw new E("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};v._createClass(d,[{key:"url",get:function(){const l=this.get("portal.restUrl");return l?`${l}/content/users/${this.username}/${this.id}`:null}}]);return d}(B.JSONSupport);t.__decorate([u.property({type:Date})],
B.prototype,"created",void 0);t.__decorate([u.property()],B.prototype,"id",void 0);t.__decorate([u.property()],B.prototype,"portal",void 0);t.__decorate([u.property()],B.prototype,"title",void 0);t.__decorate([u.property({readOnly:!0})],B.prototype,"url",null);t.__decorate([u.property()],B.prototype,"username",void 0);return B=t.__decorate([e.subclass("esri.portal.PortalFolder")],B)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(v,t,E,B,u,A,x,e,h,d){B=function(l){function m(k){k=l.call(this,k)||this;k.access=null;k.created=null;k.description=null;k.id=null;k.isInvitationOnly=!1;k.modified=null;k.owner=null;k.portal=null;k.snippet=null;k.sortField=null;k.sortOrder=null;k.tags=null;k.title=null;return k}v._inheritsLoose(m,l);var r=m.prototype;r.fetchCategorySchema=function(k){return u.unwrapOrThrow(this.portal)._request(this.url+"/categorySchema",k).then(c=>{c=c.categorySchema||[];return c.some(b=>"contentCategorySetsGroupQuery.LivingAtlas"===
b.source)?this._fetchCategorySchemaSet("LivingAtlas",k):c})};r.fetchMembers=function(k){return u.unwrapOrThrow(this.portal)._request(this.url+"/users",k)};r.getThumbnailUrl=function(k){let c=this.thumbnailUrl;c&&k&&(c+=`&w=${k}`);return c};r.toJSON=function(){throw new E("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};r.queryItems=function(k,c){k=e.ensureType(d,k);const b=u.unwrapOrThrow(this.portal);if(5<parseFloat(b.currentVersion))return k=k||new d,b._queryPortal(`/content/groups/${this.id}/search`,
k,"PortalItem",c);k=k?k.clone():new d;k.query="group:"+this.id+(k.query?" "+k.query:"");return b.queryItems(k,c)};r._fetchCategorySchemaSet=function(k,c){const b=u.unwrapOrThrow(this.portal);return b._fetchSelf(b.authMode,!0,c).then(a=>{if(a=a.contentCategorySetsGroupQuery){const g=new d;g.disableExtraQuery=!0;g.num=1;g.query=a;return b.queryGroups(g,c)}throw new E("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(a=>{if(a.total){a=a.results[0];const g=new d;
g.num=1;g.query=`typekeywords:"${k}"`;return a.queryItems(g,c)}throw new E("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(a=>a.total?a.results[0].fetchData("json",c).then(g=>(g=g&&g.categorySchema)&&g.length?g:[]):[])};v._createClass(m,[{key:"thumbnailUrl",get:function(){const k=this.url,c=this.thumbnail;return k&&c&&this.portal?this.portal?._normalizeUrl(`${k}/info/${c}?f=json`):null}},{key:"url",get:function(){const k=this.get("portal.restUrl");return k?
k+"/community/groups/"+this.id:null}}]);return m}(B.JSONSupport);t.__decorate([A.property()],B.prototype,"access",void 0);t.__decorate([A.property({type:Date})],B.prototype,"created",void 0);t.__decorate([A.property()],B.prototype,"description",void 0);t.__decorate([A.property()],B.prototype,"id",void 0);t.__decorate([A.property()],B.prototype,"isInvitationOnly",void 0);t.__decorate([A.property({type:Date})],B.prototype,"modified",void 0);t.__decorate([A.property()],B.prototype,"owner",void 0);t.__decorate([A.property()],
B.prototype,"portal",void 0);t.__decorate([A.property()],B.prototype,"snippet",void 0);t.__decorate([A.property()],B.prototype,"sortField",void 0);t.__decorate([A.property()],B.prototype,"sortOrder",void 0);t.__decorate([A.property()],B.prototype,"tags",void 0);t.__decorate([A.property()],B.prototype,"thumbnail",void 0);t.__decorate([A.property({readOnly:!0})],B.prototype,"thumbnailUrl",null);t.__decorate([A.property()],B.prototype,"title",void 0);t.__decorate([A.property({readOnly:!0})],B.prototype,
"url",null);return B=t.__decorate([h.subclass("esri.portal.PortalGroup")],B)})},"esri/symbols/support/styleUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(v,t,E,B,u,A,x,e,h,d){function l(a,g){return m.apply(this,arguments)}function m(){m=t._asyncToGenerator(function*(a,g){try{return{data:(yield c(a,
g)).data,baseUrl:x.removeFile(a),styleUrl:a}}catch(n){return A.throwIfAbortError(n),null}});return m.apply(this,arguments)}function r(a,g,n){g=u.isSome(g.portal)?g.portal:e.getDefault();let f;const q=`${g.url} - ${g.user&&g.user.username} - ${a}`;b[q]||(b[q]=k(a,g,n).then(p=>{f=p;return p.fetchData()}).then(p=>({data:p,baseUrl:f.itemUrl??"",styleName:a})));return b[q]}function k(a,g,n){return g.load(n).then(()=>{const f=new h({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${a}"`});
return g.queryItems(f,n)}).then(({results:f})=>{let q=null;const p=a.toLowerCase();if(f&&Array.isArray(f))for(const z of f)if(z.typeKeywords?.some(w=>w.toLowerCase()===p)&&"Style"===z.type&&"esri_en"===z.owner){q=z;break}if(!q)throw new B("symbolstyleutils:style-not-found",`The style '${a}' could not be found`,{styleName:a});return q.load(n)})}function c(a,g){g={responseType:"json",query:{f:"json"},...g};return E(x.normalize(a),g)}const b={};v.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
v.fetchStyle=function(a,g,n){return a&&u.isSome(a.styleUrl)?l(a.styleUrl,n):a&&u.isSome(a.styleName)?r(a.styleName,g,n):Promise.reject(new B("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};v.makeCIMSymbolRef=function(a){return null===a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}};v.requestJSON=c;v.symbolUrlFromStyleItem=function(a,g){if("cimRef"===g)return a.cimRef;if(a.formatInfos&&!d.enableWebStyleForceWOSR())for(const n of a.formatInfos)if("gltf"===
n.type)return n.href;return a.webRef};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(v,t){const E=()=>t.cache["enable-feature:direct-3d-object-feature-layer-display"]=!0;v.enableDirect3DObjectFeatureLayerDisplay=()=>!!t("enable-feature:direct-3d-object-feature-layer-display");v.enableSceneLayerEditing=()=>{t.cache["enable-feature:SceneLayer-editing"]=!0;E()};v.enableWebStyleForceWOSR=
()=>!!t("enable-feature:force-wosr");v.sceneLayerEditingEnabled=()=>!!t("enable-feature:SceneLayer-editing");v.turnOnDirect3DObjectFeatureLayerDisplay=E;Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(v,t,E,B,u,A,x,e,h){function d(z,w,y,G){return l.apply(this,arguments)}function l(){l=E._asyncToGenerator(function*(z,w,y,G){switch(z.type){case "simple":case "heatmap":return a.fromBasicRenderer(z,w,y,G);case "map":return f.fromUVRenderer(z,w,y,G);case "interval":return n.fromCBRenderer(z,w,y,G);case "dictionary":return p.fromDictionaryRenderer(z,w,y,G);case "pie-chart":return g.fromPieChartRenderer(z,w,y,G);case "subtype":return g.fromSubtypes(z,w,y,G)}});return l.apply(this,arguments)}
function m(z,w){return r.apply(this,arguments)}function r(){r=E._asyncToGenerator(function*(z,w){const y=z||1;if("number"===typeof y)return(H,I,D)=>y;const G=yield x.createRendererExpression(y,w.spatialReference,w.fields);return(H,I,D)=>e(G,H,{$view:D},w.geometryType,I)||1});return r.apply(this,arguments)}function k(){return c.apply(this,arguments)}function c(){c=E._asyncToGenerator(function*(){q||(q=new Promise((z,w)=>v(["../../../layers/features/createSymbolSchema"],z,w)));return q});return c.apply(this,
arguments)}const b=u.getLogger("esri/views/2d/engine/webgl/util/Matcher");let a=function(){function z(){this.type="feature";this._defaultResult=null}z.fromBasicRenderer=function(){var y=E._asyncToGenerator(function*(G,H,I,D){const C=new z;G.symbol&&(G=yield h.expandSymbol(G.symbol,I,D),H=H.createTemplateGroup(G,null),C.setDefault(H));return C});return function(G,H,I,D){return y.apply(this,arguments)}}();z.fromPieChartRenderer=function(){var y=E._asyncToGenerator(function*(G,H,I,D){const C=new z;if(G.markerSymbol){const F=
yield h.expandSymbol(G.markerSymbol,I,D);let K;G.fillSymbol&&(K=yield h.expandSymbol(G.fillSymbol,I,D));G=H.createTemplateGroup(F,K);C.setDefault(G)}return C});return function(G,H,I,D){return y.apply(this,arguments)}}();var w=z.prototype;w.size=function(){return 1};w.getDefault=function(){return this._defaultResult};w.setDefault=function(y){this._defaultResult=y};w.match=function(y,G,H,I,D){return this.getDefault()};w.analyze=function(){var y=E._asyncToGenerator(function*(G,H,I,D,C,F){return null});
return function(G,H,I,D,C,F){return y.apply(this,arguments)}}();return z}(),g=function(z){function w(y,G){var H=z.call(this)||this;H._subMatchers=y;H._subtypeField=G;return H}E._inheritsLoose(w,z);w.fromSubtypes=function(){var y=E._asyncToGenerator(function*(G,H,I,D){const C=new Map,F=[];for(const K in G.renderers){const J=parseInt(K,10),P=d(G.renderers[K],H,I,D).then(S=>C.set(J,S));F.push(P)}yield Promise.all(F);return new w(C,G.subtypeField)});return function(G,H,I,D){return y.apply(this,arguments)}}();
w.prototype.match=function(y,G,H,I,D){var C=G.readAttribute(this._subtypeField);return(C=this._subMatchers.get(C))?C.match(y,G,H,I,D):null};return w}(a),n=function(z){function w(G,H,I,D){var C=z.call(this)||this;C.type="interval";C._intervals=[];C._isMaxInclusive=H;C._fieldIndex=D;C._field=G;C._normalizationInfo=I;return C}E._inheritsLoose(w,z);w.fromCBRenderer=function(){var G=E._asyncToGenerator(function*(H,I,D,C){const {isMaxInclusive:F,normalizationField:K,normalizationTotal:J,normalizationType:P}=
H,S=new w(H.field,F,{normalizationField:K,normalizationTotal:J,normalizationType:P},H.fieldIndex),X=yield h.expandSymbol(H.backgroundFillSymbol,D,C);yield Promise.all(H.intervals.map(function(){var ha=E._asyncToGenerator(function*(U){var Q=yield h.expandSymbol(U.symbol,D,C);Q=yield I.createTemplateGroup(Q,X);S.add({min:U.min,max:U.max},Q)});return function(U){return ha.apply(this,arguments)}}()));if(H=yield h.expandSymbol(H.defaultSymbol,D,C))H=yield I.createTemplateGroup(H,X),S.setDefault(H);return S});
return function(H,I,D,C){return G.apply(this,arguments)}}();var y=w.prototype;y.add=function(G,H){this._intervals.push({interval:G,result:H});this._intervals.sort((I,D)=>I.interval.min-D.interval.min)};y.size=function(){return z.prototype.size.call(this)+this._intervals.length};y.match=function(G,H,I,D,C){if(null==this._fieldIndex&&!this._field)return this.getDefault();G=null!=this._fieldIndex?H.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(H);if(null===G||void 0===G||isNaN(G)||
Infinity===G||-Infinity===G)return this.getDefault();for(H=0;H<this._intervals.length;H++){const {interval:F,result:K}=this._intervals[H];I=this._isMaxInclusive?G<=F.max:G<F.max;if(G>=F.min&&I)return K}return this.getDefault()};y._needsNormalization=function(){const G=this._normalizationInfo;return G&&(G.normalizationField||G.normalizationTotal||G.normalizationType)};y._getValueFromField=function(G){const H=G.readAttribute(this._field);if(!this._needsNormalization()||null==H)return H;const {normalizationField:I,
normalizationTotal:D,normalizationType:C}=this._normalizationInfo;G=!!I&&G.readAttribute(I);if(C)switch(C){case "esriNormalizeByField":return(G||void 0)&&H/G;case "esriNormalizeByLog":return Math.log(H)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return H/D*100;default:b.error(`Found unknown normalization type: ${C}`)}else b.error("Normalization is required, but no type was set!")};return w}(a),f=function(z){function w(G,H,I){var D=z.call(this)||this;D.type="map";D._nullResult=null;D._resultsMap=
new Map;D._fieldsIndex=I;D._fields=G;D._seperator=H||"";return D}E._inheritsLoose(w,z);w.fromUVRenderer=function(){var G=E._asyncToGenerator(function*(H,I,D,C){const F=H.fieldDelimiter,K=[H.field];H.field2&&K.push(H.field2);H.field3&&K.push(H.field3);const J=yield h.expandSymbol(H.backgroundFillSymbol,D,C),P=new w(K,F,H.fieldIndex);yield Promise.all(H.map.map(function(){var S=E._asyncToGenerator(function*(X){var ha=yield h.expandSymbol(X.symbol,D,C);ha=yield I.createTemplateGroup(ha,J);"\x3cNull\x3e"===
X.value?P.setNullResult(ha):P.add(X.value,ha)});return function(X){return S.apply(this,arguments)}}()));if(H=yield h.expandSymbol(H.defaultSymbol,D,C))H=yield I.createTemplateGroup(H,J),P.setDefault(H);return P});return function(H,I,D,C){return G.apply(this,arguments)}}();var y=w.prototype;y.setNullResult=function(G){this._nullResult=G};y.add=function(G,H){this._resultsMap.set(G.toString(),H)};y.size=function(){return z.prototype.size.call(this)+this._resultsMap.size};y.match=function(G,H,I,D,C){if(null==
this._fieldsIndex&&!this._fields)return this.getDefault();G=null!=this._fieldsIndex?H.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(H);if(null!==this._nullResult&&(null==G||""===G||"\x3cNull\x3e"===G))return this._nullResult;if(null==G)return this.getDefault();G=G.toString();return this._resultsMap.has(G)?this._resultsMap.get(G):this.getDefault()};y._getValueFromFields=function(G){const H=[];for(const I of this._fields){const D=G.readAttribute(I);null==D||""===D?H.push("\x3cNull\x3e"):
H.push(D)}return H.join(this._seperator)};return w}(a),q,p=function(z){function w(G,H,I,D,C,F){var K=z.call(this)||this;K.type="dictionary";K._groupIdCache=new A(100);K._loader=G;K._fieldMap=G.fieldMap;K._symbolFields=G.getSymbolFields();K._templates=H;K._info=I;K._scaleFn=D;K._schemaUtilsModule=C;K._symbolOptions=F;return K}E._inheritsLoose(w,z);w.fromDictionaryRenderer=function(){var G=E._asyncToGenerator(function*(H,I,D,C){const [{DictionaryLoader:F},K]=yield Promise.all([new Promise((P,S)=>v(["../../../../../renderers/support/DictionaryLoader"],
P,S)),k()]);C=new F(H.url,H.config,H.fieldMap);yield C.fetchResources({spatialReference:D.spatialReference,fields:D.fields});const J=yield m(H.scaleExpression,D);return new w(C,I,D,J,K,H.symbolOptions)});return function(H,I,D,C){return G.apply(this,arguments)}}();var y=w.prototype;y._analyzeFeature=function(){var G=E._asyncToGenerator(function*(H,I,D,C,F){H=H.readLegacyFeature();const K=this._scaleFn(H,D,C);D=this._attributeHash(H)+"-"+K;const J=this._groupIdCache.get(D);if(J)return J;C=yield this._loader.getSymbolAsync(H,
{...C,spatialReference:this._info.spatialReference,abortOptions:F,fields:this._info.fields});C=this._schemaUtilsModule.createSymbolSchema(C,this._symbolOptions);I=h.expandSymbol(C,this._info,I,F).then(P=>{if("expanded-cim"!==P.type)return b.error(new B("mapview-bad-type",`Found unexpected type ${P.type} in dictionary response`)),null;P.hash+="-"+K;for(const S of P.layers)S.scaleFactor=K,S.templateHash+="-"+K;return this._templates.createTemplateGroup(P,null)});this._groupIdCache.put(D,I,1);return I});
return function(H,I,D,C,F){return G.apply(this,arguments)}}();y.analyze=function(){var G=E._asyncToGenerator(function*(H,I,D,C,F,K){H=I.getCursor();for(I=[];H.next();)I.push(this._analyzeFeature(H,D,C,F,K));return Promise.all(I)});return function(H,I,D,C,F,K){return G.apply(this,arguments)}}();y.match=function(G,H,I,D,C){return null};y._attributeHash=function(G){let H="";for(const I of this._symbolFields){const D=this._fieldMap[I];D&&(H+=G.attributes[D]+"-")}return H};return w}(a);t.DictionaryMatcher=
p;t.FeatureMatcher=a;t.IntervalMatcher=n;t.MapMatcher=f;t.SubtypeMatcher=g;t.createMatcher=d;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(v,t){return function(){function E(u,A){this._storage=new t.MemCacheStorage;this._storage.maxSize=u;A&&this._storage.registerRemoveFunc("",A)}var B=E.prototype;B.put=function(u,A,x){this._storage.put(u,A,x,1)};B.pop=
function(u){return this._storage.pop(u)};B.get=function(u){return this._storage.get(u)};B.clear=function(){this._storage.clearAll()};B.destroy=function(){this._storage.destroy()};v._createClass(E,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(u){this._storage.maxSize=u}}]);return E}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(v,t,E,B,u,A,x){E=function(e){function h(){return e.apply(this,arguments)||this}v._inheritsLoose(h,e);var d=h.prototype;d.initialize=function(){};d.destroy=function(){};v._createClass(h,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const l=this.get("tileStore.tileScheme.spatialReference");return l&&l.toJSON()||null}}]);return h}(E.HandleOwner);t.__decorate([B.property({readOnly:!0})],E.prototype,"supportsTileUpdates",null);t.__decorate([B.property({constructOnly:!0})],
E.prototype,"remoteClient",void 0);t.__decorate([B.property({constructOnly:!0})],E.prototype,"service",void 0);t.__decorate([B.property()],E.prototype,"spatialReference",null);t.__decorate([B.property({constructOnly:!0})],E.prototype,"tileInfo",void 0);t.__decorate([B.property({constructOnly:!0})],E.prototype,"tileStore",void 0);return E=t.__decorate([x.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],E)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(v,t){return function(){function E(u){this._remoteClient=u;this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var B=E.prototype;B.destroy=function(){};B.fetchResource=function(){var u=v._asyncToGenerator(function*(A,x){const e=this._resourceMap;var h=e.get(A);if(h||(h=this._inFlightResourceMap.get(A)))return h;try{h=this._remoteClient.invoke("tileRenderer.fetchResource",{url:A},{...x}),this._inFlightResourceMap.set(A,h),
h.then(d=>{this._inFlightResourceMap.delete(A);e.set(A,d);return d})}catch(d){return t.isAbortError(d)?null:{width:0,height:0}}return h});return function(A,x){return u.apply(this,arguments)}}();B.getResource=function(u){return this._resourceMap.get(u)??null};return E}()})},"*noref":1}});
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(v,
t,E,B,u,A,x,e,h,d,l,m,r,k,c,b){E=function(a){function g(){var f=a.apply(this,arguments)||this;f.controller=null;f.processor=null;f.remoteClient=null;f.tileStore=null;f.service=null;f.viewState=null;f._paused=!1;f._pendingTileUpdates=[];return f}v._inheritsLoose(g,a);var n=g.prototype;n.initialize=function(){this.handles.add(u.watch(()=>this.updating,f=>{this.remoteClient.invoke("setUpdating",f).catch(q=>{})}))};n.destroy=function(){this.stop();this.controller?.destroy();this.processor?.destroy();
this.controller=this.processor=this.tileStore=this.remoteClient=null};n.stop=function(){this._paused=!0;Array.isArray(this.service?.source)&&(this.service.source.forEach(f=>f.close()),this.service.source.length=0);this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(f=>f.id)});this.tileStore?.destroy();this.tileStore=null;this._pendingTileUpdates.length=0};n.startup=function(){var f=v._asyncToGenerator(function*({service:q,config:p,tileInfo:z,tiles:w}){this._paused=!0;Array.isArray(this.service?.source)&&
(this.service.source.forEach(y=>y.close()),this.service.source.length=0);this.service=q;this.tileStore&&d.equals(this.tileStore.tileScheme.spatialReference,z.spatialReference)||(q=new b(l.fromJSON(z)),w.added.length=w.removed.length=0,this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(y=>y.id)}),this.tileStore?.destroy(),this.tileStore=new k(q),this._pendingTileUpdates.length=0);yield this._createProcessorAndController(p);yield this.update({config:p});this.controller.resume();
this.tileStore.clear();this.tileStore.updateTiles(w);for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())});return function(q){return f.apply(this,arguments)}}();n.updateTiles=function(){var f=v._asyncToGenerator(function*(q){this._paused?this._pendingTileUpdates.push(q):this.tileStore.updateTiles(q)});return function(q){return f.apply(this,arguments)}}();n.update=function(){var f=v._asyncToGenerator(function*({config:q}){const p=c.UpdateToken.empty();
yield Promise.all([this.processor.update(p,q),this.controller.update(p,q)]);return p.toJSON()});return function(q){return f.apply(this,arguments)}}();n.applyUpdate=function(){var f=v._asyncToGenerator(function*(q){return this.controller.applyUpdate(c.UpdateToken.create(q))});return function(q){return f.apply(this,arguments)}}();n._createProcessorAndController=function(){var f=v._asyncToGenerator(function*(q){yield Promise.all([this._handleControllerConfig(q),this._handleProcessorConfig(q)]);this.controller.processor=
this.processor});return function(q){return f.apply(this,arguments)}}();n._handleControllerConfig=function(){var f=v._asyncToGenerator(function*(q){return this._createController(this.service,q)});return function(q){return f.apply(this,arguments)}}();n._handleProcessorConfig=function(){var f=v._asyncToGenerator(function*(q){return this._createProcessor(this.service,q)});return function(q){return f.apply(this,arguments)}}();n._createController=function(){var f=v._asyncToGenerator(function*(q,p){this.controller&&
this.controller.destroy();const {tileStore:z,remoteClient:w}=this;return this.controller=q=new r({service:q,tileStore:z,remoteClient:w})});return function(q,p){return f.apply(this,arguments)}}();n._createProcessor=function(){var f=v._asyncToGenerator(function*(q,p){const z=(yield m.loadProcessorModule(p.schema.processors[0].type)).default,{remoteClient:w,tileStore:y}=this;q=new z({service:q,config:p,tileStore:y,remoteClient:w});this.processor&&this.processor.destroy();return this.processor=q});return function(q,
p){return f.apply(this,arguments)}}();v._createClass(g,[{key:"updating",get:function(){return!this.controller||this.controller.updating}}]);return g}(E.HandleOwner);t.__decorate([A.property()],E.prototype,"controller",void 0);t.__decorate([A.property()],E.prototype,"processor",void 0);t.__decorate([A.property()],E.prototype,"updating",null);t.__decorate([A.property()],E.prototype,"viewState",void 0);return E=t.__decorate([h.subclass("esri.views.2d.layers.features.Pipeline")],E)});