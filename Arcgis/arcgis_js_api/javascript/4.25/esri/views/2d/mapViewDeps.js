// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/reactiveUtils ../../../core/scheduling ../../../chunks/mat3f32 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/BufferPool ./webgl/enums ./webgl/Painter ./webgl/Profiler ../support/Timeline ../../support/screenshotUtils ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/RenderingContext ../../../core/imageUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f){let n=function(z){function x(D,F){var G=z.call(this)||this;G._trash=new Set;G._renderRemainingTime=0;G._lastFrameRenderTime=0;G.renderRequested=!1;G.stage=t._assertThisInitialized(G);G._stationary=!0;const {canvas:H=document.createElement("canvas"),alpha:J=!0,stencil:L=!0,contextOptions:K={}}=F;G._canvas=H;const U=w.createContextOrErrorHTML("2d",H,{alpha:J,antialias:!1,depth:!0,stencil:L});G.context=new g.RenderingContext(y.isSome(U)?U:null,K);
G.resourceManager=new a;G.painter=new p(G.context,t._assertThisInitialized(G),G.resourceManager);A("esri-2d-profiler")&&(G._debugOutput=document.createElement("div"),G._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),D.appendChild(G._debugOutput));G._renderParameters={drawPhase:0,state:G.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:G.context,painter:G.painter,
timeline:F.timeline||new v.Timeline,renderingOptions:F.renderingOptions,requestRender:()=>G.requestRender(),allowDelayedRender:!1,requireFBO:!1,profiler:new r.Profiler(G.context,G._debugOutput),dataUploadCounter:0};G._taskHandle=l.addFrameTask({render:X=>G.renderFrame(X)});G._taskHandle.pause();G._lostWebGLContextHandle=C.on(H,"webglcontextlost",()=>{G.emit("webgl-error",{error:new E("webgl-context-lost")})});G._bufferPool=new d.BufferPool;H.setAttribute("style","width: 100%; height:100%; display:block;");
D.appendChild(H);return G}t._inheritsLoose(x,z);var B=x.prototype;B.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._taskHandle=null;this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this._bufferPool.destroy();this.highlightOptions=
null;this.resourceManager.destroy();this.painter.dispose();this.context.dispose();this._canvas=null};B.trashDisplayObject=function(D){this._trash.add(D);this.requestRender()};B.untrashDisplayObject=function(D){return this._trash.delete(D)};B.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};B.renderFrame=function(D){this._renderRemainingTime-=this._lastFrameRenderTime?D.time-this._lastFrameRenderTime:
0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=D.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=D.time;this._renderParameters.deltaTime=D.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};
B._createTransforms=function(){return{dvs:c.create()}};B.renderChildren=function(D){for(const F of this.children)F.beforeRender(D);this._renderChildren(this.children,D);for(const F of this.children)F.afterRender(D)};B._renderChildren=function(D,F){const G=this.context;this.painter.textureUploadManager.upload();G.resetInfo();F.profiler.recordStart("drawLayers");F.dataUploadCounter=0;F.drawPhase=e.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(G,this.background);for(const H of D)H.processRender(F);
this.painter.prepareDisplay(F,this.background,this.state.padding);this.painter.renderLayers(G);F.drawPhase=e.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(G);for(const H of D)H.processRender(F);this.painter.renderLayers(G);if(this._isLabelDrawPhaseRequired(D)){F.drawPhase=e.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(G);for(const H of D)H.processRender(F);this.painter.renderLayers(G)}if(A("esri-tiles-debug")){F.drawPhase=e.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(G);for(const H of D)H.processRender(F);
this.painter.renderLayers(G)}F.profiler.recordEnd("drawLayers");G.logInfo()};B.doRender=function(D){const F=this.context,{state:G,pixelRatio:H}=D;this._resizeCanvas(D);F.setViewport(0,0,H*G.size[0],H*G.size[1]);F.setDepthWriteEnabled(!0);F.setStencilWriteMask(255);z.prototype.doRender.call(this,D)};B.takeScreenshot=function(){var D=t._asyncToGenerator(function*(F){const {framebufferWidth:G,framebufferHeight:H}={framebufferWidth:Math.round(this.state.size[0]*F.resolutionScale),framebufferHeight:Math.round(this.state.size[1]*
F.resolutionScale)};var J=this.context,L=this._state.clone();if(null!=F.rotation){var K=L.viewpoint;L.viewpoint.rotation=F.rotation;L.viewpoint=K}var U={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:L,pixelRatio:1,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const X=new k.FramebufferObject(J,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:G,height:H});L=J.getBoundFramebufferObject();
K=J.getViewport();J.bindFramebuffer(X);J.setViewport(0,0,G,H);this._renderChildren(F.children,U);U=this._readbackScreenshot(X,{...F.cropArea,y:H-(F.cropArea.y+F.cropArea.height)});J.bindFramebuffer(L);J.setViewport(K.x,K.y,K.width,K.height);this.requestRender();J=yield U;1===F.outputScale?F=J:(F=new ImageData(Math.round(J.width*F.outputScale),Math.round(J.height*F.outputScale)),h.resampleHermite(J,F,!0));return F});return function(F){return D.apply(this,arguments)}}();B._readbackScreenshot=function(){var D=
t._asyncToGenerator(function*(F,G){const H=f.createEmptyImageData(G.width,G.height,document.createElement("canvas"));yield F.readPixelsAsync(G.x,G.y,G.width,G.height,u.PixelFormat.RGBA,u.PixelType.UNSIGNED_BYTE,new Uint8Array(H.data.buffer));return H});return function(F,G){return D.apply(this,arguments)}}();B._resizeCanvas=function(D){const F=this._canvas,G=F.style,{state:{size:H},pixelRatio:J}=D;D=H[0];const L=H[1],K=Math.round(D*J),U=Math.round(L*J);if(F.width!==K||F.height!==U)F.width=K,F.height=
U;G.width=D+"px";G.height=L+"px"};B._emptyTrash=function(){for(;0<this._trash.size;){const D=Array.from(this._trash);this._trash.clear();for(const F of D)F.processDetach()}};B._isLabelDrawPhaseRequired=function(D){let F=!1;for(const G of D){if(!(G instanceof b.Container)){F=F||!1;break}if(G.hasLabels)return!0;F=F||this._isLabelDrawPhaseRequired(G.children)}return F};t._createClass(x,[{key:"background",get:function(){return this._background},set:function(D){this._background=D;this.requestRender()}},
{key:"bufferPool",get:function(){return this._bufferPool}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(D){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=D)this._highlightOptionsHandle=m.watch(()=>this._highlightOptions?.version,()=>{this.painter.setHighlightOptions(D);this.requestRender()},m.initial)}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(D){this._renderingOptions=
D;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(D){this._state=D;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(D){this._stationary!==D&&(this._stationary=D,this.requestRender())}}]);return x}(b.Container);q.EXTRA_RENDER_TIME=2E3;q.Stage=n;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMResourceManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/promiseUtils ../../views/2d/engine/webgl/animatedFormats/apng ../../views/2d/engine/webgl/animatedFormats/gif".split(" "),
function(q,t,E,C,A,y){function m(e,p){return l.apply(this,arguments)}function l(){l=q._asyncToGenerator(function*(e,p){e=window.URL.createObjectURL(e);try{const {data:r}=yield t(e,{...p,responseType:"image"});return r}catch(r){if(!C.isAbortError(r))throw new E("mapview-invalid-resource",`Could not fetch requested resource at ${e}`);throw r;}finally{window.URL.revokeObjectURL(e)}});return l.apply(this,arguments)}function c(e,p){return a.apply(this,arguments)}function a(){a=q._asyncToGenerator(function*(e,
p){const {arrayBuffer:r,mediaType:v}=yield b(e,p);e="image/png"===v;if("image/gif"===v&&y.isAnimatedGIF(r))return y.parseGif(r,p);if(e&&A.isAnimatedPNG(r))return A.parseApng(r,p);e=new Blob([r],{type:v});return m(e,p)});return a.apply(this,arguments)}function b(e,p){return d.apply(this,arguments)}function d(){d=q._asyncToGenerator(function*(e,p){if(e.includes(";base64,")){p=e.indexOf(";base64,");var r=e.indexOf(";base64,")+8;r=e.substring(r);r=atob(r);var v=new Uint8Array(r.length);for(var h=0;h<
r.length;h++)v[h]=r.charCodeAt(h);r=v.buffer;e=e.substring(0,p).replace("data:","");r={arrayBuffer:r,mediaType:e}}else try{v=yield t(e,{responseType:"array-buffer",...p});h=v.data;const w=v.getHeader("Content-Type");r={arrayBuffer:h,mediaType:w}}catch(w){if(!C.isAbortError(w))throw new E("mapview-invalid-resource",`Could not fetch requested resource at ${e}`);}return r});return d.apply(this,arguments)}return function(){function e(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=
null}var p=e.prototype;p.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};p.getResource=function(r){return this._resourceMap.get(r)??null};p.fetchResource=function(){var r=q._asyncToGenerator(function*(v,h){var w=this._resourceMap.get(v);if(w)return{width:w.width,height:w.height};if(w=this._inFlightResourceMap.get(v))return w.then(u=>({width:u.width,height:u.height}));h=c(v,h);this._inFlightResourceMap.set(v,w);return h.then(u=>{this._inFlightResourceMap.delete(v);this._resourceMap.set(v,
u);return{width:u.width,height:u.height}},()=>({width:0,height:0}))});return function(v,h){return r.apply(this,arguments)}}();p.deleteResource=function(r){this._inFlightResourceMap.delete(r);this._resourceMap.delete(r)};return e}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/_commonjsHelpers","../../../../../core/promiseUtils","../../../../../core/time"],function(q,t,E,C,A){function y(){y=
t._asyncToGenerator(function*(b,d){b=c(b);if(b instanceof Error)throw b;yield b.createImages();C.throwIfAborted(d);const {frames:e,width:p,height:r}=b;d=document.createElement("canvas");d.width=p;d.height=r;d=d.getContext("2d");const v=[];b=[];for(const w of e){b.push(A.Milliseconds(w.delay||100));var h=w.imageElement;d.globalCompositeOperation=0===w.blendOp?"copy":"source-over";const u=2===w.disposeOp&&d.getImageData(w.left,w.top,w.width,w.height);d.drawImage(h,w.left,w.top);h=d.getImageData(0,0,
p,r);v.push(h);0!==w.disposeOp&&(1===w.disposeOp?d.clearRect(w.left,w.top,w.width,w.height):2===w.disposeOp&&d.putImageData(u,w.left,w.top))}return{frameDurations:b,getFrame:w=>v[w],width:p,height:r}});return y.apply(this,arguments)}function m(b){const d=new Uint8Array(b);return!a.some((e,p)=>e!==d[p])}var l={exports:{}};(function(b,d){(function(e,p){b.exports=p()})(E.commonjsGlobal,function(){return function(e){function p(v){if(r[v])return r[v].exports;var h=r[v]={exports:{},id:v,loaded:!1};e[v].call(h.exports,
h,h.exports,p);h.loaded=!0;return h.exports}var r={};p.m=e;p.c=r;p.p="";return p(0)}([function(e,p,r){function v(x,B){var D=new DataView(x.buffer),F=8,G=void 0,H=void 0,J=void 0;do H=D.getUint32(F),G=F+4,G=Array.prototype.slice.call(x.subarray(G,G+4)),G=String.fromCharCode.apply(String,G),J=B(G,x,F,H),F+=12+H;while(!1!==J&&"IEND"!=G&&F<x.length)}function h(x,B,D){var F=new Uint8Array(D);F.set(x.subarray(B,B+D));return F}Object.defineProperty(p,"__esModule",{value:!0});p.isNotPNG=function(x){return x===
k};p.isNotAPNG=function(x){return x===g};p.default=function(x){var B=new Uint8Array(x);if(Array.prototype.some.call(f,function(Z,aa){return Z!==B[aa]}))return k;var D=!1;v(B,function(Z){return!(D="acTL"===Z)});if(!D)return g;var F=[],G=[],H=null,J=null,L=0,K=new u.APNG;v(B,function(Z,aa,da,R){var M=new DataView(aa.buffer);switch(Z){case "IHDR":H=aa.subarray(da+8,da+8+R);K.width=M.getUint32(da+8);K.height=M.getUint32(da+12);break;case "acTL":K.numPlays=M.getUint32(da+8+4);break;case "fcTL":J&&(K.frames.push(J),
L++);J=new u.Frame;J.width=M.getUint32(da+8+4);J.height=M.getUint32(da+8+8);J.left=M.getUint32(da+8+12);J.top=M.getUint32(da+8+16);Z=M.getUint16(da+8+20);aa=M.getUint16(da+8+22);0===aa&&(aa=100);J.delay=1E3*Z/aa;10>=J.delay&&(J.delay=100);K.playTime+=J.delay;J.disposeOp=M.getUint8(da+8+24);J.blendOp=M.getUint8(da+8+25);J.dataParts=[];0===L&&2===J.disposeOp&&(J.disposeOp=1);break;case "fdAT":J&&J.dataParts.push(aa.subarray(da+8+4,da+8+R));break;case "IDAT":J&&J.dataParts.push(aa.subarray(da+8,da+8+
R));break;case "IEND":G.push(h(aa,da,12+R));break;default:F.push(h(aa,da,12+R))}});J&&K.frames.push(J);if(0==K.frames.length)return g;var U=new Blob(F),X=new Blob(G);K.frames.forEach(function(Z){var aa=[];aa.push(f);H.set(z(Z.width),0);H.set(z(Z.height),4);aa.push(n("IHDR",H));aa.push(U);Z.dataParts.forEach(function(da){return aa.push(n("IDAT",da))});aa.push(X);Z.imageData=new Blob(aa,{type:"image/png"});delete Z.dataParts;aa=null});return K};var w=(e=r(1))&&e.__esModule?e:{default:e},u=r(2),k=Error("Not a PNG"),
g=Error("Not an animated PNG"),f=new Uint8Array([137,80,78,71,13,10,26,10]),n=function(x,B){var D=x.length+B.length,F=new Uint8Array(D+8),G=new DataView(F.buffer);G.setUint32(0,B.length);for(var H=F.set,J=new Uint8Array(x.length),L=0;L<x.length;L++)J[L]=x.charCodeAt(L);H.call(F,J,4);F.set(B,8);x=(0,w.default)(F,4,D);G.setUint32(D+4,x);return F},z=function(x){return new Uint8Array([x>>>24&255,x>>>16&255,x>>>8&255,x&255])}},function(e,p){Object.defineProperty(p,"__esModule",{value:!0});p.default=function(h){var w=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,u=-1,k=w;for(w+=2<arguments.length&&void 0!==arguments[2]?arguments[2]:h.length-w;k<w;k++)u=u>>>8^r[(u^h[k])&255];return u^-1};var r=new Uint32Array(256);for(e=0;256>e;e++){p=e;for(var v=0;8>v;v++)p=0!==(p&1)?3988292384^p>>>1:p>>>1;r[e]=p}},function(e,p,r){function v(u,k){if(!(u instanceof k))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(p,"__esModule",{value:!0});p.Frame=p.APNG=void 0;var h=function(){function u(k,
g){for(var f=0;f<g.length;f++){var n=g[f];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(k,n.key,n)}}return function(k,g,f){g&&u(k.prototype,g);f&&u(k,f);return k}}(),w=(e=r(3))&&e.__esModule?e:{default:e};p.APNG=function(){function u(){v(this,u);this.playTime=this.numPlays=this.height=this.width=0;this.frames=[]}h(u,[{key:"createImages",value:function(){return Promise.all(this.frames.map(function(k){return k.createImage()}))}},{key:"getPlayer",
value:function(k){var g=this,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;return this.createImages().then(function(){return new w.default(g,k,f)})}}]);return u}();p.Frame=function(){function u(){v(this,u);this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageElement=this.imageData=null}h(u,[{key:"createImage",value:function(){var k=this;return this.imageElement?Promise.resolve():new Promise(function(g,f){var n=URL.createObjectURL(k.imageData);
k.imageElement=document.createElement("img");k.imageElement.onload=function(){URL.revokeObjectURL(n);g()};k.imageElement.onerror=function(){URL.revokeObjectURL(n);k.imageElement=null;f(Error("Image creation error"))};k.imageElement.src=n})}}]);return u}()},function(e,p,r){function v(w,u){if("function"!==typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);w.prototype=Object.create(u&&u.prototype,{constructor:{value:w,enumerable:!1,writable:!0,
configurable:!0}});u&&(Object.setPrototypeOf?Object.setPrototypeOf(w,u):w.__proto__=u)}Object.defineProperty(p,"__esModule",{value:!0});var h=function(){function w(u,k){for(var g=0;g<k.length;g++){var f=k[g];f.enumerable=f.enumerable||!1;f.configurable=!0;"value"in f&&(f.writable=!0);Object.defineProperty(u,f.key,f)}}return function(u,k,g){k&&w(u.prototype,k);g&&w(u,g);return u}}();e=r(4);e=function(w){function u(k,g,f){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");
var n=(u.__proto__||Object.getPrototypeOf(u)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");n=!n||"object"!==typeof n&&"function"!==typeof n?this:n;n.playbackRate=1;n._currentFrameNumber=0;n._ended=!1;n._paused=!0;n._numPlays=0;n._apng=k;n.context=g;n.stop();f&&n.play();return n}v(u,w);h(u,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length;this._currentFrameNumber===this._apng.frames.length-
1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._paused=this._ended=!0));this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var k=this.currentFrame;this._prevFrame=k;this._prevFrameData=null;2==k.disposeOp&&(this._prevFrameData=
this.context.getImageData(k.left,k.top,k.width,k.height));0==k.blendOp&&this.context.clearRect(k.left,k.top,k.width,k.height);this.context.drawImage(k.imageElement,k.left,k.top);this.emit("frame",this._currentFrameNumber);this._ended&&this.emit("end")}},{key:"play",value:function(){var k=this;this.emit("play");this._ended&&this.stop();this._paused=!1;var g=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function z(n){if(!k._ended&&!k._paused){if(n>=g){for(;n-g>=k._apng.playTime/
k.playbackRate;)g+=k._apng.playTime/k.playbackRate,k._numPlays++;do k.renderNextFrame(),g+=k.currentFrame.delay/k.playbackRate;while(!k._ended&&n>g)}requestAnimationFrame(z)}})}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop");this._numPlays=0;this._ended=!1;this._paused=!0;this._currentFrameNumber=-1;this.context.clearRect(0,0,this._apng.width,this._apng.height);this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},
{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]);return u}((e&&e.__esModule?e:{default:e}).default);p.default=e},function(e,p){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function v(w){return"function"===typeof w}function h(w){return"object"===typeof w&&null!==w}e.exports=r;r.EventEmitter=r;r.prototype._events=void 0;
r.prototype._maxListeners=void 0;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(w){if("number"!==typeof w||0>w||isNaN(w))throw TypeError("n must be a positive number");this._maxListeners=w;return this};r.prototype.emit=function(w){var u;this._events||(this._events={});if("error"===w&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){var k=arguments[1];if(k instanceof Error)throw k;var g=Error('Uncaught, unspecified "error" event. ('+k+")");g.context=k;throw g;
}g=this._events[w];if(void 0===g)return!1;if(v(g))switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:k=Array.prototype.slice.call(arguments,1),g.apply(this,k)}else if(h(g)){k=Array.prototype.slice.call(arguments,1);var f=g.slice();g=f.length;for(u=0;u<g;u++)f[u].apply(this,k)}return!0};r.prototype.addListener=function(w,u){if(!v(u))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",w,v(u.listener)?u.listener:u);this._events[w]?h(this._events[w])?this._events[w].push(u):this._events[w]=[this._events[w],u]:this._events[w]=u;h(this._events[w])&&!this._events[w].warned&&(u=void 0!==this._maxListeners?this._maxListeners:r.defaultMaxListeners)&&0<u&&this._events[w].length>u&&(this._events[w].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[w].length),"function"===typeof console.trace&&console.trace());return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(w,u){function k(){this.removeListener(w,k);g||(g=!0,u.apply(this,arguments))}if(!v(u))throw TypeError("listener must be a function");var g=!1;k.listener=u;this.on(w,k);return this};r.prototype.removeListener=function(w,u){if(!v(u))throw TypeError("listener must be a function");if(!this._events||!this._events[w])return this;var k=this._events[w];
var g=k.length;var f=-1;if(k===u||v(k.listener)&&k.listener===u)delete this._events[w],this._events.removeListener&&this.emit("removeListener",w,u);else if(h(k)){for(;0<g--;)if(k[g]===u||k[g].listener&&k[g].listener===u){f=g;break}if(0>f)return this;1===k.length?(k.length=0,delete this._events[w]):k.splice(f,1);this._events.removeListener&&this.emit("removeListener",w,u)}return this};r.prototype.removeAllListeners=function(w){if(!this._events)return this;if(!this._events.removeListener)return 0===
arguments.length?this._events={}:this._events[w]&&delete this._events[w],this;if(0===arguments.length){for(u in this._events)"removeListener"!==u&&this.removeAllListeners(u);this.removeAllListeners("removeListener");this._events={};return this}var u=this._events[w];if(v(u))this.removeListener(w,u);else if(u)for(;u.length;)this.removeListener(w,u[u.length-1]);delete this._events[w];return this};r.prototype.listeners=function(w){return this._events&&this._events[w]?v(this._events[w])?[this._events[w]]:
this._events[w].slice():[]};r.prototype.listenerCount=function(w){if(this._events){w=this._events[w];if(v(w))return 1;if(w)return w.length}return 0};r.listenerCount=function(w,u){return w.listenerCount(u)}}])})})(l);const c=E.getDefaultExportFromCjs(l.exports),a=[137,80,78,71,13,10,26,10];q.isAnimatedPNG=function(b){if(!m(b))return!1;const d=new DataView(b);b=new Uint8Array(b);let e=8,p;do{const r=d.getUint32(e);p=String.fromCharCode.apply(String,Array.prototype.slice.call(b.subarray(e+4,e+8)));if("acTL"===
p)return!0;e+=12+r}while("IEND"!==p&&e<b.length);return!1};q.isPNG=m;q.parseApng=function(b,d){return y.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/time","../../../../../geometry/support/meshUtils/exporters/gltf/imageutils"],function(q,t,E,C){function A(){A=t._asyncToGenerator(function*(k,
g){k=h(k);var f=r(k,!0);const {width:n,height:z}=k.lsd;k=document.createElement("canvas");k.width=n;k.height=z;k=k.getContext("2d");const x=[];g=[];for(const D of f){g.push(E.Milliseconds(D.delay||100));f=new ImageData(D.patch,D.dims.width,D.dims.height);var B=C.imageTypeToCanvas(f);f=3===D.disposalType&&k.getImageData(D.dims.left,D.dims.top,D.dims.width,D.dims.height);k.drawImage(B,D.dims.left,D.dims.top);B=k.getImageData(0,0,n,z);x.push(B);1!==D.disposalType&&(2===D.disposalType?k.clearRect(D.dims.left,
D.dims.top,D.dims.width,D.dims.height):3===D.disposalType&&k.putImageData(f,D.dims.left,D.dims.top))}return{frameDurations:g,getFrame:D=>x[D],width:n,height:z}});return A.apply(this,arguments)}function y(k){const g=new Uint8Array(k);return!u.some((f,n)=>f!==g[n])}var m={},l={},c={};Object.defineProperty(c,"__esModule",{value:!0});c.loop=c.conditional=c.parse=void 0;c.parse=function n(g,f){var z=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},x=3<arguments.length&&void 0!==arguments[3]?arguments[3]:
z;if(Array.isArray(f))f.forEach(function(D){return n(g,D,z,x)});else if("function"===typeof f)f(g,z,x,n);else{var B=Object.keys(f)[0];Array.isArray(f[B])?(x[B]={},n(g,f[B],z,x[B])):x[B]=f[B](g,z,x,n)}return z};c.conditional=function(g,f){return function(n,z,x,B){f(n,z,x)&&B(n,g,z,x)}};c.loop=function(g,f){return function(n,z,x,B){for(var D=[],F=n.pos;f(n,z,x);){var G={};B(n,g,z,G);if(n.pos===F)break;F=n.pos;D.push(G)}return D}};var a={};Object.defineProperty(a,"__esModule",{value:!0});a.readBits=
a.readArray=a.readUnsigned=a.readString=a.peekBytes=a.readBytes=a.peekByte=a.readByte=a.buildStream=void 0;a.buildStream=function(g){return{data:g,pos:0}};var b=function(){return function(g){return g.data[g.pos++]}};a.readByte=b;a.peekByte=function(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(f){return f.data[f.pos+g]}};var d=function(g){return function(f){return f.data.subarray(f.pos,f.pos+=g)}};a.readBytes=d;a.peekBytes=function(g){return function(f){return f.data.subarray(f.pos,
f.pos+g)}};a.readString=function(g){return function(f){return Array.from(d(g)(f)).map(function(n){return String.fromCharCode(n)}).join("")}};a.readUnsigned=function(g){return function(f){f=d(2)(f);return g?(f[1]<<8)+f[0]:(f[0]<<8)+f[1]}};a.readArray=function(g,f){return function(n,z,x){z="function"===typeof f?f(n,z,x):f;x=d(g);for(var B=Array(z),D=0;D<z;D++)B[D]=x(n);return B}};a.readBits=function(g){return function(f){f=b()(f);for(var n=Array(8),z=0;8>z;z++)n[7-z]=!!(f&1<<z);return Object.keys(g).reduce(function(x,
B){var D=g[B];if(D.length){for(var F=D.length,G=0,H=0;H<F;H++)G+=n[D.index+H]&&Math.pow(2,F-H-1);x[B]=G}else x[B]=n[D.index];return x},{})}};(function(g){Object.defineProperty(g,"__esModule",{value:!0});g["default"]=void 0;var f={blocks:function(D){for(var F=[],G=D.data.length,H=0,J=(0,a.readByte)()(D);0!==J&&J;J=(0,a.readByte)()(D)){if(D.pos+J>=G){G-=D.pos;F.push((0,a.readBytes)(G)(D));H+=G;break}F.push((0,a.readBytes)(J)(D));H+=J}D=new Uint8Array(H);for(G=H=0;G<F.length;G++)D.set(F[G],H),H+=F[G].length;
return D}},n=(0,c.conditional)({gce:[{codes:(0,a.readBytes)(2)},{byteSize:(0,a.readByte)()},{extras:(0,a.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,a.readUnsigned)(!0)},{transparentColorIndex:(0,a.readByte)()},{terminator:(0,a.readByte)()}]},function(D){D=(0,a.peekBytes)(2)(D);return 33===D[0]&&249===D[1]}),z=(0,c.conditional)({image:[{code:(0,a.readByte)()},{descriptor:[{left:(0,a.readUnsigned)(!0)},{top:(0,a.readUnsigned)(!0)},
{width:(0,a.readUnsigned)(!0)},{height:(0,a.readUnsigned)(!0)},{lct:(0,a.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,c.conditional)({lct:(0,a.readArray)(3,function(D,F,G){return Math.pow(2,G.descriptor.lct.size+1)})},function(D,F,G){return G.descriptor.lct.exists}),{data:[{minCodeSize:(0,a.readByte)()},f]}]},function(D){return 44===(0,a.peekByte)()(D)}),x=(0,c.conditional)({text:[{codes:(0,a.readBytes)(2)},{blockSize:(0,a.readByte)()},
{preData:function(D,F,G){return(0,a.readBytes)(G.text.blockSize)(D)}},f]},function(D){D=(0,a.peekBytes)(2)(D);return 33===D[0]&&1===D[1]}),B=(0,c.conditional)({application:[{codes:(0,a.readBytes)(2)},{blockSize:(0,a.readByte)()},{id:function(D,F,G){return(0,a.readString)(G.blockSize)(D)}},f]},function(D){D=(0,a.peekBytes)(2)(D);return 33===D[0]&&255===D[1]});f=(0,c.conditional)({comment:[{codes:(0,a.readBytes)(2)},f]},function(D){D=(0,a.peekBytes)(2)(D);return 33===D[0]&&254===D[1]});n=[{header:[{signature:(0,a.readString)(3)},
{version:(0,a.readString)(3)}]},{lsd:[{width:(0,a.readUnsigned)(!0)},{height:(0,a.readUnsigned)(!0)},{gct:(0,a.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,a.readByte)()},{pixelAspectRatio:(0,a.readByte)()}]},(0,c.conditional)({gct:(0,a.readArray)(3,function(D,F){return Math.pow(2,F.lsd.gct.size+1)})},function(D,F){return F.lsd.gct.exists}),{frames:(0,c.loop)([n,B,f,z,x],function(D){D=(0,a.peekByte)()(D);return 33===D||
44===D})}];g["default"]=n})(l);var e={};Object.defineProperty(e,"__esModule",{value:!0});e.deinterlace=void 0;e.deinterlace=function(g,f){for(var n=Array(g.length),z=g.length/f,x=[0,4,2,1],B=[8,8,4,2],D=0,F=0;4>F;F++)for(var G=x[F];G<z;G+=B[F]){var H=G,J=g.slice(D*f,(D+1)*f);n.splice.apply(n,[H*f,f].concat(J));D++}return n};var p={};Object.defineProperty(p,"__esModule",{value:!0});p.lzw=void 0;p.lzw=function(g,f,n){var z,x,B,D,F,G,H,J,L=Array(n),K=Array(4096),U=Array(4096),X=Array(4097);var Z=1<<
g;var aa=Z+1;var da=Z+2;var R=-1;var M=g+1;var Q=(1<<M)-1;for(x=0;x<Z;x++)K[x]=0,U[x]=x;for(B=D=z=F=G=J=H=0;B<n;){if(0===G){if(z<M){D+=f[H]<<z;z+=8;H++;continue}x=D&Q;D>>=M;z-=M;if(x>da||x==aa)break;if(x==Z){M=g+1;Q=(1<<M)-1;da=Z+2;R=-1;continue}if(-1==R){X[G++]=U[x];F=R=x;continue}var N=x;x==da&&(X[G++]=F,x=R);for(;x>Z;)X[G++]=U[x],x=K[x];F=U[x]&255;X[G++]=F;4096>da&&(K[da]=R,U[da]=F,da++,0===(da&Q)&&4096>da&&(M++,Q+=da));R=N}G--;L[J++]=X[G];B++}for(B=J;B<n;B++)L[B]=0;return L};Object.defineProperty(m,
"__esModule",{value:!0});var r=m.decompressFrames=m.decompressFrame=h=m.parseGIF=void 0,v=l&&l.__esModule?l:{default:l},h=m.parseGIF=function(g){g=new Uint8Array(g);return(0,c.parse)((0,a.buildStream)(g),v["default"])},w=function(g,f,n){if(g.image){var z=g.image,x=(0,p.lzw)(z.data.minCodeSize,z.data.blocks,z.descriptor.width*z.descriptor.height);z.descriptor.lct.interlaced&&(x=(0,e.deinterlace)(x,z.descriptor.width));x={pixels:x,dims:{top:g.image.descriptor.top,left:g.image.descriptor.left,width:g.image.descriptor.width,
height:g.image.descriptor.height}};x.colorTable=z.descriptor.lct&&z.descriptor.lct.exists?z.lct:f;g.gce&&(x.delay=10*(g.gce.delay||10),x.disposalType=g.gce.extras.disposal,g.gce.extras.transparentColorGiven&&(x.transparentIndex=g.gce.transparentColorIndex));if(n){g=x.pixels.length;f=new Uint8ClampedArray(4*g);for(n=0;n<g;n++){z=4*n;var B=x.pixels[n],D=x.colorTable[B]||[0,0,0];f[z]=D[0];f[z+1]=D[1];f[z+2]=D[2];f[z+3]=B!==x.transparentIndex?255:0}x.patch=f}return x}console.warn("gif frame does not have associated image.")};
m.decompressFrame=w;r=m.decompressFrames=function(g,f){return g.frames.filter(function(n){return n.image}).map(function(n){return w(n,g.gct,f)})};const u=[71,73,70];q.isAnimatedGIF=function(g){function f(){B++;x+=8;const F=z.getUint8(x++);x+=F&128?3*2**((F&7)+1):0;x++;n()}function n(){let F;for(;F=z.getUint8(x++);)x+=F}if(!y(g))return!1;const z=new DataView(g);g=z.getUint8(10);let x=13+(g&128?3*2**((g&7)+1):0),B=0;for(g=!1;!g;){switch(z.getUint8(x++)){case 33:a:{switch(z.getUint8(x++)){case 249:x++;
x+=4;n();break;case 1:B++;x++;x+=12;n();break;case 254:n();break;case 255:x++;x+=8;x+=3;n();break;default:var D=!1;break a}D=!0}if(!D)return!1;break;case 44:f();break;case 59:g=!0;break;default:return!1}if(1<B)return!0}return!1};q.isGIF=y;q.parseGif=function(g,f){return A.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/meshUtils/exporters/gltf/imageutils":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Error ../../../../../core/maybe ../../../../../core/urlUtils".split(" "),
function(q,t,E,C,A,y){function m(){m=t._asyncToGenerator(function*(b){const d=a(b);if(A.isNone(d))throw new C("imageToArrayBuffer","Unsupported image type");const e=yield l(b);b=yield new Promise(p=>d.toBlob(p,e));if(!b)throw new C("imageToArrayBuffer","Failed to encode image");return{data:yield b.arrayBuffer(),type:e}});return m.apply(this,arguments)}function l(b){return c.apply(this,arguments)}function c(){c=t._asyncToGenerator(function*(b){if(!(b instanceof HTMLImageElement))return"image/png";
b=b.src;return y.isDataProtocol(b)?(b=y.dataComponents(b),"image/jpeg"===b?.mediaType?b.mediaType:"image/png"):/\.png$/i.test(b)?"image/png":/\.(jpg|jpeg)$/i.test(b)?"image/jpeg":"image/png"});return c.apply(this,arguments)}function a(b){if(b instanceof HTMLCanvasElement)return b;if(b instanceof HTMLVideoElement)return null;const d=document.createElement("canvas");d.width=b.width;d.height=b.height;const e=d.getContext("2d");b instanceof HTMLImageElement?e.drawImage(b,0,0,b.width,b.height):b instanceof
ImageData&&e.putImageData(b,0,0);return d}q.encodeBase64DataUri=function(b){const d=[];b=new Uint8Array(b);for(let e=0;e<b.length;e++)d.push(String.fromCharCode(b[e]));return"data:application/octet-stream;base64,"+btoa(d.join(""))};q.imageToArrayBuffer=function(b){return m.apply(this,arguments)};q.imageToDataURI=function(b){b=a(b);return A.isSome(b)?b.toDataURL():""};q.imageTypeToCanvas=a;q.isArrayBufferPNG=function(b){if(8>b.byteLength)return!1;b=new Uint8Array(b);return 137===b[0]&&80===b[1]&&78===
b[2]&&71===b[3]&&13===b[4]&&10===b[5]&&26===b[6]&&10===b[7]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","../../../layers/effects/EffectView","./DisplayObject"],function(q,t,E,C,A){A=function(y){function m(){var c=y.apply(this,arguments)||this;c._childrenSet=new Set;c._needsSort=!1;c.children=[];c._effectView=null;return c}
t._inheritsLoose(m,y);var l=m.prototype;l.updateTransitionProperties=function(c,a){y.prototype.updateTransitionProperties.call(this,c,a);this._effectView&&(this._effectView.transitionStep(c,a),this._effectView.transitioning&&this.requestRender())};l.doRender=function(c){c=this.createRenderParams(c);this.renderChildren(c)};l.addChild=function(c){return this.addChildAt(c,this.children.length)};l.addChildAt=function(c,a=this.children.length){if(!c||this.contains(c))return c;this._needsSort=!0;const b=
c.parent;b&&b!==this&&b.removeChild(c);a>=this.children.length?this.children.push(c):this.children.splice(a,0,c);this._childrenSet.add(c);c.parent=this;c.stage=this.stage;this!==this.stage&&(c.clips=this.clips);this.requestRender();return c};l.contains=function(c){return this._childrenSet.has(c)};l.endTransitions=function(){y.prototype.endTransitions.call(this);this._effectView&&(this._effectView.endTransitions(),this.requestRender())};l.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=
!0;for(const c of this.children)this!==this.stage&&(c.clips=null),c.stage=null,c.parent=null;this.children.length=0};l.removeChild=function(c){return this.contains(c)?this.removeChildAt(this.children.indexOf(c)):c};l.removeChildAt=function(c){if(0>c||c>=this.children.length)return null;this._needsSort=!0;c=this.children.splice(c,1)[0];this._childrenSet.delete(c);this!==this.stage&&(c.clips=null);c.stage=null;c.parent=null;return c};l.sortChildren=function(c){this._needsSort&&(this.children.sort(c),
this._needsSort=!1)};l.beforeRender=function(c){y.prototype.beforeRender.call(this,c);for(const a of this.children)a.beforeRender(c)};l.afterRender=function(c){y.prototype.afterRender.call(this,c);for(const a of this.children)a.afterRender(c)};l._createTransforms=function(){return{dvs:E.create()}};l.onAttach=function(){y.prototype.onAttach.call(this);const c=this.stage;for(const a of this.children)a.stage=c};l.onDetach=function(){y.prototype.onDetach.call(this);for(const c of this.children)c.stage=
null};l.renderChildren=function(c){for(const a of this.children)a.processRender(c)};l.createRenderParams=function(c){return{...c,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:c.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};t._createClass(m,[{key:"blendMode",get:function(){return this._blendMode},set:function(c){this._blendMode=c;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(c){this._clips=c;this.children.forEach(a=>
a.clips=c)}},{key:"computedEffects",get:function(){return this._effectView?.effects??null}},{key:"effect",get:function(){return this._effectView?.effect??""},set:function(c){if(this._effectView||c)this._effectView||(this._effectView=new C.EffectView),this._effectView.effect=c,this.requestRender()}}]);return m}(A.DisplayObject);q.Container=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){function e(v){v=b.parse(v)||[];var h=(h=v[0])?"type"in h:!1;return h?[{scale:-1,effects:v}]:v}function p(v,h,w){return v[0]?.effects&&h[0]?.effects?(-1===v[0]?.scale||-1===h[0]?.scale)&&(1<v.length||1<h.length)&&0>=w?!1:d.canInterpolateEffects(v[0].effects,h[0].effects):!0}function r(v,h,w){const u=v.length>h.length?v:h;v=v.length>h.length?h:v;var k=v[v.length-1];h=k?.scale??w;k=k?.effects??[];for(let g=v.length;g<u.length;g++)v.push({scale:h,effects:[...k]});for(h=
0;h<u.length;h++)v[h].scale=-1===v[h].scale?w:v[h].scale,u[h].scale=-1===u[h].scale?w:u[h].scale,d.normalizeEffects(v[h].effects,u[h].effects)}q.EffectView=function(v){function h(u){u=v.call(this,u)||this;u._from=null;u._to=null;u._final=null;u._current=[];u._time=0;u.duration=A("mapview-transitions-duration");u.effects=[];return u}t._inheritsLoose(h,v);var w=h.prototype;w.canTransitionTo=function(u){try{return 0<this.scale&&p(this._current,e(u),this.scale)}catch{return!1}};w.transitionStep=function(u,
k){this._applyTimeTransition(u);this._updateForScale(k)};w.endTransitions=function(){this._applyTimeTransition(this.duration)};w._transitionTo=function(u){0<this.scale&&p(this._current,u,this.scale)?(this._final=u,this._to=y.clone(u),r(this._current,this._to,this.scale),this._from=y.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=u);this._set("effects",this._current[0]?y.clone(this._current[0].effects):[])};w._applyTimeTransition=function(u){if(this._to&&this._from&&
this._current&&this._final){this._time+=u;u=Math.min(1,this._time/this.duration);for(let g=0;g<this._current.length;g++){const f=this._current[g],n=this._from[g],z=this._to[g];var k=n.scale;f.scale=k+(z.scale-k)*u;for(k=0;k<f.effects.length;k++)f.effects[k].interpolate(n.effects[k],z.effects[k],u)}1===u&&(this._current=this._final,this._set("effects",this._current[0]?y.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};w._updateForScale=function(u){this._set("scale",u);if(0!==
this._current.length){var k=this._current,g=this._current.length-1,f,n=1;if(1===k.length||u>=k[0].scale)var z=f=k[0].effects;else if(u<=k[g].scale)z=f=k[g].effects;else for(let x=0;x<g;x++){const B=k[x],D=k[x+1];if(B.scale>=u&&D.scale<=u){n=(u-B.scale)/(D.scale-B.scale);f=B.effects;z=D.effects;break}}for(u=0;u<this.effects.length;u++)this.effects[u].interpolate(f[u],z[u],n)}};t._createClass(h,[{key:"effect",set:function(u){const k=this._get("effect");u=u||"";if(k!==u){this._set("effect",u);try{this._transitionTo(e(u))}catch(g){this._transitionTo([]),
m.getLogger(this.declaredClass).warn("Invalid Effect",{effect:u,error:g})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(u){this._updateForScale(u)}},{key:"transitioning",get:function(){return null!==this._to}}]);return h}(C);E.__decorate([l.property()],q.EffectView.prototype,"_to",void 0);E.__decorate([l.property()],q.EffectView.prototype,"duration",void 0);E.__decorate([l.property({value:""})],q.EffectView.prototype,"effect",null);
E.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"effects",void 0);E.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"hasEffects",null);E.__decorate([l.property({value:0})],q.EffectView.prototype,"scale",null);E.__decorate([l.property({readOnly:!0})],q.EffectView.prototype,"transitioning",null);q.EffectView=E.__decorate([a.subclass("esri.layers.effects.EffectView")],q.EffectView);q.canInterpolateEffectStops=p;q.convertEffectToStops=e;q.normalizeEffectStops=r;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(q,t,E,C,A,y){const m=1/C("mapview-transitions-duration");E=function(l){function c(){var b=l.apply(this,arguments)||this;b._fadeOutResolver=null;b._fadeInResolver=null;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;
b.fadeTransitionEnabled=!1;b.inFadeTransition=!1;b._isReady=!1;b._opacity=1;b._stage=null;b._visible=!0;return b}t._inheritsLoose(c,l);var a=c.prototype;a._getTransforms=function(){A.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};a.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.opacity=1;this.computedOpacity=0;this.fadeTransitionEnabled=!0;
this._fadeInResolver=y.createResolver();this.requestRender();return this._fadeInResolver.promise};a.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this.opacity=0;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=y.createResolver();this.requestRender();return this._fadeOutResolver.promise};a.endTransitions=function(){this._fadeInResolver?.();this._fadeInResolver=null;this._fadeOutResolver?.();
this._fadeOutResolver=null;this.computedOpacity=this.visible?this.opacity:0;this.requestRender()};a.beforeRender=function(b){this.updateTransitionProperties(b.deltaTime,b.state.scale)};a.afterRender=function(b){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};a.remove=function(){this.parent?.removeChild(this)};a.setTransform=function(b){};
a.processRender=function(b){this.stage&&this.computedVisible&&this.doRender(b)};a.requestRender=function(){this.stage&&this.stage.requestRender()};a.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.onDetach();this.emit("detach")};a.updateTransitionProperties=function(b,d){if(this.fadeTransitionEnabled){d=this._fadeOutResolver||!this.visible?0:this.opacity;const e=this.computedOpacity;
e===d?this.computedVisible=this.visible:(b*=m,this.computedOpacity=e>d?Math.max(d,e-b):Math.min(d,e+b),this.computedVisible=0<this.computedOpacity,b=d===this.computedOpacity,this.inFadeTransition=!b,b||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};a.onAttach=function(){};a.onDetach=function(){};a.doRender=function(b){};a.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};t._createClass(c,[{key:"clips",get:function(){return this._clips},
set:function(b){this._clips=b;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=Math.min(1,Math.max(b,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(b){if(this._stage!==b){var d=this._stage;(this._stage=b)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):d.trashDisplayObject(this)}}},{key:"transforms",
get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(b){this._visible!==b&&(this._visible=b,this.requestRender())}}]);return c}(E);q.DisplayObject=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/BufferPool":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","../../../../core/maybe","./cpuMapped/FreeList"],function(q,t,E,
C,A){const y=E("esri-2d-log-allocations");E=function(){function c(b,d){this._array=b;this._pool=d}c.create=function(b,d){b=d.acquire(b);return new c(b,d)};var a=c.prototype;a.expand=function(b){b=this._pool.acquire(b);b.set(this._array);this._pool.release(this._array);this._array=b};a.destroy=function(){this._pool.release(this._array)};a.set=function(b,d){this._array.set(b._array,d)};a.slice=function(){const b=this._pool.acquire(this._array.byteLength);b.set(this._array);return new c(b,this._pool)};
t._createClass(c,[{key:"array",get:function(){return this._array}},{key:"length",get:function(){return this._array.length}}]);return c}();let m=function(){function c(){this._data=new ArrayBuffer(c.BYTE_LENGTH);this._freeList=new A.FreeList({start:0,end:this._data.byteLength})}var a=c.prototype;a.allocate=function(b){const d=this._freeList.firstFit(b);return C.isNone(d)?null:new Uint32Array(this._data,d,b/Uint32Array.BYTES_PER_ELEMENT)};a.free=function(b){this._freeList.free(b.byteOffset,b.byteLength)};
t._createClass(c,[{key:"buffer",get:function(){return this._data}}],[{key:"BYTE_LENGTH",get:function(){return 64E6}}]);return c}(),l=function(){function c(){this._bytesAllocated=0;this._pages=[];this._pagesByBuffer=new Map;this._addPage()}var a=c.prototype;a.destroy=function(){this._pages=[];this._pagesByBuffer=null};a.acquire=function(b){this._bytesAllocated+=b;y&&console.log(`Allocating ${b}, (${this._bytesAllocated} / ${this._bytesTotal})`);if(b>m.BYTE_LENGTH)return new Uint32Array(b/Uint32Array.BYTES_PER_ELEMENT);
for(const d of this._pages){const e=d.allocate(b);if(C.isSome(e))return e}return C.unwrapOrThrow(this._addPage().allocate(b),"Expected to allocate page")};a.release=function(b){this._bytesAllocated-=b.byteLength;y&&console.log(`Freeing ${b.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);const d=this._pagesByBuffer.get(b.buffer);d&&d.free(b)};a._addPage=function(){const b=new m;this._pages.push(b);this._pagesByBuffer.set(b.buffer,b);return b};t._createClass(c,[{key:"_bytesTotal",get:function(){return this._pages.length*
m.BYTE_LENGTH}}]);return c}();q.BufferPool=l;q.TypedBuffer=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/cpuMapped/FreeList":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],function(q,t,E){let C=function(){function y(l){this.next=null;if(Array.isArray(l)){this.data=l[0];var c=this;for(let a=1;a<l.length;a++)c.next=new y([l[a]]),c=c.next}else this.data=l}var m=y.prototype;
m.values=function*(){let l=this;for(;l;)yield l.data,l=l.next};m.forEach=function(l){let c=this;for(;c;)l(c.data),c=c.next};m.find=function(l){return l(this.data)?this:this.next?.find(l)};m.max=function(l,c=this){c=l(this.data)>l(c.data)?this:c;return this.next?this.next.max(l,c):c};m.remove=function(l,c=null){return this===l?c?(c.next=this.next,c):this.next:this.next?.remove(l,this)??null};t._createClass(y,[{key:"last",get:function(){return this.next?this.next.last:this}}]);return y}(),A=function(){function y(l){this._head=
null;E.isNone(l)||(this._head=new C(l))}var m=y.prototype;m.maxAvailableSpace=function(){if(E.isNone(this._head))return 0;const l=this._head.max(c=>c.end-c.start);return l.data.end-l.data.start};m.firstFit=function(l){if(E.isNone(this._head))return null;var c=null;let a=this._head;for(;a;){const b=a.data.end-a.data.start;if(b===l)return c?c.next=a.next:this._head=a.next,a.data.start;if(b>l)return c=a.data.start,a.data.start+=l,c;c=a;a=a.next}return null};m.free=function(l,c){const a=l+c;if(E.isNone(this._head))this._head=
new C({start:l,end:a});else if(a<=this._head.data.start)if(a===this._head.data.start)this._head.data.start-=c;else{var b=new C({start:l,end:a});b.next=this._head;this._head=b}else{b=this._head;for(var d=b.next;d;){if(d.data.start>=a){if(b.data.end===l){b.data.end+=c;b.data.end===d.data.start&&(b.data.end+=d.data.end-d.data.start,b.next=d.next);return}if(d.data.start===a){d.data.start-=c;return}l=new C({start:l,end:a});l.next=b.next;b.next=l;return}b=d;d=d.next}l===b.data.end?b.data.end+=c:(l=new C({start:l,
end:a}),b.next=l)}};t._createClass(y,[{key:"head",get:function(){return this._head}}]);return y}();q.FreeList=A;q.List=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(q){q.WGLGeometryType=void 0;(function(t){t[t.FILL=0]="FILL";t[t.LINE=1]="LINE";t[t.MARKER=2]="MARKER";t[t.TEXT=3]="TEXT";t[t.LABEL=4]="LABEL"})(q.WGLGeometryType||(q.WGLGeometryType={}));q.WGLGeometryTransactionStatus=
void 0;(function(t){t[t.SUCCEEDED=0]="SUCCEEDED";t[t.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(q.WGLGeometryTransactionStatus||(q.WGLGeometryTransactionStatus={}));q.WGLDrawPhase=void 0;(function(t){t[t.NONE=0]="NONE";t[t.MAP=1]="MAP";t[t.LABEL=2]="LABEL";t[t.LABEL_ALPHA=4]="LABEL_ALPHA";t[t.HITTEST=8]="HITTEST";t[t.HIGHLIGHT=16]="HIGHLIGHT";t[t.CLIP=32]="CLIP";t[t.DEBUG=64]="DEBUG";t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(q.WGLDrawPhase||(q.WGLDrawPhase={}));q.VVType=void 0;(function(t){t[t.SIZE=
0]="SIZE";t[t.COLOR=1]="COLOR";t[t.OPACITY=2]="OPACITY";t[t.ROTATION=3]="ROTATION"})(q.VVType||(q.VVType={}));q.WGLVVFlag=void 0;(function(t){t[t.NONE=0]="NONE";t[t.OPACITY=1]="OPACITY";t[t.COLOR=2]="COLOR";t[t.ROTATION=4]="ROTATION";t[t.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";t[t.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";t[t.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";t[t.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(q.WGLVVFlag||(q.WGLVVFlag={}));q.WGLVVTarget=void 0;(function(t){t[t.MINMAX_TARGETS_OUTLINE=
128]="MINMAX_TARGETS_OUTLINE";t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(q.WGLVVTarget||(q.WGLVVTarget={}));q.MosaicType=void 0;(function(t){t[t.SPRITE=0]="SPRITE";t[t.GLYPH=1]="GLYPH"})(q.MosaicType||(q.MosaicType={}));q.WGLSymbologyType=void 0;(function(t){t[t.DEFAULT=0]="DEFAULT";t[t.SIMPLE=1]="SIMPLE";t[t.DOT_DENSITY=2]="DOT_DENSITY";t[t.OUTLINE_FILL=3]="OUTLINE_FILL";t[t.OUTLINE_FILL_SIMPLE=
4]="OUTLINE_FILL_SIMPLE";t[t.HEATMAP=5]="HEATMAP";t[t.PIE_CHART=6]="PIE_CHART"})(q.WGLSymbologyType||(q.WGLSymbologyType={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./TextureUploadManager ./WorldExtentClipRenderer ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g){function f(z,x){switch(z){case y.WGLGeometryType.LINE:return E.brushes.line;case y.WGLGeometryType.TEXT:return E.brushes.text;case y.WGLGeometryType.LABEL:return E.brushes.label;case y.WGLGeometryType.FILL:switch(x){case y.WGLSymbologyType.DOT_DENSITY:return E.brushes.dotDensity;default:return E.brushes.fill}case y.WGLGeometryType.MARKER:switch(x){case y.WGLSymbologyType.HEATMAP:return E.brushes.heatmap;case y.WGLSymbologyType.PIE_CHART:return E.brushes.pieChart;
default:return E.brushes.marker}}}function n(z,x,B,D){return z!==y.WGLDrawPhase.HIGHLIGHT&&(1!==D||t.isSome(x)&&"normal"!==x||t.isSome(B)&&0<B.length)}return function(){function z(B,D,F){this.context=B;this._blitRenderer=new A.BitBlitRenderer;this._worldExtentClipRenderer=new a.WorldExtentClipRenderer;this._isClippedToWorldExtent=!1;this._brushCache=new Map;this._vtlMaterialManager=new C;this._blendEffect=new d.BlendEffect;this._fboPool=[];this.effects={highlight:new p,hittest:new r.HittestEffect,
hittestVTL:new v.HittestEffectVTL,integrate:new b.AnimationEffect,insideEffect:new e.FeatureEffect("inside"),outsideEffect:new e.FeatureEffect("outside")};this.materialManager=new m(B);this.textureManager=new l(D,F);this.textureUploadManager=new c.TextureUploadManager(B,D);this._effectsManager=new h.EffectManager}var x=z.prototype;x.getRenderTarget=function(){return this._renderTarget};x.setRenderTarget=function(B){this._renderTarget=B};x.getFbos=function(B,D){if(B!==this._lastWidth||D!==this._lastHeight){this._lastWidth=
B;this._lastHeight=D;if(this._fbos){for(var F in this._fbos)this._fbos[F].resize(B,D);return this._fbos}F={target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,samplingMode:u.TextureSamplingMode.NEAREST,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,width:B,height:D};const G={colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};this._stencilBuf=B=new g.Renderbuffer(this.context,{width:B,height:D,internalFormat:u.RenderbufferFormat.DEPTH_STENCIL});
this._fbos={output:new k.FramebufferObject(this.context,G,F,B),blend:new k.FramebufferObject(this.context,G,F,B),effect0:new k.FramebufferObject(this.context,G,F,B)}}return this._fbos};x.acquireFbo=function(B,D){let F;F=0<this._fboPool.length?this._fboPool.pop():new k.FramebufferObject(this.context,{colorTarget:u.TargetType.TEXTURE,depthStencilTarget:u.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},{target:u.TextureType.TEXTURE_2D,pixelFormat:u.PixelFormat.RGBA,dataType:u.PixelType.UNSIGNED_BYTE,
samplingMode:u.TextureSamplingMode.NEAREST,wrapMode:u.TextureWrapMode.CLAMP_TO_EDGE,width:B,height:D},this._stencilBuf);const G=F.descriptor;G.width===B&&G.height===D||F.resize(B,D);return F};x.releaseFbo=function(B){this._fboPool.push(B)};x.getSharedStencilBuffer=function(){return this._stencilBuf};x.beforeRenderLayers=function(B,D=null){const {width:F,height:G}=B.getViewport();this._prevFBO=B.getBoundFramebufferObject();const H=this.getFbos(F,G);B.bindFramebuffer(H.output);B.setColorMask(!0,!0,
!0,!0);if(t.isSome(D)){const {r:J,g:L,b:K,a:U}=D.color;B.setClearColor(U*J/255,U*L/255,U*K/255,U)}else B.setClearColor(0,0,0,0);B.setDepthWriteEnabled(!0);B.setClearDepth(1);B.clear(B.gl.COLOR_BUFFER_BIT|B.gl.DEPTH_BUFFER_BIT);B.setDepthWriteEnabled(!1)};x.beforeRenderLayer=function(B,D,F){const {context:G,blendMode:H,effects:J,requireFBO:L,drawPhase:K}=B;L||n(K,H,J,F)?(G.bindFramebuffer(this._fbos.blend),G.setColorMask(!0,!0,!0,!0),G.setClearColor(0,0,0,0),G.setDepthWriteEnabled(!0),G.setClearDepth(1),
G.clear(G.gl.COLOR_BUFFER_BIT|G.gl.DEPTH_BUFFER_BIT),G.setDepthWriteEnabled(!1)):(B=this._getOutputFBO(),G.bindFramebuffer(B));G.setDepthWriteEnabled(!1);G.setDepthTestEnabled(!1);G.setStencilTestEnabled(!0);G.setClearStencil(D);G.setStencilWriteMask(255);G.clear(G.gl.STENCIL_BUFFER_BIT)};x.compositeLayer=function(B,D){const {context:F,blendMode:G,effects:H,requireFBO:J,drawPhase:L}=B;if(J||n(L,G,H,D)){t.isSome(H)&&0<H.length&&L===y.WGLDrawPhase.MAP&&this._applyEffects(B,H);var K=this._getOutputFBO();
F.bindFramebuffer(K);F.setStencilTestEnabled(!1);F.setStencilWriteMask(0);F.setBlendingEnabled(!0);F.setBlendFunctionSeparate(u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA,u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA);F.setColorMask(!0,!0,!0,!0);K=t.isNone(G)||L===y.WGLDrawPhase.HIGHLIGHT?"normal":G;this._blendEffect.draw(B,this._fbos.blend.colorTexture,u.TextureSamplingMode.NEAREST,K,D)}};x.renderLayers=function(B){B.bindFramebuffer(this._prevFBO);if(this._fbos){var D=this._getOutputFBO();
B.setDepthTestEnabled(!1);B.setStencilWriteMask(0);this._isClippedToWorldExtent?(B.setStencilTestEnabled(!0),B.setStencilFunction(u.CompareFunction.EQUAL,1,255)):B.setStencilTestEnabled(!1);this.blitTexture(B,D.colorTexture,u.TextureSamplingMode.NEAREST)}};x.prepareDisplay=function(B,D,F){const {context:G}=B;G.bindFramebuffer(this._prevFBO);G.setColorMask(!0,!0,!0,!0);if(t.isSome(D)){const {r:H,g:J,b:L,a:K}=D.color;G.setClearColor(K*H/255,K*J/255,K*L/255,K)}else G.setClearColor(0,0,0,0);G.setStencilWriteMask(255);
G.setClearStencil(0);G.clear(G.gl.COLOR_BUFFER_BIT|G.gl.STENCIL_BUFFER_BIT);this._isClippedToWorldExtent=this._worldExtentClipRenderer.render(B,F)};x.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this.textureUploadManager.destroy();this._blitRenderer=t.disposeMaybe(this._blitRenderer);this._worldExtentClipRenderer=t.disposeMaybe(this._worldExtentClipRenderer);this._brushCache&&(this._brushCache.forEach(B=>B.dispose()),this._brushCache.clear(),this._brushCache=null);
if(this._fbos)for(const B in this._fbos)this._fbos[B]&&this._fbos[B].dispose();for(const B of this._fboPool)B.dispose();this._fboPool.length=0;if(this.effects)for(const B in this.effects)this.effects[B]&&this.effects[B].dispose();this._effectsManager.dispose();this._vtlMaterialManager=t.disposeMaybe(this._vtlMaterialManager);this._prevFBO=null};x.getBrush=function(B,D){B=f(B,D);D=this._brushCache.get(B);void 0===D&&(D=new B,this._brushCache.set(B,D));return this._brushCache.get(B)};x.renderObject=
function(B,D,F,G){F=E.brushes[F];if(!F)return null;let H=this._brushCache.get(F);void 0===H&&(H=new F,this._brushCache.set(F,H));H.prepareState(B,G);H.draw(B,D,G)};x.renderObjects=function(B,D,F,G){F=E.brushes[F];if(!F)return null;let H=this._brushCache.get(F);void 0===H&&(H=new F,this._brushCache.set(F,H));H.drawMany(B,D,G)};x.registerRenderPass=function(B){const D=B.brushes.map(F=>{this._brushCache.has(F)||this._brushCache.set(F,new F);return this._brushCache.get(F)});return new w(D,B)};x.setHighlightOptions=
function(B){this.effects.highlight.setHighlightOptions(B)};x.blitTexture=function(B,D,F,G=1){B.setBlendingEnabled(!0);B.setBlendFunctionSeparate(u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA,u.BlendFactor.ONE,u.BlendFactor.ONE_MINUS_SRC_ALPHA);B.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(B,D,F,G)};x.getPostProcessingEffects=function(B){return this._effectsManager.getPostProcessingEffects(B)};x._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};
x._applyEffects=function(B,D){const {context:F}=B;D=this._effectsManager.getPostProcessingEffects(D);for(const {postProcessingEffect:G,effect:H}of D)F.bindFramebuffer(this._fbos.blend),G.draw(B,this._fbos.blend,H)};q._createClass(z,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return z}()})},"esri/views/2d/engine/brushes":function(){define("exports ./flow/BrushFlow ./imagery/BrushRasterBitmap ./imagery/BrushVectorField ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/BrushOverlay ./webgl/brushes/WGLBrushDotDensity ./webgl/brushes/WGLBrushHeatmap ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushPieChart ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f){q.brushes={marker:g,line:k,fill:w,text:f,label:u,clip:y,stencil:d,bitmap:A,overlay:m,raster:E,rasterVF:C,flow:t,tileInfo:a,vtlBackground:e.WGLBrushVTLBackground,vtlFill:r.WGLBrushVTLFill,vtlLine:v.WGLBrushVTLLine,vtlCircle:p.WGLBrushVTLCircle,vtlSymbol:h.WGLBrushVTLSymbol,dotDensity:l,heatmap:c,pieChart:b};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../../core/maybe","../../../../chunks/mat3f32","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(q,t,E,C,A){return function(y){function m(){var c=y.apply(this,arguments)||this;c._visualState={time:0,dvsMat3:E.create(),displayViewMat3:E.create()};return c}q._inheritsLoose(m,y);var l=m.prototype;l.dispose=function(){};l.prepareState=function(c){({context:c}=c);c.setColorMask(!0,!0,!0,!0);c.setStencilFunction(A.CompareFunction.EQUAL,0,255)};l.draw=function(c,a){const {requestRender:b,
allowDelayedRender:d}=c,{displayData:e}=a;if(!t.isNone(e)&&("loaded"===e.state.name&&e.attach(c),"attached"===e.state.name)){var p=e.state.resources;d&&!p.ready&&t.isSome(b)?b():(this._visualState.time=c.time/1E3,this._visualState.dvsMat3=a.transforms.dvs,this._visualState.displayViewMat3=c.state.displayViewMat3,e.flowStyle.render(c,this._visualState,p),e.flowStyle.animated&&t.isSome(b)&&b())}};return m}(C)})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function q(){this.name=
this.constructor.name||"UnnamedBrush";this.brushEffect=null}var t=q.prototype;t.prepareState=function(E,C){};t.draw=function(E,C,A){};t.drawMany=function(E,C,A){for(const y of C)y.visible&&this.draw(E,y,A)};return q}()})},"esri/views/2d/engine/imagery/BrushRasterBitmap":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./RasterBitmap ../webgl/VertexStream ../webgl/brushes/WGLBrush ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),function(q,t,E,C,A,y,
m){return function(l){function c(){var b=l.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};b._rendererUniformInfos=new Map;return b}q._inheritsLoose(c,l);var a=c.prototype;a.dispose=
function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b}){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0)};a.draw=function(b,d){if(E.hasSource(d)&&!d.suspended){var {timeline:e,context:p,painter:r}=b;e.begin(this.name);p.setStencilFunction(y.CompareFunction.EQUAL,d.stencilRef,255);var v=
!p.capabilities.textureFloat?.textureFloatLinear;d.updateTexture(b);v=this._getShaderVariations(d,v);v=r.materialManager.getProgram(this._desc[d.symbolizerParameters.type],v);this._drawWithProgram(b,v,d);e.end(this.name)}};a._drawWithProgram=function({context:b,requestRender:d,allowDelayedRender:e},p,r,v=1,h=[0,0],w=!1){this._quad||(this._quad=new C(b,[0,0,1,0,0,1,1,1]));if(e&&t.isSome(d)&&!p.isCompiled)d();else{var {symbolizerParameters:u,transformGrid:k,width:g,height:f,opacity:n}=r;d=u.type;b.useProgram(p);
e=this._getShaderVariations(r);d=this._getUniformInfos(d,b,p,e);var {names:z,textures:x}=r.getTextures();m.setTextures(b,p,z,x);b=m.getBasicGridUniforms(v,h);w=m.getCommonUniforms(k,[g,f],[r.source.width,r.source.height],n,w);m.setUniforms(p,d,{u_coordScale:r.coordScale,u_dvsMat3:r.transforms.dvs,...b,...w});if(u.colormap){const {colormap:B,colormapOffset:D}=u;r=m.getColormapUniforms(B,D);m.setUniforms(p,d,r)}"stretch"===u.type?(r=m.getStretchUniforms(u),m.setUniforms(p,d,r)):"hillshade"===u.type&&
(r=m.getShadedReliefUniforms(u),m.setUniforms(p,d,r));this._quad.draw()}};a._getUniformInfos=function(b,d,e,p){b=0<p.length?b+"-"+p.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);d=m.getUniformLocationInfos(d,e);this._rendererUniformInfos.set(b,d);return d};a._getShaderVariations=function(b,d=!1){const e=[],{interpolation:p}=b,{type:r,colormap:v}=b.symbolizerParameters;"cubic"===p?e.push("bicubic"):"bilinear"===p&&"stretch"===r&&null!=v?(e.push("bilinear"),
e.push("nnedge")):d&&"bilinear"===p&&e.push("bilinear");b.isRendereredSource?e.push("noop"):v&&e.push("applyColormap");b.transformGrid&&(e.push("applyProjection"),1===b.transformGrid.spacing[0]&&e.push("lookupProjection"));return e};return c}(A)})},"esri/views/2d/engine/imagery/RasterBitmap":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/pixelUtils ../DisplayObject ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a){const b={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};l=function(e){function p(v=null,h=null,w=null){var u=e.call(this)||this;u._textureInvalidated=!0;u._colormapTextureInvalidated=!0;u._supportsBilinearTexture=!0;u.stencilRef=0;u.coordScale=[1,1];u._symbolizerParameters=null;u.height=null;u.isRendereredSource=
!1;u.pixelRatio=1;u.resolution=0;u.rotation=0;u._source=null;u.rawPixelData=null;u._suspended=!1;u._bandIds=null;u._interpolation=null;u._transformGrid=null;u.width=null;u.x=0;u.y=0;u.source=v;u.transformGrid=h;u.interpolation=w;return u}t._inheritsLoose(p,e);var r=p.prototype;r.destroy=function(){this.getTextures()?.textures.forEach(v=>v.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};r.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=
!0,this.requestRender())};r._createTransforms=function(){return{dvs:A.create()}};r.setTransform=function(v){const h=C.identity(this.transforms.dvs),[w,u]=v.toScreenNoRotation([0,0],[this.x,this.y]);var k=this.resolution/this.pixelRatio/v.resolution;const g=k*this.width;k*=this.height;const f=Math.PI*this.rotation/180;C.translate(h,h,y.fromValues(w,u));C.translate(h,h,y.fromValues(g/2,k/2));C.rotate(h,h,-f);C.translate(h,h,y.fromValues(-g/2,-k/2));C.scaleByVec2(h,h,y.fromValues(g,k));C.multiply(this.transforms.dvs,
v.displayViewMat3,h)};r.getTextures=function(){if(!this._rasterTexture)return null;const v=[],h=[];this._transformGridTexture&&(h.push(this._transformGridTexture),v.push("u_transformGrid"));this._rasterTexture&&(h.push(this._rasterTexture),v.push("u_image"));this._colormapTexture&&(h.push(this._colormapTexture),v.push("u_colormap"));return{names:v,textures:h}};r.onAttach=function(){this.invalidateTexture()};r.onDetach=function(){this.invalidateTexture()};r.updateTexture=function({context:v}){if(this.stage){var h=
this._isValidSource(this.source);h&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(v));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(v),this._rasterTexture&&(h?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=a.createTransformTexture(v,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else this._rasterTexture?.dispose(),
this._transformGridTexture?.dispose(),this._colormapTexture?.dispose(),this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null};r._createOrDestroyRasterTexture=function(v){const h=E.isSome(this.source)?m.extractBands(this.source,this.bandIds):null;if(this._isValidSource(h)){var w=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(w)return;this._rasterTexture.dispose();this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=
v.capabilities.textureFloat?.textureFloatLinear;w=this._getTextureSamplingMethod(this.interpolation);this._rasterTexture=a.createRasterTexture(v,h,w,this.isRendereredSource||!v.capabilities.textureFloat?.textureFloat);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=null)};r._isBandIdschanged=function(v){const h=this._rasterTextureBandIds;return!(null==h&&null==v||h&&v&&h.join("")===
v.join(""))};r._isValidSource=function(v){return E.isSome(v)&&0<v.pixels?.length};r._getTextureSamplingMethod=function(v){const {type:h,colormap:w}=this.symbolizerParameters,u="lut"===h||"stretch"===h&&E.isSome(w);return!this._supportsBilinearTexture||u||"bilinear"!==v&&"cubic"!==v?"nearest":"bilinear"};r._updateColormapTexture=function(v){const h=this._colormap,w=this.symbolizerParameters.colormap;if(!w)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=
null;else if(!h)this._colormapTexture=a.createColormapTexture(v,w),this._colormap=w;else if(w.length!==h.length||w.some((u,k)=>u!==h[k]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=a.createColormapTexture(v,w),this._colormap=w};t._createClass(p,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||b},set:function(v){this._symbolizerParameters!==v&&(this._symbolizerParameters=v,this._colormapTextureInvalidated=!0)}},
{key:"source",get:function(){return this._source},set:function(v){this._source!==v&&(this._source=v,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(v){this._suspended&&!v&&this.stage&&(this.ready(),this.requestRender());this._suspended=v}},{key:"bandIds",get:function(){return this._bandIds},set:function(v){this._bandIds=v;this._isBandIdschanged(v)&&
this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(v){this._interpolation=v;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(v)?c.TextureSamplingMode.LINEAR:c.TextureSamplingMode.NEAREST)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(v){this._transformGrid=v;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=
null)}}]);return p}(l.DisplayObject);let d=function(e){function p(){return e.apply(this,arguments)||this}t._inheritsLoose(p,e);t._createClass(p,[{key:"source",get:function(){return this._source}}]);return p}(l);q.RasterBitmap=l;q.RasterBitmapWithSource=d;q.hasSource=function(e){return E.isSome(e.source)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock"],
function(q,t,E){function C(k){return t.isSome(k)&&"esri.layers.support.PixelBlock"===k.declaredClass&&k.pixels&&0<k.pixels.length}function A(k,g,f,n,z){const x=k.length;z=E.createEmptyBand(z,x);if(g)for(let B=0;B<x;B++)g[B]&&(z[B]=f[k[B]-n]);else for(g=0;g<x;g++)z[g]=f[k[g]-n];return z}function y(k,g,f,n){const z=null!=f&&2<=f.length?new Set(f):null;f=1===f?.length?f[0]:null;const x=!!g?.length;for(let B=0;B<k.length;B++)if(n[B]){const D=k[B];if(x){let F=!1;for(let G=0;G<g.length;G+=2)if(D>=g[G]&&
D<=g[G+1]){F=!0;break}F||(n[B]=0)}n[B]&&(D===f||z?.has(D))&&(n[B]=0)}}function m(k,g){const f=k[0].length;for(let n=0;n<f;n++)if(g[n]){let z=!1;for(let x=0;x<k.length;x++)if(k[x][n]){z=!0;break}z||(g[n]=0)}}function l(k,g){const f=k[0].length;for(let n=0;n<f;n++)if(g[n]){let z=!1;for(let x=0;x<k.length;x++)if(0===k[x][n]){z=!0;break}z&&(g[n]=0)}}function c(k,g,f,n,z,x,B,D){return{xmin:z<=f*k?0:z<f*k+k?z-f*k:k,ymin:x<=n*g?0:x<n*g+g?x-n*g:g,xmax:z+B<=f*k?0:z+B<f*k+k?z+B-f*k:k,ymax:x+D<=n*g?0:x+D<n*
g+g?x+D-n*g:g}}function a(k,g,f,n,z,x){const {width:B,height:D}=f.block,{x:F,y:G}=f.offset,{width:H,height:J}=f.mosaic;f=c(B,D,n,z,F,G,H,J);let L=0;var K=0;if(x){var U=x.hasGCSSShiftTransform?360:x.halfWorldWidth??0,X=B*x.resolutionX;const Z=x.startX+n*X;Z<U&&Z+X>U?K=x.rightPadding:Z>=U&&(L=x.leftMargin-x.rightPadding,K=0)}f.xmax-=K;if("number"===typeof g)for(x=f.ymin;x<f.ymax;x++)for(K=(z*D+x-G)*H+(n*B-F)+L,U=f.xmin;U<f.xmax;U++)k[K+U]=g;else for(x=f.ymin;x<f.ymax;x++)for(K=(z*D+x-G)*H+(n*B-F)+L,
U=x*B,X=f.xmin;X<f.xmax;X++)k[K+X]=g[U+X]}function b(k,g,f={}){const {clipOffset:n,clipSize:z,alignmentInfo:x,blockWidths:B}=f;if(B)return d(k,g,{blockWidths:B});var D=k.find(da=>C(da));if(t.isNone(D))return null;f=z?z.width:g.width;const F=z?z.height:g.height;var G=D.width,H=D.height;const J=g.width/G,L=g.height/H;g={offset:n||{x:0,y:0},mosaic:z||g,block:{width:G,height:H}};G=D.pixelType;H=E.getPixelArrayConstructor(G);var K=D.pixels.length;D=[];for(var U=0;U<K;U++){var X=new H(f*F);for(let da=0;da<
L;da++)for(let R=0;R<J;R++){var Z=k[da*J+R];C(Z)&&(Z=Z.pixels[U],a(X,Z,g,R,da,x))}D.push(X)}let aa;if(k.some(da=>t.isNone(da)||t.isSome(da.mask)&&0<da.mask.length))for(aa=new Uint8Array(f*F),H=0;H<L;H++)for(K=0;K<J;K++)X=k[H*J+K],U=t.isSome(X)?X.mask:null,t.isSome(U)?a(aa,U,g,K,H,x):X?a(aa,1,g,K,H,x):a(aa,0,g,K,H,x);k=new E({width:f,height:F,pixels:D,pixelType:G,mask:aa});k.updateStatistics();return k}function d(k,g,f){const n=k.find(K=>t.isSome(K));if(t.isNone(n))return null;var z=k.some(K=>t.isSome(K)?
!!K.mask:!0);const {width:x,height:B}=g;g=z?new Uint8Array(x*B):null;({blockWidths:f}=f);const D=[],F=n.getPlaneCount(),G=E.getPixelArrayConstructor(n.pixelType);if(z)for(let K=0,U=0;K<k.length;U+=f[K],K++)if(z=k[K],C(z)){var H=t.unwrap(z.mask);for(var J=0;J<B;J++)for(var L=0;L<f[K];L++)g[J*x+L+U]=null==H?255:H[J*z.width+L]}for(z=0;z<F;z++){H=new G(x*B);for(let K=0,U=0;K<k.length;U+=f[K],K++)if(J=k[K],C(J)&&(L=J.pixels[z],null!=L))for(let X=0;X<B;X++)for(let Z=0;Z<f[K];Z++)H[X*x+Z+U]=L[X*J.width+
Z];D.push(H)}k=new E({width:x,height:B,mask:g,pixels:D,pixelType:n.pixelType});k.updateStatistics();return k}function e(k){if(!C(k))return null;const g=k.clone(),{width:f,height:n,pixels:z}=k;var x=z[0];const B=g.pixels[0];k=t.unwrap(k.mask);for(let G=2;G<n-1;G++){const H=new Map;for(var D=G-2;D<G+2;D++)for(var F=0;4>F;F++){const J=D*f+F;v(H,x[J],k?k[J]:1)}B[G*f]=p(H);B[G*f+1]=B[G*f+2]=B[G*f];for(D=3;D<f-1;D++)F=(G-2)*f+D+1,v(H,x[F],k?k[F]:1),F=(G-1)*f+D+1,v(H,x[F],k?k[F]:1),F=G*f+D+1,v(H,x[F],k?
k[F]:1),F=(G+1)*f+D+1,v(H,x[F],k?k[F]:1),F=(G-2)*f+D-3,r(H,x[F],k?k[F]:1),F=(G-1)*f+D-3,r(H,x[F],k?k[F]:1),F=G*f+D-3,r(H,x[F],k?k[F]:1),F=(G+1)*f+D-3,r(H,x[F],k?k[F]:1),B[G*f+D]=p(H);B[G*f+D+1]=B[G*f+D]}for(x=0;x<f;x++)B[x]=B[f+x]=B[2*f+x],B[(n-1)*f+x]=B[(n-2)*f+x];g.updateStatistics();return g}function p(k){if(0===k.size)return 0;let g=0,f=-1,n=0;const z=k.keys();let x=z.next();for(;!x.done;)n=k.get(x.value),n>g&&(f=x.value,g=n),x=z.next();return f}function r(k,g,f){0!==f&&(f=k.get(g),1===f?k.delete(g):
k.set(g,f-1))}function v(k,g,f){0!==f&&k.set(g,k.has(g)?k.get(g)+1:1)}function h(k,g,f){let {x:n,y:z}=g;const {width:x,height:B}=f;if(0===n&&0===z&&B===k.height&&x===k.width)return k;const {width:D,height:F}=k;g=Math.max(0,z);const G=Math.max(0,n),H=Math.min(n+x,D),J=Math.min(z+B,F);if(0>H||0>J||!C(k))return null;n=Math.max(0,-n);z=Math.max(0,-z);var {pixels:L}=k,K=x*B,U=L.length;const X=[];for(var Z=0;Z<U;Z++){var aa=L[Z],da=E.createEmptyBand(k.pixelType,K);for(let R=g;R<J;R++){const M=R*D;let Q=
(R+z-g)*x+n;for(let N=G;N<H;N++)da[Q++]=aa[M+N]}X.push(da)}L=new Uint8Array(K);K=t.unwrap(k.mask);for(U=g;U<J;U++)for(Z=U*D,aa=(U+z-g)*x+n,da=G;da<H;da++)L[aa++]=K?K[Z+da]:1;k=new E({width:f.width,height:f.height,pixelType:k.pixelType,pixels:X,mask:L});k.updateStatistics();return k}function w(k,g=!0){if(!C(k))return null;const {pixels:f,width:n,height:z,mask:x,pixelType:B}=k;k=[];const D=Math.round(n/2),F=Math.round(z/2),G=z-1,H=n-1;for(var J=0;J<f.length;J++){var L=f[J],K=E.createEmptyBand(B,D*F),
U=0;for(var X=0;X<z;X+=2)for(var Z=0;Z<n;Z+=2){var aa=L[X*n+Z];if(g){var da=Z===H?aa:L[X*n+Z+1];const R=X===G?aa:L[X*n+Z+n],M=Z===H?R:X===G?da:L[X*n+Z+n+1];K[U++]=(aa+da+R+M)/4}else K[U++]=aa}k.push(K)}J=null;if(t.isSome(x))for(J=new Uint8Array(D*F),L=0,K=0;K<z;K+=2)for(U=0;U<n;U+=2)X=x[K*n+U],g?(Z=U===H?X:x[K*n+U+1],aa=K===G?X:x[K*n+U+n],da=U===H?aa:K===G?Z:x[K*n+U+n+1],J[L++]=X*Z*aa*da?1:0):J[L++]=X;return new E({width:D,height:F,pixelType:B,pixels:k,mask:J})}function u(k,g,f,n,z=.5){const {width:x,
height:B}=k,{width:D,height:F}=g;k=n.cols;n=n.rows;g=Math.ceil(D/k-.1/k);const G=Math.ceil(F/n-.1/n);let H,J,L,K,U;const X=g*k;var Z=X*G*n;const aa=new Float32Array(Z),da=new Float32Array(Z),R=new Uint32Array(Z),M=new Uint32Array(Z);let Q=0,N,S;for(let ba=0;ba<G;ba++)for(let I=0;I<g;I++){var W=12*(ba*g+I);Z=f[W];H=f[W+1];J=f[W+2];L=f[W+3];K=f[W+4];U=f[W+5];for(var T=0;T<n;T++){Q=(ba*n+T)*X+I*k;S=(T+.5)/n;for(let P=0;P<T;P++)N=(P+.5)/k,aa[Q+P]=(Z*N+H*S+J)*x-z,da[Q+P]=(L*N+K*S+U)*B-z,R[Q+P]=Math.round(aa[Q+
P]),M[Q+P]=Math.round(da[Q+P])}W+=6;Z=f[W];H=f[W+1];J=f[W+2];L=f[W+3];K=f[W+4];U=f[W+5];for(W=0;W<n;W++)for(Q=(ba*n+W)*X+I*k,S=(W+.5)/n,T=W;T<k;T++)N=(T+.5)/k,aa[Q+T]=(Z*N+H*S+J)*x-z,da[Q+T]=(L*N+K*S+U)*B-z,R[Q+T]=Math.round(aa[Q+T]),M[Q+T]=Math.round(da[Q+T])}return{offsets_x:aa,offsets_y:da,offsets_xi:R,offsets_yi:M,gridWidth:X}}q.NoDataInterpretation=void 0;(function(k){k[k.matchAny=0]="matchAny";k[k.matchAll=1]="matchAll"})(q.NoDataInterpretation||(q.NoDataInterpretation={}));q.MissingBandAction=
void 0;(function(k){k[k.bestMatch=0]="bestMatch";k[k.fail=1]="fail"})(q.MissingBandAction||(q.MissingBandAction={}));q.approximateTransform=function(k,g,f,n,z="nearest"){if(!C(k))return null;"majority"===z&&(k=e(k));const {pixels:x,mask:B,pixelType:D}=k,F=k.width;var G=k.height;const H=E.getPixelArrayConstructor(D),J=x.length,{width:L,height:K}=g;k=!1;for(let M=0;M<f.length;M+=3)-1===f[M]&&-1===f[M+1]&&-1===f[M+2]&&(k=!0);const {offsets_x:U,offsets_y:X,offsets_xi:Z,offsets_yi:aa,gridWidth:da}=u({width:F,
height:G},g,f,n,"majority"===z?0:.5);let R;g=(M,Q,N)=>{const S=M instanceof Float32Array||M instanceof Float64Array?0:.5;for(let W=0;W<K;W++){R=W*da;for(let T=0;T<L;T++){if(0>U[R]||0>X[R])M[W*L+T]=0;else if(N)M[W*L+T]=Q[Z[R]+aa[R]*F];else{const ba=Math.floor(U[R]),I=Math.floor(X[R]),P=Math.ceil(U[R]),O=Math.ceil(X[R]),V=U[R]-ba,Y=X[R]-I;M[W*L+T]=!B||B[ba+I*F]&&B[ba+I*F]&&B[ba+O*F]&&B[P+O*F]?(1-Y)*((1-V)*Q[ba+I*F]+V*Q[P+I*F])+Y*((1-V)*Q[ba+O*F]+V*Q[P+O*F])+S:Q[Z[R]+aa[R]*F]}R++}}};f=[];for(G=0;G<J;G++)n=
new H(L*K),g(n,x[G],"nearest"===z||"majority"===z),f.push(n);z=new E({width:L,height:K,pixelType:D,pixels:f});if(t.isSome(B))z.mask=new Uint8Array(L*K),g(z.mask,B,!0);else if(k)for(z.mask=new Uint8Array(L*K),k=0;k<L*K;k++)z.mask[k]=0>U[k]||0>X[k]?0:1;z.updateStatistics();return z};q.clip=h;q.colorize=function(k,g){if(!C(k)||!g||!g.indexedColormap&&!g.indexed2DColormap)return k;const f=k.clone();var n=f.pixels;let z=f.mask;const x=f.width*f.height;if(1!==n.length)return k;const {indexedColormap:B,
indexed2DColormap:D,offset:F,alphaSpecified:G}=g;k=0;n=n[0];g=new Uint8Array(n.length);const H=new Uint8Array(n.length),J=new Uint8Array(n.length);var L=0;if(B){const K=B.length-1;if(t.isSome(z))for(k=0;k<x;k++)z[k]&&(L=4*(n[k]-F),L<F||L>K?z[k]=0:(g[k]=B[L],H[k]=B[L+1],J[k]=B[L+2],z[k]=B[L+3]));else{z=new Uint8Array(x);for(k=0;k<x;k++)L=4*(n[k]-F),L<F||L>K?z[k]=0:(g[k]=B[L],H[k]=B[L+1],J[k]=B[L+2],z[k]=B[L+3]);f.mask=z}}else if(D)if(t.isSome(z))for(k=0;k<x;k++)z[k]&&(L=D[n[k]],g[k]=L[0],H[k]=L[1],
J[k]=L[2],z[k]=L[3]);else{z=new Uint8Array(x);for(k=0;k<x;k++)L=D[n[k]],g[k]=L[0],H[k]=L[1],J[k]=L[2],z[k]=L[3];f.mask=z}f.pixels=[g,H,J];f.statistics=null;f.pixelType="u8";f.maskIsAlpha=G;return f};q.compositeBands=function(k){if(!k?.length||k.some(F=>!C(F)))return null;if(1===k.length)return t.isSome(k[0])?k[0].clone():null;const {width:g,height:f,pixelType:n}=k[0];if(k.some(F=>F.width!==g||F.height!==f))return null;const z=k.map(({mask:F})=>F).filter(F=>null!=F);let x=null;z.length&&(x=new Uint8Array(g*
f),x.set(z[0]),1<z.length&&l(z.slice(1),x));const B=[];k.forEach(({pixels:F})=>B.push(...F));const D=[];k.map(({statistics:F})=>F).filter(F=>F?.length).forEach(F=>D.push(...F));return new E({pixelType:n,width:g,height:f,mask:x,pixels:B,statistics:D.length?D:null})};q.createColormapLUT=function(k){if(k){var g=k.colormap;if(g&&0!==g.length){g=g.sort((G,H)=>G[0]-H[0]);var f=0;0>g[0][0]&&(f=g[0][0]);var n=Math.max(256,g[g.length-1][0]-f+1),z=new Uint8Array(4*n),x=[],B=0,D=0,F=5===g[0].length;if(65536<
n)return g.forEach(G=>{x[G[0]-f]=F?G.slice(1):G.slice(1).concat([255])}),{indexed2DColormap:x,offset:f,alphaSpecified:F};if(k.fillUnspecified)for(k=g[D],B=k[0]-f;B<n;B++)z[4*B]=k[1],z[4*B+1]=k[2],z[4*B+2]=k[3],z[4*B+3]=F?k[4]:255,B===k[0]-f&&(k=D===g.length-1?k:g[++D]);else for(B=0;B<g.length;B++)k=g[B],D=4*(k[0]-f),z[D]=k[1],z[D+1]=k[2],z[D+2]=k[3],z[D+3]=F?k[4]:255;return{indexedColormap:z,offset:f,alphaSpecified:F}}}};q.createMaskLUT=function(k,g,f){if("u8"!==k&&"s8"!==k&&"u16"!==k&&"s16"!==k)return null;
var n=k.includes("16")?65536:256;k=k.includes("s")?-n/2:0;n=new Uint8Array(n);if(g)for(let x=0;x<g.length;x++){var z=Math.ceil(g[2*x]-k);const B=Math.floor(g[2*x+1]-k);for(;z<=B;z++)n[z]=255}if(f)for(g=0;g<f.length;g++)n[f[g]-k]=0;return{lut:n,offset:k}};q.createRemapLUT=function(k,g,f){if("u8"!==k&&"s8"!==k&&"u16"!==k&&"s16"!==k)return null;var n=k.includes("16")?65536:256;const z=k.includes("s")?-n/2:0;k=E.createEmptyBand(k,n);for(n=0;n<g.length;n++){const B=f[n];var x=Math.ceil(g[2*n]-z);const D=
Math.floor(g[2*n+1]-z);for(;x<=D;x++)k[x]=B}return{lut:k,offset:z}};q.extractBands=function(k,g){if(!g?.length||!C(k))return k;const f=k.pixels.length;return g&&g.some(n=>n>=f)||1===f&&1===g.length&&0===g[0]||f===g.length&&!g.some((n,z)=>n!==z)?k:new E({pixelType:k.pixelType,width:k.width,height:k.height,mask:k.mask,validPixelCount:k.validPixelCount,maskIsAlpha:k.maskIsAlpha,pixels:g.map(n=>k.pixels[n]),statistics:k.statistics&&g.map(n=>k.statistics[n])})};q.getClipBounds=c;q.getLocalArithmeticNorthRotations=
function(k,g){const {coefficients:f,spacing:n}=g,{offsets_x:z,offsets_y:x,gridWidth:B}=u(k,k,f,{rows:n[0],cols:n[1]},.5),{width:D,height:F}=k;k=new Float32Array(D*F);g=180/Math.PI;for(let J=0;J<F;J++)for(let L=0;L<D;L++){var G=J*B+L,H=0===J?G:G-B;const K=J===F-1?G:G+B;G=z[H]-z[K];H=x[K]-x[H];isNaN(G)||isNaN(H)?k[J*D+L]=90:(H=Math.atan2(H,G)*g,H=(360+H)%360,k[J*D+L]=H)}return k};q.isValidPixelBlock=C;q.lookupBandValues=A;q.lookupPixels=function(k,g){if(!C(k))return null;const {pixels:f,mask:n}=k,z=
f.length;let x=g.lut;const {offset:B}=g;x&&1===x[0].length&&(x=f.map(()=>x));const D=[];g=g.outputPixelType||"u8";for(let F=0;F<z;F++){const G=A(f[F],n,x[F],B||0,g);D.push(G)}k=new E({width:k.width,height:k.height,pixels:D,mask:n,pixelType:g});k.updateStatistics();return k};q.mask=function(k,g){if(!C(k))return null;const {width:f,height:n,pixels:z}=k;var x=f*n;const B=new Uint8Array(x);k.mask?B.set(k.mask):B.fill(255);k=z.length;const {includedRanges:D,noDataValues:F,outputPixelType:G,matchAll:H,
lookup:J}=g;if(J){x=[];for(g=0;g<k;g++){var L=A(z[g],B,J.lut,J.offset||0,"u8");x.push(L)}1===x.length?B.set(x[0]):H?m(x,B):l(x,B)}else if(H){g=[];for(L=0;L<k;L++){const K=new Uint8Array(x);K.set(B);y(z[L],D,F,K);g.push(K)}1===g.length?B.set(g[0]):m(g,B)}else for(x=0;x<k;x++)y(z[x],D,F,B);return new E({width:f,height:n,pixelType:G,pixels:z,mask:B})};q.mosaic=b;q.mosaicPixelData=function(k,g){if(!k||0===k.length)return null;var f=k.find(J=>J.pixelBlock);if(!f||t.isNone(f.pixelBlock))return null;var n=
(f.extent.xmax-f.extent.xmin)/f.pixelBlock.width;const z=(f.extent.ymax-f.extent.ymin)/f.pixelBlock.height,x=.01*Math.min(n,z),B=k.sort((J,L)=>Math.abs(J.extent.ymax-L.extent.ymax)>x?L.extent.ymax-J.extent.ymax:Math.abs(J.extent.xmin-L.extent.xmin)>x?J.extent.xmin-L.extent.xmin:0);var D=Math.min.apply(null,B.map(J=>J.extent.xmin));const F=Math.min.apply(null,B.map(J=>J.extent.ymin)),G=Math.max.apply(null,B.map(J=>J.extent.xmax)),H=Math.max.apply(null,B.map(J=>J.extent.ymax));k={x:Math.round((g.xmin-
D)/n),y:Math.round((H-g.ymax)/z)};D={width:Math.round((G-D)/n),height:Math.round((H-F)/z)};n={width:Math.round((g.xmax-g.xmin)/n),height:Math.round((g.ymax-g.ymin)/z)};if(Math.round(D.width/f.pixelBlock.width)*Math.round(D.height/f.pixelBlock.height)!==B.length||0>k.x||0>k.y||D.width<n.width||D.height<n.height)return null;f=B.map(J=>J.pixelBlock);f=b(f,D,{clipOffset:k,clipSize:n});return{extent:g,pixelBlock:f}};q.remap=function(k,g){if(!C(k))return null;const {width:f,height:n}=k,{inputRanges:z,outputValues:x,
outputPixelType:B,noDataRanges:D,allowUnmatched:F}=g;g=k.pixels[0];const G=E.createEmptyBand(B,g.length);F&&G.set(g);k=k.mask;const H=z.length/2;for(var J=0;J<n;J++)for(var L=0;L<f;L++){var K=J*f+L;if(!k||k[K]){var U=g[K];for(var X=H-1;0<=X;X--)if(U>=z[2*X]&&U<=z[2*X+1]){G[K]=x[X];break}}}J=k;if(D?.length)for(J=new Uint8Array(f*n),k&&J.set(k),L=0;L<n;L++)for(K=0;K<f;K++)if(U=L*f+K,!k||k[U]){X=g[U];for(let Z=0;Z<H;Z+=2)if(X>=D[Z]&&X<=D[Z+1]){G[U]=0;J[U]=0;break}}return new E({width:f,height:n,pixelType:B,
pixels:[G],mask:J})};q.remapColor=function(k,g){if(!C(k))return null;k=k.clone();var {pixels:f}=k;const n=k.width*k.height,z=g.length,x=Math.floor(z/2),B=g[Math.floor(x)];f=f[0];let D,F,G,H,J,L,K=!1;const U=new Uint8Array(n),X=new Uint8Array(n),Z=new Uint8Array(n);let aa=k.mask;const da=4===g[0].mappedColor.length;aa||(aa=new Uint8Array(n),aa.fill(da?255:1),k.mask=aa);for(J=0;J<n;J++)if(aa[J]){D=f[J];K=!1;L=x;F=B;G=0;for(H=z-1;1<H-G;){if(D===F.value){K=!0;break}D>F.value?G=L:H=L;L=Math.floor((G+H)/
2);F=g[Math.floor(L)]}K||(D===g[G].value?(F=g[G],K=!0):D===g[H].value?(F=g[H],K=!0):D<g[G].value?(K=!1,F=null):D>g[G].value&&(D<g[H].value?(F=g[G],K=!0):H===z-1?(K=!1,F=null):(F=g[H],K=!0)));K?(U[J]=F.mappedColor[0],X[J]=F.mappedColor[1],Z[J]=F.mappedColor[2],aa[J]=F.mappedColor[3]):U[J]=X[J]=Z[J]=aa[J]=0}k.pixels=[U,X,Z];k.mask=aa;k.pixelType="u8";k.maskIsAlpha=da;return k};q.resampleByMajority=e;q.setValidBoundary=function(k,g,f){if(!C(k))return null;const {width:n,height:z}=k,x=g.x;g=g.y;const B=
f.width+x;f=f.height+g;if(0>x||0>g||B>n||f>z||0===x&&0===g&&B===n&&f===z)return k;k.mask||(k.mask=new Uint8Array(n*z));const D=k.mask;for(let F=0;F<z;F++){const G=F*n;for(let H=0;H<n;H++)D[G+H]=F<g||F>=f||H<x||H>=B?0:1}k.updateStatistics();return k};q.split=function(k,g,f){if(!C(k))return null;const {width:n,height:z}=g;let {width:x,height:B}=k;const D=new Map,F={x:0,y:0};f=null==f?1:1+f;for(let G=0;G<f;G++){const H=Math.ceil(x/n),J=Math.ceil(B/z);for(let L=0;L<J;L++){F.y=L*z;for(let K=0;K<H;K++){F.x=
K*n;const U=h(k,F,g);D.set(`${G}/${L}/${K}`,U)}}G<f-1&&(k=w(k));x=Math.round(x/2);B=Math.round(B/2)}return D};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b){var d;C=d=function(e){function p(v){v=e.call(this,v)||this;v.width=null;v.height=null;v.pixelType="f32";v.validPixelCount=null;v.mask=null;v.maskIsAlpha=!1;v.statistics=null;return v}q._inheritsLoose(p,e);p.createEmptyBand=function(v,h){return new (d.getPixelArrayConstructor(v))(h)};p.getPixelArrayConstructor=function(v){let h;switch(v){case "u1":case "u2":case "u4":case "u8":h=Uint8Array;break;case "u16":h=Uint16Array;break;case "u32":h=Uint32Array;break;case "s8":h=
Int8Array;break;case "s16":h=Int16Array;break;case "s32":h=Int32Array;break;case "f32":h=Float32Array;break;case "f64":h=Float64Array;break;case "c64":case "c128":case "unknown":h=Float32Array}return h};var r=p.prototype;r.castPixelType=function(v){if(!v)return"f32";v=v.toLowerCase();["u1","u2","u4"].includes(v)?v="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(v)||(v="f32");return v};r.getPlaneCount=function(){return this.pixels?.length};r.addData=function(v){if(!v.pixels||v.pixels.length!==
this.width*this.height)throw new E("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(v.pixels);this.statistics.push(v.statistics??new b.SimpleBandStatistics)};r.getAsRGBA=function(){const v=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(v);
break;default:this._fillFrom8Bit(v)}return new Uint8ClampedArray(v)};r.getAsRGBAFloat=function(){const v=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(v);return v};r.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(w=>this._calculateBandStatistics(w,this.mask));var v=this.mask,h=0;if(m.isSome(v))for(let w=0;w<v.length;w++)v[w]&&h++;else h=this.width*this.height;this.validPixelCount=h}};r.clamp=function(v){if(v&&"f64"!==v&&"f32"!==v&&this.pixels){switch(v){case "u8":var h=
[0,255];break;case "u16":h=[0,65535];break;case "u32":h=[0,4294967295];break;case "s8":h=[-128,127];break;case "s16":h=[-32768,32767];break;case "s32":h=[-2147483648,2147483647];break;default:h=[-3.4*1E39,3.4*1E39]}var [w,u]=h;h=this.pixels;var k=this.width*this.height,g=h.length,f=[];for(let B=0;B<g;B++){var n=d.createEmptyBand(v,k);var z=h[B];for(let D=0;D<k;D++){var x=z[D];n[D]=x>u?u:x<w?w:x}f.push(n)}this.pixels=f;this.pixelType=v}};r.extractBands=function(v){const {pixels:h,statistics:w}=this;
if(m.isNone(v)||0===v.length||!h||0===h.length)return this;var u=h.length;const k=v.some(g=>g>=h.length);u=u===v.length&&!v.some((g,f)=>g!==f);return k||u?this:new d({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:v.map(g=>h[g]),statistics:w&&v.map(g=>w[g])})};r.clone=function(){const v=new d({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
m.isSome(this.mask)&&(v.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let h;const w=d.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){v.pixels=[];const u=!!this.pixels[0].slice;for(h=0;h<this.pixels.length;h++)v.pixels[h]=u?this.pixels[h].slice(0,this.pixels[h].length):new w(this.pixels[h])}if(this.statistics)for(v.statistics=[],h=0;h<this.statistics.length;h++)v.statistics[h]=A.clone(this.statistics[h]);return v};r._fillFrom8Bit=
function(v){const {mask:h,maskIsAlpha:w,pixels:u}=this;if(v&&u&&u.length){var k,g;var f=k=g=u[0];3<=u.length?(k=u[1],g=u[2]):2===u.length&&(k=u[1]);var n=new Uint32Array(v),z=this.width*this.height;if(f.length!==z)y.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(m.isSome(h)&&h.length===z)if(w)for(v=0;v<z;v++)h[v]&&(n[v]=h[v]<<24|g[v]<<16|k[v]<<8|f[v]);else for(v=0;v<z;v++)h[v]&&(n[v]=-16777216|g[v]<<16|k[v]<<8|f[v]);else for(v=0;v<
z;v++)n[v]=-16777216|g[v]<<16|k[v]<<8|f[v]}else y.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};r._fillFromNon8Bit=function(v){const {pixels:h,mask:w,statistics:u}=this;if(v&&h&&h.length){var k=this.pixelType,g=1,f=0;g=1;if(u&&0<u.length){for(var n of u)null!=n.minValue&&(f=Math.min(f,n.minValue)),null!=n.maxValue&&null!=n.minValue&&(g=Math.max(g,n.maxValue-n.minValue));g=255/g}else g=255,"s8"===k?(f=-128,g=127):"u16"===k?g=65535:
"s16"===k?(f=-32768,g=32767):"u32"===k?g=4294967295:"s32"===k?(f=-2147483648,g=2147483647):"f32"===k?(f=-3.4*1E39,g=3.4*1E39):"f64"===k&&(f=-Number.MAX_VALUE,g=Number.MAX_VALUE),g=255/(g-f);v=new Uint32Array(v);k=this.width*this.height;var z,x,B;n=z=x=h[0];if(n.length!==k)return y.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=h.length)if(z=h[1],3<=h.length&&(x=h[2]),m.isSome(w)&&w.length===k)for(B=0;B<k;B++)w[B]&&(v[B]=-16777216|(x[B]-
f)*g<<16|(z[B]-f)*g<<8|(n[B]-f)*g);else for(B=0;B<k;B++)v[B]=-16777216|(x[B]-f)*g<<16|(z[B]-f)*g<<8|(n[B]-f)*g;else if(m.isSome(w)&&w.length===k)for(B=0;B<k;B++)z=(n[B]-f)*g,w[B]&&(v[B]=-16777216|z<<16|z<<8|z);else for(B=0;B<k;B++)z=(n[B]-f)*g,v[B]=-16777216|z<<16|z<<8|z}else y.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};r._fillFrom32Bit=function(v){const {pixels:h,mask:w}=this;if(!v||!h||!h.length)return y.getLogger(this.declaredClass).error("getAsRGBAFloat()",
"Unable to convert to RGBA. The input pixel block is empty.");let u,k,g,f;u=k=g=h[0];3<=h.length?(k=h[1],g=h[2]):2===h.length&&(k=h[1]);const n=this.width*this.height;if(u.length!==n)return y.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let z=0;if(m.isSome(w)&&w.length===n)for(f=0;f<n;f++)v[z++]=u[f],v[z++]=k[f],v[z++]=g[f],v[z++]=w[f]&1;else for(f=0;f<n;f++)v[z++]=u[f],v[z++]=k[f],v[z++]=g[f],v[z++]=1};r._calculateBandStatistics=
function(v,h){let w=Infinity,u=-Infinity;const k=v.length;let g,f=0;if(m.isSome(h))for(g=0;g<k;g++)h[g]&&(f=v[g],w=f<w?f:w,u=f>u?f:u);else for(g=0;g<k;g++)f=v[g],w=f<w?f:w,u=f>u?f:u;return new b.SimpleBandStatistics(w,u)};return p}(C.JSONSupport);t.__decorate([l.property({json:{write:!0}})],C.prototype,"width",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"height",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"pixelType",void 0);t.__decorate([c.cast("pixelType")],
C.prototype,"castPixelType",null);t.__decorate([l.property({json:{write:!0}})],C.prototype,"validPixelCount",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"mask",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"maskIsAlpha",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"pixels",void 0);t.__decorate([l.property({json:{write:!0}})],C.prototype,"statistics",void 0);return C=d=t.__decorate([a.subclass("esri.layers.support.PixelBlock")],C)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],
function(q){q.SimpleBandStatistics=function(t=null,E=null,C=null){this.minValue=t;this.maxValue=E;this.noDataValue=C};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/rasterUtils":function(){define(["exports","../../chunks/vec2f64","./context-util","./enums","./Texture"],function(q,t,E,C,A){q.createColormapTexture=function(y,m){return new A.Texture(y,{width:m.length/4,height:1,target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,
internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,samplingMode:C.TextureSamplingMode.NEAREST,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},m)};q.createRasterTexture=function(y,m,l="nearest",c=!1){const a=(c=!(c&&"u8"===m.pixelType))?C.PixelType.FLOAT:C.PixelType.UNSIGNED_BYTE,b=null==m.pixels||0===m.pixels.length?null:c?m.getAsRGBAFloat():m.getAsRGBA();return new A.Texture(y,{width:m.width,height:m.height,target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:y.type===
E.ContextType.WEBGL2&&c?C.SizedPixelFormat.RGBA32F:C.PixelFormat.RGBA,samplingMode:!y.capabilities.textureFloat?.textureFloatLinear||"bilinear"!==l&&"cubic"!==l?C.TextureSamplingMode.NEAREST:C.TextureSamplingMode.LINEAR,dataType:a,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},b)};q.createTransformTexture=function(y,m){const {spacing:l,offsets:c,coefficients:a,size:[b,d]}=m;var e=1<l[0];m={width:e?4*b:b,height:d,target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:y.type===
E.ContextType.WEBGL2?C.SizedPixelFormat.RGBA32F:C.PixelFormat.RGBA,dataType:C.PixelType.FLOAT,samplingMode:C.TextureSamplingMode.NEAREST,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};const p=new Float32Array(e?b*d*16:2*c.length);if(e)for(let r=0,v=0;r<a.length;r++)p[v++]=a[r],2===r%3&&(p[v++]=1);else for(e=0;e<d;e++)for(let r=0;r<b;r++){const v=4*(e*b+r),h=2*(r*d+e);p[v]=c[h];p[v+1]=c[h+1];p[v+3]=-1===c[h]?0:1}return new A.Texture(y,m,p)};q.getBasicGridUniforms=function(y,m){return{u_scale:y,
u_offset:m}};q.getColormapUniforms=function(y,m){return{u_colormapOffset:m||0,u_colormapMaxIndex:y?y.length/4-1:0}};q.getCommonUniforms=function(y,m,l,c=1,a=!0){return{u_flipY:a,u_applyTransform:y?!0:!1,u_opacity:c,u_transformSpacing:y?y.spacing:t.ZEROS,u_transformGridSize:y?y.size:t.ZEROS,u_targetImageSize:m,u_srcImageSize:l}};q.getShadedReliefUniforms=function(y){return{u_hillshadeType:y.hillshadeType,u_sinZcosAs:y.sinZcosAs,u_sinZsinAs:y.sinZsinAs,u_cosZs:y.cosZs,u_weights:y.weights,u_factor:y.factor,
u_minValue:y.minValue,u_maxValue:y.maxValue}};q.getStretchUniforms=function(y){return{u_bandCount:y.bandCount,u_minOutput:y.outMin,u_maxOutput:y.outMax,u_minCutOff:y.minCutOff,u_maxCutOff:y.maxCutOff,u_factor:y.factor,u_useGamma:y.useGamma,u_gamma:y.gamma,u_gammaCorrection:y.gammaCorrection}};q.getUniformLocationInfos=function(y,m){y=y.gl;m=m.glName;const l=y.getProgramParameter(m,y.ACTIVE_UNIFORMS),c=new Map;let a;for(let b=0;b<l;b++)(a=y.getActiveUniform(m,b))&&c.set(a.name,{location:y.getUniformLocation(m,
a.name),info:a});return c};q.setTextures=function(y,m,l,c){l.length===c.length&&(c.some(a=>null==a)||l.some(a=>null==a)||l.forEach((a,b)=>{m.setUniform1i(a,b);y.bindTexture(c[b],b)}))};q.setUniforms=function(y,m,l){Object.keys(l).forEach(c=>{var a=m.get(c)||m.get(c+"[0]");if(a){var b=l[c];if(null!==a&&null!=b)switch({info:a}=a,a.type){case C.UniformType.FLOAT:1<a.size?y.setUniform1fv(c,b):y.setUniform1f(c,b);break;case C.UniformType.FLOAT_VEC2:y.setUniform2fv(c,b);break;case C.UniformType.FLOAT_VEC3:y.setUniform3fv(c,
b);break;case C.UniformType.FLOAT_VEC4:y.setUniform4fv(c,b);break;case C.UniformType.FLOAT_MAT3:y.setUniformMatrix3fv(c,b);break;case C.UniformType.FLOAT_MAT4:y.setUniformMatrix4fv(c,b);break;case C.UniformType.INT:1<a.size?y.setUniform1iv(c,b):y.setUniform1i(c,b);break;case C.UniformType.BOOL:y.setUniform1i(c,b?1:0);break;case C.UniformType.INT_VEC2:case C.UniformType.BOOL_VEC2:y.setUniform2iv(c,b);break;case C.UniformType.INT_VEC3:case C.UniformType.BOOL_VEC3:y.setUniform3iv(c,b);break;case C.UniformType.INT_VEC4:case C.UniformType.BOOL_VEC4:y.setUniform4iv(c,
b)}}})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(q,t,E,C){return function(){function A(m,l){this._rctx=m;this._vertexBuffer=q.BufferObject.createVertex(m,t.Usage.STATIC_DRAW,new Uint16Array(l));this._vao=new E.VertexArrayObject(m,new Map([["a_position",
0]]),{geometry:[new C.VertexElementDescriptor("a_position",2,t.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=l.length/2}var y=A.prototype;y.bind=function(){this._rctx.bindVAO(this._vao)};y.unbind=function(){this._rctx.bindVAO(null)};y.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};y.draw=function(){this._rctx.bindVAO(this._vao);this._rctx.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,this._count)};return A}()})},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports"],
function(q){q.VertexElementDescriptor=function(t,E,C,A,y,m=!1,l=0){this.name=t;this.count=E;this.type=C;this.offset=A;this.stride=y;this.normalized=m;this.divisor=l};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/imagery/BrushVectorField":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(q,t,E,C){const A=new Float32Array([.27058823529411763,
.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,
.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),y={beaufort_ft:A,beaufort_m:A,beaufort_km:A,beaufort_mi:A,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,
1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,
.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,
.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(m){function l(){var a=m.apply(this,arguments)||this;a._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",
0],["a_offset",1],["a_vv",2]])}};return a}q._inheritsLoose(l,m);var c=l.prototype;c.dispose=function(){};c.prepareState=function({context:a}){a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA,C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilOp(C.StencilOperation.KEEP,C.StencilOperation.KEEP,C.StencilOperation.REPLACE)};c.draw=function(a,b){if(!t.isNone(b.source)&&
0!==b.source.validPixelCount){var {context:d,timeline:e}=a;e.begin(this.name);d.setStencilFunction(C.CompareFunction.EQUAL,b.stencilRef,255);b.updateVectorFieldVAO(a);if("scalar"===a.renderPass){var p=b.vaoData.scalar;p&&this._drawScalars(a,b,p.vao,p.elementCount)}else(p=b.vaoData.magdir)&&this._drawTriangles(a,b,p.vao,p.elementCount);e.end(this.name)}};c._drawTriangles=function(a,b,d,e){const {context:p,painter:r,requestRender:v,allowDelayedRender:h}=a,{symbolizerParameters:w}=b;var u=w.dataRange?
["dataRange"]:[];"geographic"===w.rotationType&&u.push("rotationGeographic");u=r.materialManager.getProgram(this._desc.magdir,u);if(h&&t.isSome(v)&&!u.isCompiled)v();else{p.useProgram(u);var {coordScale:k,opacity:g,transforms:f}=b;u.setUniform2fv("u_coordScale",k);u.setUniform1f("u_opacity",g);u.setUniformMatrix3fv("u_dvsMat3",f.dvs);var {style:n,dataRange:z,rotation:x,symbolPercentRange:B}=w;u.setUniform4fv("u_colors",y[n]||y.single_arrow);u.setUniform2fv("u_dataRange",z);u.setUniform1f("u_rotation",
x);u.setUniform2fv("u_symbolPercentRange",B);a=this._getSymbolSize(a,b);u.setUniform2fv("u_symbolSize",a);p.bindVAO(d);p.drawElements(C.PrimitiveType.TRIANGLES,e,C.DataType.UNSIGNED_INT,0)}};c._drawScalars=function(a,b,d,e){const {context:p,painter:r,requestRender:v,allowDelayedRender:h}=a,{symbolizerParameters:w}=b;var u=[];"wind_speed"===w.style?u.push("innerCircle"):w.dataRange&&u.push("dataRange");"geographic"===w.rotationType&&u.push("rotationGeographic");u=r.materialManager.getProgram(this._desc.scalar,
u);if(h&&t.isSome(v)&&!u.isCompiled)v();else{p.useProgram(u);var {coordScale:k,opacity:g,transforms:f}=b;u.setUniform2fv("u_coordScale",k);u.setUniform1f("u_opacity",g);u.setUniformMatrix3fv("u_dvsMat3",f.dvs);var {dataRange:n,symbolPercentRange:z}=w;u.setUniform2fv("u_dataRange",n);u.setUniform2fv("u_symbolPercentRange",z);a=this._getSymbolSize(a,b);u.setUniform2fv("u_symbolSize",a);p.bindVAO(d);p.drawElements(C.PrimitiveType.TRIANGLES,e,C.DataType.UNSIGNED_INT,0)}};c._getSymbolSize=function(a,b){a=
b.key?2**(a.displayLevel-b.key.level):b.resolution/a.state.resolution;const {symbolTileSize:d}=b.symbolizerParameters;return[d/(Math.round((b.width-b.offset[0])/d)*d)/a,d/(Math.round((b.height-b.offset[1])/d)*d)/a]};return l}(E)})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./WGLBrush ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y){const m={nearest:{defines:[],
samplingMode:y.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:y.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:y.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:y.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,mips:!0}};return function(l){function c(){var b=l.apply(this,arguments)||this;b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])};return b}q._inheritsLoose(c,l);var a=c.prototype;a.dispose=
function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b}){b.setBlendingEnabled(!0);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0)};a.draw=function(b,d){const {context:e,renderingOptions:p,painter:r,requestRender:v,allowDelayedRender:h}=b;if(d.source&&d.isReady){if("dynamic"===p.samplingMode){({state:u}=b);var w=d.resolution/d.pixelRatio/u.resolution;const n=Math.round(b.pixelRatio)!==b.pixelRatio;var u=u.rotation||1.05<w||.95>w||n||d.isSourceScaled||
d.rotation?m.bilinear:m.nearest}else u=m[p.samplingMode];w=r.materialManager.getProgram(this._desc,u.defines);if(h&&t.isSome(v)&&!w.isCompiled)v();else{b.timeline.begin(this.name);"additive"===d.blendFunction?e.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE,y.BlendFactor.ONE,y.BlendFactor.ONE):e.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA);e.setStencilFunction(y.CompareFunction.EQUAL,d.stencilRef,255);
this._quad||(this._quad=new C(e,[0,0,1,0,0,1,1,1]));var {coordScale:k,computedOpacity:g,transforms:f}=d;d.setSamplingProfile(u);d.bind(b.context,E.TEXTURE_BINDING_BITMAP);e.useProgram(w);w.setUniformMatrix3fv("u_dvsMat3",f.dvs);w.setUniform1i("u_texture",E.TEXTURE_BINDING_BITMAP);w.setUniform2fv("u_coordScale",k);w.setUniform1f("u_opacity",g);this._quad.draw();b.timeline.end(this.name)}}};return c}(A)})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(q){q.ANGLE_FACTOR_256=
256/360;q.ATTRIBUTE_DATA_ANIMATION=1;q.ATTRIBUTE_DATA_DD0=3;q.ATTRIBUTE_DATA_DD1=4;q.ATTRIBUTE_DATA_FILTER_FLAGS=0;q.ATTRIBUTE_DATA_GPGPU=2;q.ATTRIBUTE_DATA_VV=3;q.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;q.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};q.BITSET_FILL_RANDOM_PATTERN_OFFSET=4;q.BITSET_GENERIC_CONSIDER_ALPHA_ONLY=16;q.BITSET_GENERIC_LOCK_COLOR=2;q.BITSET_LINE_SCALE_DASH=4;q.BITSET_MARKER_ALIGNMENT_MAP=1;q.BITSET_MARKER_ALIGNMENT_SCREEN=0;q.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=
4;q.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=8;q.BITSET_TYPE_FILL_OUTLINE=1;q.BUFFER_DATA_MINIMUM_SIZE=128;q.BUFFER_DATA_POOL_SIZE=4;q.CHART_MAX_FIELDS=10;q.COLLISION_BOX_PADDING=16;q.COLLISION_BUCKET_SIZE=128;q.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;q.COLLISION_MAX_ZOOM_DELTA=1;q.COLLISION_PLACEMENT_PADDING=8;q.COLLISION_TILE_BOX_SIZE=4;q.DEBUG_LABELS=!1;q.DISPLAY_RECORD_INT_PER_ELEMENT=8;q.DOT_DENSITY_MAX_FIELDS=8;q.EFFECT_FLAG_0=4;q.ENABLE_EARLY_LABEL_DISCARD=!1;q.EXTRUDE_SCALE=64;q.FILTER_FLAG_0=
2;q.GLYPH_SIZE=24;q.HEURISTIC_GLYPHS_PER_FEATURE=10;q.HEURISTIC_GLYPHS_PER_LINE=50;q.HIGHLIGHT_FLAG=1;q.HITTEST_RADIUS=3;q.MAGIC_LABEL_LINE_HEIGHT=29;q.MAX_FILTERS=2;q.MAX_GPU_UPLOADS_PER_FRAME=2;q.MIN_MAX_ZOOM_PRECISION_FACTOR=10;q.NAN_MAGIC_NUMBER=1E-30;q.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;q.PATTERN_FILL_RASTERIZATION_SCALE=2;q.PICTURE_FILL_COLOR=4294967295;q.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE=1024;q.RASTER_TILE_SIZE=256;q.SPRITE_PADDING=2;q.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;q.TEXTURE_BINDING_ATTRIBUTE_DATA_1=
2;q.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;q.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;q.TEXTURE_BINDING_ATTRIBUTE_DATA_4=5;q.TEXTURE_BINDING_ATTRIBUTE_DATA_5=6;q.TEXTURE_BINDING_BITMAP=0;q.TEXTURE_BINDING_GLYPH_ATLAS=0;q.TEXTURE_BINDING_GPGPU=12;q.TEXTURE_BINDING_HIGHLIGHT_0=5;q.TEXTURE_BINDING_HIGHLIGHT_1=6;q.TEXTURE_BINDING_RENDERER_0=5;q.TEXTURE_BINDING_RENDERER_1=6;q.TEXTURE_BINDING_SPRITE_ATLAS=0;q.TEXTURE_UPLOAD_MANAGER_BUDGET=4;q.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE=128;q.TEXT_PLACEMENT_PADDING=8;q.THIN_LINE_HALF_WIDTH_THRESHOLD=
1.05;q.TILE_SIZE=512;q.VTL_HIGH_RES_CUTOFF=1.15;q.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;q.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;q.WEBGL_MAX_INNER_STOPS=6;q.WEBGL_MAX_STOPS=8;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),
function(q,t,E,C,A,y,m,l){return function(c){function a(){var d=c.apply(this,arguments)||this;d._color=E.fromValues(0,1,0,1);return d}q._inheritsLoose(a,c);var b=a.prototype;b.dispose=function(){this._program&&this._program.dispose()};b.prepareState=function({context:d}){d.setStencilTestEnabled(!0);d.setBlendingEnabled(!1);d.setFaceCullingEnabled(!1);d.setColorMask(!1,!1,!1,!1);d.setStencilOp(m.StencilOperation.KEEP,m.StencilOperation.KEEP,m.StencilOperation.REPLACE);d.setStencilWriteMask(255);d.setStencilFunction(m.CompareFunction.ALWAYS,
0,255)};b.draw=function(d,e){const {context:p,state:r,requestRender:v,allowDelayedRender:h}=d;d=C.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:m.DataType.SHORT}]});e=e.getVAO(p,r,d.attributes,d.bufferLayouts);t.isNone(e.indexBuffer)||(this._program||(this._program=l.createProgram(p,y.background)),h&&t.isSome(v)&&!this._program.isCompiled?v():(p.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),
this._program.setUniformMatrix3fv("u_dvsMat3",r.displayMat3),p.bindVAO(e),p.drawElements(m.PrimitiveType.TRIANGLES,e.indexBuffer.size,m.DataType.UNSIGNED_INT,0),p.bindVAO()))};return a}(A)})},"esri/chunks/vec4f32":function(){define(["exports"],function(q){function t(){return new Float32Array(4)}function E(u){const k=new Float32Array(4);k[0]=u[0];k[1]=u[1];k[2]=u[2];k[3]=u[3];return k}function C(u,k,g,f){const n=new Float32Array(4);n[0]=u;n[1]=k;n[2]=g;n[3]=f;return n}function A(u,k){return new Float32Array(u,
k,4)}function y(){return t()}function m(){return C(1,1,1,1)}function l(){return C(1,0,0,0)}function c(){return C(0,1,0,0)}function a(){return C(0,0,1,0)}function b(){return C(0,0,0,1)}const d=t(),e=m(),p=l(),r=c(),v=a(),h=b(),w=Object.freeze(Object.defineProperty({__proto__:null,create:t,clone:E,fromValues:C,createView:A,zeros:y,ones:m,unitX:l,unitY:c,unitZ:a,unitW:b,ZEROS:d,ONES:e,UNIT_X:p,UNIT_Y:r,UNIT_Z:v,UNIT_W:h},Symbol.toStringTag,{value:"Module"}));q.ONES=e;q.UNIT_W=h;q.UNIT_X=p;q.UNIT_Y=r;
q.UNIT_Z=v;q.ZEROS=d;q.clone=E;q.create=t;q.createView=A;q.fromValues=C;q.ones=m;q.unitW=b;q.unitX=l;q.unitY=c;q.unitZ=a;q.vec4f32=w;q.zeros=y})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,
d){function e(T){const ba={};for(const I of T)ba[I.name]=I.strideInBytes;return ba}function p(T){switch(T){case l.WGLGeometryType.MARKER:return U;case l.WGLGeometryType.FILL:return X;case l.WGLGeometryType.LINE:return Z;case l.WGLGeometryType.TEXT:return aa;case l.WGLGeometryType.LABEL:return da}}function r(T){switch(T%4){case 0:case 2:return 4;case 1:case 3:return 1}}function v(T){switch(T){case a.DataType.BYTE:case a.DataType.UNSIGNED_BYTE:return 1;case a.DataType.SHORT:case a.DataType.UNSIGNED_SHORT:return 2;
case a.DataType.FLOAT:case a.DataType.INT:case a.DataType.UNSIGNED_INT:return 4}}function h(T){const ba={};for(const I in T){let P=0;ba[I]=T[I].map(O=>{const V=new d.VertexElementDescriptor(O.name,O.count,O.type,P,0,O.normalized||!1);P+=O.count*v(O.type);return V});ba[I].forEach(O=>O.stride=P)}return ba}const w=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:36}];const u=[{name:"geometry",strideInBytes:12}],k=[{name:"geometry",strideInBytes:36}],g=[{name:"geometry",
strideInBytes:24}],f=[{name:"geometry",strideInBytes:12}],n=[{name:"geometry",strideInBytes:40}],z=[{name:"geometry",strideInBytes:36}],x=[{name:"geometry",strideInBytes:36}],B=e(E),D=e(u),F=e(k),G=e(g),H=e(f),J=e(n),L=e(z),K=e(x),U=["geometry"],X=["geometry"],Z=["geometry"],aa=["geometry"],da=["geometry"],R={geometry:a.Usage.STATIC_DRAW},M=new Map,Q=T=>T.startsWith("data:image/gif"),N=T=>T.startsWith("data:image/png"),S=T=>{if(!T)return!1;T=T.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(T)&&
/[\dz]$/i.test(T)&&4<T.length?!0:!1},W=T=>"fill"===T.type&&"CIMMarkerPlacementInsidePolygon"===T?.cim?.markerPlacement?.type;q.C_FILL_STRIDE_SPEC=F;q.C_FILL_STRIDE_SPEC_DD=H;q.C_FILL_STRIDE_SPEC_SIMPLE=G;q.C_FILL_VERTEX_DEF=k;q.C_FILL_VERTEX_DEF_DD=f;q.C_FILL_VERTEX_DEF_SIMPLE=g;q.C_HEATMAP_STRIDE_SPEC=D;q.C_HEATMAP_VERTEX_DEF=u;q.C_ICON_STRIDE_SPEC=B;q.C_ICON_VERTEX_DEF=E;q.C_LABEL_STRIDE_SPEC=K;q.C_LABEL_VERTEX_DEF=x;q.C_LINE_STRIDE_SPEC=J;q.C_LINE_VERTEX_DEF=n;q.C_TEXT_STRIDE_SPEC=L;q.C_TEXT_VERTEX_DEF=
z;q.C_VBO_GEOMETRY="geometry";q.C_VBO_INFO=R;q.C_VBO_PERINSTANCE="per_instance";q.C_VBO_PERINSTANCE_VV="per_instance_vv";q.allocateTypedArrayBuffer=function(T,ba){switch(ba%4){case 0:case 2:return new Uint32Array(Math.floor(T*ba/4));case 1:case 3:return new Uint8Array(T*ba)}};q.allocateTypedArrayBufferwithData=function(T,ba){switch(ba%4){case 0:case 2:return new Uint32Array(T);case 1:case 3:return new Uint8Array(T)}};q.charCodes=function(T){const ba=[];for(let I=0;I<T.length;I++)ba.push(T.charCodeAt(I));
return ba};q.copyMeshData=function(T,ba,I,P,O,V,Y){for(const fa in V){var ca=V[fa].stride,ea=r(ca);const ha=V[fa].data,ia=I[fa].data,la=ca*O.vertexCount/ea,ka=ca*T/ea;ca=ca*O.vertexFrom/ea;for(ea=0;ea<la;++ea)ia[ea+ka]=ha[ea+ca]}I=O.indexCount;for(V=0;V<I;++V)P[V+ba]=Y[V+O.indexFrom]-O.vertexFrom+T};q.createGeometryData=function(T,ba){const I=[];for(let P=0;5>P;++P){const O=p(P),V={};for(const Y of O)V[Y]={data:ba(P,Y)};I.push({data:T(P),buffers:V})}return I};q.createProgramDescriptor=(T,ba)=>{if(!M.has(T)){const O=
h(ba);var I=O;var P={};for(const V in I){const Y=I[V];P[V]=Y.length?Y[0].stride:0}I=P;P=new Map;for(const V in ba)for(const Y of ba[V])P.set(Y.name,Y.location);M.set(T,{strides:I,bufferLayouts:O,attributes:P})}return M.get(T)};q.createTextureFromTexelData=function(T,ba){let I,P;C.isPowerOfTwo(ba.width)&&C.isPowerOfTwo(ba.height)?(I=!0,P=a.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(I=!1,P=a.TextureSamplingMode.LINEAR);return new b.Texture(T,{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,
internalFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,hasMipmap:I,samplingMode:P,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},ba)};q.forEachGeometryType=function(T){T(l.WGLGeometryType.FILL);T(l.WGLGeometryType.LINE);T(l.WGLGeometryType.MARKER);T(l.WGLGeometryType.TEXT);T(l.WGLGeometryType.LABEL)};q.geometryToMappedGeometry=function(T){return{vertexFrom:void 0,vertexTo:void 0,geometry:T}};q.getBytes=v;q.getCapType=function(T){switch(T){case "butt":return y.CapType.BUTT;case "round":return y.CapType.ROUND;
case "square":return y.CapType.SQUARE;default:return w.error(new t("mapview-invalid-type",`Cap type ${T} is not a valid option. Defaulting to round`)),y.CapType.ROUND}};q.getJoinType=function(T){switch(T){case "miter":return y.JoinType.MITER;case "bevel":return y.JoinType.BEVEL;case "round":return y.JoinType.ROUND;default:return w.error(new t("mapview-invalid-type",`Join type ${T} is not a valid option. Defaulting to round`)),y.JoinType.ROUND}};q.getNamedBuffers=p;q.getPMSResourceSize=function(T){const ba=
"maxVVSize"in T&&T.maxVVSize;T="width"in T&&T.width||"size"in T&&T.size||0;return ba?ba:T};q.getPixelArrayCtor=function(T){switch(T){case a.PixelType.UNSIGNED_BYTE:return Uint8Array;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.PixelType.FLOAT:return Float32Array;default:w.error(new t("webgl-utils",`Unable to handle type ${T}`))}};q.getPixelBytes=function(T){switch(T){case a.PixelType.UNSIGNED_BYTE:return 1;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case a.PixelType.FLOAT:return 4;
default:w.error(new t("webgl-utils",`Unable to handle type ${T}`))}};q.getStrides=function(T,ba){switch(T){case l.WGLGeometryType.MARKER:switch(ba){case l.WGLSymbologyType.HEATMAP:return D;default:return B}case l.WGLGeometryType.FILL:switch(ba){case l.WGLSymbologyType.DOT_DENSITY:return H;case l.WGLSymbologyType.SIMPLE:case l.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return G;default:return F}case l.WGLGeometryType.LINE:return J;case l.WGLGeometryType.TEXT:return L;case l.WGLGeometryType.LABEL:return K}};
q.getTextProperties=function(T){return c.TextProperties.pool.acquire(T.color?m.copyAndPremultiply(T.color):[255,255,255,255],T.haloColor?m.copyAndPremultiply(T.haloColor):[255,255,255,255],A.pt2px(T.haloSize),A.pt2px(T.font.size),T.angle*Math.PI/180,T.xoffset/T.font.size,T.yoffset/T.font.size,"left"===T.horizontalAlignment?0:"right"===T.horizontalAlignment?1:.5,"top"===T.verticalAlignment?0:"bottom"===T.verticalAlignment?1:.5)};q.getTransformParams=function(T){const {transform:ba,hasZ:I,hasM:P}=T;
return{transform:ba,hasZ:I,hasM:P}};q.getUrl=T=>"imageData"in T&&T.imageData&&"contentType"in T&&T.contentType?`data:${T.contentType};base64,${T.imageData}`:"url"in T?T.url:null;q.getVVType=function(T){switch(T){case "opacity":return l.VVType.OPACITY;case "color":return l.VVType.COLOR;case "rotation":return l.VVType.ROTATION;case "size":return l.VVType.SIZE;default:return w.error(`Cannot interpret unknown vv: ${T}`),null}};q.is3D=T=>T.type&&T.type.toLowerCase().includes("3d");q.isDefined=function(T){return null!=
T};q.isGIF=T=>"url"in T&&T.url&&(T.url.includes(".gif")||Q(T.url))||"contentType"in T&&"image/gif"===T.contentType||"imageData"in T&&Q(T.imageData);q.isGIFDataUri=Q;q.isImageResource=T=>"url"in T&&T.url||"imageData"in T&&T.imageData;q.isMarkerPlacementInsidePolygon=W;q.isNumber=function(T){return"number"===typeof T};q.isPNG=T=>"url"in T&&T.url&&(T.url.includes(".png")||N(T.url))||"contentType"in T&&"image/png"===T.contentType||"imageData"in T&&N(T.imageData);q.isPNGDataUri=N;q.isSVGImage=T=>T.includes("data:image/svg+xml");
q.isSVGResource=T=>"path"in T&&S(T.path);q.isSimple=function(T){switch(T.type){case "line":return"CIMSolidStroke"===T.cim.type&&!T.dashTemplate;case "fill":return"CIMSolidFill"===T.cim.type;case "esriSFS":return"esriSFSSolid"===T.style||"esriSFSNull"===T.style;case "esriSLS":return"esriSLSSolid"===T.style||"esriSLSNull"===T.style;default:return!1}};q.isValidSVG=S;q.shouldRepeat=function(T){switch("cim"in T?T.cim.type:T.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return W(T);
default:return!0}};q.strideToPackingFactor=r;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/enums":function(){define(["exports"],function(q){q.CapType=void 0;(function(t){t[t.BUTT=0]="BUTT";t[t.ROUND=1]="ROUND";t[t.SQUARE=2]="SQUARE";t[t.UNKNOWN=4]="UNKNOWN"})(q.CapType||(q.CapType={}));q.JoinType=void 0;(function(t){t[t.BEVEL=0]="BEVEL";t[t.ROUND=1]="ROUND";t[t.MITER=2]="MITER";t[t.UNKNOWN=4]="UNKNOWN"})(q.JoinType||(q.JoinType={}));
q.Alignment=void 0;(function(t){t[t.SCREEN=0]="SCREEN";t[t.MAP=1]="MAP"})(q.Alignment||(q.Alignment={}));q.ExternalColorMixMode=void 0;(function(t){t[t.Tint=0]="Tint";t[t.Ignore=1]="Ignore";t[t.Multiply=99]="Multiply"})(q.ExternalColorMixMode||(q.ExternalColorMixMode={}));q.ExtremityPlacement=void 0;(function(t){t.Both="Both";t.JustBegin="JustBegin";t.JustEnd="JustEnd";t.None="None"})(q.ExtremityPlacement||(q.ExtremityPlacement={}));q.FillMode=void 0;(function(t){t[t.Mosaic=0]="Mosaic";t[t.Centered=
1]="Centered"})(q.FillMode||(q.FillMode={}));q.FontEffects=void 0;(function(t){t[t.Normal=0]="Normal";t[t.Superscript=1]="Superscript";t[t.Subscript=2]="Subscript"})(q.FontEffects||(q.FontEffects={}));q.FontEncoding=void 0;(function(t){t[t.MSSymbol=0]="MSSymbol";t[t.Unicode=1]="Unicode"})(q.FontEncoding||(q.FontEncoding={}));q.FontType=void 0;(function(t){t[t.Unspecified=0]="Unspecified";t[t.TrueType=1]="TrueType";t[t.PSOpenType=2]="PSOpenType";t[t.TTOpenType=3]="TTOpenType";t[t.Type1=4]="Type1"})(q.FontType||
(q.FontType={}));q.AngleAlignment=void 0;(function(t){t[t.Display=0]="Display";t[t.Map=1]="Map"})(q.AngleAlignment||(q.AngleAlignment={}));q.AnimatedSymbolRepeatType=void 0;(function(t){t.None="None";t.Loop="Loop";t.Oscillate="Oscillate"})(q.AnimatedSymbolRepeatType||(q.AnimatedSymbolRepeatType={}));q.DominantSizeAxis=void 0;(function(t){t[t.Z=0]="Z";t[t.X=1]="X";t[t.Y=2]="Y"})(q.DominantSizeAxis||(q.DominantSizeAxis={}));q.RotationOrder=void 0;(function(t){t[t.XYZ=0]="XYZ";t[t.ZXY=1]="ZXY";t[t.YXZ=
2]="YXZ"})(q.RotationOrder||(q.RotationOrder={}));q.BalloonCalloutStyle=void 0;(function(t){t[t.Rectangle=0]="Rectangle";t[t.RoundedRectangle=1]="RoundedRectangle";t[t.Oval=2]="Oval"})(q.BalloonCalloutStyle||(q.BalloonCalloutStyle={}));q.BlendingMode=void 0;(function(t){t[t.None=0]="None";t[t.Alpha=1]="Alpha";t[t.Screen=2]="Screen";t[t.Multiply=3]="Multiply";t[t.Add=4]="Add"})(q.BlendingMode||(q.BlendingMode={}));q.BlockProgression=void 0;(function(t){t[t.TTB=0]="TTB";t[t.RTL=1]="RTL";t[t.BTT=2]=
"BTT"})(q.BlockProgression||(q.BlockProgression={}));q.BillBoardMode=void 0;(function(t){t[t.None=0]="None";t[t.SignPost=1]="SignPost";t[t.FaceNearPlane=2]="FaceNearPlane"})(q.BillBoardMode||(q.BillBoardMode={}));q.CGAAttributeType=void 0;(function(t){t[t.Float=0]="Float";t[t.String=1]="String";t[t.Boolean=2]="Boolean"})(q.CGAAttributeType||(q.CGAAttributeType={}));q.ClippingType=void 0;(function(t){t[t.Intersect=0]="Intersect";t[t.Subtract=1]="Subtract"})(q.ClippingType||(q.ClippingType={}));q.GeometricEffectArrowType=
void 0;(function(t){t.OpenEnded="OpenEnded";t.Block="Block";t.Crossed="Crossed"})(q.GeometricEffectArrowType||(q.GeometricEffectArrowType={}));q.GeometricEffectControlMeasureLineRule=void 0;(function(t){t.FullGeometry="FullGeometry";t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment";t.ReversedFirstSegment="ReversedFirstSegment";t.PerpendicularToSecondSegment="PerpendicularToSecondSegment";t.SecondSegmentWithTicks="SecondSegmentWithTicks";t.DoublePerpendicular="DoublePerpendicular";t.OppositeToFirstSegment=
"OppositeToFirstSegment";t.TriplePerpendicular="TriplePerpendicular";t.HalfCircleFirstSegment="HalfCircleFirstSegment";t.HalfCircleSecondSegment="HalfCircleSecondSegment";t.HalfCircleExtended="HalfCircleExtended";t.OpenCircle="OpenCircle";t.CoverageEdgesWithTicks="CoverageEdgesWithTicks";t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks";t.GapExtentMidline="GapExtentMidline";t.Chevron="Chevron";t.PerpendicularWithArc="PerpendicularWithArc";t.ClosedHalfCircle="ClosedHalfCircle";t.TripleParallelExtended=
"TripleParallelExtended";t.ParallelWithTicks="ParallelWithTicks";t.Parallel="Parallel";t.PerpendicularToFirstSegment="PerpendicularToFirstSegment";t.ParallelOffset="ParallelOffset";t.OffsetOpposite="OffsetOpposite";t.OffsetSame="OffsetSame";t.CircleWithArc="CircleWithArc";t.DoubleJog="DoubleJog";t.PerpendicularOffset="PerpendicularOffset";t.LineExcludingLastSegment="LineExcludingLastSegment";t.MultivertexArrow="MultivertexArrow";t.CrossedArrow="CrossedArrow";t.ChevronArrow="ChevronArrow";t.ChevronArrowOffset=
"ChevronArrowOffset";t.PartialFirstSegment="PartialFirstSegment";t.Arch="Arch";t.CurvedParallelTicks="CurvedParallelTicks";t.Arc90Degrees="Arc90Degrees"})(q.GeometricEffectControlMeasureLineRule||(q.GeometricEffectControlMeasureLineRule={}));q.GeometricEffectDonutMethod=void 0;(function(t){t.Mitered="Mitered";t.Bevelled="Bevelled";t.Rounded="Rounded";t.Square="Square";t.TrueBuffer="TrueBuffer"})(q.GeometricEffectDonutMethod||(q.GeometricEffectDonutMethod={}));q.GeometricEffectEnclosingPolygonMethod=
void 0;(function(t){t.ClosePath="ClosePath";t.ConvexHull="ConvexHull";t.RectangularBox="RectangularBox"})(q.GeometricEffectEnclosingPolygonMethod||(q.GeometricEffectEnclosingPolygonMethod={}));q.GeometricEffectExtensionOrigin=void 0;(function(t){t.BeginningOfLine="BeginningOfLine";t.EndOfLine="EndOfLine"})(q.GeometricEffectExtensionOrigin||(q.GeometricEffectExtensionOrigin={}));q.GeometricEffectOffsetMethod=void 0;(function(t){t.Mitered="Mitered";t.Bevelled="Bevelled";t.Rounded="Rounded";t.Square=
"Square"})(q.GeometricEffectOffsetMethod||(q.GeometricEffectOffsetMethod={}));q.GeometricEffectOffsetOption=void 0;(function(t){t.Fast="Fast";t.Accurate="Accurate"})(q.GeometricEffectOffsetOption||(q.GeometricEffectOffsetOption={}));q.GeometricEffectOffsetTangentMethod=void 0;(function(t){t.BeginningOfLine="BeginningOfLine";t.EndOfLine="EndOfLine"})(q.GeometricEffectOffsetTangentMethod||(q.GeometricEffectOffsetTangentMethod={}));q.GeometricEffectWaveform=void 0;(function(t){t.Sinus="Sinus";t.Square=
"Square";t.Triangle="Triangle";t.Random="Random"})(q.GeometricEffectWaveform||(q.GeometricEffectWaveform={}));q.GlyphHinting=void 0;(function(t){t[t.None=0]="None";t[t.Default=1]="Default";t[t.Force=2]="Force"})(q.GlyphHinting||(q.GlyphHinting={}));q.GradientAlignment=void 0;(function(t){t[t.Buffered=0]="Buffered";t[t.Left=1]="Left";t[t.Right=2]="Right";t[t.AlongLine=3]="AlongLine"})(q.GradientAlignment||(q.GradientAlignment={}));q.GradientFillMethod=void 0;(function(t){t[t.Linear=0]="Linear";t[t.Rectangular=
1]="Rectangular";t[t.Circular=2]="Circular";t[t.Buffered=3]="Buffered"})(q.GradientFillMethod||(q.GradientFillMethod={}));q.GradientStrokeType=void 0;(function(t){t[t.Discrete=0]="Discrete";t[t.Continuous=1]="Continuous"})(q.GradientStrokeType||(q.GradientStrokeType={}));q.GradientStrokeMethod=void 0;(function(t){t[t.AcrossLine=0]="AcrossLine";t[t.AloneLine=1]="AloneLine"})(q.GradientStrokeMethod||(q.GradientStrokeMethod={}));q.HorizontalAlignment=void 0;(function(t){t[t.Left=0]="Left";t[t.Right=
1]="Right";t[t.Center=2]="Center";t[t.Justify=3]="Justify"})(q.HorizontalAlignment||(q.HorizontalAlignment={}));q.LeaderLineStyle=void 0;(function(t){t[t.Base=0]="Base";t[t.MidPoint=1]="MidPoint";t[t.ThreePoint=2]="ThreePoint";t[t.FourPoint=3]="FourPoint";t[t.Underline=4]="Underline";t[t.CircularCW=5]="CircularCW";t[t.CircularCCW=6]="CircularCCW"})(q.LeaderLineStyle||(q.LeaderLineStyle={}));q.LineCapStyle=void 0;(function(t){t.Butt="Butt";t.Round="Round";t.Square="Square"})(q.LineCapStyle||(q.LineCapStyle=
{}));q.LineDashEnding=void 0;(function(t){t.NoConstraint="NoConstraint";t.HalfPattern="HalfPattern";t.HalfGap="HalfGap";t.FullPattern="FullPattern";t.FullGap="FullGap";t.Custom="Custom"})(q.LineDashEnding||(q.LineDashEnding={}));q.LineDecorationStyle=void 0;(function(t){t[t.None=-1]="None";t[t.Custom=0]="Custom";t[t.Circle=1]="Circle";t[t.OpenArrow=2]="OpenArrow";t[t.ClosedArrow=3]="ClosedArrow";t[t.Diamond=4]="Diamond"})(q.LineDecorationStyle||(q.LineDecorationStyle={}));q.LineGapType=void 0;(function(t){t[t.ExtraLeading=
0]="ExtraLeading";t[t.Multiple=1]="Multiple";t[t.Exact=2]="Exact"})(q.LineGapType||(q.LineGapType={}));q.LineJoinStyle=void 0;(function(t){t.Bevel="Bevel";t.Round="Round";t.Miter="Miter"})(q.LineJoinStyle||(q.LineJoinStyle={}));q.ExpressionReturnType=void 0;(function(t){t[t.Default=0]="Default";t[t.String=1]="String";t[t.Numeric=2]="Numeric"})(q.ExpressionReturnType||(q.ExpressionReturnType={}));q.MarkerPlacementType=void 0;(function(t){t[t.InsidePolygon=0]="InsidePolygon";t[t.PolygonCenter=1]="PolygonCenter";
t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(q.MarkerPlacementType||(q.MarkerPlacementType={}));q.MaterialMode=void 0;(function(t){t[t.Tint=0]="Tint";t[t.Replace=1]="Replace";t[t.Multiply=2]="Multiply"})(q.MaterialMode||(q.MaterialMode={}));q.PlacementClip=void 0;(function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary";t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary";t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary";t[t.DoNotClip=3]="DoNotClip"})(q.PlacementClip||(q.PlacementClip=
{}));q.PlacementEndings=void 0;(function(t){t.NoConstraint="NoConstraint";t.WithMarkers="WithMarkers";t.WithFullGap="WithFullGap";t.WithHalfGap="WithHalfGap";t.Custom="Custom"})(q.PlacementEndings||(q.PlacementEndings={}));q.PlacementGridType=void 0;(function(t){t.Fixed="Fixed";t.Random="Random";t.RandomFixedQuantity="RandomFixedQuantity"})(q.PlacementGridType||(q.PlacementGridType={}));q.PlacementOnLineRelativeTo=void 0;(function(t){t.LineMiddle="LineMiddle";t.LineBeginning="LineBeginning";t.LineEnd=
"LineEnd";t.SegmentMidpoint="SegmentMidpoint"})(q.PlacementOnLineRelativeTo||(q.PlacementOnLineRelativeTo={}));q.PlacementPolygonCenterMethod=void 0;(function(t){t.OnPolygon="OnPolygon";t.CenterOfMass="CenterOfMass";t.BoundingBoxCenter="BoundingBoxCenter"})(q.PlacementPolygonCenterMethod||(q.PlacementPolygonCenterMethod={}));q.PlacementRandomlyAlongLineRandomization=void 0;(function(t){t[t.Low=0]="Low";t[t.Medium=1]="Medium";t[t.High=2]="High"})(q.PlacementRandomlyAlongLineRandomization||(q.PlacementRandomlyAlongLineRandomization=
{}));q.PlacementStepPosition=void 0;(function(t){t[t.MarkerCenter=0]="MarkerCenter";t[t.MarkerBounds=1]="MarkerBounds"})(q.PlacementStepPosition||(q.PlacementStepPosition={}));q.PointSymbolCalloutScale=void 0;(function(t){t[t.None=0]="None";t[t.PropUniform=1]="PropUniform";t[t.PropNonuniform=2]="PropNonuniform";t[t.DifUniform=3]="DifUniform";t[t.DifNonuniform=4]="DifNonuniform"})(q.PointSymbolCalloutScale||(q.PointSymbolCalloutScale={}));q.Simple3DLineStyle=void 0;(function(t){t.Tube="Tube";t.Strip=
"Strip";t.Wall="Wall"})(q.Simple3DLineStyle||(q.Simple3DLineStyle={}));q.SizeVariationMethod=void 0;(function(t){t[t.Random=0]="Random";t[t.Increasing=1]="Increasing";t[t.Decreasing=2]="Decreasing";t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(q.SizeVariationMethod||(q.SizeVariationMethod={}));q.SymbolUnits=void 0;(function(t){t[t.Relative=0]="Relative";t[t.Absolute=1]="Absolute"})(q.SymbolUnits||(q.SymbolUnits={}));q.TextCase=void 0;(function(t){t[t.Normal=0]="Normal";t[t.LowerCase=
1]="LowerCase";t[t.Allcaps=2]="Allcaps"})(q.TextCase||(q.TextCase={}));q.TextReadingDirection=void 0;(function(t){t[t.LTR=0]="LTR";t[t.RTL=1]="RTL"})(q.TextReadingDirection||(q.TextReadingDirection={}));q.TextureFilter=void 0;(function(t){t.Draft="Draft";t.Picture="Picture";t.Text="Text"})(q.TextureFilter||(q.TextureFilter={}));q.VerticalAlignment=void 0;(function(t){t[t.Top=0]="Top";t[t.Center=1]="Center";t[t.Baseline=2]="Baseline";t[t.Bottom=3]="Bottom"})(q.VerticalAlignment||(q.VerticalAlignment=
{}));q.VerticalGlyphOrientation=void 0;(function(t){t[t.Right=0]="Right";t[t.Upright=1]="Upright"})(q.VerticalGlyphOrientation||(q.VerticalGlyphOrientation={}));q.WaterbodySize=void 0;(function(t){t[t.Small=0]="Small";t[t.Medium=1]="Medium";t[t.Large=2]="Large"})(q.WaterbodySize||(q.WaterbodySize={}));q.WaveStrength=void 0;(function(t){t[t.Calm=0]="Calm";t[t.Rippled=1]="Rippled";t[t.Slight=2]="Slight";t[t.Moderate=3]="Moderate"})(q.WaveStrength||(q.WaveStrength={}));Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],function(q,t,E){function C(m,l){Array.isArray(l)?(m[0]=l[0],m[1]=l[1],m[2]=l[2],m[3]=l[3]):(m[0]=l.r,m[1]=l.g,m[2]=l.b,m[3]=l.a);return m}function A(m,l=0,c=!1){const a=m[l+3];m[l+0]*=a;m[l+1]*=a;m[l+2]*=a;c||(m[l+3]*=255);return m}const y=[0,0,0,0];q.copyAndPremultiply=function(m){return A(C([],m))};q.premultiplyAlpha=A;q.premultiplyAlphaRGBA=function(m){if(!m)return 0;
const {r:l,g:c,b:a,a:b}=m;return E.i8888to32(l*b,c*b,a*b,255*b)};q.premultiplyAlphaRGBAArray=function(m){if(!m)return 0;const [l,c,a,b]=m;return E.i8888to32(b/255*l,b/255*c,b/255*a,b)};q.premultiplyAlphaUint32=function(m){A(C(y,m));return E.i8888to32(y[0],y[1],y[2],y[3])};q.white=[255,255,255,1];q.writeColor=function(m,l,c=0){if(t.isNone(l))m[c+0]=0,m[c+1]=0,m[c+2]=0,m[c+3]=0;else{var {r:a,g:b,b:d,a:e}=l;m[c+0]=a*e/255;m[c+1]=b*e/255;m[c+2]=d*e/255;m[c+3]=e}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(q){function t(A,y,m){return Math.round(Math.max(Math.min(A,m),y))}const E=new Float32Array(1),C=new Uint32Array(E.buffer);q.i16=function(A){return t(A,-32768,32767)};q.i1616to32=function(A,y){return 65535&A|y<<16};q.i32=function(A){return t(A,-2147483648,2147483647)};q.i8=function(A){return t(A,-128,127)};q.i8816to32=function(A,y,m){return A&255|(y&255)<<8|m<<16};q.i8888to32=function(A,
y,m,l){return A&255|(y&255)<<8|(m&255)<<16|l<<24};q.numTo32=function(A){return A|0};q.toFloat32=function(A){C[0]=A;return E[0]};q.toUint32=function(A){E[0]=A;return C[0]};q.u16=function(A){return t(A,0,65535)};q.u32=function(A){return t(A,0,4294967295)};q.u32to4Xu8=function(A){return[A&255,(A&65280)>>>8,(A&16711680)>>>16,(A&4278190080)>>>24]};q.u4u4to8=function(A,y){return 15&A|(15&y)<<4};q.u8=function(A){return t(A,0,255)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(q,t){let E=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var A=C.prototype;A.acquire=function(y,m,l,c,a,b,d,e,p){this.color=y;this.haloColor=m;this.haloSize=l;this.size=c;this.angle=a;this.offsetX=b;this.offsetY=d;this.hAnchor=e;this.vAnchor=p};A.release=function(){this.color[0]=
this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return C}();E.pool=new t(E);q.TextProperties=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("background/background.vert"),
fragmentShader:t.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};q.background=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(q,t,E){const C=new E.ShaderCompiler(function(A){let y=t;A.split("/").forEach(m=>{y&&(y=y[m])});return y});q.resolveIncludes=function(A){return C.resolveIncludes(A)};
Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d clamp(vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(clamp(vividLight(Cb.r, Cs.r), 0.0, 1.0),\nclamp(vividLight(Cb.g, Cs.g), 0.0, 1.0),\nclamp(vividLight(Cb.b, Cs.b), 0.0, 1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d clamp(vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},debug:{overlay:{"overlay.frag":"precision mediump float;\nvarying vec4 v_color;\nvoid main(void) {\ngl_FragColor \x3d v_color;\n}","overlay.vert":"attribute vec3 a_PositionAndFlags;\nuniform mat3 u_dvsMat3;\nuniform vec4 u_colors[4];\nuniform float u_opacities[4];\nvarying vec4 v_color;\nvoid main(void) {\nvec2 position \x3d a_PositionAndFlags.xy;\nfloat flags \x3d a_PositionAndFlags.z;\nint colorIndex \x3d int(mod(flags, 4.0));\nvec4 color;\nfor (int i \x3d 0; i \x3c 4; i++) {\ncolor \x3d u_colors[i];\nif (i \x3d\x3d colorIndex) {\nbreak;\n}\n}\nint opacityIndex \x3d int(mod(floor(flags / 4.0), 4.0));\nfloat opacity;\nfor (int i \x3d 0; i \x3c 4; i++) {\nopacity \x3d u_opacities[i];\nif (i \x3d\x3d opacityIndex) {\nbreak;\n}\n}\nv_color \x3d color * opacity;\ngl_Position \x3d vec4((u_dvsMat3 * vec3(position, 1.0)).xy, 0.0, 1.0);\n}"}},
dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}","dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data \x3d texture2D(u_texture, v_uv);\nfloat density \x3d data.r * COMPRESSION_FACTOR;\ndensity *\x3d u_densityNormalization;\ndensity \x3d (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color \x3d texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}",
"heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nvarying vec2 v_uv;\nvoid main() {\nv_uv \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary \x3d abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 \x3d mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 \x3d v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG \x3d 180.0 / 3.141592654;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst float EPSILON_HITTEST \x3d 0.05;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY \x3d 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET \x3d 2;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nout_color \x3d v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\nconst float INV_SCALE_COMPRESSION_FACTOR \x3d 1.0 / 128.0;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nout_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d INV_SCALE_COMPRESSION_FACTOR * a_scale;\nfloat width \x3d u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nfloat dx \x3d 0.0;\nfloat dy \x3d 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) \x3e 0.5) {\nfloat id \x3d rgba2float(vec4(a_id, 0.0));\ndx \x3d rand(vec2(id, 0.0));\ndy \x3d rand(vec2(0.0, id));\n}\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly \x3d getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize \x3d 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  \x3d vec3(0.);\nhighp vec4 color  \x3d vec4(0.);\ndraw(color, pos);\nv_color \x3d color;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist \x3d u_hittestDist;\nfloat dist \x3d distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3c 0. || dist \x3e\x3d hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3d\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L \x3d p2 - p1;\nvec2 A \x3d p0 - p1;\nfloat projAL \x3d projectScalar(A, L);\nfloat t \x3d clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist \x3d distance(pos, vec3(u_hittestPos, 1.));\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) \x3e u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, (dist - size) \x3c 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba \x3d b - a;\nvec2 ca \x3d c - a;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_HITTEST \x26\x26 crossProduct \x3e -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) \x3d\x3d 1.) {\nreturn 0.;\n}\nfloat distAB \x3d distPointSegment(p, a, b);\nfloat distBC \x3d distPointSegment(p, b, c);\nfloat distCA \x3d distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},
icon:{"common.glsl":"#include \x3cutil/encoding.glsl\x3e\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",
heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor \x3d v_hittestResult;\n#else\nfloat radius \x3d length(v_offsetFromCenter);\nfloat shapeWeight \x3d step(radius, 1.0);\nfloat oneMinusRadiusSquared \x3d 1.0 - radius * radius;\nfloat kernelWeight \x3d oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor \x3d vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}",
"heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\nvoid main() {\nfloat filterFlags \x3d getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult \x3d vec4(0.);\nhighp vec3 out_pos \x3d vec3(0.);\nvec3 pos \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult \x3d out_hittestResult;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter \x3d sign(a_vertexOffset);\nv_fieldValue \x3d getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nvec3 vertexPos \x3d centerPos + u_displayViewMat3 * vec3(v_offsetFromCenter, 0.0) * u_radius;\ngl_Position \x3d vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase \x3d u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 \x3d scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 \x3d scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 \x3d xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 \x3d xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 \x3d xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 \x3d a_texCoords  / u_mosaicSize;\nvec2 tex1 \x3d a_texCoords1 / u_mosaicSize;\nvec2 tex2 \x3d a_texCoords2 / u_mosaicSize;\nfloat alphaSum \x3d 0.;\nalphaSum +\x3d inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z +\x3d step(alphaSum, .05) * 2.0;\nout_color \x3d vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvoid main()\n{\n#ifdef HITTEST\nvec4 color \x3d v_color;\n#else\nvec4 color \x3d getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f \x3d getSize(size.y) / size.y;\nfloat sizeFactor \x3d size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec3  pos           \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        \x3d vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize \x3d a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally \x3d getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               \x3d getMarkerScaleFactor(size, referenceSize);\nsize.xy     *\x3d scaleFactor;\noffset.xy   *\x3d scaleFactor;\noutlineSize *\x3d scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   \x3d a_texCoords / u_mosaicSize;\nfloat filterFlags \x3d getFilterFlags();\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_pos      \x3d u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  \x3d vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color \x3d vec4(0.);\nhighp vec3 out_pos   \x3d vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color \x3d out_color;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist \x3d min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3e\x3d u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3c\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d v_color;\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
pie:{"pie.frag":"precision mediump float;\n#include \x3cutil/atan2.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ \x3d\x3d 300\nmediump int colorIndex \x3d int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d index) {\ncolorIndex \x3d int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID \x3d 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle \x3d 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle \x3c 0.0) {\nangle +\x3d 360.0;\n} else if (angle \x3e 360.0) {\nangle \x3d mod(angle, 360.0);\n}\nint numOfEntries \x3d int(v_numOfEntries);\nfloat maxSectorAngle \x3d v_maxSectorAngle;\nlowp vec4 fillColor \x3d (maxSectorAngle \x3e 0.0 || u_sectorThreshold \x3e 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor \x3d vec4(0.0);\nlowp vec4 nextColor \x3d vec4(0.0);\nfloat startSectorAngle \x3d 0.0;\nfloat endSectorAngle \x3d 0.0;\nif (angle \x3c maxSectorAngle) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle \x3d endSectorAngle;\nendSectorAngle \x3d v_filteredSectorToColorId[index].x;\nif (endSectorAngle \x3e angle) {\nfillColor \x3d getSectorColor(index, v_filteredSectorToColorId);\nprevColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 index \x3d\x3d 0 \x26\x26 abs(360.0 - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3e 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 abs(endSectorAngle - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3c numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index \x3d\x3d numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor \x3d getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle \x3d maxSectorAngle;\nendSectorAngle \x3d 360.0;\n}\nlowp vec4 outlineColor \x3d u_outlineColor;\nfloat offset \x3d length(v_offset);\nfloat distanceSize \x3d offset * v_size;\nif (startSectorAngle !\x3d 0.0 || endSectorAngle !\x3d 360.0) {\nfloat distanceToStartSector \x3d (angle - startSectorAngle);\nfloat distanceToEndSector \x3d (endSectorAngle - angle);\nfloat sectorThreshold \x3d 0.6;\nfloat beginSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize \x3d u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut \x3d donutSize - v_outlineWidth;\nfloat aaThreshold \x3d 0.75;\nfloat innerCircleAlpha \x3d endOfDonut - aaThreshold \x3e 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha \x3d 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha \x3d innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline \x3d v_size - v_outlineWidth;\nif (startOfOutline \x3e 0.0 \x26\x26 v_outlineWidth \x3e 0.25) {\nfloat outlineFactor \x3d smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor \x3d donutSize - aaThreshold \x3e 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor \x3d mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle \x3e u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle +\x3d sectorAngle;\n#if __VERSION__ \x3d\x3d 300\nfilteredSectorToColorId[filteredInfo.colorId] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; i++) {\nif (i \x3d\x3d filteredInfo.colorId) {\nfilteredSectorToColorId[i] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue \x3d sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value !\x3d NAN_MAGIC_NUMBER \x26\x26 value \x3e 0.0 ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat outlineSize \x3d u_outlineWidth;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 size \x3d getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags \x3d getFilterFlags();\nvec3  pos         \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      \x3d getOpacity();\nv_id           \x3d norm(a_id);\nv_pos          \x3d u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       \x3d sign(a_texCoords - 0.5);\nv_size         \x3d max(size.x, size.y);\nv_outlineWidth \x3d outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 \x3d getAttributeData3(a_id);\nattributeData[0] \x3d filterNaNValues(attributeData0.x);\nattributeData[1] \x3d filterNaNValues(attributeData0.y);\nattributeData[2] \x3d filterNaNValues(attributeData0.z);\nattributeData[3] \x3d filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS \x3e 4)\nvec4 attributeData1 \x3d getAttributeData4(a_id);\nattributeData[4] \x3d filterNaNValues(attributeData1.x);\nattributeData[5] \x3d filterNaNValues(attributeData1.y);\nattributeData[6] \x3d filterNaNValues(attributeData1.z);\nattributeData[7] \x3d filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS \x3e 8)\nvec4 attributeData2 \x3d getAttributeData5(a_id);\nattributeData[8] \x3d filterNaNValues(attributeData2.x);\nattributeData[9] \x3d filterNaNValues(attributeData2.y);\n#endif\nfloat sum \x3d 0.0;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsum +\x3d attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] \x3d 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo \x3d FilteredChartInfo(0.0, 0);\nint numOfEntries \x3d filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries \x3d float(numOfEntries);\nv_maxSectorAngle \x3d filteredInfo.endSectorAngle;\n#if __VERSION__ \x3d\x3d 300\nv_filteredSectorToColorId \x3d filteredSectorToColorId;\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] \x3d filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos \x3d vec3(0.0);\nv_color            \x3d vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize \x3d 1.0;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};",
"line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternHeight \x3d line.patternSize.y * 2.0 * lineHalfWidth / line.patternSize.x;\nmediump float relativeTexY \x3d fract(line.accumulatedDistance / adjustedPatternHeight);\nmediump float relativeTexX \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nv_sampleAlphaOnly \x3d getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a \x3d 12.9898;\nhighp float b \x3d 78.233;\nhighp float c \x3d 43758.5453;\nhighp float dt \x3d dot(co, vec2(a,b));\nhighp float sn \x3d mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/barycentric.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_texture, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_perspective;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv \x3d a_uv;\nfloat w \x3d 1.0 + dot(a_uv, u_perspective);\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position \x3d vec4(w * pos.xy, 0.0, w);\n}"}},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\nvec4 color \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\ngl_FragColor \x3d clamp(color, 0.0, 1.0);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\ngl_FragColor \x3d vec4(color.rgb * u_opacity, color.a * u_opacity);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff \x3d mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart \x3d clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist \x3e featheringStart) {\ncolor *\x3d 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",
imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled \x3d texture2D(u_texture, v_texcoord);\nfloat intensity \x3d getIntensity(sampled.r);\ngl_FragColor \x3d getColor(intensity);\ngl_FragColor.a *\x3d getOpacity(sampled.r);\ngl_FragColor.a *\x3d sampled.a;\ngl_FragColor.rgb *\x3d gl_FragColor.a;\n}",
"imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy \x3d (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\nvoid main(void) {\ngl_FragColor \x3d getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}",
"particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/vv.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nvec2 position0 \x3d a_xyts0.xy;\nfloat t0 \x3d a_xyts0.z;\nfloat speed0 \x3d a_xyts0.w;\nvec2 position1 \x3d a_xyts1.xy;\nfloat t1 \x3d a_xyts1.z;\nfloat speed1 \x3d a_xyts1.w;\nfloat type \x3d a_typeIdDurationSeed.x;\nfloat id \x3d a_typeIdDurationSeed.y;\nfloat duration \x3d a_typeIdDurationSeed.z;\nfloat seed \x3d a_typeIdDurationSeed.w;\nvec2 e0 \x3d a_extrudeInfo.xy;\nvec2 e1 \x3d a_extrudeInfo.zw;\nfloat animationPeriod \x3d duration + u_trailLength;\nfloat scaledTime \x3d u_time * u_flowSpeed;\nfloat randomizedTime \x3d scaledTime + seed * animationPeriod;\nfloat t \x3d mod(randomizedTime, animationPeriod);\nfloat fUnclamped \x3d (t - t0) / (t1 - t0);\nfloat f \x3d clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime \x3d mix(t0, t1, f);\nfloat speed \x3d mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type \x3d\x3d 2.0) {\nif (fUnclamped \x3c 0.0 || (fUnclamped \x3e 1.0 \x26\x26 t1 !\x3d duration)) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho \x3d mix(e0, e1, f);\nvec2 parallel;\nparallel \x3d normalize(position1 - position0) * 0.5;\nif (id \x3d\x3d 1.0) {\nextrude \x3d ortho;\nv_texcoord \x3d vec2(0.5, 0.0);\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -ortho;\nv_texcoord \x3d vec2(0.5, 1.0);\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d ortho + parallel;\nv_texcoord \x3d vec2(1.0, 0.0);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -ortho + parallel;\nv_texcoord \x3d vec2(1.0, 1.0);\n}\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else {\nif (fUnclamped \x3c 0.0) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id \x3d\x3d 1.0) {\nextrude \x3d e0;\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -e0;\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n}\n}\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_color.a *\x3d fadeOpacity;\nv_color.a *\x3d mix(1.0, introOpacity, u_introFade);\nv_color.rgb *\x3d v_color.a;\n}"},
streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color \x3d v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *\x3d mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor \x3d getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}",
"streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nvoid main(void) {\nvec4 lineColor \x3d getColor(a_speed);\nfloat lineOpacity \x3d getOpacity(a_speed);\nfloat lineSize \x3d getSize(a_speed);\nvec2 position \x3d a_positionAndSide.xy;\nv_side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_color \x3d lineColor;\nv_color.a *\x3d lineOpacity;\nv_color.rgb *\x3d v_color.a;\nv_size \x3d lineSize;\n}"},
"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color \x3d u_color_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_color_count) {\nbreak;\n}\nfloat x1 \x3d u_color_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_color_stops[i];\nvec4 y2 \x3d u_color_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_color_values[i - 1];\ncolor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor \x3d y2;\n}\n}\n}\n#else\nvec4 color \x3d u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity \x3d u_opacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_opacity_count) {\nbreak;\n}\nfloat x1 \x3d u_opacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_opacity_stops[i];\nfloat y2 \x3d u_opacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_opacity_values[i - 1];\nopacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity \x3d y2;\n}\n}\n}\n#else\nfloat opacity \x3d u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size \x3d u_size_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_size_count) {\nbreak;\n}\nfloat x1 \x3d u_size_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_size_stops[i];\nfloat y2 \x3d u_size_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_size_values[i - 1];\nsize \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize \x3d y2;\n}\n}\n}\n#else\nfloat size \x3d u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position \x3d vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 \x3d abs(x);\nt1 \x3d abs(y);\nt0 \x3d max(t3, t1);\nt1 \x3d min(t3, t1);\nt3 \x3d 1.0 / t0;\nt3 \x3d t1 * t3;\nt4 \x3d t3 * t3;\nt0 \x3d         - 0.013480470;\nt0 \x3d t0 * t4 + 0.057477314;\nt0 \x3d t0 * t4 - 0.121239071;\nt0 \x3d t0 * t4 + 0.195635925;\nt0 \x3d t0 * t4 - 0.332994597;\nt0 \x3d t0 * t4 + 0.999995630;\nt3 \x3d t0 * t3;\nt3 \x3d (abs(y) \x3e abs(x)) ? 1.570796327 - t3 : t3;\nt3 \x3d x \x3c 0.0 ?  3.141592654 - t3 : t3;\nt3 \x3d y \x3c 0.0 ? -t3 : t3;\nreturn t3;\n}",
"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/BrushOverlay":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../Utils ./WGLBrush ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y){return function(m){function l(){var a=
m.apply(this,arguments)||this;a._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])};return a}q._inheritsLoose(l,m);var c=l.prototype;c.dispose=function(){};c.prepareState=function({context:a}){a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(y.CompareFunction.GREATER,
255,255)};c.draw=function(a,b){const {context:d,painter:e,requestRender:p,allowDelayedRender:r}=a;if(b.isReady){var {computedOpacity:v,dvsMat3:h,isWrapAround:w,perspectiveTransform:u,texture:k}=b;a.timeline.begin(this.name);var g=e.materialManager.getProgram(this._desc);if(r&&t.isSome(p)&&!g.isCompiled)p();else{var f=C.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:y.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:y.DataType.UNSIGNED_SHORT}]});if(b=b.getVAO(d,
f.bufferLayouts,f.attributes))d.bindVAO(b),d.useProgram(g),d.bindTexture(k,E.TEXTURE_BINDING_BITMAP),g.setUniformMatrix3fv("u_dvsMat3",h),g.setUniform1i("u_texture",E.TEXTURE_BINDING_BITMAP),g.setUniform1f("u_opacity",v),g.setUniform2fv("u_perspective",u),d.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,w?10:4),d.bindVAO(),a.timeline.end(this.name)}}};return l}(A)})},"esri/views/2d/engine/webgl/brushes/WGLBrushDotDensity":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ./WGLGeometryBrushFill ../techniques/utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){return function(p){function r(){var h=p.apply(this,arguments)||this;h._dotTextureSize=0;h._dotTextures=null;h._dotSamplers=new Int32Array([C.TEXTURE_BINDING_RENDERER_0,C.TEXTURE_BINDING_RENDERER_1]);h._dotVAO=null;h._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return h}q._inheritsLoose(r,p);var v=r.prototype;v.dispose=function(){p.prototype.dispose.call(this);this._disposeTextures();this._dotFBO=t.disposeMaybe(this._dotFBO);this._dotVAO=
t.disposeMaybe(this._dotVAO)};v.getGeometryType=function(){return A.WGLGeometryType.FILL};v.supportsSymbology=function(h){return h===A.WGLSymbologyType.DOT_DENSITY};v._drawFills=function(h,w,u,k,g,f){const {passOptions:n}=h;t.isSome(n)&&"hittest"===n.type?p.prototype._drawFills.call(this,h,w,u,k,g,f):(u=this._drawDotLocations(h,w,u,g,f),this._drawDotDensity(h,w,u))};v._drawDotDensity=function(h,w,u){const {context:k,painter:g,rendererInfo:f,requestRender:n,allowDelayedRender:z}=h,x=g.materialManager.getProgram(this._dotDesc);
if(z&&t.isSome(n)&&!x.isCompiled)n();else{var {rendererSchema:B}=f;m.assertRendererSchema(B,"dot-density");var D=this._createDotDensityMesh(k,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:c.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});k.setStencilTestEnabled(!0);k.useProgram(x);x.setUniform1f("u_tileZoomFactor",1);x.setUniform1i("u_texture",this._dotSamplers[0]);x.setUniform1f("u_dotSize",Math.max(B.dotSize,1));x.setUniform1f("u_pixelRatio",window.devicePixelRatio);
this._setSharedUniforms(x,h,w);k.bindTexture(u,this._dotSamplers[0]);k.bindVAO(D);k.drawArrays(c.PrimitiveType.POINTS,0,262144)}};v._drawDotLocations=function(h,w,u,k,g){const {context:f,rendererInfo:n,requiredLevel:z}=h,x=f.getViewport();var {rendererSchema:B}=n;m.assertRendererSchema(B,"dot-density");const {dotScale:D,colors:F,activeDots:G,backgroundColor:H,dotValue:J}=B;f.setViewport(0,0,512,512);B=f.getBoundFramebufferObject();const L=this._createFBO(f);f.bindFramebuffer(L);f.setClearColor(0,
0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT|f.gl.STENCIL_BUFFER_BIT);f.setStencilTestEnabled(!1);w=1/2**(z-w.key.level);const K=C.TILE_SIZE,U=K*window.devicePixelRatio*K*window.devicePixelRatio,X=1/w*(1/w);h=D?h.state.scale/D:1;u.setUniform1f("u_tileZoomFactor",w);u.setUniform1f("u_tileDotsOverArea",U/(C.TILE_SIZE*window.devicePixelRatio*C.TILE_SIZE*window.devicePixelRatio));u.setUniformMatrix4fv("u_dotColors",F);u.setUniform4fv("u_isActive",G);u.setUniform4fv("u_dotBackgroundColor",H);u.setUniform1f("u_dotValue",
Math.max(1,J*h*X));this._bindDotDensityTextures(f,u,n,K);f.drawElements(c.PrimitiveType.TRIANGLES,k,c.DataType.UNSIGNED_INT,g);f.setViewport(x.x,x.y,x.width,x.height);f.bindFramebuffer(B);return L.colorTexture};v._createFBO=function(h){if(t.isNone(this._dotFBO)){const w={target:c.TextureType.TEXTURE_2D,pixelFormat:c.PixelFormat.RGBA,dataType:c.PixelType.UNSIGNED_BYTE,samplingMode:c.TextureSamplingMode.NEAREST,wrapMode:c.TextureWrapMode.CLAMP_TO_EDGE,width:512,height:512},u={colorTarget:c.TargetType.TEXTURE,
depthStencilTarget:c.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},k=new b.Renderbuffer(h,{width:512,height:512,internalFormat:c.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new a.FramebufferObject(h,u,w,k)}return this._dotFBO};v._disposeTextures=function(){if(this._dotTextures){for(let h=0;h<this._dotTextures.length;h++)this._dotTextures[h].dispose();this._dotTextures=null}};v._bindDotDensityTextures=function(h,w,u,k){({rendererSchema:u}=u);m.assertRendererSchema(u,"dot-density");k=this._createDotDensityTextures(h,
k,u.seed);w.setUniform1iv("u_dotTextures",this._dotSamplers);for(w=0;w<k.length;w++)h.bindTexture(k[w],this._dotSamplers[w])};v._createDotDensityMesh=function(h,w,u){if(t.isNone(this._dotVAO)){var k=new Int16Array(524288);for(let g=0;512>g;g++)for(let f=0;512>f;f++)k[2*(f+512*g)]=f,k[2*(f+512*g)+1]=g;k=l.BufferObject.createVertex(h,c.Usage.STATIC_DRAW,k);this._dotVAO=new e.VertexArrayObject(h,w,u,{geometry:k},null)}return this._dotVAO};v._createDotDensityTextures=function(h,w,u){if(this._dotTextureSize!==
w||this._seed!==u)this._disposeTextures(),this._dotTextureSize=w,this._seed=u;null===this._dotTextures&&(u=new E(u),this._dotTextures=[this._allocDotDensityTexture(h,w,u),this._allocDotDensityTexture(h,w,u)]);return this._dotTextures};v._allocDotDensityTexture=function(h,w,u){const k=new Float32Array(w*w*4);for(let g=0;g<k.length;g++)k[g]=u.getFloat();return new d.Texture(h,{wrapMode:c.TextureWrapMode.REPEAT,pixelFormat:c.PixelFormat.RGBA,dataType:c.PixelType.FLOAT,samplingMode:c.TextureSamplingMode.NEAREST,
width:w,height:w},k)};return r}(y)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y,m,l){return function(c){function a(){return c.apply(this,arguments)||this}q._inheritsLoose(a,c);var b=a.prototype;b.dispose=function(){};b.getGeometryType=function(){return E.WGLGeometryType.FILL};
b.supportsSymbology=function(d){return d!==E.WGLSymbologyType.DOT_DENSITY};b.drawGeometry=function(d,e,p,r){const {context:v,painter:h,rendererInfo:w,requiredLevel:u,passOptions:k,requestRender:g,allowDelayedRender:f}=d;var n=y.FillMaterialKey.load(p.materialKey),z=m.getTechniqueFromMaterialKey(n.data);const x=t.isSome(k)&&"hittest"===k.type;var B=h.materialManager,D=t.unwrapOr;z=z.programSpec;const F={geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_id",count:3,
type:l.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:l.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:l.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:l.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:l.DataType.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]};switch(n.symbologyType){case E.WGLSymbologyType.SIMPLE:case E.WGLSymbologyType.OUTLINE_FILL_SIMPLE:F.geometry.splice(7,
1),F.geometry.splice(4,1)}const {shader:G,vertexLayout:H,hittestAttributes:J}=D.call(t,z,{shader:"materials/fill",vertexLayout:F});D=l.PrimitiveType.TRIANGLES;z=C.createProgramDescriptor(n.data,H);x&&(z=this._getTriangleDesc(p.materialKey,z,J),D=l.PrimitiveType.POINTS);const {attributes:L,bufferLayouts:K}=z;r=B.getMaterialProgram(d,n,G,L,r);f&&t.isSome(g)&&!r.isCompiled?g():(v.useProgram(r),this._setSharedUniforms(r,d,e),r.setUniform2f("u_tileOffset",512*e.key.col,512*e.key.row),n.textureBinding&&
(h.textureManager.bindTextures(v,r,n),r.setUniform1f("u_zoomFactor",1/2**(u-e.key.level))),B=1/d.pixelRatio,r.setUniform1f("u_blur",B),r.setUniform1f("u_antialiasing",B),this._setSizeVVUniforms(n,r,w,e),this._setColorAndOpacityVVUniforms(n,r,w),n=p.target.getVAO(v,K,L,x),B=p.indexCount,p=p.indexFrom*Uint32Array.BYTES_PER_ELEMENT,x&&(B/=3,p/=3),v.bindVAO(n),this._drawFills(d,e,r,D,B,p))};b._drawFills=function(d,e,p,r,v,h){d.context.drawElements(r,v,l.DataType.UNSIGNED_INT,h)};return a}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./WGLBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y){return function(m){function l(){var a=m.apply(this,arguments)||this;a._computeDesc=new Map;return a}q._inheritsLoose(l,m);var c=l.prototype;c.prepareState=function({context:a},b){b&&b.includes("hittest")?a.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE,y.BlendFactor.ONE,y.BlendFactor.ONE):a.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setBlendingEnabled(!0);a.setColorMask(!0,
!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0)};c.draw=function(a,b,d){var e=this.getGeometryType();b.commit(a);e=b.getGeometry(e);t.isNone(e)||(a.timeline.begin(this.name),a.attributeView.bindTextures(a.context),a.context.setStencilFunction(y.CompareFunction.EQUAL,b.stencilRef,255),e.forEachCommand(p=>{const r=A.MaterialKeyBase.load(p.materialKey).symbologyType;this.supportsSymbology(r)&&this.drawGeometry(a,b,p,d)}))};c._setSharedUniforms=function(a,b,d){const {displayLevel:e,pixelRatio:p,
state:r,passOptions:v}=b;t.isSome(v)&&"hittest"===v.type&&(a.setUniform2fv("u_hittestPos",v.position),a.setUniform1f("u_hittestDist",v.distance));a.setUniform1f("u_pixelRatio",p);a.setUniformMatrix3fv("u_tileMat3",d.transforms.tileMat3);a.setUniformMatrix3fv("u_viewMat3",r.viewMat3);a.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",r.displayViewMat3);a.setUniform1f("u_currentZoom",Math.round(e*E.MIN_MAX_ZOOM_PRECISION_FACTOR));a.setUniform1i("u_attributeTextureSize",
b.attributeView.size);a.setUniform1i("u_attributeData0",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",E.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.setUniform1i("u_attributeData3",E.TEXTURE_BINDING_ATTRIBUTE_DATA_3);a.setUniform1i("u_attributeData4",E.TEXTURE_BINDING_ATTRIBUTE_DATA_4);a.setUniform1i("u_attributeData5",E.TEXTURE_BINDING_ATTRIBUTE_DATA_5)};c._setSizeVVUniforms=function(a,b,d,e){a.vvSizeMinMaxValue&&
b.setUniform4fv("u_vvSizeMinMaxValue",d.vvSizeMinMaxValue);a.vvSizeScaleStops&&b.setUniform1f("u_vvSizeScaleStopsValue",d.vvSizeScaleStopsValue);a.vvSizeFieldStops&&(e=d.getSizeVVFieldStops(e.key.level),b.setUniform1fv("u_vvSizeFieldStopsValues",e.values),b.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes));a.vvSizeUnitValue&&b.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",d.vvSizeUnitValueToPixelsRatio)};c._setColorAndOpacityVVUniforms=function(a,b,d){a.vvColor&&(b.setUniform1fv("u_vvColorValues",
d.vvColorValues),b.setUniform4fv("u_vvColors",d.vvColors));a.vvOpacity&&(b.setUniform1fv("u_vvOpacityValues",d.vvOpacityValues),b.setUniform1fv("u_vvOpacities",d.vvOpacities))};c._setRotationVVUniforms=function(a,b,d){a.vvRotation&&b.setUniform1f("u_vvRotationType","geographic"===d.vvMaterialParameters.vvRotationType?0:1)};c._getTriangleDesc=function(a,b,d=["a_pos"]){const e=b.bufferLayouts.geometry;d=d.map(v=>e.findIndex(h=>h.name===v));a=`${a}-${d.join("-")}`;var p=this._computeDesc.get(a);if(!p){p=
b.strides;const v=b.strides.geometry,h=new Map(b.attributes);var r=e.map(u=>({...u}));b=Math.max(...b.attributes.values());r={geometry:r};let w=0;for(const u of d)d=e[u],r.geometry.push({count:d.count,name:d.name+"1",divisor:d.divisor,normalized:d.normalized,offset:v+d.offset,stride:v,type:d.type}),r.geometry.push({count:d.count,name:d.name+"2",divisor:d.divisor,normalized:d.normalized,offset:2*v+d.offset,stride:v,type:d.type}),h.set(d.name+"1",b+ ++w),h.set(d.name+"2",b+ ++w);p={bufferLayouts:r,
attributes:h,strides:p};this._computeDesc.set(a,p)}return p};return l}(C)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(q,t,E,C,A){function y(u){return u===A.WGLSymbologyType.SIMPLE||u===A.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function m(u){return u===A.WGLSymbologyType.OUTLINE_FILL||u===A.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const l=Object.keys(A.WGLSymbologyType).filter(u=>
"number"===typeof A.WGLSymbologyType[u]).reduce((u,k)=>({...u,[k]:A.WGLSymbologyType[k]}),{});let c=function(){function u(g){this._data=0;this._data=g}u.load=function(g){const f=this.shared;f.data=g;return f};var k=u.prototype;k.setBit=function(g,f){g=1<<g;this._data=f?this._data|g:this._data&~g};k.bit=function(g){return(this._data&1<<g)>>g};k.setBits=function(g,f,n){for(let z=f,x=0;z<n;z++,x++)this.setBit(z,0!==(g&1<<x))};k.bits=function(g,f){let n=0;for(let z=g,x=0;z<f;z++,x++)n|=this.bit(z)<<x;
return n};k.hasVV=function(){return!1};k.setVV=function(g,f){};k.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:A.WGLSymbologyType[this.symbologyType],options:l,namespace:"SYMBOLOGY_TYPE"}}};k.getVariationHash=function(){return this._data&~(7&this.textureBinding)};t._createClass(u,[{key:"data",get:function(){return this._data},set:function(g){this._data=g}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(g){this.setBits(g,
8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(g){this.setBit(20,g)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(g){this.setBit(11,g)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(g){this.setBit(12,g)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(g){this.setBits(g,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(g){this.setBits(g,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case A.WGLGeometryType.FILL:return"fill";
case A.WGLGeometryType.MARKER:return"marker";case A.WGLGeometryType.LINE:return"line";case A.WGLGeometryType.TEXT:return"text";case A.WGLGeometryType.LABEL:return"label";default:throw new E(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return u}();c.shared=new c(0);const a=u=>function(k){function g(){return k.apply(this,arguments)||this}t._inheritsLoose(g,k);var f=g.prototype;f.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||
this.vvSizeFieldStops||this.vvSizeUnitValue};f.setVV=function(n,z){k.prototype.setVV.call(this,n,z);{var x=this.geometryType;const B=A.WGLVVFlag.SIZE_FIELD_STOPS|A.WGLVVFlag.SIZE_MINMAX_VALUE|A.WGLVVFlag.SIZE_SCALE_STOPS|A.WGLVVFlag.SIZE_UNIT_VALUE,D=(n&(A.WGLVVTarget.FIELD_TARGETS_OUTLINE|A.WGLVVTarget.MINMAX_TARGETS_OUTLINE|A.WGLVVTarget.SCALE_TARGETS_OUTLINE|A.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;z=x===A.WGLGeometryType.LINE&&z.isOutline||x===A.WGLGeometryType.FILL&&m(z.symbologyType)?B&D:B&
~D}n&=z;this.vvSizeMinMaxValue=!!(n&A.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(n&A.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(n&A.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(n&A.WGLVVFlag.SIZE_SCALE_STOPS)};t._createClass(g,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(n){this.setBit(16,n)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(n){this.setBit(17,n)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(n){this.setBit(18,n)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(n){this.setBit(19,n)}}]);return g}(u),b=u=>function(k){function g(){return k.apply(this,arguments)||this}t._inheritsLoose(g,k);var f=g.prototype;f.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvRotation};f.setVV=function(n,z){k.prototype.setVV.call(this,n,z);this.vvRotation=!z.isOutline&&!!(n&A.WGLVVFlag.ROTATION)};t._createClass(g,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(n){this.setBit(15,n)}}]);return g}(u),d=u=>function(k){function g(){return k.apply(this,arguments)||this}t._inheritsLoose(g,k);var f=g.prototype;f.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvColor};f.setVV=function(n,z){k.prototype.setVV.call(this,n,z);this.vvColor=!z.isOutline&&!!(n&A.WGLVVFlag.COLOR)};t._createClass(g,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(n){this.setBit(13,n)}}]);return g}(u),e=u=>function(k){function g(){return k.apply(this,
arguments)||this}t._inheritsLoose(g,k);var f=g.prototype;f.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvOpacity};f.setVV=function(n,z){k.prototype.setVV.call(this,n,z);this.vvOpacity=!z.isOutline&&!!(n&A.WGLVVFlag.OPACITY)};t._createClass(g,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(n){this.setBit(14,n)}}]);return g}(u);let p=function(u){function k(){return u.apply(this,arguments)||this}t._inheritsLoose(k,u);k.load=function(g){const f=this.shared;f.data=
g;return f};k.from=function(g){const {symbologyType:f,vvFlags:n}=g,z=this.load(0);z.geometryType=A.WGLGeometryType.FILL;z.symbologyType=f;f!==A.WGLSymbologyType.DOT_DENSITY&&z.setVV(n,g);return z.data};k.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(d(e(a(c))));
p.shared=new p(0);let r=function(u){function k(){return u.apply(this,arguments)||this}t._inheritsLoose(k,u);k.load=function(g){const f=this.shared;f.data=g;return f};k.from=function(g){const {symbologyType:f,vvFlags:n}=g,z=this.load(0);z.geometryType=A.WGLGeometryType.MARKER;z.symbologyType=f;f!==A.WGLSymbologyType.HEATMAP&&z.setVV(n,g);return z.data};k.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(d(e(b(a(c)))));r.shared=new r(0);let v=function(u){function k(){return u.apply(this,arguments)||this}t._inheritsLoose(k,u);k.load=function(g){const f=this.shared;f.data=g;return f};k.from=function(g){const f=this.load(0);f.geometryType=A.WGLGeometryType.LINE;f.symbologyType=g.symbologyType;f.setVV(g.vvFlags,g);return f.data};k.prototype.getVariation=
function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(d(e(a(c))));v.shared=new v(0);let h=function(u){function k(){return u.apply(this,arguments)||this}t._inheritsLoose(k,u);k.load=function(g){const f=this.shared;f.data=g;return f};k.from=function(g){const f=this.load(0);f.geometryType=
A.WGLGeometryType.TEXT;f.symbologyType=g.symbologyType;f.setVV(g.vvFlags,g);return f.data};k.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(d(e(b(a(c)))));h.shared=new h(0);let w=function(u){function k(){return u.apply(this,arguments)||
this}t._inheritsLoose(k,u);k.load=function(g){const f=this.shared;f.data=g;return f};k.from=function(g){const f=this.load(0);f.geometryType=A.WGLGeometryType.LABEL;f.symbologyType=g.symbologyType;f.setVV(g.vvFlags,g);f.mapAligned=C.isMapAligned(g.placement);return f.data};k.prototype.getVariation=function(){return{...u.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return k}(a(c));w.shared=new w(0);q.FillMaterialKey=p;q.LabelMaterialKey=w;q.LineMaterialKey=v;q.MarkerMaterialKey=r;q.MaterialKeyBase=c;q.TextMaterialKey=h;q.createMaterialKey=function(u,k){switch(u){case A.WGLGeometryType.FILL:return p.from(k);case A.WGLGeometryType.LINE:return v.from(k);case A.WGLGeometryType.MARKER:return r.from(k);case A.WGLGeometryType.TEXT:return h.from(k);case A.WGLGeometryType.LABEL:return w.from(k);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${u}`);
}};q.hasOutlineFillSymbology=function(u){return m(u.symbologyType)};q.hasSimpleSymbology=function(u){return y(u.symbologyType)};q.hydrateMaterialKey=function(u){switch(c.load(u).geometryType){case A.WGLGeometryType.MARKER:return new r(u);case A.WGLGeometryType.FILL:return new p(u);case A.WGLGeometryType.LINE:return new v(u);case A.WGLGeometryType.TEXT:return new h(u);case A.WGLGeometryType.LABEL:return new w(u)}};q.isOutlineFillSymbology=m;q.isSimpleSymbology=y;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(q){q.HAlign=void 0;(function(t){t[t.Left=-1]="Left";t[t.Center=0]="Center";t[t.Right=1]="Right"})(q.HAlign||(q.HAlign={}));q.VAlign=void 0;(function(t){t[t.Top=1]="Top";t[t.Center=0]="Center";t[t.Bottom=-1]="Bottom";t[t.Baseline=2]="Baseline"})(q.VAlign||(q.VAlign={}));q.getAlignmentFromPlacement=function(t){switch(t){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[q.HAlign.Right,
q.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[q.HAlign.Center,q.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[q.HAlign.Left,q.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[q.HAlign.Right,q.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[q.HAlign.Center,
q.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[q.HAlign.Left,q.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[q.HAlign.Right,q.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[q.HAlign.Center,q.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[q.HAlign.Left,q.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[q.HAlign.Center,
q.VAlign.Center];default:return console.debug(`Found invalid placement type ${t}`),[q.HAlign.Center,q.VAlign.Center]}};q.getJustification=function(t){switch(t){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXAnchorDirection=function(t){switch(t){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXDirection=function(t){switch(t){case q.HAlign.Right:return-1;case q.HAlign.Center:return 0;
case q.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}};q.getYAnchorDirection=function(t){switch(t){case "top":return q.VAlign.Top;case "middle":return q.VAlign.Center;case "baseline":return q.VAlign.Baseline;case "bottom":return q.VAlign.Bottom}};q.getYDirection=function(t){switch(t){case q.VAlign.Top:return 1;case q.VAlign.Center:return 0;case q.VAlign.Bottom:case q.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),
0}};q.isMapAligned=function(t){switch(t){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/utils":function(){define("exports ../../../../../core/Error ../enums ../materialKey/MaterialKey ./Technique ./dotDensity/TechniqueDotDensity ./heatmap/TechniqueHeatmap ./pieChart/TechniquePieChart".split(" "),
function(q,t,E,C,A,y,m,l){q.assertRendererSchema=function(c,a){if(c.type!==a)throw new t("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${a}" but found type "${c.type}"`);};q.getTechniqueFromMaterialKey=function(c){const {geometryType:a,symbologyType:b}=C.MaterialKeyBase.load(c);switch(a){case E.WGLGeometryType.FILL:switch(b){case E.WGLSymbologyType.DOT_DENSITY:return y.DotDensityTechnique}break;case E.WGLGeometryType.MARKER:switch(b){case E.WGLSymbologyType.HEATMAP:return m.HeatmapTechnique;
case E.WGLSymbologyType.PIE_CHART:return l.PieChartTechnique}}return A.Technique};q.getTechniqueFromRenderer=function(c){switch(c?.type){case "dot-density":return y.DotDensityTechnique;case "heatmap":return m.HeatmapTechnique;case "pie-chart":return l.PieChartTechnique;default:return A.Technique}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/Technique":function(){define(["exports","../../../../../core/maybe"],function(q,
t){let E=function(){function C(){}C.getStorageSpec=function(A){return null};C.createOrUpdateRendererSchema=function(A,y){return t.isSome(A)&&"default"===A.type?A:{type:"default"}};C.getVariation=function(A){return{}};C.getVariationHash=function(A){return 0};return C}();E.type="default";E.programSpec=null;q.Technique=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m){y=function(l){function c(){return l.apply(this,arguments)||this}t._inheritsLoose(c,l);c.getStorageSpec=function({attributes:a}){return{visualVariables:!1,attributes:a??null}};c._createRendererSchema=function(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}};c.createOrUpdateRendererSchema=function(a,b){const {attributes:d,dotValue:e,referenceScale:p,
dotSize:r,dotBlendingEnabled:v,seed:h,backgroundColor:w}=b;a=E.isSome(a)&&"dot-density"===a.type?a:this._createRendererSchema();a.dotValue=e;a.dotSize=r;a.dotScale=p;a.dotBlending=v;a.seed=h;const {colors:u,activeDots:k,backgroundColor:g}=a;for(var f=0;f<A.DOT_DENSITY_MAX_FIELDS;f++)C.writeColor(u,f>=d.length?null:d[f].color,4*f);for(f=0;8>f;f++)k[f]=f<b.attributes.length?1:0;C.writeColor(g,w);return a};c.getVariation=function(a){return{ddDotBlending:a.dotBlending}};c.getVariationHash=function(a){return a.dotBlending?
1:0};return c}(y.Technique);y.type="dot-density";y.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:m.DataType.SHORT},{location:1,name:"a_id",count:3,type:m.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:m.DataType.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:m.DataType.FLOAT}]}};q.DotDensityTechnique=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../renderers/support/heatmapUtils ../Technique ../../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m){y=function(l){function c(){return l.apply(this,arguments)||this}t._inheritsLoose(c,l);c.getStorageSpec=function({field:a,valueExpression:b}){return{visualVariables:!1,attributes:a||b?[{field:a,valueExpression:b}]:null}};c._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}};c.createOrUpdateRendererSchema=function(a,b){const {radius:d,minDensity:e,maxDensity:p,
referenceScale:r,field:v,valueExpression:h,colorStops:w}=b;b=p-e;const u=v||h?1:0,k=w.map(({color:n,ratio:z})=>`${z}:${n.toString()}`).join();let g=!0,f;E.isSome(a)&&"heatmap"===a.type?(f=a,g=k!==a.gradientHash):f=this._createRendererSchema();f.radius=C.pt2px(d);f.minDensity=e;f.densityRange=b;f.referenceScale=r;f.isFieldActive=u;g&&(f.gradient=A.generateGradient(w),f.gradientHash=k);return f};return c}(y.Technique);y.type="heatmap";y.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,
name:"a_pos",count:2,type:m.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:m.DataType.SHORT},{location:4,name:"a_id",count:4,type:m.DataType.UNSIGNED_BYTE}]}};q.HeatmapTechnique=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../Color ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c){l=function(a){function b(){return a.apply(this,arguments)||this}t._inheritsLoose(b,a);b.getStorageSpec=function({attributes:d}){return{visualVariables:!0,attributes:d??null}};b._createRendererSchema=function(){return{type:"pie-chart",colors:new Float32Array(4*m.CHART_MAX_FIELDS),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}};b.createOrUpdateRendererSchema=
function(d,e){const {attributes:p,defaultColor:r,holePercentage:v,othersCategory:h,outline:w}=e;d=C.isSome(d)&&"pie-chart"===d.type?d:this._createRendererSchema();for(e=0;e<m.CHART_MAX_FIELDS;e++){const u=e>=p.length?new E([0,0,0,0]):p[e].color;y.writeColor(d.colors,u,4*e)}y.writeColor(d.defaultColor,r);y.writeColor(d.othersColor,h?.color);y.writeColor(d.outlineColor,w?.color);d.outlineWidth=A.pt2px(w?.width||0);d.holePercentage=v;d.sectorThreshold=h?.threshold||0;d.numberOfFields=p.length;return d};
b.getVariation=function(d){return{numberOfFields:d.numberOfFields}};b.getVariationHash=function(d){return d.numberOfFields};return b}(l.Technique);l.type="pie-chart";l.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:c.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:c.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:c.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:c.DataType.UNSIGNED_SHORT},{location:4,
name:"a_id",count:4,type:c.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:c.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:c.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:c.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:c.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};q.PieChartTechnique=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/brushes/WGLBrushHeatmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ./WGLGeometryBrushMarker ../effects/Effect ../techniques/utils ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/heatmapTextureUtils ../../../../webgl/Renderbuffer ../../../../webgl/Texture".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,d,e,p){const r=
t.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap");t=function(w){function u(){var g=w.apply(this,arguments)||this;g.brushEffect=new h;return g}q._inheritsLoose(u,w);var k=u.prototype;k.supportsSymbology=function(g){return g===C.WGLSymbologyType.HEATMAP};k.dispose=function(){w.prototype.dispose.call(this);this.brushEffect.dispose();this.brushEffect=null};k.prepareState=function(){};k.drawGeometry=function(g,f,n,z){const {defines:x}=this.brushEffect.loadQualityProfile(g.context);w.prototype.drawGeometry.call(this,
g,f,n,z?[...z,...x]:x)};k._drawMarkers=function(g,f,n,z,x,B,D){const {context:F,rendererInfo:G,state:H}=g;({rendererSchema:g}=G);l.assertRendererSchema(g,"heatmap");const {referenceScale:J,radius:L,isFieldActive:K}=g;n.setUniform1f("u_radius",L*(0!==J?J/H.scale:1));D||(n.setUniform1f("u_isFieldActive",K),F.setStencilFunction(a.CompareFunction.GEQUAL,f.stencilRef,255));F.drawElements(z,x,a.DataType.UNSIGNED_INT,B)};return u}(y);const v={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",
attributes:new Map([["a_position",0]])};let h=function(w){function u(){var g=w.apply(this,arguments)||this;g.name=g.constructor.name;return g}q._inheritsLoose(u,w);var k=u.prototype;k.createOptions=function({passOptions:g}){return g};k.dispose=function(){this._prevFBO=null;this._accumulateOutputTexture=E.disposeMaybe(this._accumulateOutputTexture);E.isSome(this._accumulateFramebuffer)&&this._accumulateFramebuffer.detachDepthStencilBuffer();this._accumulateOutputStencilBuffer=E.disposeMaybe(this._accumulateOutputStencilBuffer);
this._accumulateFramebuffer=E.disposeMaybe(this._accumulateFramebuffer);this._resolveGradientTexture=E.disposeMaybe(this._resolveGradientTexture);this._tileQuad=E.disposeMaybe(this._tileQuad)};k.bind=function(g){const {context:f,rendererInfo:n,passOptions:z}=g,{rendererSchema:x}=n;E.isSome(z)&&"hittest"===z.type||"heatmap"!==x.type||(this._prevFBO=f.getBoundFramebufferObject(),this._prevViewport=f.getViewport(),l.assertRendererSchema(x,"heatmap"),this._loadResources(g),this._updateResources(f,x),
f.bindFramebuffer(this._accumulateFramebuffer),f.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),f.setStencilTestEnabled(!0),f.setBlendingEnabled(!0),f.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE),f.setClearColor(0,0,0,0),f.clear(a.ClearBufferBit.COLOR_BUFFER_BIT))};k.unbind=function(){this._prevViewport=this._prevFBO=null};k.draw=function(g){const {context:f,painter:n,rendererInfo:z,passOptions:x}=g;({rendererSchema:g}=z);if(!(E.isSome(x)&&"hittest"===
x.type||"heatmap"!==g.type)){var {defines:B}=this.loadQualityProfile(f);B=n.materialManager.getProgram(v,B);f.useProgram(B);f.bindFramebuffer(this._prevFBO);f.setViewport(0,0,this._prevViewport.width,this._prevViewport.height);f.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setStencilTestEnabled(!1);var {radius:D,minDensity:F,densityRange:G}=g;f.bindTexture(this._accumulateOutputTexture,8);f.bindTexture(this._resolveGradientTexture,9);B.setUniform1i("u_texture",8);B.setUniform1i("u_gradient",
9);B.setUniform2f("u_densityMinAndInvRange",F,1/G);B.setUniform1f("u_densityNormalization",3/(D*D*Math.PI));this._tileQuad.draw()}};k._loadResources=function({context:g,painter:f}){const {dataType:n,samplingMode:z,pixelFormat:x,internalFormat:B,shadingRate:D,requiresSharedStencilBuffer:F}=this.loadQualityProfile(g),{width:G,height:H}=this._prevViewport,J=G*D,L=H*D;this._accumulateOutputTexture??(this._accumulateOutputTexture=new p.Texture(g,{target:a.TextureType.TEXTURE_2D,pixelFormat:x,internalFormat:B,
dataType:n,samplingMode:z,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,width:J,height:L}));F||(this._accumulateOutputStencilBuffer??(this._accumulateOutputStencilBuffer=new e.Renderbuffer(g,{width:J,height:L,internalFormat:a.RenderbufferFormat.DEPTH_STENCIL})));this._accumulateFramebuffer??(this._accumulateFramebuffer=new b.FramebufferObject(g,{},this._accumulateOutputTexture,F?f.getSharedStencilBuffer():this._accumulateOutputStencilBuffer));this._resolveGradientTexture??(this._resolveGradientTexture=
new p.Texture(g,{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,samplingMode:a.TextureSamplingMode.LINEAR,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE}));this._tileQuad??(this._tileQuad=new A(g,[0,0,1,0,0,1,1,1]))};k._updateResources=function(g,f){const {gradientHash:n,gradient:z}=f;this._prevGradientHash!==n&&(this._resolveGradientTexture.resize(z.length/4,1),this._resolveGradientTexture.setData(z),this._prevGradientHash=n);const {shadingRate:x,requiresSharedStencilBuffer:B}=
this.loadQualityProfile(g),{width:D,height:F}=this._prevViewport;f=D*x;const G=F*x,{width:H,height:J}=this._accumulateFramebuffer;if(H!==f||J!==G){const L=this._accumulateFramebuffer.depthStencilAttachment;if(B&&E.isSome(L)){const {width:K,height:U}=L.descriptor;if(K!==f||U!==G)r.errorOnce("Attempted to resize shared stencil buffer! Detaching instead."),this._accumulateFramebuffer.detachDepthStencilBuffer()}this._accumulateFramebuffer.resize(f,G)}B||g.blitFramebuffer(this._prevFBO,this._accumulateFramebuffer,
0,0,this._prevFBO.width,this._prevFBO.height,0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height,a.ClearBufferBit.STENCIL_BUFFER_BIT,a.TextureSamplingMode.NEAREST)};k.loadQualityProfile=function(g){if(E.isNone(this._qualityProfile)){const f=d.loadHeatmapTextureConfiguration(g,r);g=g.type===c.ContextType.WEBGL1;this._qualityProfile={...f,requiresSharedStencilBuffer:g,shadingRate:g?1:.25,defines:f.dataType!==a.PixelType.FLOAT?["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile};
return u}(m.Effect);return t})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y,m,l){const c={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.DataType.SHORT},
{location:2,name:"a_texCoords",count:2,type:l.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.DataType.UNSIGNED_SHORT}]},
hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(a){function b(){return a.apply(this,arguments)||this}q._inheritsLoose(b,a);var d=b.prototype;d.dispose=function(){};d.getGeometryType=function(){return E.WGLGeometryType.MARKER};d.supportsSymbology=function(e){return e!==E.WGLSymbologyType.HEATMAP&&e!==E.WGLSymbologyType.PIE_CHART};d.drawGeometry=function(e,p,r,v){const {context:h,painter:w,rendererInfo:u,state:k,passOptions:g,requestRender:f,allowDelayedRender:n}=e;var z=y.MarkerMaterialKey.load(r.materialKey),
x=m.getTechniqueFromMaterialKey(z.data);const B=t.isSome(g)&&"hittest"===g.type,{shader:D,vertexLayout:F,hittestAttributes:G}=t.unwrapOr(x.programSpec,c);x=l.PrimitiveType.TRIANGLES;var H=C.createProgramDescriptor(z.data,F);B&&(H=this._getTriangleDesc(r.materialKey,H,G),x=l.PrimitiveType.POINTS);const {attributes:J,bufferLayouts:L}=H;v=w.materialManager.getMaterialProgram(e,z,D,J,v);n&&t.isSome(f)&&!v.isCompiled?f():(h.useProgram(v),z.textureBinding&&w.textureManager.bindTextures(h,v,z,!0),this._setSharedUniforms(v,
e,p),v.setUniformMatrix3fv("u_displayMat3",z.vvRotation?k.displayViewMat3:k.displayMat3),this._setSizeVVUniforms(z,v,u,p),this._setColorAndOpacityVVUniforms(z,v,u),this._setRotationVVUniforms(z,v,u),z=r.target.getVAO(h,L,J,B),H=r.indexCount,r=r.indexFrom*Uint32Array.BYTES_PER_ELEMENT,B&&(H/=3,r/=3),h.bindVAO(z),this._drawMarkers(e,p,v,x,H,r,B),h.bindVAO(null))};d._drawMarkers=function(e,p,r,v,h,w,u){e.context.drawElements(v,h,l.DataType.UNSIGNED_INT,w)};return b}(A)})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],
function(q){let t=function(){function E(){this.name=this.constructor.name}E.prototype.createOptions=function(C,A){return null};return E}();q.Effect=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/heatmapTextureUtils":function(){define(["exports","../../core/Error","../../core/maybe","./enums"],function(q,t,E,C){q.loadHeatmapTextureConfiguration=function(A,y){const {textureFloat:m,colorBufferFloat:l}=A.capabilities,c=m?.textureFloat,a=
m?.textureFloatLinear;var b=m?.textureHalfFloat;const d=m?.textureHalfFloatLinear,e=m?.HALF_FLOAT,p=l?.textureFloat;var r=l?.textureHalfFloat;const v=l?.floatBlend;({floatBufferBlendWorking:A}=E.unwrapOrThrow(A.driverTest));if(!c&&!b)throw new t("heatmap:missing-texture-float","HeatmapRenderer requires WebGL2 or the WebGL1 extension OES_texture_float or OES_texture_half_float.");if(!p&&!r)throw new t("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");
if(!(v&&A||r))throw new t("heatmap:missing-float-blend",`HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float.${A?"":" This device claims support for EXT_float_blend, but does not actually support it."}`);b=b&&r;r=!!l?.R32F;const h=!!l?.R16F;if(c&&p&&v&&A&&(a||!d))return a||y.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),{dataType:C.PixelType.FLOAT,samplingMode:a?C.TextureSamplingMode.LINEAR:C.TextureSamplingMode.NEAREST,
pixelFormat:r?C.PixelFormat.RED:C.PixelFormat.RGBA,internalFormat:r?C.SizedPixelFormat.R32F:C.PixelFormat.RGBA};if(b)return d||y.warnOnce("Missing WebGL extension OES_texture_half_float_linear. Heatmap quality may be reduced."),{dataType:e,samplingMode:d?C.TextureSamplingMode.LINEAR:C.TextureSamplingMode.NEAREST,pixelFormat:h?C.PixelFormat.RED:C.PixelFormat.RGBA,internalFormat:h?C.SizedPixelFormat.R16F:C.PixelFormat.RGBA};throw new t("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.");
};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){return function(e){function p(){var v=e.apply(this,arguments)||this;v._color=E.fromValues(1,0,0,1);return v}q._inheritsLoose(p,e);var r=p.prototype;r.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};r.prepareState=function({context:v}){v.setBlendingEnabled(!0);v.setBlendFunctionSeparate(c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA,c.BlendFactor.ONE,c.BlendFactor.ONE_MINUS_SRC_ALPHA);v.setColorMask(!0,!0,!0,!0);v.setStencilWriteMask(0);v.setStencilTestEnabled(!1)};r.draw=function(v,h){const {context:w,requestRender:u,allowDelayedRender:k}=v;if(h.isReady)if(this._loadWGLResources(w),!k||!t.isSome(u)||
this._outlineProgram.isCompiled&&this._tileInfoProgram.isCompiled){w.bindVAO(this._outlineVertexArrayObject);w.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",h.rangeX,h.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);w.drawArrays(c.PrimitiveType.LINE_STRIP,0,4);if(v=this._getTexture(w,h))w.bindVAO(this._tileInfoVertexArrayObject),
w.useProgram(this._tileInfoProgram),w.bindTexture(v,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",h.rangeX/h.width,h.rangeY/h.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",v.descriptor.width,v.descriptor.height),w.drawArrays(c.PrimitiveType.TRIANGLE_STRIP,0,4);w.bindVAO()}else u()};r._loadWGLResources=function(v){if(!this._outlineProgram||
!this._tileInfoProgram){var h=a.createProgram(v,y.background),w=a.createProgram(v,m.tileInfo),u=new Int8Array([0,0,1,0,1,1,0,1]);u=l.BufferObject.createVertex(v,c.Usage.STATIC_DRAW,u);u=new d.VertexArrayObject(v,y.background.attributes,C.Pos2b,{geometry:u});var k=new Int8Array([0,0,1,0,0,1,1,1]);k=l.BufferObject.createVertex(v,c.Usage.STATIC_DRAW,k);v=new d.VertexArrayObject(v,m.tileInfo.attributes,C.Pos2b,{geometry:k});this._outlineProgram=h;this._tileInfoProgram=w;this._outlineVertexArrayObject=
u;this._tileInfoVertexArrayObject=v}};r._getTexture=function(v,h){if(h.texture&&h.triangleCountReportedInDebug===h.triangleCount)return h.texture;h.triangleCountReportedInDebug=h.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const w=h.triangleCount;let u=h.key.id;0<h.triangleCount&&(u+=`, ${w}`);
const k=this._canvas,g=k.getContext("2d");g.font="24px sans-serif";g.textAlign="left";g.textBaseline="top";g.clearRect(0,0,300,32);1E5<w?(g.fillStyle="red",g.fillRect(0,0,300,32),g.fillStyle="black"):(g.clearRect(0,0,300,32),g.fillStyle="blue");g.fillText(u,0,0);h.texture=new b.Texture(v,{target:c.TextureType.TEXTURE_2D,pixelFormat:c.PixelFormat.RGBA,dataType:c.PixelType.UNSIGNED_BYTE,samplingMode:c.TextureSamplingMode.NEAREST,wrapMode:c.TextureWrapMode.CLAMP_TO_EDGE},k);return h.texture};return p}(A)})},
"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports","../../../webgl/enums","../../../webgl/VertexElementDescriptor"],function(q,t,E){const C={geometry:[new E.VertexElementDescriptor("a_pos",2,t.DataType.BYTE,0,2)]},A={geometry:[new E.VertexElementDescriptor("a_pos",2,t.DataType.BYTE,0,4),new E.VertexElementDescriptor("a_tex",2,t.DataType.BYTE,2,4)]};t={geometry:[new E.VertexElementDescriptor("a_pos",2,t.DataType.UNSIGNED_SHORT,0,4)]};q.Pos2b=C;q.Pos2us=t;q.PosTex2b=
A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:t.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};q.tileInfo=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushPieChart":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","./WGLGeometryBrushMarker","../techniques/utils","../../../../webgl/enums"],function(q,t,E,C,A){return function(y){function m(){return y.apply(this,arguments)||this}q._inheritsLoose(m,y);var l=m.prototype;l.supportsSymbology=function(c){return c===t.WGLSymbologyType.PIE_CHART};l._drawMarkers=function(c,a,b,d,e,p,r){({context:a}=c);({rendererInfo:c}=c);({rendererSchema:c}=c);C.assertRendererSchema(c,"pie-chart");b.setUniform4fv("u_colors",c.colors);b.setUniform4fv("u_defaultColor",c.defaultColor);
b.setUniform4fv("u_othersColor",c.othersColor);b.setUniform4fv("u_outlineColor",c.outlineColor);b.setUniform1f("u_donutRatio",c.holePercentage);b.setUniform1f("u_sectorThreshold",c.sectorThreshold);b.setUniform1f("u_outlineWidth",c.outlineWidth);a.drawElements(d,e,A.DataType.UNSIGNED_INT,p)};return m}(E)})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l,c,a){return function(b){function d(){var p=b.apply(this,arguments)||this;p._color=E.fromValues(1,0,0,1);p._initialized=!1;return p}q._inheritsLoose(d,b);var e=d.prototype;e.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};e.prepareState=function({context:p}){p.setDepthWriteEnabled(!1);p.setDepthTestEnabled(!1);p.setStencilTestEnabled(!0);
p.setBlendingEnabled(!1);p.setColorMask(!1,!1,!1,!1);p.setStencilOp(l.StencilOperation.KEEP,l.StencilOperation.KEEP,l.StencilOperation.REPLACE);p.setStencilWriteMask(255)};e.draw=function(p,r){const {context:v,requestRender:h,allowDelayedRender:w}=p;this._initialized||this._initialize(v);w&&t.isSome(h)&&!this._solidProgram.isCompiled?h():(v.setStencilFunctionSeparate(l.Face.FRONT_AND_BACK,l.CompareFunction.GREATER,r.stencilRef,255),v.bindVAO(this._solidVertexArrayObject),v.useProgram(this._solidProgram),
this._solidProgram.setUniformMatrix3fv("u_dvsMat3",r.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[r.rangeX,r.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),v.drawArrays(l.PrimitiveType.TRIANGLE_STRIP,0,4),v.bindVAO())};e._initialize=function(p){if(this._initialized)return!0;const r=c.createProgram(p,y.background);if(!r)return!1;var v=new Int8Array([0,0,1,0,0,1,1,1]);v=m.BufferObject.createVertex(p,l.Usage.STATIC_DRAW,
v);p=new a.VertexArrayObject(p,y.background.attributes,C.Pos2b,{geometry:v});this._solidProgram=r;this._solidVertexArrayObject=p;return this._initialized=!0};return d}(A)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){a=function(p){function r(){var h=p.apply(this,arguments)||this;h._color=y.fromValues(1,0,0,1);h._patternMatrix=A.create();h._programOptions={id:!1,pattern:!1};return h}t._inheritsLoose(r,p);var v=r.prototype;v.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};v.drawMany=function(h,w){const {context:u,painter:k,styleLayerUID:g,requestRender:f,allowDelayedRender:n}=h;this._loadWGLResources(h);const z=h.displayLevel;var x=h.styleLayer,B=x.backgroundMaterial;
const D=k.vectorTilesMaterialManager;var F=x.getPaintValue("background-color",z);const G=x.getPaintValue("background-opacity",z),H=x.getPaintValue("background-pattern",z),J=void 0!==H,L=F[3]*G,K=h.spriteMosaic;let U,X;const Z=(window.devicePixelRatio|1)>m.VTL_HIGH_RES_CUTOFF?2:1;h=h.drawPhase===l.WGLDrawPhase.HITTEST;const aa=this._programOptions;aa.id=h;aa.pattern=J;B=D.getMaterialProgram(u,B,aa);if(n&&C.isSome(f)&&!B.isCompiled)f();else{u.bindVAO(this._vao);u.useProgram(B);if(J){F=K.getMosaicItemPosition(H,
!0);if(C.isSome(F)){const {tl:da,br:R,page:M}=F;U=R[0]-da[0];X=R[1]-da[1];F=K.getPageSize(M);C.isSome(F)&&(K.bind(u,d.TextureSamplingMode.LINEAR,M,m.VTL_TEXTURE_BINDING_UNIT_SPRITES),B.setUniform4f("u_tlbr",da[0],da[1],R[0],R[1]),B.setUniform2fv("u_mosaicSize",F),B.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES))}B.setUniform1f("u_opacity",G)}else this._color[0]=L*F[0],this._color[1]=L*F[1],this._color[2]=L*F[2],this._color[3]=L,B.setUniform4fv("u_color",this._color);B.setUniform1f("u_depth",
x.z||0);h&&(x=c.u32to4Xu8(g+1),B.setUniform4fv("u_id",x));for(const da of w)B.setUniform1f("u_coord_range",da.rangeX),B.setUniformMatrix3fv("u_dvsMat3",da.transforms.dvs),J&&(x=Z*da.width*Math.max(2**(Math.round(z)-da.key.level),1),w=x/E.nextPowerOfTwo(U),x/=E.nextPowerOfTwo(X),this._patternMatrix[0]=w,this._patternMatrix[4]=x,B.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),u.setStencilFunction(d.CompareFunction.EQUAL,0,255),u.drawArrays(d.PrimitiveType.TRIANGLE_STRIP,0,4)}};v._loadWGLResources=
function(h){if(!this._vao){var {context:w,styleLayer:u}=h;h=u.backgroundMaterial;var k=new Int8Array([0,0,1,0,0,1,1,1]);k=b.BufferObject.createVertex(w,d.Usage.STATIC_DRAW,k);this._vao=new e.VertexArrayObject(w,h.getAttributeLocations(),h.getLayoutInfo(),{geometry:k})}};return r}(a);q.WGLBrushVTLBackground=a;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l){m=function(c){function a(){var d=c.apply(this,arguments)||this;d._programOptions={id:!1};return d}t._inheritsLoose(a,c);var b=a.prototype;b.dispose=function(){};b.drawMany=function(d,e){const {context:p,displayLevel:r,requiredLevel:v,state:h,drawPhase:w,painter:u,spriteMosaic:k,styleLayerUID:g,requestRender:f,allowDelayedRender:n}=d;if(e.some(H=>H.layerData.get(g)?.circleIndexCount??!1)){d=d.styleLayer;var z=d.circleMaterial,x=u.vectorTilesMaterialManager,B=d.getPaintValue("circle-translate",
r),D=d.getPaintValue("circle-translate-anchor",r),F=w===A.WGLDrawPhase.HITTEST,G=this._programOptions;G.id=F;x=x.getMaterialProgram(p,z,G);if(n&&E.isSome(f)&&!x.isCompiled)f();else{p.useProgram(x);x.setUniformMatrix3fv("u_displayMat3",D===C.TranslateAnchor.VIEWPORT?h.displayMat3:h.displayViewMat3);x.setUniform2fv("u_circleTranslation",B);x.setUniform1f("u_depth",d.z);x.setUniform1f("u_antialiasingWidth",1.2);B=-1;F&&(F=y.u32to4Xu8(g+1),x.setUniform4fv("u_id",F));for(const H of e)H.layerData.has(g)&&
(H.key.level!==B&&(B=H.key.level,z.setDataUniforms(x,r,d,B,k)),e=H.layerData.get(g),e.circleIndexCount&&(e.prepareForRendering(p),F=e.circleVertexArrayObject,E.isNone(F)||(p.bindVAO(F),x.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),v!==H.key.level?p.setStencilFunction(l.CompareFunction.EQUAL,H.stencilRef,255):p.setStencilFunction(l.CompareFunction.GREATER,255,255),p.drawElements(l.PrimitiveType.TRIANGLES,e.circleIndexCount,l.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),
H.triangleCount+=e.circleIndexCount/3)))}}};return a}(m);q.WGLBrushVTLCircle=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../symbols/cim/enums"],function(q,t){q.StyleLayerType=void 0;(function(C){C[C.BACKGROUND=0]="BACKGROUND";C[C.FILL=1]="FILL";C[C.LINE=2]="LINE";C[C.SYMBOL=3]="SYMBOL";C[C.CIRCLE=4]="CIRCLE"})(q.StyleLayerType||(q.StyleLayerType={}));
q.Visibility=void 0;(function(C){C[C.VISIBLE=0]="VISIBLE";C[C.NONE=1]="NONE"})(q.Visibility||(q.Visibility={}));q.SymbolPlacement=void 0;(function(C){C[C.POINT=0]="POINT";C[C.LINE=1]="LINE";C[C.LINE_CENTER=2]="LINE_CENTER"})(q.SymbolPlacement||(q.SymbolPlacement={}));q.RotationAlignment=void 0;(function(C){C[C.MAP=0]="MAP";C[C.VIEWPORT=1]="VIEWPORT";C[C.AUTO=2]="AUTO"})(q.RotationAlignment||(q.RotationAlignment={}));q.TextJustification=void 0;(function(C){C[C.AUTO=0]="AUTO";C[C.LEFT=1]="LEFT";C[C.CENTER=
2]="CENTER";C[C.RIGHT=3]="RIGHT"})(q.TextJustification||(q.TextJustification={}));q.SymbolAnchor=void 0;(function(C){C[C.CENTER=0]="CENTER";C[C.LEFT=1]="LEFT";C[C.RIGHT=2]="RIGHT";C[C.TOP=3]="TOP";C[C.BOTTOM=4]="BOTTOM";C[C.TOP_LEFT=5]="TOP_LEFT";C[C.TOP_RIGHT=6]="TOP_RIGHT";C[C.BOTTOM_LEFT=7]="BOTTOM_LEFT";C[C.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(q.SymbolAnchor||(q.SymbolAnchor={}));q.TextTransform=void 0;(function(C){C[C.NONE=0]="NONE";C[C.UPPERCASE=1]="UPPERCASE";C[C.LOWERCASE=2]="LOWERCASE"})(q.TextTransform||
(q.TextTransform={}));q.TranslateAnchor=void 0;(function(C){C[C.MAP=0]="MAP";C[C.VIEWPORT=1]="VIEWPORT"})(q.TranslateAnchor||(q.TranslateAnchor={}));q.TextWritingMode=void 0;(function(C){C[C.HORIZONTAL=0]="HORIZONTAL";C[C.VERTICAL=1]="VERTICAL"})(q.TextWritingMode||(q.TextWritingMode={}));let E=function(){};E.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};E.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};
E.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:t.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:t.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};E.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE},"symbol-avoid-edges":{type:"boolean",
default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:q.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:q.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",
default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:q.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),
default:q.SymbolAnchor.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:q.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},
"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:q.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:q.TextTransform.NONE},
"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[q.TextWritingMode.HORIZONTAL]}};E.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:q.Visibility.VISIBLE}};E.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};E.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",
default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};E.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},
"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}};E.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",
minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},
"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};E.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",
minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};E.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,
0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:q.TranslateAnchor.MAP}};q.StyleDefinition=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c){const a=1/65536;l=function(b){function d(){var p=b.apply(this,arguments)||this;p._fillProgramOptions={id:!1,pattern:!1};p._outlineProgramOptions={id:!1};return p}t._inheritsLoose(d,b);var e=d.prototype;e.dispose=function(){};e.drawMany=function(p,r){const {displayLevel:v,drawPhase:h,renderPass:w,spriteMosaic:u,styleLayerUID:k}=p;var g=!1;for(var f of r)if(f.layerData.has(k)){var n=f.layerData.get(k);if(0<n.fillIndexCount||0<n.outlineIndexCount){g=!0;break}}if(g){g=p.styleLayer;
var z=g.getPaintProperty("fill-pattern");n=(f=void 0!==z)&&z.isDataDriven;if(f&&!n){var x=z.getValue(v);x=u.getMosaicItemPosition(x,!0)}z=!f&&g.getPaintValue("fill-antialias",v);var B=!0,D=1;if(!f){var F=g.getPaintProperty("fill-color"),G=g.getPaintProperty("fill-opacity");F?.isDataDriven||G?.isDataDriven||(D=g.getPaintValue("fill-color",v),D=g.getPaintValue("fill-opacity",v)*D[3],1<=D&&(B=!1))}if(!B||"opaque"!==w){var H;h===y.WGLDrawPhase.HITTEST&&(H=m.u32to4Xu8(k+1));F=g.getPaintValue("fill-translate",
v);G=g.getPaintValue("fill-translate-anchor",v);(B||"translucent"!==w)&&this._drawFill(p,k,g,r,F,G,f,x,n,H);x=!g.hasDataDrivenOutlineColor&&g.outlineUsesFillColor&&1>D;z&&"opaque"!==w&&!x&&this._drawOutline(p,k,g,r,F,G,H)}}};e._drawFill=function(p,r,v,h,w,u,k,g,f,n){if(!k||f||!E.isNone(g)){var {context:z,displayLevel:x,state:B,drawPhase:D,painter:F,pixelRatio:G,spriteMosaic:H,requestRender:J,allowDelayedRender:L}=p;p=v.fillMaterial;var K=F.vectorTilesMaterialManager,U=G>A.VTL_HIGH_RES_CUTOFF?2:1,
X=D===y.WGLDrawPhase.HITTEST,Z=this._fillProgramOptions;Z.id=X;Z.pattern=k;K=K.getMaterialProgram(z,p,Z);if(L&&E.isSome(J)&&!K.isCompiled)J();else{z.useProgram(K);E.isSome(g)&&({page:g}=g,Z=H.getPageSize(g),E.isSome(Z)&&(H.bind(z,c.TextureSamplingMode.LINEAR,g,A.VTL_TEXTURE_BINDING_UNIT_SPRITES),K.setUniform2fv("u_mosaicSize",Z),K.setUniform1i("u_texture",A.VTL_TEXTURE_BINDING_UNIT_SPRITES)));K.setUniformMatrix3fv("u_displayMat3",u===C.TranslateAnchor.VIEWPORT?B.displayMat3:B.displayViewMat3);K.setUniform2fv("u_fillTranslation",
w);K.setUniform1f("u_depth",v.z+a);X&&K.setUniform4fv("u_id",n);w=-1;for(const aa of h)if(aa.layerData.has(r)&&(aa.key.level!==w&&(w=aa.key.level,p.setDataUniforms(K,x,v,w,H)),h=aa.layerData.get(r),h.fillIndexCount&&(h.prepareForRendering(z),u=h.fillVertexArrayObject,!E.isNone(u)))){z.bindVAO(u);K.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);z.setStencilFunction(c.CompareFunction.EQUAL,aa.stencilRef,255);k&&K.setUniform1f("u_patternFactor",aa.rangeX/(U*aa.width*Math.max(2**(Math.round(x)-aa.key.level),
1)));if(f){u=h.patternMap;if(!u)continue;for(const [da,R]of u)u=H.getPageSize(da),E.isSome(u)&&(H.bind(z,c.TextureSamplingMode.LINEAR,da,A.VTL_TEXTURE_BINDING_UNIT_SPRITES),K.setUniform2fv("u_mosaicSize",u),K.setUniform1i("u_texture",A.VTL_TEXTURE_BINDING_UNIT_SPRITES),z.drawElements(c.PrimitiveType.TRIANGLES,R[1],c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*R[0]))}else z.drawElements(c.PrimitiveType.TRIANGLES,h.fillIndexCount,c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*h.fillIndexStart);
aa.triangleCount+=h.fillIndexCount/3}}}};e._drawOutline=function(p,r,v,h,w,u,k){const {context:g,displayLevel:f,state:n,drawPhase:z,painter:x,pixelRatio:B,spriteMosaic:D,requestRender:F,allowDelayedRender:G}=p;p=v.outlineMaterial;var H=x.vectorTilesMaterialManager;const J=.75/B,L=z===y.WGLDrawPhase.HITTEST,K=this._outlineProgramOptions;K.id=L;H=H.getMaterialProgram(g,p,K);if(G&&E.isSome(F)&&!H.isCompiled)F();else{g.useProgram(H);H.setUniformMatrix3fv("u_displayMat3",u===C.TranslateAnchor.VIEWPORT?
n.displayMat3:n.displayViewMat3);H.setUniform2fv("u_fillTranslation",w);H.setUniform1f("u_depth",v.z+a);H.setUniform1f("u_outline_width",J);L&&H.setUniform4fv("u_id",k);w=-1;for(const U of h)U.layerData.has(r)&&(U.key.level!==w&&(w=U.key.level,p.setDataUniforms(H,f,v,w,D)),h=U.layerData.get(r),h.prepareForRendering(g),h.outlineIndexCount&&(u=h.outlineVertexArrayObject,E.isNone(u)||(g.bindVAO(u),H.setUniformMatrix3fv("u_dvsMat3",U.transforms.dvs),g.setStencilFunction(c.CompareFunction.EQUAL,U.stencilRef,
255),g.drawElements(c.PrimitiveType.TRIANGLES,h.outlineIndexCount,c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*h.outlineIndexStart),U.triangleCount+=h.outlineIndexCount/3)))}};return d}(l);q.WGLBrushVTLFill=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c){l=function(a){function b(){var e=a.apply(this,arguments)||this;e._programOptions={id:!1,pattern:!1,sdf:!1};return e}t._inheritsLoose(b,a);var d=b.prototype;d.dispose=function(){};d.drawMany=function(e,p){const {context:r,displayLevel:v,state:h,drawPhase:w,painter:u,pixelRatio:k,spriteMosaic:g,styleLayerUID:f,requestRender:n,allowDelayedRender:z}=e;if(p.some(aa=>aa.layerData.get(f)?.lineIndexCount??!1)){e=e.styleLayer;var x=e.lineMaterial,B=u.vectorTilesMaterialManager,
D=e.getPaintValue("line-translate",v),F=e.getPaintValue("line-translate-anchor",v),G=e.getPaintProperty("line-pattern"),H=void 0!==G,J=H&&G.isDataDriven;if(H&&!J){G=G.getValue(v);var L=g.getMosaicItemPosition(G)}var K;G=!1;if(!H){var U=e.getPaintProperty("line-dasharray");G=(K=void 0!==U)&&U.isDataDriven;K&&!G&&(L=U.getValue(v),L=e.getDashKey(L,e.getLayoutValue("line-cap",v)),L=g.getMosaicItemPosition(L))}U=1/k;var X=w===y.WGLDrawPhase.HITTEST,Z=this._programOptions;Z.id=X;Z.pattern=H;Z.sdf=K;K=B.getMaterialProgram(r,
x,Z);if(z&&E.isSome(n)&&!K.isCompiled)n();else{r.useProgram(K);K.setUniformMatrix3fv("u_displayViewMat3",h.displayViewMat3);K.setUniformMatrix3fv("u_displayMat3",F===C.TranslateAnchor.VIEWPORT?h.displayMat3:h.displayViewMat3);K.setUniform2fv("u_lineTranslation",D);K.setUniform1f("u_depth",e.z);K.setUniform1f("u_antialiasing",U);X&&(D=m.u32to4Xu8(f+1),K.setUniform4fv("u_id",D));L&&E.isSome(L)&&({page:D}=L,F=g.getPageSize(D),E.isSome(F)&&(g.bind(r,c.TextureSamplingMode.LINEAR,D,A.VTL_TEXTURE_BINDING_UNIT_SPRITES),
K.setUniform2fv("u_mosaicSize",F),K.setUniform1i("u_texture",A.VTL_TEXTURE_BINDING_UNIT_SPRITES)));D=-1;for(const aa of p)if(aa.layerData.has(f)&&(aa.key.level!==D&&(D=aa.key.level,x.setDataUniforms(K,v,e,D,g)),K.setUniform1f("u_zoomFactor",2**(v-D)/k),p=aa.layerData.get(f),p.lineIndexCount&&(p.prepareForRendering(r),F=p.lineVertexArrayObject,!E.isNone(F)))){r.bindVAO(F);K.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);r.setStencilFunction(c.CompareFunction.EQUAL,aa.stencilRef,255);if(J||G){F=
p.patternMap;if(!F)continue;for(const [da,R]of F)F=g.getPageSize(da),E.isSome(F)&&(g.bind(r,c.TextureSamplingMode.LINEAR,da,A.VTL_TEXTURE_BINDING_UNIT_SPRITES),K.setUniform2fv("u_mosaicSize",F),K.setUniform1i("u_texture",A.VTL_TEXTURE_BINDING_UNIT_SPRITES),r.drawElements(c.PrimitiveType.TRIANGLES,R[1],c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*R[0]))}else r.drawElements(c.PrimitiveType.TRIANGLES,p.lineIndexCount,c.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*p.lineIndexStart);aa.triangleCount+=
p.lineIndexCount/3}}}};return b}(l);q.WGLBrushVTLLine=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){const e=1/65536;b=function(p){function r(){var h=p.apply(this,arguments)||this;h._iconProgramOptions={id:!1,sdf:!1};h._sdfProgramOptions={id:!1};h._spritesTextureSize=C.create();return h}t._inheritsLoose(r,p);var v=r.prototype;v.dispose=function(){};v.drawMany=function(h,w){const {drawPhase:u,styleLayerUID:k}=h,g=h.styleLayer;let f;u===l.WGLDrawPhase.HITTEST&&(f=a.u32to4Xu8(k+1));this._drawIcons(h,g,w,f);this._drawText(h,g,w,f)};v._drawIcons=function(h,w,u,k){const {context:g,
displayLevel:f,drawPhase:n,painter:z,spriteMosaic:x,state:B,styleLayerUID:D,requestRender:F,allowDelayedRender:G}=h,H=w.iconMaterial;var J=z.vectorTilesMaterialManager,L=!1;for(var K of u)if(K.layerData.has(D)){var U=K.layerData.get(D);if(0<U.iconPerPageElementsMap.size){L=!0;break}}if(L){L=w.getPaintValue("icon-translate",f);K=w.getPaintValue("icon-translate-anchor",f);var X=w.getLayoutValue("icon-rotation-alignment",f);X===y.RotationAlignment.AUTO&&(X=w.getLayoutValue("symbol-placement",f)===y.SymbolPlacement.POINT?
y.RotationAlignment.VIEWPORT:y.RotationAlignment.MAP);var Z=X===y.RotationAlignment.MAP;Z=w.getLayoutValue("icon-keep-upright",f)&&Z;var aa=U.isIconSDF;U=n===l.WGLDrawPhase.HITTEST;var da=this._iconProgramOptions;da.id=U;da.sdf=aa;J=J.getMaterialProgram(g,H,da);if(G&&E.isSome(F)&&!J.isCompiled)F();else{g.useProgram(J);J.setUniformMatrix3fv("u_displayViewMat3",X===y.RotationAlignment.MAP?B.displayViewMat3:B.displayMat3);J.setUniformMatrix3fv("u_displayMat3",K===y.TranslateAnchor.VIEWPORT?B.displayMat3:
B.displayViewMat3);J.setUniform2fv("u_iconTranslation",L);J.setUniform1f("u_depth",w.z);J.setUniform1f("u_mapRotation",c.degToByte(B.rotation));J.setUniform1f("u_keepUpright",Z?1:0);J.setUniform1f("u_level",10*f);J.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_SPRITES);J.setUniform1f("u_fadeDuration",A.FADE_DURATION/1E3);U&&J.setUniform4fv("u_id",k);k=-1;for(const R of u)if(R.layerData.has(D)&&(R.key.level!==k&&(k=R.key.level,H.setDataUniforms(J,f,w,k,x)),U=R.layerData.get(D),0!==U.iconPerPageElementsMap.size&&
(U.prepareForRendering(g),U.updateOpacityInfo(),u=U.iconVertexArrayObject,!E.isNone(u)))){g.bindVAO(u);J.setUniformMatrix3fv("u_dvsMat3",R.transforms.dvs);J.setUniform1f("u_time",(performance.now()-U.lastOpacityUpdate)/1E3);for(const [M,Q]of U.iconPerPageElementsMap)this._renderIconRange(h,J,Q,M,R)}}}};v._renderIconRange=function(h,w,u,k,g){const {context:f,spriteMosaic:n}=h;this._spritesTextureSize[0]=n.getWidth(k)/4;this._spritesTextureSize[1]=n.getHeight(k)/4;w.setUniform2fv("u_mosaicSize",this._spritesTextureSize);
n.bind(f,d.TextureSamplingMode.LINEAR,k,m.VTL_TEXTURE_BINDING_UNIT_SPRITES);f.setStencilTestEnabled(!0);f.setStencilFunction(d.CompareFunction.GREATER,255,255);f.setStencilWriteMask(0);f.drawElements(d.PrimitiveType.TRIANGLES,u[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*u[0]);g.triangleCount+=u[1]/3};v._drawText=function(h,w,u,k){const {context:g,displayLevel:f,drawPhase:n,glyphMosaic:z,painter:x,pixelRatio:B,spriteMosaic:D,state:F,styleLayerUID:G,requestRender:H,allowDelayedRender:J}=
h;h=w.textMaterial;const L=x.vectorTilesMaterialManager;var K=!1;for(var U of u)if(U.layerData.has(G)){var X=U.layerData.get(G);if(0<X.glyphPerPageElementsMap.size){K=!0;break}}if(K&&(X=w.getPaintProperty("text-opacity"),!X||X.isDataDriven||0!==X.getValue(f))){X=w.getPaintProperty("text-color");var Z=!X||X.isDataDriven||0<X.getValue(f)[3];X=w.getPaintProperty("text-halo-width");U=w.getPaintProperty("text-halo-color");var aa=(!X||X.isDataDriven||0<X.getValue(f))&&(!U||U.isDataDriven||0<U.getValue(f)[3]);
if(Z||aa){X=w.getLayoutValue("text-rotation-alignment",f);X===y.RotationAlignment.AUTO&&(X=w.getLayoutValue("symbol-placement",f)===y.SymbolPlacement.POINT?y.RotationAlignment.VIEWPORT:y.RotationAlignment.MAP);U=X===y.RotationAlignment.MAP;U=w.getLayoutValue("text-keep-upright",f)&&U;K=n===l.WGLDrawPhase.HITTEST;var da=.8*3/B;this._glyphTextureSize||(this._glyphTextureSize=C.fromValues(z.width/4,z.height/4));var R=w.getPaintValue("text-translate",f),M=w.getPaintValue("text-translate-anchor",f),Q=
this._sdfProgramOptions;Q.id=K;var N=L.getMaterialProgram(g,h,Q);if(J&&E.isSome(H)&&!N.isCompiled)H();else{g.useProgram(N);N.setUniformMatrix3fv("u_displayViewMat3",X===y.RotationAlignment.MAP?F.displayViewMat3:F.displayMat3);N.setUniformMatrix3fv("u_displayMat3",M===y.TranslateAnchor.VIEWPORT?F.displayMat3:F.displayViewMat3);N.setUniform2fv("u_textTranslation",R);N.setUniform1f("u_depth",w.z+e);N.setUniform2fv("u_mosaicSize",this._glyphTextureSize);N.setUniform1f("u_mapRotation",c.degToByte(F.rotation));
N.setUniform1f("u_keepUpright",U?1:0);N.setUniform1f("u_level",10*f);N.setUniform1i("u_texture",m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);N.setUniform1f("u_antialiasingWidth",da);N.setUniform1f("u_fadeDuration",A.FADE_DURATION/1E3);K&&N.setUniform4fv("u_id",k);k=-1;for(const S of u)S.layerData.has(G)&&(S.key.level!==k&&(k=S.key.level,h.setDataUniforms(N,f,w,k,D)),X=S.layerData.get(G),0!==X.glyphPerPageElementsMap.size&&(X.prepareForRendering(g),X.updateOpacityInfo(),u=X.textVertexArrayObject,E.isNone(u)||
(g.bindVAO(u),N.setUniformMatrix3fv("u_dvsMat3",S.transforms.dvs),g.setStencilTestEnabled(!0),g.setStencilFunction(d.CompareFunction.GREATER,255,255),g.setStencilWriteMask(0),u=(performance.now()-X.lastOpacityUpdate)/1E3,N.setUniform1f("u_time",u),X.glyphPerPageElementsMap.forEach((W,T)=>{this._renderGlyphRange(g,W,T,z,N,aa,Z,S)}))))}}}};v._renderGlyphRange=function(h,w,u,k,g,f,n,z){k.bind(h,d.TextureSamplingMode.LINEAR,u,m.VTL_TEXTURE_BINDING_UNIT_GLYPHS);f&&(g.setUniform1f("u_halo",1),h.drawElements(d.PrimitiveType.TRIANGLES,
w[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*w[0]),z.triangleCount+=w[1]/3);n&&(g.setUniform1f("u_halo",0),h.drawElements(d.PrimitiveType.TRIANGLES,w[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*w[0]),z.triangleCount+=w[1]/3)};return r}(b);q.WGLBrushVTLSymbol=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(q){q.COLLISION_GRID_CELL_SIZE=
32;q.DECLUTTER_BUDGET=1.5;q.DECLUTTER_TILES=!0;q.FADE_DURATION=200;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(q){function t(l,c){l%=c;return 0<=l?l:l+c}const E=Number.POSITIVE_INFINITY,C=Math.PI,A=128/C,y=256/360,m=1/Math.LN2;q.C_256_TO_RAD=C/128;q.C_2PI=2*C;q.C_DEG_TO_256=y;q.C_DEG_TO_RAD=C/180;q.C_INFINITY=E;q.C_PI=C;q.C_PI_BY_2=C/2;q.C_RAD_TO_256=A;q.C_SQRT2=1.414213562;
q.C_SQRT2_INV=1/1.414213562;q.between=function(l,c,a){return l>=c&&l<=a||l>=a&&l<=c};q.degToByte=function(l){return t(l*y,256)};q.interpolate=function(l,c,a){return l*(1-a)+c*a};q.log2=function(l){return Math.log(l)*m};q.positiveMod=t;q.radToByte=function(l){return t(l*A,256)};q.sqr=function(l){return l*l};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m){return function(l){function c(){return l.apply(this,arguments)||this}q._inheritsLoose(c,l);var a=c.prototype;a.dispose=function(){};a.getGeometryType=function(){return E.WGLGeometryType.LABEL};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,d,e,p){const {context:r,painter:v,state:h,rendererInfo:w,requestRender:u,allowDelayedRender:k}=b,g=y.LabelMaterialKey.load(e.materialKey),f=g.mapAligned?1:0;if(f||!(1<=Math.abs(d.key.level-Math.round(100*b.displayLevel)/
100))){var {bufferLayouts:n,attributes:z}=C.createProgramDescriptor(g.data,{geometry:[{location:0,name:"a_pos",count:2,type:m.DataType.SHORT},{location:1,name:"a_id",count:4,type:m.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:m.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:m.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:m.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:m.DataType.UNSIGNED_BYTE},
{location:6,name:"a_glyphData",count:4,type:m.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:m.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:m.DataType.UNSIGNED_SHORT}]});p=v.materialManager.getMaterialProgram(b,g,"materials/label",z,p);if(k&&t.isSome(u)&&!p.isCompiled)u();else{b.context.setStencilFunction(m.CompareFunction.EQUAL,0,255);r.useProgram(p);this._setSharedUniforms(p,b,d);v.textureManager.bindTextures(r,p,g);var x=1===f?h.displayViewMat3:h.displayMat3;
this._setSizeVVUniforms(g,p,w,d);p.setUniform1f("u_mapRotation",Math.floor(h.rotation/360*254));p.setUniform1f("u_mapAligned",f);p.setUniformMatrix3fv("u_displayMat3",x);p.setUniform1f("u_opacity",1);p.setUniform2fv("u_screenSize",b.state.size);p.setUniform1f("u_isHalo",1);b=e.target.getVAO(r,n,z);d=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(b);r.drawElements(m.PrimitiveType.TRIANGLES,e.indexCount,m.DataType.UNSIGNED_INT,d);p.setUniform1f("u_isHalo",0);r.drawElements(m.PrimitiveType.TRIANGLES,
e.indexCount,m.DataType.UNSIGNED_INT,d);r.setStencilTestEnabled(!0);r.setBlendingEnabled(!0)}}};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y,m){return function(l){function c(){return l.apply(this,arguments)||this}q._inheritsLoose(c,l);var a=c.prototype;a.dispose=
function(){};a.getGeometryType=function(){return E.WGLGeometryType.LINE};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,d,e,p){const {context:r,painter:v,rendererInfo:h,displayLevel:w,passOptions:u,requestRender:k,allowDelayedRender:g}=b,f=y.LineMaterialKey.load(e.materialKey),n=t.isSome(u)&&"hittest"===u.type;var z=C.createProgramDescriptor(f.data,{geometry:[{location:0,name:"a_pos",count:2,type:m.DataType.SHORT},{location:1,name:"a_id",count:4,type:m.DataType.UNSIGNED_BYTE},
{location:2,name:"a_color",count:4,type:m.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:m.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:m.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:m.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:m.DataType.BYTE},{location:7,name:"a_aux",count:2,type:m.DataType.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:m.DataType.UNSIGNED_SHORT}]});
let x=m.PrimitiveType.TRIANGLES;n&&(z=this._getTriangleDesc(e.materialKey,z),x=m.PrimitiveType.POINTS);const {attributes:B,bufferLayouts:D}=z;p=v.materialManager.getMaterialProgram(b,f,"materials/line",B,p);g&&t.isSome(k)&&!p.isCompiled?k():(z=1/b.pixelRatio,r.useProgram(p),this._setSharedUniforms(p,b,d),f.textureBinding&&v.textureManager.bindTextures(r,p,f),p.setUniform1f("u_zoomFactor",2**(w-d.key.level)),p.setUniform1f("u_blur",0+z),p.setUniform1f("u_antialiasing",z),this._setSizeVVUniforms(f,
p,h,d),this._setColorAndOpacityVVUniforms(f,p,h),r.setFaceCullingEnabled(!1),b=e.target.getVAO(r,D,B,n),d=e.indexCount,e=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT,n&&(d/=3,e/=3),r.bindVAO(b),r.drawElements(x,d,m.DataType.UNSIGNED_INT,e))};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m){return function(l){function c(){return l.apply(this,arguments)||this}q._inheritsLoose(c,l);var a=c.prototype;a.dispose=function(){};a.getGeometryType=function(){return E.WGLGeometryType.TEXT};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,d,e,p){const {context:r,painter:v,rendererInfo:h,state:w,passOptions:u,requestRender:k,allowDelayedRender:g}=b,f=y.TextMaterialKey.load(e.materialKey),n=t.isSome(u)&&"hittest"===u.type,{bufferLayouts:z,attributes:x}=C.createProgramDescriptor(f.data,
{geometry:[{location:0,name:"a_pos",count:2,type:m.DataType.SHORT},{location:1,name:"a_id",count:4,type:m.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:m.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:m.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:m.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:m.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:m.DataType.UNSIGNED_SHORT},{location:7,
name:"a_vertexOffset",count:2,type:m.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:m.DataType.UNSIGNED_SHORT}]});p=v.materialManager.getMaterialProgram(b,f,"materials/text",x,p);if(g&&t.isSome(k)&&!p.isCompiled)k();else{r.useProgram(p);var B=m.PrimitiveType.TRIANGLES;n&&(B=m.PrimitiveType.POINTS);this._setSharedUniforms(p,b,d);v.textureManager.bindTextures(r,p,f);p.setUniformMatrix3fv("u_displayMat3",w.displayMat3);p.setUniformMatrix3fv("u_displayViewMat3",w.displayViewMat3);this._setSizeVVUniforms(f,
p,h,d);this._setColorAndOpacityVVUniforms(f,p,h);this._setRotationVVUniforms(f,p,h);p.setUniform1f("u_isHalo",1);b=e.target.getVAO(r,z,x);d=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(b);r.drawElements(m.PrimitiveType.TRIANGLES,e.indexCount,m.DataType.UNSIGNED_INT,d);p.setUniform1f("u_isHalo",0);r.drawElements(B,e.indexCount,m.DataType.UNSIGNED_INT,d)}};return c}(A)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../enums","./Programs"],function(q,t){return function(){function E(){this._programByKey=
new Map}var C=E.prototype;C.dispose=function(){this._programByKey.forEach(A=>A.dispose());this._programByKey.clear()};C.getMaterialProgram=function(A,y,m){const l=y.key<<3|this._getMaterialOptionsValue(y.type,m);if(this._programByKey.has(l))return this._programByKey.get(l);var c=this._getProgramTemplate(y.type);({shaders:c}=c);const {vertexShader:a,fragmentShader:b}=c(m);m=y.getShaderHeader();c=y.getShaderMain();m=a.replace("#pragma header",m).replace("#pragma main",c);A=A.programCache.acquire(m,
b,y.getAttributeLocations());this._programByKey.set(l,A);return A};C._getMaterialOptionsValue=function(A,y){switch(A){case q.ShaderProgramType.BACKGROUND:return(y.pattern?1:0)<<1|(y.id?1:0);case q.ShaderProgramType.FILL:return(y.pattern?1:0)<<1|(y.id?1:0);case q.ShaderProgramType.OUTLINE:return y.id?1:0;case q.ShaderProgramType.LINE:return(y.sdf?1:0)<<2|(y.pattern?1:0)<<1|(y.id?1:0);case q.ShaderProgramType.ICON:return(y.sdf?1:0)<<1|(y.id?1:0);case q.ShaderProgramType.CIRCLE:return y.id?1:0;case q.ShaderProgramType.TEXT:return y.id?
1:0;default:return 0}};C._getProgramTemplate=function(A){switch(A){case q.ShaderProgramType.BACKGROUND:return t.background;case q.ShaderProgramType.CIRCLE:return t.circle;case q.ShaderProgramType.FILL:return t.fill;case q.ShaderProgramType.ICON:return t.icon;case q.ShaderProgramType.LINE:return t.line;case q.ShaderProgramType.OUTLINE:return t.outline;case q.ShaderProgramType.TEXT:return t.text;default:return null}};return E}()})},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],
function(q){q.MemoryBufferType=void 0;(function(t){t[t.UNKNOWN=0]="UNKNOWN";t[t.FILL_VERTEX=1]="FILL_VERTEX";t[t.FILL_DD_VERTEX=2]="FILL_DD_VERTEX";t[t.FILL_INDEX=3]="FILL_INDEX";t[t.OUTLINE_VERTEX=4]="OUTLINE_VERTEX";t[t.OUTLINE_DD_VERTEX=5]="OUTLINE_DD_VERTEX";t[t.OUTLINE_INDEX=6]="OUTLINE_INDEX";t[t.LINE_VERTEX=7]="LINE_VERTEX";t[t.LINE_DD_VERTEX=8]="LINE_DD_VERTEX";t[t.LINE_INDEX=9]="LINE_INDEX";t[t.ICON_VERTEX=10]="ICON_VERTEX";t[t.ICON_DD_VERTEX=11]="ICON_DD_VERTEX";t[t.ICON_INDEX=12]="ICON_INDEX";
t[t.TEXT_VERTEX=13]="TEXT_VERTEX";t[t.TEXT_DD_VERTEX=14]="TEXT_DD_VERTEX";t[t.TEXT_INDEX=15]="TEXT_INDEX";t[t.CIRCLE_VERTEX=16]="CIRCLE_VERTEX";t[t.CIRCLE_INDEX=17]="CIRCLE_INDEX"})(q.MemoryBufferType||(q.MemoryBufferType={}));q.BucketType=void 0;(function(t){t[t.FILL=1]="FILL";t[t.LINE=2]="LINE";t[t.SYMBOL=3]="SYMBOL";t[t.CIRCLE=4]="CIRCLE"})(q.BucketType||(q.BucketType={}));q.DrawPhase=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.OPAQUE=1]="OPAQUE";t[t.TRANSLUCENT=2]="TRANSLUCENT";t[t.SYMBOLS=
3]="SYMBOLS";t[t.HITTEST=4]="HITTEST"})(q.DrawPhase||(q.DrawPhase={}));q.ShaderProgramType=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.FILL=1]="FILL";t[t.OUTLINE=2]="OUTLINE";t[t.LINE=3]="LINE";t[t.ICON=4]="ICON";t[t.CIRCLE=5]="CIRCLE";t[t.TEXT=6]="TEXT";t[t.TILEINFO=7]="TILEINFO"})(q.ShaderProgramType||(q.ShaderProgramType={}));q.StyleUpdateType=void 0;(function(t){t[t.PAINTER_CHANGED=0]="PAINTER_CHANGED";t[t.LAYOUT_CHANGED=1]="LAYOUT_CHANGED";t[t.LAYER_CHANGED=2]="LAYER_CHANGED";t[t.LAYER_REMOVED=
3]="LAYER_REMOVED";t[t.SPRITES_CHANGED=4]="SPRITES_CHANGED"})(q.StyleUpdateType||(q.StyleUpdateType={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(q,t,E){q.background={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id,PATTERN:C.pattern})+t.resolveIncludes("background/background.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id,
PATTERN:C.pattern})+t.resolveIncludes("background/background.frag")})};q.circle={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("circle/circle.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("circle/circle.frag")})};q.fill={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id,PATTERN:C.pattern})+t.resolveIncludes("fill/fill.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id,PATTERN:C.pattern})+t.resolveIncludes("fill/fill.frag")})};q.icon={shaders:C=>
({vertexShader:E.glslifyDefineMap({ID:C.id,SDF:C.sdf})+t.resolveIncludes("icon/icon.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id,SDF:C.sdf})+t.resolveIncludes("icon/icon.frag")})};q.line={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id,PATTERN:C.pattern,SDF:C.sdf})+t.resolveIncludes("line/line.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id,PATTERN:C.pattern,SDF:C.sdf})+t.resolveIncludes("line/line.frag")})};q.outline={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("outline/outline.vert"),
fragmentShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("outline/outline.frag")})};q.text={shaders:C=>({vertexShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("text/text.vert"),fragmentShader:E.glslifyDefineMap({ID:C.id})+t.resolveIncludes("text/text.frag")})};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],
function(q,t,E){const C=new E.ShaderCompiler(function(A){let y=t;A.split("/").forEach(m=>{y&&(y=y[m])});return y});q.resolveIncludes=function(A){return C.resolveIncludes(A)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l){let c=function(){function a(){this._initialized=!1}var b=a.prototype;b.dispose=function(){this._program=t.disposeMaybe(this._program);this._vertexArrayObject=t.disposeMaybe(this._vertexArrayObject)};b.render=function(d,e,p,r){d&&(this._initialized||this._initialize(d),d.setBlendFunctionSeparate(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA,y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA),d.bindVAO(this._vertexArrayObject),d.useProgram(this._program),e.setSamplingMode(p),
d.bindTexture(e,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",r),d.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4),d.bindTexture(null,0),d.bindVAO())};b._initialize=function(d){if(this._initialized)return!0;const e=m.createProgram(d,C.bitBlit);if(!e)return!1;const p=new Int8Array(16);p[0]=-1;p[1]=-1;p[2]=0;p[3]=0;p[4]=1;p[5]=-1;p[6]=1;p[7]=0;p[8]=-1;p[9]=1;p[10]=0;p[11]=1;p[12]=1;p[13]=1;p[14]=1;p[15]=1;d=new l.VertexArrayObject(d,C.bitBlit.attributes,E.PosTex2b,{geometry:A.BufferObject.createVertex(d,
y.Usage.STATIC_DRAW,p)});this._program=e;this._vertexArrayObject=d;return this._initialized=!0};return a}();q.BitBlitRenderer=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:t.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",
1]])};q.bitBlit=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../core/maybe","./enums","./shaders/MaterialPrograms"],function(q,t,E){const C=m=>m===t.WGLDrawPhase.HITTEST||m===t.WGLDrawPhase.LABEL_ALPHA,A=({rendererInfo:m,drawPhase:l},c,a,b)=>{c=c.getVariationHash();b=b.join(".");l=(C(l)?1:0)|(l===t.WGLDrawPhase.HIGHLIGHT?2:0);return`${c}-${b}-${l}-${m.getVariationHash()}-${q.isSome(a)&&
a.join(".")}`},y=(m,l,c,a)=>{a=a.reduce((b,d)=>({...b,[d]:m.context.driverTest[d]}),{});l={...l.getVariation(),...m.rendererInfo.getVariation(),highlight:m.drawPhase===t.WGLDrawPhase.HIGHLIGHT,id:C(m.drawPhase),...a};if(q.isSome(c))for(const b of c)l[b]=!0;return l};return function(){function m(c){this._rctx=c;this._programByKey=new Map}var l=m.prototype;l.dispose=function(){this._programByKey.forEach(c=>c.dispose());this._programByKey.clear()};l.getProgram=function(c,a=[],b=[]){const d=c.vsPath+
"."+c.fsPath+JSON.stringify(a)+b.join(".");if(this._programByKey.has(d))return this._programByKey.get(d);b=b.reduce((v,h)=>({...v,[h]:this._rctx.driverTest[h]}),{});a={...a.map(v=>"string"===typeof v?{name:v,value:!0}:v).reduce((v,h)=>({...v,[h.name]:h.value}),{}),...b};const {vsPath:e,fsPath:p,attributes:r}=c;c=E.createProgramTemplate(e,p,r,a);c=this._rctx.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!c)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(d,c);return c};l.getMaterialProgram=function(c,a,b,d,e,p=["ignoresSamplerPrecision"]){const r=A(c,a,e,p);if(this._programByKey.has(r))return this._programByKey.get(r);c=y(c,a,e,p);b=E.createProgramTemplate(b,b,d,c);b=this._rctx.programCache.acquire(b.shaders.vertexShader,b.shaders.fragmentShader,b.attributes);if(!b)throw Error("Unable to get program for key: ${key}");this._programByKey.set(r,b);return b};return m}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(q,t,E){q.createProgramTemplate=(C,A,y,m)=>{C+=C.substring(C.lastIndexOf("/"));A+=A.substring(A.lastIndexOf("/"));const l={};for(const a in m){let b=void 0;var c=a;b=""+c[0].toUpperCase();for(let d=1;d<c.length;d++){const e=c[d];e===e.toUpperCase()?(b+="_",b+=e):b+=e.toUpperCase()}l[b]=m[a]}m=E.glslifyDefineMap(l);return{attributes:y,shaders:{vertexShader:m+t.resolveIncludes(`${C}.vert`),fragmentShader:m+t.resolveIncludes(`${A}.frag`)}}};
Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/fontUtils ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/AnimatableTextureResource ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f,n,z,x){function B(H,J){J=Math.round(a.pt2px(J)*window.devicePixelRatio);return Math.min(H,J*(128<=J?2:4))}const D=d.create(),F=m.getLogger("esri.views.2d.engine.webgl.TextureManager");let G=function(){function H(J,L,K){this.mosaicType=J;this.page=L;this.sdf=K}H.fromMosaic=function(J,L){return new H(J,L.page,L.sdf)};return H}();return function(){function H(L,K){this._requestRender=L;this.resourceManager=K;this._invalidFontsMap=new Map;this._sdfConverter=
new w(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new z.QueueProcessor({concurrency:10,process:function(){var U=q._asyncToGenerator(function*(X,Z){c.throwIfAborted(Z);try{return yield E(X,{responseType:"image",signal:Z})}catch(aa){if(!c.isAbortError(aa))throw new A("mapview-invalid-resource",`Could not fetch requested resource at ${X}`,aa);throw aa;}});return function(X,Z){return U.apply(this,arguments)}}()});this._spriteMosaic=
new u(2048,2048,500);this._glyphSource=new h(`${t.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new v(1024,1024,this._glyphSource);this._rasterizer=new e(K)}var J=H.prototype;J.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=
null;this._imageRequestQueue.clear();this._imageRequestQueue=null};J.rasterizeItem=function(){var L=q._asyncToGenerator(function*(K,U,X,Z){if(l.isNone(K))return F.error(new A("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(K.type){case "text":case "esriTS":return K=yield this._rasterizeText(K,X,Z),K.forEach(aa=>this._setTextureBinding(r.MosaicType.GLYPH,aa)),{glyphMosaicItems:K};default:if(k.is3D(K))return F.error(new A("mapview-invalid-type",`MapView does not support symbol type: ${K.type}`,
K)),null;K=yield this._rasterizeSpriteSymbol(K,U,Z);f.ok(K)&&K&&this._setTextureBinding(r.MosaicType.SPRITE,K);return{spriteMosaicItem:K}}});return function(K,U,X,Z){return L.apply(this,arguments)}}();J.bindTextures=function(L,K,U,X=!1){if(0!==U.textureBinding){var Z=this._bindingInfos[U.textureBinding-1];U=Z.page;X=X?x.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:x.TextureSamplingMode.LINEAR;switch(Z.mosaicType){case r.MosaicType.SPRITE:Z=this.sprites.getWidth(U);const aa=this.sprites.getHeight(U);Z=
b.set(D,Z,aa);this._spriteMosaic.bind(L,X,U,p.TEXTURE_BINDING_SPRITE_ATLAS);K.setUniform1i("u_texture",p.TEXTURE_BINDING_SPRITE_ATLAS);K.setUniform2fv("u_mosaicSize",Z);break;case r.MosaicType.GLYPH:Z=b.set(D,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(L,X,U,p.TEXTURE_BINDING_GLYPH_ATLAS);K.setUniform1i("u_texture",p.TEXTURE_BINDING_GLYPH_ATLAS);K.setUniform2fv("u_mosaicSize",Z);break;default:F.error("mapview-texture-manager",`Cannot handle unknown type ${Z.mosaicType}`)}}};J._hashMosaic=
function(L,K){return 1|L<<1|(K.sdf?1:0)<<2|K.page<<3};J._setTextureBinding=function(L,K){const U=this._hashMosaic(L,K);this._hashToBindingIndex.has(U)||(L=G.fromMosaic(L,K),this._hashToBindingIndex.set(U,this._bindingInfos.length+1),this._bindingInfos.push(L));K.textureBinding=this._hashToBindingIndex.get(U)};J._rasterizeText=function(){var L=q._asyncToGenerator(function*(K,U,X){let Z,aa;Z="cim"in K?K.fontName:y.getFullyQualifiedFontName(K.font);aa=K.text;K=this._invalidFontsMap.has(Z);U=U?U:k.charCodes(C.bidiText(aa)[0]);
try{return yield this._glyphMosaic.getGlyphItems(K?"arial-unicode-ms-regular":Z,U,X)}catch(da){return F.error(new A("mapview-invalid-resource",`Couldn't find font ${Z}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(Z,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",U,X)}});return function(K,U,X){return L.apply(this,arguments)}}();J._rasterizeSpriteSymbol=function(){var L=q._asyncToGenerator(function*(K,U,X){if(k.isSimple(K))return null;U=n.keyFromSymbol(K);
if(this._spriteMosaic.has(U))return this._spriteMosaic.getSpriteItem(U);if(k.isSVGResource(K)||k.isImageResource(K)&&!k.isMarkerPlacementInsidePolygon(K))return this._handleAsyncResource(U,K,X);if(X=this._rasterizer.rasterizeJSONResource(K,p.PATTERN_FILL_RASTERIZATION_SCALE)){const {size:Z,image:aa,sdf:da,simplePattern:R,rasterizationScale:M}=X;return this._addItemToMosaic(U,Z,{type:"static",data:aa},k.shouldRepeat(K),da,R,M)}return new A("TextureManager","unrecognized or null rasterized image")});
return function(K,U,X){return L.apply(this,arguments)}}();J._handleAsyncResource=function(){var L=q._asyncToGenerator(function*(K,U,X){if(this._ongoingRasterizations.has(K))return this._ongoingRasterizations.get(K);U=k.isSVGResource(U)?this._handleSVG(U,K,X):this._handleImage(U,K,X);this._ongoingRasterizations.set(K,U);try{yield U,this._ongoingRasterizations.delete(K)}catch{this._ongoingRasterizations.delete(K)}return U});return function(K,U,X){return L.apply(this,arguments)}}();J._handleSVG=function(){var L=
q._asyncToGenerator(function*(K,U,X){K=yield this._sdfConverter.draw(K.path,X);return this._addItemToMosaic(U,[126,126],{type:"static",data:new Uint32Array(K.buffer)},!1,!0,!0)});return function(K,U,X){return L.apply(this,arguments)}}();J._handleGIFOrPNG=function(){var L=q._asyncToGenerator(function*(K,U,X){var Z=k.getUrl(K);yield this.resourceManager.fetchResource(Z,X);X=this.resourceManager.getResource(Z);if(l.isNone(X))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${Z}.`);
if(X instanceof HTMLImageElement){Z=X.width;let aa=X.height;"esriPMS"===K.type&&(Z=Math.round(B(X.width,k.getPMSResourceSize(K))),aa=Math.round(Z/X.width*X.height));const {size:da,sdf:R,image:M}=this._rasterizer.rasterizeImageResource(Z,aa,X,"cim"in K?K.cim.colorSubstitutions:void 0);return this._addItemToMosaic(U,da,{type:"static",data:M},k.shouldRepeat(K),R,!1)}X=new g.AnimatableTextureResource(X,this._requestRender,K.animatedSymbolProperties||{},K.objectId);return this._addItemToMosaic(U,[X.width,
X.height],{type:"animated",data:X},k.shouldRepeat(K),!1,!1)});return function(K,U,X){return L.apply(this,arguments)}}();J._handleImage=function(){var L=q._asyncToGenerator(function*(K,U,X){if(k.isGIF(K)||k.isPNG(K))return this._handleGIFOrPNG(K,U,X);const Z=k.getUrl(K);try{let aa;const da=this.resourceManager.getResource(Z);if(l.isSome(da)&&da instanceof HTMLImageElement)aa=da;else{const {data:W}=yield this._imageRequestQueue.push(Z,{...X});aa=W}if(k.isSVGImage(Z))if("width"in K&&"height"in K)aa.width=
a.pt2px(K.width),aa.height=a.pt2px(K.height);else if("cim"in K){const W=K.cim;aa.width=a.pt2px(W.width??W.scaleX*W.size);aa.height=a.pt2px(W.size)}if(!aa.width||!aa.height)return null;let R=aa.width,M=aa.height;"esriPMS"===K.type&&(R=Math.round(B(aa.width,k.getPMSResourceSize(K))),M=Math.round(R/aa.width*aa.height));const {size:Q,sdf:N,image:S}=this._rasterizer.rasterizeImageResource(R,M,aa,"cim"in K?K.cim.colorSubstitutions:void 0);return this._addItemToMosaic(U,Q,{type:"static",data:S},k.shouldRepeat(K),
N,!1)}catch(aa){if(!c.isAbortError(aa))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${Z}. ${aa.message}`)}});return function(K,U,X){return L.apply(this,arguments)}}();J._addItemToMosaic=function(L,K,U,X,Z,aa,da){return this._spriteMosaic.addSpriteItem(L,K,U,X,Z,aa,da)};q._createClass(H,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return H}()})},"esri/core/BidiText":function(){define(["exports",
"./BidiEngine"],function(q,t){const E=new t;q.bidiText=function(C){if(!E.hasBidiChar(C))return[C,!1];let A;A="rtl"===E.checkContextual(C)?"IDNNN":"ICNNN";return[E.bidiTransform(C,A,"VLYSN"),!0]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(q){function t(f,n,z,x,B){var D=f;void 0===n&&(n=B.defInFormat);void 0===z&&(z=B.defOutFormat);void 0===x&&(x=B.defSwap);if(n!==z){var F=n.substring(0,
1),G=z.substring(0,1);var H=n.substring(1,4);var J=z.substring(1,4);"C"===H.charAt(0)&&(H=E(D),H="ltr"===H||"rtl"===H?H.toUpperCase():"L"===n.charAt(2)?"LTR":"RTL",n=F+H);"C"===J.charAt(0)&&(H=E(D),"rtl"===H?J="RTL":"ltr"===H?(D=D.split(""),D.reverse(),H=E(D.join("")),J=H.toUpperCase()):J="L"===z.charAt(2)?"LTR":"RTL",z=G+J)}if(n===z)return f;G=n.substring(0,1);D=n.substring(1,4);F=z.substring(0,1);J=z.substring(1,4);B.inFormat=n;B.outFormat=z;B.swap=x;if("L"===G&&"VLTR"===z){if("LTR"===D)return B.dir=
0,C(f,B);if("RTL"===D)return B.dir=1,C(f,B)}if("V"===G&&"V"===F)return B.dir="RTL"===D?1:0,y(f,B);if("L"===G&&"VRTL"===z)return B.dir="LTR"===D?0:1,f=C(f,B),y(f);if("VLTR"===n&&"LLTR"===z)return B.dir=0,C(f,B);if("V"===G&&"L"===F&&D!==J)return f=y(f),"RTL"===D?t(f,"LLTR","VLTR",x,B):t(f,"LRTL","VRTL",x,B);if("VRTL"===n&&"LRTL"===z)return t(f,"LRTL","VRTL",x,B);"L"===G&&"L"===F&&(n=B.swap,B.swap=n.substr(0,1)+"N","RTL"===D?(B.dir=1,f=C(f,B),B.swap="N"+n.substr(1,2),B.dir=0,f=C(f,B)):(B.dir=0,f=C(f,
B),B.swap="N"+n.substr(1,2),f=t(f,"VLTR","LRTL",B.swap,B)));return f}function E(f){return(f=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(f))?"z">=f[0]?"ltr":"rtl":""}function C(f,n){f=f.split("");const z=[];A(f,z,n);if(0!==n.hiLevel&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let D=0;D<f.length;D++)if(1===z[D]){var x=D;b:{let F=void 0;var B=f[D];let G=0,H=q.SwapTable.length-1;for(;G<=H;)if(F=Math.floor((G+H)/2),B<q.SwapTable[F][0])H=F-1;else if(B>q.SwapTable[F][0])G=
F+1;else{B=q.SwapTable[F][1];break b}}f[x]=B}c(2,f,z,n);c(1,f,z,n);w=z;return f.join("")}function A(f,n,z){const x=f.length;var B=z.dir?q.impTabRtl:q.impTabLtr,D=0,F=-1;const G=[],H=[];z.hiLevel=z.dir;z.lastArabic=!1;z.hasUbatAl=!1;z.hasUbatB=!1;z.hasUbatS=!1;for(var J=0;J<x;J++){var L=J,K=f[J].charCodeAt(0);const U=q.PrimaryTable[K>>8];G[L]=U<q.TBBASE?U:q.UnicodeTable[U-q.TBBASE][K&255]}for(L=0;L<x;L++){J=a(f,G,H,L,z);H[L]=J;D=B[D][J];K=D&240;D&=15;J=B[D][5];n[L]=J;if(0<K){if(16===K)for(;F<L;F++)n[F]=
1;F=-1}if(B[D][6])-1===F&&(F=L);else if(-1<F){for(;F<L;F++)n[F]=J;F=-1}G[L]===q.UBAT_B&&(n[L]=0);z.hiLevel|=J}if(z.hasUbatS)for(f=0;f<x;f++)if(G[f]===q.UBAT_S)for(n[f]=z.dir,B=f-1;0<=B;B--)if(G[B]===q.UBAT_WS)n[B]=z.dir;else break}function y(f,n){f=f.split("");if(n){const z=[];A(f,z,n);w=z}f.reverse();v.reverse();return f.join("")}function m(f){for(let n=0;n<q.ArabicAlefBetIntervalsBegine.length;n++)if(f>=q.ArabicAlefBetIntervalsBegine[n]&&f<=q.ArabicAlefBetIntervalsEnd[n])return!0;return!1}function l(f,
n,z,x){for(;n*z<x&&d(f[n]);)n+=z;return n*z<x&&m(f[n])?!0:!1}function c(f,n,z,x){if(!(x.hiLevel<f))if(1!==f||1!==x.dir||x.hasUbatB){x=n.length;for(var B=0,D,F,G;B<x;){if(z[B]>=f){for(D=B+1;D<x&&z[D]>=f;)D++;for(F=D-1;B<F;B++,F--)G=n[B],n[B]=n[F],n[F]=G,G=v[B],v[B]=v[F],v[F]=G;B=D}B++}}else n.reverse(),v.reverse()}function a(f,n,z,x,B){return{UBAT_L:()=>{B.lastArabic=!1;return q.UBAT_L},UBAT_R:()=>{B.lastArabic=!1;return q.UBAT_R},UBAT_ON:()=>q.UBAT_ON,UBAT_AN:()=>q.UBAT_AN,UBAT_EN:()=>B.lastArabic?
q.UBAT_AN:q.UBAT_EN,UBAT_AL:()=>{B.lastArabic=!0;B.hasUbatAl=!0;return q.UBAT_R},UBAT_WS:()=>q.UBAT_ON,UBAT_CS:()=>{let D,F;if(1>x||x+1>=n.length||(D=z[x-1])!==q.UBAT_EN&&D!==q.UBAT_AN||(F=n[x+1])!==q.UBAT_EN&&F!==q.UBAT_AN)return q.UBAT_ON;B.lastArabic&&(F=q.UBAT_AN);return F===D?F:q.UBAT_ON},UBAT_ES:()=>(0<x?z[x-1]:q.UBAT_B)===q.UBAT_EN&&x+1<n.length&&n[x+1]===q.UBAT_EN?q.UBAT_EN:q.UBAT_ON,UBAT_ET:()=>{if(0<x&&z[x-1]===q.UBAT_EN)return q.UBAT_EN;if(B.lastArabic)return q.UBAT_ON;let D=x+1;const F=
n.length;for(;D<F&&n[D]===q.UBAT_ET;)D++;return D<F&&n[D]===q.UBAT_EN?q.UBAT_EN:q.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===B.inFormat){for(var D=n.length,F=x+1;F<D&&n[F]===q.UBAT_NSM;)F++;if(F<D&&(D=f[x].charCodeAt[0],F=n[F],(1425<=D&&2303>=D||64286===D)&&(F===q.UBAT_R||F===q.UBAT_AL)))return q.UBAT_R}return 1>x||n[x-1]===q.UBAT_B?q.UBAT_ON:z[x-1]},UBAT_B:()=>{B.lastArabic=!0;B.hasUbatB=!0;return B.dir},UBAT_S:()=>{B.hasUbatS=!0;return q.UBAT_ON},UBAT_LRE:()=>{B.lastArabic=!1;return q.UBAT_ON},UBAT_RLE:()=>
{B.lastArabic=!1;return q.UBAT_ON},UBAT_LRO:()=>{B.lastArabic=!1;return q.UBAT_ON},UBAT_RLO:()=>{B.lastArabic=!1;return q.UBAT_ON},UBAT_PDF:()=>{B.lastArabic=!1;return q.UBAT_ON},UBAT_BN:()=>q.UBAT_ON}[q.TYPES_NAMES[n[x]]]()}function b(f,n){for(let z=0;z<q.BaseForm.length;z++)if(f===q.BaseForm[z])return n[z];return f}function d(f){return"\u064b"<=f&&"\u0655">=f?!0:!1}function e(f){return"L"===f?"LTR":"R"===f?"RTL":"C"===f?"CLR":"D"===f?"CRL":""}function p(f,n){for(let z=0;z<q.AlefTable.length;z++)if(f===
q.AlefTable[z])return n[z];return f}function r(f,n,z,x){for(let B=0;B<f.length;B++)if(f[B]>n||!z&&f[B]===n)f[B]+=x}let v=[],h=[],w=[];const u={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},k=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,g=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function f(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=
[];this.targetToSource=[];this.levels=[]}var n=f.prototype;n.bidiTransform=function(z,x,B){this.sourceToTarget=[];this.targetToSource=[];if(!z)return"";var D=this.sourceToTarget,F=this.targetToSource,G=z.length;v=[];w=[];for(var H=0;H<G;H++)D[H]=H,F[H]=H,v[H]=H;if(!this.checkParameters(x,B))return z;x=this.inputFormat;B=this.outputFormat;D=z;G=e(x.charAt(1));D=e(B.charAt(1));H="I"===x.charAt(0)?"L":x.charAt(0);F="I"===B.charAt(0)?"L":B.charAt(0);G=H+G;D=F+D;F=x.charAt(2)+B.charAt(2);u.defInFormat=
G;u.defOutFormat=D;u.defSwap=F;z=t(z,G,D,F,u);D=!1;if("R"===B.charAt(1))D=!0;else if("C"===B.charAt(1)||"D"===B.charAt(1))D="rtl"===this.checkContextual(z);F=this.sourceToTarget=v;G=Array(F.length);for(H=0;H<F.length;H++)G[F[H]]=H;h=this.targetToSource=G;if(x.charAt(3)===B.charAt(3))D=z;else if("S"===B.charAt(3))if(x=D,B=!0,0===z.length)D="";else{void 0===x&&(x=!0);void 0===B&&(B=!0);z=String(z);z=z.split("");G=0;D=1;F=z.length;x||(G=z.length-1,D=-1,F=1);var J=G;G=B;var L=0;H=[];for(var K=0;J*D<F;J+=
D)if(m(z[J])||d(z[J])){var U;if(U="\u0644"===z[J])b:{for(var X=z,Z=J+D,aa=D,da=F;Z*aa<da&&d(X[Z]);)Z+=aa;U=" ";if(Z*aa<da)for(U=X[Z],X=0;X<q.AlefTable.length;X++)if(q.AlefTable[X]===U){U=!0;break b}U=!1}if(U){z[J]=0===L?p(z[J+D],q.LamAlefInialTableFE):p(z[J+D],q.LamAlefMedialTableFE);J+=D;L=z;U=J;X=D;for(Z=F;U*X<Z&&d(L[U]);)U+=X;U*X<Z&&(L[U]=" ");G&&(H[K]=J,K++);L=0}else{U=z[J];if(1===L){X=J;if(l(z,J+D,D,F))b:for(Z=z[J],aa=0;aa<q.BaseForm.length;aa++){if(Z===q.BaseForm[aa]){Z=q.MedialForm[aa];break b}}else Z=
b(z[J],q.FinalForm);z[X]=Z}else!0===l(z,J+D,D,F)?z[J]=b(z[J],q.InitialForm):z[J]=b(z[J],q.IsolatedForm);d(U)||(L=1);b:{for(X=0;X<q.StandAlonForm.length;X++)if(q.StandAlonForm[X]===U){U=!0;break b}U=!1}!0===U&&(L=0)}}else L=0;D=H;F="";for(G=0;G<z.length;G++){if(H=B){b:{for(H=0;H<D.length;H++)if(D[H]===G)break b;H=-1}H=-1<H}H?(r(h,G,!x,-1),v.splice(G,1)):F+=z[G]}D=F}else if(x=z,B=D,z=!0,0===x.length)D="";else for(void 0===z&&(z=!0),void 0===B&&(B=!0),x=String(x),D="",F=x.split(""),G=0;G<x.length;G++)H=
!1,"\ufe70"<=F[G]&&"\ufeff">F[G]?(K=x.charCodeAt(G),"\ufef5"<=F[G]&&"\ufefc">=F[G]?(B?(0<G&&z&&" "===F[G-1]?D=D.substring(0,D.length-1)+"\u0644":(D+="\u0644",H=!0),D+=q.AlefTable[(K-65269)/2]):(D+=q.AlefTable[(K-65269)/2],D+="\u0644",G+1<x.length&&z&&" "===F[G+1]?G++:H=!0),H&&(r(h,G,!0,1),v.splice(G,0,v[G]))):D+=q.FETo06Table[K-65136]):D+=F[G];this.sourceToTarget=v;this.targetToSource=h;this.levels=w;return D};n._inputFormatSetter=function(z){if(!k.test(z))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=z};n._outputFormatSetter=function(z){if(!k.test(z))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=z};n.checkParameters=function(z,x){z?this._inputFormatSetter(z):z=this.inputFormat;x?this._outputFormatSetter(x):x=this.outputFormat;return z===x?!1:!0};n.checkContextual=function(z){z=E(z);if("ltr"!==z&&"rtl"!==z){try{z=document.dir.toLowerCase()}catch(x){}"ltr"!==z&&"rtl"!==z&&(z="ltr")}return z};n.hasBidiChar=function(z){return g.test(z)};
return f}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(q){q.AlefTable=["\u0622","\u0623","\u0625","\u0627"];q.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];q.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];q.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
q.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
q.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");q.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
q.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");q.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];q.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];q.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
q.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];q.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");q.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];q.TBBASE=100;q.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");q.UBAT_AL=7;q.UBAT_AN=3;q.UBAT_B=5;q.UBAT_BN=18;q.UBAT_CS=9;q.UBAT_EN=2;q.UBAT_ES=10;q.UBAT_ET=11;q.UBAT_L=0;q.UBAT_LRE=13;q.UBAT_LRO=16;q.UBAT_NSM=12;q.UBAT_ON=
4;q.UBAT_PDF=15;q.UBAT_R=1;q.UBAT_RLE=14;q.UBAT_RLO=17;q.UBAT_S=6;q.UBAT_WS=8;q.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];q.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];q.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/fontUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../config"],function(q,t,E){function C(){C=t._asyncToGenerator(function*(l){const c=y(l);
let a=m.get(c);if(a)return a;l=new FontFace(l.family,`url('${E.fontsUrl}/woff2/${c}.${"woff2"}') format('${"woff2"}')`);const b=document.fonts;if(b.has(l)&&"loading"===l.status)return l.loaded;a=l.load();m.set(c,a);b.add(l);return a});return C.apply(this,arguments)}function A(l){if(!l)return"arial-unicode-ms";l=l.toLowerCase().split(" ").join("-");switch(l){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";
case "cursive":return"redressed";default:return l}}function y(l){a:{if(l.weight)switch(l.weight.toLowerCase()){case "bold":case "bolder":var c="-bold";break a}c=""}a:{if(l.style)switch(l.style.toLowerCase()){case "italic":case "oblique":var a="-italic";break a}a=""}c+=a;return A(l.family)+(0<c.length?c:"-regular")}const m=new Map;q.getFontDecorationTop=function(l){switch(l){case "underline":return-26;case "line-through":return-18}return NaN};q.getFontFamily=A;q.getFullyQualifiedFontName=y;q.loadFont=
function(l){return C.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rasterizer":function(){define("../../core/mathUtils ./CIMSymbolHelper ./rasterizingUtils ./Rect ./SDFHelper ./utils".split(" "),function(q,t,E,C,A,y){return function(){function m(c){this._resourceManager=c}var l=m.prototype;l.dispose=function(){this._rasterizationCanvas=null};l.rasterizeJSONResource=function(c,a,b){this._rasterizationCanvas||(this._rasterizationCanvas=
document.createElement("canvas"));if("simple-fill"===c.type||"esriSFS"===c.type){const [k,g,f]=E.rasterizeSimpleFill(this._rasterizationCanvas,c.style,a);return{size:[g,f],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:q.nextPowerOfTwo(Math.ceil(a))}}if("simple-line"===c.type||"esriSLS"===c.type||"line"===c.type&&c.dashTemplate){if("simple-line"===c.type||"esriSLS"===c.type)switch(a=t.slsDashToTemplateArray(c.style,c.cap),c.cap){case "butt":c="Butt";
break;case "square":c="Square";break;default:c="Round"}else a=c.dashTemplate,c=c.cim.capStyle;const [k,g,f]=E.rasterizeDash(a,c);return{size:[g,f],image:new Uint32Array(k.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let d,e,p=1;"simple-marker"===c.type||"esriSMS"===c.type||"line-marker"===c.type?(c=t.CIMSymbolHelper.fromSimpleMarker(c),e=A.getSDFInfo(c)):c.cim&&"CIMHatchFill"===c.cim.type?(c=t.CIMSymbolHelper.fromCIMHatchFill(c.cim,a),d=new C(c.frame.xmin,-c.frame.ymax,c.frame.xmax-c.frame.xmin,
c.frame.ymax-c.frame.ymin),p=a):c.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===c.cim.markerPlacement.type?(c=t.CIMSymbolHelper.fromCIMInsidePolygon(c.cim),d=new C(c.frame.xmin,-c.frame.ymax,c.frame.xmax-c.frame.xmin,c.frame.ymax-c.frame.ymin)):(c=c.cim,e=A.getSDFInfo(c));if(e&&!b){const [k,g,f]=A.buildSDF(e);return k?{size:[g,f],image:new Uint32Array(k.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:p}:null}const [r,v,h,w,u]=t.CIMSymbolHelper.rasterize(this._rasterizationCanvas,
c,d,this._resourceManager,!b);return r?{size:[v,h],image:new Uint32Array(r.buffer),sdf:!1,simplePattern:!1,anchorX:w,anchorY:u}:null};l.rasterizeImageResource=function(c,a,b,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=c;this._rasterizationCanvas.height=a;var e=this._rasterizationCanvas.getContext("2d");b instanceof ImageData?e.putImageData(b,0,0):(b.setAttribute("width",`${c}px`),b.setAttribute("height",`${a}px`),e.drawImage(b,
0,0,c,a));b=e.getImageData(0,0,c,a);b=new Uint8Array(b.data);if(d)for(var p of d)if(p&&p.oldColor&&4===p.oldColor.length&&p.newColor&&4===p.newColor.length){const [r,v,h,w]=p.oldColor,[u,k,g,f]=p.newColor;if(r!==u||v!==k||h!==g||w!==f)for(d=0;d<b.length;d+=4)r===b[d]&&v===b[d+1]&&h===b[d+2]&&w===b[d+3]&&(b[d]=u,b[d+1]=k,b[d+2]=g,b[d+3]=f)}for(d=0;d<b.length;d+=4)p=b[d+3]/255,b[d]*=p,b[d+1]*=p,b[d+2]*=p;e=b;p=c;d=a;if(512<=p||512<=d){e=p/d;1<e?(p=512,d=Math.round(512/e)):(d=512,p=Math.round(512*e));
e=new Uint8Array(4*p*d);const r=new Uint8ClampedArray(e.buffer);y.resampleHermite(b,c,a,r,p,d,!1)}return{size:[p,d],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return m}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k){function g(Q,N,S){switch(N.type){case "CIMSymbolReference":return g(Q,N.symbol,S);case "CIMPointSymbol":null==S&&(S={x:0,y:0});Q.drawSymbol(N,S);break;case "CIMLineSymbol":null==S&&(S={paths:[[[0,0],[10,0]]]});Q.drawSymbol(N,S);break;case "CIMPolygonSymbol":null==S&&(S={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});Q.drawSymbol(N,S);break;case "CIMTextSymbol":Q.drawSymbol(N,{x:0,y:0});break;case "CIMVectorMarker":S=new e.Placement,Q.drawMarker(N,S)}return Q.envelope()}
function f(Q){if(!Q)return 0;switch(Q.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(Q.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(Q.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(Q.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(Q.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(Q.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(Q.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(Q.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function n(Q){if(!Q)return 0;switch(Q.type){case "CIMGeometricEffectArrow":return Math.abs(.5*Q.width);case "CIMGeometricEffectBuffer":return Math.abs(Q.size);case "CIMGeometricEffectExtension":return Math.abs(Q.length);case "CIMGeometricEffectJog":return Math.abs(.5*Q.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(v.getValue(Q.offsetX)),Math.abs(v.getValue(Q.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(Q.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(Q.offset);case "CIMGeometricEffectRadial":return Math.abs(Q.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(Q.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(Q.fromWidth),Math.abs(Q.toWidth));case "CIMGeometricEffectWave":return Math.abs(Q.amplitude);default:return 0}}function z(Q){if(!Q)return 0;let N=0;for(const S of Q)N+=
n(S);return N}function x(Q,N,S){Q.effects&&!m.isSome(N.geometryEngine)&&(M?S.push(M):v.isGeometryEngineRequired(Q.effects)&&(M=v.importGeometryEngine(),S.push(M),M.then(W=>N.geometryEngine=W)))}const B=Math.PI,D=B/2,F=96/72,G=Math.PI/180,H=y.getLogger("esri.symbols.cim.CIMSymbolHelper");y=function(){function Q(){}var N=Q.prototype;N.getSymbolInflateSize=function(S,W,T,ba,I){S||(S=[0,0,0,0]);return W?this._getInflateSize(S,W,T,ba,I):S};Q.safeSize=function(S){const W=Math.max(Math.abs(S[0]),Math.abs(S[2]));
S=Math.max(Math.abs(S[1]),Math.abs(S[3]));return Math.sqrt(W*W+S*S)};N._vectorMarkerBounds=function(S,W,T,ba){let I=!0;const P=a.create();if(W&&W.markerGraphics)for(const O of W.markerGraphics)W=[0,0,0,0],O.geometry&&(b.getBoundsXY(P,O.geometry),W[0]=0,W[1]=0,W[2]=0,W[3]=0,this.getSymbolInflateSize(W,O.symbol,T,0,ba),P[0]+=W[0],P[1]+=W[1],P[2]+=W[2],P[3]+=W[3],I?(S[0]=P[0],S[1]=P[1],S[2]=P[2],S[3]=P[3],I=!1):(S[0]=Math.min(S[0],P[0]),S[1]=Math.min(S[1],P[1]),S[2]=Math.max(S[2],P[2]),S[3]=Math.max(S[3],
P[3])));return S};N._getInflateSize=function(S,W,T,ba,I){return void 0!==W.symbolLayers?(S=this._getLayersInflateSize(S,W.symbolLayers,T,ba,I),W=z(W.effects),0<W&&(S[0]-=W,S[1]-=W,S[2]+=W,S[3]+=W),S):this._getTextInflatedSize(S,W,I)};N._getLayersInflateSize=function(S,W,T,ba,I){let P=!0;if(!W)return S;for(const fa of W)if(fa){var O=[0,0,0,0];switch(fa.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":W=fa;var V=W.width;V=W.capStyle===r.LineCapStyle.Square||W.joinStyle===
r.LineJoinStyle.Miter?V/1.4142135623730951:V/2;O[0]=-V;O[1]=-V;O[2]=V;O[3]=V;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":W=fa;if("CIMVectorMarker"===fa.type){if(V=fa,O=this._vectorMarkerBounds(O,V,T,I),V.frame){var Y=(V.frame.xmin+V.frame.xmax)/2,ca=(V.frame.ymin+V.frame.ymax)/2;O[0]-=Y;O[1]-=ca;O[2]-=Y;O[3]-=ca;V=V.size/(V.frame.ymax-V.frame.ymin);O[0]*=V;O[1]*=V;O[2]*=V;O[3]*=V}}else"CIMPictureMarker"===fa.type?(O=fa,Y=T.getResource(O.url),V=1,m.isSome(Y)&&Y.height&&
(V=Y.width/Y.height),Y=W.size/2,O=W.size*V*O.scaleX/2,O=[-O,-Y,O,Y]):(O=W.size/2,O=[-O,-O,O,O]);W.anchorPoint&&("Absolute"===W.anchorPointUnits?(V=W.anchorPoint.x,Y=W.anchorPoint.y):(V=W.anchorPoint.x*(O[2]-O[0]),Y=W.anchorPoint.y*(O[3]-O[1])),O[0]-=V,O[1]-=Y,O[2]-=V,O[3]-=Y);V=v.getValue(W.rotation);W.rotateClockwise&&(V=-V);ba&&(V-=ba);V&&(Y=G*V,V=Math.cos(Y),Y=Math.sin(Y),ca=a.create([w.C_INFINITY,w.C_INFINITY,-w.C_INFINITY,-w.C_INFINITY]),a.expandPointInPlace(ca,[O[0]*V-O[1]*Y,O[0]*Y+O[1]*V]),
a.expandPointInPlace(ca,[O[0]*V-O[3]*Y,O[0]*Y+O[3]*V]),a.expandPointInPlace(ca,[O[2]*V-O[1]*Y,O[2]*Y+O[1]*V]),a.expandPointInPlace(ca,[O[2]*V-O[3]*Y,O[2]*Y+O[3]*V]),O=ca);V=v.getValue(W.offsetX);Y=v.getValue(W.offsetY);if(ba){var ea=G*ba;ca=Math.cos(ea);ea=Math.sin(ea);const ha=V*ea+Y*ca;V=V*ca-Y*ea;Y=ha}O[0]+=V;O[1]+=Y;O[2]+=V;O[3]+=Y;W=f(W.markerPlacement);0<W&&(O[0]-=W,O[1]-=W,O[2]+=W,O[3]+=W)}W=z(fa.effects);0<W&&(O[0]-=W,O[1]-=W,O[2]+=W,O[3]+=W);P?(S[0]=O[0],S[1]=O[1],S[2]=O[2],S[3]=O[3],P=!1):
(S[0]=Math.min(S[0],O[0]),S[1]=Math.min(S[1],O[1]),S[2]=Math.max(S[2],O[2]),S[3]=Math.max(S[3],O[3]))}return S};N._getTextInflatedSize=function(S,W,T){const ba=W.height??10;S[0]=-ba/2;S[1]=-ba/2;S[2]=ba/2;S[3]=ba/2;if(!T)return S;T=T.get(W);if(!T)return S;const {text:I,mosaicItem:P}=T;if(!P||0===P.glyphMosaicItems.length)return S;T=p.lineGapType2LineHeight(W.lineGapType,W.lineGap??0,ba);const O=C.bidiText(I)[1];W=k.shapeGlyphs(P.glyphMosaicItems,O,{scale:ba/u.GLYPH_SIZE,angle:v.getValue(W.angle),
xOffset:v.getValue(W.offsetX),yOffset:v.getValue(W.offsetY),hAlign:p.horizontalAlignment2HAlign(W.horizontalAlignment),vAlign:p.verticalAlignment2VAlign(W.verticalAlignment),maxLineWidth:512,lineHeight:u.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(T||1,4)),decoration:W.font.decoration||"none",isCIM:!0}).boundsT;S[0]=W.x-W.halfWidth;S[1]=-W.y-W.halfHeight;S[2]=W.x+W.halfWidth;S[3]=-W.y+W.halfHeight;return S};return Q}();let J=function(){function Q(){}Q.getEnvelope=function(N,S,W){W=new p.EnvDrawHelper(W);
if(Array.isArray(N)){let T;for(const ba of N)T?T.union(g(W,ba,S)):T=g(W,ba,S);return T}return g(W,N,S)};Q.getTextureAnchor=function(N,S){N=this.getEnvelope(N,null,S);if(!N)return[0,0,0];S=N.height*F+2;return[-((N.x+.5*N.width)*F)/(N.width*F+2),-((N.y+.5*N.height)*F)/S,S]};Q.rasterize=function(N,S,W,T,ba=!0){var I=W||this.getEnvelope(S,null,T);if(!I)return[null,0,0,0,0];const P=(I.x+.5*I.width)*F,O=(I.y+.5*I.height)*F;N.width=I.width*F;N.height=I.height*F;W||(N.width+=2,N.height+=2);W=N.getContext("2d");
I=p.Transformation.createScale(F,-F);I.translate(.5*N.width-P,.5*N.height+O);T=new p.CanvasDrawHelper(W,T,I);switch(S.type){case "CIMPointSymbol":T.drawSymbol(S,{type:"point",x:0,y:0});break;case "CIMVectorMarker":I=new e.Placement,T.drawMarker(S,I)}S=W.getImageData(0,0,N.width,N.height);S=new Uint8Array(S.data);if(ba)for(T=0;T<S.length;T+=4)ba=S[T+3]/255,S[T]*=ba,S[T+1]*=ba,S[T+2]*=ba;return[S,N.width,N.height,-P/N.width,-O/N.height]};Q.fromTextSymbol=function(N){const {angle:S,color:W,font:T,haloColor:ba,
haloSize:I,horizontalAlignment:P,kerning:O,text:V,verticalAlignment:Y,xoffset:ca,yoffset:ea}=N;let fa,ha;if(T){var ia=T.family;var la=T.style;var ka=T.weight;fa=T.size;ha=T.decoration}N=!1;V&&(N=C.bidiText(V)[1]);var ja=r.BlockProgression.BTT,ma=r.FontEffects.Normal,na=r.FontEncoding.Unicode;ia=ia||"Arial";b:{if(ka)switch(ka.toLowerCase()){case "bold":case "bolder":ka="bold";break b}ka=""}b:{if(la)switch(la.toLowerCase()){case "italic":case "oblique":la="italic";break b}la=""}ka=ka&&la?`${ka}-${la}`:
`${ka}${la}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:S,blockProgression:ja,depth3D:1,extrapolateBaselines:!0,fontEffects:ma,fontEncoding:na,fontFamilyName:ia,fontStyleName:ka,fontType:r.FontType.Unspecified,haloSize:I,height:fa,hinting:r.GlyphHinting.Default,
horizontalAlignment:X(P??"center"),kerning:O,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:v.getValue(ca),offsetY:v.getValue(ea),strikethrough:"line-through"===ha,underline:"underline"===ha,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:aa(W)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:aa(ba)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:N?r.TextReadingDirection.RTL:
r.TextReadingDirection.LTR,verticalAlignment:Z(Y??"baseline"),verticalGlyphOrientation:r.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:r.BillBoardMode.FaceNearPlane},textString:V}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};Q.fromPictureFillSymbol=function(N){const {height:S,outline:W,width:T,xoffset:ba,xscale:I,yoffset:P,yscale:O}=N,V=[],Y={type:"CIMPolygonSymbol",symbolLayers:V};if(W){const {cap:ea,join:fa,miterLimit:ha,width:ia}=W;V.push({type:"CIMSolidStroke",
color:aa(W.color),capStyle:K(ea),joinStyle:U(fa),miterLimit:ha,width:ia})}let ca=N.url;"esriPFS"===N.type&&N.imageData&&(ca=N.imageData);N="angle"in N?N.angle:0;V.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.TextureFilter.Picture,tintColor:null,url:ca,height:S*(O||1),width:T*(I||1),offsetX:v.getValue(ba),offsetY:v.getValue(P),rotation:v.getValue(-N),colorSubstitutions:null});return Y};Q.fromSimpleFillSymbol=function(N){const {color:S,style:W,outline:T}=N;N=[];const ba=
{type:"CIMPolygonSymbol",symbolLayers:N};var I=null;if(T){const {cap:P,join:O,style:V}=T;"solid"!==V&&"none"!==V&&"esriSLSSolid"!==V&&"esriSLSNull"!==V&&(I=[{type:"CIMGeometricEffectDashes",dashTemplate:da(V,P),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);N.push({type:"CIMSolidStroke",color:aa(T.color),capStyle:K(P),joinStyle:U(O),miterLimit:T.miterLimit,width:T.width,effects:I})}if(W&&"solid"!==W&&"none"!==W&&"esriSFSSolid"!==W&&"esriSFSNull"!==W){I={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",
color:aa(S),capStyle:r.LineCapStyle.Butt,joinStyle:r.LineJoinStyle.Miter,width:.75}]};let P=0;const O=c.px2pt("vertical"===W||"horizontal"===W||"cross"===W||"esriSFSCross"===W||"esriSFSVertical"===W||"esriSFSHorizontal"===W?8:10);switch(W){case "vertical":case "esriSFSVertical":P=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":P=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":P=45;break;case "cross":case "esriSFSCross":P=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":P=
-45}N.push({type:"CIMHatchFill",lineSymbol:I,offsetX:0,offsetY:0,rotation:P,separation:O});"cross"===W||"esriSFSCross"===W?N.push({type:"CIMHatchFill",lineSymbol:A.clone(I),offsetX:0,offsetY:0,rotation:90,separation:O}):("diagonal-cross"===W||"esriSFSDiagonalCross"===W)&&N.push({type:"CIMHatchFill",lineSymbol:A.clone(I),offsetX:0,offsetY:0,rotation:45,separation:O})}else!W||"solid"!==W&&"esriSFSSolid"!==W||N.push({type:"CIMSolidFill",enable:!0,color:aa(S)});return ba};Q.fromSimpleLineSymbol=function(N){const {cap:S,
color:W,join:T,marker:ba,miterLimit:I,style:P,width:O}=N;N=null;"solid"!==P&&"none"!==P&&"esriSLSSolid"!==P&&"esriSLSNull"!==P&&(N=[{type:"CIMGeometricEffectDashes",dashTemplate:da(P,S),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const V=[];if(ba){let Y;switch(ba.placement){case "begin-end":Y=r.ExtremityPlacement.Both;break;case "begin":Y=r.ExtremityPlacement.JustBegin;break;case "end":Y=r.ExtremityPlacement.JustEnd;break;default:Y=r.ExtremityPlacement.None}const ca=Q.fromSimpleMarker(ba,
O,W).symbolLayers[0];ca.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:Y,offsetAlongLine:0};V.push(ca)}"none"!==P&&"esriSLSNull"!==P&&V.push({type:"CIMSolidStroke",color:aa(W),capStyle:K(S),joinStyle:U(T),miterLimit:I,width:O,effects:N});return{type:"CIMLineSymbol",symbolLayers:V}};Q.fromPictureMarker=function(N){const {angle:S,height:W,width:T,xoffset:ba,yoffset:I}=N;let P=N.url;"esriPMS"===N.type&&N.imageData&&(P=N.imageData);return{type:"CIMPointSymbol",
symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.TextureFilter.Picture,tintColor:null,url:P,size:W,width:T,offsetX:v.getValue(ba),offsetY:v.getValue(I),rotation:v.getValue(-S)}]}};Q.fromSimpleMarker=function(N,S,W){var {style:T}=N;W=N.color??W;if("path"===T){S=[];"outline"in N&&N.outline&&(T=N.outline,S.push({type:"CIMSolidStroke",enable:!0,width:c.pt2px(Math.round(c.px2pt(T.width))),color:aa(T.color)}));S.push({type:"CIMSolidFill",enable:!0,color:aa(W),path:N.path});
const [O,V]=R("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:v.getValue(-N.angle),size:v.getValue(N.size||6),offsetX:v.getValue(N.xoffset),offsetY:v.getValue(N.yoffset),frame:O,markerGraphics:[{type:"CIMMarkerGraphic",geometry:V,symbol:{type:"CIMPolygonSymbol",symbolLayers:S}}]}]}}const [ba,I]=R(T);if(I&&ba){T=[];if("outline"in N&&N.outline){var P=N.outline;T.push({type:"CIMSolidStroke",enable:!0,width:.667<P.width?c.pt2px(Math.round(c.px2pt(P.width))):
P.width,color:aa(P.color)})}else!S||"line-marker"!==N.type||"cross"!==N.style&&"x"!==N.style||T.push({type:"CIMSolidStroke",enable:!0,width:S,color:aa(W)});T.push({type:"CIMSolidFill",enable:!0,color:aa(W)});W={type:"CIMPolygonSymbol",symbolLayers:T};P={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:v.getValue(-N.angle),size:v.getValue(N.size||6*S),offsetX:v.getValue(N.xoffset),offsetY:v.getValue(N.yoffset),frame:ba,markerGraphics:[{type:"CIMMarkerGraphic",geometry:I,
symbol:W}]}]}}return P};Q.fromCIMHatchFill=function(N,S){const W=S*(N.separation??4);var T=W/2;N=A.clone(N.lineSymbol);for(var ba=this._getLineSymbolPeriod(N)||4;4>ba;)ba*=2;ba/=2;T={xmin:-ba,xmax:ba,ymin:-T,ymax:T};const I=N.symbolLayers.find(P=>"CIMSolidStroke"===P.type);I&&(I.width*=S);return{type:"CIMVectorMarker",frame:T,markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-ba,0],[ba,0]]]},symbol:N}],size:W}};Q.fetchResources=function(N,S,W){if(N&&S)switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N=
N.symbolLayers)for(const T of N)switch(x(T,S,W),T.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in T&&T.url&&W.push(S.fetchResource(T.url,null));break;case "CIMVectorMarker":if(N=T.markerGraphics)for(const ba of N)ba&&(N=ba.symbol)&&Q.fetchResources(N,S,W)}}};Q._getLineSymbolPeriod=function(N){if(N){const S=this._getEffectsRepeat(N.effects);if(S)return S;if(N.symbolLayers)for(const W of N.symbolLayers)if(W){if(N=
this._getEffectsRepeat(W.effects))return N;switch(W.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(N=this._getPlacementRepeat(W.markerPlacement))return N}}}return 0};Q._getEffectsRepeat=function(N){if(N)for(var S of N)if(S)switch(S.type){case "CIMGeometricEffectDashes":if((N=S.dashTemplate)&&N.length){S=0;for(const W of N)S+=W;N.length&1&&(S*=2);return S}break;case "CIMGeometricEffectWave":return S.period;default:H.error(`unsupported geometric effect type ${S.type}`)}return 0};
Q._getPlacementRepeat=function(N){if(N)switch(N.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((N=N.placementTemplate)&&N.length){let S=0;for(const W of N)S+=W;N.length&1&&(S*=2);return S}}return 0};Q.fromCIMInsidePolygon=function(N){var S=N.markerPlacement;const W={type:N.type,...N,markerPlacement:null,anchorPoint:null};N=Math.abs(S.stepX);const T=Math.abs(S.stepY);var ba=(S.randomness??100)/100;let I,
P;if("Random"===S.gridType){var O=c.px2pt(u.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const V=Math.max(Math.floor(O/N),1),Y=Math.max(Math.floor(O/T),1);O=V*N/2;I=Y*T/2;P=2*I;S=new l(S.seed);const ca=ba*N/1.5,ea=ba*T/1.5;ba=[];for(let fa=0;fa<V;fa++)for(let ha=0;ha<Y;ha++){const ia=fa*N-O+ca*(.5-S.getFloat()),la=ha*T-I+ea*(.5-S.getFloat());ba.push({x:ia,y:la});0===fa&&ba.push({x:ia+2*O,y:la});0===ha&&ba.push({x:ia,y:la+2*I})}}else!0===S.shiftOddRows?(O=N/2,I=T,P=2*T,ba=[{x:-O,y:0},{x:O,y:0},{x:0,y:I},{x:0,
y:-I}]):(O=N/2,I=T/2,P=T,ba=[{x:-N,y:0},{x:0,y:-T},{x:-N,y:-T},{x:0,y:0},{x:N,y:0},{x:0,y:T},{x:N,y:T},{x:-N,y:T},{x:N,y:-T}]);N=ba.map(V=>({type:"CIMMarkerGraphic",geometry:V,symbol:{type:"CIMPointSymbol",symbolLayers:[W]}}));return{type:"CIMVectorMarker",frame:{xmin:-O,xmax:O,ymin:-I,ymax:I},markerGraphics:N,size:P}};Q.getSize=function(N){if(N)switch(N.type){case "CIMTextSymbol":return N.height;case "CIMPointSymbol":var S=0;if(N.symbolLayers)for(var W of N.symbolLayers)if(W)switch(W.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":N=
W.size,N>S&&(S=N)}return S;case "CIMLineSymbol":case "CIMPolygonSymbol":W=0;if(N.symbolLayers)for(S of N.symbolLayers)if(S)switch(S.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":N=S.width;N>W&&(W=N);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":v.isCIMMarkerStrokePlacement(S.markerPlacement)&&(N=S.size,N>W&&(W=N))}return W}};Q.getMarkerScaleRatio=function(N){if(N)switch(N.type){case "CIMVectorMarker":if(!1!==
N.scaleSymbolsProportionally&&N.frame)return N.size/(N.frame.ymax-N.frame.ymin)}return 1};return Q}(),L=function(){function Q(){}Q.findApplicableOverrides=function(N,S,W){if(N&&S){if(N.primitiveName){let T=!1;for(const ba of W)if(ba.primitiveName===N.primitiveName){T=!0;break}if(!T)for(const ba of S)ba.primitiveName===N.primitiveName&&W.push(ba)}switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N.effects)for(const T of N.effects)Q.findApplicableOverrides(T,S,W);
if(N.symbolLayers)for(const T of N.symbolLayers)Q.findApplicableOverrides(T,S,W);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(N.effects)for(const T of N.effects)Q.findApplicableOverrides(T,S,W);N.markerPlacement&&Q.findApplicableOverrides(N.markerPlacement,S,W);if("CIMVectorMarker"===N.type){if(N.markerGraphics)for(const T of N.markerGraphics)Q.findApplicableOverrides(T,
S,W),Q.findApplicableOverrides(T.symbol,S,W)}else"CIMCharacterMarker"===N.type?Q.findApplicableOverrides(N.symbol,S,W):"CIMHatchFill"===N.type?Q.findApplicableOverrides(N.lineSymbol,S,W):"CIMPictureMarker"===N.type&&Q.findApplicableOverrides(N.animatedSymbolProperties,S,W)}}};Q.findEffectOverrides=function(N,S,W){if(S&&N){var T=N.length;for(let ba=0;ba<T;ba++){const I=N[ba]?.primitiveName;if(I){let P=!1;for(const O of W)if(O.primitiveName===I){P=!0;break}if(!P)for(const O of S)O.primitiveName===I&&
W.push(O)}}}};Q.resolveSymbolOverrides=function(){var N=t._asyncToGenerator(function*(S,W,T,ba,I,P,O){if(!S||!S.symbol)return null;let {symbol:V,primitiveOverrides:Y}=S;S=!!Y;if(!S&&!ba)return V;V=A.clone(V);let ca=!0;W||(W={attributes:{}},ca=!1);S&&(ca||(Y=Y.filter(ea=>!ea.valueExpressionInfo?.expression.includes("$feature"))),O||(Y=Y.filter(ea=>!ea.valueExpressionInfo?.expression.includes("$view"))),0<Y.length&&(S=v.attributesToFields(W.attributes),yield Q.evaluateOverrides(Y,W,{spatialReference:T,
fields:S,geometryType:I},P,O)),Q.applyOverrides(V,Y));ba&&Q.applyDictionaryTextOverrides(V,W,ba);return V});return function(S,W,T,ba,I,P,O){return N.apply(this,arguments)}}();Q.evaluateOverrides=function(){var N=t._asyncToGenerator(function*(S,W,T,ba,I){if(W){var P;for(const O of S)(S=O.valueExpressionInfo)&&T&&(P||(P=[]),O.value=void 0,S=d.createRendererExpression(S.expression,T.spatialReference,T.fields).then(V=>{O.value=h(V,W,{$view:I},T.geometryType,ba)}),P.push(S));void 0!==P&&0<P.length&&(yield Promise.all(P))}});
return function(S,W,T,ba,I){return N.apply(this,arguments)}}();Q.applyDictionaryTextOverrides=function(N,S,W,T="Normal"){if(N&&N.type)switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var ba=N.symbolLayers;if(!ba)break;for(var I of ba)I&&"CIMVectorMarker"===I.type&&Q.applyDictionaryTextOverrides(I,S,W,"CIMTextSymbol"===N.type?N.textCase:T);break;case "CIMVectorMarker":N=N.markerGraphics;if(!N)break;for(ba of N)ba&&Q.applyDictionaryTextOverrides(ba,
S,W);break;case "CIMMarkerGraphic":(I=N.textString)&&I.includes("[")&&(W=v.analyzeTextParts(I,W),N.textString=v.assignTextValuesFromFeature(S,W,T))}};Q.applyOverrides=function(N,S,W,T){if(N.primitiveName)for(const I of S)if(I.primitiveName===N.primitiveName){var ba=(ba=I.propertyName)?ba.charAt(0).toLowerCase()+ba.substr(1):ba;T&&T.push({cim:N,nocapPropertyName:ba,value:N[ba]});I.expression&&(I.value=Q.toValue(I.propertyName,I.expression));if(W){let P=!1;for(const O of W)O.primitiveName===N.primitiveName&&
(P=!0);P||W.push(I)}m.isSome(I.value)&&(N[ba]=I.value)}switch(N.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(N.effects)for(const I of N.effects)Q.applyOverrides(I,S,W,T);if(N.symbolLayers)for(const I of N.symbolLayers)Q.applyOverrides(I,S,W,T);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(N.effects)for(const I of N.effects)Q.applyOverrides(I,S,W,T);if("CIMVectorMarker"===N.type&&N.markerGraphics)for(const I of N.markerGraphics)Q.applyOverrides(I,
S,W,T),Q.applyOverrides(I.symbol,S,W,T)}};Q.restoreOverrides=function(N){for(const S of N)S.cim[S.nocapPropertyName]=S.value};Q.buildOverrideKey=function(N){let S="";for(const W of N)void 0!==W.value&&(S+=`${W.primitiveName}${W.propertyName}${JSON.stringify(W.value)}`);return S};Q.toValue=function(N,S){return"DashTemplate"===N?S.split(" ").map(W=>Number(W)):"Color"===N?(N=(new E(S)).toRgba(),N[3]*=255,N):S};return Q}();const K=Q=>{if(!Q)return r.LineCapStyle.Butt;switch(Q){case "butt":return r.LineCapStyle.Butt;
case "square":return r.LineCapStyle.Square;case "round":return r.LineCapStyle.Round}},U=Q=>{if(!Q)return r.LineJoinStyle.Miter;switch(Q){case "miter":return r.LineJoinStyle.Miter;case "round":return r.LineJoinStyle.Round;case "bevel":return r.LineJoinStyle.Bevel}},X=Q=>{if(m.isNone(Q))return"Center";switch(Q){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},Z=Q=>{if(m.isNone(Q))return"Center";switch(Q){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";
case "bottom":return"Bottom"}},aa=Q=>{if(!Q)return[0,0,0,0];const {r:N,g:S,b:W,a:T}=Q;return[N,S,W,255*T]},da=(Q,N)=>{N="butt"===N;switch(Q){case "dash":case "esriSLSDash":return N?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return N?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return N?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return N?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return N?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return N?
[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return N?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return N?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return N?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return N?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return H.error("Unexpected: style does not require rasterization"),[0,0];default:return H.error(`Tried to rasterize SLS, but found an unexpected style: ${Q}!`),
[0,0]}},R=Q=>{if("circle"===Q||"esriSMSCircle"===Q){var N=Math.acos(.995);Q=Math.ceil(B/N/4);0===Q&&(Q=1);N=D/Q;Q*=4;var S=[];S.push([50,0]);for(let W=1;W<Q;W++)S.push([50*Math.cos(W*N),-50*Math.sin(W*N)]);S.push([50,0]);N={rings:[S]};S={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===Q||"esriSMSCross"===Q?(N={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===Q||"esriSMSDiamond"===Q?(N=
{rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===Q||"esriSMSSquare"===Q?(N={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===Q||"esriSMSX"===Q?(N={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===Q||"esriSMSTriangle"===Q?(Q=2/3*100,S=Q-100,N={rings:[[[-57.735026918962575,S],[0,Q],
[57.735026918962575,S],[-57.735026918962575,S]]]},S={xmin:-57.735026918962575,ymin:S,xmax:57.735026918962575,ymax:Q}):"arrow"===Q&&(N={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50});return[S,N]};let M;q.CIMSymbolHelper=J;q.CIMSymbolInflatedSizeHelper=y;q.OverrideHelper=L;q.slsDashToTemplateArray=da;q.symbolToCIM=function(Q){if(!Q||!Q.type)return null;let N;switch(Q.type){case "cim":return Q.data;case "web-style":return Q;case "simple-marker":N=
J.fromSimpleMarker(Q);break;case "picture-marker":N=J.fromPictureMarker(Q);break;case "simple-line":N=J.fromSimpleLineSymbol(Q);break;case "simple-fill":N=J.fromSimpleFillSymbol(Q);break;case "picture-fill":N=J.fromPictureFillSymbol(Q);break;case "text":N=J.fromTextSymbol(Q)}return{type:"CIMSymbolReference",symbol:N}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(q){let t=function(){function C(){this.setIdentity()}
var A=C.prototype;A.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};A.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};A.setTranslate=function(y,m){this.tx=y;this.ty=m};A.setTranslateZ=function(y){this.tz=y};A.setRotateCS=function(y,m){this.rz=void 0;this.rzCos=y;this.rzSin=m};A.setRotate=function(y){this.rz=y;this.rzSin=this.rzCos=void 0};A.setRotateY=
function(y){this.ry=y};A.setScale=function(y){this.s=y};A.setMeasure=function(y){this.m=y};return C}(),E=function(){function C(){}C.prototype.next=function(){return null};return C}();q.EmptyPlacementCursor=E;q.Placement=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f,n,z,x){function B(aa,da=1){const R=f.fromCIMFontDecoration(aa);var M=f.fromCIMFontStyle(aa.fontStyleName);const Q=C.getFontFamily(aa.fontFamilyName),{weight:N,style:S}=M;M=da*(aa.height||5);const W=f.fromCIMHorizontalAlignment(aa.horizontalAlignment),T=f.fromCIMVerticalAlignment(aa.verticalAlignment),ba=f.getFillColor(aa),I=f.getStrokeColor(aa.haloSymbol);aa=I?da*(aa.haloSize|0):0;return{color:ba,size:M,horizontalAlignment:W,verticalAlignment:T,
font:{family:Q,style:f.getFontStyle(S),weight:f.getFontWeight(N),decoration:R},halo:{size:aa||0,color:I,style:S},pixelRatio:1,premultiplyColors:!0}}const D=Math.PI/180,F=y.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let G=function(){function aa(R){this._t=R}aa.createIdentity=function(){return new aa([1,0,0,0,1,0])};var da=aa.prototype;da.clone=function(){return new aa(this._t.slice())};da.transform=function(R){const M=this._t;return[M[0]*R[0]+M[1]*R[1]+M[2],M[3]*R[0]+M[4]*R[1]+M[5]]};aa.createScale=
function(R,M){return new aa([R,0,0,0,M,0])};da.scale=function(R,M){const Q=this._t;Q[0]*=R;Q[1]*=R;Q[2]*=R;Q[3]*=M;Q[4]*=M;Q[5]*=M;return this};da.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};aa.createTranslate=function(R,M){return new aa([0,0,R,0,0,M])};da.translate=function(R,M){const Q=this._t;Q[2]+=R;Q[5]+=M;return this};aa.createRotate=function(R){const M=Math.cos(R);R=Math.sin(R);return new aa([M,-R,0,R,M,0])};da.rotate=function(R){return aa.multiply(this,
aa.createRotate(R),this)};da.angle=function(){const R=this._t[0],M=this._t[3],Q=Math.sqrt(R*R+M*M);return[R/Q,M/Q]};aa.multiply=function(R,M,Q){R=R._t;M=M._t;const N=R[1]*M[0]+R[4]*M[1],S=R[2]*M[0]+R[5]*M[1]+M[2],W=R[0]*M[3]+R[3]*M[4],T=R[1]*M[3]+R[4]*M[4],ba=R[2]*M[3]+R[5]*M[4]+M[5],I=Q._t;I[0]=R[0]*M[0]+R[3]*M[1];I[1]=N;I[2]=S;I[3]=W;I[4]=T;I[5]=ba;return Q};da.invert=function(){const R=this._t;let M=R[0]*R[4]-R[1]*R[3];if(0===M)return new aa([0,0,0,0,0,0]);M=1/M;return new aa([R[4]*M,-R[1]*M,(R[1]*
R[5]-R[2]*R[4])*M,-R[3]*M,R[0]*M,(R[2]*R[3]-R[0]*R[5])*M])};return aa}();y=function(){function aa(R,M){this._resourceManager=R;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new l(h.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(M||G.createIdentity());this._sizeTransfos.push(M?M.scaleRatio():1)}var da=aa.prototype;da.setTransform=function(R,M){this._transfos=[R||G.createIdentity()];this._sizeTransfos=[M?M:R?R.scaleRatio():
1]};da.setGeomUnitsPerPoint=function(R){this._geomUnitsPerPoint=R};da.transformPt=function(R){return this._transfos[this._transfos.length-1].transform(R)};da.transformSize=function(R){return R*this._sizeTransfos[this._sizeTransfos.length-1]};da.reverseTransformPt=function(R){return this._transfos[this._transfos.length-1].invert().transform(R)};da.reverseTransformSize=function(R){return R/this._sizeTransfos[this._sizeTransfos.length-1]};da.getTransformAngle=function(){return this._transfos[this._transfos.length-
1].angle()};da.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};da.isEmbedded=function(){return 1<this._transfos.length};da.back=function(){return this._transfos[this._transfos.length-1]};da.push=function(R,M){M=M?R.scaleRatio():1;G.multiply(R,this.back(),R);this._transfos.push(R);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*M)};da.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};da.drawSymbol=function(R,M,Q){if(R)switch(R.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(R,
M);break;case "CIMTextSymbol":this.drawTextSymbol(R,M,Q)}};da.drawMultiLayerSymbol=function(R,M){if(R){var Q=R.symbolLayers;if(Q)if((R=R.effects)&&0<R.length){if(M=this.executeEffects(R,M))for(R=M.next();R;)this.drawSymbolLayers(Q,R),R=M.next()}else this.drawSymbolLayers(Q,M)}};da.executeEffects=function(R,M){const Q=this._resourceManager.geometryEngine;M=new p.SimpleGeometryCursor(M);for(const N of R)(R=v.getEffectOperator(N))&&(M=R.execute(M,N,this.geomUnitsPerPoint(),Q));return M};da.drawSymbolLayers=
function(R,M){let Q=R.length;for(;Q--;){const S=R[Q];if(S&&!1!==S.enable){var N=S.effects;if(N&&0<N.length){if(N=this.executeEffects(N,M)){let W=null;for(;(W=N.next())&&(this.drawSymbolLayer(S,W),!this._earlyReturn););}}else this.drawSymbolLayer(S,M);if(this._earlyReturn)break}}};da.drawSymbolLayer=function(R,M){switch(R.type){case "CIMSolidFill":this.drawSolidFill(M,R.color);break;case "CIMHatchFill":this.drawHatchFill(M,R);break;case "CIMPictureFill":this.drawPictureFill(M,R);break;case "CIMGradientFill":this.drawGradientFill(M,
R);break;case "CIMSolidStroke":this.drawSolidStroke(M,R.color,R.width,R.capStyle,R.joinStyle,R.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(M,R);break;case "CIMGradientStroke":this.drawGradientStroke(M,R);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(R,M)}};da.drawHatchFill=function(R,M){const Q=this._buildHatchPolyline(M,R,this.geomUnitsPerPoint());Q&&(this.pushClipPath(R),this.drawMultiLayerSymbol(M.lineSymbol,Q),this.popClipPath())};
da.drawPictureFill=function(R,M){};da.drawGradientFill=function(R,M){};da.drawPictureStroke=function(R,M){};da.drawGradientStroke=function(R,M){};da.drawMarkerLayer=function(R,M){var Q=R.markerPlacement;if(Q){const S=v.getPlacementOperator(Q);if(S){var N="CIMMarkerPlacementInsidePolygon"===Q.type||"CIMMarkerPlacementPolygonCenter"===Q.type&&Q.clipAtBoundary;N&&this.pushClipPath(M);if(M=S.execute(M,Q,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(Q=null;(Q=M.next())&&(this.drawMarker(R,
Q),!this._earlyReturn););N&&this.popClipPath()}}else{Q=this._placementPool.acquire();if(e.isPoint(M))Q.tx=M.x,Q.ty=M.y,this.drawMarker(R,Q);else if(e.isPolygon(M))[Q.tx,Q.ty]=d.polygonCentroid(M),this.drawMarker(R,Q);else for(N of M.points)if(Q.tx=N[0],Q.ty=N[1],this.drawMarker(R,Q),this._earlyReturn)break;this._placementPool.release(Q)}};da.drawMarker=function(R,M){switch(R.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(R,M);break;case "CIMVectorMarker":this.drawVectorMarker(R,
M)}};da.drawPictureMarker=function(R,M){if(R){var Q=this._resourceManager.getResource(R.url),N=R.size??10;if(!(m.isNone(Q)||0>=N)){var S=Q.width;Q=Q.height;if(S&&Q){Q=S/Q;var W=R.scaleX??1;S=G.createIdentity();var T=R.anchorPoint;if(T){var ba=T.x;T=T.y;"Absolute"!==R.anchorPointUnits&&(ba*=N*Q*W,T*=N);S.translate(-ba,-T)}Q=R.rotation??0;R.rotateClockwise&&(Q=-Q);this._mapRotation&&(Q+=this._mapRotation);Q&&S.rotate(Q*D);Q=R.offsetX??0;W=R.offsetY??0;if(Q||W){if(this._mapRotation){T=D*this._mapRotation;
ba=Math.cos(T);T=Math.sin(T);const I=Q*T+W*ba;Q=Q*ba-W*T;W=I}S.translate(Q,W)}Q=this.geomUnitsPerPoint();1!==Q&&S.scale(Q,Q);(Q=M.getAngle())&&S.rotate(Q);S.translate(M.tx,M.ty);this.push(S,!1);this.drawImage(R,N);this.pop()}}}};da.drawVectorMarker=function(R,M){if(R){var Q=R.markerGraphics;if(Q){var N=R.size??10,S=R.frame,W=S?S.ymax-S.ymin:0;W=N&&W?N/W:1;N=G.createIdentity();S&&N.translate(.5*-(S.xmax+S.xmin),.5*-(S.ymax+S.ymin));var T=R.anchorPoint;if(T){var ba=T.x;T=T.y;"Absolute"!==R.anchorPointUnits?
S&&(ba*=S.xmax-S.xmin,T*=S.ymax-S.ymin):(ba/=W,T/=W);N.translate(-ba,-T)}1!==W&&N.scale(W,W);S=R.rotation??0;R.rotateClockwise&&(S=-S);this._mapRotation&&(S+=this._mapRotation);S&&N.rotate(S*D);S=R.offsetX??0;W=R.offsetY??0;if(S||W){if(this._mapRotation){T=D*this._mapRotation;ba=Math.cos(T);T=Math.sin(T);const I=S*T+W*ba;S=S*ba-W*T;W=I}N.translate(S,W)}S=this.geomUnitsPerPoint();1!==S&&N.scale(S,S);(S=M.getAngle())&&N.rotate(S);N.translate(M.tx,M.ty);this.push(N,R.scaleSymbolsProportionally);for(const I of Q)if(I&&
I.symbol&&I.geometry||F.error("Invalid marker graphic",I),this.drawSymbol(I.symbol,I.geometry,I.textString),this._earlyReturn)break;this.pop()}}};da.drawTextSymbol=function(R,M,Q){if(R&&e.isPoint(M)&&!(0>=(R.height??10))){var N=G.createIdentity(),S=R.angle??0;(S=-S)&&N.rotate(S*D);S=R.offsetX??0;var W=R.offsetY??0;(S||W)&&N.translate(S,W);S=this.geomUnitsPerPoint();1!==S&&N.scale(S,S);N.translate(M.x,M.y);this.push(N,!1);this.drawText(R,Q);this.pop()}};da._buildHatchPolyline=function(R,M,Q){var N=
(void 0!==R.separation?R.separation:4)*Q,S=void 0!==R.rotation?R.rotation:0;if(0===N)return null;0>N&&(N=-N);for(var W=0,T=.5*N;W>T;)W-=N;for(;W<-T;)W+=N;W=a.create();b.getBoundsXY(W,M);W[0]-=T;W[1]-=T;W[2]+=T;W[3]+=T;for(var ba=[[W[0],W[1]],[W[0],W[3]],[W[2],W[3]],[W[2],W[1]]];180<S;)S-=180;for(;0>S;)S+=180;T=Math.cos(S*D);var I=Math.sin(S*D);S=-N*I;M=N*T;W=(void 0!==R.offsetX?R.offsetX*Q:0)*I-(void 0!==R.offsetY?R.offsetY*Q:0)*T;let P;var O=R=Number.MAX_VALUE;P=Q=-Number.MAX_VALUE;for(var V of ba){var Y=
V[0];const ca=V[1];ba=T*Y+I*ca;Y=-I*Y+T*ca;O=Math.min(O,ba);R=Math.min(R,Y);P=Math.max(P,ba);Q=Math.max(Q,Y)}R=Math.floor(R/N)*N;V=T*O-I*R-S*W/N;O=I*O+T*R-M*W/N;ba=T*P-I*R-S*W/N;W=I*P+T*R-M*W/N;N=1+Math.round((Q-R)/N);T=[];for(I=0;I<N;I++)V+=S,O+=M,ba+=S,W+=M,T.push([[V,O],[ba,W]]);return{paths:T}};return aa}();let H=function(aa){function da(M,Q){M=aa.call(this,M,Q)||this;M.reset();return M}t._inheritsLoose(da,aa);var R=da.prototype;R.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=
-Infinity;this._clipCount=0};R.envelope=function(){return new k(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};R.bounds=function(){return a.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};R.drawSolidFill=function(M){!M||0<this._clipCount||(e.isPolygon(M)?this._processPath(M.rings,0):e.isPolyline(M)?this._processPath(M.paths,0):e.isExtent(M)?(M=K(M))&&this._processPath(M.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};R.drawSolidStroke=function(M,Q,
N){!M||0<this._clipCount||(Q=.5*this.transformSize(N),e.isPolygon(M)?this._processPath(M.rings,Q):e.isPolyline(M)?this._processPath(M.paths,Q):e.isExtent(M)?(M=K(M))&&this._processPath(M.rings,Q):console.error("drawSolidStroke unexpected geometry type!"))};R.drawMarkerLayer=function(M,Q){e.isPolygon(Q)&&M.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===M.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===M.markerPlacement.type&&M.markerPlacement.clipAtBoundary)?this._processPath(Q.rings,
0):aa.prototype.drawMarkerLayer.call(this,M,Q)};R.drawHatchFill=function(M,Q){this.drawSolidFill(M)};R.drawPictureFill=function(M,Q){this.drawSolidFill(M)};R.drawGradientFill=function(M,Q){this.drawSolidFill(M)};R.drawPictureStroke=function(M,Q){this.drawSolidStroke(M,null,Q.width)};R.drawGradientStroke=function(M,Q){this.drawSolidStroke(M,null,Q.width)};R.pushClipPath=function(M){this.drawSolidFill(M);this._clipCount++};R.popClipPath=function(){this._clipCount--};R.drawImage=function(M,Q){var {url:N}=
M;M=M.scaleX??1;let S=M*Q,W=Q;N=this._resourceManager.getResource(N);!Q&&m.isSome(N)&&(S=M*N.width,W=N.height);this._merge(this.transformPt([-S/2,-W/2]),0);this._merge(this.transformPt([-S/2,W/2]),0);this._merge(this.transformPt([S/2,-W/2]),0);this._merge(this.transformPt([S/2,W/2]),0)};R.drawText=function(M,Q){if(Q&&0!==Q.length){this._textRasterizer||(this._textRasterizer=new g);var N=B(M),[S,W]=this._textRasterizer.computeTextSize(Q,N);Q=0;switch(M.horizontalAlignment){case "Left":Q=S/2;break;
case "Right":Q=-S/2}N=0;switch(M.verticalAlignment){case "Bottom":N=W/2;break;case "Top":N=-W/2;break;case "Baseline":N=W/6}this._merge(this.transformPt([-S/2+Q,-W/2+N]),0);this._merge(this.transformPt([-S/2+Q,W/2+N]),0);this._merge(this.transformPt([S/2+Q,-W/2+N]),0);this._merge(this.transformPt([S/2+Q,W/2+N]),0)}};R._processPath=function(M,Q){if(M)for(const N of M)if(M=N?N.length:0,1<M){this._merge(this.transformPt(N[0]),Q);for(let S=1;S<M;S++)this._merge(this.transformPt(N[S]),Q)}};R._merge=function(M,
Q){M[0]-Q<this._xmin&&(this._xmin=M[0]-Q);M[0]+Q>this._xmax&&(this._xmax=M[0]+Q);M[1]-Q<this._ymin&&(this._ymin=M[1]-Q);M[1]+Q>this._ymax&&(this._ymax=M[1]+Q)};return da}(y),J=function(aa){function da(){var M=aa.apply(this,arguments)||this;M._searchPoint=[0,0];M._searchDistPoint=0;return M}t._inheritsLoose(da,aa);var R=da.prototype;R.hitTest=function(M,Q,N,S,W,T){T*=c.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(T);this._searchPoint=[(M[0]+M[2])/2,(M[1]+M[3])/2];this._searchDistPoint=(M[2]-
M[0])/2/T;this._textInfo=S;this._mapRotation=Q&&("CIMPointSymbol"===Q.type&&"Map"!==Q.angleAlignment||"CIMTextSymbol"===Q.type)?W:0;this._earlyReturn=!1;this.drawSymbol(Q,N);return this._earlyReturn};R.drawSolidFill=function(M,Q){this._hitTestFill(M)};R.drawHatchFill=function(M,Q){this._hitTestFill(M)};R.drawPictureFill=function(M,Q){this._hitTestFill(M)};R.drawGradientFill=function(M,Q){this._hitTestFill(M)};R.drawSolidStroke=function(M,Q,N,S,W,T){this._hitTestStroke(M,N)};R.drawPictureStroke=function(M,
Q){this._hitTestStroke(M,Q.width)};R.drawGradientStroke=function(M,Q){this._hitTestStroke(M,Q.width)};R.drawMarkerLayer=function(M,Q){M.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===M.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===M.markerPlacement.type&&M.markerPlacement.clipAtBoundary)?this._hitTestFill(Q):aa.prototype.drawMarkerLayer.call(this,M,Q)};R.pushClipPath=function(M){};R.popClipPath=function(){};R.drawImage=function(M,Q){var {url:N}=M;M=M.scaleX??1;N=this._resourceManager.getResource(N);
if(!m.isNone(N)&&0!==N.height&&0!==Q){Q*=this.geomUnitsPerPoint();M=N.width/N.height*M*Q;N=this.reverseTransformPt(this._searchPoint);var S=this._searchDistPoint;Math.abs(N[0])<M/2+S&&Math.abs(N[1])<Q/2+S&&(this._earlyReturn=!0)}};R.drawText=function(M,Q){if(Q=this._textInfo)if(Q=Q.get(M)){var {text:N,mosaicItem:S}=Q;if(S&&0!==S.glyphMosaicItems.length){Q=M.height??10;var W=Z(M.lineGapType,M.lineGap??0,Q),T=E.bidiText(N)[1];M=x.shapeGlyphs(S.glyphMosaicItems,T,{scale:Q/z.GLYPH_SIZE,angle:0,xOffset:0,
yOffset:0,hAlign:U(M.horizontalAlignment),vAlign:X(M.verticalAlignment),maxLineWidth:512,lineHeight:z.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(W||1,4)),decoration:M.font.decoration||"none",isCIM:!0});W=this.reverseTransformPt(this._searchPoint);Q=W[0];W=W[1];for(const ba of M.glyphs)if(Q>ba.xTopLeft&&Q<ba.xBottomRight&&W>-ba.yBottomRight&&W<-ba.yTopLeft){this._earlyReturn=!0;break}}}};R._hitTestFill=function(M){let Q=null;if(e.isExtent(M))Q=[[[M.xmin,M.ymin],[M.xmin,M.ymax],[M.xmax,M.ymax],[M.xmax,
M.ymin],[M.xmin,M.ymin]]];else if(e.isPolygon(M))Q=M.rings;else if(e.isPolyline(M))Q=M.paths;else return;M=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(M,Q)&&(this._earlyReturn=!0);if(!this._earlyReturn){const N=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(M,Q,N)&&(this._earlyReturn=!0)}};R._hitTestStroke=function(M,Q){let N=null;if(e.isExtent(M))N=[[[M.xmin,M.ymin],[M.xmin,M.ymax],[M.xmax,M.ymax],[M.xmax,M.ymin],[M.xmin,M.ymin]]];else if(e.isPolygon(M))N=
M.rings;else if(e.isPolyline(M))N=M.paths;else return;M=this.reverseTransformPt(this._searchPoint);Q*=this.geomUnitsPerPoint();const S=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(M,N,Q/2+S)&&(this._earlyReturn=!0)};R._pointInPolygon=function(M,Q){let N=0;for(const S of Q){Q=S.length;for(let W=1;W<Q;W++){const T=S[W-1],ba=S[W];T[1]>M[1]!==ba[1]>M[1]&&(0<(ba[0]-T[0])*(M[1]-T[1])-(ba[1]-T[1])*(M[0]-T[0])?N++:N--)}}return 0!==N};R._nearLine=function(M,Q,N){for(const W of Q){Q=
W.length;for(let T=1;T<Q;T++){var S=W[T-1];const ba=W[T];let I=(ba[0]-S[0])*(ba[0]-S[0])+(ba[1]-S[1])*(ba[1]-S[1]);if(0!==I&&(I=Math.sqrt(I),Math.abs(((ba[0]-S[0])*(M[1]-S[1])-(ba[1]-S[1])*(M[0]-S[0]))/I)<N&&(S=((ba[0]-S[0])*(M[0]-S[0])+(ba[1]-S[1])*(M[1]-S[1]))/I,S>-N&&S<I+N)))return!0}}return!1};return da}(y),L=function(aa){function da(M,Q,N,S){Q=aa.call(this,Q,N)||this;Q._applyAdditionalRenderProps=S;Q._colorSubstitutionHelper=new r;Q._ctx=M;return Q}t._inheritsLoose(da,aa);var R=da.prototype;
R.drawSolidFill=function(M,Q){if(M){if(e.isPolygon(M))this._buildPath(M.rings,!0);else if(e.isPolyline(M))this._buildPath(M.paths,!0);else if(e.isExtent(M))this._buildPath(K(M).rings,!0);else if(e.isMultipoint(M))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;M=this._ctx;M.fillStyle="string"===typeof Q?Q:"rgba("+Math.round(Q[0])+","+Math.round(Q[1])+","+Math.round(Q[2])+","+Q[3]/255+")";M.fill("evenodd")}};R.drawSolidStroke=function(M,Q,N,S,W,T){if(M&&Q&&0!==N){if(e.isPolygon(M))this._buildPath(M.rings,
!0);else if(e.isPolyline(M))this._buildPath(M.paths,!1);else if(e.isExtent(M))this._buildPath(K(M).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}M=this._ctx;M.strokeStyle="string"===typeof Q?Q:"rgba("+Math.round(Q[0])+","+Math.round(Q[1])+","+Math.round(Q[2])+","+Q[3]/255+")";M.lineWidth=Math.max(this.transformSize(N),.5);this._setCapStyle(S);this._setJoinStyle(W);M.miterLimit=T;M.stroke()}};R.pushClipPath=function(M){this._ctx.save();if(e.isPolygon(M))this._buildPath(M.rings,
!0);else if(e.isPolyline(M))this._buildPath(M.paths,!0);else if(e.isExtent(M))this._buildPath(K(M).rings,!0);else return;this._ctx.clip("evenodd")};R.popClipPath=function(){this._ctx.restore()};R.drawImage=function(M,Q){const {colorSubstitutions:N,url:S,tintColor:W}=M;M=M.scaleX??1;var T=this._resourceManager.getResource(S);if(!m.isNone(T)){var ba=T.width/T.height*Q,I=Q;Q||(ba=T.width,I=T.height);var P=f.isSVGImage(S)||"src"in T&&f.isSVGImage(T.src);Q="getFrame"in T?u.getFirstFrame(T):T;N&&(Q=this._colorSubstitutionHelper.applyColorSubstituition(Q,
N));this._applyAdditionalRenderProps&&!P&&W&&(Q=this._colorSubstitutionHelper.tintImageData(Q,W));T=this.transformPt([0,0]);var [O,V]=this.getTransformAngle();P=this.transformSize(1);var Y=this._ctx;Y.save();Y.setTransform({m11:M*P*O,m12:M*P*V,m21:-P*V,m22:P*O,m41:T[0],m42:T[1]});Y.drawImage(Q,-ba/2,-I/2,ba,I);Y.restore()}};R.drawText=function(M,Q){if(Q&&0!==Q.length&&(this._textRasterizer||(this._textRasterizer=new g),M=B(M),M.size*=this.transformSize(c.px2pt(1)),Q=this._textRasterizer.rasterizeText(Q,
M))){var {size:N,anchorX:S,anchorY:W,canvas:T}=Q;Q=N[0]*(S+.5);M=N[1]*(W-.5);var ba=this._ctx,I=this.transformPt([0,0]),[P,O]=this.getTransformAngle();ba.save();ba.setTransform({m11:1*P,m12:1*O,m21:-1*O,m22:1*P,m41:I[0]-1*Q,m42:I[1]+1*M});ba.drawImage(T,0,0);ba.restore()}};R.drawPictureFill=function(M,Q){if(M){var {colorSubstitutions:N,height:S,offsetX:W,offsetY:T,rotation:ba,scaleX:I,tintColor:P,url:O}=Q;Q=this._resourceManager.getResource(O);if(!m.isNone(Q)){if(e.isPolygon(M))this._buildPath(M.rings,
!0);else if(e.isPolyline(M))this._buildPath(M.paths,!0);else if(e.isExtent(M))this._buildPath(K(M).rings,!0);else if(e.isMultipoint(M))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");else return;M=this._ctx;var V=f.isSVGImage(O)||"src"in Q&&f.isSVGImage(Q.src),Y="getFrame"in Q?u.getFirstFrame(Q):Q;N&&(Y=this._colorSubstitutionHelper.applyColorSubstituition(Y,N));if(this._applyAdditionalRenderProps){if(V||P&&(Y=this._colorSubstitutionHelper.tintImageData(Y,P)),V=M.createPattern(Y,
"repeat"),Y=this.transformSize(1),ba||(ba=0),W=W?Y*W:0,T=T?Y*T:0,S&&(S*=Y),Y=S?S/Q.height:1,Q=I&&S?I*S/Q.width:1,0!==ba||1!==Y||1!==Q||0!==W||0!==T){const ca=new DOMMatrix;ca.rotateSelf(0,0,-ba).translateSelf(W,T).scaleSelf(Q,Y,1);V.setTransform(ca)}}else V=M.createPattern(Y,"repeat");M.save();M.fillStyle=V;M.fill("evenodd");M.restore()}}};R.drawPictureStroke=function(M,Q){if(M){var {colorSubstitutions:N,capStyle:S,joinStyle:W,miterLimit:T,tintColor:ba,url:I,width:P}=Q;Q=this._resourceManager.getResource(I);
if(!m.isNone(Q)){if(e.isPolygon(M))var O=M.rings;else if(e.isPolyline(M))O=M.paths;else if(e.isExtent(M))O=K(M).rings;else if(e.isMultipoint(M))console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");else return;P||(P=Q.width);M=f.isSVGImage(I)||"src"in Q&&f.isSVGImage(Q.src);var V="getFrame"in Q?u.getFirstFrame(Q):Q;N&&(V=this._colorSubstitutionHelper.applyColorSubstituition(V,N));this._applyAdditionalRenderProps&&(M||ba&&(V=this._colorSubstitutionHelper.tintImageData(V,ba)));M=Math.max(this.transformSize(c.pt2px(P)),
.5);Q=M/V.width;var Y=this._ctx;V=Y.createPattern(V,"repeat-y");Y.save();this._setCapStyle(S);this._setJoinStyle(W);Y.miterLimit=T;Y.lineWidth=M;var ca;for(let la of O){la=A.clone(la);var ea=ca=void 0,fa=void 0;let ka=ea=void 0;O=la;for(var ha=O[0],ia=1;ia<O.length;)ka=O[ia][0]-ha[0],ea=O[ia][1]-ha[1],ea=0!==ka?ea/ka:Math.PI/2,void 0!==fa&&1E-4>=ea-fa?(O.splice(ia-1,1),ha=ca):(ca=ha,ha=O[ia],ia++),fa=ea;if(la&&!(1>=la.length))for(O=this.transformPt(la[0]),fa=1;fa<la.length;fa++)ca=this.transformPt(la[fa]),
ha=180/Math.PI*Math.atan2(ca[1]-O[1],ca[0]-O[0]),ia=new DOMMatrix,ia.translateSelf(0,O[1]-M/2).scaleSelf(Q,Q,1).rotateSelf(0,0,90-ha),V.setTransform(ia),Y.strokeStyle=V,Y.beginPath(),Y.moveTo(O[0],O[1]),Y.lineTo(ca[0],ca[1]),Y.stroke(),O=ca}Y.restore()}}};R._buildPath=function(M,Q){const N=this._ctx;N.beginPath();if(M)for(const S of M)if(M=S?S.length:0,1<M){let W=this.transformPt(S[0]);N.moveTo(W[0],W[1]);for(let T=1;T<M;T++)W=this.transformPt(S[T]),N.lineTo(W[0],W[1]);Q&&N.closePath()}};R._setCapStyle=
function(M){switch(M){case w.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case w.LineCapStyle.Round:this._ctx.lineCap="round";break;case w.LineCapStyle.Square:this._ctx.lineCap="square"}};R._setJoinStyle=function(M){switch(M){case w.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case w.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case w.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return da}(y);const K=aa=>aa?{spatialReference:aa.spatialReference,rings:[[[aa.xmin,aa.ymin],[aa.xmin,
aa.ymax],[aa.xmax,aa.ymax],[aa.xmax,aa.ymin],[aa.xmin,aa.ymin]]]}:null,U=aa=>{switch(aa){case "Left":return n.HAlign.Left;case "Right":return n.HAlign.Right;case "Center":return n.HAlign.Center;case "Justify":return F.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),n.HAlign.Center}},X=aa=>{switch(aa){case "Top":return n.VAlign.Top;case "Center":return n.VAlign.Center;case "Bottom":return n.VAlign.Bottom;case "Baseline":return n.VAlign.Baseline}},Z=(aa,da,R)=>
{switch(aa){case "ExtraLeading":return 1+da/R;case "Multiple":return da;case "Exact":return da/R}};q.CIMSymbolDrawHelper=y;q.C_DEG_TO_RAD=D;q.CanvasDrawHelper=L;q.EnvDrawHelper=H;q.HittestDrawHelper=J;q.Transformation=G;q.horizontalAlignment2HAlign=U;q.lineGapType2LineHeight=Z;q.verticalAlignment2VAlign=X;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(q,t){let E=function(){function C(A){this._geometry=
A}C.prototype.next=function(){const A=this._geometry;this._geometry=null;return A};return C}();q.SimpleGeometryCursor=E;q.clone=function(C){return t.clone(C)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(["../../Color"],function(q){return function(){function t(){}var E=t.prototype;E.applyColorSubstituition=function(C,A){if(!A)return C;this._rasterizationCanvas||(this._rasterizationCanvas=
document.createElement("canvas"));const {width:y,height:m}=C,l=this._rasterizationCanvas,c=l.getContext("2d");C!==l&&(l.width=y,l.height=m,c.drawImage(C,0,0,y,m));C=c.getImageData(0,0,y,m).data;if(A)for(var a of A)if(a&&a.oldColor&&4===a.oldColor.length&&a.newColor&&4===a.newColor.length){const [b,d,e,p]=a.oldColor,[r,v,h,w]=a.newColor;if(b!==r||d!==v||e!==h||p!==w)for(A=0;A<C.length;A+=4)b===C[A]&&d===C[A+1]&&e===C[A+2]&&p===C[A+3]&&(C[A]=r,C[A+1]=v,C[A+2]=h,C[A+3]=w)}a=new ImageData(C,y,m);c.putImageData(a,
0,0);return l};E.tintImageData=function(C,A){if(!A)return C;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:y,height:m}=C,l=this._rasterizationCanvas,c=l.getContext("2d");C!==l&&(l.width=y,l.height=m,c.drawImage(C,0,0,y,m));C=c.getImageData(0,0,y,m);C=new Uint8Array(C.data);A=new q(A);A=[A.r/255,A.g/255,A.b/255,A.a];for(let a=0;a<C.length;a+=4)C[a+0]*=A[0],C[a+1]*=A[1],C[a+2]*=A[2],C[a+3]*=A[3];C=new ImageData(new Uint8ClampedArray(C.buffer),y,
m);c.putImageData(C,0,0);return l};return t}()})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f){q.getEffectOperator=function(n){if(!n)return null;switch(n.type){case "CIMGeometricEffectAddControlPoints":return t.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return E.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return A.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return y.EffectCut.local();case "CIMGeometricEffectDashes":return m.EffectDashes.local();
case "CIMGeometricEffectDonut":return l.EffectDonut.local();case "CIMGeometricEffectJog":return c.EffectJog.local();case "CIMGeometricEffectMove":return a.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return d.EffectReverse.local();case "CIMGeometricEffectRotate":return e.EffectRotate.local();case "CIMGeometricEffectScale":return p.EffectScale.local();case "CIMGeometricEffectWave":return r.EffectWave.local()}return null};q.getPlacementOperator=
function(n){if(!n)return null;switch(n.type){case "CIMMarkerPlacementAlongLineSameSize":return v.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return h.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return w.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return u.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return k.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return g.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return f.PlacementPolygonCenter.local()}return null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,
c,a)};return m}();A.instance=null;let y=function(){function m(c,a,b){this._inputGeometries=c;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var l=m.prototype;l.next=function(){for(var c=this._inputGeometries.next();c;){if(E.isPolygon(c))return this._isClosed=!0,c=t.clone(c),this._processMultipath(c.rings),c;if(E.isPolyline(c))return this._isClosed=!1,c=t.clone(c),this._processMultipath(c.paths),c;if(E.isExtent(c)){if(this._maxCosAngle)return c;
this._isClosed=!0;c=[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]];this._processPath(c);return{rings:[c]}}c=this._inputGeometries.next()}return null};l._processMultipath=function(c){if(c)for(const a of c)this._processPath(a)};l._processPath=function(c){if(c){let a=c.length,b=c[0],d,e,p,r,v,h;this._isClosed&&++a;for(let w=1;w<a;++w){let u;u=this._isClosed&&w===a-1?c[0]:c[w];const k=u[0]-b[0],g=u[1]-b[1],f=Math.sqrt(k*k+g*g);1<w&&0<f&&0<p&&(d*k+e*g)/f/p<=this._maxCosAngle&&
C.setId(b,1);1===w&&(r=k,v=g,h=f);0<f&&(b=u,d=k,e=g,p=f)}this._isClosed&&0<p&&0<h&&(d*r+e*v)/h/p<=this._maxCosAngle&&C.setId(c[0],1)}};return m}();q.EffectAddControlPoints=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(q,t,E,C){function A(h){h&&(E.isPoint(h)?h.y=-h.y:E.isPolygon(h)?m(h.rings):E.isPolyline(h)?m(h.paths):
E.isMultipoint(h)&&y(h.points))}function y(h){if(h){const w=h.length;for(let u=0;u<w;u++)h[u][1]=-h[u][1]}}function m(h){if(h)for(const w of h)y(w)}function l(h){if(h){var w=h.length;for(--w;0<w;--w)h[w][0]-=h[w-1][0],h[w][1]-=h[w-1][1]}}function c(h){if(h)for(const w of h)l(w)}function a(h){if(h){const w=h.length;for(let u=1;u<w;++u)h[u][0]+=h[u-1][0],h[u][1]+=h[u-1][1]}}function b(h){if(h)for(const w of h)a(w)}function d(h){h&&(E.isPolygon(h)?b(h.rings):E.isPolyline(h)?b(h.paths):E.isMultipoint(h)&&
a(h.points),A(h))}function e(h){h&&h.reverse()}function p(h){return{rings:[[[h.xmin,h.ymin],[h.xmin,h.ymax],[h.xmax,h.ymax],[h.xmax,h.ymin],[h.xmin,h.ymin]]]}}let r=function(){function h(w,u,k,g=0){this.isClosed=!1;this.multiPath=null;this.acceptPolygon=u;this.acceptPolyline=k;this.geomUnitsPerPoint=g;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;w&&(E.isPolygon(w)?u&&(this.multiPath=w.rings,this.isClosed=!0):E.isPolyline(w)?k&&(this.multiPath=w.paths,this.isClosed=!1):E.isExtent(w)&&u&&(this.multiPath=
p(w).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}h.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const w=this.processPath(this.multiPath[this.pathIndex]);if(w)return w}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return h}(),v=function(){function h(w,u,k,g=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=
w;this.acceptPolygon=u;this.acceptPolyline=k;this.geomUnitsPerPoint=g;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}h.prototype.next=function(){for(;;){if(!this.multiPath){for(var w=this.inputGeometries.next();w;)if(E.isPolygon(w)?this.acceptPolygon&&(this.multiPath=w.rings,this.isClosed=!0):E.isPolyline(w)?this.acceptPolyline&&(this.multiPath=w.paths,this.isClosed=!1):E.isExtent(w)&&this.acceptPolygon&&(this.multiPath=p(w).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;
this.pathIndex=-1;break}else w=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,w=this.processPath(this.multiPath[this.pathIndex]))return w;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return h}();q.PathGeometryCursor=v;q.PathTransformationCursor=r;q.cloneAndDecodeGeometry=function(h){h=t.clone(h);d(h);return h};q.deltaDecodeGeometry=d;q.deltaEncodeGeometry=function(h){h&&(A(h),E.isPolygon(h)?
c(h.rings):E.isPolyline(h)?c(h.paths):E.isMultipoint(h)&&l(h.points))};q.getCoord2D=function(h,w,u){return[h[0]+(w[0]-h[0])*u,h[1]+(w[1]-h[1])*u]};q.getId=function(h){return h[4]};q.isClosedPath=function(h){return h&&0!==h.length?h[0][0]===h[h.length-1][0]&&h[0][1]===h[h.length-1][1]:!1};q.reverseMultipath=function(h){if(h)for(const w of h)e(w)};q.reversePath=e;q.setId=function(h,w){h[4]=w};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(q,t,E,C,A){const y=A.GeometricEffectArrowType.OpenEnded;let m=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(a,b,d,e){return new l(a,b,d)};return c}();m.instance=null;let l=function(c){function a(d,e,p){d=c.call(this,d,!1,!0)||this;d._curveHelper=new C.CurveHelper;d._width=(void 0!==e.width?e.width:5)*p;d._arrowType=void 0!==
e.geometricEffectArrowType?e.geometricEffectArrowType:void 0!==e.arrowType?e.arrowType:y;d._offsetFlattenError=C.PIXEL_TOLERANCE*p;return d}t._inheritsLoose(a,c);var b=a.prototype;b.processPath=function(d){switch(this._arrowType){default:return this._constructSimpleArrow(d,!0);case A.GeometricEffectArrowType.Block:return this._constructSimpleArrow(d,!1);case A.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(d)}};b._constructSimpleArrow=function(d,e){var p=this._curveHelper.calculatePathLength(d),
r=this._width;p<2*r&&(r=p/2);p=this._curveHelper.getSubCurve(d,0,p-r);if(!p)return null;var v=r/2;if(this._curveHelper.isEmpty(p,!1))return null;r=this._constructOffset(p,-v);if(!r)return null;p=this._constructOffset(p,v);if(!p)return null;const h=this._constructArrowBasePoint(r,-v/2);if(!h)return null;v=this._constructArrowBasePoint(p,v/2);if(!v)return null;d=d[d.length-1];e||(this._makeControlPoint(p,!0),this._makeControlPoint(r,!0));const w=new C.PathHelper;w.addPath(p,!0);w.lineTo(v);this._makeControlPoint(w.path());
w.lineTo(d);this._makeControlPoint(w.path());w.lineTo(h);this._makeControlPoint(w.path());w.addPath(r,!1);return e?{paths:[w.path()]}:(w.close(),{rings:[w.path()]})};b._constructCrossedArrow=function(d){var e=this._curveHelper.calculatePathLength(d),p=this._width;e<3.732050807568877*p&&(p=e/3.732050807568877);var r=this._curveHelper.getSubCurve(d,0,e-2.732050807568877*p);if(!r)return null;var v=p/2;if(this._curveHelper.isEmpty(r,!1))return null;const h=this._constructOffset(r,v);if(!h)return null;
r=this._constructOffset(r,-v);if(!r)return null;e=this._curveHelper.getSubCurve(d,0,e-p);if(!e||this._curveHelper.isEmpty(e,!1))return null;p=this._constructOffset(e,v);if(!p)return null;var w=this._constructOffset(e,-v);if(!w)return null;e=p[p.length-1];p=this._constructArrowBasePoint(p,v/2);if(!p)return null;const u=w[w.length-1];v=this._constructArrowBasePoint(w,-v/2);if(!v)return null;d=d[d.length-1];this._makeControlPoint(h,!1);this._makeControlPoint(r,!1);w=new C.PathHelper;w.addPath(h,!0);
this._makeControlPoint(w.path());w.lineTo(u);w.lineTo(v);this._makeControlPoint(w.path());w.lineTo(d);this._makeControlPoint(w.path());w.lineTo(p);this._makeControlPoint(w.path());w.lineTo(e);this._makeControlPoint(w.path());w.addPath(r,!1);return{paths:[w.path()]}};b._constructOffset=function(d,e){return this._curveHelper.offset(d,e,A.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};b._constructArrowBasePoint=function(d,e){if(!d||2>d.length)return null;var p=d[d.length-2];d=d[d.length-
1];p=[d[0]-p[0],d[1]-p[1]];this._curveHelper.normalize(p);return[d[0]+p[1]*e,d[1]-p[0]*e]};b._makeControlPoint=function(d,e=!1){e?E.setId(d[0],1):E.setId(d[d.length-1],1)};return a}(E.PathGeometryCursor);q.EffectArrow=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(q,t){let E=function(){function A(){this._path=[]}var y=A.prototype;y.path=function(){return this._path};y.addPath=
function(m,l){l||m.reverse();Array.prototype.push.apply(this._path,m);l||m.reverse()};A.mergePath=function(m,l){l&&Array.prototype.push.apply(m,l)};y.startPath=function(m){this._path.push(m)};y.lineTo=function(m){this._path.push(m)};y.close=function(){const m=this._path;1<m.length&&(m[0][0]!==m[m.length-1][0]||m[0][1]!==m[m.length-1][1])&&m.push([m[0][0],m[0][1]])};return A}(),C=function(){function A(m,l){}var y=A.prototype;y.normalize=function(m){const l=Math.sqrt(m[0]*m[0]+m[1]*m[1]);0!==l&&(m[0]/=
l,m[1]/=l)};y.calculateLength=function(m,l){const c=l[0]-m[0];m=l[1]-m[1];return Math.sqrt(c*c+m*m)};y.calculateSegLength=function(m,l){return this.calculateLength(m[l],m[l+1])};y.calculatePathLength=function(m){let l=0;const c=m?m.length:0;for(let a=0;a<c-1;++a)l+=this.calculateSegLength(m,a);return l};y.calculatePathArea=function(m){let l=0;const c=m?m.length:0;for(let a=0;a<c-1;++a)l+=(m[a+1][0]-m[a][0])*(m[a+1][1]+m[a][1]);return l/2};y.getCoord2D=function(m,l,c){return[m[0]+(l[0]-m[0])*c,m[1]+
(l[1]-m[1])*c]};y.getSegCoord2D=function(m,l,c){return this.getCoord2D(m[l],m[l+1],c)};y.getAngle=function(m,l,c){return Math.atan2(l[1]-m[1],l[0]-m[0])};y.getSegAngle=function(m,l,c){return this.getAngle(m[l],m[l+1],c)};y.getAngleCS=function(m,l,c){c=l[0]-m[0];m=l[1]-m[1];l=Math.sqrt(c*c+m*m);return 0<l?[c/l,m/l]:[1,0]};y.getSegAngleCS=function(m,l,c){return this.getAngleCS(m[l],m[l+1],c)};y.cut=function(m,l,c,a){c=0>=c?m[l]:this.getSegCoord2D(m,l,c);m=1<=a?m[l+1]:this.getSegCoord2D(m,l,a);return[c,
m]};y.addSegment=function(m,l,c){c&&m.push(l[0]);m.push(l[1])};y.getSubCurve=function(m,l,c){const a=[];return this.appendSubCurve(a,m,l,c)?a:null};y.appendSubCurve=function(m,l,c,a){const b=l?l.length-1:0;let d=0,e=!0,p=0;for(;p<b;){const v=this.calculateSegLength(l,p);if(0!==v){if(e){if(d+v>c){var r=(c-d)/v;let h=1,w=!1;d+v>=a&&(h=(a-d)/v,w=!0);(r=this.cut(l,p,r,h))&&this.addSegment(m,r,e);if(w)break;e=!1}}else{if(d+v>a){(l=this.cut(l,p,0,(a-d)/v))&&this.addSegment(m,l,e);break}this.addSegment(m,
[l[p],l[p+1]],e)}d+=v}++p}return!0};y.getCIMPointAlong=function(m,l){const c=m?m.length-1:0;let a=0,b=-1;for(;b<c;){++b;const d=this.calculateSegLength(m,b);if(0!==d){if(a+d>l)return this.getCoord2D(m[b],m[b+1],(l-a)/d);a+=d}}return null};y.isEmpty=function(m,l){if(!m||1>=m.length)return!0;const c=m?m.length-1:0;let a=-1;for(;a<c;)if(++a,m[a+1][0]!==m[a][0]||m[a+1][1]!==m[a][1]||l&&m[a+1][2]!==m[a][2])return!1;return!0};y.offset=function(m,l,c,a,b){if(!m||2>m.length)return null;var d=0,e=m[d++];for(b=
d;d<m.length;){var p=m[d];if(p[0]!==e[0]||p[1]!==e[1])d!==b&&(m[b]=m[d]),e=m[b++];d++}(d=m[0][0]===m[b-1][0]&&m[0][1]===m[b-1][1])&&--b;if(b<(d?3:2))return null;p=[];e=d?m[b-1]:null;let r=m[0];for(let k=0;k<b;k++){const g=k===b-1?d?m[0]:null:m[k+1];if(e)if(g){var v=[g[0]-r[0],g[1]-r[1]];this.normalize(v);var h=[r[0]-e[0],r[1]-e[1]];this.normalize(h);var w=h[0]*v[1]-h[1]*v[0],u=h[0]*v[0]+h[1]*v[1];if(0===w&&1===u){r=g;continue}if(0<=w===0>=l)1>u&&(v=[v[0]-h[0],v[1]-h[1]],this.normalize(v),h=Math.sqrt((1+
u)/2),h>1/a&&(h=-Math.abs(l)/h,p.push([r[0]-v[0]*h,r[1]-v[1]*h])));else switch(c){case t.GeometricEffectOffsetMethod.Mitered:if(e=Math.sqrt((1+u)/2),0<e&&1/e<a){v=[v[0]-h[0],v[1]-h[1]];this.normalize(v);h=Math.abs(l)/e;p.push([r[0]-v[0]*h,r[1]-v[1]*h]);break}case t.GeometricEffectOffsetMethod.Bevelled:p.push([r[0]+h[1]*l,r[1]-h[0]*l]);p.push([r[0]+v[1]*l,r[1]-v[0]*l]);break;case t.GeometricEffectOffsetMethod.Rounded:if(1>u){p.push([r[0]+h[1]*l,r[1]-h[0]*l]);e=Math.floor(2.5*(1-u));if(0<e){w=u=1/e;
for(let f=1;f<e;f++,w+=u){const n=[h[1]*(1-w)+v[1]*w,-h[0]*(1-w)-v[0]*w];this.normalize(n);p.push([r[0]+n[0]*l,r[1]+n[1]*l])}}p.push([r[0]+v[1]*l,r[1]-v[0]*l])}break;default:0>w?(p.push([r[0]+(h[1]+h[0])*l,r[1]+(h[1]-h[0])*l]),p.push([r[0]+(v[1]-v[0])*l,r[1]-(v[0]+v[1])*l])):(e=Math.sqrt((1+Math.abs(u))/2),v=[v[0]-h[0],v[1]-h[1]],this.normalize(v),h=l/e,p.push([r[0]-v[0]*h,r[1]-v[1]*h]))}}else v=[r[0]-e[0],r[1]-e[1]],this.normalize(v),p.push([r[0]+v[1]*l,r[1]-v[0]*l]);else v=[g[0]-r[0],g[1]-r[1]],
this.normalize(v),p.push([r[0]+v[1]*l,r[1]-v[0]*l]);e=r;r=g}if(p.length<(d?3:2))return null;d&&p.push([p[0][0],p[0][1]]);return p};return A}();q.CurveHelper=C;q.PIXEL_TOLERANCE=.03;q.PathHelper=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&
(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a,b)};return m}();A.instance=null;let y=function(){function m(l,c,a,b){this._inputGeometries=l;this._curveHelper=new E.CurveHelper;this._size=(void 0!==c.size?c.size:1)*a;this._offsetFlattenError=E.PIXEL_TOLERANCE*a}m.prototype.next=function(){let l=this._inputGeometries.next();for(;l;){if(t.isExtent(l))if(0<this._size){var c=this._curveHelper.offset([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,
l.ymin],[l.xmin,l.ymin]],this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(c)return{rings:[c]}}else if(0>this._size){if(0<Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._size)return{xmin:l.xmin-this._size,xmax:l.xmax+this._size,ymin:l.ymin-this._size,ymax:l.ymax+this._size}}else return l;if(t.isPolygon(l)){if(0===this._size)return l;c=[];for(const b of l.rings){var a=this._curveHelper.offset(b,this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);
a&&c.push(a)}if(c.length)return{rings:c}}if(t.isPolyline(l)&&0<this._size){c=[];for(const b of l.paths)if(b&&1<b.length){a=this._curveHelper.offset(b,this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);const d=this._curveHelper.offset(b,-this._size,C.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(a&&d){for(let e=d.length-1;0<=e;e--)a.push(d[e]);a.push([a[0][0],a[0][1]]);c.push(a)}}if(c.length)return{rings:c}}t.isPoint(l);l=this._inputGeometries.next()}return null};
return m}();q.EffectBuffer=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(){function m(c,
a,b){this._defaultPointSize=20;this._inputGeometries=c;this._geomUnitsPerPoint=b;this._rule=a.rule??C.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*b}var l=m.prototype;l.next=function(){let c;for(;c=this._inputGeometries.next();){let a;t.isPoint(c)?a=this._processGeom([[[c.x,c.y]]]):t.isMultipoint(c)?a=this._processGeom([c.points]):t.isPolyline(c)?a=this._processGeom(c.paths):t.isPolygon(c)&&(a=this._processGeom(c.rings));if(a&&a.length)return{paths:a}}return null};
l._clone=function(c){return[c[0],c[1]]};l._mid=function(c,a){return[(c[0]+a[0])/2,(c[1]+a[1])/2]};l._mix=function(c,a,b,d){return[c[0]*a+b[0]*d,c[1]*a+b[1]*d]};l._add=function(c,a){return[c[0]+a[0],c[1]+a[1]]};l._add2=function(c,a,b){return[c[0]+a,c[1]+b]};l._sub=function(c,a){return[c[0]-a[0],c[1]-a[1]]};l._dist=function(c,a){return Math.sqrt((c[0]-a[0])*(c[0]-a[0])+(c[1]-a[1])*(c[1]-a[1]))};l._norm=function(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])};l._normalize=function(c,a=1){a/=this._norm(c);
c[0]*=a;c[1]*=a};l._leftPerpendicular=function(c){const a=c[0];c[0]=-c[1];c[1]=a};l._leftPerp=function(c){return[-c[1],c[0]]};l._rightPerpendicular=function(c){const a=-c[0];c[0]=c[1];c[1]=a};l._rightPerp=function(c){return[c[1],-c[0]]};l._dotProduct=function(c,a){return c[0]*a[0]+c[1]*a[1]};l._crossProduct=function(c,a){return c[0]*a[1]-c[1]*a[0]};l._rotateDirect=function(c,a,b){const d=c[0]*b+c[1]*a;c[0]=c[0]*a-c[1]*b;c[1]=d};l._makeCtrlPt=function(c){c=[c[0],c[1]];E.setId(c,1);return c};l._addAngledTicks=
function(c,a,b,d){const e=this._sub(b,a);this._normalize(e);var p=this._crossProduct(e,this._sub(d,a));d=0<p?this._rightPerp(e):this._leftPerp(e);p=Math.abs(p)/2;const r=[];r.push([a[0]+(d[0]-e[0])*p,a[1]+(d[1]-e[1])*p]);r.push(a);r.push(b);r.push([b[0]+(d[0]+e[0])*p,b[1]+(d[1]+e[1])*p]);c.push(r)};l._addBezier2=function(c,a,b,d,e){if(0===e--)c.push(d);else{var p=this._mid(a,b);b=this._mid(b,d);var r=this._mid(p,b);this._addBezier2(c,a,p,r,e);this._addBezier2(c,r,b,d,e)}};l._addBezier3=function(c,
a,b,d,e,p){if(0===p--)c.push(e);else{var r=this._mid(a,b),v=this._mid(b,d);d=this._mid(d,e);b=this._mid(r,v);v=this._mid(v,d);var h=this._mid(b,v);this._addBezier3(c,a,r,b,h,p);this._addBezier3(c,h,v,d,e,p)}};l._add90DegArc=function(c,a,b,d,e){d=e??0<this._crossProduct(this._sub(b,a),this._sub(d,a));e=this._mid(a,b);const p=this._sub(e,a);d?this._leftPerpendicular(p):this._rightPerpendicular(p);e[0]+=p[0];e[1]+=p[1];this._addBezier3(c,a,this._mix(a,.33333,e,.66667),this._mix(b,.33333,e,.66667),b,
4)};l._addArrow=function(c,a,b){var d=a[0],e=a[1],p=a[a.length-1],r=this._sub(d,e);this._normalize(r);const v=this._crossProduct(r,this._sub(p,e));e=.5*v;var h=this._leftPerp(r);const w=[p[0]-h[0]*v,p[1]-h[1]*v];var u=a.length-1;p=[];p.push(b?[-h[0],-h[1]]:h);var k=[-r[0],-r[1]];for(b=1;b<u-1;b++){r=this._sub(a[b+1],a[b]);this._normalize(r);var g=this._dotProduct(r,k);h=this._crossProduct(r,k);g=Math.sqrt((1+g)/2);k=this._sub(r,k);this._normalize(k);k[0]/=g;k[1]/=g;p.push(0>h?[-k[0],-k[1]]:k);k=r}p.push(this._rightPerp(k));
for(u=p.length-1;0<u;u--)c.push([a[u][0]+p[u][0]*e,a[u][1]+p[u][1]*e]);c.push([w[0]+p[0][0]*e,w[1]+p[0][1]*e]);c.push([w[0]+p[0][0]*v,w[1]+p[0][1]*v]);c.push(d);c.push([w[0]-p[0][0]*v,w[1]-p[0][1]*v]);c.push([w[0]-p[0][0]*e,w[1]-p[0][1]*e]);for(d=1;d<p.length;d++)c.push([a[d][0]-p[d][0]*e,a[d][1]-p[d][1]*e])};l._cp2=function(c,a,b){return 2<=c.length?c[1]:this._add2(c[0],a*this._defaultSize,b*this._defaultSize)};l._cp3=function(c,a,b,d){if(3<=c.length)return c[2];b=this._mix(c[0],1-b,a,b);c=this._sub(a,
c[0]);this._normalize(c);this._rightPerpendicular(c);return[b[0]+c[0]*d*this._defaultSize,b[1]+c[1]*d*this._defaultSize]};l._arrowPath=function(c){if(2<c.length)return c;const a=c[0];c=this._cp2(c,-4,0);const b=this._sub(a,c);this._normalize(b);const d=this._rightPerp(b);return[a,c,[a[0]+(d[0]-b[0])*this._defaultSize,a[1]+(d[1]-b[1])*this._defaultSize]]};l._arrowLastSeg=function(c){var a=c[0];const b=this._cp2(c,-4,0);if(3<=c.length)a=c[c.length-1];else{c=this._sub(a,b);this._normalize(c);const d=
this._rightPerp(c);a=[a[0]+(d[0]-c[0])*this._defaultSize,a[1]+(d[1]-c[1])*this._defaultSize]}return[b,a]};l._processGeom=function(c){if(!c)return null;const a=[];for(const b of c){if(!b||0===b.length)continue;const d=b.length;let e=b[0];switch(this._rule){case C.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const p=this._cp2(b,0,-1),r=this._cp3(b,p,.5,4),v=[];v.push(r);v.push(this._mid(e,p));a.push(v);break;case C.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const h=
this._cp2(b,0,-1);a.push([h,e]);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const w=this._cp2(b,-4,1),u=this._cp3(b,w,.882353,-1.94),k=[];k.push(this._mid(w,u));k.push(e);a.push(k);break;case C.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const g=this._cp2(b,-4,1),f=this._cp3(b,g,.882353,-1.94),n=this._sub(f,g);let z;z=0<this._crossProduct(n,this._sub(e,g))?this._rightPerp(z):this._leftPerp(n);const x=[];x.push([g[0]+(z[0]-n[0])/3,g[1]+(z[1]-n[1])/
3]);x.push(g);x.push(f);x.push([f[0]+(z[0]+n[0])/3,f[1]+(z[1]+n[1])/3]);a.push(x);break;case C.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const B=this._cp2(b,0,-1),D=this._cp3(b,B,.5,3),F=this._mid(e,B),G=this._sub(F,D);this._normalize(G);const H=this._crossProduct(G,this._sub(e,D));this._leftPerpendicular(G);const J=[];J.push(e);J.push([D[0]+G[0]*H,D[1]+G[1]*H]);a.push(J);const L=[];L.push([D[0]-G[0]*H,D[1]-G[1]*H]);L.push(B);a.push(L);break;case C.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const K=
this._cp2(b,0,-1),U=this._cp3(b,K,.5,3),X=this._mid(e,K),Z=this._sub(X,U);this._normalize(Z);const aa=this._crossProduct(Z,this._sub(e,U));this._leftPerpendicular(Z);const da=[];da.push([U[0]+Z[0]*aa,U[1]+Z[1]*aa]);da.push([U[0]-Z[0]*aa,U[1]-Z[1]*aa]);a.push(da);break;case C.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const R=this._cp2(b,0,-1),M=this._cp3(b,R,.5,4),Q=this._mid(e,R),N=this._sub(Q,M);this._normalize(N);const S=this._crossProduct(N,this._sub(e,M));this._leftPerpendicular(N);
const W=[];W.push([M[0]+N[0]*S*.8,M[1]+N[1]*S*.8]);W.push([Q[0]+.8*(e[0]-Q[0]),Q[1]+.8*(e[1]-Q[1])]);a.push(W);a.push([M,Q]);const T=[];T.push([M[0]-N[0]*S*.8,M[1]-N[1]*S*.8]);T.push([Q[0]+.8*(R[0]-Q[0]),Q[1]+.8*(R[1]-Q[1])]);a.push(T);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const ba=this._cp2(b,0,-1),I=this._cp3(b,ba,.5,4),P=this._mid(e,ba);let O=this._sub(ba,e);const V=Math.cos(Math.PI/18),Y=Math.sin(Math.PI/18),ca=Math.sqrt((1+V)/2),ea=Math.sqrt((1-V)/2),fa=[];
let ha;0<this._crossProduct(O,this._sub(I,e))?(fa.push(e),O=this._sub(e,P),ha=ba):(fa.push(ba),O=this._sub(ba,P),ha=e);this._rotateDirect(O,ca,ea);O[0]/=ca;O[1]/=ca;for(let ra=1;18>=ra;ra++)fa.push(this._add(P,O)),this._rotateDirect(O,V,Y);fa.push(ha);a.push(fa);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const ia=this._cp2(b,0,-1),la=this._cp3(b,ia,1,-1);let ka=this._sub(e,ia);this._normalize(ka);const ja=this._crossProduct(ka,this._sub(la,ia))/2;this._leftPerpendicular(ka);
const ma=[ia[0]+ka[0]*ja,ia[1]+ka[1]*ja];ka=this._sub(ia,ma);const na=Math.cos(Math.PI/18);let pa=Math.sin(Math.PI/18);0<ja&&(pa=-pa);const oa=[ia];for(let ra=1;18>=ra;ra++)this._rotateDirect(ka,na,pa),oa.push(this._add(ma,ka));a.push(oa);break;case C.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const sa=this._cp2(b,0,-2),qa=this._cp3(b,sa,1,-1);let ta;if(4<=d)ta=b[3];else{const ra=this._sub(e,sa);ta=this._add(qa,ra)}const wa=this._dist(sa,qa)/2/.75,Aa=this._sub(sa,e);this._normalize(Aa,
wa);const ua=this._sub(qa,ta);this._normalize(ua,wa);a.push([ta,qa]);const xa=[this._clone(qa)];this._addBezier3(xa,qa,this._add(qa,ua),this._add(sa,Aa),sa,4);xa.push(e);a.push(xa);break;case C.GeometricEffectControlMeasureLineRule.OpenCircle:const za=this._cp2(b,-2,0),va=this._sub(za,e),Ia=Math.cos(Math.PI/18),Qa=-Math.sin(Math.PI/18),Ma=[za];for(let ra=1;33>=ra;ra++)this._rotateDirect(va,Ia,Qa),Ma.push(this._add(e,va));a.push(Ma);break;case C.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const Ba=
this._cp2(b,0,-1);let Ea;if(3<=d)Ea=b[2];else{const ra=this._sub(Ba,e),ya=this._leftPerp(ra);Ea=[e[0]+ya[0]-.25*ra[0],e[1]+ya[1]-.25*ra[1]]}let Ha;if(4<=d)Ha=b[3];else{const ra=this._mid(e,Ba),ya=this._sub(e,Ba);this._normalize(ya);this._leftPerpendicular(ya);const Fa=this._crossProduct(ya,this._sub(Ea,ra));this._rightPerpendicular(ya);Ha=[Ea[0]+ya[0]*Fa*2,Ea[1]+ya[1]*Fa*2]}const Ga=this._sub(Ba,e);let Ca,Ja;Ca=0<this._crossProduct(Ga,this._sub(Ea,e))?this._rightPerp(Ga):this._leftPerp(Ga);Ja=[];
Ja.push(Ea);Ja.push(e);Ja.push([e[0]+(Ca[0]-Ga[0])/3,e[1]+(Ca[1]-Ga[1])/3]);a.push(Ja);Ca=0<this._crossProduct(Ga,this._sub(Ha,Ba))?this._rightPerp(Ca):this._leftPerp(Ga);Ja=[];Ja.push([Ba[0]+(Ca[0]+Ga[0])/3,Ba[1]+(Ca[1]+Ga[1])/3]);Ja.push(Ba);Ja.push(Ha);a.push(Ja);break;case C.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const La=this._cp2(b,0,2),Sb=this._cp3(b,La,0,1);let Ab;if(4<=d)Ab=b[3];else{const ra=this._sub(La,e);Ab=this._add(Sb,ra)}this._addAngledTicks(a,e,La,this._mid(Sb,
Ab));this._addAngledTicks(a,Sb,Ab,this._mid(e,La));break;case C.GeometricEffectControlMeasureLineRule.GapExtentMidline:const Tb=this._cp2(b,2,0),pc=this._cp3(b,Tb,0,1);let Ub;if(4<=d)Ub=b[3];else{const ra=this._sub(Tb,e);Ub=this._add(pc,ra)}const Vb=[];Vb.push(this._mid(e,pc));Vb.push(this._mid(Tb,Ub));a.push(Vb);break;case C.GeometricEffectControlMeasureLineRule.Chevron:const qc=this._cp2(b,-1,-1);let Wb;if(3<=d)Wb=b[2];else{const ra=this._sub(qc,e);this._leftPerpendicular(ra);Wb=this._add(e,ra)}a.push([qc,
this._makeCtrlPt(e),Wb]);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const hb=this._cp2(b,0,-2),rc=this._cp3(b,hb,.5,-1);let Da=this._sub(hb,e);const ib=this._norm(Da);Da[0]/=ib;Da[1]/=ib;const $a=this._crossProduct(Da,this._sub(rc,e));let jb=this._dotProduct(Da,this._sub(rc,e));jb<.05*ib?jb=.05*ib:jb>.95*ib&&(jb=.95*ib);const Bb=[e[0]+Da[0]*jb,e[1]+Da[1]*jb];this._leftPerpendicular(Da);let kb=[];kb.push([Bb[0]-Da[0]*$a,Bb[1]-Da[1]*$a]);kb.push([Bb[0]+Da[0]*$a,Bb[1]+Da[1]*
$a]);a.push(kb);const sc=[hb[0]+Da[0]*$a,hb[1]+Da[1]*$a];Da=this._sub(hb,sc);const Rc=Math.cos(Math.PI/18);let Xb=Math.sin(Math.PI/18);0>$a&&(Xb=-Xb);kb=[e,hb];for(let ra=1;9>=ra;ra++)this._rotateDirect(Da,Rc,Xb),kb.push(this._add(sc,Da));a.push(kb);break;case C.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Yb=this._cp2(b,2,0),tc=this._mid(e,Yb),uc=this._sub(Yb,tc),Sc=Math.cos(Math.PI/18),Tc=Math.sin(Math.PI/18),vc=[e,Yb];for(let ra=1;18>=ra;ra++)this._rotateDirect(uc,Sc,Tc),vc.push(this._add(tc,
uc));a.push(vc);break;case C.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const ab=this._cp2(b,0,-2),Zb=this._cp3(b,ab,1,-2),bb=this._mid(e,ab),Pa=this._sub(Zb,ab);this._normalize(Pa);const wc=Math.abs(this._crossProduct(Pa,this._sub(bb,ab)))/2,lb=this._dist(ab,Zb),xc=[ab,e];xc.push([e[0]+Pa[0]*lb*.5,e[1]+Pa[1]*lb*.5]);a.push(xc);const mb=[];mb.push([bb[0]-Pa[0]*wc,bb[1]-Pa[1]*wc]);mb.push([bb[0]+Pa[0]*lb*.375,bb[1]+Pa[1]*lb*.375]);E.setId(mb[mb.length-1],1);mb.push([bb[0]+Pa[0]*lb*
.75,bb[1]+Pa[1]*lb*.75]);a.push(mb);a.push([ab,Zb]);break;case C.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const qb=this._cp2(b,3,0),$b=this._cp3(b,qb,.5,-1),rb=this._sub($b,qb);this._normalize(rb);const yc=this._crossProduct(rb,this._sub($b,e));this._leftPerpendicular(rb);this._addAngledTicks(a,e,qb,$b);this._addAngledTicks(a,this._mix(e,1,rb,yc),this._mix(qb,1,rb,yc),this._mid(e,qb));break;case C.GeometricEffectControlMeasureLineRule.Parallel:const sb=this._cp2(b,3,0),Uc=this._cp3(b,
sb,.5,-1),ac=this._sub(sb,e);this._normalize(ac);const Cb=this._leftPerp(ac),Db=this._crossProduct(ac,this._sub(Uc,e));let tb=[e,sb];a.push(tb);tb=[];tb.push([e[0]+Cb[0]*Db,e[1]+Cb[1]*Db]);tb.push([sb[0]+Cb[0]*Db,sb[1]+Cb[1]*Db]);a.push(tb);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const bc=this._cp2(b,3,0),Vc=this._cp3(b,bc,.5,-1),Eb=this._mid(e,bc),cb=this._sub(bc,e);this._normalize(cb);const Fb=this._crossProduct(cb,this._sub(Vc,e));this._leftPerpendicular(cb);
const cc=[];cc.push([Eb[0]-cb[0]*Fb*.25,Eb[1]-cb[1]*Fb*.25]);cc.push([Eb[0]+cb[0]*Fb*1.25,Eb[1]+cb[1]*Fb*1.25]);a.push(cc);break;case C.GeometricEffectControlMeasureLineRule.ParallelOffset:const nb=this._cp2(b,3,0),Wc=this._cp3(b,nb,.5,-1),Na=this._sub(nb,e);this._normalize(Na);const Ta=this._crossProduct(Na,this._sub(Wc,e));this._leftPerpendicular(Na);const dc=[];dc.push([e[0]-Na[0]*Ta,e[1]-Na[1]*Ta]);dc.push([nb[0]-Na[0]*Ta,nb[1]-Na[1]*Ta]);a.push(dc);const ec=[];ec.push([e[0]+Na[0]*Ta,e[1]+Na[1]*
Ta]);ec.push([nb[0]+Na[0]*Ta,nb[1]+Na[1]*Ta]);a.push(ec);break;case C.GeometricEffectControlMeasureLineRule.OffsetOpposite:const Gb=this._cp2(b,3,0),Xc=this._cp3(b,Gb,.5,-1),db=this._sub(Gb,e);this._normalize(db);const Hb=this._crossProduct(db,this._sub(Xc,e));this._leftPerpendicular(db);const fc=[];fc.push([e[0]-db[0]*Hb,e[1]-db[1]*Hb]);fc.push([Gb[0]-db[0]*Hb,Gb[1]-db[1]*Hb]);a.push(fc);break;case C.GeometricEffectControlMeasureLineRule.OffsetSame:const Ib=this._cp2(b,3,0),Yc=this._cp3(b,Ib,.5,
-1),eb=this._sub(Ib,e);this._normalize(eb);const Jb=this._crossProduct(eb,this._sub(Yc,e));this._leftPerpendicular(eb);const gc=[];gc.push([e[0]+eb[0]*Jb,e[1]+eb[1]*Jb]);gc.push([Ib[0]+eb[0]*Jb,Ib[1]+eb[1]*Jb]);a.push(gc);break;case C.GeometricEffectControlMeasureLineRule.CircleWithArc:let Ua=this._cp2(b,3,0);const hc=this._cp3(b,Ua,.5,-1);let ob,Kb;if(4<=d)ob=b[3],Kb=0<this._crossProduct(this._sub(ob,Ua),this._sub(hc,Ua));else{ob=Ua;Kb=0<this._crossProduct(this._sub(ob,e),this._sub(hc,e));const ra=
24*this._geomUnitsPerPoint,ya=this._sub(ob,e);this._normalize(ya,ra);const Fa=Math.sqrt(2)/2;this._rotateDirect(ya,Fa,Kb?Fa:-Fa);Ua=this._add(e,ya)}const zc=this._sub(Ua,e),Zc=Math.cos(Math.PI/18),$c=Math.sin(Math.PI/18),ub=[Ua];for(let ra=1;36>=ra;ra++)this._rotateDirect(zc,Zc,$c),ub.push(this._add(e,zc));this._add90DegArc(ub,Ua,ob,hc,Kb);E.setId(ub[ub.length-8],1);a.push(ub);break;case C.GeometricEffectControlMeasureLineRule.DoubleJog:let Va=this._cp2(b,-3,1),Wa;Wa=3<=d?b[2]:this._add(e,this._sub(e,
Va));let Ra;if(4<=d)Ra=b[3];else{const ra=e;e=Va;Ra=Wa;const ya=this._dist(e,ra),Fa=this._dist(Ra,ra);let Xa=30*this._geomUnitsPerPoint;.5*ya<Xa&&(Xa=.5*ya);.5*Fa<Xa&&(Xa=.5*Fa);Va=this._mix(e,Xa/ya,ra,(ya-Xa)/ya);Wa=this._mix(Ra,Xa/Fa,ra,(Fa-Xa)/Fa)}const Ac=this._mid(e,Va),Bc=this._mid(Ra,Wa),ad=this._dist(e,Va),bd=this._dist(Wa,Ra);let Lb=Math.min(ad,bd)/8;Lb=Math.min(Lb,24*this._geomUnitsPerPoint);const Ya=Math.cos(Math.PI/4);let Ka=this._sub(e,Va);this._normalize(Ka,Lb);0<this._crossProduct(Ka,
this._sub(Ra,Va))?this._rotateDirect(Ka,Ya,-Ya):this._rotateDirect(Ka,Ya,Ya);let Oa=[];Oa.push(Va);Oa.push(this._add(Ac,Ka));Oa.push(this._sub(Ac,Ka));Oa.push(e);a.push(Oa);Ka=this._sub(Ra,Wa);this._normalize(Ka,Lb);0>this._crossProduct(Ka,this._sub(e,Wa))?this._rotateDirect(Ka,Ya,Ya):this._rotateDirect(Ka,Ya,-Ya);Oa=[];Oa.push(Wa);Oa.push(this._add(Bc,Ka));Oa.push(this._sub(Bc,Ka));Oa.push(Ra);a.push(Oa);break;case C.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Mb=this._cp2(b,
-4,1),Cc=this._cp3(b,Mb,.882353,-1.94),vb=this._sub(Cc,Mb);0<this._crossProduct(vb,this._sub(e,Mb))?this._rightPerpendicular(vb):this._leftPerpendicular(vb);const cd=[vb[0]/8,vb[1]/8],dd=this._sub(this._mid(Mb,Cc),cd);a.push([dd,e]);break;case C.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Dc=this._arrowPath(b),Ec=[];let Fc=Dc.length-2;for(;Fc--;)Ec.push(Dc[Fc]);a.push(Ec);break;case C.GeometricEffectControlMeasureLineRule.MultivertexArrow:const ed=this._arrowPath(b),Gc=[];
this._addArrow(Gc,ed,!1);a.push(Gc);break;case C.GeometricEffectControlMeasureLineRule.CrossedArrow:const fd=this._arrowPath(b),Hc=[];this._addArrow(Hc,fd,!0);a.push(Hc);break;case C.GeometricEffectControlMeasureLineRule.ChevronArrow:const [Ic,wb]=this._arrowLastSeg(b),Nb=10*this._geomUnitsPerPoint,fb=this._sub(e,Ic);this._normalize(fb);const Jc=this._crossProduct(fb,this._sub(wb,Ic)),Kc=this._leftPerp(fb),Lc=[wb[0]-Kc[0]*Jc*2,wb[1]-Kc[1]*Jc*2],Ob=[];Ob.push([wb[0]+fb[0]*Nb,wb[1]+fb[1]*Nb]);Ob.push(e);
Ob.push([Lc[0]+fb[0]*Nb,Lc[1]+fb[1]*Nb]);a.push(Ob);break;case C.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Mc,ic]=this._arrowLastSeg(b),Sa=this._sub(e,Mc);this._normalize(Sa);const pb=this._crossProduct(Sa,this._sub(ic,Mc));this._leftPerpendicular(Sa);const xb=[ic[0]-Sa[0]*pb,ic[1]-Sa[1]*pb],Pb=[];Pb.push([xb[0]+Sa[0]*pb*.5,xb[1]+Sa[1]*pb*.5]);Pb.push(this._mid(xb,e));Pb.push([xb[0]-Sa[0]*pb*.5,xb[1]-Sa[1]*pb*.5]);a.push(Pb);break;case C.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [jc,
kc]=this._arrowLastSeg(b),yb=this._sub(e,jc);this._normalize(yb);const Nc=this._crossProduct(yb,this._sub(kc,jc));this._leftPerpendicular(yb);a.push([jc,[kc[0]-yb[0]*Nc,kc[1]-yb[1]*Nc]]);break;case C.GeometricEffectControlMeasureLineRule.Arch:const lc=this._cp2(b,0,-1),Qb=this._cp3(b,lc,.5,1),Oc=this._sub(e,lc),gd=this._mix(Qb,1,Oc,.55),hd=this._mix(Qb,1,Oc,-.55),mc=[e];this._addBezier2(mc,e,gd,Qb,4);this._addBezier2(mc,Qb,hd,lc,4);a.push(mc);break;case C.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const Za=
this._cp2(b,-4,1),zb=this._cp3(b,Za,.882353,-1.94),gb=this._sub(zb,Za);0<this._crossProduct(gb,this._sub(e,Za))?this._rightPerpendicular(gb):this._leftPerpendicular(gb);const nc=[gb[0]/8,gb[1]/8],Pc=this._sub(this._mid(Za,zb),nc),id=this._sub(this._mix(Za,.75,zb,.25),nc),jd=this._sub(this._mix(Za,.25,zb,.75),nc),Rb=[Za];this._addBezier2(Rb,Za,id,Pc,3);this._addBezier2(Rb,Pc,jd,zb,3);a.push(Rb);for(let ra=0;8>ra;ra++){const ya=Rb[2*ra+1],Fa=[this._clone(ya)];Fa.push(this._add(ya,[gb[0]/4,gb[1]/4]));
a.push(Fa)}break;case C.GeometricEffectControlMeasureLineRule.Arc90Degrees:const oc=this._cp2(b,0,-1),kd=this._cp3(b,oc,.5,1),Qc=[oc];this._add90DegArc(Qc,oc,e,kd);a.push(Qc);break;default:a.push(b)}}return a};return m}();q.EffectControlMeasureLine=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,t,E,
C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(m){function l(c,a,b){c=m.call(this,c,!0,!0)||this;c._curveHelper=new C.CurveHelper;c._beginCut=(void 0!==a.beginCut?a.beginCut:1)*b;c._endCut=(void 0!==a.endCut?a.endCut:1)*b;c._middleCut=(void 0!==a.middleCut?a.middleCut:0)*b;c._invert=void 0!==a.invert?a.invert:!1;0>c._beginCut&&(c._beginCut=
0);0>c._endCut&&(c._endCut=0);0>c._middleCut&&(c._middleCut=0);return c}t._inheritsLoose(l,m);l.prototype.processPath=function(c){var a=this._beginCut;const b=this._endCut,d=this._middleCut,e=this._curveHelper.calculatePathLength(c),p=[];if(!this._invert)0===a&&0===b&&0===d?p.push(c):a+b+d>=e||(0===d?(c=this._curveHelper.getSubCurve(c,a,e-b))&&p.push(c):((a=this._curveHelper.getSubCurve(c,a,.5*(e-d)))&&p.push(a),(a=this._curveHelper.getSubCurve(c,.5*(e+d),e-b))&&p.push(a)));else if(0!==a||0!==b||
0!==d)a+b+d>=e?p.push(c):((a=this._curveHelper.getSubCurve(c,0,a))&&p.push(a),(a=this._curveHelper.getSubCurve(c,.5*(e-d),.5*(e+d)))&&p.push(a),(a=this._curveHelper.getSubCurve(c,e-b,b))&&p.push(a));return 0===p.length?null:{paths:p}};return l}(E.PathGeometryCursor);q.EffectCut=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(q,t,E,C,A,y){let m=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(a,b,d,e){return new l(a,b,d)};return c}();m.instance=null;let l=function(c){function a(b,d,e){b=c.call(this,b,!0,!0)||this;b._firstCurve=null;b._walker=new y.GeometryWalker;b._walker.updateTolerance(e);b._endings=d.lineDashEnding;b._customDashPos=-(d.offsetAlongLine??0)*e;b._offsetAtEnd=(d.customEndingOffset??0)*e;b._pattern=new y.DashPattern;
b._pattern.init(d.dashTemplate,!0);b._pattern.scale(e);return b}t._inheritsLoose(a,c);a.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var d=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case A.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case A.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case A.LineDashEnding.NoConstraint:this.isClosed||
(d=!1);break;case A.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var e=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||e<.1*this._pattern.length()||!this._walker.init(b,this._pattern,d))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{switch(this._endings){default:d=.5*this._pattern.firstValue();break;case A.LineDashEnding.HalfGap:d=.5*-this._pattern.lastValue();break;case A.LineDashEnding.FullGap:d=-this._pattern.lastValue();
break;case A.LineDashEnding.FullPattern:d=0;break;case A.LineDashEnding.NoConstraint:case A.LineDashEnding.Custom:d=-this._customDashPos}b=d/this._pattern.length();b-=Math.floor(b);d=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(e=!1;d>=b;)d-=b,b=this._pattern.nextValue(),e=!e;b-=d;e?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(d=
this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),C.PathHelper.mergePath(d,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(d=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,d=this._firstCurve,this._firstCurve=null);return{paths:[d]}};return a}(E.PathGeometryCursor);q.EffectDashes=
m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(q,t,E,C){let A=function(){function l(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var c=l.prototype;c.isEmpty=function(){return 0===this._values.length};c.size=function(){return this._values.length};c.init=function(a,b,d=!0){this._setEmpty();
if(!a||0===a.length)return!1;for(let e=0;e<a.length;e++){let p=Math.abs(a[e]);d&&1E-7>p&&(p=1E-7);this._values.push(p);this._length+=p}b&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};c.scale=function(a){const b=this._values?this._values.length:0;for(let d=0;d<b;++d)this._values[d]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};c.addValue=function(a){this._length+=a;this._values.push(a)};c.firstValue=function(){return this._values[0]};
c.lastValue=function(){return this._values[this._values.length-1]};c.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};c.reset=function(){this._currentValue=-1};c.length=function(){return this._length};c._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return l}();q.EndType=void 0;(function(l){l[l.FAIL=0]="FAIL";l[l.END=1]="END";l[l.CONTINUE=
2]="CONTINUE"})(q.EndType||(q.EndType={}));let y=function(){function l(){this.reset()}var c=l.prototype;c.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};c.isValid=function(){return-1!==this.segment};c.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return l}(),m=function(l){function c(b=0,d=!1){b=l.call(this,b,d)||this;b._tolerance=C.PIXEL_TOLERANCE;
b._currentPosition=new y;return b}t._inheritsLoose(c,l);var a=c.prototype;a.updateTolerance=function(b){this._tolerance=C.PIXEL_TOLERANCE*b};a.init=function(b,d,e=!0){e?(this._patternLength=d.length(),this._partExtPtGap=d.extPtGap,this._partCtrlPtGap=d.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=b;this._seg=-1;return this._setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};
a.nextPosition=function(b,d=q.EndType.FAIL){const e=new y;if(!this._nextPosition(b,e,null,d))return!1;e.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(b){b.pt=this._getPoint(this._currentPosition);const [d,e]=this._getAngle(this._currentPosition);b.ca=d;b.sa=e};a.nextPointAndAngle=function(b,d,e=q.EndType.FAIL){const p=new y;if(!this._nextPosition(b,p,null,e))return!1;p.copyTo(this._currentPosition);d.pt=this._getPoint(p);const [r,v]=this._getAngle(p);d.ca=r;d.sa=v;return!0};
a.nextCurve=function(b){if(0===b)return null;const d=[],e=new y;if(!this._nextPosition(b,e,d,q.EndType.END))return null;e.copyTo(this._currentPosition);return d};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};a._nextPosition=function(b,d,e,p){if(this._currentPosition.isPathEnd)return!1;var r=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&
(r/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(d);d.abscissa+b*this._partLengthRatio>d.segmentLength+this._tolerance;)if(e&&(0===e.length&&(0===r?(r=this._path[d.segment],e.push([r[0],r[1]])):e.push(this.getSegCoord2D(this._path,d.segment,r))),r=this._path[d.segment+1],e.push([r[0],r[1]])),r=0,b-=(d.segmentLength-d.abscissa)/this._partLengthRatio,this._partSegCount)d.segment=this._nextSegment(),d.segmentLength=this.calculateSegLength(this._path,d.segment),d.abscissa=0,this._partSegCount--;
else{if(!this._setPosAtNextPart()){if(p===q.EndType.FAIL)return!1;d.segmentLength=this.calculateSegLength(this._path,d.segment);d.isPartEnd=!0;p===q.EndType.END?(d.abscissa=d.segmentLength,d.isPathEnd=!0):d.abscissa=d.segmentLength+b;return!0}this._currentPosition.copyTo(d)}d.abscissa+=b*this._partLengthRatio;e&&(0===e.length&&(0===r?(b=this._path[d.segment],e.push([b[0],b[1]])):e.push(this.getSegCoord2D(this._path,d.segment,r))),b=d.abscissa/d.segmentLength,1===b?(b=this._path[d.segment+1],e.push([b[0],
b[1]])):e.push(this.getSegCoord2D(this._path,d.segment,b)));!this._partSegCount&&Math.abs(d.abscissa-d.segmentLength)<this._tolerance&&(d.isPathEnd=this._partIsLast,d.isPartEnd=!0);return!0};a._getPoint=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,b.segment,0>=b.segmentLength?0:b.abscissa/b.segmentLength)};a._getAngle=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,b.segment,0>=b.segmentLength?0:
b.abscissa/b.segmentLength)};a._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===E.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var b=this._partSegCount;b;)this._previousSegment(),
--b;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;b=this._getStartPointIndex();this._ctrlPtBegin=1===E.getId(this._path[b]);b=b+this._partSegCount+1;b>=this._path.length&&(b=0);this._ctrlPtEnd=1===E.getId(this._path[b]);if(0<this._patternLength){b=this._ctrlPtBegin?this._partCtrlPtGap:
this._partExtPtGap;const d=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(b+d))/this._patternLength);0>=e&&(e=0<b+d?0:1);this._partLengthRatio=this._partLength/(b+d+e*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};a._hasNextSegment=function(){return this._seg<this._path.length-2};a._previousSegment=function(){return--this._seg};a._nextSegment=function(){return++this._seg};a._getStartPointIndex=
function(){return this._seg};a._getEndPointIndex=function(){return this._seg+1};return c}(C.CurveHelper);q.DashPattern=A;q.GeometryWalker=m;q.Pos=function(){this.pt=null;this.sa=this.ca=0};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&
(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(){function m(l,c,a){this._inputGeometries=l;this._curveHelper=new E.CurveHelper;this._width=(void 0!==c.width?c.width:2)*a;switch(c.method){default:this._method=C.GeometricEffectOffsetMethod.Mitered;break;case C.GeometricEffectDonutMethod.Bevelled:this._method=C.GeometricEffectOffsetMethod.Bevelled;break;case C.GeometricEffectDonutMethod.Rounded:case C.GeometricEffectDonutMethod.TrueBuffer:this._method=
C.GeometricEffectOffsetMethod.Rounded;break;case C.GeometricEffectDonutMethod.Square:this._method=C.GeometricEffectOffsetMethod.Square}this._option=c.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*a}m.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(t.isExtent(l)&&0<this._width){if(0>Math.min(l.xmax-l.xmin,l.ymax-l.ymin)-2*this._width)return l;var c=[];c.push([[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]);c.push([[l.xmin+this._width,l.ymin+
this._width],[l.xmax-this._width,l.ymin+this._width],[l.xmax-this._width,l.ymax-this._width],[l.xmin+this._width,l.ymax-this._width],[l.xmin+this._width,l.ymin+this._width]]);return{rings:c}}if(t.isPolygon(l)&&0<this._width){c=[];for(const a of l.rings){l=this._curveHelper.calculatePathLength(a);const b=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);b&&(0>l&&b.reverse(),c.push(b))}if(c.length)return{rings:c}}l=this._inputGeometries.next()}return null};return m}();
q.EffectDonut=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(m){function l(c,a,b){c=
m.call(this,c,!1,!0)||this;c._curveHelper=new C.CurveHelper;c._length=(void 0!==a.length?a.length:20)*b;c._angle=void 0!==a.angle?a.angle:225;c._position=void 0!==a.position?a.position:50;0>c._length&&(c._length=-c._length);20>c._position&&(c._position=20);80<c._position&&(c._position=80);c._mirror=!1;return c}t._inheritsLoose(l,m);l.prototype.processPath=function(c){if(this._curveHelper.isEmpty(c,!1))return null;const a=c[0];c=c[c.length-1];this._curveHelper.normalize([c[0]-a[0],c[1]-a[1]]);const b=
[a[0]+(c[0]-a[0])*this._position/100,a[1]+(c[1]-a[1])*this._position/100],d=Math.cos((90-this._angle)/180*Math.PI);let e=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(e=-e);this._mirror=!this._mirror;return{paths:[[a,[b[0]-this._length/2*d,b[1]-this._length/2*e],[b[0]+this._length/2*d,b[1]+this._length/2*e],c]]}};return l}(E.PathGeometryCursor);q.EffectJog=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports",
"../../../core/lang","../../../geometry/support/jsonUtils"],function(q,t,E){let C=function(){function y(){}y.local=function(){null===y.instance&&(y.instance=new y);return y.instance};y.prototype.execute=function(m,l,c,a){return new A(m,l,c)};return y}();C.instance=null;let A=function(){function y(l,c,a){this._inputGeometries=l;this._offsetX=void 0!==c.offsetX?c.offsetX*a:0;this._offsetY=void 0!==c.offsetY?-c.offsetY*a:0}var m=y.prototype;m.next=function(){for(var l=this._inputGeometries.next();l;){if(E.isExtent(l))return{xmin:l.xmin+
this._offsetX,xmax:l.xmax+this._offsetX,ymin:l.ymin+this._offsetY,ymax:l.ymax+this._offsetY};if(E.isPolygon(l))return l=t.clone(l),this._moveMultipath(l.rings,this._offsetX,this._offsetY),l;if(E.isPolyline(l))return l=t.clone(l),this._moveMultipath(l.paths,this._offsetX,this._offsetY),l;if(E.isMultipoint(l))return l=t.clone(l),this._movePath(l.points,this._offsetX,this._offsetY),l;if(E.isPoint(l))return{x:l.x+this._offsetX,y:l.y+this._offsetY};l=this._inputGeometries.next()}return null};m._moveMultipath=
function(l,c,a){if(l)for(const b of l)this._movePath(b,c,a)};m._movePath=function(l,c,a){if(l)for(const b of l)b[0]+=c,b[1]+=a};return y}();q.EffectMove=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};
m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(){function m(l,c,a){this._inputGeometries=l;this._curveHelper=new E.CurveHelper;this._offset=(c.offset??1)*a;this._method=c.method;this._option=c.option;this._offsetFlattenError=E.PIXEL_TOLERANCE*a}m.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(0===this._offset)return l;if(t.isExtent(l)){if(this._method===C.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var c=this._curveHelper.offset([[l.xmin,
l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return c?{rings:[c]}:null}if(0<Math.min(l.xmax-l.xmin,l.ymax-l.ymin)+2*this._offset)return{xmin:l.xmin-this._offset,xmax:l.xmax+this._offset,ymin:l.ymin-this._offset,ymax:l.ymax+this._offset}}if(t.isPolygon(l)){var a=[];for(c of l.rings){const b=this._curveHelper.offset(c,-this._offset,this._method,4,this._offsetFlattenError);b&&a.push(b)}if(a.length)return{rings:a}}if(t.isPolyline(l)){a=
[];for(const b of l.paths)(l=this._curveHelper.offset(b,-this._offset,this._method,4,this._offsetFlattenError))&&a.push(l);if(a.length)return{paths:a}}l=this._inputGeometries.next()}return null};return m}();q.EffectOffset=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,t,E,C){let A=function(){function m(){}
m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,c,a)};return m}();A.instance=null;let y=function(){function m(l,c,a){this._inputGeometries=l;this._reverse=void 0!==c.reverse?c.reverse:!0}m.prototype.next=function(){for(var l=this._inputGeometries.next();l;){if(!this._reverse)return l;if(E.isPolyline(l))return l=t.clone(l),C.reverseMultipath(l.paths),l;l=this._inputGeometries.next()}return null};return m}();q.EffectReverse=
A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,a,b)};return l}();
y.instance=null;let m=function(){function l(a,b,d){this._inputGeometries=a;this._rotateAngle=void 0!==b.angle?b.angle*Math.PI/180:0}var c=l.prototype;c.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var b=E.create();C.getBoundsXY(b,a);const d=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(A.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,d,b),a;if(A.isPolygon(a))return a=
t.clone(a),this._rotateMultipath(a.rings,d,b),a;if(A.isPolyline(a))return a=t.clone(a),this._rotateMultipath(a.paths,d,b),a;if(A.isMultipoint(a))return a=t.clone(a),this._rotatePath(a.points,d,b),a;if(A.isPoint(a))return a;a=this._inputGeometries.next()}return null};c._rotateMultipath=function(a,b,d){if(a)for(const e of a)this._rotatePath(e,b,d)};c._rotatePath=function(a,b,d){if(a){const e=Math.cos(this._rotateAngle),p=Math.sin(this._rotateAngle);for(const r of a){a=r[0]-b;const v=r[1]-d;r[0]=b+a*
e-v*p;r[1]=d+a*p+v*e}}};return l}();q.EffectRotate=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=
function(c,a,b,d){return new m(c,a,b)};return l}();y.instance=null;let m=function(){function l(a,b,d){this._inputGeometries=a;this._xFactor=void 0!==b.xScaleFactor?b.xScaleFactor:1.15;this._yFactor=void 0!==b.yScaleFactor?b.yScaleFactor:1.15}var c=l.prototype;c.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var b=E.create();C.getBoundsXY(b,a);const d=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(A.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,
a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,d,b),a;if(A.isPolygon(a))return a=t.clone(a),this._scaleMultipath(a.rings,d,b),a;if(A.isPolyline(a))return a=t.clone(a),this._scaleMultipath(a.paths,d,b),a;if(A.isMultipoint(a))return a=t.clone(a),this._scalePath(a.points,d,b),a;if(A.isPoint(a))return a;a=this._inputGeometries.next()}return null};c._scaleMultipath=function(a,b,d){if(a)for(const e of a)this._scalePath(e,b,d)};c._scalePath=function(a,b,d){if(a)for(const e of a)a=
(e[1]-d)*this._yFactor,e[0]=b+(e[0]-b)*this._xFactor,e[1]=d+a};return l}();q.EffectScale=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,
a,b)};return l}();y.instance=null;let m=function(){function l(a,b,d){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*d;this._period=(void 0!==b.period?b.period:3)*d;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new A.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new A.GeometryWalker;this._walker.updateTolerance(d)}var c=
l.prototype;c.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(t.isPolyline(a)){const b=this._processGeom(a.paths);if(b.length)return{paths:b}}if(t.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};c._processGeom=function(a){const b=[];for(const d of a)if(this._walker.init(d,this._pattern))switch(this._style){default:b.push(this._constructCurve(d,!1));break;case C.GeometricEffectWaveform.Square:b.push(this._constructSquare(d));
break;case C.GeometricEffectWaveform.Triangle:b.push(this._constructTriangle(d));break;case C.GeometricEffectWaveform.Random:b.push(this._constructCurve(d,!0))}else b.push(d);return b};c._constructCurve=function(a,b){const d=new E.PathHelper;var e=this._walker.calculatePathLength(a),p=Math.round(e/this._period);0===p&&(p=1);const r=this._period/16,v=1/(16*p+1);e=2*Math.PI*e/(e/p);p=2*Math.PI*Math.random();const h=2*Math.PI*Math.random(),w=2*Math.PI*Math.random(),u=.75-Math.random()/2,k=.75-Math.random()/
2,g=new A.Pos;this._walker.curPointAndAngle(g);d.startPath(g.pt);let f=0;for(;;)if(this._walker.nextPointAndAngle(r,g)){const n=f;f+=v;let z;if(b){const x=this._height/2*(1+.3*Math.sin(u*e*n+p));z=x*Math.sin(e*n+h);z+=x*Math.sin(k*e*n+w);z/=2}else z=.5*this._height*Math.sin(.5*e*n);d.lineTo([g.pt[0]-z*g.sa,g.pt[1]+z*g.ca])}else{d.lineTo(a[a.length-1]);break}return d.path()};c._constructSquare=function(a){const b=new E.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=
!0;;){let d=!1;if(this._walker.curPositionIsValid()){const e=new A.Pos;this._walker.curPointAndAngle(e);const p=new A.Pos;if(this._walker.nextPointAndAngle(this._period,p)){const r=new A.Pos;this._walker.nextPointAndAngle(this._period,r)&&(a?(b.startPath(e.pt),a=!1):b.lineTo(e.pt),b.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),b.lineTo([p.pt[0]-this._height/2*p.sa,p.pt[1]+this._height/2*p.ca]),b.lineTo([p.pt[0]+this._height/2*p.sa,p.pt[1]-this._height/2*p.ca]),b.lineTo([r.pt[0]+
this._height/2*r.sa,r.pt[1]-this._height/2*r.ca]),d=!0)}}if(!d){b.lineTo(this._walker.getPathEnd());break}}return b.path()};c._constructTriangle=function(a){const b=new E.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let d=!1;if(this._walker.curPositionIsValid()){const e=new A.Pos;this._walker.curPointAndAngle(e);const p=new A.Pos;if(this._walker.nextPointAndAngle(this._period/2,p)){const r=new A.Pos;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/
2)&&(a?(b.startPath(e.pt),a=!1):b.lineTo(e.pt),b.lineTo([p.pt[0]-this._height/2*p.sa,p.pt[1]+this._height/2*p.ca]),b.lineTo([r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca])),d=!0)}}if(!d){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return l}();q.EffectWave=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../enums","../GeometryWalker"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,a,b)};return l}();y.instance=null;let m=function(l){function c(b,d,e){b=l.call(this,b,!0,!0)||this;b._geometryWalker=new A.GeometryWalker;b._geometryWalker.updateTolerance(e);b._angleToLine=d.angleToLine??!0;b._offset=(d.offset?d.offset:0)*e;b._originalEndings=d.endings;b._offsetAtEnd=
(d.customEndingOffset?d.customEndingOffset:0)*e;b._position=-(d.offsetAlongLine?d.offsetAlongLine:0)*e;b._pattern=new A.DashPattern;b._pattern.init(d.placementTemplate,!1);b._pattern.scale(e);b._endings=b._originalEndings;return b}t._inheritsLoose(c,l);var a=c.prototype;a.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath)var d=this._pattern.nextValue();else{this._endings=this._originalEndings===C.PlacementEndings.WithFullGap&&this.isClosed?C.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let e=!0;switch(this._endings){case C.PlacementEndings.NoConstraint:d=-this._position;d=this._adjustPosition(d);e=!1;break;default:d=-this._pattern.lastValue()/2;break;case C.PlacementEndings.WithFullGap:d=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case C.PlacementEndings.WithMarkers:d=0;break;case C.PlacementEndings.Custom:d=-this._position,d=this._adjustPosition(d),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(b,
this._pattern,e))return null;this._pattern.reset();for(b=0;d>b;)d-=b,b=this._pattern.nextValue();d=b-d;this.iteratePath=!0}b=new A.Pos;if(!this._geometryWalker.nextPointAndAngle(d,b)||this._endings===C.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===C.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(b.pt[0]-this._offset*b.sa,b.pt[1]+this._offset*
b.ca);this._angleToLine&&this.internalPlacement.setRotateCS(b.ca,b.sa);return this.internalPlacement};a._adjustPosition=function(b){b/=this._pattern.length();b-=Math.floor(b);return b*this._pattern.length()};return c}(E.PathTransformationCursor);q.PlacementAlongLineSameSize=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,a,b)};return l}();y.instance=null;let m=function(l){function c(b,d,e){b=l.call(this,b,!1,!0)||this;b._curveHelper=new C.CurveHelper;b._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;b._offset=void 0!==d.offset?d.offset*e:0;b._type=d.extremityPlacement;b._position=void 0!==d.offsetAlongLine?
d.offsetAlongLine*e:0;b._beginProcessed=!1;return b}t._inheritsLoose(c,l);var a=c.prototype;a.processPath=function(b){let d;switch(this._type){default:this._beginProcessed?(d=this._atExtremities(b,this._position,!1),this.iteratePath=this._beginProcessed=!1):(d=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case A.ExtremityPlacement.JustBegin:d=this._atExtremities(b,this._position,!0);break;case A.ExtremityPlacement.JustEnd:d=this._atExtremities(b,this._position,
!1);case A.ExtremityPlacement.None:}return d};a._atExtremities=function(b,d,e){var p=b.length;if(2>p)return null;var r=e?1:p-2;const v=e?p:-1,h=e?1:-1;let w=0;e=e?b[0]:b[p-1];for(p=r;p!==v;p+=h){r=e;e=b[p];const u=this._curveHelper.calculateLength(r,e);if(w+u>d){b=(d-w)/u;const [k,g]=this._curveHelper.getAngleCS(r,e,b);b=E.getCoord2D(r,e,b);this.internalPlacement.setTranslate(b[0]-this._offset*g,b[1]+this._offset*k);this._angleToLine&&this.internalPlacement.setRotateCS(-k,-g);return this.internalPlacement}w+=
u}return null};return c}(E.PathTransformationCursor);q.PlacementAtExtremities=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(l,c,a,b){return new y(l,
c,a)};return m}();A.instance=null;let y=function(m){function l(c,a,b){c=m.call(this,c,!0,!0)||this;c._walker=new C.GeometryWalker;c._walker.updateTolerance(b);c._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;c._offset=void 0!==a.offset?a.offset*b:0;c._beginGap=void 0!==a.beginPosition?a.beginPosition*b:0;c._endGap=void 0!==a.endPosition?a.endPosition*b:0;c._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;c._pattern=new C.DashPattern;c._pattern.init(a.positionArray,!1,!1);c._subPathLen=0;c._posCount=
c._pattern.size();c._isFirst=!0;c._prevPos=0;return c}t._inheritsLoose(l,m);l.prototype.processPath=function(c){if(this._pattern.isEmpty())return null;if(this.iteratePath){c=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+c;c=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(c)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(c,
this._pattern,!1))return null;this._pattern.reset();c=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+c;c=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a=new C.Pos;if(!this._walker.nextPointAndAngle(c,a,C.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);c=this._isFirst&&this._flipFirst;let b;this._angleToLine?(b=a.ca,a=a.sa):(b=1,a=0);c&&(b=-b,a=-a);this.internalPlacement.setRotateCS(b,a);this._isFirst=
!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return l}(E.PathTransformationCursor);q.PlacementAtRatioPositions=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/RandomLCG","../CIMPlacements","../enums"],function(q,t,E,C){let A=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};
m.prototype.execute=function(l,c,a,b){return new y(l,c,a,b)};return m}();A.instance=null;let y=function(){function m(c,a,b,d){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=Math.abs(a.stepX??16)*b;this._stepY=Math.abs(a.stepY??16)*b;if(0!==this._stepX&&0!==this._stepY&&c&&void 0!==c.rings&&c.rings){this._gridType=a.gridType??C.PlacementGridType.Fixed;if(this._gridType===C.PlacementGridType.Random)this._randomLCG=new t(1*(a.seed??13)),this._randomness=(a.randomness??
100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=a.gridAngle??0;this._shiftOddRows=a.shiftOddRows??!1;this._offsetX=(a.offsetX??0)*b;this._offsetY=(a.offsetY??0)*b;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=
this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new E.Placement;this._calculateMinMax(c);this._geometry=c}}var l=m.prototype;l.next=function(){return this._geometry?this._nextInside():null};l._calculateMinMax=function(c){this._yMax=this._yMin=this._xMax=this._xMin=0;let a,b,d,e,p;b=d=Number.MAX_VALUE;e=
p=-Number.MAX_VALUE;for(const v of c.rings){const h=v?v.length:0;for(let w=0;w<h;++w){var r=v[w][0]-this._graphicOriginX-this._offsetX;a=v[w][1]-this._graphicOriginY-this._offsetY;c=this._cosAngle*r-this._sinAngle*a;r=this._sinAngle*r+this._cosAngle*a;b=Math.min(b,c);e=Math.max(e,c);d=Math.min(d,r);p=Math.max(p,r)}}b+=this._graphicOriginX;e+=this._graphicOriginX;d+=this._graphicOriginY;p+=this._graphicOriginY;this._xMin=Math.round(b/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(d/
this._stepY);this._yMax=Math.round(p/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};l._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var c=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(c+=.5*this._stepX);const a=this._currentY*this._stepY+this._offsetY;this._currentX++;let b;this._gridType===
C.PlacementGridType.Random?(b=this._graphicOriginX+c+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,c=this._graphicOriginY+a+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(b=this._graphicOriginX+this._cosAngle*c+this._sinAngle*a,c=this._graphicOriginY-this._sinAngle*c+this._cosAngle*a);this._internalPlacement.setTranslate(b,c);return this._internalPlacement}};return m}();q.PlacementInsidePolygon=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(q,t,E,C,A){let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,a,b)};return l}();y.instance=null;let m=function(l){function c(b,d,e){b=l.call(this,b,!0,!0)||this;b._curveHelper=new C.CurveHelper;b._angleToLine=void 0!==d.angleToLine?
d.angleToLine:!0;b._offset=void 0!==d.offset?d.offset*e:0;b._relativeTo=d.relativeTo;b._position=void 0!==d.startPointOffset?d.startPointOffset*e:0;b._epsilon=.001*e;return b}t._inheritsLoose(c,l);var a=c.prototype;a.processPath=function(b){var d=this._position;if(this._relativeTo===A.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var e=this._curSegment;this._curSegment++;
d=b[e-1];e=b[e];const p=this._curveHelper.calculateLength(d,e);if(p<this._epsilon)continue;b=.5+this._position/p;const [r,v]=this._curveHelper.getAngleCS(d,e,b);b=E.getCoord2D(d,e,b);this.internalPlacement.setTranslate(b[0]-this._offset*v,b[1]+this._offset*r);this._angleToLine&&this.internalPlacement.setRotateCS(r,v);return this.internalPlacement}this.iteratePath=!1;return null}this._relativeTo===A.PlacementOnLineRelativeTo.LineEnd&&E.reversePath(b);d=this.onLine(b,d);this._relativeTo===A.PlacementOnLineRelativeTo.LineEnd&&
E.reversePath(b);return d};a.onLine=function(b,d){let e,p=!1;switch(this._relativeTo){default:e=this._curveHelper.calculatePathLength(b)/2+d;break;case A.PlacementOnLineRelativeTo.LineBeginning:e=d;break;case A.PlacementOnLineRelativeTo.LineEnd:e=d,p=!0}const r=b.length;let v=0,h=b[0];for(let w=1;w<r;++w){d=h;h=b[w];const u=this._curveHelper.calculateLength(d,h);if(v+u>e){b=(e-v)/u;const [k,g]=this._curveHelper.getAngleCS(d,h,b);b=E.getCoord2D(d,h,b);d=p?-this._offset:this._offset;this.internalPlacement.setTranslate(b[0]-
d*g,b[1]+d*k);this._angleToLine&&(p?this.internalPlacement.setRotateCS(-k,-g):this.internalPlacement.setRotateCS(k,g));return this.internalPlacement}v+=u}return null};return c}(E.PathTransformationCursor);q.PlacementOnLine=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,t,E,C){function A(l,
c){const a=Math.PI;for(;Math.abs(c-l)>a+2E-15;)c=c-l>a?c-2*a:c+2*a;return(l+c)/2}let y=function(){function l(){}l.local=function(){null===l.instance&&(l.instance=new l);return l.instance};l.prototype.execute=function(c,a,b,d){return new m(c,a,b)};return l}();y.instance=null;let m=function(l){function c(b,d,e){b=l.call(this,b,!0,!0)||this;b._curveHelper=new C.CurveHelper;b._angleToLine=void 0!==d.angleToLine?d.angleToLine:!0;b._offset=void 0!==d.offset?d.offset*e:0;b._endPoints=void 0!==d.placeOnEndPoints?
d.placeOnEndPoints:!0;b._controlPoints=void 0!==d.placeOnControlPoints?d.placeOnControlPoints:!0;b._regularVertices=void 0!==d.placeOnRegularVertices?d.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}t._inheritsLoose(c,l);var a=c.prototype;a.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;b=this._tags[this._tagIterator];this._angleToLine&&
this.internalPlacement.setRotate(b[2]);let d=b[0],e=b[1];if(0!==this._offset){const p=Math.cos(b[2]);d-=this._offset*Math.sin(b[2]);e+=this._offset*p}this.internalPlacement.setTranslate(d,e);this._tagIterator++;return this.internalPlacement};a._preparePath=function(b){this._tagIterator=this._tags.length=0;const d=E.isClosedPath(b),e=b.length-1;let p=0,r=0,v=0,h=0,w=0,u,k;for(;p<e;){p++;u=b[p-1];k=b[p];const g=E.getId(u),f=E.getId(k);if(this._angleToLine||0!==this._offset)h=this._curveHelper.getAngle(u,
k,0);1===p?d?(r=h,v=g):(this._endPoints||this._controlPoints&&1===g)&&this._tags.push([u[0],u[1],h]):1===g?this._controlPoints&&this._tags.push([u[0],u[1],A(w,h)]):this._regularVertices&&this._tags.push([u[0],u[1],A(w,h)]);if(this._angleToLine||0!==this._offset)w=this._curveHelper.getAngle(u,k,1);p===e&&(d?1===f||1===v?this._controlPoints&&this._tags.push([k[0],k[1],A(w,r)]):this._regularVertices&&this._tags.push([k[0],k[1],A(w,r)]):(this._endPoints||this._controlPoints&&1===f)&&this._tags.push([k[0],
k[1],w]))}this._tagIterator=0};return c}(E.PathTransformationCursor);q.PlacementOnVertices=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../core/has ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(q,t,E,C,A,y,m,l){let c=
function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,e,p,r){return new a(d,e,p)};return b}();c.instance=null;let a=function(){function b(e,p,r){this._geometry=e;this._offsetX=void 0!==p.offsetX?p.offsetX*r:0;this._offsetY=void 0!==p.offsetY?p.offsetY*r:0;this._method=void 0!==p.method?p.method:l.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new m.Placement}var d=b.prototype;d.next=function(){const e=this._geometry;
this._geometry=null;return e&&void 0!==e.rings?this._polygonCenter(e):null};d._polygonCenter=function(e){let p=!1;switch(this._method){case l.PlacementPolygonCenterMethod.CenterOfMass:if(e=A.weightedAreaCentroid(e))this._internalPlacement.setTranslate(e[0]+this._offsetX,e[1]+this._offsetY),p=!0;break;case l.PlacementPolygonCenterMethod.BoundingBoxCenter:const r=E.create();C.getBoundsXY(r,e);r&&(this._internalPlacement.setTranslate((r[2]+r[0])/2+this._offsetX,(r[3]+r[1])/2+this._offsetY),p=!0);break;
default:e=t("polylabel-placement-enabled")?y.getPolylabelPoint(e):y.getLabelPoint(e),null!==e&&(this._internalPlacement.setTranslate(e[0]+this._offsetX,e[1]+this._offsetY),p=!0)}return p?this._internalPlacement:null};return b}();q.PlacementPolygonCenter=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/labelPoint":function(){define("exports ../../core/maybe ../../core/PriorityQueue ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(q,t,E,C,A,y,m,l){function c(v,h){var {rings:w}=h;h=0;for(const u of w){w=u.length;for(let k=1;k<w;++k){const g=u[k-1],f=u[k];g[1]>v[1]!==f[1]>v[1]&&(0<(f[0]-g[0])*(v[1]-g[1])-(f[1]-g[1])*(v[0]-g[0])?h++:h--)}}return 0!==h}function a(v,h,w){if(w&&c(v,h))return{coord:v,distance:0};w=Infinity;let u=0,k=0;const g=[0,0];({rings:h}=h);for(const f of h)if(!(2>f.length))for(h=0;h<f.length-1;h++){m.projectPointOnLine(g,v,f,h);const n=e(v,g);n<w&&(w=n,u=g[0],k=g[1])}return{coord:[u,k],distance:Math.sqrt(w)}}
function b(v,h,w,u){w=[h,0];let k=Infinity,g=Infinity,f=!1,n=!1;h=[[h,u[1]-1],[h,u[3]+1]];u=[0,0];const z=[0,0],x=[0,0],B=[[0,0],[0,0]],D=C.create();({rings:v}=v);for(const J of v)if(!(2>J.length))for(v=1;v<J.length;v++){B[0][0]=J[v-1][0];B[0][1]=J[v-1][1];B[1][0]=J[v][0];B[1][1]=J[v][1];a:{var F=D;var G=B;if(2>G.length){F=null;break a}F||(F=C.create());const [L,K]=G[0],[U,X]=G[1];F[0]=Math.min(L,U);F[1]=Math.min(K,X);F[2]=Math.max(L,U);F[3]=Math.max(K,X)}if(null!==F){z[0]=h[0][0];z[1]=h[0][1];x[0]=
h[1][0];x[1]=h[1][1];a:{F=D;G=z;var H=x;let L=d(G,F),K=d(H,F);const U=F[0],X=F[1],Z=F[2],aa=F[3];if(L&K){F=0;break a}if(!(L|K)){F=4;break a}const da=(L?1:0)|(K?2:0);do{const R=H[0]-G[0],M=H[1]-G[1];if(R>M)L&3?(L&1?(G[1]+=M*(U-G[0])/R,G[0]=U):(G[1]+=M*(Z-G[0])/R,G[0]=Z),L=d(G,F)):K&3?(K&1?(H[1]+=M*(U-H[0])/R,H[0]=U):(H[1]+=M*(Z-H[0])/R,H[0]=Z),K=d(H,F)):L?(L&4?(G[0]+=R*(X-G[1])/M,G[1]=X):(G[0]+=R*(aa-G[1])/M,G[1]=aa),L=d(G,F)):(K&4?(H[0]+=R*(X-H[1])/M,H[1]=X):(H[0]+=R*(aa-H[1])/M,H[1]=aa),K=d(H,F));
else if(L&12?(L&4?(G[0]+=R*(X-G[1])/M,G[1]=X):(G[0]+=R*(aa-G[1])/M,G[1]=aa),L=d(G,F)):K&12?(K&4?(H[0]+=R*(X-H[1])/M,H[1]=X):(H[0]+=R*(aa-H[1])/M,H[1]=aa),K=d(H,F)):L?(L&1?(G[1]+=M*(U-G[0])/R,G[0]=U):(G[1]+=M*(Z-G[0])/R,G[0]=Z),L=d(G,F)):(K&1?(H[1]+=M*(U-H[0])/R,H[0]=U):(H[1]+=M*(Z-H[0])/R,H[0]=Z),K=d(H,F)),L&K){F=0;break a}}while(L|K);F=da}0!==F&&l.segmentIntersects(h[0],h[1],B[0],B[1],u)&&(F=u[1],k>g?F<k&&(k=F,f=!0):F<g&&(g=F,n=!0))}}f&&n?w[1]=(k+g)/2:w[0]=w[1]=NaN;return w}function d(v,h){return(v[0]<
h[0]?1:0)|(v[0]>h[2]?1:0)<<1|(v[1]<h[1]?1:0)<<2|(v[1]>h[3]?1:0)<<3}function e(v,h){return(v[0]-h[0])*(v[0]-h[0])+(v[1]-h[1])*(v[1]-h[1])}function p(v,h){if(v<h)return-1;if(v>h)return 1;if(v===h)return 0;v=isNaN(v);h=isNaN(h);return v<h?-1:v>h?1:0}let r=function(v,h,w,u){this.x=v;this.y=h;this.cellSize=w;this.distancefromCellCenter=m.distanceFromPointToPolygon(v,h,u);this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2};q.getLabelPoint=function(v){var {rings:h}=v;if(!h||0===
h.length)return null;var w=A.getBoundsXY(C.create(),v);if(!w)return null;var u=8.8818E-14*(Math.abs(w[0])+Math.abs(w[2])+Math.abs(w[1])+Math.abs(w[3])+1),k=0,g=0;for(var f=0;f<h.length;f++){var n=m.getRingArea(h[f]);n>g&&(g=n,k=f)}if(Math.abs(g)<=2*u*u)return g=A.getPointsBounds(C.create(),h[k]),[(g[0]+g[2])/2,(g[1]+g[3])/2];var z=y.ringCentroid(h[k],!1,C.create());if(null===z)return null;if(1===h.length&&4>h[0].length)return z;g=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];f=[NaN,NaN,NaN,NaN];n=[NaN,
NaN,NaN,NaN];var x=!1,B=a(z,v,!0);0===B.distance&&(x=!0,g[0][0]=z[0],g[0][1]=z[1],B=a(z,v,!1));f[0]=B.distance;n[0]=0;var D=[NaN,NaN],F=!1;let G=.25,H=-1;h=A.getPointsBounds(C.create(),h[k]);k=NaN;do if(k=NaN,B=h[0],g[1]=b(v,B+(h[2]-B)*G,u,w),isNaN(g[1][0])||isNaN(g[1][1])||(B=a(g[1],v,!1),k=B.distance),!isNaN(k)&&k>u&&c(g[1],v))F=!0,f[1]=k,n[1]=e(g[1],z);else if(!isNaN(k)&&k>H&&(H=k,D[0]=g[1][0],D[1]=g[1][1]),G-=.01,.1>G)if(0<=H)F=!0,f[1]=H,g[1][0]=D[0],g[1][1]=D[1],n[1]=e(g[1],z);else break;while(!F);
F=!1;G=.5;H=-1;let J=.01,L=1;do if(k=NaN,B=h[0],g[2]=b(v,B+(h[2]-B)*G,u,w),isNaN(g[2][0])||isNaN(g[2][1])||(B=a(g[2],v,!1),k=B.distance),!isNaN(k)&&k>u&&c(g[2],v))F=!0,f[2]=k,n[2]=e(g[2],z);else if(!isNaN(k)&&k>H)H=k,D[0]=g[2][0],D[1]=g[2][1];else if(k>H&&(H=k,D[0]=g[2][0],D[1]=g[2][1]),G=.5+J*L,J+=.01,L*=-1,.3>G||.7<G)if(0<=H)F=!0,f[2]=H,g[2][0]=D[0],g[2][1]=D[1],n[2]=e(g[2],z);else break;while(!F);F=!1;G=.75;H=-1;do if(k=NaN,B=h[0],g[3]=b(v,B+(h[2]-B)*G,u,w),isNaN(g[3][0])||isNaN(g[3][1])||(B=a(g[3],
v,!1),k=B.distance),!isNaN(k)&&k>u&&c(g[3],v))F=!0,f[3]=k,n[3]=e(g[3],z);else if(k>H&&(H=k,D[0]=g[3][0],D[1]=g[3][1]),G+=.01,.9<G)if(0<=H)F=!0,f[3]=H,g[3][0]=D[0],g[3][1]=D[1],n[3]=e(g[3],z);else break;while(!F);v=[0,1,2,3];w=x?0:1;for(x=w;4>x;x++)for(z=w;3>z;z++)D=n[z],F=n[z+1],0<p(D,F)&&(u=v[z],v[z]=v[z+1],v[z+1]=u,n[z]=F,n[z+1]=D);n=w;for(x=u=0;4>w;w++){switch(w){case 0:x=2*f[v[w]];break;case 1:x=1.66666666*f[v[w]];break;case 2:x=1.33333333*f[v[w]];break;case 3:x=f[v[w]]}x>u&&(u=x,n=v[w])}return g[n]};
q.getPolylabelPoint=function(v){if(!v||!v.rings||0===v.rings.length)return null;var h=A.getPointsBounds(C.create(),v.rings[0]);if(!h)return null;var w=h[2]-h[0],u=h[3]-h[1];if(0===w||0===u)return[h[0]+w/2,h[1]+u/2];const k=Math.max(Math.min(w,u)/100,1),g=new E((z,x)=>x.maxDistanceToPolygon-z.maxDistanceToPolygon);u=Math.min(w,u);w=u/2;let f=0,n=0;for(f=h[0];f<h[2];f+=u)for(n=h[1];n<h[3];n+=u)g.enqueue(new r(f+w,n+w,w,v));h=y.ringsCentroid(v.rings,!1);if(null===h)return null;for(h=new r(h[0],h[1],
0,v);0<g.size;)u=t.unwrap(g.dequeue()),u.distancefromCellCenter>h.distancefromCellCenter&&(h=u),u.maxDistanceToPolygon-h.distancefromCellCenter<=k||(w=u.cellSize/2,g.enqueue(new r(u.x-w,u.y-w,w,v)),g.enqueue(new r(u.x+w,u.y-w,w,v)),g.enqueue(new r(u.x-w,u.y+w,w,v)),g.enqueue(new r(u.x+w,u.y+w,w,v)));return[h.x,h.y]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],function(q){const t=
(E,C)=>E<C?-1:E>C?1:0;return function(){function E(A=t){this._data=[];this._compare=A}var C=E.prototype;C.enqueue=function(A){if(null!=A){var {_data:y,_compare:m}=this;y.push(A);A=y.length-1>>>0;for(var l=y[A];0<A;){const c=A-1>>1,a=y[c];if(0>=m(a,l))y[c]=l,y[A]=a,A=c;else break}}};C.dequeue=function(){const {_data:A,_compare:y}=this,m=A[0];var l=A.pop();if(0===A.length)return m;A[0]=l;l=0;const c=A.length,a=A[0];let b;let d=null;for(;;){var e=2*l+1;const p=2*l+2;d=null;e<c&&(b=A[e],0<y(b,a)&&(d=
e));p<c&&(e=A[p],null===d&&0>=y(e,a)||null!==d&&0>=y(e,b))&&(d=p);if(null===d)break;A[l]=A[d];A[d]=a;l=d}return m};q._createClass(E,[{key:"size",get:function(){return this._data.length}}]);return E}()})},"esri/symbols/cim/imageUtils":function(){define(["exports"],function(q){q.getFirstFrame=function(t){const E=t.getFrame(0);if(E instanceof HTMLImageElement||E instanceof HTMLCanvasElement)return E;const C=document.createElement("canvas");C.width=t.width;C.height=t.height;t=C.getContext("2d");E instanceof
ImageData?t.putImageData(E,0,0):t.drawImage(E,0,0);return C};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(E=0,C=0,A=0,y=0){this.x=E;this.y=C;this.width=A;this.height=y}t.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};
q._createClass(t,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(q){return function(){function t(C){C&&(this._textRasterizationCanvas=C)}var E=t.prototype;E.rasterizeText=function(C,A){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const y=this._textRasterizationCanvas;var m=y.getContext("2d");this._setFontProperties(m,A);this._parameters=
A;this._textLines=C.split(/\r?\n/);this._lineHeight=this._computeLineHeight();C=this._computeTextWidth(m,A);const {decoration:l,weight:c}=A.font;this._lineThroughWidthOffset=l&&"line-through"===l?.1*this._lineHeight:0;var a=this._lineHeight*this._textLines.length;y.width=C+2*this._lineThroughWidthOffset;y.height=a;this._renderedLineHeight=Math.round(this._lineHeight*A.pixelRatio);this._renderedHaloSize=A.halo.size*A.pixelRatio;this._renderedWidth=C*A.pixelRatio;this._renderedHeight=a*A.pixelRatio;
this._lineThroughWidthOffset*=A.pixelRatio;C=A.halo&&A.halo.color?A.halo.color:[0,0,0,0];a=A.color??[0,0,0,0];this._fillStyle=`rgba(${a.slice(0,3).toString()},${a[3]})`;this._haloStyle=`rgb(${C.slice(0,3).toString()})`;C=this._renderedLineHeight;a=this._renderedHaloSize;m.save();m.clearRect(0,0,y.width,y.height);this._setFontProperties(m,A);var b=m.textAlign,d=this._renderedWidth;b=("center"===b?.5*d:"right"===b?d:0)+a;d=0<a;let e=this._lineThroughWidthOffset,p=0;d&&this._renderHalo(m,b,a,e,p,A);
p+=a;e+=b;for(var r of this._textLines)d&&(m.globalCompositeOperation="destination-out",m.fillStyle="rgb(0, 0, 0)",m.fillText(r,e,p),m.globalCompositeOperation="source-over"),m.fillStyle=this._fillStyle,m.fillText(r,e,p),l&&"none"!==l&&this._renderDecoration(m,e,p,l,c),p+=C;m.restore();r=this._renderedWidth+2*this._lineThroughWidthOffset;C=this._renderedHeight;m=m.getImageData(0,0,r,C);m=new Uint8Array(m.data);if(A.premultiplyColors)for(b=0;b<m.length;b+=4)a=m[b+3]/255,m[b]*=a,m[b+1]*=a,m[b+2]*=a;
switch(A.horizontalAlignment){case "left":a=-.5;break;case "right":a=.5;break;default:a=0}switch(A.verticalAlignment){case "bottom":A=-.5;break;case "top":A=.5;break;default:A=0}return{size:[r,C],image:new Uint32Array(m.buffer),sdf:!1,simplePattern:!1,anchorX:a,anchorY:A,canvas:y}};E._renderHalo=function(C,A,y,m,l,c){const a=this._renderedWidth,b=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=
a;this._haloRasterizationCanvas.height=b;const d=this._haloRasterizationCanvas,e=d.getContext("2d");e.clearRect(0,0,a,b);this._setFontProperties(e,c);const {decoration:p,weight:r}=c.font;e.fillStyle=this._haloStyle;e.strokeStyle=this._haloStyle;e.lineJoin="round";this._renderHaloNative(e,A,y,p,r);C.globalAlpha=this._parameters.halo.color[3];C.drawImage(d,0,0,a,b,m,l,a,b);C.globalAlpha=1};E._renderHaloNative=function(C,A,y,m,l){const c=this._renderedLineHeight,a=this._renderedHaloSize;for(const b of this._textLines){const d=
2*a;for(let e=0;5>e;e++){const p=(.6+.1*e)*d;C.lineWidth=p;C.strokeText(b,A,y);m&&"none"!==m&&this._renderDecoration(C,A,y,m,l,p)}y+=c}};E._setFontProperties=function(C,A){var y=A.font;y=`${y.style} ${y.weight} ${q.pt2px(Math.max(A.size,.5)*A.pixelRatio).toFixed(1)}px ${y.family}, sans-serif`;C.font=y;C.textBaseline="top";switch(A.horizontalAlignment){case "left":A="left";break;case "right":A="right";break;case "center":A="center";break;default:A="left"}C.textAlign=A};E.computeTextSize=function(C,
A){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const y=this._textRasterizationCanvas;var m=y.getContext("2d");this._setFontProperties(m,A);this._parameters=A;this._textLines=C.split(/\r?\n/);this._lineHeight=this._computeLineHeight();C=this._computeTextWidth(m,A);m=this._lineHeight*this._textLines.length;y.width=C;y.height=m;return[C*A.pixelRatio,m*A.pixelRatio]};E._computeTextWidth=function(C,A){let y=0;for(const m of this._textLines)y=Math.max(y,
C.measureText(m).width);A=A.font;if("italic"===A.style||"oblique"===A.style||"string"===typeof A.weight&&("bold"===A.weight||"bolder"===A.weight)||"number"===typeof A.weight&&600<A.weight)y+=.3*C.measureText("w").width;y+=2*this._parameters.halo.size;return Math.round(y)};E._computeLineHeight=function(){let C=1.275*this._parameters.size;const A=this._parameters.font.decoration;A&&"underline"===A&&(C*=1.3);return Math.round(C+2*this._parameters.halo.size)};E._renderDecoration=function(C,A,y,m,l,c){const a=
.9*this._lineHeight;switch(C.textAlign){case "center":A-=this._renderedWidth/2;break;case "right":A-=this._renderedWidth}const b=C.textBaseline;if("underline"===m)switch(b){case "top":y+=a;break;case "middle":y+=a/2}else if("line-through"===m)switch(b){case "top":y+=a/1.5;break;case "middle":y+=a/3}m=c?1.5*c:Math.ceil(a*("bold"===l?.06:"bolder"===l?.09:.04));C.save();C.beginPath();C.strokeStyle=C.fillStyle;C.lineWidth=m;C.moveTo(A-this._lineThroughWidthOffset,y);C.lineTo(A+this._renderedWidth+2*this._lineThroughWidthOffset,
y);C.stroke();C.restore()};return t}()})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(q,t,E,C,A,y,m,l,c,a){const b=Math.PI/180;let d=function(){function r(h,w,u,k){this._rotationT=C.create();
this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const g=u.rect,f=new Float32Array(8);h*=k;w*=k;const n=u.code?g.width*k:u.metrics.width,z=u.code?g.height*k:u.metrics.height;f[0]=h;f[1]=w;f[2]=h+n;f[3]=w;f[4]=h;f[5]=w+z;f[6]=h+n;f[7]=w+z;this._data=f;this._setTextureCoords(g);this._scale=k;this._mosaic=u;this.x=h;this.y=w;this.maxOffset=Math.max(h+n,w+z)}var v=r.prototype;v.setTransform=function(h){this._transform=h;this._offsets=null};v._setOffsets=function(h){this._offsets||
(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const w=this._offsets,u=new Float32Array(8),k=E.multiply(C.create(),this._rotationT,this._transform);C.transformMany(u,h,k);w.upperLeft=l.i1616to32(8*u[0],8*u[1]);w.upperRight=l.i1616to32(8*u[2],8*u[3]);w.lowerLeft=l.i1616to32(8*u[4],8*u[5]);w.lowerRight=l.i1616to32(8*u[6],8*u[7])};v._setTextureCoords=function({x:h,y:w,width:u,height:k}){this._texcoords={upperLeft:l.i1616to32(h,w),upperRight:l.i1616to32(h+u,w),lowerLeft:l.i1616to32(h,
w+k),lowerRight:l.i1616to32(h+u,w+k)}};t._createClass(r,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(h){this._angle=h;E.fromRotation(this._rotationT,-h);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",
get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:g,width:f}=this._mosaic.metrics;var h=f*this._scale,
w=Math.abs(g)*this._scale,u=new Float32Array(8);u[0]=this.x;u[1]=this.y;u[2]=this.x+h;u[3]=this.y;u[4]=this.x;u[5]=this.y+w;u[6]=this.x+h;u[7]=this.y+w;h=E.multiply(C.create(),this._rotationT,this._transform);C.transformMany(u,u,h);w=h=Infinity;let n=0;var k=0;for(let z=0;4>z;z++){const x=u[2*z],B=u[2*z+1];h=Math.min(h,x);w=Math.min(w,B);n=Math.max(n,x);k=Math.max(k,B)}u=n-h;k-=w;this._bounds=new a(h+u/2,w+k/2,u,k)}return this._bounds}}]);return r}(),e=function(){function r(h,w,u){this._rotation=
0;this._decorate(h,w,u);this.glyphs=h;this.bounds=this._createBounds(h);this.isMultiline=1<w.length;this._hasRotation=0!==u.angle;this._transform=this._createGlyphTransform(this.bounds,u);for(const k of h)k.setTransform(this._transform)}var v=r.prototype;v.setRotation=function(h){if(0!==h||0!==this._rotation){this._rotation=h;var w=this._transform;h=E.fromRotation(C.create(),h);E.multiply(w,h,w);for(const u of this.glyphs)u.setTransform(this._transform)}};v._decorate=function(h,w,u){if(u.decoration&&
"none"!==u.decoration&&h.length){var k=u.scale;u="underline"===u.decoration?30:20;var g=h[0].textureBinding;for(const x of w){const B=x.startX*k,D=x.startY*k;w=h;var f=w.push;var n=(x.width+x.glyphWidthEnd)*k;var z=g;n={code:0,page:0,sdf:!0,rect:new c(0,0,11,8),textureBinding:z,metrics:{advance:0,height:4,width:n,left:0,top:0}};f.call(w,new d(B,D+u*k,n,1))}}};v._createBounds=function(h){let w=Infinity,u=Infinity,k=0;var g=0;for(const f of h)w=Math.min(w,f.xTopLeft),u=Math.min(u,f.yTopLeft),k=Math.max(k,
f.xTopLeft+f.width),g=Math.max(g,f.yBottomRight);h=k-w;g-=u;return new a(w+h/2,u+g/2,h,g)};v._createGlyphTransform=function(h,w){const u=b*w.angle,k=C.create(),g=y.create();E.translate(k,k,A.set(g,w.xOffset,-w.yOffset));w.isCIM?E.rotate(k,k,u):(E.translate(k,k,A.set(g,h.x,h.y)),E.rotate(k,k,u),E.translate(k,k,A.set(g,-h.x,-h.y)));return k};t._createClass(r,[{key:"boundsT",get:function(){var h=this.bounds;const w=A.set(y.create(),h.x,h.y);A.transformMat2d(w,w,this._transform);return this._hasRotation?
(h=Math.max(h.width,h.height),new a(w[0],w[1],h,h)):new a(w[0],w[1],h.width,h.height)}}]);return r}(),p=function(r,v,h,w,u,k){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(v,h));this.end=Math.max(0,Math.max(v,h));this.end<r.length&&(this.glyphWidthEnd=r[this.end].metrics.width);this.width=w;this.yMin=u;this.yMax=k};q.ShapedGlyph=d;q.ShapingInfo=e;q.shapeGlyphs=function(r,v,h){const w=h.scale,u=[],k=[];var g=1/h.scale*h.maxLineWidth;var f=v?r.length-1:0,n=v?-1:r.length;
v=v?-1:1;var z=f,x=0,B=0;let D=z,F=D,G=0,H=Infinity,J=0;for(;z!==n;){const {code:X,metrics:Z}=r[z];var L=Math.abs(Z.top);10!==X&&32!==X&&(H=Math.min(H,L),J=Math.max(J,L+Z.height));10===X?(z!==f&&(k.push(new p(r,D,z-v,x,H,J)),H=Infinity,J=0),x=0,D=z+v,F=z+v,B=0):32===X?(F=z+v,B=0,G=Z.advance,x+=Z.advance):(x>g&&(F!==D?(L=F-2*v,x-=G,k.push(new p(r,D,L,x-B,H,J)),H=Infinity,J=0,D=F,x=B):(k.push(new p(r,D,z-v,x,H,J)),H=Infinity,J=0,F=D=z,x=0)),x+=Z.advance,B+=Z.advance);z+=v}g=new p(r,D,z-v,x,H,J);0<=
g.start&&g.end<r.length&&k.push(g);for(g=0;g<k.length;g++);f=k[0].yMin;g=k[k.length-1].yMax+h.lineHeight*(k.length-1)+("underline"===h.decoration?4:0)-f;const {vAlign:K,hAlign:U}=h;n=K===m.VAlign.Baseline?1:0;g=(1-n)*-f+g/2*(n?0:K-1)+-26*(n?1:0);for(f=0;f<k.length;f++){const {start:X,end:Z,width:aa}=k[f];n=aa/2*(U+1)*-1-3;v=f*h.lineHeight+g-3;k[f].startX=n;k[f].startY=v;for(z=X;z<=Z;z++)x=r[z],10!==x.code&&(B=new d(n+x.metrics.left,v-x.metrics.top,x,w),n+=x.metrics.advance,u.push(B))}return new e(u,
k,h)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(E=0,C=0,A=0,y=0){this.x=E;this.y=C;this.width=A;this.height=y}t.prototype.union=function(E){this.x=Math.min(this.x,E.x);this.y=Math.min(this.y,E.y);this.width=Math.max(this.width,E.width);this.height=Math.max(this.height,E.height)};q._createClass(t,[{key:"isEmpty",
get:function(){return 0>=this.width||0>=this.height}}]);return t}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(q,t){return function(){function E(A,y,m,l){this.center=t.fromValues(A,y);this.centerT=t.create();this.halfWidth=m/2;this.halfHeight=l/2;this.width=m;this.height=l}var C=E.prototype;C.clone=function(){return new E(this.x,this.y,this.width,this.height)};C.serialize=function(A){A.writeF32(this.center[0]);
A.writeF32(this.center[1]);A.push(this.width);A.push(this.height);return A};C.findCollisionDelta=function(A,y=4){return Math.log2(Math.min((A.halfWidth+this.halfWidth+y)/Math.abs(A.centerT[0]-this.centerT[0]),(A.halfHeight+this.halfHeight+y)/Math.abs(A.centerT[1]-this.centerT[1])))};C.extend=function(A){const y=Math.min(this.xmin,A.xmin),m=Math.min(this.ymin,A.ymin),l=Math.max(this.xmax,A.xmax)-y;A=Math.max(this.ymax,A.ymax)-m;this.width=l;this.height=A;this.halfWidth=l/2;this.halfHeight=A/2;this.x=
y+l/2;this.y=m+A/2};E.deserialize=function(A){const y=A.readF32(),m=A.readF32(),l=A.readInt32();A=A.readInt32();return new E(y,m,l,A)};q._createClass(E,[{key:"x",get:function(){return this.center[0]},set:function(A){this.center[0]=A}},{key:"y",get:function(){return this.center[1]},set:function(A){this.center[1]=A}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},
{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return E}()})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(q,
t,E,C){function A(m){const l={};switch(m){case "esriGeometryPoint":return(c,a,b,d)=>C.unquantizePoint(a,l,c,b,d);case "esriGeometryPolygon":return(c,a,b,d)=>C.unquantizePolygon(a,l,c,b,d);case "esriGeometryPolyline":return(c,a,b,d)=>C.unquantizePolyline(a,l,c,b,d);case "esriGeometryMultipoint":return(c,a,b,d)=>C.unquantizeMultipoint(a,l,c,b,d);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new q("mapview-arcade",`Unable to handle geometryType: ${m}`)),c=>c}}const y=new Map;
return function(m,l,c,a,b){if(E.isNone(m))return null;if(m.referencesGeometry()&&b){const {transform:d,hasZ:e,hasM:p}=b;y.has(a)||y.set(a,A(a));a=y.get(a)(l.geometry,d,e,p);l={...l,geometry:a}}l=m.repurposeFeature(l);try{return m.evaluate({...c,$feature:l})}catch(d){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",d),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(q,t,E){function C({scale:D,
translate:F},G){return Math.round((G-F[0])/D[0])}function A({scale:D,translate:F},G){return Math.round((F[1]-G)/D[1])}function y(D,F,G){const H=[];let J,L,K,U;for(let X=0;X<G.length;X++){const Z=G[X];if(0<X){if(K=C(D,Z[0]),U=A(D,Z[1]),K!==J||U!==L)H.push(F(Z,K-J,U-L)),J=K,L=U}else J=C(D,Z[0]),L=A(D,Z[1]),H.push(F(Z,J,L))}return 0<H.length?H:null}function m(D,F,G,H){return y(D,G?H?B:x:H?x:z,F)}function l(D,F,G,H){const J=[];G=G?H?B:x:H?x:z;for(H=0;H<F.length;H++){const L=y(D,G,F[H]);L&&3<=L.length&&
J.push(L)}return J.length?J:null}function c(D,F,G,H){const J=[];G=G?H?B:x:H?x:z;for(H=0;H<F.length;H++){const L=y(D,G,F[H]);L&&2<=L.length&&J.push(L)}return J.length?J:null}function a({scale:D,translate:F},G){return G*D[0]+F[0]}function b({scale:D,translate:F},G){return F[1]-G*D[1]}function d(D,F,G){const H=Array(G.length);if(!G.length)return H;const [J,L]=D.scale;let K=a(D,G[0][0]);D=b(D,G[0][1]);H[0]=F(G[0],K,D);for(let U=1;U<G.length;U++){const X=G[U];K+=X[0]*J;D-=X[1]*L;H[U]=F(X,K,D)}return H}
function e(D,F,G){const H=Array(G.length);for(let J=0;J<G.length;J++)H[J]=d(D,F,G[J]);return H}function p(D,F,G,H){return d(D,G?H?B:x:H?x:z,F)}function r(D,F,G,H){return e(D,G?H?B:x:H?x:z,F)}function v(D,F,G,H){return e(D,G?H?B:x:H?x:z,F)}function h(D,F,G){let [H,J]=G[0],L=Math.min(H,F[0]),K=Math.min(J,F[1]),U=Math.max(H,F[2]);F=Math.max(J,F[3]);for(let X=1;X<G.length;X++){const [Z,aa]=G[X];H+=Z;J+=aa;0>Z&&(L=Math.min(L,H));0<Z&&(U=Math.max(U,H));0>aa?K=Math.min(K,J):0<aa&&(F=Math.max(F,J))}D[0]=
L;D[1]=K;D[2]=U;D[3]=F;return D}function w(D,F){if(!F.length)return null;D[0]=D[1]=Number.POSITIVE_INFINITY;D[2]=D[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<F.length;G++)h(D,D,F[G]);return D}function u(D,F,G,H,J){F.xmin=C(D,G.xmin);F.ymin=A(D,G.ymin);F.xmax=C(D,G.xmax);F.ymax=A(D,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),J&&(F.mmin=G.mmin,F.mmax=G.mmax));return F}function k(D,F,G,H,J){F.points=m(D,G.points,H,J)??[];return F}function g(D,F,G,H,J){F.x=C(D,G.x);F.y=A(D,G.y);F!==G&&(H&&(F.z=G.z),
J&&(F.m=G.m));return F}function f(D,F,G,H,J){D=l(D,G.rings,H,J);if(!D)return null;F.rings=D;return F}function n(D,F,G,H,J){D=c(D,G.paths,H,J);if(!D)return null;F.paths=D;return F}const z=(D,F,G)=>[F,G],x=(D,F,G)=>[F,G,D[2]],B=(D,F,G)=>[F,G,D[2],D[3]];q.equals=function(D,F){if(D===F||null==D&&null==F)return!0;if(null==D||null==F)return!1;let G,H,J,L;D&&"upperLeft"===D.originPosition?(G=D.translate[0],H=D.translate[1],D=D.scale[0]):(G=t.isSome(D.extent)?D.extent.xmin:0,H=t.isSome(D.extent)?D.extent.ymax:
0,D=D.tolerance);F&&"upperLeft"===F.originPosition?(J=F.translate[0],L=F.translate[1],F=F.scale[0]):(J=t.isSome(F.extent)?F.extent.xmin:0,L=t.isSome(F.extent)?F.extent.ymax:0,F=F.tolerance);return G===J&&H===L&&D===F};q.getQuantizedBoundsCoordsArray=h;q.getQuantizedBoundsCoordsArrayArray=w;q.getQuantizedBoundsPaths=function(D){return w([0,0,0,0],D)};q.getQuantizedBoundsPoints=function(D){const F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];
return h(F,F,D)};q.getQuantizedBoundsRings=function(D){return w([0,0,0,0],D)};q.quantizeBounds=function(D,F,G){F[0]=C(D,G[0]);F[3]=A(D,G[1]);F[2]=C(D,G[2]);F[1]=A(D,G[3]);return F};q.quantizeExtent=u;q.quantizeGeometry=function(D,F){return D&&F?E.isPoint(F)?g(D,{},F,!1,!1):E.isPolyline(F)?n(D,{},F,!1,!1):E.isPolygon(F)?f(D,{},F,!1,!1):E.isMultipoint(F)?k(D,{},F,!1,!1):E.isExtent(F)?u(D,{},F,!1,!1):null:null};q.quantizeMultipoint=k;q.quantizePaths=c;q.quantizePoint=g;q.quantizePoints=m;q.quantizePolygon=
f;q.quantizePolyline=n;q.quantizeRings=l;q.quantizeX=C;q.quantizeY=A;q.toQuantizationTransform=function(D){return D?{originPosition:"upper-left"===D.originPosition?"upperLeft":"lower-left"===D.originPosition?"lowerLeft":D.originPosition,scale:D.tolerance?[D.tolerance,D.tolerance]:[1,1],translate:t.isSome(D.extent)?[D.extent.xmin,D.extent.ymax]:[0,0]}:null};q.unquantizeBounds=function(D,F,G){return G?(F[0]=a(D,G[0]),F[1]=b(D,G[3]),F[2]=a(D,G[2]),F[3]=b(D,G[1]),F):[a(D,F[0]),b(D,F[3]),a(D,F[2]),b(D,
F[1])]};q.unquantizeCoordsArray=d;q.unquantizeCoordsArrayArray=e;q.unquantizeExtent=function(D,F,G,H,J){F.xmin=a(D,G.xmin);F.ymin=b(D,G.ymin);F.xmax=a(D,G.xmax);F.ymax=b(D,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),J&&(F.mmin=G.mmin,F.mmax=G.mmax));return F};q.unquantizeMultipoint=function(D,F,G,H,J){t.isSome(G)&&(F.points=p(D,G.points,H,J));return F};q.unquantizePaths=r;q.unquantizePoint=function(D,F,G,H,J){if(t.isNone(G))return F;F.x=a(D,G.x);F.y=b(D,G.y);F!==G&&(H&&(F.z=G.z),J&&(F.m=G.m));
return F};q.unquantizePoints=p;q.unquantizePolygon=function(D,F,G,H,J){t.isSome(G)&&(F.rings=v(D,G.rings,H,J));return F};q.unquantizePolyline=function(D,F,G,H,J){t.isSome(G)&&(F.paths=r(D,G.paths,H,J));return F};q.unquantizeRings=v;q.unquantizeX=a;q.unquantizeY=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(q){function t(l,c){l%=c;return 0<=l?l:l+c}const E=Number.POSITIVE_INFINITY,
C=Math.PI,A=128/C,y=256/360,m=1/Math.LN2;q.C_256_TO_RAD=C/128;q.C_2PI=2*C;q.C_DEG_TO_256=y;q.C_DEG_TO_RAD=C/180;q.C_INFINITY=E;q.C_PI=C;q.C_PI_BY_2=C/2;q.C_RAD_TO_256=A;q.C_SQRT2=1.414213562;q.C_SQRT2_INV=1/1.414213562;q.between=function(l,c,a){return l>=c&&l<=a||l>=a&&l<=c};q.degToByte=function(l){return t(l*y,256)};q.interpolate=function(l,c,a){return l*(1-a)+c*a};q.log2=function(l){return Math.log(l)*m};q.positiveMod=t;q.radToByte=function(l){return t(l*A,256)};q.sqr=function(l){return l*l};Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/rasterizingUtils":function(){define(["exports","../../core/floatRGBA","../../core/mathUtils"],function(q,t,E){q.rasterizeDash=function(C,A){var y="Butt"===A,m="Square"===A;A=!y&&!m;1===C.length%2&&(C=[...C,...C]);var l=0;for(var c of C)l+=c;c=Math.round(15.5*l);l=new Float32Array(31*c);let a=0,b=0,d=.5,e=!0;for(var p of C){a=b;for(b+=15.5*p;d<=b;){for(C=.5;31>C;){const r=A?(C-15.5)*(C-15.5):Math.abs(C-15.5);l[(C-.5)*
c+d-.5]=e?y?Math.max(Math.max(a+7.75-d,r),Math.max(d-b+7.75,r)):r:A?Math.min((d-a)*(d-a)+r,(d-b)*(d-b)+r):m?Math.min(Math.max(d-a,r),Math.max(b-d,r)):Math.min(Math.max(d-a+7.75,r),Math.max(b+7.75-d,r));C++}d++}e=!e}y=l.length;p=new Uint8Array(4*y);for(m=0;m<y;++m)t.packFloatRGBA((A?Math.sqrt(l[m]):l[m])/15.5,p,4*m);return[p,c,31]};q.rasterizeSimpleFill=function(C,A,y){y=E.nextPowerOfTwo(Math.ceil(y));var m="vertical"===A||"horizontal"===A||"cross"===A||"esriSFSCross"===A||"esriSFSVertical"===A||"esriSFSHorizontal"===
A?8*y:16*y;const l=2*y;C.width=m;C.height=m;const c=C.getContext("2d");c.strokeStyle="#FFFFFF";c.lineWidth=y;c.beginPath();if("vertical"===A||"cross"===A||"esriSFSCross"===A||"esriSFSVertical"===A)c.moveTo(m/2,-l),c.lineTo(m/2,m+l);if("horizontal"===A||"cross"===A||"esriSFSCross"===A||"esriSFSHorizontal"===A)c.moveTo(-l,m/2),c.lineTo(m+l,m/2);if("forward-diagonal"===A||"diagonal-cross"===A||"esriSFSDiagonalCross"===A||"esriSFSForwardDiagonal"===A)c.moveTo(-l,-l),c.lineTo(m+l,m+l),c.moveTo(m-l,-l),
c.lineTo(m+l,l),c.moveTo(-l,m-l),c.lineTo(l,m+l);if("backward-diagonal"===A||"diagonal-cross"===A||"esriSFSBackwardDiagonal"===A||"esriSFSDiagonalCross"===A)c.moveTo(m+l,-l),c.lineTo(-l,m+l),c.moveTo(l,-l),c.lineTo(-l,l),c.moveTo(m+l,m-l),c.lineTo(m-l,m+l);c.stroke();A=c.getImageData(0,0,C.width,C.height);A=new Uint8Array(A.data);for(m=0;m<A.length;m+=4)y=A[m+3]/255,A[m]*=y,A[m+1]*=y,A[m+2]*=y;return[A,C.width,C.height]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(q,t){function E(m,l=0){let c=0;for(let a=0;4>a;a++)c+=m[l+a]*A[a];return c}const C=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],y=E(new Uint8ClampedArray([255,255,255,255]));q.packFloatRGBA=function(m,l,c=0){m=t.clamp(m,0,y);for(let d=0;4>d;d++){var a=Math,b=m*C[d];l[c+d]=a.floor.call(a,256*(b-Math.floor(b)))}};q.unpackFloatRGBA=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(q,t,E,C){function A(m){if(!m)return null;switch(m.type){case "CIMPointSymbol":m=m.symbolLayers;if(!m||1!==m.length)break;return A(m[0]);case "CIMVectorMarker":m=m.markerGraphics;if(!m||1!==m.length)break;var l=m[0];if(!l)break;m=l.geometry;if(!m)break;l=l.symbol;if(!l||"CIMPolygonSymbol"!==l.type&&"CIMLineSymbol"!==l.type||l.symbolLayers?.some(c=>!!c.effects))break;
return{geom:m,asFill:"CIMPolygonSymbol"===l.type};case "sdf":return{geom:m.geom,asFill:m.asFill}}return null}function y(m){let l=Infinity,c=-Infinity,a=Infinity,b=-Infinity;for(const d of m)for(const e of d)e[0]<l&&(l=e[0]),e[0]>c&&(c=e[0]),e[1]<a&&(a=e[1]),e[1]>b&&(b=e[1]);return[l,a,c,b]}q.buildSDF=function(m){var l=m.geom;var c=l?l.rings?l.rings:l.paths?l.paths:void 0!==l.xmin&&void 0!==l.ymin&&void 0!==l.xmax&&void 0!==l.ymax?[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,
l.ymin]]]:null:null;l=Infinity;var a=-Infinity;var b=Infinity,d=-Infinity;for(var e of c)for(var p of e)p[0]<l&&(l=p[0]),p[0]>a&&(a=p[0]),p[1]<b&&(b=p[1]),p[1]>d&&(d=p[1]);a=new C(l,b,a-l,d-b);b=64/Math.max(a.width,a.height);e=Math.round(a.width*b)+62;p=Math.round(a.height*b)+62;l=[];for(var r of c)if(r&&1<r.length){c=[];for(var v of r){let [B,D]=v;B-=a.x;D-=a.y;B*=b;D*=b;B+=30.5;D+=30.5;m.asFill?c.push([B,D]):c.push([Math.round(B),Math.round(D)])}m.asFill&&(d=c.length-1,c[0][0]===c[d][0]&&c[0][1]===
c[d][1]||c.push(c[0]));l.push(c)}v=e*p;r=Array(v);for(c=0;c<v;++c)r[c]=962;for(var h of l)for(c=h.length,a=1;a<c;++a){b=h[a-1];d=h[a];var w=void 0,u=void 0;b[0]<d[0]?(w=b[0],u=d[0]):(w=d[0],u=b[0]);var k=void 0,g=void 0;b[1]<d[1]?(k=b[1],g=d[1]):(k=d[1],g=b[1]);var f=Math.floor(w)-31;u=Math.floor(u)+31;k=Math.floor(k)-31;g=Math.floor(g)+31;0>f&&(f=0);u>e&&(u=e);0>k&&(k=0);g>p&&(g=p);w=d[0]-b[0];const B=d[1]-b[1],D=w*w+B*B;for(;f<u;f++)for(let F=k;F<g;F++){var n=(f-b[0])*w+(F-b[1])*B,z=void 0;0>n?
(z=b[0],n=b[1]):n>D?(z=d[0],n=d[1]):(n/=D,z=b[0]+n*w,n=b[1]+n*B);z=(f-z)*(f-z)+(F-n)*(F-n);n=(p-F-1)*e+f;z<r[n]&&(r[n]=z)}}for(h=0;h<v;++h)r[h]=Math.sqrt(r[h]);if(m.asFill)for(var x of l)for(m=x.length,h=1;h<m;++h)for(l=x[h-1],v=x[h],l[0]<v[0]?(c=l[0],a=v[0]):(c=v[0],a=l[0]),l[1]<v[1]?(d=l[1],b=v[1]):(d=v[1],b=l[1]),c=Math.floor(c),a=Math.floor(a)+1,d=Math.floor(d),b=Math.floor(b)+1,31>c&&(c=31),a>e-31&&(a=e-31),31>d&&(d=31),b>p-31&&(b=p-31);d<b;++d)if(l[1]>d!==v[1]>d){u=(p-d-1)*e;for(k=c;k<a;++k)k<
(v[0]-l[0])*(d-l[1])/(v[1]-l[1])+l[0]&&(r[u+k]=-r[u+k]);for(k=31;k<c;++k)r[u+k]=-r[u+k]}x=r.length;m=new Uint8Array(4*x);for(h=0;h<x;++h)t.packFloatRGBA(.5-r[h]/62,m,4*h);return[m,e,p]};q.getExtent=function(m){return m?m.rings?y(m.rings):m.paths?y(m.paths):E.isExtent(m)?[m.xmin,m.ymin,m.xmax,m.ymax]:null:null};q.getSDFInfo=A;q.getSDFMetrics=function(m,l,c,a,b){const [d,e,p,r]=m;if(p<d||r<e)return[0,0,0];var v=p-d,h=r-e;m=64/Math.max(v,h);const w=Math.round(v*m),u=Math.round(h*m)+62;h=1;l&&(h=u/m/
(l.ymax-l.ymin));let k=0,g=0;v=1;a&&(b?l&&c&&0<l.ymax-l.ymin&&(v=(l.xmax-l.xmin)/(l.ymax-l.ymin),k=a.x/(c*v),g=a.y/c):(k=a.x,g=a.y));k=.5*(l.xmax+l.xmin)+k*(l.xmax-l.xmin);g=.5*(l.ymax+l.ymin)+g*(l.ymax-l.ymin);k=(k-d)*m+31;g=(g-e)*m+31;l=k/(w+62)-.5;a=g/u-.5;b&&(l*=c*v,a*=c);return[h,l,a]};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(q,t,E,C,A,y,m){function l(a){const b=new Set;for(const d of a)b.add(Math.floor(d/256));return b}function c(a,b,d){a.has(b)||a.set(b,d().then(()=>{a.delete(b)}).catch(e=>{a.delete(b);E.throwIfNotAbortError(e)}));return a.get(b)}return function(){function a(d,e,p){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=d;this.height=e;this._glyphSource=p;this._binPack=new A(d-4,e-4);this._glyphData.push(new Uint8Array(d*
e));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var b=a.prototype;b.dispose=function(){this._binPack=null;for(const d of this._textures)d&&d.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var d=[117,149,181,207,207,181,149,117];const e=[];for(let p=0;p<d.length;p++){const r=d[p];for(let v=0;11>v;v++)e.push(r)}d={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(e)};this._recordGlyph(d)};b.getGlyphItems=
function(){var d=q._asyncToGenerator(function*(e,p,r){const v=this._getGlyphCache(e);yield this._fetchRanges(e,p,r);return p.map(h=>this._getMosaicItem(v,e,h))});return function(e,p,r){return d.apply(this,arguments)}}();b.bind=function(d,e,p,r){const v=this._getTexture(d,p);v.setSamplingMode(e);this._dirties[p]&&(v.setData(this._glyphData[p]),this._dirties[p]=!1);d.bindTexture(v,r)};b._getGlyphCache=function(d){this._glyphCache[d]||(this._glyphCache[d]={});return this._glyphCache[d]};b._getTexture=
function(d,e){this._textures[e]||(this._textures[e]=new m.Texture(d,{pixelFormat:y.PixelFormat.ALPHA,dataType:y.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[e]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=function(){var d=q._asyncToGenerator(function*(e,p,r){const v=[];l(p).forEach(h=>{v.push(this._fetchRange(e,h,r))});yield Promise.all(v)});return function(e,p,r){return d.apply(this,arguments)}}();
b._fetchRange=function(){var d=q._asyncToGenerator(function*(e,p,r){return 256<p?null:c(this._rangePromises,e+p,()=>this._glyphSource.getRange(e,p,r))});return function(e,p,r){return d.apply(this,arguments)}}();b._getMosaicItem=function(d,e,p){if(!d[p]){e=this._glyphSource.getGlyph(e,p);if(!e||!e.metrics)return{rect:new C(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:p,sdf:!0};const r=this._recordGlyph(e);d[p]={rect:r,page:this._currentPage,metrics:e.metrics,code:p,sdf:!0};
this._invalidate()}return d[p]};b._recordGlyph=function(d){var e=d.metrics;if(0===e.width)e=new C(0,0,0,0);else{const p=e.width+6,r=e.height+6;e=this._binPack.allocate(p,r);e.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new A(this.width-4,this.height-4),e=this._binPack.allocate(p,
r));const v=this._glyphData[this._currentPage];d=d.bitmap;let h,w;if(d)for(let u=0;u<r;u++){h=p*u;w=this.width*(e.y+u)+e.x;for(let k=0;k<p;k++)v[w+k]=d[h+k]}t("esri-glyph-debug")&&this._showDebugPage(v)}return e};b._showDebugPage=function(d){const e=document.createElement("canvas"),p=e.getContext("2d"),r=new ImageData(this.width,this.height),v=r.data;e.width=this.width;e.height=this.height;e.style.border="1px solid black";for(let h=0;h<d.length;++h)v[4*h]=d[h],v[4*h+1]=0,v[4*h+2]=0,v[4*h+3]=255;p.putImageData(r,
0,0);document.body.appendChild(e)};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(q,t){return function(){function E(A,y){this._height=this._width=0;this._free=[];this._width=A;this._height=y;this._free.push(new t(0,0,A,y))}var C=E.prototype;C.allocate=function(A,y){if(A>this._width||y>this._height)return new t;let m=null,l=-1;for(let c=0;c<this._free.length;++c){const a=this._free[c];A<=a.width&&y<=
a.height&&(null===m||a.y<=m.y&&a.x<=m.x)&&(m=a,l=c)}if(null===m)return new t;this._free.splice(l,1);m.width<m.height?(m.width>A&&this._free.push(new t(m.x+A,m.y,m.width-A,y)),m.height>y&&this._free.push(new t(m.x,m.y+y,m.width,m.height-y))):(m.width>A&&this._free.push(new t(m.x+A,m.y,m.width-A,m.height)),m.height>y&&this._free.push(new t(m.x,m.y+y,A,m.height-y)));return new t(m.x,m.y,A,y)};C.release=function(A){for(let y=0;y<this._free.length;++y){const m=this._free[y];if(m.y===A.y&&m.height===A.height&&
m.x+m.width===A.x)m.width+=A.width;else if(m.x===A.x&&m.width===A.width&&m.y+m.height===A.y)m.height+=A.height;else if(A.y===m.y&&A.height===m.height&&A.x+A.width===m.x)m.x=A.x,m.width+=A.width;else if(A.x===m.x&&A.width===m.width&&A.y+A.height===m.y)m.y=A.y,m.height+=A.height;else continue;this._free.splice(y,1);this.release(A)}this._free.push(A)};q._createClass(E,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return E}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request",
"../../../../core/pbf"],function(q,t){let E=function(){function A(m){this._metrics=[];for(this._bitmaps=[];m.next();)switch(m.tag()){case 1:const l=m.getMessage();for(;l.next();)switch(l.tag()){case 3:const c=l.getMessage();let a,b,d,e,p,r,v;for(;c.next();)switch(c.tag()){case 1:a=c.getUInt32();break;case 2:b=c.getBytes();break;case 3:d=c.getUInt32();break;case 4:e=c.getUInt32();break;case 5:p=c.getSInt32();break;case 6:r=c.getSInt32();break;case 7:v=c.getUInt32();break;default:c.skip()}c.release();
a&&(this._metrics[a]={width:d,height:e,left:p,top:r,advance:v},this._bitmaps[a]=b);break;default:l.skip()}l.release();break;default:m.skip()}}var y=A.prototype;y.getMetrics=function(m){return this._metrics[m]};y.getBitmap=function(m){return this._bitmaps[m]};return A}(),C=function(){function A(){this._ranges=[]}var y=A.prototype;y.getRange=function(m){return this._ranges[m]};y.addRange=function(m,l){this._ranges[m]=l};return A}();return function(){function A(m){this._glyphInfo={};this._baseURL=m}
var y=A.prototype;y.getRange=function(m,l,c){const a=this._getFontStack(m);if(a.getRange(l))return Promise.resolve();const b=256*l,d=b+255;m=this._baseURL.replace("{fontstack}",m).replace("{range}",b+"-"+d);return q(m,{responseType:"array-buffer",...c}).then(e=>{a.addRange(l,new E(new t(new Uint8Array(e.data),new DataView(e.data))))})};y.getGlyph=function(m,l){if(m=this._getFontStack(m)){var c=Math.floor(l/256);if(!(256<c)&&(m=m.getRange(c)))return{metrics:m.getMetrics(l),bitmap:m.getBitmap(l)}}};
y._getFontStack=function(m){let l=this._glyphInfo[m];l||(l=this._glyphInfo[m]=new C);return l};return A}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA","../../../../core/promiseUtils"],function(q,t){return function(){function E(A){this._svg=null;this.size=A;const y=document.createElement("canvas");y.width=y.height=A;this._context=y.getContext("2d");this._gridOuter=new Float64Array(A*A);this._gridInner=new Float64Array(A*A);this._f=new Float64Array(A);
this._d=new Float64Array(A);this._z=new Float64Array(A+1);this._v=new Int16Array(A)}var C=E.prototype;C.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};C.draw=function(A,y,m=31){this._initSVG();const l=this.createSVGString(A);return new Promise((c,a)=>{const b=new Image;b.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(l);b.onload=()=>{b.onload=null;this._context.clearRect(0,
0,this.size,this.size);this._context.drawImage(b,0,0,this.size,this.size);var e=this._context.getImageData(0,0,this.size,this.size);const p=new Uint8Array(this.size*this.size*4);for(let r=0;r<this.size*this.size;r++){const v=e.data[4*r+3]/255;this._gridOuter[r]=1===v?0:0===v?1E20:Math.max(0,.5-v)**2;this._gridInner[r]=1===v?1E20:0===v?0:Math.max(0,v-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(e=0;e<this.size*this.size;e++)q.packFloatRGBA(.5-
(this._gridOuter[e]-this._gridInner[e])/(2*m),p,4*e);c(p)};const d=y&&y.signal;if(d)t.onAbort(d,()=>a(t.createAbortError()))})};C._initSVG=function(){if(!this._svg){const A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttribute("style","position: absolute;");A.setAttribute("width","0");A.setAttribute("height","0");A.setAttribute("aria-hidden","true");A.setAttribute("role","presentation");document.body.appendChild(A);this._svg=A}return this._svg};C.createSVGString=function(A){const y=
this._initSVG(),m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",A);y.appendChild(m);A=m.getBBox();var l=A.width/A.height;const c=this.size/2;let a,b,d;1<l?(b=a=c/A.width,d=this.size/4,l=c-1/l*c/2):(a=b=c/A.height,d=c-c*l/2,l=this.size/4);m.setAttribute("style",`transform: matrix(${a}, 0, 0, ${b}, ${-A.x*a+d}, ${-A.y*b+l})`);A=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${y.innerHTML}</svg>`;y.removeChild(m);
return A};C._edt=function(A,y,m){const l=this._f,c=this._d,a=this._v,b=this._z;for(var d=0;d<y;d++){for(var e=0;e<m;e++)l[e]=A[e*y+d];this._edt1d(l,c,a,b,m);for(e=0;e<m;e++)A[e*y+d]=c[e]}for(d=0;d<m;d++){for(e=0;e<y;e++)l[e]=A[d*y+e];this._edt1d(l,c,a,b,y);for(e=0;e<y;e++)A[d*y+e]=Math.sqrt(c[e])}};C._edt1d=function(A,y,m,l,c){m[0]=0;l[0]=-1E20;l[1]=1E20;for(let a=1,b=0;a<c;a++){let d=(A[a]+a*a-(A[m[b]]+m[b]*m[b]))/(2*a-2*m[b]);for(;d<=l[b];)b--,d=(A[a]+a*a-(A[m[b]]+m[b]*m[b]))/(2*a-2*m[b]);b++;m[b]=
a;l[b]=d;l[b+1]=1E20}for(let a=0,b=0;a<c;a++){for(;l[b+1]<a;)b++;y[a]=(a-m[b])*(a-m[b])+A[m[b]]}};return E}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(q,t,E,C,A,y,m,l){function c(a){return a&&"static"===a.type}return function(){function a(d,e,p=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=
this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=d||0>=e)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=d;this._pageHeight=e;0<p&&(this._maxItemSize=p);this.pixelRatio=window.devicePixelRatio||1;this._binPack=new y(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},
size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var b=a.prototype;b.getWidth=function(d){return d>=this._mosaicPages.length?-1:this._mosaicPages[d].size[0]};b.getHeight=function(d){return d>=this._mosaicPages.length?-1:this._mosaicPages[d].size[1]};b.getPageTexture=function(d){return d<this._mosaicPages.length?this._mosaicPages[d].texture:null};b.has=function(d){return this._mosaicRects.has(d)};b.getSpriteItem=function(d){return this._mosaicRects.get(d)};b.addSpriteItem=function(d,
e,p,r,v,h,w=1){if(this._mosaicRects.has(d))return this._mosaicRects.get(d);let u,k,g;c(p)?[u,k,g]=this._allocateImage(e[0],e[1]):(u=new A(0,0,e[0],e[1]),k=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:p,size:[e[0]+2*E.SPRITE_PADDING,e[1]+2*E.SPRITE_PADDING],dirty:!0,texture:void 0}));if(0>=u.width||0>=u.height)return null;h={rect:u,width:e[0],height:e[1],sdf:v,simplePattern:h,pixelRatio:w,page:k};this._mosaicRects.set(d,h);c(p)&&this._copy({rect:u,spriteSize:e,spriteData:p.data,page:k,
pageSize:g,repeat:r,sdf:v});return h};b.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};b.processNextItem=function(){const d=this._spriteCopyQueue.pop();d&&this._copy(d)};b.getSpriteItems=function(d){const e={};for(const p of d)e[p]=this.getSpriteItem(p);return e};b.getMosaicItemPosition=function(d){const e=(d=this.getSpriteItem(d))&&d.rect;if(!e)return null;e.width=d.width;e.height=d.height;const p=E.SPRITE_PADDING,r=this._mosaicPages[d.page];return{size:[d.width,d.height],
tl:[(e.x+p)/r[0],(e.y+p)/r[1]],br:[(e.x+p+d.width)/r[0],(e.y+p+d.height)/r[1]],page:d.page}};b.bind=function(d,e,p=0,r=0){p=this._mosaicPages[p];const v=p.mosaicsData;var h=p.texture;h||(h=p.size,h=c(v)?new l.Texture(d,{pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,width:h[0],height:h[1]},new Uint8Array(v.data.buffer)):new l.Texture(d,{pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,samplingMode:m.TextureSamplingMode.LINEAR,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,
width:h[0],height:h[1]},null),p.texture=h);h.setSamplingMode(e);c(v)?(d.bindTexture(h,r),p.dirty&&(h.setData(new Uint8Array(v.data.buffer)),h.generateMipmap())):v.data.bindFrame(d,h,r);p.dirty=!1};a._copyBits=function(d,e,p,r,v,h,w,u,k,g,f){let n=r*e+p;w=u*h+w;if(f)for(w-=h,f=-1;f<=g;f++,n=((f+g)%g+r)*e+p,w+=h)for(u=-1;u<=k;u++)v[w+u]=d[n+(u+k)%k];else for(p=0;p<g;p++){for(r=0;r<k;r++)v[w+r]=d[n+r];n+=e;w+=h}};b._copy=function(d){if(!(d.page>=this._mosaicPages.length)){var e=this._mosaicPages[d.page],
p=e.mosaicsData;if(!c(e.mosaicsData))throw new t("mapview-invalid-resource","unsuitable data type!");var r=d.spriteData;(p=p.data)&&r||console.error("Source or target images are uninitialized!");a._copyBits(r,d.spriteSize[0],0,0,p,d.pageSize[0],d.rect.x+E.SPRITE_PADDING,d.rect.y+E.SPRITE_PADDING,d.spriteSize[0],d.spriteSize[1],d.repeat);e.dirty=!0}};b._allocateImage=function(d,e){d+=2*E.SPRITE_PADDING;e+=2*E.SPRITE_PADDING;var p=Math.max(d,e);if(this._maxItemSize&&this._maxItemSize<p){p=2**Math.ceil(C.log2(d));
const r=2**Math.ceil(C.log2(e));d=new A(0,0,d,e);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(p*r)},size:[p,r],dirty:!0,texture:void 0});return[d,this._mosaicPages.length-1,[p,r]]}p=this._binPack.allocate(d,e);return 0>=p.width?(p=this._mosaicPages[this._currentPage],!p.dirty&&c(p.mosaicsData)&&(p.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,
this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new y(this._pageWidth,this._pageHeight),this._allocateImage(d,e)):[p,this._currentPage,[this._pageWidth,this._pageHeight]]};b.dispose=function(){this._binPack=null;for(const e of this._mosaicPages){var d=e.texture;d&&d.dispose();d=e.mosaicsData;c(d)||d.data.destroy()}this._mosaicPages=null;this._mosaicRects.clear()};q._createClass(a,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return a}()})},"esri/views/2d/engine/webgl/animatedFormats/AnimatableTextureResource":function(){define(["exports",
"../../../../../core/maybe","../definitions","./utils"],function(q,t,E,C){let A=function(){function y(l,c,a,b){this._animation=l;this._frameData=null;this.frameCount=this._animation.frameDurations.length;this.width=this._animation.width;this.height=this._animation.height;this._playHandle=C.play(this._animation,a,b,d=>{this._frameData=d;c.requestRender()})}var m=y.prototype;m.destroy=function(){this._playHandle.remove()};m.bindFrame=function(l,c,a){l.bindTexture(c,a);t.isNone(this._frameData)||(c.updateData(0,
E.SPRITE_PADDING,E.SPRITE_PADDING,this._frameData.width,this._frameData.height,this._frameData),this._frameData=null)};return y}();q.AnimatableTextureResource=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/utils":function(){define(["exports","../../../../../core/time","../../../../../symbols/cim/enums","../grouping"],function(q,t,E,C){function A(d){return t.Milliseconds(d.frameDurations.reduce((e,p)=>e+p,0))}
function y(d){const {width:e,height:p}=d;return{frameDurations:d.frameDurations.reverse(),getFrame:r=>d.getFrame(d.frameDurations.length-1-r),width:e,height:p}}function m(d,e){const {width:p,height:r,getFrame:v}=d,h=A(d),w=e/h;return{frameDurations:d.frameDurations.map(u=>t.Milliseconds(u*w)),getFrame:v,width:p,height:r}}function l(d,e){const {width:p,height:r,getFrame:v}=d;d=d.frameDurations.slice();const h=d.shift();d.unshift(t.Milliseconds(h+e));return{frameDurations:d,getFrame:v,width:p,height:r}}
function c(d,e){const {width:p,height:r,getFrame:v}=d;d=d.frameDurations.slice();const h=d.pop();d.push(t.Milliseconds(h+e));return{frameDurations:d,getFrame:v,width:p,height:r}}function a(d,e,p,r){let {repeatType:v}=e;null==v&&(v=E.AnimatedSymbolRepeatType.Loop);!0===e.reverseAnimation&&(d=y(d));null!=e.duration&&(d=m(d,t.Milliseconds(1E3*e.duration)));if(null!=e.repeatDelay){const h=1E3*e.repeatDelay;v===E.AnimatedSymbolRepeatType.Loop?d=c(d,t.Milliseconds(h)):v===E.AnimatedSymbolRepeatType.Oscillate&&
(d=l(c(d,t.Milliseconds(h/2)),t.Milliseconds(h/2)))}null!=e.startTimeOffset?e=t.Milliseconds(1E3*e.startTimeOffset):null!=e.randomizeStartTime?(p=C.getMaterialGroup(p),e=C.getRandomValue(p,null!=e.randomizeStartSeed?e.randomizeStartSeed:82749913),e=t.Milliseconds(e*A(d))):e=t.Milliseconds(0);return new b(d,e,v,r)}let b=function(){function d(e,p,r,v){this._animation=e;this._repeatType=r;this._onFrameData=v;this._direction=1;this._currentFrame=0;this.timeToFrame=this._animation.frameDurations[this._currentFrame];
for(e=0;p>e;)e+=this.timeToFrame,this.nextFrame();p=this._animation.getFrame(this._currentFrame);this._onFrameData(p)}d.prototype.nextFrame=function(){this._currentFrame+=this._direction;if(0<this._direction){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case E.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case E.AnimatedSymbolRepeatType.Loop:this._currentFrame=0;break;case E.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=
this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case E.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case E.AnimatedSymbolRepeatType.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case E.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const e=this._animation.getFrame(this._currentFrame);this._onFrameData(e)};
return d}();q.Player=b;q.adjustDuration=m;q.appendDelay=c;q.createPlayer=a;q.getDuration=A;q.play=function(d,e,p,r){function v(){k=h&&setTimeout(()=>{w.nextFrame();u=w.timeToFrame;v()},u)}const h=null!=e.playAnimation?e.playAnimation:!0,w=a(d,e,p,r);let u=w.timeToFrame,k;v();return{remove:()=>{h&&clearTimeout(k)}}};q.prependDelay=l;q.reverse=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports",
"../../../../core/string"],function(q,t){function E(C,A){if("string"===typeof C)C=t.numericHash(C+`-seed(${A})`);else{let y=12;C^=A;do C=107*(C>>8^C)+y|0;while(0!==--y)}return(1+C/-2147483648)/2}q.getMaterialGroup=function(C){return Math.floor(10*E(C,53290320))};q.getRandomValue=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(q,t){q.ok=function(E,
C){return E&&"name"in E?(C&&C.error(new t(E.name,E.message,E.details)),!1):!0};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(q){q.keyFromSymbol=function(t){switch(t.type){case "esriSMS":return`${t.style}.${t.path}`;case "esriSLS":return`${t.style}.${t.cap}`;case "esriSFS":return`${t.style}`;case "esriPFS":case "esriPMS":return t.imageData?`${t.imageData}${t.width}${t.height}`:
`${t.url}${t.width}${t.height}`;default:return"mosaicHash"in t?t.mosaicHash:JSON.stringify(t)}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TextureUploadManager":function(){define(["exports","../../../../core/maybe","../../../../core/promiseUtils","./definitions","../../../webgl/context-util"],function(q,t,E,C,A){let y=function(){function m(c,a){this._queue=[];this._context=c;this._refreshable=a}var l=m.prototype;l.destroy=
function(){this._queue=[]};l.enqueueTextureUpdate=function(c,a){const b=E.createResolver(),d=C.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE,e=Math.ceil(c.height/d);E.throwIfAborted(a);if(this._context.type===A.ContextType.WEBGL1)this._queue.push({type:"no-chunk",request:c,resolver:b,options:a});else for(let p=0;p<e;p++){const r=p===e-1;this._queue.push({type:"chunk",request:c,resolver:b,chunk:p,chunkOffset:p*d,destHeight:r?c.height-d*p:d,chunkIsLast:r,options:a})}E.onAbortOrThrow(a,p=>b.reject(p));return b.promise};
l.upload=function(){let c=0;for(;this._queue.length;){var a=performance.now();const b=this._queue.shift();if(b&&(!t.isSome(b.options.signal)||!b.options.signal.aborted)){switch(b.type){case "chunk":this._uploadChunk(b);break;case "no-chunk":this._uploadNoChunk(b)}a=performance.now()-a;c+=a;if(c+a>=C.TEXTURE_UPLOAD_MANAGER_BUDGET)break}}this._queue.length&&this._refreshable.requestRender()};l._uploadChunk=function(c){const {request:a,resolver:b,chunkOffset:d,chunkIsLast:e,destHeight:p}=c,{data:r,texture:v,
width:h}=a;t.isSome(r)&&(v.updateData(0,0,d,h,p,r,d),e&&b.resolve())};l._uploadNoChunk=function(c){const {request:a,resolver:b}=c,{data:d,texture:e}=a;e.setData(d);b.resolve()};return m}();q.TextureUploadManager=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/WorldExtentClipRenderer":function(){define("exports ../../../../core/maybe ../../../../chunks/common ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ./VertexStream ./shaders/StencilPrograms ../../../webgl/enums ../../../webgl/ProgramTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){const e=y.fromValues(-.5,-.5);y=function(){function p(){this._centerNdc=l.create();this._pxToNdc=l.create();this._worldDimensionsPx=l.create();this._mat3=A.create();this._initialized=!1}var r=p.prototype;r.dispose=function(){this._program=t.disposeMaybe(this._program);this._quad=t.disposeMaybe(this._quad)};r.render=function(v,h){const {context:w}=v;if(!this._updateGeometry(v,h))return!1;this._initialized||this._initialize(w);w.setDepthWriteEnabled(!1);w.setDepthTestEnabled(!1);
w.setColorMask(!1,!1,!1,!1);w.setBlendingEnabled(!1);w.setStencilOp(b.StencilOperation.KEEP,b.StencilOperation.KEEP,b.StencilOperation.REPLACE);w.setStencilFunction(b.CompareFunction.ALWAYS,1,255);w.setStencilTestEnabled(!0);w.useProgram(this._program);this._program.setUniformMatrix3fv("u_worldExtent",this._mat3);this._quad.draw();this._quad.unbind();return!0};r._initialize=function(v){if(!this._initialized){var h=d.createProgram(v,a.stencil);h&&(this._program=h,this._quad=new c(v,[0,0,1,0,0,1,1,
1]),this._initialized=!0)}};r._updateGeometry=function(v,h){const {state:w,pixelRatio:u}=v,{size:k,rotation:g}=w,f=Math.round(k[0]*u),n=Math.round(k[1]*u);if(!w.spatialReference.isWrappable)return!1;v=E.toRadian(g);const z=Math.abs(Math.cos(v)),x=Math.abs(Math.sin(v)),B=Math.round(w.worldScreenWidth);if(Math.round(f*z+n*x)<=B)return!1;const D=(h.left-h.right)*u/f;h=(h.bottom-h.top)*u/n;m.set(this._worldDimensionsPx,B*u,f*x+n*z,1);m.set(this._pxToNdc,2/f,-2/n,1);m.set(this._centerNdc,D,h,1);h=this._mat3;
C.fromTranslation(h,this._centerNdc);C.scale(h,h,this._pxToNdc);0!==g&&C.rotate(h,h,v);C.scale(h,h,this._worldDimensionsPx);C.translate(h,h,e);return!0};return p}();q.WorldExtentClipRenderer=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(q,t){t={shaders:{vertexShader:t.resolveIncludes("stencil/stencil.vert"),fragmentShader:t.resolveIncludes("stencil/stencil.frag")},
attributes:new Map([["a_pos",0]])};q.stencil=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(q,t,E,C,A,y){y=function(m){function l(){var a=m.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",
0]])};return a}t._inheritsLoose(l,m);var c=l.prototype;c.dispose=function(){this._quad&&this._quad.dispose()};c.bind=function(){};c.unbind=function(){};c.draw=function(a,b){if(b.size){var {context:d,renderingOptions:e}=a;this._quad||(this._quad=new A(d,[0,0,1,0,0,1,1,1]));var p=d.getBoundFramebufferObject(),{x:r,y:v,width:h,height:w}=d.getViewport();b.bindTextures(d);var u=b.getBlock(C.ATTRIBUTE_DATA_ANIMATION);if(!E.isNone(u)){var k=u.getFBO(d);u=u.getFBO(d,1);d.setViewport(0,0,b.size,b.size);this._computeDelta(a,
u,e.labelsAnimationTime);this._updateAnimationState(a,u,k);d.bindFramebuffer(p);d.setViewport(r,v,h,w)}}};c._computeDelta=function(a,b,d){const {context:e,painter:p,displayLevel:r}=a,v=p.materialManager.getProgram(this._desc,["delta"]);e.bindFramebuffer(b);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);e.useProgram(v);v.setUniform1i("u_maskTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_0);v.setUniform1i("u_sourceTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_1);v.setUniform1f("u_timeDelta",a.deltaTime);
v.setUniform1f("u_animationTime",d);v.setUniform1f("u_zoomLevel",Math.round(10*r));this._quad.draw()};c._updateAnimationState=function(a,b,d){const {context:e,painter:p}=a;a=p.materialManager.getProgram(this._desc,["update"]);e.bindTexture(b.colorTexture,1);e.useProgram(a);a.setUniform1i("u_sourceTexture",1);e.bindFramebuffer(d);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._quad.draw()};return l}(y.Effect);q.AnimationEffect=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),function(q,t,E,C,A,y,m,l,c){const a=E.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");E=function(){function b(){this._size=[0,0]}var d=b.prototype;d.dispose=function(e){this._backBufferTexture=C.disposeMaybe(this._backBufferTexture);
this._quad=C.disposeMaybe(this._quad)};d.draw=function(e,p,r,v,h){const {context:w,drawPhase:u}=e;this._setupShader(w);v&&"normal"!==v&&u!==A.WGLDrawPhase.LABEL?this._drawBlended(e,p,r,v,h):(e=m.createProgramTemplate("normal"),(e=w.programCache.acquire(e.shaders.vertexShader,e.shaders.fragmentShader,e.attributes))?(w.useProgram(e),p.setSamplingMode(r),w.bindTexture(p,0),e.setUniform1i("u_layerTexture",0),e.setUniform1f("u_opacity",h),w.setBlendingEnabled(!0),w.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA),
p=this._quad,p.draw(),p.unbind(),e.dispose()):a.error(new t("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};d._drawBlended=function(e,p,r,v,h){const {context:w,state:u,pixelRatio:k,inFadeTransition:g}=e;var {size:f}=u,n=w.getBoundFramebufferObject();let z;C.isSome(n)?(f=n.descriptor,z=f.width,f=f.height):(z=Math.round(k*f[0]),f=Math.round(k*f[1]));this._createOrResizeTexture(e,z,f);e=this._backBufferTexture;n.copyToTexture(0,0,z,f,0,0,e);w.setStencilTestEnabled(!1);
w.setStencilWriteMask(0);w.setBlendingEnabled(!0);w.setDepthTestEnabled(!1);w.setDepthWriteEnabled(!1);n=m.createProgramTemplate(v);(n=w.programCache.acquire(n.shaders.vertexShader,n.shaders.fragmentShader,n.attributes))?(w.useProgram(n),e.setSamplingMode(r),w.bindTexture(e,0),n.setUniform1i("u_backbufferTexture",0),p.setSamplingMode(r),w.bindTexture(p,1),n.setUniform1i("u_layerTexture",1),n.setUniform1f("u_opacity",h),n.setUniform1f("u_inFadeOpacity",g?1:0),w.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ZERO),
p=this._quad,p.draw(),p.unbind(),n.dispose(),w.setBlendFunction(l.BlendFactor.ONE,l.BlendFactor.ONE_MINUS_SRC_ALPHA)):a.error(new t("mapview-BlendEffect",`Error creating shader program for blend mode ${v}`))};d._setupShader=function(e){this._quad||(this._quad=new y(e,[-1,-1,1,-1,-1,1,1,1]))};d._createOrResizeTexture=function(e,p,r){({context:e}=e);if(null===this._backBufferTexture||p!==this._size[0]||r!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(p,r):this._backBufferTexture=
new c.Texture(e,{target:l.TextureType.TEXTURE_2D,pixelFormat:l.PixelFormat.RGBA,internalFormat:l.PixelFormat.RGBA,dataType:l.PixelType.UNSIGNED_BYTE,wrapMode:l.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:l.TextureSamplingMode.LINEAR,flipped:!1,width:p,height:r}),this._size[0]=p,this._size[1]=r};return b}();q.BlendEffect=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(q,t){q.createProgramTemplate=function(E){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${E.replace("-","_").toUpperCase()}\n`+t.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${E.replace("-","_").toUpperCase()}\n`+t.resolveIncludes("blend/blend.frag")}}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"./Effect","../../../../webgl/enums"],function(q,t,E,C){E=function(A){function y(l){var c=A.call(this)||this;c.name=c.constructor.name;c.defines=[l];return c}t._inheritsLoose(y,A);var m=y.prototype;m.dispose=function(){};m.bind=function({context:l,painter:c}){this._prev=l.getBoundFramebufferObject();const {width:a,height:b}=l.getViewport();c=c.getFbos(a,b).effect0;l.bindFramebuffer(c);l.setColorMask(!0,!0,!0,!0);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT)};m.unbind=function(){};m.draw=
function(l,c){const {context:a,painter:b}=l;c=b.getPostProcessingEffects(c);const d=a.getBoundFramebufferObject();for(const {postProcessingEffect:e,effect:p}of c)e.draw(l,d,p);a.bindFramebuffer(this._prev);a.setStencilTestEnabled(!1);b.blitTexture(a,d.colorTexture,C.TextureSamplingMode.NEAREST);a.setStencilTestEnabled(!0)};return y}(E.Effect);q.FeatureEffect=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l){return function(c){function a(){var d=c.apply(this,arguments)||this;d.defines=["highlight"];d._hlRenderer=new y;d._hlGradient=new A;d._width=void 0;d._height=void 0;d._hlSurfaces=new m;d._adjustedWidth=void 0;d._adjustedHeight=void 0;d._blitRenderer=new E.BitBlitRenderer;return d}q._inheritsLoose(a,c);var b=a.prototype;b.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};b.bind=function(d){const {context:e,painter:p}=d,{width:r,height:v}=e.getViewport(),h=p.getFbos(r,v).effect0;this.setup(d,r,v);e.bindFramebuffer(h);e.setColorMask(!0,!0,!0,!0);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:d},e,p){this._width=e;this._height=p;const r=e%4,v=p%4;e+=2>r?-r:4-r;p+=2>v?-v:4-v;this._adjustedWidth=e;this._adjustedHeight=p;this._boundFBO=d.getBoundFramebufferObject();e=Math.round(1*e);p=Math.round(1*
p);this._hlRenderer.setup(d,e,p);this._hlSurfaces.setup(d,e,p)};b.draw=function({context:d}){const e=d.getBoundFramebufferObject();d.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);d.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);d.setStencilTestEnabled(!1);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(d,e.colorTexture,l.TextureSamplingMode.NEAREST,1);d.setStencilTestEnabled(!1);d.setBlendingEnabled(!1);d.setColorMask(!1,!1,!1,!0);d.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(d,this._hlSurfaces.sharedBlur1Tex);d.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(d,this._hlSurfaces.sharedBlur2Tex);d.bindFramebuffer(this._boundFBO);d.setBlendingEnabled(!0);d.setColorMask(!0,!0,!0,!0);d.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(d,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};b.setHighlightOptions=function(d){this._hlGradient.setHighlightOptions(d)};return a}(C.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture"],function(q,t,E,C,A){function y(c,a){a.fillColor[0]=c.color.r/255;a.fillColor[1]=c.color.g/255;a.fillColor[2]=c.color.b/255;a.fillColor[3]=c.color.a;c.haloColor?(a.outlineColor[0]=
c.haloColor.r/255,a.outlineColor[1]=c.haloColor.g/255,a.outlineColor[2]=c.haloColor.b/255,a.outlineColor[3]=c.haloColor.a):(a.outlineColor[0]=a.fillColor[0],a.outlineColor[1]=a.fillColor[1],a.outlineColor[2]=a.fillColor[2],a.outlineColor[3]=a.fillColor[3]);a.fillColor[3]*=c.fillOpacity;a.outlineColor[3]*=c.haloOpacity;a.fillColor[0]*=a.fillColor[3];a.fillColor[1]*=a.fillColor[3];a.fillColor[2]*=a.fillColor[3];a.outlineColor[0]*=a.outlineColor[3];a.outlineColor[1]*=a.outlineColor[3];a.outlineColor[2]*=
a.outlineColor[3];a.outlineWidth=E.HIGHLIGHT_SIZING.outlineWidth;a.outerHaloWidth=E.HIGHLIGHT_SIZING.outerHaloWidth;a.innerHaloWidth=E.HIGHLIGHT_SIZING.innerHaloWidth;a.outlinePosition=E.HIGHLIGHT_SIZING.outlinePosition}const m=q.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),l=[0,0,0,0];return function(){function c(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:E.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:E.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:E.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:E.HIGHLIGHT_SIZING.outerHaloWidth};this._shadeTexChanged=!0;this._texelData=new Uint8Array(4*E.SHADE_TEXTURE_SIZE);this._minMaxDistance=[0,0]}var a=c.prototype;a.setHighlightOptions=function(b){function d(k,g,f){u[0]=(1-f)*k[0]+f*g[0];u[1]=(1-f)*k[1]+f*g[1];u[2]=(1-f)*k[2]+f*g[2];u[3]=(1-f)*k[3]+f*g[3]}const e=this._convertedHighlightOptions;y(b,e);b=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth;const p=e.outlinePosition-e.outlineWidth/
2,r=e.outlinePosition+e.outlineWidth/2,v=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth;var h=Math.sqrt(Math.PI/2)*E.SIGMA,w=Math.abs(b)>h?Math.round(10*(Math.abs(b)-h))/10:0;h=Math.abs(v)>h?Math.round(10*(Math.abs(v)-h))/10:0;w&&!h?m.error("The outer rim of the highlight is "+w+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!w&&h?m.error("The inner rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
w&&h&&m.error("The highlight is "+Math.max(w,h)+"px away from the edge of the feature; consider reducing some width values.");const u=[void 0,void 0,void 0,void 0];({_texelData:h}=this);for(let k=0;k<E.SHADE_TEXTURE_SIZE;++k)w=b+k/(E.SHADE_TEXTURE_SIZE-1)*(v-b),w<b?(u[4*k]=0,u[4*k+1]=0,u[4*k+2]=0,u[4*k+3]=0):w<p?d(l,e.outlineColor,(w-b)/(p-b)):w<r?[u[0],u[1],u[2],u[3]]=e.outlineColor:w<v?d(e.outlineColor,e.fillColor,(w-r)/(v-r)):[u[4*k],u[4*k+1],u[4*k+2],u[4*k+3]]=e.fillColor,h[4*k]=255*u[0],h[4*
k+1]=255*u[1],h[4*k+2]=255*u[2],h[4*k+3]=255*u[3];this._minMaxDistance[0]=b;this._minMaxDistance[1]=v;this._shadeTexChanged=!0};a.applyHighlightOptions=function(b,d){this._shadeTex||(this._shadeTex=new A.Texture(b,{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,width:E.SHADE_TEXTURE_SIZE,height:1,samplingMode:C.TextureSamplingMode.LINEAR}));this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,E.SHADE_TEXTURE_SIZE,
1,this._texelData),this._shadeTexChanged=!1);b.bindTexture(this._shadeTex,t.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform2fv("u_minMaxDistance",this._minMaxDistance)};a.destroy=function(){this._shadeTex&&(this._shadeTex.dispose(),this._shadeTex=null)};return c}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(q){q.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];q.HIGHLIGHT_SIZING={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,
outlinePosition:0};q.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];q.SHADE_TEXTURE_SIZE=256;q.SIGMA=1;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(q,t,E,C,A,y,m,l){return function(){function c(){this._height=this._width=void 0;this._resources=null}var a=c.prototype;a.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.preBlur=function(b,d){b.bindTexture(d,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",t.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);b.bindVAO(this._resources.quadVAO);b.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.finalBlur=function(b,d){b.bindTexture(d,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",t.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
b.bindVAO(this._resources.quadVAO);b.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.renderHighlight=function(b,d,e){b.bindTexture(d,q.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.highlightProgram);e.applyHighlightOptions(b,this._resources.highlightProgram);b.bindVAO(this._resources.quadVAO);b.setBlendingEnabled(!0);b.setBlendFunction(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);b.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a._initialize=function(b,
d,e){this._width=d;this._height=e;d=C.BufferObject.createVertex(b,A.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);e=new m.VertexArrayObject(b,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new l.VertexElementDescriptor("a_position",2,A.DataType.BYTE,0,4),new l.VertexElementDescriptor("a_texcoord",2,A.DataType.UNSIGNED_BYTE,2,4)]},{geometry:d});const p=y.createProgram(b,E.highlight),r=y.createProgram(b,E.blur);b.useProgram(p);p.setUniform1i("u_texture",q.TEXTURE_BINDING_HIGHLIGHT_0);
p.setUniform1i("u_shade",q.TEXTURE_BINDING_HIGHLIGHT_1);p.setUniform1f("u_sigma",t.SIGMA);b.useProgram(r);r.setUniform1i("u_texture",q.TEXTURE_BINDING_HIGHLIGHT_0);r.setUniform1f("u_sigma",t.SIGMA);this._resources={quadGeometry:d,quadVAO:e,highlightProgram:p,blurProgram:r}};a.setup=function(b,d,e){this._resources?(this._width=d,this._height=e):this._initialize(b,d,e)};return c}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(q,
t){const E={shaders:{vertexShader:t.resolveIncludes("highlight/textured.vert"),fragmentShader:t.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};t={shaders:{vertexShader:t.resolveIncludes("highlight/textured.vert"),fragmentShader:t.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};q.blur=t;q.highlight=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/maybe","../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(q,t,E,C,A){function y(m,l,c){l=new A.Texture(m,{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,width:l,height:c,samplingMode:E.TextureSamplingMode.LINEAR});m=new C.FramebufferObject(m,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.STENCIL_RENDER_BUFFER},
l);return[l,m]}return function(){function m(){this._height=this._width=void 0;this._resources=null}var l=m.prototype;l.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=t.nullifyNonNullableForDispose(this._resources))};l._initialize=function(c,a,b){this._width=a;this._height=b;const [d,e]=y(c,a,b),[p,r]=y(c,a,b);this._resources={sharedBlur1Tex:d,
sharedBlur1Fbo:e,sharedBlur2Tex:p,sharedBlur2Fbo:r}};l.setup=function(c,a,b){!this._resources||this._width===a&&this._height===b||this.dispose();this._resources||this._initialize(c,a,b)};q._createClass(m,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);
return m}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(q,t,E,C,A,y){A=function(m){function l(){var a=m.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["hittest"];return a}t._inheritsLoose(l,m);var c=l.prototype;c.dispose=function(){E.isSome(this._fbo)&&this._fbo.dispose()};c.createOptions=function({pixelRatio:a},
b,d=C.HITTEST_RADIUS){if(!b.length)return null;b=b.shift();const e=b.x,p=b.y;this._outstanding=b;return{type:"hittest",distance:d*a,position:[e,p]}};c.bind=function(a){const {context:b,attributeView:d}=a;d.size&&(a=d.getBlock(C.ATTRIBUTE_DATA_GPGPU),E.isNone(a)||(a=a.getFBO(b),b.setViewport(0,0,d.size,d.size),b.bindFramebuffer(a),b.setColorMask(!0,!0,!0,!0),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT)))};c.unbind=function(a){};c.draw=function(a){if(!E.isNone(this._outstanding)){var b=
this._outstanding;this._outstanding=null;this._resolve(a,b.resolvers)}};c._resolve=function(){var a=t._asyncToGenerator(function*(b,d){const {context:e,attributeView:p}=b;b=p.getBlock(C.ATTRIBUTE_DATA_GPGPU);if(E.isNone(b))d.forEach(h=>h.resolve([]));else{var r=b.getFBO(e);b=new Uint8Array(r.width*r.height*4);try{yield r.readPixelsAsync(0,0,r.width,r.height,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,b)}catch(h){d.forEach(w=>w.resolve([]));return}r=[];for(let h=0;h<b.length;h+=4){const w=b[h+3];
b[h]&&r.push({id:h/4,directHits:w})}r.sort((h,w)=>w.directHits===h.directHits?w.id-h.id:w.directHits-h.directHits);var v=r.map(h=>h.id);d.forEach(h=>h.resolve(v))}});return function(b,d){return a.apply(this,arguments)}}();return l}(A.Effect);q.HittestEffect=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y){A=function(m){function l(){var a=m.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}t._inheritsLoose(l,m);var c=l.prototype;c.dispose=function(){E.isSome(this._fbo)&&this._fbo.dispose()};c.bind=function({context:a,painter:b}){const {width:d,height:e}=a.getViewport();this._boundFBO=a.getBoundFramebufferObject();b=b.getFbos(d,e).effect0;a.bindFramebuffer(b);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};
c.unbind=function({context:a}){a.bindFramebuffer(this._boundFBO);this._boundFBO=null};c.draw=function(a,b,d=2*C.HITTEST_RADIUS){this._resolve(a,b,d)};c._resolve=function(){var a=t._asyncToGenerator(function*({context:b,state:d,pixelRatio:e},p,r){var v=this;const h=b.getBoundFramebufferObject(),w=d.size[1]*e,u=Math.round(r*e),k=u/2,g=u/2;this._ensureBuffer(u);p.forEach(function(){var f=t._asyncToGenerator(function*(n,z){var x=new Map;yield h.readPixelsAsync(Math.floor(z.x*e-u/2),Math.floor(w-z.y*e-
u/2),u,u,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,v._buf);for(let F=0;F<v._buf32.length;F++){const G=v._buf32[F];if(4294967295!==G&&0!==G){var B=F%u,D=u-Math.floor(F/u);B=(k-B)*(k-B)+(g-D)*(g-D);D=x.has(G)?x.get(G):4294967295;x.set(G,Math.min(B,D))}}x=Array.from(x).sort((F,G)=>F[1]-G[1]).map(F=>F[0]);n.resolve(x);p.delete(z)});return function(n,z){return f.apply(this,arguments)}}())});return function(b,d,e){return a.apply(this,arguments)}}();c._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=
a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return l}(A.Effect);q.HittestEffectVTL=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),function(q,t,E,C,A,y){const m={colorize:()=>new C.Colorize,blur:()=>new E.Blur,bloom:()=>new t.Bloom,opacity:()=>new y.Opacity,"drop-shadow":()=>
new A.DropShadow};let l=function(){function c(){this._effectMap=new Map}var a=c.prototype;a.dispose=function(){this._effectMap.forEach(b=>b.dispose());this._effectMap.clear()};a.getPostProcessingEffects=function(b){if(!b||0===b.length)return[];const d=[];for(const e of b){a:switch(b=e.type,b){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:b="colorize"}let p=this._effectMap.get(b);p||(p=m[b](),this._effectMap.set(b,p));d.push({postProcessingEffect:p,effect:e})}return d};
return c}();q.EffectManager=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(q,t,E,C){const A=[1,0],y=[0,1],m=[1,.8,.6,.4,.2],l=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let c=function(){function a(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=
5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",
attributes:new Map([["a_position",0]])}}}var b=a.prototype;b.dispose=function(){this._quad&&(this._quad.dispose(),this._quad=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=null);if(this._mipsFBOs){for(let d=0;d<this._nMips;d++)this._mipsFBOs[d]&&(this._mipsFBOs[d].horizontal.dispose(),this._mipsFBOs[d].vertical.dispose());this._mipsFBOs=null}};b.draw=function(d,e,p){const {width:r,height:v}=e,{context:h,
painter:w}=d,{materialManager:u}=w;var k=h.gl;const g=this._programDesc,{strength:f,radius:n,threshold:z}=p;this._quad||(this._quad=new t(h,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(d,r,v);h.setStencilTestEnabled(!1);h.setBlendingEnabled(!0);h.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);h.setStencilWriteMask(0);d=this._quad;d.bind();h.bindFramebuffer(this._intensityFBO);p=u.getProgram(g.luminosityHighPass);h.useProgram(p);h.bindTexture(e.colorTexture,0);p.setUniform1i("u_texture",
0);p.setUniform3fv("u_defaultColor",[0,0,0]);p.setUniform1f("u_defaultOpacity",0);p.setUniform1f("u_luminosityThreshold",z);p.setUniform1f("u_smoothWidth",.01);p=[Math.round(r/2),Math.round(v/2)];h.setViewport(0,0,p[0],p[1]);h.setClearColor(0,0,0,0);h.clear(k.COLOR_BUFFER_BIT);d.draw();h.setBlendingEnabled(!1);k=this._intensityFBO.colorTexture;for(let x=0;x<this._nMips;x++){const B=u.getProgram(g.gaussianBlur,[{name:"radius",value:this._kernelSizeArray[x]}]);h.useProgram(B);h.bindTexture(k,x+1);B.setUniform1i("u_colorTexture",
x+1);B.setUniform2fv("u_texSize",p);B.setUniform2fv("u_direction",A);h.setViewport(0,0,p[0],p[1]);const D=this._mipsFBOs[x];h.bindFramebuffer(D.horizontal);d.draw();k=D.horizontal.colorTexture;h.bindFramebuffer(D.vertical);h.bindTexture(k,x+1);B.setUniform2fv("u_direction",y);d.draw();k=D.vertical.colorTexture;p[0]=Math.round(p[0]/2);p[1]=Math.round(p[1]/2)}h.setViewport(0,0,r,v);p=u.getProgram(g.composite,[{name:"nummips",value:5}]);h.bindFramebuffer(this._compositeFBO);h.useProgram(p);p.setUniform1f("u_bloomStrength",
f);p.setUniform1f("u_bloomRadius",n);p.setUniform1fv("u_bloomFactors",m);p.setUniform3fv("u_bloomTintColors",l);h.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);p.setUniform1i("u_blurTexture1",1);h.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);p.setUniform1i("u_blurTexture2",2);h.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);p.setUniform1i("u_blurTexture3",3);h.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);p.setUniform1i("u_blurTexture4",4);h.bindTexture(this._mipsFBOs[4].vertical.colorTexture,
5);p.setUniform1i("u_blurTexture5",5);d.draw();h.bindFramebuffer(e);h.setBlendingEnabled(!0);e=u.getProgram(g.blit);h.useProgram(e);h.bindTexture(this._compositeFBO.colorTexture,6);e.setUniform1i("u_texture",6);h.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE);d.draw();d.unbind();h.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);h.setStencilTestEnabled(!0)};b._createOrResizeResources=function(d,e,p){({context:d}=d);if(!this._compositeFBO||this._size[0]!==e||this._size[1]!==
p){this._size[0]=e;this._size[1]=p;var r=[Math.round(e/2),Math.round(p/2)];this._compositeFBO?this._compositeFBO.resize(e,p):this._compositeFBO=new C.FramebufferObject(d,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:e,height:p});this._intensityFBO?this._intensityFBO.resize(r[0],r[1]):this._intensityFBO=new C.FramebufferObject(d,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:E.TextureType.TEXTURE_2D,
pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]});for(e=0;e<this._nMips;e++)this._mipsFBOs[e]?(this._mipsFBOs[e].horizontal.resize(r[0],r[1]),this._mipsFBOs[e].vertical.resize(r[0],r[1])):this._mipsFBOs[e]={horizontal:new C.FramebufferObject(d,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:r[0],
height:r[1]},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),vertical:new C.FramebufferObject(d,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,
dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]})},r[0]=Math.round(r[0]/2),r[1]=Math.round(r[1]/2)}};return a}();q.Bloom=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(q,
t,E,C){const A=[1,0],y=[0,1];let m=function(){function l(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var c=l.prototype;c.dispose=function(){this._blurFBO&&
(this._blurFBO.dispose(),this._blurFBO=null)};c.draw=function(a,b,d){const {context:e}=a,{type:p,radius:r}=d;0!==r&&(this._createOrResizeResources(a),this._quad||(this._quad=new t(e,[-1,-1,1,-1,-1,1,1,1])),d=this._quad,d.bind(),"blur"===p?this._gaussianBlur(a,b,r):this._radialBlur(a,b),d.unbind())};c._gaussianBlur=function(a,b,d){const {context:e,state:p,painter:r,pixelRatio:v}=a;var {size:h}=p,{materialManager:w}=r;a=this._quad;h=[Math.round(v*h[0]),Math.round(v*h[1])];const u=this._blurFBO;w=w.getProgram(this._programDesc.gaussianBlur,
[{name:"radius",value:Math.ceil(d)}]);e.useProgram(w);e.setBlendingEnabled(!1);e.bindFramebuffer(u);e.bindTexture(b.colorTexture,4);w.setUniform1i("u_colorTexture",4);w.setUniform2fv("u_texSize",h);w.setUniform2fv("u_direction",A);w.setUniform1f("u_sigma",d);a.draw();e.bindFramebuffer(b);e.setStencilWriteMask(0);e.setStencilTestEnabled(!1);e.setDepthWriteEnabled(!1);e.setDepthTestEnabled(!1);e.bindTexture(u.colorTexture,5);w.setUniform1i("u_colorTexture",5);w.setUniform2fv("u_direction",y);a.draw();
e.setBlendingEnabled(!0);e.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);e.setStencilTestEnabled(!0)};c._radialBlur=function(a,b){const {context:d,painter:e}=a,{materialManager:p}=e,r=this._programDesc;a=this._quad;const v=this._blurFBO;d.bindFramebuffer(v);const h=p.getProgram(r.radialBlur);d.useProgram(h);d.setBlendingEnabled(!1);d.bindTexture(b.colorTexture,4);h.setUniform1i("u_colorTexture",4);a.draw();d.bindFramebuffer(b);d.setStencilWriteMask(0);d.setStencilTestEnabled(!1);
d.setDepthWriteEnabled(!1);d.setDepthTestEnabled(!1);d.setBlendingEnabled(!0);b=p.getProgram(r.blit);d.useProgram(b);d.bindTexture(v.colorTexture,5);b.setUniform1i("u_texture",5);d.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);a.draw()};c._createOrResizeResources=function(a){const {context:b,state:d,pixelRatio:e}=a;var {size:p}=d;a=Math.round(e*p[0]);p=Math.round(e*p[1]);this._blurFBO&&this._size[0]===a&&this._size[1]===p||(this._size[0]=a,this._size[1]=p,this._blurFBO?this._blurFBO.resize(a,
p):this._blurFBO=new C.FramebufferObject(b,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:a,height:p},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:a,height:p}))};return l}();q.Blur=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/Texture"],function(q,t,E,C){let A=function(){function y(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var m=y.prototype;m.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};m.draw=function(l,
c,a){const {width:b,height:d}=c;this._createOrResizeResources(l,b,d);const {context:e,painter:p}=l,{materialManager:r}=p,v=this._programDesc;l=this._quad;a=a.colorMatrix;l.bind();const h=this._layerFBOTexture;e.bindFramebuffer(c);c.copyToTexture(0,0,b,d,0,0,h);e.setBlendingEnabled(!1);e.setStencilTestEnabled(!1);c=r.getProgram(v);e.useProgram(c);e.bindTexture(h,2);c.setUniformMatrix4fv("u_coefficients",a);c.setUniform1i("u_colorTexture",2);l.draw();e.setBlendingEnabled(!0);e.setBlendFunction(E.BlendFactor.ONE,
E.BlendFactor.ONE_MINUS_SRC_ALPHA);e.setStencilTestEnabled(!0);l.unbind()};m._createOrResizeResources=function(l,c,a){({context:l}=l);this._layerFBOTexture&&this._size[0]===c&&this._size[1]===a||(this._size[0]=c,this._size[1]=a,this._layerFBOTexture?this._layerFBOTexture.resize(c,a):this._layerFBOTexture=new C.Texture(l,{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,
flipped:!1,width:c,height:a}),this._quad||(this._quad=new t(l,[-1,-1,1,-1,-1,1,1,1])))};return y}();q.Colorize=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),function(q,t,E,C,A,y){const m=[1,0],l=[0,1];
let c=function(){function a(){this._verticalBlurFBO=this._horizontalBlurFBO=null;this._size=[0,0];this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var b=a.prototype;b.dispose=function(){this._layerFBOTexture&&
(this._layerFBOTexture.dispose(),this._layerFBOTexture=null);this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null);this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)};b.draw=function(d,e,p){const {context:r,state:v,painter:h}=d,{materialManager:w}=h,u=this._programDesc,k=e.width,g=e.height,f=[Math.round(k),Math.round(g)],{blurRadius:n,offsetX:z,offsetY:x,color:B}=p;p=[t.pt2px(z),t.pt2px(x)];this._createOrResizeResources(d,k,g,f);
const D=this._horizontalBlurFBO;d=this._verticalBlurFBO;r.setStencilWriteMask(0);r.setStencilTestEnabled(!1);r.setDepthWriteEnabled(!1);r.setDepthTestEnabled(!1);const F=this._layerFBOTexture;e.copyToTexture(0,0,k,g,0,0,F);this._quad||(this._quad=new E(r,[-1,-1,1,-1,-1,1,1,1]));r.setViewport(0,0,f[0],f[1]);const G=this._quad;G.bind();r.setBlendingEnabled(!1);const H=w.getProgram(u.blur,[{name:"radius",value:Math.ceil(n)}]);r.useProgram(H);r.bindFramebuffer(D);r.bindTexture(e.colorTexture,4);H.setUniform1i("u_colorTexture",
4);H.setUniform2fv("u_texSize",f);H.setUniform2fv("u_direction",m);H.setUniform1f("u_sigma",n);G.draw();r.bindFramebuffer(d);r.bindTexture(D.colorTexture,5);H.setUniform1i("u_colorTexture",5);H.setUniform2fv("u_direction",l);G.draw();r.bindFramebuffer(e);r.setViewport(0,0,k,g);e=w.getProgram(u.composite);r.useProgram(e);r.bindTexture(d.colorTexture,2);e.setUniform1i("u_blurTexture",2);r.bindTexture(F,3);e.setUniform1i("u_layerFBOTexture",3);e.setUniform4fv("u_shadowColor",[B[0]/255*B[3],B[1]/255*
B[3],B[2]/255*B[3],B[3]]);e.setUniformMatrix3fv("u_displayViewMat3",v.displayMat3);e.setUniform2fv("u_shadowOffset",p);G.draw();r.setBlendingEnabled(!0);r.setStencilTestEnabled(!0);r.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);G.unbind()};b._createOrResizeResources=function(d,e,p,r){({context:d}=d);this._horizontalBlurFBO&&this._size[0]===e&&this._size[1]===p||(this._size[0]=e,this._size[1]=p,this._horizontalBlurFBO?this._horizontalBlurFBO.resize(r[0],r[1]):this._horizontalBlurFBO=
new A.FramebufferObject(d,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(r[0],r[1]):this._verticalBlurFBO=new A.FramebufferObject(d,{colorTarget:C.TargetType.TEXTURE,
depthStencilTarget:C.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(e,p):this._layerFBOTexture=new y.Texture(d,{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,
dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:e,height:p}))};return a}();q.DropShadow=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../webgl/enums","../../../../../webgl/Texture"],function(q,t,E){let C=function(){function A(){this._size=[0,0]}var y=A.prototype;
y.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};y.draw=function(m,l,c){const {width:a,height:b}=l;this._createOrResizeResources(m,a,b);const {context:d,painter:e}=m;({amount:m}=c);c=d.gl;const p=this._layerFBOTexture;d.bindFramebuffer(l);l.copyToTexture(0,0,a,b,0,0,p);d.setBlendingEnabled(!0);d.setStencilTestEnabled(!1);d.setDepthTestEnabled(!1);d.setClearColor(0,0,0,0);d.clear(c.COLOR_BUFFER_BIT);e.blitTexture(d,p,t.TextureSamplingMode.NEAREST,
m)};y._createOrResizeResources=function(m,l,c){({context:m}=m);this._layerFBOTexture&&this._size[0]===l&&this._size[1]===c||(this._size[0]=l,this._size[1]=c,this._layerFBOTexture?this._layerFBOTexture.resize(l,c):this._layerFBOTexture=new E.Texture(m,{target:t.TextureType.TEXTURE_2D,pixelFormat:t.PixelFormat.RGBA,internalFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:t.TextureSamplingMode.NEAREST,flipped:!1,width:l,height:c}))};return A}();
q.Opacity=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(q,t,E){return function(){function C(y,m){this.brushes=y;this.name=m.name;this.drawPhase=m.drawPhase||E.WGLDrawPhase.MAP;this._targetFn=m.target;this.effects=m.effects||[];this.enableDefaultDraw=m.enableDefaultDraw??(()=>!0)}var A=C.prototype;A.render=
function(y){const {context:m,profiler:l}=y,c=this._targetFn();var a=this.drawPhase&y.drawPhase;l.recordPassStart(this.name);if(a){this.enableDefaultDraw()&&this._doRender(y,c);l.recordPassEnd();for(const b of this.effects){if(!b.enable())continue;a=b.apply;const d=b.args&&b.args(),e=m.getViewport(),p=m.getBoundFramebufferObject(),r=y.passOptions;this._bindEffect(y,a,d);this._doRender(y,c,a.defines);this._drawAndUnbindEffect(y,a,e,p,r,d)}}};A._doRender=function(y,m,l){if(!t.isNone(m)){var {profiler:c,
context:a}=y;for(const b of this.brushes){c.recordBrushStart(b.name);if(t.isSome(b.brushEffect)){const d=a.getViewport(),e=a.getBoundFramebufferObject(),p=y.passOptions;this._bindEffect(y,b.brushEffect);this._drawWithBrush(b,y,m,l);this._drawAndUnbindEffect(y,b.brushEffect,d,e,p)}else this._drawWithBrush(b,y,m,l);c.recordBrushEnd()}}};A._drawWithBrush=function(y,m,l,c){q.isArrayLike(l)?(y.prepareState(m,c),y.drawMany(m,l,c)):l.visible&&(y.prepareState(m,c),y.draw(m,l,c))};A._bindEffect=function(y,
m,l){const {profiler:c}=y;c.recordPassStart(this.name+"."+m.name);m.bind(y,l);m=m.createOptions(y,l);y.passOptions=m};A._drawAndUnbindEffect=function(y,m,l,c,a,b){const {profiler:d,context:e}=y;y.passOptions=a;d.recordBrushStart(m.name);m.draw(y,b);m.unbind(y,b);e.bindFramebuffer(c);const {x:p,y:r,width:v,height:h}=l;e.setViewport(p,r,v,h);d.recordBrushEnd();d.recordPassEnd()};return C}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(q,t,E,C,A,y,m){const l=A("esri-2d-profiler");A=function(){function c(b,d){this._events=new C;this._entries=new Map;this._timings=new E(10);this._currentSummary=this._currentBrush=this._currentPass=this._currentContainer=null;if(l){this._ext=m.createDisjointTimerQuery(b.gl,{});this._debugOutput=d;var e=b.gl;if(this.enableCommandLogging)for(const p in e)if("function"===typeof e[p]){const r=e[p],v=p.includes("draw");e[p]=(...h)=>{this._events.emit("command",{container:this._currentContainer,
pass:this._currentPass,brush:this._currentBrush,method:p,args:h,isDrawCommand:v});this._currentSummary&&(this._currentSummary.commands++,v&&this._currentSummary.drawCommands++);return r.apply(e,h)}}}}var a=c.prototype;a.recordContainerStart=function(b){l&&(this._currentContainer=b)};a.recordContainerEnd=function(){l&&(this._currentContainer=null)};a.recordPassStart=function(b){l&&(this._currentPass=b,this._initSummary())};a.recordPassEnd=function(){l&&(this._currentPass=null,this._emitSummary())};
a.recordBrushStart=function(b){l&&(this._currentBrush=b)};a.recordBrushEnd=function(){l&&(this._currentBrush=null)};a.recordStart=function(b){if(l&&y.isSome(this._ext)){if(this._entries.has(b)){const v=this._entries.get(b);var d=this._ext.resultAvailable(v.query),e=this._ext.disjoint();if(d&&!e){d=this._ext.getResult(v.query)/1E6;e=0;if(y.isSome(this._timings.enqueue(d))){e=this._timings.entries;const h=e.length;let w=0;for(var p of e)w+=p;e=w/h}p=d.toFixed(2);d=e?e.toFixed(2):"--";this.enableCommandLogging?
(console.groupCollapsed(`Frame report for ${b}, ${p} ms (${d} last 10 avg)\n${v.commandsLen} Commands (${v.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(v.summaries),console.log("Commands: ",v.commands),console.groupEnd()):console.log(`Frame report for ${b}, ${p} ms (${d} last 10 avg)`);this._debugOutput.innerHTML=`${p} (${d})`}for(const h of v.handles)h.remove();this._ext.deleteQuery(v.query);this._entries.delete(b)}const r={name:b,query:this._ext.createQuery(),commands:[],
commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(r.handles.push(this._events.on("command",v=>{r.commandsLen++;r.commands.push(v);v.isDrawCommand&&r.drawCommands++})),r.handles.push(this._events.on("summary",v=>{r.summaries.push(v)})));this._ext.beginTimeElapsed(r.query);this._entries.set(b,r)}};a.recordEnd=function(b){l&&y.isSome(this._ext)&&this._entries.has(b)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary=
{container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&this._currentSummary&&this._events.emit("summary",this._currentSummary)};t._createClass(c,[{key:"enableCommandLogging",get:function(){return!("object"===typeof l&&l.disableCommands)}}]);return c}();q.Profiler=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers",
"./maybe"],function(q,t){return function(){function E(A){this._start=this.size=0;this.maxSize=A;this._buffer=Array(A)}var C=E.prototype;C.enqueue=function(A){if(this.size===this.maxSize){const y=this._buffer[this._start];this._buffer[this._start]=A;this._start=(this._start+1)%this.maxSize;return y}this._buffer[(this._start+this.size++)%this.maxSize]=A;return null};C.dequeue=function(){if(0===this.size)return null;const A=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=
(this._start+1)%this.maxSize;return A};C.peek=function(){return 0===this.size?null:this._buffer[this._start]};C.find=function(A){if(0===this.size)return null;for(const y of this._buffer)if(t.isSome(y)&&A(y))return y;return null};C.clear=function(A){let y=this.dequeue();for(;t.isSome(y);)A&&A(y),y=this.dequeue()};q._createClass(E,[{key:"entries",get:function(){return this._buffer}}]);return E}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],
function(q,t){let E=function(C,A,y,m,l,c,a,b,d){this.createQuery=C;this.deleteQuery=A;this.resultAvailable=y;this.getResult=m;this.disjoint=l;this.beginTimeElapsed=c;this.endTimeElapsed=a;this.createTimestamp=b;this.timestampBits=d};q.hasRunningElapsedTimer=!1;q.DisjointTimerQuery=E;q.createDisjointTimerQuery=function(C,A){if(A.disjointTimerQuery)return null;let y=C.getExtension("EXT_disjoint_timer_query_webgl2");return y&&t(C)?new E(()=>C.createQuery(),m=>{C.deleteQuery(m);q.hasRunningElapsedTimer=
!1},m=>C.getQueryParameter(m,C.QUERY_RESULT_AVAILABLE),m=>C.getQueryParameter(m,C.QUERY_RESULT),()=>C.getParameter(y.GPU_DISJOINT_EXT),m=>{q.hasRunningElapsedTimer||(q.hasRunningElapsedTimer=!0,C.beginQuery(y.TIME_ELAPSED_EXT,m))},()=>{C.endQuery(y.TIME_ELAPSED_EXT);q.hasRunningElapsedTimer=!1},m=>y.queryCounterEXT(m,y.TIMESTAMP_EXT),()=>C.getQuery(y.TIMESTAMP_EXT,y.QUERY_COUNTER_BITS_EXT)):(y=C.getExtension("EXT_disjoint_timer_query"))?new E(()=>y.createQueryEXT(),m=>{y.deleteQueryEXT(m);q.hasRunningElapsedTimer=
!1},m=>y.getQueryObjectEXT(m,y.QUERY_RESULT_AVAILABLE_EXT),m=>y.getQueryObjectEXT(m,y.QUERY_RESULT_EXT),()=>C.getParameter(y.GPU_DISJOINT_EXT),m=>{q.hasRunningElapsedTimer||(q.hasRunningElapsedTimer=!0,y.beginQueryEXT(y.TIME_ELAPSED_EXT,m))},()=>{y.endQueryEXT(y.TIME_ELAPSED_EXT);q.hasRunningElapsedTimer=!1},m=>y.queryCounterEXT(m,y.TIMESTAMP_EXT),()=>y.getQueryEXT(y.TIMESTAMP_EXT,y.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./checkWebGLError ./context-util ./ContextState ./enums ./InstanceCounter ./ProgramCache ./renderState ./Texture ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h){function w(g,f,n,z){f?z!==f&&g.bindBuffer(n,f.glName):g.bindBuffer(n,null);return f}function u(g,
f){switch(g){case c.PrimitiveType.POINTS:return 2*f;case c.PrimitiveType.TRIANGLES:return f/3;case c.PrimitiveType.TRIANGLE_STRIP:return f-2;case c.PrimitiveType.TRIANGLE_FAN:return f-2;default:return 0}}let k=function(){function g(n,z){this.gl=n;this.instanceCounter=new a.InstanceCounter;this.programCache=new b.ProgramCache(this);this._state=new l.ContextState;this._numOfTriangles=this._numOfDrawCalls=0;this.type=h(n)?m.ContextType.WEBGL2:m.ContextType.WEBGL1;this._loadExtensions();this.configure(z)}
var f=g.prototype;f.configure=function(n){this._capabilities=new v.Capabilities(this.gl,n);this._parameters=this._loadParameters(n);n=this.gl.getParameter(this.gl.VIEWPORT);this._state=new l.ContextState;this._state.viewport={x:n[0],y:n[1],width:n[2],height:n[3]};this._stateTracker=new d.StateTracker({setBlending:z=>{z?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(z.opRgb,z.opAlpha),this.setBlendFunctionSeparate(z.srcRgb,z.dstRgb,z.srcAlpha,z.dstAlpha),z=z.color,this.setBlendColor(z.r,
z.g,z.b,z.a)):this.setBlendingEnabled(!1)},setCulling:z=>{z?(this.setFaceCullingEnabled(!0),this.setCullFace(z.face),this.setFrontFace(z.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:z=>{z?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(z.factor,z.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:z=>{z?(this.setDepthTestEnabled(!0),this.setDepthFunction(z.func)):this.setDepthTestEnabled(!1)},setStencilTest:z=>{if(z){this.setStencilTestEnabled(!0);const x=z.function;
this.setStencilFunction(x.func,x.ref,x.mask);z=z.operation;this.setStencilOp(z.fail,z.zFail,z.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:z=>{z?(this.setDepthWriteEnabled(!0),this.setDepthRange(z.zNear,z.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:z=>{z?this.setColorMask(z.r,z.g,z.b,z.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:z=>{z?this.setStencilWriteMask(z.mask):this.setStencilWriteMask(0)}});this.enforceState();this._driverTest=new r.WebGLDriverTest(this)};f.dispose=
function(){this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(c.BufferType.ARRAY_BUFFER);this.unbindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER);h(this.gl)&&(this.unbindBuffer(c.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(c.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(c.BufferType.COPY_READ_BUFFER),this.unbindBuffer(c.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;
y.webglDebugEnabled()&&this.instanceCounter.printResourceCount()};f.setPipelineState=function(n){this._stateTracker.setPipeline(n)};f.setBlendingEnabled=function(n){this._state.blend!==n&&(!0===n?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=n,this._stateTracker.invalidateBlending())};f.externalProgramUpdate=function(){this._state.program?.stop();this._state.program=null};f.externalTextureUnitUpdate=function(n,z){for(let x=0;x<n.length;++x)this._state.textureUnitMap[n[x]]=
null;0<=z&&(this._state.activeTexture=z)};f.externalVertexArrayObjectUpdate=function(){const n=this.capabilities.vao;n&&(n.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};f.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};f.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};f.setBlendColor=function(n,z,x,B){if(n!==this._state.blendColor.r||z!==this._state.blendColor.g||x!==this._state.blendColor.b||
B!==this._state.blendColor.a)this.gl.blendColor(n,z,x,B),this._state.blendColor.r=n,this._state.blendColor.g=z,this._state.blendColor.b=x,this._state.blendColor.a=B,this._stateTracker.invalidateBlending()};f.setBlendFunction=function(n,z){if(n!==this._state.blendFunction.srcRGB||z!==this._state.blendFunction.dstRGB)this.gl.blendFunc(n,z),this._state.blendFunction.srcRGB=n,this._state.blendFunction.srcAlpha=n,this._state.blendFunction.dstRGB=z,this._state.blendFunction.dstAlpha=z,this._stateTracker.invalidateBlending()};
f.setBlendFunctionSeparate=function(n,z,x,B){if(this._state.blendFunction.srcRGB!==n||this._state.blendFunction.srcAlpha!==x||this._state.blendFunction.dstRGB!==z||this._state.blendFunction.dstAlpha!==B)this.gl.blendFuncSeparate(n,z,x,B),this._state.blendFunction.srcRGB=n,this._state.blendFunction.srcAlpha=x,this._state.blendFunction.dstRGB=z,this._state.blendFunction.dstAlpha=B,this._stateTracker.invalidateBlending()};f.setBlendEquation=function(n){this._state.blendEquation.mode!==n&&(this.gl.blendEquation(n),
this._state.blendEquation.mode=n,this._state.blendEquation.modeAlpha=n,this._stateTracker.invalidateBlending())};f.setBlendEquationSeparate=function(n,z){if(this._state.blendEquation.mode!==n||this._state.blendEquation.modeAlpha!==z)this.gl.blendEquationSeparate(n,z),this._state.blendEquation.mode=n,this._state.blendEquation.modeAlpha=z,this._stateTracker.invalidateBlending()};f.setColorMask=function(n,z,x,B){if(this._state.colorMask.r!==n||this._state.colorMask.g!==z||this._state.colorMask.b!==x||
this._state.colorMask.a!==B)this.gl.colorMask(n,z,x,B),this._state.colorMask.r=n,this._state.colorMask.g=z,this._state.colorMask.b=x,this._state.colorMask.a=B,this._stateTracker.invalidateColorWrite()};f.setClearColor=function(n,z,x,B){if(this._state.clearColor.r!==n||this._state.clearColor.g!==z||this._state.clearColor.b!==x||this._state.clearColor.a!==B)this.gl.clearColor(n,z,x,B),this._state.clearColor.r=n,this._state.clearColor.g=z,this._state.clearColor.b=x,this._state.clearColor.a=B};f.setFaceCullingEnabled=
function(n){this._state.faceCulling!==n&&(!0===n?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=n,this._stateTracker.invalidateCulling())};f.setPolygonOffsetFillEnabled=function(n){this._state.polygonOffsetFill!==n&&(!0===n?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=n,this._stateTracker.invalidatePolygonOffset())};f.setPolygonOffset=function(n,z){if(this._state.polygonOffset[0]!==
n||this._state.polygonOffset[1]!==z)this._state.polygonOffset[0]=n,this._state.polygonOffset[1]=z,this.gl.polygonOffset(n,z),this._stateTracker.invalidatePolygonOffset()};f.setCullFace=function(n){this._state.cullFace!==n&&(this.gl.cullFace(n),this._state.cullFace=n,this._stateTracker.invalidateCulling())};f.setFrontFace=function(n){this._state.frontFace!==n&&(this.gl.frontFace(n),this._state.frontFace=n,this._stateTracker.invalidateCulling())};f.setScissorTestEnabled=function(n){this._state.scissorTest!==
n&&(!0===n?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=n)};f.setScissorRect=function(n,z,x,B){if(this._state.scissorRect.x!==n||this._state.scissorRect.y!==z||this._state.scissorRect.width!==x||this._state.scissorRect.height!==B)this.gl.scissor(n,z,x,B),this._state.scissorRect.x=n,this._state.scissorRect.y=z,this._state.scissorRect.width=x,this._state.scissorRect.height=B};f.setDepthTestEnabled=function(n){this._state.depthTest!==n&&(!0===n?this.gl.enable(this.gl.DEPTH_TEST):
this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=n,this._stateTracker.invalidateDepthTest())};f.setClearDepth=function(n){this._state.clearDepth!==n&&(this.gl.clearDepth(n),this._state.clearDepth=n)};f.setDepthFunction=function(n){this._state.depthFunction!==n&&(this.gl.depthFunc(n),this._state.depthFunction=n,this._stateTracker.invalidateDepthTest())};f.setDepthWriteEnabled=function(n){this._state.depthWrite!==n&&(this.gl.depthMask(n),this._state.depthWrite=n,this._stateTracker.invalidateDepthWrite())};
f.setDepthRange=function(n,z){if(this._state.depthRange.zNear!==n||this._state.depthRange.zFar!==z)this.gl.depthRange(n,z),this._state.depthRange.zNear=n,this._state.depthRange.zFar=z,this._stateTracker.invalidateDepthWrite()};f.setStencilTestEnabled=function(n){this._state.stencilTest!==n&&(!0===n?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=n,this._stateTracker.invalidateStencilTest())};f.setClearStencil=function(n){n!==this._state.clearStencil&&
(this.gl.clearStencil(n),this._state.clearStencil=n)};f.setStencilFunction=function(n,z,x){if(this._state.stencilFunction.func!==n||this._state.stencilFunction.ref!==z||this._state.stencilFunction.mask!==x)this.gl.stencilFunc(n,z,x),this._state.stencilFunction.face=c.Face.FRONT_AND_BACK,this._state.stencilFunction.func=n,this._state.stencilFunction.ref=z,this._state.stencilFunction.mask=x,this._stateTracker.invalidateStencilTest()};f.setStencilFunctionSeparate=function(n,z,x,B){if(this._state.stencilFunction.face!==
n||this._state.stencilFunction.func!==z||this._state.stencilFunction.ref!==x||this._state.stencilFunction.mask!==B)this.gl.stencilFuncSeparate(n,z,x,B),this._state.stencilFunction.face=n,this._state.stencilFunction.func=z,this._state.stencilFunction.ref=x,this._state.stencilFunction.mask=B,this._stateTracker.invalidateStencilTest()};f.setStencilWriteMask=function(n){this._state.stencilWriteMask!==n&&(this.gl.stencilMask(n),this._state.stencilWriteMask=n,this._stateTracker.invalidateStencilWrite())};
f.setStencilOp=function(n,z,x){if(this._state.stencilOperation.face!==c.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==n||this._state.stencilOperation.zFail!==z||this._state.stencilOperation.zPass!==x)this.gl.stencilOp(n,z,x),this._state.stencilOperation.face=c.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=n,this._state.stencilOperation.zFail=z,this._state.stencilOperation.zPass=x,this._stateTracker.invalidateStencilTest()};f.setStencilOpSeparate=function(n,z,x,B){if(this._state.stencilOperation.face!==
n||this._state.stencilOperation.fail!==z||this._state.stencilOperation.zFail!==x||this._state.stencilOperation.zPass!==B)this.gl.stencilOpSeparate(n,z,x,B),this._state.stencilOperation.face=n,this._state.stencilOperation.fail=z,this._state.stencilOperation.zFail=x,this._state.stencilOperation.zPass=B,this._stateTracker.invalidateStencilTest()};f.setActiveTexture=function(n,z=!1){const x=this._state.activeTexture;0<=n&&(z||n!==this._state.activeTexture)&&(this.gl.activeTexture(c.BASE_TEXTURE_UNIT+
n),this._state.activeTexture=n);return x};f.clear=function(n){n&&this.gl.clear(n)};f.clearSafe=function(n,z=255){n&&(n&c.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),n&c.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),n&c.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(z),this.gl.clear(n))};f.drawArrays=function(n,z,x){y.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=u(n,x));this.gl.drawArrays(n,z,x);y.webglDebugEnabled()&&(n=p.getErrorString(this))&&
console.error("drawArrays:",n)};f.drawElements=function(n,z,x,B){y.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=u(n,z));this.gl.drawElements(n,z,x,B);if(y.webglDebugEnabled()){const G=p.getErrorString(this);if(G){var D=this.getBoundVAO(),F=D?.indexBuffer;D={indexBuffer:F,vertexBuffers:D?.vertexBuffers};n={mode:n,count:z,type:x,offset:B};F=E.applySome(F,H=>H.size)??0;z=B+z;console.error(`drawElements: ${G}${F<z?`. Buffer is too small. Attempted to draw index ${z} of ${F}`:""}`,
{args:n,vao:D})}}};f.logInfo=function(){y.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};f.resetInfo=function(){y.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};f.setViewport=function(n,z,x,B){x=Math.max(Math.round(x),1);B=Math.max(Math.round(B),1);const D=this._state.viewport;if(D.x!==n||D.y!==z||D.width!==x||D.height!==B)D.x=n,D.y=z,D.width=x,D.height=B,this.gl.viewport(n,z,x,B)};f.getViewport=function(){const n=this._state.viewport;
return{x:n.x,y:n.y,width:n.width,height:n.height}};f.useProgram=function(n){this._state.program!==n&&(this._state.program?.stop(),this._state.program=n,this.gl.useProgram(n?.glName??null))};f.bindTexture=function(n,z,x=!1){(z>=this.parameters.maxTextureImageUnits||0>z)&&console.error("Input texture unit is out of range of available units!");const B=this._state.textureUnitMap[z];if(E.isNone(n)||null==n.glName)return E.isSome(B)&&(this.setActiveTexture(z,x),this.gl.bindTexture(B.descriptor.target,null)),
this._state.textureUnitMap[z]=null,B;if(!x&&B===n)return n.isDirty&&(this.setActiveTexture(z,x),n.applyChanges()),B;this.setActiveTexture(z,x);this.gl.bindTexture(n.descriptor.target,n.glName);n.applyChanges();this._state.textureUnitMap[z]=n;return B};f.unbindTexture=function(n){if(!E.isNone(n))for(let z=0;z<this.parameters.maxTextureImageUnits;z++)this._state.textureUnitMap[z]===n&&(this.bindTexture(null,z),this._state.textureUnitMap[z]=null)};f.bindFramebuffer=function(n,z=!1){if(z||this._state.readFramebuffer!==
n||this._state.drawFramebuffer!==n)E.isNone(n)?(this.gl.bindFramebuffer(c.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(n.initializeAndBind(c.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=n,this._state.drawFramebuffer=n)};f.bindFramebufferSeparate=function(n,z,x=!1){const B=z===c.FramebufferTarget.READ_FRAMEBUFFER,D=B?this._state.readFramebuffer:this._state.drawFramebuffer;if(x||D!==n)E.isNone(n)?this.gl.bindFramebuffer(z,null):
n.initializeAndBind(z),B?this._state.readFramebuffer=E.unwrapOr(n,null):this._state.drawFramebuffer=E.unwrapOr(n,null)};f.blitFramebuffer=function(n,z,x=0,B=0,D=n.width,F=n.height,G=0,H=0,J=z.width,L=z.height,K=c.ClearBufferBit.COLOR_BUFFER_BIT,U=c.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(n,c.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(z,c.FramebufferTarget.DRAW_FRAMEBUFFER);this.gl.blitFramebuffer(x,B,D,F,G,H,J,L,K,U)};f.bindBuffer=function(n,z){if(n)switch(z??
(z=n.bufferType),z){case c.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=w(this.gl,n,z,this._state.vertexBuffer);break;case c.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=w(this.gl,n,z,this._state.indexBuffer);break;case c.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=w(this.gl,n,z,this._state.uniformBuffer);break;case c.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=w(this.gl,n,z,this._state.pixelPackBuffer);break;case c.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=
w(this.gl,n,z,this._state.pixelUnpackBuffer);break;case c.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=w(this.gl,n,z,this._state.copyReadBuffer);break;case c.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=w(this.gl,n,z,this._state.copyWriteBuffer)}};f.bindRenderbuffer=function(n){const z=this.gl;n||(z.bindRenderbuffer(z.RENDERBUFFER,null),this._state.renderbuffer=null);this._state.renderbuffer!==n&&(z.bindRenderbuffer(z.RENDERBUFFER,n.glName),this._state.renderbuffer=n)};f._getBufferBinding=
function(n,z){if(z>=this.parameters.maxUniformBufferBindings||0>z)return console.error("Uniform buffer binding point is out of range!"),null;n=this._state.uniformBufferBindingPoints;let x=n[z];E.isNone(x)&&(x={buffer:null,offset:0,size:0},n[z]=x);return x};f.bindBufferBase=function(n,z,x){const B=this._getBufferBinding(n,z);E.isNone(B)||B.buffer===x&&0===B.offset&&0===B.size||(this.gl.bindBufferBase(n,z,x?x.glName:null),B.buffer=x,B.offset=0,B.size=0)};f.bindBufferRange=function(n,z,x,B,D){const F=
this._getBufferBinding(n,z);E.isNone(F)||F.buffer===x&&F.offset===B&&F.size===D||(0!==B%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(n,z,x.glName,B,D),F.buffer=x,F.offset=B,F.size=D))};f.bindUBO=function(n,z,x,B){E.isNone(z)?this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,n,null):(y.webglDebugEnabled()&&(B??z.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),
z.initialize(),void 0!==x&&void 0!==B?this.bindBufferRange(c.BufferType.UNIFORM_BUFFER,n,z.buffer,x,B):this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,n,z.buffer))};f.unbindUBO=function(n){for(let z=0,x=this._state.uniformBufferBindingPoints.length;z<x;z++){const B=this._state.uniformBufferBindingPoints[z];E.isSome(B)&&B.buffer===n.buffer&&this.bindBufferBase(c.BufferType.UNIFORM_BUFFER,z,null)}};f.unbindBuffer=function(n){switch(n){case c.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=w(this.gl,
null,n,this._state.vertexBuffer);break;case c.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=w(this.gl,null,n,this._state.indexBuffer);break;case c.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=w(this.gl,null,n,this._state.uniformBuffer);break;case c.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=w(this.gl,null,n,this._state.pixelPackBuffer);break;case c.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=w(this.gl,null,n,this._state.pixelUnpackBuffer);break;case c.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=
w(this.gl,null,n,this._state.copyReadBuffer);break;case c.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=w(this.gl,null,n,this._state.copyWriteBuffer)}};f.bindVAO=function(n=null){E.isNone(n)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null):this._state.vertexArrayObject!==n&&(n.bind(),this._state.vertexArrayObject=n)};f.clientWaitAsync=function(){var n=t._asyncToGenerator(function*(z=A.Milliseconds(10)){const x=this.gl,B=x.fenceSync(c.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,
0);if(!B)throw Error("Client wait failed, could not create sync object");this.instanceCounter.increment(c.ResourceType.Sync,B);x.flush();let D;do yield C.after(z),D=x.clientWaitSync(B,0,0);while(D===c.ClientWaitSyncStatus.TIMEOUT_EXPIRED);this.instanceCounter.decrement(c.ResourceType.Sync,B);x.deleteSync(B);if(D===c.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");});return function(){return n.apply(this,arguments)}}();f.getBoundFramebufferObject=function(n=c.FramebufferTarget.FRAMEBUFFER){return n===
c.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};f.getBoundVAO=function(){return this._state.vertexArrayObject};f.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(c.BufferType.ARRAY_BUFFER);this.unbindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER);h(this.gl)&&(this.unbindBuffer(c.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(c.BufferType.PIXEL_PACK_BUFFER),
this.unbindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(c.BufferType.COPY_READ_BUFFER),this.unbindBuffer(c.BufferType.COPY_WRITE_BUFFER));for(let n=0;n<this.parameters.maxTextureImageUnits;++n)this.bindTexture(null,n);this.setBlendingEnabled(!1);this.setBlendFunction(c.BlendFactor.ONE,c.BlendFactor.ZERO);this.setBlendEquation(c.BlendOperation.ADD);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(c.Face.BACK);this.setFrontFace(c.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);
this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(c.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(c.CompareFunction.ALWAYS,0,0);this.setStencilOp(c.StencilOperation.KEEP,c.StencilOperation.KEEP,c.StencilOperation.KEEP);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,
!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};f.enforceState=function(){const n=this.gl;var z=this.capabilities.vao;z&&z.bindVertexArray(null);for(var x=0;x<this.parameters.maxVertexAttributes;x++)n.disableVertexAttribArray(x);this._state.vertexBuffer?n.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):n.bindBuffer(c.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?n.bindBuffer(this._state.indexBuffer.bufferType,
this._state.indexBuffer.glName):n.bindBuffer(c.BufferType.ELEMENT_ARRAY_BUFFER,null);if(h(n)){this._state.uniformBuffer?n.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):n.bindBuffer(c.BufferType.UNIFORM_BUFFER,null);for(x=0;x<this._parameters.maxUniformBufferBindings;x++){const B=this._state.uniformBufferBindingPoints[x];if(E.isSome(B)){const {buffer:D,offset:F,size:G}=B;null!==D?0===F&&0===G?n.bindBufferBase(c.BufferType.UNIFORM_BUFFER,x,D.glName):n.bindBufferRange(c.BufferType.UNIFORM_BUFFER,
x,D.glName,F,G):n.bindBufferBase(c.BufferType.UNIFORM_BUFFER,x,null)}}this._state.pixelPackBuffer?n.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):n.bindBuffer(c.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?n.bindBuffer(this._state.pixelUnpackBuffer.bufferType,this._state.pixelUnpackBuffer.glName):n.bindBuffer(c.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?n.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):
n.bindBuffer(c.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?n.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):n.bindBuffer(c.BufferType.COPY_WRITE_BUFFER,null);n.bindFramebuffer(c.FramebufferTarget.READ_FRAMEBUFFER,null);n.readBuffer(n.BACK);this._state.readFramebuffer&&(n.bindFramebuffer(c.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),n.readBuffer(c.ColorAttachment.COLOR_ATTACHMENT0));n.bindFramebuffer(c.FramebufferTarget.DRAW_FRAMEBUFFER,
this._state.drawFramebuffer?.glName??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,n.bindFramebuffer(c.FramebufferTarget.FRAMEBUFFER,this._state.drawFramebuffer?.glName??null);if(z&&this._state.vertexArrayObject){if(z=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null;this.bindVAO(z)}n.useProgram(this._state.program?.glName??null);n.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);
n.bindRenderbuffer(n.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?n.enable(this.gl.BLEND):n.disable(this.gl.BLEND);n.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);n.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);n.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,
this._state.clearColor.a);n.clearDepth(this._state.clearDepth);n.clearStencil(this._state.clearStencil);n.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);n.cullFace(this._state.cullFace);n.depthFunc(this._state.depthFunction);n.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar);!0===this._state.depthTest?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST);n.depthMask(this._state.depthWrite);n.frontFace(this._state.frontFace);
n.lineWidth(1);!0===this._state.faceCulling?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE);n.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?n.enable(n.POLYGON_OFFSET_FILL):n.disable(n.POLYGON_OFFSET_FILL);n.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height);!0===this._state.scissorTest?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST);n.stencilFunc(this._state.stencilFunction.func,
this._state.stencilFunction.ref,this._state.stencilFunction.mask);n.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST);n.stencilMask(this._state.stencilWriteMask);for(z=0;z<this.parameters.maxTextureImageUnits;z++)n.activeTexture(c.BASE_TEXTURE_UNIT+z),n.bindTexture(c.TextureType.TEXTURE_2D,null),n.bindTexture(c.TextureType.TEXTURE_CUBE_MAP,
null),h(n)&&(n.bindTexture(c.TextureType.TEXTURE_3D,null),n.bindTexture(c.TextureType.TEXTURE_2D_ARRAY,null)),x=this._state.textureUnitMap[z],E.isSome(x)&&n.bindTexture(x.descriptor.target,x.glName);n.activeTexture(c.BASE_TEXTURE_UNIT+this._state.activeTexture);z=this._state.viewport;n.viewport(z.x,z.y,z.width,z.height);this.resetInfo()};f._loadExtensions=function(){this.type===m.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};
f._loadParameters=function(n){var z=this.capabilities.textureFilterAnisotropic;n=n.maxAnisotropy??Infinity;const x=h(this.gl),B=this.gl;z={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:z?Math.min(this.gl.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY),n):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),
maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:x?B.getParameter(B.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:x?B.getParameter(B.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:x?B.getParameter(B.MAX_FRAGMENT_UNIFORM_BLOCKS):0,maxUniformBlockSize:x?B.getParameter(B.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:x?B.getParameter(B.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:x?B.getParameter(B.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:x?
B.getParameter(B.MAX_SAMPLES):1};e.Texture.TEXTURE_UNIT_FOR_UPDATES=z.maxTextureImageUnits-1;return z};t._createClass(g,[{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return g}();q.RenderingContext=k;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/ContextState":function(){define(["exports","./enums"],function(q,t){q.ContextState=function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:t.BlendFactor.ONE,dstRGB:t.BlendFactor.ZERO,srcAlpha:t.BlendFactor.ONE,dstAlpha:t.BlendFactor.ZERO};this.blendEquation={mode:t.BlendOperation.ADD,modeAlpha:t.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=t.Face.BACK;this.frontFace=t.CullMode.CCW;this.scissorTest=!1;this.scissorRect=
{x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=t.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=this.stencilTest=!1;this.polygonOffset=[0,0];this.stencilFunction={face:t.Face.FRONT_AND_BACK,func:t.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:t.Face.FRONT_AND_BACK,fail:t.StencilOperation.KEEP,zFail:t.StencilOperation.KEEP,zPass:t.StencilOperation.KEEP};
this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=null;this.uniformBufferBindingPoints=[];this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=null;this.activeTexture=0;this.textureUnitMap=[];this.vertexArrayObject=null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/InstanceCounter":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(q,t,E,C){const A={RECORD_ALLOCATIONS:!1};let y=function(){function m(){this._current=[];this._max=[];for(this._allocations=new E.AllocationTracer(A.RECORD_ALLOCATIONS);this._current.length<C.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var l=m.prototype;l.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};l.increment=function(c,a){const b=++this._current[c];
this._max[c]=Math.max(b,this._max[c]);this._allocations.add(a)};l.decrement=function(c,a){--this._current[c];this._allocations.remove(a)};l.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let c=0;c<C.ResourceType.COUNT;++c){const a=this._current[c];0<a&&console.log(`${C.ResourceType[c]}: ${a}`)}}this._allocations.print()};t._createClass(m,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((c,
a)=>c+a,0)}}]);return m}();q.InstanceCounter=y;q.test=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/AllocationTracer":function(){define(["exports"],function(q){let t=function(){function E(A){this._allocations=new Map;A?Error.stackTraceLimit=Infinity:(this.add=()=>{},this.remove=()=>{})}var C=E.prototype;C.add=function(A){this._allocations.set(A,Error().stack)};C.remove=function(A){this._allocations.delete(A)};C.print=function(){if(0<
this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const A=new Map;this._allocations.forEach(y=>{A.set(y,(A.get(y)??0)+1)});A.forEach((y,m)=>{m=m.split("\n");m.shift();m.shift();console.log(`${y}: ${m.shift()}`);m.forEach(l=>console.log("   ",l))})}};return E}();q.AllocationTracer=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/renderState":function(){define(["exports","../3d/webgl-engine/lib/basicInterfaces",
"./enums"],function(q,t,E){function C(K){return z.intern(K)}function A(K){return x.intern(K)}function y(K){return B.intern(K)}function m(K){return D.intern(K)}function l(K){return F.intern(K)}function c(K){return G.intern(K)}function a(K){return H.intern(K)}function b(K){return J.intern(K)}function d(K){return"["+K.join(",")+"]"}function e(K){return K?d([K.srcRgb,K.srcAlpha,K.dstRgb,K.dstAlpha,K.opRgb,K.opAlpha,K.color.r,K.color.g,K.color.b,K.color.a]):null}function p(K){return K?d([K.face,K.mode]):
null}function r(K){return K?d([K.factor,K.units]):null}function v(K){return K?d([K.func]):null}function h(K){return K?d([K.function.func,K.function.ref,K.function.mask,K.operation.fail,K.operation.zFail,K.operation.zPass]):null}function w(K){return K?d([K.zNear,K.zFar]):null}function u(K){return K?d([K.r,K.g,K.b,K.a]):null}function k(K){return K?d([K.mask]):null}const g={face:E.Face.BACK,mode:E.CullMode.CCW},f={face:E.Face.FRONT,mode:E.CullMode.CCW};var n=function(){function K(U,X){this._makeKey=
U;this._makeRef=X;this._interns=new Map}K.prototype.intern=function(U){if(!U)return null;const X=this._makeKey(U),Z=this._interns;Z.has(X)||Z.set(X,this._makeRef(U));return Z.get(X)??null};return K}();const z=new n(e,K=>({__tag:"Blending",...K})),x=new n(p,K=>({__tag:"Culling",...K})),B=new n(r,K=>({__tag:"PolygonOffset",...K})),D=new n(v,K=>({__tag:"DepthTest",...K})),F=new n(h,K=>({__tag:"StencilTest",...K})),G=new n(w,K=>({__tag:"DepthWrite",...K})),H=new n(u,K=>({__tag:"ColorWrite",...K})),J=
new n(k,K=>({__tag:"StencilWrite",...K})),L=new n(function(K){return K?d([e(K.blending),p(K.culling),r(K.polygonOffset),v(K.depthTest),h(K.stencilTest),w(K.depthWrite),u(K.colorWrite),k(K.stencilWrite)]):null},K=>({blending:C(K.blending),culling:A(K.culling),polygonOffset:y(K.polygonOffset),depthTest:m(K.depthTest),stencilTest:l(K.stencilTest),depthWrite:c(K.depthWrite),colorWrite:a(K.colorWrite),stencilWrite:b(K.stencilWrite)}));n=function(){function K(X){this._stencilWriteInvalid=this._colorWriteInvalid=
this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=X}var U=K.prototype;U.setPipeline=function(X){if(this._pipelineInvalid||X!==this._pipeline)this._setBlending(X.blending),this._setCulling(X.culling),this._setPolygonOffset(X.polygonOffset),this._setDepthTest(X.depthTest),this._setStencilTest(X.stencilTest),this._setDepthWrite(X.depthWrite),this._setColorWrite(X.colorWrite),
this._setStencilWrite(X.stencilWrite),this._pipeline=X;this._pipelineInvalid=!1};U.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};U.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};U.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};U.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};U.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};U.invalidateDepthWrite=
function(){this._pipelineInvalid=this._depthWriteInvalid=!0};U.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};U.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};U._setBlending=function(X){this._blending=this._setSubState(X,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};U._setCulling=function(X){this._culling=this._setSubState(X,this._culling,this._cullingInvalid,this._stateSetters.setCulling);
this._cullingInvalid=!1};U._setPolygonOffset=function(X){this._polygonOffset=this._setSubState(X,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};U._setDepthTest=function(X){this._depthTest=this._setSubState(X,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};U._setStencilTest=function(X){this._stencilTest=this._setSubState(X,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);
this._stencilTestInvalid=!1};U._setDepthWrite=function(X){this._depthWrite=this._setSubState(X,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};U._setColorWrite=function(X){this._colorWrite=this._setSubState(X,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};U._setStencilWrite=function(X){this._stencilWrite=this._setSubState(X,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);
this._stencilTestInvalid=!1};U._setSubState=function(X,Z,aa,da){if(aa||X!==Z)da(X),this._pipelineInvalid=!0;return X};return K}();q.StateTracker=n;q.backFaceCullingParams=g;q.cullingParams=K=>K===t.CullFaceOptions.Back?g:K===t.CullFaceOptions.Front?f:null;q.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};q.defaultDepthWriteParams={zNear:0,zFar:1};q.frontFaceCullingParams=f;q.makeBlending=C;q.makeColorWrite=a;q.makeCulling=A;q.makeDepthTest=m;q.makeDepthWrite=c;q.makePipelineState=function(K){return L.intern(K)};
q.makePolygonOffset=y;q.makeStencilTest=l;q.makeStencilWrite=b;q.separateBlendingParams=function(K,U,X,Z,aa=E.BlendOperation.ADD,da=E.BlendOperation.ADD,R=[0,0,0,0]){return{srcRgb:K,srcAlpha:U,dstRgb:X,dstAlpha:Z,opRgb:aa,opAlpha:da,color:{r:R[0],g:R[1],b:R[2],a:R[3]}}};q.simpleBlendingParams=function(K,U,X=E.BlendOperation.ADD,Z=[0,0,0,0]){return{srcRgb:K,srcAlpha:K,dstRgb:U,dstAlpha:U,opRgb:X,opAlpha:X,color:{r:Z[0],g:Z[1],b:Z[2],a:Z[3]}}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],function(q){q.CullFaceOptions=void 0;(function(t){t[t.None=0]="None";t[t.Front=1]="Front";t[t.Back=2]="Back";t[t.COUNT=3]="COUNT"})(q.CullFaceOptions||(q.CullFaceOptions={}));q.DepthTestFunction=void 0;(function(t){t[t.Less=0]="Less";t[t.Lequal=1]="Lequal";t[t.COUNT=2]="COUNT"})(q.DepthTestFunction||(q.DepthTestFunction={}));q.RenderRequestType=void 0;(function(t){t[t.BACKGROUND=0]="BACKGROUND";t[t.UPDATE=1]="UPDATE"})(q.RenderRequestType||
(q.RenderRequestType={}));q.ResourceState=void 0;(function(t){t[t.NOT_LOADED=0]="NOT_LOADED";t[t.LOADING=1]="LOADING";t[t.LOADED=2]="LOADED"})(q.ResourceState||(q.ResourceState={}));q.StencilBits=void 0;(function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(q.StencilBits||(q.StencilBits={}));q.UpdatePolicy=void 0;(function(t){t[t.ASYNC=0]="ASYNC";t[t.SYNC=1]="SYNC"})(q.UpdatePolicy||(q.UpdatePolicy={}));q.Object3DState=
void 0;(function(t){t[t.Highlight=0]="Highlight";t[t.MaskOccludee=1]="MaskOccludee";t[t.COUNT=2]="COUNT"})(q.Object3DState||(q.Object3DState={}));q.PrimitiveType=void 0;(function(t){t[t.Triangle=0]="Triangle";t[t.Point=1]="Point";t[t.Line=2]="Line"})(q.PrimitiveType||(q.PrimitiveType={}));q.PowerOfTwoResizeMode=void 0;(function(t){t[t.STRETCH=1]="STRETCH";t[t.PAD=2]="PAD"})(q.PowerOfTwoResizeMode||(q.PowerOfTwoResizeMode={}));q.ValidationState=void 0;(function(t){t[t.CHANGED=0]="CHANGED";t[t.UNCHANGED=
1]="UNCHANGED"})(q.ValidationState||(q.ValidationState={}));q.AlphaDiscardMode=void 0;(function(t){t[t.Blend=0]="Blend";t[t.Opaque=1]="Opaque";t[t.Mask=2]="Mask";t[t.MaskBlend=3]="MaskBlend";t[t.COUNT=4]="COUNT"})(q.AlphaDiscardMode||(q.AlphaDiscardMode={}));q.Decorations=void 0;(function(t){t[t.OFF=0]="OFF";t[t.ON=1]="ON"})(q.Decorations||(q.Decorations={}));Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),
function(q,t,E,C,A,y,m){let l=function(){function c(a){this.context=a;this._floatBufferBlendWorking=A.testFloatBufferBlend(a);m.testSVGPremultipliedAlpha(a).then(b=>this._svgAlwaysPremultipliesAlpha=!b)}t._createClass(c,[{key:"floatBufferBlendWorking",get:function(){if(E.isNone(this._floatBufferBlendWorking))throw Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}},{key:"svgAlwaysPremultipliesAlpha",get:function(){if(E.isNone(this._svgAlwaysPremultipliesAlpha))throw Error("svgAlwaysPremultipliesAlpha test not yet available");
return this._svgAlwaysPremultipliesAlpha}},{key:"doublePrecisionRequiresObfuscation",get:function(){if(E.isNone(this._doublePrecisionRequiresObfuscation)){const a=C.testDoublePrecisionArithmetic(this.context,!1),b=C.testDoublePrecisionArithmetic(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===b||5<a/b)}return this._doublePrecisionRequiresObfuscation}},{key:"ignoresSamplerPrecision",get:function(){E.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=y.testSamplerPrecision(this.context));
return this._ignoresSamplerPrecision}}]);return c}();q.WebGLDriverTest=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../core/floatRGBA ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(q,t,E,C,A,y,m,l,c){q.testDoublePrecisionArithmetic=function(a,b){a.resetState();var d=
new m.FramebufferObject(a,{colorTarget:y.TargetType.TEXTURE,depthStencilTarget:y.DepthStencilTargetType.NONE},{target:y.TextureType.TEXTURE_2D,wrapMode:y.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:y.PixelFormat.RGBA,dataType:y.PixelType.UNSIGNED_BYTE,samplingMode:y.TextureSamplingMode.NEAREST,width:1,height:1}),e=C.BufferObject.createVertex(a,y.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));const p=new l.VertexArrayObject(a,new Map([["position",0]]),{geometry:[new c.VertexElementDescriptor("position",
2,y.DataType.UNSIGNED_SHORT,0,4)]},{geometry:e}),r=E.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),v=E.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);b=a.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${b?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]));const h=new Float32Array(6);A.encodeDoubleArray(r,h,3);const w=new Float32Array(6);A.encodeDoubleArray(v,w,3);a.useProgram(b);b.setUniform3f("u_highA",h[0],h[2],h[4]);b.setUniform3f("u_lowA",h[1],h[3],h[5]);b.setUniform3f("u_highB",w[0],w[2],w[4]);b.setUniform3f("u_lowB",w[1],w[3],w[5]);a.bindFramebuffer(d);a.setViewport(0,0,1,1);a.bindVAO(p);a.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,
0,4);a=new Uint8Array(4);d.readPixels(0,0,1,1,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,a);b.dispose();p.dispose(!1);e.dispose();d.dispose();d=(r[2]-v[2])/25;e=t.unpackFloatRGBA(a);return Math.abs(d-e)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(q){const t=new Float32Array(2);q.decodeDoubleArray=function(E,C,A){for(let y=0;y<A;++y)C[y]=E[2*y]+E[2*y+1]};q.encodeDoubleArray=
function(E,C,A){for(let y=0;y<A;++y)C[2*y]=E[y],C[2*y+1]=E[y]-C[2*y]};q.encodeDoubleHi=function(E,C){const A=E.length;for(let y=0;y<A;++y)t[0]=E[y],C[y]=t[0];return C};q.encodeDoubleLo=function(E,C){const A=E.length;for(let y=0;y<A;++y)t[0]=E[y],t[1]=E[y]-t[0],C[y]=t[1];return C};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor".split(" "),
function(q,t,E,C,A,y,m,l,c){var a={exports:{}};(function(b){(function(d){d=d();void 0!==d&&(b.exports=d)})(function(){function d(f){if(null==k){k={};g={};for(var n in f)"number"==typeof f[n]&&(k[f[n]]=n,g[n]=f[n])}}function e(){if(null==k)throw"WebGLDebugUtils.init(ctx) not called";}function p(f){e();var n=k[f];return void 0!==n?"gl."+n:"/*UNKNOWN WebGL ENUM*/ 0x"+f.toString(16)}function r(f,n,z,x){f=u[f];if(void 0!==f&&(f=f[n],void 0!==f&&f[z])){if("object"===typeof f[z]&&void 0!==f[z].enumBitwiseOr){n=
f[z].enumBitwiseOr;z=0;f=[];for(var B=0;B<n.length;++B){var D=g[n[B]];0!==(x&D)&&(z|=D,f.push(p(D)))}return z===x?f.join(" | "):p(x)}return p(x)}return null===x?"null":void 0===x?"undefined":x.toString()}function v(f,n,z){f.__defineGetter__(z,function(){return n[z]});f.__defineSetter__(z,function(x){n[z]=x})}function h(f,n,z,x){function B(J,L){return function(){z&&z(L,arguments);var K=J[L].apply(J,arguments),U=x.getError();0!=U&&(D[U]=!0,n(U,L,arguments));return K}}x=x||f;d(f);n=n||function(J,L,K){for(var U=
"",X=K.length,Z=0;Z<X;++Z)U+=(0==Z?"":", ")+r(L,X,Z,K[Z]);J="WebGL error "+p(J)+" in "+L+"("+U+")";window.console&&window.console.error?window.console.error(J):window.console&&window.console.log&&window.console.log(J)};var D={},F={},G;for(G in f)if("function"==typeof f[G])if("getExtension"!=G)F[G]=B(f,G);else{var H=B(f,G);F[G]=function(){var J=H.apply(f,arguments);return h(J,n,z,x)}}else v(F,f,G);F.getError=function(){for(var J in D)if(D.hasOwnProperty(J)&&D[J])return D[J]=!1,J;return f.NO_ERROR};
return F}function w(f){var n=f.getParameter(f.MAX_VERTEX_ATTRIBS),z=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,z);for(var x=0;x<n;++x)f.disableVertexAttribArray(x),f.vertexAttribPointer(x,4,f.FLOAT,!1,0,0),f.vertexAttrib1f(x,0);f.deleteBuffer(z);n=f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS);for(x=0;x<n;++x)f.activeTexture(f.TEXTURE0+x),f.bindTexture(f.TEXTURE_CUBE_MAP,null),f.bindTexture(f.TEXTURE_2D,null);f.activeTexture(f.TEXTURE0);f.useProgram(null);f.bindBuffer(f.ARRAY_BUFFER,null);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,
null);f.bindFramebuffer(f.FRAMEBUFFER,null);f.bindRenderbuffer(f.RENDERBUFFER,null);f.disable(f.BLEND);f.disable(f.CULL_FACE);f.disable(f.DEPTH_TEST);f.disable(f.DITHER);f.disable(f.SCISSOR_TEST);f.blendColor(0,0,0,0);f.blendEquation(f.FUNC_ADD);f.blendFunc(f.ONE,f.ZERO);f.clearColor(0,0,0,0);f.clearDepth(1);f.clearStencil(-1);f.colorMask(!0,!0,!0,!0);f.cullFace(f.BACK);f.depthFunc(f.LESS);f.depthMask(!0);f.depthRange(0,1);f.frontFace(f.CCW);f.hint(f.GENERATE_MIPMAP_HINT,f.DONT_CARE);f.lineWidth(1);
f.pixelStorei(f.PACK_ALIGNMENT,4);f.pixelStorei(f.UNPACK_ALIGNMENT,4);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);f.UNPACK_COLORSPACE_CONVERSION_WEBGL&&f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.BROWSER_DEFAULT_WEBGL);f.polygonOffset(0,0);f.sampleCoverage(1,!1);f.scissor(0,0,f.canvas.width,f.canvas.height);f.stencilFunc(f.ALWAYS,0,4294967295);f.stencilMask(4294967295);f.stencilOp(f.KEEP,f.KEEP,f.KEEP);f.viewport(0,0,f.canvas.width,f.canvas.height);
for(f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT|f.STENCIL_BUFFER_BIT);f.getError(););}var u={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},
texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},
bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,
1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},k=null,g=null;return{init:d,mightBeEnum:function(f){e();return void 0!==k[f]},glEnumToString:p,glFunctionArgToString:r,glFunctionArgsToString:function(f,n){for(var z="",x=n.length,
B=0;B<x;++B)z+=(0==B?"":", ")+r(f,x,B,n[B]);return z},makeDebugContext:h,makeLostContextSimulatingCanvas:function(f){function n(Q){return"function"==typeof Q?Q:function(N){Q.handleEvent(N)}}function z(){for(var Q=Object.keys(M),N=0;N<Q.length;++N)delete M[Q]}function x(){++aa;U||Z==aa&&f.loseContext()}function B(Q,N){var S=Q[N];return function(){x();if(!U)return S.apply(Q,arguments)}}function D(Q){return{statusMessage:Q,preventDefault:function(){da=!0}}}function F(Q){for(var N in Q)"function"==typeof Q[N]?
L[N]=B(Q,N):v(L,Q,N);L.getError=function(){x();if(!U)for(var T;T=G.getError();)M[T]=!0;for(T in M)if(M[T])return delete M[T],T;return L.NO_ERROR};var S="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(N=0;N<S.length;++N){var W=S[N];L[W]=function(T){return function(){x();if(U)return null;var ba=T.apply(Q,arguments);ba.__webglDebugContextLostId__=K;X.push(ba);return ba}}(Q[W])}S="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");
for(N=0;N<S.length;++N)W=S[N],L[W]=function(T){return function(){x();return U?null:T.apply(Q,arguments)}}(L[W]);S="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(N=0;N<S.length;++N)W=S[N],L[W]=function(T){return function(){x();return U?!1:T.apply(Q,arguments)}}(L[W]);L.checkFramebufferStatus=function(T){return function(){x();return U?L.FRAMEBUFFER_UNSUPPORTED:T.apply(Q,arguments)}}(L.checkFramebufferStatus);L.getAttribLocation=function(T){return function(){x();
return U?-1:T.apply(Q,arguments)}}(L.getAttribLocation);L.getVertexAttribOffset=function(T){return function(){x();return U?0:T.apply(Q,arguments)}}(L.getVertexAttribOffset);L.isContextLost=function(){return U};return L}var G,H=[],J=[];var L={};var K=1,U=!1,X=[],Z=0,aa=0,da=!1,R=0,M={};f.getContext=function(Q){return function(){var N=Q.apply(f,arguments);if(N instanceof WebGLRenderingContext){if(N!=G){if(G)throw"got different context";G=N;L=F(G)}return L}return N}}(f.getContext);(function(Q){var N=
Q.addEventListener;Q.addEventListener=function(S,W,T){switch(S){case "webglcontextlost":H.push(n(W));break;case "webglcontextrestored":J.push(n(W));break;default:N.apply(Q,arguments)}}})(f);f.loseContext=function(){if(!U){U=!0;Z=0;for(++K;G.getError(););z();M[G.CONTEXT_LOST_WEBGL]=!0;var Q=D("context lost"),N=H.slice();setTimeout(function(){for(var S=0;S<N.length;++S)N[S](Q);0<=R&&setTimeout(function(){f.restoreContext()},R)},0)}};f.restoreContext=function(){U&&J.length&&setTimeout(function(){if(!da)throw"can not restore. webglcontestlost listener did not call event.preventDefault";
for(var Q=0;Q<X.length;++Q){var N=X[Q];N instanceof WebGLBuffer?G.deleteBuffer(N):N instanceof WebGLFramebuffer?G.deleteFramebuffer(N):N instanceof WebGLProgram?G.deleteProgram(N):N instanceof WebGLRenderbuffer?G.deleteRenderbuffer(N):N instanceof WebGLShader?G.deleteShader(N):N instanceof WebGLTexture&&G.deleteTexture(N)}w(G);U=!1;aa=0;da=!1;Q=J.slice();N=D("context restored");for(var S=0;S<Q.length;++S)Q[S](N)},0)};f.loseContextInNCalls=function(Q){if(U)throw"You can not ask a lost contet to be lost";
Z=aa+Q};f.getNumCalls=function(){return aa};f.setRestoreTimeout=function(Q){R=Q};return f},resetToInitialState:w}})})(a);q.testFloatBufferBlend=function(b){if(!b.gl)return!1;if(b.type===C.ContextType.WEBGL1)return!(!b.capabilities.textureFloat?.textureFloat||!b.capabilities.colorBufferFloat?.textureFloat);if(!(b.capabilities.textureFloat?.textureFloat&&b.capabilities.colorBufferFloat?.textureFloat&&b.capabilities.colorBufferFloat?.floatBlend))return!1;const d=new y.FramebufferObject(b,{colorTarget:A.TargetType.TEXTURE,
depthStencilTarget:A.DepthStencilTargetType.NONE},{target:A.TextureType.TEXTURE_2D,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:A.PixelFormat.RGBA,dataType:A.PixelType.FLOAT,internalFormat:A.SizedPixelFormat.RGBA32F,samplingMode:A.TextureSamplingMode.NEAREST,width:1,height:1}),e=E.BufferObject.createVertex(b,A.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),p=new l.VertexArrayObject(b,new Map([["a_pos",0]]),{geometry:[new c.VertexElementDescriptor("a_pos",2,A.DataType.UNSIGNED_SHORT,
0,4)]},{geometry:e}),r=b.programCache.acquire("\n  precision highp float;\n  attribute vec2 a_pos;\n\n  void main() {\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n   precision highp float;\n\n   void main() {\n    gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n   }\n  ",new Map([["a_pos",0]]));b.useProgram(r);const v=b.getBoundFramebufferObject(),{x:h,y:w,width:u,height:k}=b.getViewport();b.bindFramebuffer(d);b.setViewport(0,0,1,1);b.bindVAO(p);b.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,
0,4);var g=m.makePipelineState({blending:t.blendingAlpha});b.setPipelineState(g);b.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);a.exports.init(b);g=b.gl.getError();b.setViewport(h,w,u,k);b.bindFramebuffer(v);r.dispose();p.dispose(!1);e.dispose();d.dispose();return 1282===g?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports",
"./TransparencyPassType","../../../webgl/enums","../../../webgl/renderState"],function(q,t,E,C){const A=C.separateBlendingParams(E.BlendFactor.SRC_ALPHA,E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA,E.BlendFactor.ONE_MINUS_SRC_ALPHA),y=C.simpleBlendingParams(E.BlendFactor.ONE,E.BlendFactor.ONE),m=C.simpleBlendingParams(E.BlendFactor.ZERO,E.BlendFactor.ONE_MINUS_SRC_ALPHA),l={factor:-1,units:-2};q.OITPolygonOffset=l;q.OITPolygonOffsetLimit=5E5;q.blendingAlpha=m;q.blendingColor=y;q.blendingDefault=
A;q.getOITPolygonOffset=function(c){return c?l:null};q.oitBlending=function(c){return c===t.TransparencyPassType.FrontFace?null:c===t.TransparencyPassType.Alpha?m:y};q.oitDepthTest=function(c,a=E.CompareFunction.LESS){return c===t.TransparencyPassType.NONE||c===t.TransparencyPassType.FrontFace?a:E.CompareFunction.LEQUAL};q.oitDepthWrite=function(c){return c===t.TransparencyPassType.FrontFace?C.defaultDepthWriteParams:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/3d/webgl-engine/lib/TransparencyPassType":function(){define(["exports"],function(q){q.TransparencyPassType=void 0;var t=q.TransparencyPassType||(q.TransparencyPassType={});t[t.Color=0]="Color";t[t.Alpha=1]="Alpha";t[t.FrontFace=2]="FrontFace";t[t.NONE=3]="NONE";t[t.COUNT=4]="COUNT";Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor".split(" "),
function(q,t,E,C,A,y,m,l){q.testSamplerPrecision=function(c){var a=new A.FramebufferObject(c,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE},{target:C.TextureType.TEXTURE_2D,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,samplingMode:C.TextureSamplingMode.NEAREST,width:1,height:1});const b=new Uint8Array(4),d=E.BufferObject.createVertex(c,C.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),e=new m.VertexArrayObject(c,
new Map([["a_position",0]]),{geometry:[new l.VertexElementDescriptor("a_position",2,C.DataType.SHORT,0,4)]},{geometry:d}),p=c.programCache.acquire("\nprecision highp float;\nattribute vec2 a_pos;\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));c.useProgram(p);var r=new y.Texture(c,{target:C.TextureType.TEXTURE_2D,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,samplingMode:C.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));p.setUniform1i("u_texture",0);c.bindTexture(r,0);r=c.getBoundFramebufferObject();c.bindFramebuffer(a);c.useProgram(p);
const {x:v,y:h,width:w,height:u}=c.getViewport();c.setViewport(0,0,1,1);c.bindVAO(e);c.drawArrays(C.PrimitiveType.TRIANGLE_STRIP,0,4);c.setViewport(v,h,w,u);a.readPixels(0,0,1,1,C.PixelFormat.RGBA,C.PixelType.UNSIGNED_BYTE,b);p.dispose();e.dispose(!1);d.dispose();a.dispose();(a=255!==b[0]||255!==b[1]||255!==b[2]||255!==b[3])&&t.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${b[0]}.${b[1]}.${b[2]}.${b[3]}]`);
c.bindFramebuffer(r);return a};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject".split(" "),function(q,t,E,C,A,y,m,l){function c(){c=t._asyncToGenerator(function*(a){const b=new Image;b.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
b.width=5;b.height=5;yield b.decode();if(!a.gl)return!0;const d=new y.FramebufferObject(a,{colorTarget:A.TargetType.TEXTURE,depthStencilTarget:A.DepthStencilTargetType.NONE},{target:A.TextureType.TEXTURE_2D,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:A.PixelFormat.RGBA,dataType:A.PixelType.UNSIGNED_BYTE,samplingMode:A.TextureSamplingMode.NEAREST,width:1,height:1}),e=C.BufferObject.createVertex(a,A.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),p=new l.VertexArrayObject(a,new Map([["a_pos",
0]]),E.Pos2us,{geometry:e}),r=a.programCache.acquire("\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));a.useProgram(r);const v=new m.Texture(a,{dataType:A.PixelType.UNSIGNED_BYTE,
pixelFormat:A.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:A.TextureSamplingMode.LINEAR},b);a.bindTexture(v,0);r.setUniform1i("u_texture",0);const h=a.getBoundFramebufferObject(),{x:w,y:u,width:k,height:g}=a.getViewport();a.bindFramebuffer(d);a.setViewport(0,0,1,1);a.setClearColor(0,0,0,0);a.setBlendingEnabled(!1);a.clearSafe(A.ClearBufferBit.COLOR_BUFFER_BIT);a.bindVAO(p);a.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4);const f=new Uint8Array(4);d.readPixels(0,
0,1,1,A.PixelFormat.RGBA,A.PixelType.UNSIGNED_BYTE,f);r.dispose();p.dispose(!1);e.dispose();d.dispose();v.dispose();a.setViewport(w,u,k,g);a.bindFramebuffer(h);b.src="";return 255===f[0]});return c.apply(this,arguments)}q.testSVGPremultipliedAlpha=function(a){return c.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),
function(q,t,E,C,A,y,m,l){let c=function(){function a(b,d){this._gl=b;this._textureFloatLinear=this._fragDepth=this._shaderTextureLOD=this._standardDerivatives=this._depthTexture=this._textureNorm16=this._drawBuffers=this._loseContext=this._minMaxBlending=this._colorBufferFloat=this._textureFloat=this._textureFilterAnisotropic=this._compressedTextureS3TC=this._compressedTextureETC=this._vertexArrayObject=this._instancing=null;this._disabledExtensions=d.disabledExtensions||{};this._debugWebGLExtensions=
d.debugWebGLExtensions||{}}a.prototype.enable=function(b){return this[b]};t._createClass(a,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=C.load(this._gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",get:function(){this._instancing||(this._instancing=A.load(this._gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=l.load(this._gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",
get:function(){this._compressedTextureETC||(this._compressedTextureETC=y.loadCompressedTextureETC(this._gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||(this._compressedTextureS3TC=y.loadCompressedTextureS3TC(this._gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=y.loadTextureFilterAnisotropicCapability(this._gl,
this._disabledExtensions));return this._textureFilterAnisotropic}},{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=E.createDisjointTimerQuery(this._gl,this._disabledExtensions));return this._disjointTimerQuery}},{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=y.loadTextureFloat(this._gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=
y.loadColorBufferFloat(this._gl,this._disabledExtensions));return this._colorBufferFloat}},{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=y.loadMinMaxBlending(this._gl,this._disabledExtensions));return this._minMaxBlending}},{key:"depthTexture",get:function(){null===this._depthTexture&&(this._depthTexture=y.loadBooleanExtension(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},
{key:"standardDerivatives",get:function(){null===this._standardDerivatives&&(this._standardDerivatives=y.loadBooleanExtension(this._gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"]));return this._standardDerivatives}},{key:"shaderTextureLOD",get:function(){null===this._shaderTextureLOD&&(this._shaderTextureLOD=y.loadBooleanExtension(this._gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return this._shaderTextureLOD}},{key:"fragDepth",
get:function(){null===this._fragDepth&&(this._fragDepth=y.loadBooleanExtension(this._gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"]));return this._fragDepth}},{key:"loseContext",get:function(){this._loseContext||(this._loseContext=m.load(this._gl,this._debugWebGLExtensions));return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=y.loadTextureNorm16(this._gl,this._disabledExtensions));return this._textureNorm16}},{key:"textureFloatLinear",
get:function(){null===this._textureFloatLinear&&(this._textureFloatLinear=y.loadBooleanExtension(this._gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"]));return this._textureFloatLinear}}]);return a}();q.Capabilities=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(q,t){q.load=function(E,C){return C.disjointTimerQuery?null:
t(E)?{drawBuffers:E.drawBuffers.bind(E),MAX_DRAW_BUFFERS:E.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:E.MAX_COLOR_ATTACHMENTS}:C.drawBuffers?null:(E=E.getExtension("WEBGL_draw_buffers"))?{drawBuffers:E.drawBuffersWEBGL.bind(E),MAX_DRAW_BUFFERS:E.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:E.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],
function(q,t){q.load=function(E){return t(E)?E:(E=E.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:E.drawArraysInstancedANGLE.bind(E),drawElementsInstanced:E.drawElementsInstancedANGLE.bind(E),vertexAttribDivisor:E.vertexAttribDivisorANGLE.bind(E)}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/load":function(){define(["exports","./isWebGL2Context"],function(q,t){q.loadBooleanExtension=function(E,C,A,y,
m){if(y&&t(E))return!0;if(C[A])return!1;for(const l of m)if(E.getExtension(l))return!0;return!1};q.loadColorBufferFloat=function(E,C){if(t(E)){var A=!C.colorBufferHalfFloat&&E.getExtension("EXT_color_buffer_half_float")||!C.colorBufferFloat&&E.getExtension("EXT_color_buffer_float"),y=!C.colorBufferFloat&&E.getExtension("EXT_color_buffer_float");C=!C.floatBlend&&!C.colorBufferFloat&&E.getExtension("EXT_float_blend");return A||y||C?{textureFloat:!!y,textureHalfFloat:!!A,floatBlend:!!C,R16F:E.R16F,RG16F:E.RG16F,
RGBA16F:E.RGBA16F,R32F:E.R32F,RG32F:E.RG32F,RGBA32F:E.RGBA32F,R11F_G11F_B10F:E.R11F_G11F_B10F,RGB16F:E.RGB16F}:null}return E instanceof WebGLRenderingContext?(A=!C.colorBufferHalfFloat&&E.getExtension("EXT_color_buffer_half_float"),y=!C.colorBufferFloat&&E.getExtension("WEBGL_color_buffer_float"),E=!C.floatBlend&&!C.colorBufferFloat&&E.getExtension("EXT_float_blend"),A||y||E?{textureFloat:!!y,textureHalfFloat:!!A,floatBlend:!!E,RGBA16F:A?A.RGBA16F_EXT:void 0,RGB16F:A?A.RGB16F_EXT:void 0,RGBA32F:y?
y.RGBA32F_EXT:void 0}:null):null};q.loadCompressedTextureETC=function(E,C){return C.compressedTextureETC?null:(E=E.getExtension("WEBGL_compressed_texture_etc"))?{COMPRESSED_R11_EAC:E.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:E.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:E.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:E.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:E.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:E.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:E.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,
COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:E.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:E.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:E.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};q.loadCompressedTextureS3TC=function(E,C){return C.compressedTextureS3TC?null:(E=E.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:E.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:E.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:E.COMPRESSED_RGBA_S3TC_DXT3_EXT,
COMPRESSED_RGBA_S3TC_DXT5:E.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};q.loadMinMaxBlending=function(E,C){return t(E)?{MIN:E.MIN,MAX:E.MAX}:C.blendMinMax?null:(E=E.getExtension("EXT_blend_minmax"))?{MIN:E.MIN_EXT,MAX:E.MAX_EXT}:null};q.loadTextureFilterAnisotropicCapability=function(E,C){return C.textureFilterAnisotropic?null:(E=E.getExtension("EXT_texture_filter_anisotropic")||E.getExtension("MOZ_EXT_texture_filter_anisotropic")||E.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?{MAX_TEXTURE_MAX_ANISOTROPY:E.MAX_TEXTURE_MAX_ANISOTROPY_EXT,
TEXTURE_MAX_ANISOTROPY:E.TEXTURE_MAX_ANISOTROPY_EXT}:null};q.loadTextureFloat=function(E,C){if(t(E))return{textureFloat:!0,textureFloatLinear:!C.textureFloatLinear&&!!E.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:E.HALF_FLOAT,R16F:E.R16F,RG16F:E.RG16F,RGBA16F:E.RGBA16F,R32F:E.R32F,RG32F:E.RG32F,RGBA32F:E.RGBA32F,R11F_G11F_B10F:E.R11F_G11F_B10F,RGB16F:E.RGB16F};if(E instanceof WebGLRenderingContext){const A=!C.textureHalfFloat&&E.getExtension("OES_texture_half_float");
return{textureFloat:!C.textureFloat&&!!E.getExtension("OES_texture_float"),textureFloatLinear:!C.textureFloatLinear&&!!E.getExtension("OES_texture_float_linear"),textureHalfFloat:!!A,textureHalfFloatLinear:!C.textureHalfFloatLinear&&!!E.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:A?A.HALF_FLOAT_OES:void 0}}return null};q.loadTextureNorm16=function(E,C){return!t(E)||C.textureNorm16?null:(E=E.getExtension("EXT_texture_norm16"))?{R16:E.R16_EXT,RG16:E.RG16_EXT,RGB16:E.RGB16_EXT,RGBA16:E.RGBA16_EXT,
R16_SNORM:E.R16_SNORM_EXT,RG16_SNORM:E.RG16_SNORM_EXT,RGB16_SNORM:E.RGB16_SNORM_EXT,RGBA16_SNORM:E.RGBA16_SNORM_EXT}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(q){q.load=function(t,E){const C=E.loseContext&&t.getExtension("WEBGL_lose_context");return C?{loseRenderingContext:()=>C.loseContext()}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports","./isWebGL2Context"],function(q,t){q.load=function(E,C){return t(E)?{createVertexArray:E.createVertexArray.bind(E),deleteVertexArray:E.deleteVertexArray.bind(E),bindVertexArray:E.bindVertexArray.bind(E)}:C.vao?null:(E=E.getExtension("OES_vertex_array_object")||E.getExtension("MOZ_OES_vertex_array_object")||E.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:E.createVertexArrayOES.bind(E),deleteVertexArray:E.deleteVertexArrayOES.bind(E),
bindVertexArray:E.bindVertexArrayOES.bind(E)}:null};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/has ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){E=function(p){function r(h){h=p.call(this,h)||this;h._applyVisibilityPassThrottled=l.throttle(h._applyVisibilityPass,32,q._assertThisInitialized(h));h.lastUpdateId=-1;h.updateRequested=!1;h.view=null;return h}q._inheritsLoose(r,p);var v=r.prototype;v.initialize=function(){this.collisionEngine=new e.CollisionEngine};v.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};v.update=function(h){this._applyVisibilityPassThrottled(h)};
v.viewChange=function(){this.requestUpdate()};v.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};v.processUpdate=function(h){this._set("updateParameters",h);this.updateRequested&&(this.updateRequested=!1,this.update(h))};v._applyVisibilityPass=function(h){try{const w=this.view.featuresTilingScheme.getClosestInfoForScale(h.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,h,w)}catch(w){}};q._createClass(r,[{key:"updating",get:function(){y("esri-2d-log-updating")&&
console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`);return this.updateRequested}}]);return r}(A.HandleOwnerMixin(E));t.__decorate([c.property()],E.prototype,"updateRequested",void 0);t.__decorate([c.property({readOnly:!0})],E.prototype,"updateParameters",void 0);t.__decorate([c.property()],E.prototype,"updating",null);t.__decorate([c.property()],E.prototype,"view",void 0);return E=t.__decorate([d.subclass("esri.views.2d.layers.labels.LabelManager")],
E)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(q,t,E,C,A,y){function m(b,d){const e=[];b.forEachTile(p=>e.push(p));e.sort((p,r)=>p.instanceId-r.instanceId);e.forEach(p=>{t.isSome(p.labelMetrics)&&p.isReady&&d(p,p.labelMetrics.getCursor())})}function l(b){return d=>E.pt2px(y.getSizeForValueSimple(d,b))}function c(b){for(const d of b)if(b=
("featureReduction"in d&&d.featureReduction&&"labelingInfo"in d.featureReduction&&d.featureReduction)?.labelingInfo||[],b=[...(d.labelingInfo||[]),...b],d.labelsVisible&&b.length&&b.some(e=>"none"===e.deconflictionStrategy))return!0;return!1}let a=function(){function b(){}var d=b.prototype;d.run=function(e,p,r){const v=[];for(let k=e.length-1;0<=k;k--)a:{var h=v,w=e[k];if(!w.layer||"feature"!==w.layer.type&&"csv"!==w.layer.type&&"geojson"!==w.layer.type&&"ogc-feature"!==w.layer.type&&"stream"!==w.layer.type&&
"subtype-group"!==w.layer.type&&"wfs"!==w.layer.type)break a;const g=w.layer.geometryType,f=!c("subtype-group"===w.layer.type?w.layer.sublayers.items:[w.layer]),n={};if("subtype-group"!==w.layer.type){if("heatmap"===w.tileRenderer?.type)break a;b:{var u=w.layer.renderer;if(u="visualVariables"in u&&u.visualVariables)for(const z of u)if("size"===z.type){u=l(z);break b}u=null}n[0]=u}u=w.tileRenderer;t.isNone(u)||h.push({tileRenderer:u,vvEvaluators:n,deconflictionEnabled:f,geometryType:g,visible:w.layer.visible&&
!w.suspended})}this._transformMetrics(v);this._runCollision(v,p,r)};d._runCollision=function(e,p,r){const [v,h]=p.state.size,w=new A.CollisionBitsetGrid(v,h,p.pixelRatio);for(const {tileRenderer:u,deconflictionEnabled:k,visible:g}of e){const f=u.featuresView.attributeView;k?g?(this._prepare(u),this._collideVisible(w,u,r),this._collideInvisible(w,u)):m(u,(n,z)=>{for(;z.nextId();)f.setLabelMinZoom(z.id,255)}):m(u,(n,z)=>{for(;z.nextId();)f.setLabelMinZoom(z.id,0),g&&w.insertMetrics(z)})}};d._isFiltered=
function(e,p,r){p=p.getFilterFlags(e);e=!r.hasFilter||!!(p&C.FILTER_FLAG_0);r=t.isNone(r.featureEffect)||r.featureEffect.excludedLabelsVisible||!!(p&C.EFFECT_FLAG_0);return!(e&&r)};d._prepare=function(e){const p=e.featuresView.attributeView,r=new Set;m(e,(v,h)=>{for(;h.nextId();)r.has(h.id)||(r.add(h.id),this._isFiltered(h.id,p,e.layerView)?p.setLabelMinZoom(h.id,254):0!==p.getLabelMinZoom(h.id)?p.setLabelMinZoom(h.id,255):p.setLabelMinZoom(h.id,0))})};d._collideVisible=function(e,p,r){const v=p.featuresView.attributeView,
h=new Set;m(p,(w,u)=>{for(;u.nextId();)if(!h.has(u.id))if(w.key.level!==r)v.setLabelMinZoom(u.id,254);else if(0===v.getLabelMinZoom(u.id))switch(e.insertMetrics(u)){case A.HAS_COLLISION:v.setLabelMinZoom(u.id,254);h.add(u.id);break;case A.NONE:v.setLabelMinZoom(u.id,0),h.add(u.id)}})};d._collideInvisible=function(e,p){const r=p.featuresView.attributeView,v=new Set;m(p,(h,w)=>{for(;w.nextId();)if(!v.has(w.id)&&255===r.getLabelMinZoom(w.id))switch(e.insertMetrics(w)){case A.HAS_COLLISION:r.setLabelMinZoom(w.id,
255);v.add(w.id);break;case A.NONE:r.setLabelMinZoom(w.id,0),v.add(w.id)}})};d._transformMetrics=function(e){for(const {tileRenderer:p,geometryType:r,vvEvaluators:v}of e)m(p,(h,w)=>{const u=p.featuresView.attributeView;h=h.transforms.labelMat2d;h[4]=Math.round(h[4]);h[5]=Math.round(h[5]);const k="polyline"===r;for(;w.next();){const B=w.boundsCount,D=w.anchorX,F=w.anchorY;var g=w.size,f=v[0];if(t.isSome(f)){var n=u.getVVSize(w.id);f=f(n);g=isNaN(f)||null==f||Infinity===f?g:f}f=g/2*w.directionX;g=g/
2*w.directionY;for(n=0;n<B;n++){var z=D,x=w.anchorY;k?(z=z+w.boundsX(n)+f,x=x+w.boundsY(n)+g,z=h[0]*z+h[2]*x+h[4],x=h[1]*z+h[3]*x+h[5],w.setBoundsComputedAnchorX(n,Math.floor(z)),w.setBoundsComputedAnchorY(n,Math.floor(x))):(z=h[0]*D+h[2]*F+h[4],x=h[1]*D+h[3]*F+h[5],z=z+w.boundsX(n)+f,x=x+w.boundsY(n)+g,w.setBoundsComputedAnchorX(n,z),w.setBoundsComputedAnchorY(n,x))}}})};return b}();q.CollisionEngine=a;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports",
"../../../../../core/mathUtils","../../../layers/features/support/StaticBitSet"],function(q,t,E){let C=function(){function A(m,l,c){this._debugMap=new Map;this._width=m*c;this._height=l*c;this._pixelRatio=c;m=Math.ceil(this._width/1);l=Math.ceil(this._height/1);this._cols=m;this._rows=l;this._cells=E.StaticBitSet.create(m*l)}var y=A.prototype;y.insertMetrics=function(m){const l=this._hasCollision(m);0===l&&this._markMetrics(m);return l};y.getCellId=function(m,l){return m+l*this._cols};y.has=function(m){return this._cells.has(m)};
y.hasRange=function(m,l){return this._cells.hasRange(m,l)};y.set=function(m){this._cells.set(m)};y.setRange=function(m,l){this._cells.setRange(m,l)};y._collide=function(m,l,c,a){m-=c/2;l-=a/2;c=m+c;var b=l+a;if(0>c||0>b||m>this._width||l>this._height)return 1;a=t.clamp(Math.floor(m/1),0,this._cols);var d=t.clamp(Math.floor(l/1),0,this._rows);m=t.clamp(Math.ceil(c/1),0,this._cols);l=t.clamp(Math.ceil(b/1),0,this._rows);for(c=d;c<=l;c++)for(b=a;b<=m;b++)if(d=this.getCellId(b,c),this.has(d))return 2;
return 0};y._mark=function(m,l,c,a,b){m-=c/2;l-=a/2;c=m+c;var d=l+a;a=t.clamp(Math.floor(m/1),0,this._cols);var e=t.clamp(Math.floor(l/1),0,this._rows);m=t.clamp(Math.ceil(c/1),0,this._cols);l=t.clamp(Math.ceil(d/1),0,this._rows);for(c=e;c<=l;c++)for(d=a;d<=m;d++)e=this.getCellId(d,c),this._debugMap.set(e,b),this.set(e);return!1};y._hasCollision=function(m){const l=m.id;let c=0,a=0;m.save();do{const b=m.boundsCount;c+=b;for(let d=0;d<b;d++){const e=m.boundsComputedAnchorX(d),p=m.boundsComputedAnchorY(d),
r=(m.boundsWidth(d)+2)*this._pixelRatio,v=(m.boundsHeight(d)+2)*this._pixelRatio;switch(this._collide(e,p,r,v)){case 2:return 2;case 1:a++}}}while(m.peekId()===l&&m.next());m.restore();return c===a?1:0};y._markMetrics=function(m){const l=m.id;m.save();do{const c=m.boundsCount;for(let a=0;a<c;a++){const b=m.boundsComputedAnchorX(a),d=m.boundsComputedAnchorY(a),e=(m.boundsWidth(a)+2)*this._pixelRatio,p=(m.boundsHeight(a)+2)*this._pixelRatio;this._mark(b,d,e,p,m.id)}}while(m.peekId()===l&&m.next());
m.restore()};return A}();q.CollisionBitsetGrid=C;q.HAS_COLLISION=2;q.NONE=0;q.OUTSIDE_EXTENT=1;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(q){let t=function(){function E(A,y){this._mask=0;this._buf=A;this._mask=y}E.fromBuffer=function(A,y){return new E(A,y)};E.create=function(A,y=4294967295){A=new Uint32Array(Math.ceil(A/32));return new E(A,y)};var C=E.prototype;
C._getIndex=function(A){return Math.floor(A/32)};C.has=function(A){A&=this._mask;return!!(this._buf[this._getIndex(A)]&1<<A%32)};C.hasRange=function(A,y){for(;A%32&&A!==y;){if(this.has(A))return!0;A++}for(;y%32&&A!==y;){if(this.has(A))return!0;y--}if(A===y)return!1;for(A/=32;A!==y/32;A++)if(this._buf[A])return!0;return!1};C.set=function(A){A&=this._mask;const y=this._getIndex(A);this._buf[y]|=1<<A%32};C.setRange=function(A,y){for(;A%32&&A!==y;)this.set(A++);for(;y%32&&A!==y;)this.set(y--);if(A!==
y)for(A/=32;A!==y/32;A++)this._buf[A]=4294967295};C.unset=function(A){A&=this._mask;const y=this._getIndex(A);this._buf[y]&=4294967295^1<<A%32};C.resize=function(A){const y=this._buf;A=new Uint32Array(Math.ceil(A/32));A.set(y);this._buf=A};C.or=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]|=A._buf[y];return this};C.and=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]&=A._buf[y];return this};C.xor=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]^=A._buf[y];return this};
C.ior=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]|=~A._buf[y];return this};C.iand=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]&=~A._buf[y];return this};C.ixor=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]^=~A._buf[y];return this};C.any=function(){for(let A=0;A<this._buf.length;A++)if(this._buf[A])return!0;return!1};C.copy=function(A){for(let y=0;y<this._buf.length;y++)this._buf[y]=A._buf[y];return this};C.clone=function(){return new E(this._buf.slice(),
this._mask)};C.clear=function(){for(let A=0;A<this._buf.length;A++)this._buf[A]=0};C.forEachSet=function(A){for(let y=0;y<this._buf.length;y++){let m=this._buf[y],l=32*y;if(m)for(;m;)m&1&&A(l),m>>>=1,l++}};C.countSet=function(){let A=0;this.forEachSet(y=>{A++});return A};return E}();q.StaticBitSet=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils",
"../../../../../renderers/support/lengthUtils","../../../../../renderers/visualVariables/support/sizeVariableUtils"],function(q,t,E,C){function A(c,a){switch(a.transformationType){case C.TransformationType.Additive:var b=y(a.minSize,c);return c+(b||a.minDataValue);case C.TransformationType.Constant:return b=(b=a.stops)&&b.length&&b[0].size,null==b&&(b=a.minSize),y(b,c);case C.TransformationType.ClampedLinear:b=(c-a.minDataValue)/(a.maxDataValue-a.minDataValue);var d=y(a.minSize,c),e=y(a.maxSize,c);
c=c<=a.minDataValue?d:c>=a.maxDataValue?e:d+b*(e-d);return c;case C.TransformationType.Proportional:return b=c/a.minDataValue,d=y(a.minSize,c),c=y(a.maxSize,c),t.clamp(b*d,d,c);case C.TransformationType.Stops:{const [r,v,h]=m(c,a.cache.ipData);r===v?c=y(a.stops[r].size,c):(b=y(a.stops[r].size,c),c=y(a.stops[v].size,c),c=b+(c-b)*h)}return c;case C.TransformationType.RealWorldSize:b=E.meterIn[a.valueUnit];d=y(a.minSize,c);e=y(a.maxSize,c);({valueRepresentation:a}=a);let p=null;p="area"===a?2*Math.sqrt(c/
l)/b:"radius"===a||"distance"===a?2*c/b:c/b;return t.clamp(p,d,e);case C.TransformationType.Identity:return c;case C.TransformationType.Unknown:return null}}function y(c,a){return"number"===typeof c?c:A(a,c)}function m(c,a){if(a){var b=0,d=a.length-1;a.some((e,p)=>{if(c<e)return d=p,!0;b=p;return!1});return[b,d,(c-a[b])/(a[d]-a[b])]}}const l=Math.PI;q.getSizeForValueSimple=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/enums ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k,g,f,n,z,x,B,D,F,G,H,J,L,K,U,X,Z,aa,da,R,M,Q){function N(W,T,ba){if(ba.has(W))return ba.get(W);T={tile:T,addedOrModified:[],removed:[]};ba.set(W,T);return T}const S=y("esri-2d-graphic-debug");E=function(W){function T(I){I=W.call(this,I)||this;I._storage=new U.ComputedAttributeStorage;I._displayIds=new Map;I._controller=new AbortController;I._tiles=new Map;I._graphicStoreUpdate=!1;I._graphicsSet=new Set;I._matcher=Promise.resolve(null);I._tileUpdateSet=
new Set;I._tilesToUpdate=new Map;I._graphicIdToAbortController=new Map;I._attached=!1;I._updatingGraphicsTimer=null;I._hashToExpandedSymbol=new Map;I._hashToExpandedSymbolPromise=new Map;I._hashToCIMSymbolPromise=new Map;I._hashToCIM=new Map;I._processing=!1;I._needsProcessing=!1;I._pendingUpdate={added:new Set,updated:new Set,removed:new Set};I.lastUpdateId=-1;I.updateRequested=!1;I.graphicUpdateHandler=I.graphicUpdateHandler.bind(q._assertThisInitialized(I));return I}q._inheritsLoose(T,W);var ba=
T.prototype;ba.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};ba._createMatcher=function(I,P,O){if(I){const V=
L.createSymbolSchemaOptions(I);I=L.createMatcherSchema({indexCount:0,fields:{}},"feature",I,V);this._matcher=J.createMatcher(I,P,null,O)}};ba._createDisplayId=function(I){this._displayIds.has(I)||this._displayIds.set(I,this._storage.createDisplayId());return this._displayIds.get(I)};ba.initialize=function(){this._attributeStore=new K({type:"local",initialize:P=>Promise.resolve(this.container.attributeView.initialize(P)),update:P=>this.container.attributeView.requestUpdate(P),render:()=>this.container.requestRender()},
M.getWebGLCapabilities("2d"),()=>this.notifyChange("updating"));this.container.hasHighlight=()=>this._attributeStore.hasHighlight;const I=new H.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new Z(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,P=>{this._createDisplayId(P.uid);this._setFilterState(P.uid,P.visible)},P=>{const O=this._displayIds.get(P.uid);this._displayIds.delete(P.uid);this._storage.releaseDisplayId(O)},
this._hashToCIM);this._meshFactory=new G.WGLMeshFactory(null,this.uid,I);this._templateStore=I;this.handles.add([c.watch(()=>this.renderer,P=>{this._createMatcher(P,I,this.container.stage.resourceManager);for(const O of this.graphics)this._pendingUpdate.updated.add(O);this.requestUpdate()}),this.view.graphicsTileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",()=>{S&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&
this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",O=>this._graphicsChangeHandler(O)),"graphics");const P=this.container.stage.resourceManager;this._createMatcher(this.renderer,I,P);this._graphicStore.setResourceManager(P);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};ba.hitTest=function(I){if(!this.view||!this.view.position)return[];
const {resolution:P,rotation:O}=this.view.state;return this._graphicStore.hitTest(I.x,I.y,2,P,O)};ba.update=function(I){l.throwIfAborted(this._controller.signal);({resolution:I}=I.state);this._graphicStore.updateLevel(I);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};ba.viewChange=function(){this.requestUpdate()};ba.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};
ba.processUpdate=function(I){this.updateRequested&&(this.updateRequested=!1,this.update(I))};ba.graphicUpdateHandler=function(I){const {graphic:P,property:O}=I;switch(O){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(P);this.requestUpdate();break;case "visible":this._setFilterState(P.uid,P.visible),this._attributeStore.sendUpdates()}};ba.setHighlight=function(I){const P=I.map(O=>this._displayIds.get(O));this._attributeStore.setHighlight(I,P)};ba._getIntersectingTiles=
function(I){I=this._graphicStore.getBounds(I);if(!I||0===r.width(I)||0===r.height(I))return[];const P=aa.intersectingInternationalDateline(I,this.view.spatialReference);return m.isSome(P)?[...(new Set([...this.view.graphicsTileStore.boundsIntersections(P[0]),...this.view.graphicsTileStore.boundsIntersections(P[1])]))]:this.view.graphicsTileStore.boundsIntersections(I)};ba._updateTile=function(){var I=q._asyncToGenerator(function*(P){l.throwIfAborted(this._controller.signal);const O=P.tile;var V=this._getGraphicsData(this._templateStore,
O,P.addedOrModified);V=yield this._processGraphics(O,V);l.throwIfAborted(this._controller.signal);this._patchTile(O.key,{type:"update",addOrUpdate:V,remove:P.removed,end:!0,clear:!1,sort:!1});return V});return function(P){return I.apply(this,arguments)}}();ba._patchTile=function(I,P){this._tiles.has(I)&&(I=this._tiles.get(I),this.container.onTileData(I,P),this.container.requestRender())};ba._graphicsChangeHandler=function(I){const P=this._pendingUpdate;for(const O of I.added)P.added.add(O);for(const O of I.moved)P.updated.add(O);
for(const O of I.removed)this._pendingUpdate.added.has(O)?P.added.delete(O):P.removed.add(O);this._processing?this._needsProcessing=!0:this._updateGraphics()};ba._getGraphicsToUpdate=function(){const I={added:[],removed:[],updated:[]};if(!this.graphics)return I;const P=this._pendingUpdate;for(const O of this.graphics.items)P.added.has(O)?I.added.push(O):P.updated.has(O)&&I.updated.push(O);for(const O of P.removed)this._graphicStore.has(O)&&I.removed.push(O);P.added.clear();P.removed.clear();P.updated.clear();
return I};ba._updateGraphics=function(){var I=q._asyncToGenerator(function*(){this._processing=!0;const {added:P,removed:O,updated:V}=this._getGraphicsToUpdate(),Y=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:ca}=this.view.state;this._graphicStore.updateLevel(ca)}ca=[];const ia=Array(P.length+O.length);for(let ka=0;ka<V.length;ka++){var ea=V[ka];const ja=this._getIntersectingTiles(ea);for(const ma of ja){var fa=ma.id;N(fa,ma,Y).removed.push(this._displayIds.get(ea.uid))}ca.push(this._updateGraphic(ea,
null));ia[ka]=ea}var ha=V.length;for(ea=0;ea<P.length;ea++){const ka=P[ea];ia[ha+ea]=ka;this._graphicsSet.add(ka);ca.push(this._addGraphic(ka))}for(const ka of O){this._abortProcessingGraphic(ka.uid);const ja=this._getIntersectingTiles(ka);for(const ma of ja)fa=ma.id,N(fa,ma,Y).removed.push(this._displayIds.get(ka.uid));this._graphicsSet.delete(ka);this._graphicStore.remove(ka)}this._flipUpdatingGraphics();yield Promise.all(ca);let la;for(ha=0;ha<ia.length;ha++){la=ia[ha];const ka=this._getIntersectingTiles(la);
for(const ja of ka)fa=ja.id,N(fa,ja,Y).addedOrModified.push(la)}this._graphicStore.updateZ();fa=[];for(const [,ka]of Y)fa.push(this._updateTile(ka));yield Promise.all(fa)}catch(ia){l.isAbortError(ia)}for(const ia of O)try{const la=yield this._getSymbolForGraphic(ia,null);if(la){const ka=la.hash();this._hashToExpandedSymbol.delete(ka)}}catch(la){l.isAbortError(la)}Y.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});
return function(){return I.apply(this,arguments)}}();ba._getArcadeInfo=function(I){const P=(I.attributes?Object.keys(I.attributes):[]).map(O=>({name:O,alias:O,type:"string"===typeof I.attributes[O]?"esriFieldTypeString":"esriFieldTypeDouble"}));return m.isNone(I.geometry)?null:{geometryType:h.getJsonType(I.geometry),spatialReference:p.fromJSON(I.geometry.spatialReference),fields:P}};ba._getSymbolForGraphic=function(I,P){l.throwIfAborted(this._controller.signal);return m.isSome(I.symbol)?Promise.resolve(I.symbol):
m.isSome(this.renderer)?this.renderer.getSymbolAsync(I,{scale:this.view.scale,signal:m.isSome(P)?P.signal:null}):Promise.resolve(this._getNullSymbol(I))};ba._getCIMSymbol=function(I,P,O){var V=this._hashToCIM.get(P);if(V)return Promise.resolve(V);I=g.symbolToCIM(I);if(m.isSome(I)){if("CIMSymbolReference"===I.type)return V=I,this._hashToCIM.set(P,V),Promise.resolve(V);if(V=this._hashToCIMSymbolPromise.get(P))return V;V=I.fetchCIMSymbol(O).then(Y=>{this._hashToCIM.set(P,Y.data);this._hashToCIMSymbolPromise.delete(P);
return Y}).catch(Y=>{this._hashToCIMSymbolPromise.delete(P);l.throwIfAbortError(Y);return null});this._hashToCIMSymbolPromise.set(P,V);return V}return Promise.resolve(null)};ba._expandCIMSymbol=function(I,P,O,V){var Y=this._hashToExpandedSymbol.get(O);if(Y)return Promise.resolve(Y);if(Y=this._hashToExpandedSymbolPromise.get(O))return Y;Y=this.container.stage;P=this._getArcadeInfo(P);const ca=L.createSymbolSchemaOptions(null);I=Q.createSymbolSchema(I,ca);Y=da.expandSymbol(I,P,Y.resourceManager,V);
this._hashToExpandedSymbolPromise.set(O,Y);Y.then(ea=>{this._hashToExpandedSymbol.set(O,ea);this._hashToExpandedSymbolPromise.delete(O);return ea});return Y};ba._getSymbolResources=function(){var I=q._asyncToGenerator(function*(P,O){l.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(P,O).then(V=>{const Y=V.hash();return this._getCIMSymbol(V,Y,O).then(ca=>m.isNone(ca)?null:this._expandCIMSymbol(ca,P,Y,O).then(ea=>{const fa=ea.layers.filter(ha=>"text"===
ha.type&&"string"===typeof ha.text);if(fa&&0<fa.length){const ha=Array(fa.length);for(let la=0;la<fa.length;la++){const ka=fa[la],ja=[],[ma]=C.bidiText(ka.text);ka.text=ma;for(let na=0;na<ma.length;na++)ja.push(ma.charCodeAt(na));ha[la]={symbol:ka,id:la,glyphIds:ja}}const ia=new Map;return this.container.getMaterialItems(ha).then(la=>{for(let ka=0;ka<fa.length;ka++){const ja=fa[ka];ia.set(ja.cim,{text:ja.text,mosaicItem:la[ka].mosaicItem})}return{symbol:ea,textInfo:ia,hash:Y}})}return{symbol:ea,hash:Y}}))}).catch(V=>
{l.throwIfAbortError(V);return null}):null});return function(P,O){return I.apply(this,arguments)}}();ba._projectAndNormalizeGeometry=function(){var I=q._asyncToGenerator(function*(P,O){l.throwIfAborted(this._controller.signal);if(m.isNone(P.geometry)||"mesh"===P.geometry.type)return null;var V=P.geometry;h.isPolygon(V)?V.rings=V.rings:h.isPolyline(V)?V.paths=V.paths:h.isExtent(V)&&(P=yield this._getSymbolForGraphic(P,O),l.throwIfAborted(this._controller.signal),V=aa.isMarkerSymbol(P.type)||aa.isTextSymbol(P.type)?
V.center:aa.polygonFromExtent(V));yield k.checkProjectionSupport(V.spatialReference,this.view.spatialReference);P=w.normalizeCentralMeridianForDisplay(V);(V=k.project(P,V.spatialReference,this.view.spatialReference))&&v.closeRingsAndFixWinding(V);return V});return function(P,O){return I.apply(this,arguments)}}();ba._onTileUpdate=function(I){const P=u.getInfo(this.view.spatialReference);if(I.added&&0<I.added.length)for(const O of I.added)this._addNewTile(O,P);if(I.removed&&0<I.removed.length)for(const O of I.removed)this._removeTile(O.key)};
ba._addGraphic=function(){var I=q._asyncToGenerator(function*(P){this._abortProcessingGraphic(P.uid);l.throwIfAborted(this._controller.signal);var O=new AbortController;this._graphicIdToAbortController.set(P.uid,O);O={signal:O.signal};try{yield this._addOrUpdateGraphic(P,O),l.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(P.uid)}catch(V){if(this._graphicIdToAbortController.delete(P.uid),!l.isAbortError(V))throw V;}});return function(P){return I.apply(this,arguments)}}();
ba._updateGraphic=function(I,P){l.throwIfAborted(this._controller.signal);const O=this._projectAndNormalizeGeometry(I,P);P=this._getSymbolResources(I,P);return Promise.all([O,P]).then(([V,Y])=>{l.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(I,Y,V)})};ba._addOrUpdateGraphic=function(I,P){l.throwIfAborted(this._controller.signal);const O=this._projectAndNormalizeGeometry(I,P);P=this._getSymbolResources(I,P);return Promise.all([O,P]).then(([V,Y])=>{l.throwIfAborted(this._controller.signal);
this._graphicsSet.has(I)&&this._graphicStore.addOrModify(I,Y,V)})};ba._addTile=function(I){var P=this.view.featuresTilingScheme.getTileBounds(r.create(),I);const O=this.view.featuresTilingScheme.getTileResolution(I.level);P=new x.GraphicTile(I,O,P[0],P[3]);this._tiles.set(I,P);this.container.addChild(P);return P};ba._addNewTile=function(){var I=q._asyncToGenerator(function*(P,O){const V=this._addTile(P.key),Y=this._graphicStore.queryTileData(this._templateStore,P);if(0!==Y.length){if(O){O=Math.round((O.valid[1]-
O.valid[0])/P.resolution);for(var ca of Y)ca.geometry&&(h.isPoint(ca.geometry)||h.isMultipoint(ca.geometry))&&this._wrapPoints(ca,O)}ca=P.key;this._tileUpdateSet.add(P.key);this.notifyChange("updating");try{const ea={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(P,Y),remove:[],end:!0,sort:!1};V.patch(ea);this._tileUpdateSet.delete(ca);this.notifyChange("updating")}catch(ea){if(this._tileUpdateSet.delete(ca),this.notifyChange("updating"),!l.isAbortError(ea))throw ea;}}});return function(P,
O){return I.apply(this,arguments)}}();ba._removeTile=function(I){if(this._tiles.has(I)){var P=this._tiles.get(I);this.container.removeChild(P);P.destroy();this._tiles.delete(I)}};ba._setFilterState=function(I,P){const O=this._displayIds.get(I);I=this._attributeStore.getHighlightFlag(I);this._attributeStore.setData(O,0,0,I|(P?n.FILTER_FLAG_0:0))};ba._getGraphicsData=function(I,P,O){const V=u.getInfo(this.view.spatialReference);I=this._graphicStore.getGraphicsData(I,P,O);if(V){P=Math.round((V.valid[1]-
V.valid[0])/P.resolution);for(const Y of I)Y.geometry&&(h.isPoint(Y.geometry)||h.isMultipoint(Y.geometry))&&this._wrapPoints(Y,P)}return I};ba._wrapPoints=function(I,P){const O=I.geometry;h.isMultipoint(O)?this._wrapMultipoint(O,P):this._wrapPoint(I,P)};ba._wrapMultipoint=function(I,P){var O=I.points;const V=[];let Y=0,ca=0;for(const [ea,fa]of O)V.push([ea+Y,fa]),Y=0,P===aa.TILE_SIZE?(O=5*aa.PIXEL_BUFFER,ea+ca<O?(V.push([P,0]),Y=-P):ea+ca>aa.TILE_SIZE-O&&(V.push([-P,0]),Y=P)):ea+ca<-aa.PIXEL_BUFFER?
(V.push([P,0]),Y=-P):ea+ca>aa.TILE_SIZE+aa.PIXEL_BUFFER&&(V.push([-P,0]),Y=P),ca+=ea;I.points=V};ba._wrapPoint=function(I,P){const O=I.geometry;if(P===aa.TILE_SIZE){const V=5*aa.PIXEL_BUFFER;O.x<V?I.geometry={points:[[O.x,O.y],[P,0]]}:O.x>aa.TILE_SIZE-V&&(I.geometry={points:[[O.x,O.y],[-P,0]]})}else O.x<-aa.PIXEL_BUFFER?I.geometry={points:[[O.x,O.y],[P,0]]}:O.x>aa.TILE_SIZE+aa.PIXEL_BUFFER&&(I.geometry={points:[[O.x,O.y],[-P,0]]})};ba._processGraphics=function(I,P,O){if(!P||!P.length||!this._meshFactory)return null;
const V=X.GraphicsReader.from(P,this.uid,I.transform),Y=this._meshFactory;return this._matcher.then(ca=>Y.analyzeGraphics(V,this.container.stage.resourceManager,ca,null,null,O).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(I,V)}))};ba._processAnalyzedGraphics=function(I,P){const O=this._meshFactory;var V=P.getSize();P=P.getCursor();const Y=new F.MeshData(I.key.id,{features:V,records:V,metrics:0},z.WGLSymbologyType.DEFAULT,!1,!1);for(V=[];P.next();){const ca=P.readGraphic();
ca.insertAfter=-1===ca.insertAfter?-1:this._displayIds.get(ca.insertAfter);ca.displayId=this._displayIds.get(ca.attributes[this.uid]);const ea=new D(ca.displayId);ea.insertAfter=ca.insertAfter;V.push(ea);O.writeGraphic(Y,P,I.level,this.container.stage.resourceManager)}I=Y.serialize(I.tileInfoView.tileInfo.isWrappable);return 1!==I.length?new B.TileData:B.TileData.fromVertexData(I[0].message,V)};ba._abortProcessingGraphic=function(I){this._graphicIdToAbortController.has(I)&&this._graphicIdToAbortController.get(I).abort()};
ba._getNullSymbol=function(I){I=I.geometry;return h.isPolyline(I)?f.errorPolylineSymbol2D:h.isPolygon(I)||h.isExtent(I)?f.errorPolygonSymbol2D:f.errorPointSymbol2D};ba._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};q._createClass(T,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||
0<this._tileUpdateSet.size||0<this._tilesToUpdate.size||this._attributeStore.isUpdating()}}]);return T}(R.GraphicsView(A.HandleOwnerMixin(E)));t.__decorate([a.property({constructOnly:!0})],E.prototype,"requestUpdateCallback",void 0);t.__decorate([a.property()],E.prototype,"container",void 0);t.__decorate([a.property({constructOnly:!0})],E.prototype,"graphics",void 0);t.__decorate([a.property()],E.prototype,"updating",null);t.__decorate([a.property()],E.prototype,"view",void 0);t.__decorate([a.property()],
E.prototype,"updateRequested",void 0);return E=t.__decorate([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],E)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(q,t,E,C,A,y,m,l){function c(k,g){if(t.isNone(k))return null;var f=k.spatialReference,n=l.getInfo(f);k="toJSON"in k?k.toJSON():k;if(!n)return k;f=l.isWebMercator(f)?
102100:4326;const z=m.cutParams[f].maxX,x=m.cutParams[f].minX;if(y.isPoint(k))return b(k,z,x);if(y.isMultipoint(k))k.points=k.points.map(B=>b(B,z,x));else{if(y.isExtent(k))return a(k,n);if(y.isPolygon(k)||y.isPolyline(k)){f=C.getBoundsXY(w,k);n=f[0];f=f[2];const B=2*m.offsetMagnitude(n,x)*z;k=0===B?k:m.updatePolyGeometry(k,B);n+=B;f+=B;return f>z?v(k,z,g):n<x?v(k,x,g):k}}return k}function a(k,g){if(!g)return k;const f=d(k,g).map(n=>n.extent);return 2>f.length?f[0]||k:2<f.length?(k.xmin=g.valid[0],
k.xmax=g.valid[1],k):{rings:f.map(n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]])}}function b(k,g,f){if(Array.isArray(k)){var n=k[0];n>g?(f=m.offsetMagnitude(n,g),k[0]=n+-2*f*g):n<f&&(g=m.offsetMagnitude(n,f),k[0]=n+-2*g*f)}else n=k.x,n>g?(f=m.offsetMagnitude(n,g),k.x+=-2*f*g):n<f&&(g=m.offsetMagnitude(n,f),k.x+=-2*g*f);return k}function d(k,g){const f=[],{ymin:n,ymax:z,xmin:x,xmax:B}=k;var D=k.xmax-k.xmin;const [F,G]=g.valid,{x:H,frameId:J}=e(k.xmin,g),{x:L,
frameId:K}=e(k.xmax,g);k=H===L&&0<D;if(D>2*G){D={xmin:x<B?H:L,ymin:n,xmax:G,ymax:z};k={xmin:F,ymin:n,xmax:x<B?L:H,ymax:z};g={xmin:0,ymin:n,xmax:G,ymax:z};const U={xmin:F,ymin:n,xmax:0,ymax:z},X=[],Z=[];p(D,g)&&X.push(J);p(D,U)&&Z.push(J);p(k,g)&&X.push(K);p(k,U)&&Z.push(K);for(let aa=J+1;aa<K;aa++)X.push(aa),Z.push(aa);f.push(new h(D,[J]),new h(k,[K]),new h(g,X),new h(U,Z))}else H>L||k?f.push(new h({xmin:H,ymin:n,xmax:G,ymax:z},[J]),new h({xmin:F,ymin:n,xmax:L,ymax:z},[K])):f.push(new h({xmin:H,ymin:n,
xmax:L,ymax:z},[J]));return f}function e(k,g){const [f,n]=g.valid;g=2*n;var z=0;k>n?(z=Math.ceil(Math.abs(k-n)/g),k-=z*g):k<f&&(z=Math.ceil(Math.abs(k-f)/g),k+=z*g,z=-z);return{x:k,frameId:z}}function p(k,g){const {xmin:f,ymin:n,xmax:z,ymax:x}=g;return r(k,f,n)&&r(k,f,x)&&r(k,z,x)&&r(k,z,n)}function r(k,g,f){return g>=k.xmin&&g<=k.xmax&&f>=k.ymin&&f<=k.ymax?!0:!1}function v(k,g,f=!0){const n=!y.isPolyline(k);n&&A.closeRings(k);if(f)return(new u).cut(k,g);f=n?k.rings:k.paths;const z=n?4:2,x=f.length;
g*=-2;for(let B=0;B<x;B++){const D=f[B];if(D&&D.length>=z){const F=[];for(const G of D)F.push([G[0]+g,G[1]]);f.push(F)}}n?k.rings=f:k.paths=f;return k}let h=function(k,g){this.extent=k;this.frameIds=g};const w=E.create();let u=function(){function k(){this._linesIn=[];this._linesOut=[]}var g=k.prototype;g.cut=function(f,n){this._xCut=n;if(f.rings)this._closed=!0,n=f.rings,this._minPts=4;else if(f.paths)this._closed=!1,n=f.paths,this._minPts=2;else return null;for(var z of n)if(z&&!(z.length<this._minPts)){n=
!0;for(const x of z)n?(this.moveTo(x),n=!1):this.lineTo(x);this._closed&&this.close()}this._pushLineIn();this._pushLineOut();n=[];for(const x of this._linesIn)x&&x.length>=this._minPts&&n.push(x);z=-2*this._xCut;for(const x of this._linesOut)if(x&&x.length>=this._minPts){for(const B of x)B[0]+=z;n.push(x)}this._closed?f.rings=n:f.paths=n;return f};g.moveTo=function(f){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(f[0]);this._moveTo(f[0],f[1],this._prevSide);this._firstPt=this._prevPt=
f};g.lineTo=function(f){const n=this._side(f[0]);if(-1===n*this._prevSide){const z=this._intersect(this._prevPt,f);this._lineTo(this._xCut,z,0);this._prevSide=0}this._lineTo(f[0],f[1],n);this._prevSide=n;this._prevPt=f};g.close=function(){const f=this._firstPt,n=this._prevPt;f[0]===n[0]&&f[1]===n[1]||this.lineTo(f);this._checkClosingPt(this._lineIn);this._checkClosingPt(this._lineOut)};g._moveTo=function(f,n,z){this._closed?(this._lineIn.push([0>=z?f:this._xCut,n]),this._lineOut.push([0<=z?f:this._xCut,
n])):(0>=z&&this._lineIn.push([f,n]),0<=z&&this._lineOut.push([f,n]))};g._lineTo=function(f,n,z){this._closed?(this._addPolyVertex(this._lineIn,0>=z?f:this._xCut,n),this._addPolyVertex(this._lineOut,0<=z?f:this._xCut,n)):0>z?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([f,n])):0<z?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([f,n])):0>this._prevSide?(this._lineIn.push([f,n]),this._lineOut.push([f,n])):0<this._prevSide&&(this._lineOut.push([f,n]),this._lineIn.push([f,n]))};
g._addPolyVertex=function(f,n,z){const x=f.length;1<x&&f[x-1][0]===n&&f[x-2][0]===n?f[x-1][1]=z:f.push([n,z])};g._checkClosingPt=function(f){const n=f.length;3<n&&f[0][0]===this._xCut&&f[n-2][0]===this._xCut&&f[1][0]===this._xCut&&(f[0][1]=f[n-2][1],f.pop())};g._side=function(f){return f<this._xCut?-1:f>this._xCut?1:0};g._intersect=function(f,n){return f[1]+(this._xCut-f[0])/(n[0]-f[0])*(n[1]-f[1])};g._pushLineIn=function(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn);
this._lineIn=[]};g._pushLineOut=function(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut);this._lineOut=[]};return k}();q.CutVertical=u;q.normalizeCentralMeridianForDisplay=function(k){return c(k,!1)};q.normalizeCentralMeridianSync=function(k){return c(k,!0)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(q,t,E,C,A,y,m){function l(v,h){if(!h)return null;if("x"in h){var w={x:0,y:0};[w.x,w.y]=v(h.x,h.y,d);null!=h.z&&(w.z=h.z);null!=h.m&&(w.m=h.m);return w}return"xmin"in h?(w={xmin:0,ymin:0,xmax:0,ymax:0},[w.xmin,w.ymin]=v(h.xmin,h.ymin,d),[w.xmax,w.ymax]=v(h.xmax,h.ymax,d),h.hasZ&&(w.zmin=h.zmin,w.zmax=h.zmax,w.hasZ=!0),h.hasM&&(w.mmin=h.mmin,w.mmax=h.mmax,w.hasM=!0),w):"rings"in h?{rings:c(h.rings,v),hasM:h.hasM,hasZ:h.hasZ}:"paths"in h?{paths:c(h.paths,v),hasM:h.hasM,hasZ:h.hasZ}:"points"in
h?{points:a(h.points,v),hasM:h.hasM,hasZ:h.hasZ}:null}function c(v,h){const w=[];for(const u of v)w.push(a(u,h));return w}function a(v,h){const w=[];for(const u of v)v=h(u[0],u[1],[0,0]),w.push(v),2<u.length&&v.push(u[2]),3<u.length&&v.push(u[3]);return w}function b(){b=t._asyncToGenerator(function*(v,h){v&&h&&(v=Array.isArray(v)?v.map(w=>E.isSome(w.geometry)?w.geometry.spatialReference:null).filter(E.isSome):[v],yield C.initializeProjection(v.map(w=>({source:w,dest:h}))))});return b.apply(this,arguments)}
const d=[0,0],e=l.bind(null,m.lngLatToXY),p=l.bind(null,m.xyToLngLat),r=new (function(){function v(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var h=v.prototype;h.push=function(){var w=t._asyncToGenerator(function*(u,k,g){if(!(u&&u.length&&k&&g)||y.equals(k,g))return u;const f={geometries:u,inSpatialReference:k,outSpatialReference:g,resolve:null};this._jobs.push(f);return new Promise(n=>{f.resolve=n;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(u,
k,g){return w.apply(this,arguments)}}();h._process=function(){this._timer=null;const w=this._jobs.shift();if(w){var {geometries:u,inSpatialReference:k,outSpatialReference:g,resolve:f}=w;m.canProject(k,g)?y.isWebMercator(g)?f(u.map(e)):f(u.map(p)):f(C.projectMany(A.jsonAdapter,u,k,g,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return v}());q.checkProjectionSupport=function(v,h){return b.apply(this,arguments)};q.project=function(v,h,w,u){if(!v)return v;w||(w=h,h=v.spatialReference);
return y.isValid(h)&&y.isValid(w)&&!y.equals(h,w)?m.canProject(h,w)?(v=y.isWebMercator(w)?e(v):p(v),v.spatialReference=w,v):C.projectMany(A.jsonAdapter,[v],h,w,null,u)[0]:v};q.projectMany=function(v,h,w){return r.push(v,h,w)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(q){let t=function(m,l,c){this.x=m;this.y=l;this.spatialReference=c;this.m=this.z=void 0},E=function(m,l,c,
a){this.rings=m;this.spatialReference=l;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);a&&(this.hasM=a)},C=function(m,l,c,a){this.paths=m;this.spatialReference=l;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);a&&(this.hasM=a)},A=function(m,l,c,a){this.points=m;this.spatialReference=l;this.hasM=this.hasZ=void 0;c&&(this.hasZ=c);a&&(this.hasM=a)},y=function(m,l,c,a,b){this.xmin=m;this.ymin=l;this.xmax=c;this.ymax=a;this.spatialReference=b;this.mmax=this.mmin=this.zmax=this.zmin=void 0};q.jsonAdapter={convertToGEGeometry:function(m,
l){return null==l?null:m.convertJSONToGeometry(l)},exportPoint:function(m,l,c){c=new t(m.getPointX(l),m.getPointY(l),c);const a=m.hasZ(l),b=m.hasM(l);a&&(c.z=m.getPointZ(l));b&&(c.m=m.getPointM(l));return c},exportPolygon:function(m,l,c){return new E(m.exportPaths(l),c,m.hasZ(l),m.hasM(l))},exportPolyline:function(m,l,c){return new C(m.exportPaths(l),c,m.hasZ(l),m.hasM(l))},exportMultipoint:function(m,l,c){return new A(m.exportPoints(l),c,m.hasZ(l),m.hasM(l))},exportExtent:function(m,l,c){var a=m.hasZ(l);
const b=m.hasM(l);c=new y(m.getXMin(l),m.getYMin(l),m.getXMax(l),m.getYMax(l),c);a&&(a=m.getZExtent(l),c.zmin=a.vmin,c.zmax=a.vmax);b&&(m=m.getMExtent(l),c.mmin=m.vmin,c.mmax=m.vmax);return c}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(q,t,E,C,A,y){y=function(m){function l(){var a=
m.apply(this,arguments)||this;a._data=null;a._displayList=null;a._lastCommitTime=0;a._hasData=!1;a._invalidated=!1;a._wglBuffers=null;a._dirtyMap=new E;return a}t._inheritsLoose(l,m);var c=l.prototype;c.destroy=function(){m.prototype.destroy.call(this);this.clear()};c.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};c.getDisplayList=function(){return this._displayList};c.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var b=
a.addOrUpdate,d=a.remove;!this._data&&b&&b.tileDisplayData.displayObjects.length?(b.tileDisplayData.computeDisplayList(),this._dirtyMap=new E,this._dispRecStore=C.fromTileData(b,this._dirtyMap),this._data=b,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?b&&b.tileDisplayData.displayObjects.length||d.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};c.commit=function(a){if(!a.time||
a.time!==this._lastCommitTime)if(this._lastCommitTime=a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new A(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};c.clear=function(){this._dispRecStore=this._displayList=this._data=
null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};c._doPatchData=function(a){this._invalidated=!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=C.fromTileData(this._data,this._dirtyMap));this.requestRender()};c._patchData=function(a){let b=!0;var d=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],e=(a.remove||[]).slice();for(var p of d)null!=p.insertAfter&&e.push(p.id);let r;0<e.length&&
(r=new Set(e));for(var v of e)if(e=this._data.tileDisplayData.displayObjectRegistry.get(v)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var h of e.displayRecords)this._dispRecStore.delete(h);this._data.tileDisplayData.displayObjectRegistry.delete(v)}r&&r.size&&(this._data.tileDisplayData.displayObjects=this._data.tileDisplayData.displayObjects.filter(g=>!r.has(g.id)));for(const g of d){d=this._data.tileDisplayData.displayObjectRegistry.get(g.id);let f;if(d){v=d.displayRecords;
d.set(g);d.displayRecords=v;v=d.displayRecords.length;for(h=0;h<v;++h)if(e=d.displayRecords[h],p=g.displayRecords[h],h>=g.displayRecords.length||e.geometryType!==p.geometryType||e.symbolLevel!==p.symbolLevel||e.zOrder!==p.zOrder||e.materialKey!==p.materialKey)this._dispRecStore.delete(d.displayRecords[h]),h<g.displayRecords.length&&(d.displayRecords[h]=void 0);d.displayRecords.length=g.displayRecords.length}else if(d=g.copy(),d.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(g.id,
d),v=this._data.tileDisplayData.displayObjects,null!=d.insertAfter?(f={},0<=d.insertAfter?(h=this._data.tileDisplayData.displayObjectRegistry.get(d.insertAfter))?(p=v.indexOf(h)+1,p<v.length?v.splice(p,0,d):(v.push(d),p=v.length)):(v.push(d),p=v.length):(v.unshift(d),p=0)):(v.push(d),p=v.length),f)for(h=0<g.displayRecords.length?1:0,e=0,--p;0<=p&&e<h;--p)for(var w=v[p].displayRecords.length-1;0<=w&&e<h;--w){var u=v[p].displayRecords[w],k=this._data.tileDisplayData.displayList.getDPInfoType();f[k]||
(f[k]=u,++e)}v=g.displayRecords.length;for(h=0;h<v;++h){e=g.displayRecords[h];(p=d.displayRecords[h])?(p.meshData=e.meshData,p.materialKey=e.materialKey):(p=e.copy(),p.vertexFrom=void 0,p.indexFrom=void 0,d.displayRecords[h]=p);u=e.geometryType;w=this._data.tileDisplayData.displayList.getDPInfoType();k=a.addOrUpdate.tileBufferData.geometries[u];u=k.vertexBuffer;k=k.indexBuffer;let n=void 0;f&&(n=f[w]?this._data.tileDisplayData.displayList.splitAfter(f[w]):-1);b=this._dispRecStore.setMeshData(p,e,
u,k,n)&&b;f&&null!=p.indexFrom&&null!=p.indexFrom&&(f[w]=p)}}return b};t._createClass(l,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){return this._displayObjects??[]}}]);return l}(y.WGLTile);q.GraphicTile=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function q(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,
indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var t=q.prototype;t.hasDirty=function(){return this._dirties.some(E=>-1!==E.indexCount||E.allDirty)};t.markAllClean=function(){for(const E of this._dirties)E.indexFrom=-1,E.indexCount=-1,E.vertexFrom=
-1,E.vertexCount=-1,E.allDirty=!1};t.markAllDirty=function(){for(const E of this._dirties)E.allDirty=!0};t.forEach=function(E){for(let C=0;C<this._dirties.length;++C){const {indexCount:A,indexFrom:y,vertexCount:m,vertexFrom:l,allDirty:c}=this._dirties[C],a={};let b=void 0,d=!1;if(c||-1!==l&&0<m)a.geometry={count:m,from:l,allDirty:c},d=!0;if(c||-1!==y&&0<A)b={count:A,from:y,allDirty:c},d=!0;d&&E({indices:b,vertices:a},C)}};t.markDirtyIndices=function(E,C,A){E=this._dirties[E];if(!E.allDirty)if(-1!==
E.indexCount){const y=Math.min(E.indexFrom,C);C=Math.max(E.indexFrom+E.indexCount,C+A)-y;E.indexFrom=y;E.indexCount=C}else E.indexFrom=C,E.indexCount=A};t.markDirtyVertices=function(E,C,A,y){E=this._dirties[E];E.allDirty||(-1!==E.vertexCount?(C=Math.min(E.vertexFrom,A),A=Math.max(E.vertexFrom+E.vertexCount,A+y)-C,E.vertexFrom=C,E.vertexCount=A):(E.vertexFrom=A,E.vertexCount=y))};return q}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],
function(q,t,E){const C=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function A(m,l,c,a){this._strides=m;this._displayList=l;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(const b in m){this._freeListsAndStorage[b]={vtxFreeList:a?new t.FreeList(a):null,idxFreeList:a?new t.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const d in m[b])this._freeListsAndStorage[b].vertexBuffers[d]={data:a?E.allocateTypedArrayBuffer(a,m[b][d]):null,stride:m[b][d]}}}
A.fromTileData=function(m,l){var c=m.getStrides(),a={};for(var b=0;b<c.length;b++)a[C[b]]=c[b];c=[0,0,0,0,0];b=[0,0,0,0,0];var d=m.tileDisplayData.displayObjects;for(var e of d)for(var p of e.displayRecords)c[p.geometryType]=Math.max(c[p.geometryType],p.vertexFrom+p.vertexCount),b[p.geometryType]=Math.max(b[p.geometryType],p.indexFrom+p.indexCount);l=new A(a,m.tileDisplayData.displayList,l,null);for(a=0;a<m.tileBufferData.geometries.length;++a){e=c[a];d=b[a];var r=m.tileBufferData.geometries[a];p=
l._storageFor(C[a]);const v=m.tileBufferData.geometries[a].indexBuffer;p.indexBuffer=v;p.idxFreeList=new t.FreeList(v.length);p.idxFreeList.allocate(d);let h;for(const w in r.vertexBuffer)d=m.tileBufferData.geometries[a].vertexBuffer[w],p.vertexBuffers[w].data=d.data,p.vertexBuffers[w].stride=d.stride,r=E.strideToPackingFactor(d.stride),d=d.data.length*r/d.stride,h||(h=d);p.vtxFreeList=new t.FreeList(h);p.vtxFreeList.allocate(e)}return l};var y=A.prototype;y.delete=function(m){const l=C[m.geometryType];
this._freeVertices(l,m.vertexFrom,m.vertexCount);this._freeIndices(l,m.indexFrom,m.indexCount);this._displayList.removeFromList(m);m.vertexFrom=void 0;m.indexFrom=void 0};y.setMeshData=function(m,l,c,a,b){const d=C[m.geometryType];m.meshData=null;let e=void 0,p=void 0;void 0===m.vertexFrom?(p=l.vertexCount,e=this._allocateVertices(d,p)):l.vertexCount>m.vertexCount?(this._freeVertices(d,m.vertexFrom,m.vertexCount),p=l.vertexCount,e=this._allocateVertices(d,p)):l.vertexCount===m.vertexCount?(e=m.vertexFrom,
p=m.vertexCount):(this._freeVertices(d,m.vertexFrom+l.vertexCount,m.vertexCount-l.vertexCount),e=m.vertexFrom,p=l.vertexCount);let r=!0,v=void 0,h=void 0,w=void 0;void 0===m.indexFrom?(v=b,w=l.indexCount,h=this._allocateIndices(d,w)):l.indexCount>m.indexCount?(v=this._displayList.removeFromList(m),this._freeIndices(d,m.indexFrom,m.indexCount),w=l.indexCount,h=this._allocateIndices(d,w)):l.indexCount===m.indexCount?(r=!1,h=m.indexFrom,w=m.indexCount):(v=this._displayList.removeFromList(m),this._freeIndices(d,
m.indexFrom+l.indexCount,m.indexCount-l.indexCount),h=m.indexFrom,w=l.indexCount);if(-1!==e&&-1!==h){b=this._storageFor(d);E.copyMeshData(e,h,b.vertexBuffers,b.indexBuffer,l,c,a);m.vertexFrom=e;m.indexFrom=h;m.vertexCount=l.vertexCount;m.indexCount=l.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(m.geometryType,m.indexFrom,m.indexCount);for(const u in c)this._dirtyMap.markDirtyVertices(m.geometryType,u,m.vertexFrom,m.vertexCount)}r&&this._displayList.addToList(m,v);return!0}-1!==e&&
this._freeVertices(d,e,p);-1!==h&&this._freeIndices(d,h,w);m.setMeshDataFromBuffers(l,c,a);m.vertexFrom=void 0;m.vertexCount=0;m.indexFrom=void 0;m.indexCount=0;return!1};y.tryAddMeshData=function(m,l){const c=l.vertexBuffer;l=l.indexBuffer;var a=C[m.geometryType];const b=this._allocateVertices(a,m.vertexCount);if(-1===b)return this._freeVertices(a,b,m.vertexCount),!1;const d=this._allocateIndices(a,m.indexCount);if(-1===d)return this._freeVertices(a,b,m.vertexCount),this._freeIndices(a,d,m.indexCount),
!1;a=this._storageFor(a);E.copyMeshData(b,d,a.vertexBuffers,a.indexBuffer,m,c,l);m.vertexFrom=b;m.indexFrom=d;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(m.geometryType,m.indexFrom,m.indexCount);for(const e in c)this._dirtyMap.markDirtyVertices(m.geometryType,e,b,m.vertexCount)}this._displayList.addToList(m);return!0};y._allocateVertices=function(m,l){m=this._storageFor(m);l=m.vtxFreeList.allocate(l);return-1===l||.5<m.vtxFreeList.fragmentation?-1:l};y._freeVertices=function(m,l,c){this._storageFor(m).vtxFreeList.free(l,
c)};y._freeIndices=function(m,l,c){this._storageFor(m).idxFreeList.free(l,c)};y._allocateIndices=function(m,l){m=this._storageFor(m);l=m.idxFreeList.allocate(l);return-1===l||.5<m.idxFreeList.fragmentation?-1:l};y._storageFor=function(m){return this._freeListsAndStorage[m]};y._stridesFor=function(m,l){return this._strides[m][l]};return A}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(q,t){let E=function(){function A(m){this._largestRange=
null;this._parent=m;this._updateLargestRange()}var y=A.prototype;y.rangeCreated=function(m){if(!this._largestRange||m.count>this._largestRange.count)this._largestRange=m};y.rangeResized=function(m,l){if(m===this._largestRange)m.count<l&&this._updateLargestRange();else if(!this._largestRange||m.count>this._largestRange.count)this._largestRange=m};y.findBestRange=function(m){let l=this._parent._freeHead,c=null;for(;null!==l;)l.count>=m&&(!c||l.count-m<c.count-m)&&(c=l),l=l.next;return c};y.findAdjacentRanges=
function(m,l){let c=!0,a=!1,b=null,d=this._parent._freeHead;for(;c&&!a;){const e=null!==d?d.from:this._parent._size;m>=(null!==b?b.from+b.count:0)&&m+l<=e?(c=!1,a=!0):null!==d?(b=d,d=d.next):c=!1}return[b,d]};y._updateLargestRange=function(){let m=null,l=this._parent._freeHead;for(;null!==l;){if(!m||l.count>m.count)m=l;l=l.next}this._largestRange=m};t._createClass(A,[{key:"largestRange",get:function(){return this._largestRange}}]);return A}(),C=function(){function A(m,l){this._allocated=0;this._size=
m;this._freeHead=0<m?{from:0,count:m,prev:null,next:null}:null;this._bookKeeper=l||new E(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var y=A.prototype;y.allocate=function(m){const l=this._bookKeeper.findBestRange(m);if(null===l)return-1;const c=l.from,a=l.count;l.from+=m;l.count-=m;this._bookKeeper.rangeResized(l,c,a);this._allocated+=m;0===l.count&&(m=null!==l.prev?this._freeHead:l.next,A._removeRange(l),this._freeHead=m);return c};y.free=function(m,l){const [c,a]=this._bookKeeper.findAdjacentRanges(m,
l);m={from:m,count:l,prev:c,next:a};null!==c&&(c.next=m);null!==a&&(a.prev=m);this._bookKeeper.rangeCreated(m);this._allocated-=l;if(null!==a&&m.from+m.count===a.from){l=m.from;var b=m.count;A._fuse(m,a);A._removeRange(a);this._bookKeeper.rangeResized(m,l,b);this._bookKeeper.rangeResized(a,void 0,0)}null!==c&&c.from+c.count===m.from&&(l=c.from,b=c.count,A._fuse(c,m),A._removeRange(m),this._bookKeeper.rangeResized(c,l,b),this._bookKeeper.rangeResized(m,void 0,0));this._freeHead=null!==m.prev?this._freeHead:
m};A._removeRange=function(m){null!==m.prev?null!==m.next?(m.prev.next=m.next,m.next.prev=m.prev):m.prev.next=null:null!==m.next&&(m.next.prev=null)};A._fuse=function(m,l){m.count+=l.count;m.next=l.next;l.from+=l.count;l.count=0;null!==l.next&&(l.next.prev=m)};t._createClass(A,[{key:"fragmentation",get:function(){const m=this._size-this._allocated;return 0===m?0:1-this._bookKeeper.largestRange.count/m}}]);return A}();q.FreeList=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(q,t,E,C){return function(){function A(m){this.geometryMap=q.createGeometryData(()=>({indexBuffer:t.BufferObject.createIndex(m,E.Usage.STATIC_DRAW),vao:null}),(l,c)=>({vertexBuffer:t.BufferObject.createVertex(m,q.C_VBO_INFO[c])}))}var y=A.prototype;y.dispose=function(){for(let m=0;5>m;m++){const l=this.geometryMap[m];if(l){l.data.vao&&
l.data.vao.dispose(!1);l.data.indexBuffer&&l.data.indexBuffer.dispose();for(const c in l.buffers)l.buffers[c]&&l.buffers[c].data.vertexBuffer.dispose()}}};y.get=function(m){const l=this.geometryMap[m];return{getVAO(c,a,b){if(!l.data.vao){const d={};for(const e in l.buffers)d[e]=l.buffers[e].data.vertexBuffer;l.data.vao=new C.VertexArrayObject(c,b,a,d,l.data.indexBuffer)}return l.data.vao}}};y.has=function(m){return null!=this.geometryMap[m]};y.upload=function(m,l){l.forEach((c,a)=>{this._upload(c,
a,m)})};y._upload=function(m,l,c){m.indices&&(m.indices.allDirty?this._uploadIndices(c,l):null!=m.indices.from&&null!=m.indices.count&&this._uploadIndices(c,l,m.indices.from,m.indices.count));if(m.vertices){m=m.vertices;for(const a in m){const b=m[a];b.allDirty?this._uploadVertices(c,l,a):null!=b.from&&null!=b.count&&this._uploadVertices(c,l,a,b.from,b.count)}}};y._uploadVertices=function(m,l,c,a,b){const d=this.geometryMap[l];if(d&&(m=m.geometries[l].vertexBuffer[c])){var {data:e,stride:p}=m;d.buffers[c]&&
0<e.length&&(m=p/e.BYTES_PER_ELEMENT,null!=a&&null!=b?d.buffers[c].data.vertexBuffer.setSubData(e,a*m,a*m,(a+b)*m):d.buffers[c].data.vertexBuffer.setData(e))}};y._uploadIndices=function(m,l,c,a){const b=this.geometryMap[l];b&&(m=m.geometries[l].indexBuffer,b.data.indexBuffer&&0<m.length&&(null!=c&&null!=a?b.data.indexBuffer.setSubData(m,c,c,c+a):b.data.indexBuffer.setData(m)))};return A}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./definitions ./TiledDisplayObject".split(" "),
function(q,t,E,C,A,y,m,l){let c=function(){function a(){}var b=a.prototype;b.acquire=function(d){return{refCount:1,version:-1,labelMat2d:y.create(),tileMat3:y.create(),dvs:y.create()}};b.release=function(d){};return a}();l=function(a){function b(e,p,r,v){return a.call(this,e,p,r,v,m.TILE_SIZE,m.TILE_SIZE)||this}t._inheritsLoose(b,a);var d=b.prototype;d.destroy=function(){a.prototype.destroy.call(this);this._transforms&&b.TransformCache.release(this.key.hash)};d.setTransform=function(e){var p=this.resolution/
e.resolution,r=this.transforms.tileMat3;const [v,h]=e.toScreenNoRotation([0,0],[this.x,this.y]);var w=this.width/this.rangeX*p;p*=this.height/this.rangeY;A.set(r,w,0,0,0,p,0,v,h,1);A.multiply(this.transforms.dvs,e.displayViewMat3,r);r=this.transforms.labelMat2d;const u=window.devicePixelRatio;w=E.set(C.create(),w*u,0,0,p*u,v*u,h*u);E.multiply(r,e.viewMat2d,w)};d._createTransforms=function(){return b.TransformCache.acquire(this.key.hash)};return b}(l.TiledDisplayObject);l.TransformCache=new c;q.WGLTile=
l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(q,t,E,C,A){C=function(y){function m(c,a,b,d,e,p,r=e,v=p){var h=y.call(this)||this;h.triangleCountReportedInDebug=0;h.triangleCount=0;h.texture=null;h.key=new A(c);h.resolution=a;h.x=b;h.y=d;h.width=e;h.height=
p;h.rangeX=r;h.rangeY=v;return h}t._inheritsLoose(m,y);var l=m.prototype;l.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};l.setTransform=function(c){const a=this.resolution/(c.resolution*c.pixelRatio),b=this.transforms.tileMat3,[d,e]=c.toScreenNoRotation([0,0],[this.x,this.y]);E.set(b,this.width/this.rangeX*a,0,0,0,this.height/this.rangeY*a,0,d,e,1);E.multiply(this.transforms.dvs,c.displayViewMat3,b)};return m}(C.DisplayObject);q.TiledDisplayObject=C;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./enums ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,d){const e=new C,p=new C;C=function(){function r(){this.tileBufferData=this.tileDisplayData=null}var v=r.prototype;v.reshuffle=
function(){e.reset();const h=[[],[],[],[],[]];var w=this.tileDisplayData.displayObjects;for(var u of w)for(var k of u.displayRecords)h[k.geometryType].push(k);for(var g of h)for(var f of g)f&&e.needMore(f.geometryType,f.meshData?f.meshData.vertexCount:f.vertexCount,f.meshData?f.meshData.indexData.length:f.indexCount);w=h.length;u=new A;for(k=0;k<w;++k){u.geometries[k].indexBuffer=new Uint32Array(Math.round(1.5*e.indicesFor(k)));g=[];for(var n in this.tileBufferData.geometries[k].vertexBuffer)g.push(this.tileBufferData.geometries[k].vertexBuffer[n].stride);
g=r._computeVertexAlignment(g);f=Math.round(1.5*e.verticesFor(k));g=r._align(f,g);for(var z in this.tileBufferData.geometries[k].vertexBuffer)f=this.tileBufferData.geometries[k].vertexBuffer[z].stride,u.geometries[k].vertexBuffer[z]={stride:f,data:m.allocateTypedArrayBuffer(g,f)}}p.reset();this.tileDisplayData.displayList.clear();for(n=0;n<w;++n){z=h[n];for(const x of z){if(x.meshData)x.writeMeshDataToBuffers(p.verticesFor(n),u.geometries[n].vertexBuffer,p.indicesFor(n),u.geometries[n].indexBuffer),
x.meshData=null;else{z=this.tileBufferData.geometries[n].vertexBuffer;k=this.tileBufferData.geometries[n].indexBuffer;g=u.geometries[n].vertexBuffer;f=u.geometries[n].indexBuffer;const B=p.verticesFor(n),D=p.indicesFor(n);m.copyMeshData(B,D,g,f,x,z,k);x.vertexFrom=B;x.indexFrom=D}p.needMore(n,x.vertexCount,x.indexCount)}}for(const x of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(x.displayRecords);this.tileBufferData=u};v.getStrides=function(){const h=[];for(let w=
0;w<this.tileBufferData.geometries.length;++w){const u=this.tileBufferData.geometries[w];h[w]={};for(const k in u.vertexBuffer)h[w][k]=u.vertexBuffer[k].stride}return h};v.clone=function(){const h=new r;h.tileBufferData=this.tileBufferData.clone();h.tileDisplayData=this.tileDisplayData.clone();return h};v._guessSize=function(){const {displayObjects:h}=this.tileDisplayData,w=Math.min(h.length,4);let u=0;for(let k=0;k<w;k++)u=Math.max(u,h[k].displayRecords.length);return 2*(12*h.length+h.length*u*40)};
v.serialize=function(){const h=this.tileBufferData.serialize(),w=this.tileBufferData.getBuffers(),u=this.tileDisplayData.serialize(new d(Int32Array,this._guessSize())).buffer();w.push(u);return{result:{displayData:u,bufferData:h},transferList:w}};r.fromVertexData=function(h,w){const u={},k=new Map;for(const g of w)k.set(g.id,g);m.forEachGeometryType(g=>{const f=h.data[g];if(t.isSome(f)){const z=c.DisplayRecordReader.from(f.records).getCursor();for(;z.next();){var n=z.id;const x=z.materialKey,B=z.indexFrom,
D=z.indexCount,F=z.vertexFrom,G=z.vertexCount,H=k.get(n);n=new l(n,g,x);n.indexFrom=B;n.indexCount=D;n.vertexFrom=F;n.vertexCount=G;H.displayRecords.push(n)}u[g]=a.VertexBuffers.fromVertexData(f,g)}else u[g]=(new b.VertexVectors(g,0,E.WGLSymbologyType.DEFAULT)).intoBuffers()});return r.fromMeshData({displayObjects:w,vertexBuffersMap:u})};r.fromMeshData=function(h){const w=new r,u=new y,k=new A;u.displayObjects=h.displayObjects;for(const g in h.vertexBuffersMap){const f=h.vertexBuffersMap[g];k.geometries[g].indexBuffer=
f.indexBuffer;k.geometries[g].vertexBuffer=f.namedBuffers}w.tileDisplayData=u;w.tileBufferData=k;return w};r.bind=function(h,w){const u=new r;u.tileDisplayData=h;u.tileBufferData=w;return u};r.create=function(h,w){const u=new r;u.tileDisplayData=new y;u.tileDisplayData.displayObjects=h;const k=[0,0,0,0,0],g=[0,0,0,0,0],f=[[],[],[],[],[]];for(var n of h)for(var z of n.displayRecords)f[z.geometryType].push(z),k[z.geometryType]+=z.meshData.vertexCount,g[z.geometryType]+=z.meshData.indexData.length;h=
new A;w=[w.fill||{},w.line||{},w.icon||{},w.text||{},w.label||{}];for(n=0;5>n;n++){z=new Uint32Array(g[n]);var x=w[n],B=k[n];const D={};for(const F in x){const G={data:m.allocateTypedArrayBuffer(B,x[F]),stride:x[F]};D[F]=G}x=D;l.writeAllMeshDataToBuffers(f[n],x,z);h.geometries[n]={indexBuffer:z,vertexBuffer:x}}u.tileBufferData=h;return u};r._align=function(h,w){const u=h%w;return 0===u?h:h+(w-u)};r._computeVertexAlignment=function(h){let w=!1,u=!1;for(const k of h)2===k%4?w=!0:0!==k%4&&(u=!0);return u?
4:w?2:1};return r}();q.TileData=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(){this._byGeometryType=null}var E=t.prototype;E.reset=function(){this._byGeometryType=null};E.verticesFor=function(C){return this._byGeometryType?this._byGeometryType[C].vertices:0};E.indicesFor=function(C){return this._byGeometryType?
this._byGeometryType[C].indices:0};E.needMore=function(C,A,y){if(A||y)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),C=this._byGeometryType[C],C.vertices+=A,C.indices+=y};q._createClass(t,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return t}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(q){return function(){function t(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var E=t.prototype;E.clone=function(){const C=new t;for(let A=0;A<this.geometries.length;A++){const y=this.geometries[A],m=C.geometries[A];m.indexBuffer=y.indexBuffer.slice();m.vertexBuffer={};for(const l in y.vertexBuffer){const {data:c,stride:a}=y.vertexBuffer[l];m.vertexBuffer[l]={data:c.slice(),stride:a}}}return C};
t.deserialize=function(C){const A=new t;for(let y=0;5>y;++y){A.geometries[y].indexBuffer=new Uint32Array(C.geometries[y].indexBuffer);A.geometries[y].vertexBuffer={};for(const m in C.geometries[y].vertexBuffer)A.geometries[y].vertexBuffer[m]={data:q.allocateTypedArrayBufferwithData(C.geometries[y].vertexBuffer[m].data,C.geometries[y].vertexBuffer[m].stride),stride:C.geometries[y].vertexBuffer[m].stride}}return A};E.serialize=function(){const C={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let A=0;5>A;++A)for(const y in this.geometries[A].vertexBuffer)C.geometries[A].vertexBuffer[y]={data:this.geometries[A].vertexBuffer[y].data.buffer,stride:this.geometries[A].vertexBuffer[y].stride};return C};
E.getBuffers=function(){const C=[];for(let A=0;5>A;++A){C.push(this.geometries[A].indexBuffer.buffer);for(const y in this.geometries[A].vertexBuffer)C.push(this.geometries[A].vertexBuffer[y].data.buffer)}return C};return t}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(q,t,E,C){return function(){function A(){}var y=A.prototype;y.computeDisplayList=
function(){this._displayList=new t;for(const m of this.displayObjects)for(const l of m.displayRecords)this._displayList.addToList(l)};y.clone=function(){const m=new A;this.displayObjects&&(m.displayObjects=this.displayObjects.map(l=>l.clone()));return m};y.serialize=function(m){C.serializeList(m,this.displayObjects);return m};y._deserializeObjects=function(m){var l=m.readInt32();l=Array(l);const c=new Map;for(let a=0;a<l.length;++a){const b=E.deserialize(m);l[a]=b;c.set(b.id,b)}this.displayObjects=
l;this._displayList=null;this._displayObjectRegistry=c};A.deserialize=function(m){const l=new A;l._deserializeObjects(m);return l};q._createClass(A,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const m of this.displayObjects)this._displayObjectRegistry.set(m.id,m)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return A}()})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./materialKey/MaterialKey"],function(q,t){function E(c,a,b,...d){a<c.length?c.splice(a,b,...d):c.push(...d)}let C=function(){function c(){this.symbolLevels=[]}var a=c.prototype;a.replay=function(b,d,e){for(const v of this.symbolLevels)for(const h of v.zLevels){var p=h.geometryDPInfo.unified;if(p)for(const w of p){const {geometryType:u,materialKey:k,indexFrom:g,indexCount:f}=w;p=t.MaterialKeyBase.load(k).symbologyType;p=b.painter.getBrush(u,p);var r=d.getGeometry(u);r={geometryType:u,materialKey:k,
indexFrom:g,indexCount:f,target:r};p.prepareState(b);p.drawGeometry(b,d,r,e)}}};a.clear=function(){this.symbolLevels.length=0};a.addToList=function(b,d){if(Array.isArray(b))for(const e of b)this._addToList(e,d);else this._addToList(b,d)};a.removeFromList=function(b){Array.isArray(b)||(b=[b]);let d=null;for(const e of b)d=this._removeFromList(e);return d};a.clone=function(){const b=new c;for(const d of this.symbolLevels)b.symbolLevels.push(d.clone());return b};a.splitAfter=function(b){const d=this._getDisplayList(b.symbolLevel,
b.zOrder),e=d.length,p=b.indexFrom+b.indexCount;for(let r=0;r<e;++r){const v=d[r];if(v.geometryType===b.geometryType&&p>v.indexFrom&&p<=v.indexFrom+v.indexCount)return p<v.indexFrom+v.indexCount&&(b=new A,b.geometryType=v.geometryType,b.materialKey=v.materialKey,b.indexFrom=p,b.indexCount=v.indexFrom+v.indexCount-p,d.splice(r+1,0,b),v.indexCount=p-v.indexFrom),r}};a._addToList=function(b,d){const e=this._getDisplayList(b.symbolLevel,b.zOrder);d=null!=d?d:e.length-1;var p=0<=d&&d<e.length?e[d]:null;
null!==p&&p.materialKey===b.materialKey&&p.indexFrom+p.indexCount===b.indexFrom&&p.geometryType===b.geometryType?p.indexCount+=b.indexCount:(p=new A,p.indexFrom=b.indexFrom,p.indexCount=b.indexCount,p.materialKey=b.materialKey,p.geometryType=b.geometryType,E(e,d+1,0,p))};a._removeFromList=function(b){const d=this._getDisplayList(b.symbolLevel,b.zOrder);var e=d.length;let p=void 0;for(var r=0;r<e;++r){var v=d[r];if(b.indexFrom+b.indexCount>v.indexFrom&&b.indexFrom<v.indexFrom+v.indexCount&&v.geometryType===
b.geometryType){p=r;break}}if(void 0!==p){e=d[p];if(b.indexFrom===e.indexFrom)return e.indexCount-=b.indexCount,e.indexFrom+=b.indexCount,0===e.indexCount&&E(d,p,1),p-1;if(b.indexFrom+b.indexCount===e.indexFrom+e.indexCount)return e.indexCount-=b.indexCount,0===e.indexCount?(E(d,p,1),p-1):p;r=e.indexFrom;v=b.indexFrom-e.indexFrom;const h=b.indexCount;b=e.indexFrom+e.indexCount-(b.indexFrom+b.indexCount);e.indexCount=v;const w=new A;w.geometryType=e.geometryType;w.materialKey=e.materialKey;w.indexFrom=
r+v+h;w.indexCount=b;E(d,p+1,0,w);return p}return null};a._getDisplayList=function(b,d){let e;var p=this.symbolLevels.length;for(let v=0;v<p;v++)if(this.symbolLevels[v].symbolLevel===b){e=this.symbolLevels[v];break}e||(e=new l,e.symbolLevel=b,this.symbolLevels.push(e));let r;b=e.zLevels.length;for(p=0;p<b;p++)if(e.zLevels[p].zLevel===d){r=e.zLevels[p];break}r||(r=new m,r.geometryDPInfo=new y,r.zLevel=d,e.zLevels.push(r));r.geometryDPInfo.unified||(r.geometryDPInfo.unified=[]);return r.geometryDPInfo.unified};
a.getDPInfoType=function(){return"unified"};q._createClass(c,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return c}(),A=function(){function c(){this.materialKey=null;this.indexCount=this.indexFrom=0}c.prototype.clone=function(){const a=new c;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return c}(),y=function(){function c(){this.unified=this.label=this.text=this.marker=this.line=
this.fill=null}c.prototype.clone=function(){const a=new c;a.fill=this.fill&&this.fill.map(b=>b.clone());a.line=this.line&&this.line.map(b=>b.clone());a.marker=this.marker&&this.marker.map(b=>b.clone());a.text=this.text&&this.text.map(b=>b.clone());a.label=this.label&&this.label.map(b=>b.clone());a.unified=this.unified&&this.unified.map(b=>b.clone());return a};return c}(),m=function(){function c(){this.geometryDPInfo=new y}c.prototype.clone=function(){const a=new c;a.zLevel=this.zLevel;a.geometryDPInfo=
this.geometryDPInfo.clone();return a};return c}(),l=function(){function c(){this.zLevels=[]}c.prototype.clone=function(){const a=new c;a.symbolLevel=this.symbolLevel;for(const b of this.zLevels)a.zLevels.push(b.clone());return a};return c}();return C})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(q,t){return function(){function E(A){this.insertAfter=null;this.id=A;this.displayRecords=[]}var C=E.prototype;C.copy=function(){const A=
new E(this.id);A.set(this);return A};C.clone=function(){const A=new E(this.id);A.displayRecords=this.displayRecords.map(y=>y.clone());A.insertAfter=this.insertAfter;return A};C.set=function(A){this.id=A.id;this.displayRecords=A.displayRecords;this.insertAfter=A.insertAfter};C.serialize=function(A){A.push(this.id);t.serializeList(A,this.displayRecords);return A};E.deserialize=function(A){const y=A.readInt32(),m=new E(y);m.displayRecords=t.deserializeList(A,q,{id:y});return m};return E}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(q,t,E){return function(){function C(y,m,l,c=0,a=0){this.id=y;this.geometryType=m;this.materialKey=l;this.minZoom=c;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var A=C.prototype;A.clone=function(){return this.copy()};A.copy=function(){const y=new C(this.id,this.geometryType,this.materialKey);y.vertexFrom=this.vertexFrom;y.vertexCount=this.vertexCount;y.indexFrom=this.indexFrom;y.indexCount=
this.indexCount;y.zOrder=this.zOrder;y.symbolLevel=this.symbolLevel;y.meshData=this.meshData;y.minZoom=this.minZoom;y.maxZoom=this.maxZoom;return y};A.setMeshDataFromBuffers=function(y,m,l){const c=new t;for(const a in m){const b=m[a].stride,d=m[a].data,e=[],p=E.strideToPackingFactor(b);for(let r=0;r<b*y.vertexCount/p;++r)e[r]=d[r+b*y.vertexFrom/p];c.vertexData.set(a,e)}c.indexData.length=0;for(m=0;m<y.indexCount;++m)c.indexData[m]=l[m+y.indexFrom]-y.vertexFrom;c.vertexCount=y.vertexCount;this.meshData=
c};A.readMeshDataFromBuffers=function(y,m){this.meshData?this.meshData.clear():this.meshData=new t;for(const l in y){const c=y[l].stride,a=y[l].data,b=[],d=E.strideToPackingFactor(c);for(let e=0;e<c*this.vertexCount/d;++e)b[e]=a[e+c*this.vertexFrom/d];this.meshData.vertexData.set(l,b)}this.meshData.indexData.length=0;for(y=0;y<this.indexCount;++y)this.meshData.indexData[y]=m[y+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};A.writeMeshDataToBuffers=function(y,m,l,c){for(const a in m){const b=
m[a].stride,d=this.meshData.vertexData.get(a),e=m[a].data,p=E.strideToPackingFactor(b);for(let r=0;r<b*this.meshData.vertexCount/p;++r)e[r+b*y/p]=d[r]}for(m=0;m<this.meshData.indexData.length;++m)c[m+l]=this.meshData.indexData[m]+y;this.vertexFrom=y;this.vertexCount=this.meshData.vertexCount;this.indexFrom=l;this.indexCount=this.meshData.indexData.length};C.writeAllMeshDataToBuffers=function(y,m,l){let c=0,a=0;for(const b of y)b.writeMeshDataToBuffers(c,m,a,l),c+=b.vertexCount,a+=b.indexCount};A._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};A.serialize=function(y){y.push(this.geometryType);y.push(this.materialKey);y.push(this.vertexFrom);y.push(this.vertexCount);y.push(this.indexFrom);y.push(this.indexCount);y.push(this.minZoom);y.push(this.maxZoom);return y};C.deserialize=function(y,m){const l=y.readInt32(),c=y.readInt32();m=new C(m.id,l,c);m.vertexFrom=y.readInt32();m.vertexCount=y.readInt32();m.indexFrom=y.readInt32();m.indexCount=y.readInt32();
m.minZoom=y.readInt32();m.maxZoom=y.readInt32();return m};q._createClass(C,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return C}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function q(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var t=q.prototype;t.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};t.update=function(E,C,A){for(const y in E)this.vertexData.set(y,
E[y]);for(const y in this.vertexData)null===E[y]&&this.vertexData.delete(y);this.vertexCount=C;this.indexData=A};return q}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(q){q.deserializeList=function(t,E,C){var A=t.readInt32();A=Array(A);for(let y=0;y<A.length;y++)A[y]=E.deserialize(t,C);return A};q.serializeList=function(t,E){if(null===E)t.push(0);else{t.push(E.length);for(const C of E)C.serialize(t);return t}};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(q,t,E,C){let A=function(){function m(c){this._cursor=this._head=c}m.from=function(c,a=0,b=c.byteLength/y.BYTES_PER_RECORD-a){c=new y(new Int32Array(c,a*y.BYTES_PER_RECORD,b*y.ELEMENTS_PER_RECORD));return new m(c)};var l=m.prototype;l.size=function(){let c=this._cursor,
a=0;for(;c;)a+=c.size(),c=c._link;return a};l.seekIndex=function(c){for(this._cursor=this._head;this._cursor;){const a=this._cursor.size();if(c<a)return this._cursor._index=c,!0;c-=a;this._cursor=this._cursor._link}return!1};l.forEach=function(c){const a=this.getCursor();for(;a.next();)c(a)};l.link=function(c){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=c._head;a._link._indexStart=a._indexStart+a.size()}else this._head=c._head};l.getCursor=function(){return this.copy()};l.lookup=
function(c){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(c);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};l.copy=function(){const c=new m(this._head?.copy());if(!c._head)return c;let a=c._head,b=c._head._link;for(;b;)a._link=b.copy(),a=b,b=a._link;return c};l.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};l.peekId=function(){return this._cursor.peekId()??
this._cursor._link.peekId()};l.delete=function(c){let a=this._head,b=null;for(;a;){if(a.delete(c))return a.isEmpty()&&(E.isSome(b)&&(b._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;b=a;a=a._link}return!1};t._createClass(m,[{key:"id",get:function(){return this._cursor.id},set:function(c){this._cursor.id=c}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(c){this._cursor.materialKey=c}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},
{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(c){this._cursor.indexFrom=c}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(c){this._cursor.indexCount=c}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(c){this._cursor.vertexFrom=c}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(c){this._cursor.vertexCount=c}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(c){this._cursor.sortKey=
c}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return m}();A.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;A.BYTES_PER_RECORD=A.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let y=function(){function m(c){this._link=null;this._index=-1;this._indexStart=0;this._packedRecordsF32=null;this._deletedCount=0;this._offsets={instance:null};this._packedRecords=c}m.from=function(c,a=0,b=c.byteLength/this.BYTES_PER_RECORD-a){return new m(new Int32Array(c,a*
this.BYTES_PER_RECORD,b*this.ELEMENTS_PER_RECORD))};var l=m.prototype;l.delete=function(c){const a=this._index,b=this.lookup(c);if(b)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===c;)this.id=2147483647,++this._deletedCount;this._index=a;return b};l.isEmpty=function(){return this._deletedCount===this.size()};l.link=function(c){this._link?this._link.link(c):this._link=c};l.lookup=function(c){if(E.isNone(this._offsets.instance)){this._offsets.instance=new Map;var a=this.copy();a._index=
-1;let b=0;for(;a.next();)a.id!==b&&(this._offsets.instance.set(a.id,a._index),b=a.id)}if(!this._offsets.instance.has(c))return!1;a=this._index;this._index=this._offsets.instance.get(c);return 2147483647===this.id?(this._index=a,!1):!0};l.size=function(){return this._packedRecords.length/m.ELEMENTS_PER_RECORD};l.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};l.peekId=function(){const c=(this._index+1)*m.ELEMENTS_PER_RECORD;return c>=this._packedRecords.length?
0:this._packedRecords[c]};l.getCursor=function(){return this.copy()};l.copy=function(){const c=new m(this._packedRecords);c._indexStart=this._indexStart;c._link=this._link;c._index=this._index;c._offsets=this._offsets;c._deletedCount=this._deletedCount;return c};t._createClass(m,[{key:"id",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD]},set:function(c){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD]=c}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
m.ELEMENTS_PER_RECORD+1]},set:function(c){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+1]=c}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+3]},set:function(c){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+3]=c}},{key:"indexCount",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+4]},set:function(c){this._packedRecords[this._index*
m.ELEMENTS_PER_RECORD+4]=c}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+5]},set:function(c){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+5]=c}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+6]},set:function(c){this._packedRecords[this._index*m.ELEMENTS_PER_RECORD+6]=c}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*m.ELEMENTS_PER_RECORD+7]},set:function(c){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*m.ELEMENTS_PER_RECORD+7]=c}},{key:"index",get:function(){return this._index}}]);return m}();y.ELEMENTS_PER_RECORD=C.DISPLAY_RECORD_INT_PER_ELEMENT;y.BYTES_PER_RECORD=y.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;q.DisplayRecordReader=A;Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(q,t){let E=function(){function A(y,m){this.data=y;this.stride=m}A.decode=function(y){const m=t.allocateTypedArrayBufferwithData(y.data,y.stride);return new A(m,y.stride)};A.fromVertexVector=function(y){const m=t.allocateTypedArrayBufferwithData(y.data.buffer(),y.stride);return new A(m,y.stride)};return A}(),C=function(){function A(y,m,l){this.geometryType=y;this.indexBuffer=
new Uint32Array(m);this.namedBuffers=l}A.decode=function(y){const m=y.geometryType,l=y.indexBuffer,c={};for(const a in y.namedBuffers)c[a]=E.decode(y.namedBuffers[a]);return new A(m,l,c)};A.fromVertexData=function(y,m){const l=y.indices,c=t.allocateTypedArrayBufferwithData(y.vertices,y.stride);y={geometry:new E(c,y.stride)};return new A(m,l,y)};A.fromVertexVectors=function(y){const m=y.geometryType,l=y.indexVector.buffer(),c={};for(const a in y.namedVectors)c[a]=E.fromVertexVector(y.namedVectors[a]);
return new A(m,l,c)};return A}();q.VertexBuffers=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(q,t,E,C,A){let y=function(){function l(c,a){this.data=c;this.stride=a}l.prototype.transfer=function(c,a){const b=this.data.buffer();c.vertexCount=this.vertexCount;c.data=b;c.stride=
this.stride;a.push(b)};t._createClass(l,[{key:"vertexCount",get:function(){const c=this.data.length/(this.stride/4);c!==(c|0)&&console.debug("Corrupted stride");return c}}]);return l}(),m=function(){function l(a,b,d){this.geometryType=a;this.indexVector=new A(Uint32Array,6*b);this.namedVectors={};a=E.getStrides(a,d);for(const e in a){d=a[e];let p;switch(d%4){case 0:case 2:p=new A(Uint32Array,d*b);break;case 1:case 3:p=new A(Uint8Array,d*b)}this.namedVectors[e]=new y(p,d)}}var c=l.prototype;c.get=
function(a){return this.namedVectors[a].data};c.getVector=function(a){return this.namedVectors[a]};c.transfer=function(a,b){const d=this.indexVector.buffer(),e={};b.push(d);for(const p in this.namedVectors){const r=this.namedVectors[p];e[p]={};r.transfer(e[p],b)}a.geometryType=this.geometryType;a.indexBuffer=d;a.namedBuffers=e;this.destroy()};c.intoBuffers=function(){const a=C.VertexBuffers.fromVertexVectors(this);this.destroy();return a};c.destroy=function(){this.namedVectors=this.indexVector=null};
return l}();q.VertexVector=y;q.VertexVectors=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function t(C,A){this._pos=0;A=A?this._roundToNearest(A,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(A);this._buffer=new C(this._array);this._ctor=C;this._i16View=new Int16Array(this._array)}var E=t.prototype;E._roundToNearest=
function(C,A){C=Math.round(C);return C+(A-C%A)};E._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.25*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const A=new this._ctor(C);A.set(this._buffer,0);this._array=C;this._buffer=A;this._i16View=new Int16Array(this._array)}};E.ensureSize=function(C){this._ensureSize(C)};E.writeF32=function(C){this._ensureSize(1);const A=this._pos;(new Float32Array(this._array,
4*this._pos,1))[0]=C;this._pos++;return A};E.push=function(C){this._ensureSize(1);const A=this._pos;this._buffer[this._pos++]=C;return A};E.writeFixed=function(C){this._buffer[this._pos++]=C};E.setValue=function(C,A){this._buffer[C]=A};E.i1616Add=function(C,A,y){this._i16View[2*C]+=A;this._i16View[2*C+1]+=y};E.getValue=function(C){return this._buffer[C]};E.incr=function(C){if(this._buffer.length<C)throw Error("Increment index overflows the target buffer");this._buffer[C]++};E.decr=function(C){this._buffer[C]--};
E.writeRegion=function(C){this._ensureSize(C.length);const A=this._pos;this._buffer.set(C,this._pos);this._pos+=C.length;return A};E.writeManyFrom=function(C,A,y){for(this._ensureSize(y-A);A!==y;A++)this.writeFixed(C._buffer[A])};E.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};E.toArray=function(){const C=this._array,A=[];for(let y=0;y<C.byteLength/4;y++)A.push(C[y]);return A};E.seek=function(C){this._pos=C};E.destroy=function(){this._buffer=this._array=null};
q._createClass(t,[{key:"length",get:function(){return this._pos}}]);return t}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,d,e){function p(v){switch(v){case 1:case 8:case 32:return-1;
case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function r(v){switch(v){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}E=function(){function v(w,u,k,g,f,n=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=
u;this.tileKey=w;this._hasAggregate=g;this._pixelBufferEnabled=f;this._version=n;this._symbologyType=k}var h=v.prototype;h.serialize=function(w){const u=[];u.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((k,g)=>{var f=1<<g;g=p(f);f=r(f);g=e.getPow2NeighborKey(new A(this.tileKey),g,f,w);g=this._serializeTileVertexData(this.tileKey,g.id,k.vertexData);g.message.bufferIds=k.displayIds;u.push(g)});return u};h._serializeTileVertexData=function(w,
u,k){const g=[];k={[a.WGLGeometryType.MARKER]:k.get(a.WGLGeometryType.MARKER)?.serialize(g),[a.WGLGeometryType.FILL]:k.get(a.WGLGeometryType.FILL)?.serialize(g),[a.WGLGeometryType.LINE]:k.get(a.WGLGeometryType.LINE)?.serialize(g),[a.WGLGeometryType.TEXT]:k.get(a.WGLGeometryType.TEXT)?.serialize(g),[a.WGLGeometryType.LABEL]:k.get(a.WGLGeometryType.LABEL)?.serialize(g)};return{message:{tileKeyOrigin:w,tileKey:u,data:k,version:this._version},transferList:g}};h.featureStart=function(w,u){this._current.insertAfter=
w;this._current.sortKey=u};h.featureEnd=function(){};h.recordStart=function(w,u,k,g){this._current.writer=this._getVertexWriter(k);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=g;this._current.id=w;this._current.materialKey=u;this._current.geometryType=k;this._current.isDotDensity=!1;this._current.writer.recordStart()};h.recordCount=function(){return this._current.writer.recordCount};
h.vertexCount=function(){return this._current.writer.vertexCount};h.indexCount=function(){return this._current.writer.indexCount};h.vertexEnsureSize=function(w){this._current.writer.vertexEnsureSize(w)};h.indexEnsureSize=function(w){this._current.writer.indexEnsureSize(w)};h.vertexBounds=function(w,u,k,g){this._current.bufferingEnabled&&this._addOverlap(w,u,k,g)};h.vertexWrite=function(w){this._current.writer.writeVertex(w)};h.vertexWriteF32=function(w){this._current.writer.writeVertexF32(w)};h.vertexEnd=
function(){};h.vertexWriter=function(){return this._current.writer.vertexWriter};h.indexWrite=function(w){this._current.writer.writeIndex(w)};h.indexWriter=function(){return this._current.writer.indexWriter};h.metricWriter=function(){return this._current.writer.metricWriter};h.metricStart=function(w,u,k,g,f,n,z,x){this._current.writer=this._getVertexWriter(a.WGLGeometryType.LABEL);const B=this._current.writer.metricWriter;B.push(c.getDisplayIdTexel(w));B.push(u);B.push(k);B.push(g);B.push(f);B.push(n);
B.push(z);B.push(x);B.push(255);this._current.metricBoxLenPointer=B.push(0)};h.metricEnd=function(){const w=this._current.writer.metricWriter;0===w.getValue(this._current.metricBoxLenPointer)&&w.seek(w.length-10)};h.metricBoxWrite=function(w,u,k,g){const f=this._current.writer.metricWriter;f.incr(this._current.metricBoxLenPointer);f.push(0);f.push(0);f.push(w);f.push(u);f.push(k);f.push(g)};h.recordEnd=function(){var w=this._current.vertStart,u=this._current.writer.vertexCount-w;if(!u)return!1;this.hasRecords=
!0;var k=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,k,this._current.writer.indexCount-k,w,u,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===a.WGLGeometryType.LABEL)return!0;w=this._current.writer;for(u=0;8>u;u++){var g=1<<u;if(this._current.overlaps&g){this._data.neighbors[u]||(this._data.neighbors[u]={vertexData:new Map,displayIds:new Set});
k=this._data.neighbors[u];var f=this._current.geometryType;if(!k.vertexData.has(f)){var n=b.getStrides(f,this._symbologyType).geometry;n=new d.VertexDataWriter(f,n,l.PATCH_PIXEL_BUFFER_ALLOC_SIZE);k.vertexData.set(f,n)}f=k.vertexData.get(this._current.geometryType);n=4096*-p(g);g=4096*-r(g);f.copyLastFrom(w,n,g);k.displayIds.add(this._current.id)}}return!0};h._addOverlap=function(w,u,k,g){this._current.overlaps|=255^((w<0+k?148:w>=l.TILE_SIZE-k?41:189)|(u<0+g?224:u>=l.TILE_SIZE-g?7:231))};h._getVertexWriter=
function(w){if(!this._data.self.has(w)){const u=this._data.self,k=b.getStrides(w,this._symbologyType).geometry;u.set(w,new d.VertexDataWriter(w,k,this.hint.records))}return this._data.self.get(w)};t._createClass(v,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return v}();q.MeshData=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],
function(q){q.AGGREGATE_VALID_FILTERS_MASK=254;q.DISPLAY_ID_TEXEL_MASK=8388607;q.DISPLAY_ID_TYPE_AGGREGATE=1;q.DISPLAY_ID_TYPE_FEATURE=0;q.DISPLAY_ID_TYPE_MASK=8388608;q.NONAGGREGATE_VALID_FILTERS_MASK=255;q.createDisplayId=function(t,E){return((E?8388608:0)|t)>>>0};q.getDisplayIdFilterMask=t=>1===(t&8388608)>>>23?254:255;q.getDisplayIdTexel=t=>t&8388607;q.getDisplayIdType=t=>(t&8388608)>>>23;q.isAggregateId=function(t){return 1===(t&8388608)>>>23};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(q,t,E,C,A){let y=function(){function m(c,a,b){this._start={index:0,vertex:0};b=C.getMeshSizeHint(c,a,b);a/=4;this.geometryType=c;this._records=new A(Int32Array,b.recordBytes);this._indices=new A(Uint32Array,b.indexBytes);this._vertices=new A(Uint32Array,b.vertexBytes);
this._metrics=new A(Float32Array,0);this._strideInt=a}var l=m.prototype;l.serialize=function(c){const a=this._records.buffer(),b=this._indices.buffer(),d=this._vertices.buffer(),e=this._metrics.length?this._metrics.buffer():null,p=4*this._strideInt;c.push(a,b,d);return{stride:p,records:a,indices:b,vertices:d,metrics:e}};l.vertexEnsureSize=function(c){this._vertices.ensureSize(c)};l.indexEnsureSize=function(c){this._indices.ensureSize(c)};l.recordStart=function(){this._start.index=this._indices.length;
this._start.vertex=this._vertices.length};l.recordEnd=function(c,a,b,d,e,p,r,v){this._records.push(c);this._records.push(a);this._records.push(b);this._records.push(d);this._records.push(e);this._records.push(p);this._records.push(r);this._records.writeF32(v)};l.writeIndex=function(c){this._indices.push(c)};l.writeVertex=function(c){this._vertices.push(c)};l.writeVertexF32=function(c){this._vertices.writeF32(c)};l.copyLastFrom=function(c,a,b){var d=c._records.length-E.DISPLAY_RECORD_INT_PER_ELEMENT;
const e=c._records.getValue(d),p=c._records.getValue(d+1),r=c._records.getValue(d+2),v=c._records.getValue(d+4),h=c._records.getValue(d+6);d=c._records.getValue(d+7);const w=this._vertices.length;var u=(c._start.vertex-this._vertices.length)/this._strideInt;const k=this._indices.length,g=this.vertexCount;for(var f=c._start.index;f!==c._indices.length;f++){const n=c._indices.getValue(f);this._indices.push(n-u)}for(u=c._start.vertex;u!==c._vertices.length;u++)f=c._vertices.getValue(u),this._vertices.push(f);
for(c=w;c<=this._vertices.length;c+=this._strideInt)this._vertices.i1616Add(c,a,b);this._records.push(e);this._records.push(p);this._records.push(r);this._records.push(k);this._records.push(v);this._records.push(g);this._records.push(h);this._records.push(d)};t._createClass(m,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/E.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},
{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return m}();q.VertexDataWriter=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(q,t,E){const C=new Map;C.set(E.WGLGeometryType.MARKER,
{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});C.set(E.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});C.set(E.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});C.set(E.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});q.getMeshSizeHint=function(A,y,m){const {indicesPerRecord:l,multiplier:c,verticesPerRecord:a}=C.get(A);return{recordBytes:m*
t.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:c*l*m*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:c*a*m*y}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(q,t){function E(C,A,y,m){C=C.clone();const l=1<<C.level;A=C.col+A;y=C.row+y;m&&0>A?(C.col=A+l,--C.world):A>=l?(C.col=A-l,C.world+=1):C.col=A;C.row=y;return C}q.getPow2NeighborKey=
E;q.getPow2NeighborTile=function(C,A,y){A=E(C.key,A,y,C.tileInfoView.tileInfo.isWrappable);return new t.Tile(C.tileInfoView,A)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(q,t,E,C,A,y,m,l,c,a){E=function(){function b(e,p,r){this._loadPromise=y.loadLibtess();this._geometryType=e;this._idField=p;this._templateStore=r}var d=b.prototype;d.update=function(e,p){C.isSome(e.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,p));this._schema=e};d._createLabelTemplates=function(e,p){const r=new Map;if("simple"===e.type){for(var v of e.classes)e=l.fromLabelClass(v,p),r.set(v.index,e);return r}for(const h in e.classes){v=e.classes[h];for(const w of v)v=
l.fromLabelClass(w,p),r.set(w.index,v)}return r};d.analyze=function(){var e=t._asyncToGenerator(function*(p,r,v,h,w,u,k){if(!A.isAborted(k)){var g;"dictionary"===v.type&&(g=yield v.analyze(this._idField,p.copy(),r,w,u,k));for(r=0;p.next();){var f=void 0;f=g?g[r++]:C.isSome(h)&&m.isAggregateId(p.getDisplayId())&&1!==p.readAttribute("cluster_count")?h.match(this._idField,p,this._geometryType,w,u):v.match(this._idField,p,this._geometryType,w,u);p.setGroupId(f);if(a.isDynamicId(f)){f=this._templateStore.getDynamicTemplateGroup(f);
for(const n of f)n&&n.analyze&&n.analyze(this._templateStore,p,w,u)}}yield this._loadPromise;return this._templateStore.finalize(k)}});return function(p,r,v,h,w,u,k){return e.apply(this,arguments)}}();d.analyzeGraphics=function(){var e=t._asyncToGenerator(function*(p,r,v,h,w,u){if(!A.isAborted(u)){p=p.getCursor();for(v&&(yield v.analyze(this._idField,p.copy(),r,h,w,u));p.next();){r=p.getGroupId();if(null==r||-1===r)r=v.match(this._idField,p,p.geometryType,h,w),p.setGroupId(r);if(a.isDynamicId(r)){const k=
this._templateStore.getDynamicTemplateGroup(r);for(const g of k)g&&g.analyze&&g.analyze(this._templateStore,p,h,w)}p.setGroupId(r)}yield this._loadPromise;return this._templateStore.finalize(u)}});return function(p,r,v,h,w,u){return e.apply(this,arguments)}}();d.writeGraphic=function(e,p,r,v){const h=p.getGroupId(),w=p.getDisplayId(),u=this._templateStore.getTemplateGroup(h);e.featureStart(p.insertAfter,0);if(null!=w){if(a.isDynamicId(h))for(const k of u)k&&k.bindFeature(p,null,null);if(u){for(const k of u)k&&
k.write(e,p,r,v);e.featureEnd()}}};d.writeCursor=function(e,p,r,v,h,w,u){const k=p.getGroupId(),g=p.getDisplayId(),f=this._templateStore.getTemplateGroup(k),n=this._schema.mesh.sortKey;let z=0;C.isSome(n)&&(z=null!=n.fieldIndex?p.getComputedNumericAtIndex(n.fieldIndex):null!=n.field?p.readAttribute(n.field):p.readAttribute(this._idField),z*="asc"===n.order?1:-1);e.featureStart(0,null==z||isNaN(z)?0:z);if(null!=g&&f){if(a.isDynamicId(k))for(const x of f)x.bindFeature(p,r,v);for(const x of f)x.write(e,
p,h,u);C.isSome(w)&&e.hasRecords&&(r=w&&this._findLabelRef(f),this._writeLabels(e,p,w,r,h,u));e.featureEnd()}};d._findLabelRef=function(e){for(const p of e)if(p instanceof c)return p;return null};d._writeLabels=function(e,p,r,v,h,w){for(const u of r)if(C.isSome(u)&&u){const {glyphs:k,rtl:g,index:f}=u;r=this._labelTemplates.get(f);r.setZoomLevel(h);r.bindReferenceTemplate(v);r.bindTextInfo(k,g);r.write(e,p,null,w)}};t._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);return b}();
q.WGLMeshFactory=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/libtess":function(){define(["require","exports","../chunks/_rollupPluginBabelHelpers","../assets","../core/has"],function(q,t,E,C,A){function y(){y=E._asyncToGenerator(function*(){c||(c=m());return c});return y.apply(this,arguments)}function m(){return l.apply(this,arguments)}function l(){l=E._asyncToGenerator(function*(){a=yield(A("esri-csp-restrictions")?yield(new Promise((b,
d)=>q(["../chunks/libtess-asm"],b,d))).then(b=>b.libtessAsm):yield(new Promise((b,d)=>q(["../chunks/libtess"],b,d))).then(b=>b.libtess)).load({locateFile:b=>C.getAssetUrl(`esri/core/libs/libtess/${b}`)})});return l.apply(this,arguments)}let c=null,a=null;t.loadLibtess=function(){return y.apply(this,arguments)};t.triangulate=function(b,d){return a.triangulate(b,d,Math.max(b.length,128E3))};Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r){const v=E.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),h=(u,k="mapview-labeling")=>v.error(new t(k,u)),w=function(u){const k=new Map;return g=>{k.has(g)||k.set(g,u(g));return k.get(g)}}(u=>{let k=0;if(0===u)return Infinity;for(;!(u%2);)k++,u/=2;return k});return function(u){function k(f,n,z,x){var B=u.call(this,f,z.font.size,z.haloSize||0,z.font.size,z.color&&c.premultiplyAlphaRGBAArray(z.color)||0,z.haloColor&&c.premultiplyAlphaRGBAArray(z.haloColor)||
0,z.horizontalAlignment,z.verticalAlignment,l.isMapAligned(n.labelPlacement)?m.Alignment.MAP:m.Alignment.SCREEN,z.font.decoration,!1,z.angle||0,z.xoffset,z.yoffset,z.lineWidth,z.lineHeight,null,null,null,null,null)||this;B._outLineLabelAngle=0;B._refPlacementPadding=0;B._refPlacementDirX=0;B._refPlacementDirY=0;B._refOffsetX=0;B._refOffsetY=0;B._zoomLevel=0;B.geometryType=b.WGLGeometryType.LABEL;B._allowOverrun=n.allowOverrun??!1;B._repeatLabel=n.repeatLabel??!0;B._labelPosition=n.labelPosition??
"curved";var D=!!n.minScale&&x.scaleToZoom(n.minScale)||0;D=C.clamp(D,0,25.5);x=!!n.maxScale&&x.scaleToZoom(n.maxScale)||255;x=C.clamp(x,0,25.5);const [F,G]=l.getAlignmentFromPlacement(n.labelPlacement);B._xAlignD=F;B._yAlignD=G;B._minZoom=D;B._maxZoom=x;B._refPlacementPadding=y.pt2px(z.haloSize)+a.TEXT_PLACEMENT_PADDING;B._repeatLabelDistance=n.repeatLabelDistance?y.pt2px(n.repeatLabelDistance):128;f=e.LabelMaterialKey.load(f);f.sdf=!0;B._materialKey=f.data;return B}q._inheritsLoose(k,u);k.fromLabelClass=
function(f,n){if("esriServerLinePlacementCenterAlong"===f.labelPlacement){const z=f.symbol;z.xoffset=0;z.yoffset=0;z.angle=0;z.font.decoration="none"}return new k(f.materialKey,f,f.symbol,n)};var g=k.prototype;g.setZoomLevel=function(f){this._zoomLevel=f};g.bindReferenceTemplate=function(f){let n=l.getXDirection(this._xAlignD),z=l.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(A.isNone(f))this._refSymbolAndPlacementOffset=d.i8888to32(0,0,Math.floor(127*n+127),Math.floor(127*z+
127));else{if("circle"===f.boundsType&&(n||z)){var x=Math.sqrt(n*n+z*z);n/=x;z/=x}x=Math.max(f.height,f.width);this._refSymbolAndPlacementOffset=d.i8888to32(4*this._refPlacementPadding,x,Math.floor(127*n+127),Math.floor(127*z+127));this._referenceSize=x;this._refPlacementDirX=n;this._refPlacementDirY=z;this._refOffsetX=f.xOffset;this._refOffsetY=f.yOffset}};g._write=function(f,n){if(!A.isNone(this._shapingInfo)){var z=this._shapingInfo,x=n.getDisplayId(),B="esriGeometryPolygon"===n.geometryType?n.readLegacyCentroid():
n.readLegacyGeometry();if(B)switch(this._current={out:f,inId:x,inShaping:z,zoomLevel:this._zoomLevel},n.geometryType){case "esriGeometryPolyline":this._placeLineLabels(B);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(B);break;default:h("mapview-labeling",`Geometry of type ${n.geometryType} is not supported`)}}};g._isVisible=function(f,n){const z=Math.floor(10*this._current.zoomLevel);return Math.floor(10*f)<=z&&z<=Math.floor(10*n)};g._placePointLabels=function(f){const {out:n,
inId:z,inShaping:x}=this._current;this._writeGlyphs(n,z,f,x)};g._placeLineLabels=function(f){f=p.smoothPaths(f.paths,this._current.inShaping.bounds.width);const n=this._placeSubdivGlyphs.bind(this),z=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const x of f)p.pathDivide(x,z,n,this._repeatLabel)};g._placeSubdivGlyphs=function(f,n,z,x){var B=w(n),D=this._shapedBox.width/2,F=Math.sqrt(this._repeatLabelDistance)/2;z=Math.min(z,x-z);D=this._current.inShaping.isMultiline?25:Math.log2(z/(F+D/
2));B=Math.max(this._minZoom,this._current.zoomLevel+1-(0===n?D:Math.min(B,D)));D=this._current.zoomLevel-B;F=this._shapedBox.width/2*2**D;this._current.inShaping.isMultiline?0===n&&this._placeStraight(f,B):this._allowOverrun&&0>D?this._placeStraightAlong(f,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(f,B):"curved"===this._labelPosition&&this._placeCurved(f,B,F)};g._placeStraight=function(f,n){const {out:z,inId:x,inShaping:B}=this._current,D=Math.ceil((180/Math.PI*f.angle+
180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*f.angle%360));this._writeGlyphs(z,x,f,B,n);this._outLineLabelAngle=Math.round(254/360*D);this._writeGlyphs(z,x,f,B,n)};g._placeCurved=function(f,n,z){const {out:x,inId:B}=this._current;x.metricStart(B,n,f.x,f.y,0,0,0,0);const D=f.clone(),F=(180/Math.PI*f.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*f.angle%360*(254/360));this._placeFirst(D,n,1);this._placeBack(f,D,n,z,1);this._placeForward(f,D,n,z,1);this._outLineLabelAngle=
Math.round(254/360*F);this._placeFirst(D,n,0);this._placeBack(f,D,n,z,0);this._placeForward(f,D,n,z,0);x.metricEnd()};g._placeStraightAlong=function(f,n){const {out:z,inId:x}=this._current;z.metricStart(x,n,f.x,f.y,0,0,0,0);const B=f.clone(),D=(180/Math.PI*f.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*f.angle%360*(254/360));this._placeFirst(B,n,1,!0);this._outLineLabelAngle=Math.round(254/360*D);this._placeFirst(B,n,0,!0);z.metricEnd()};g._placeBack=function(f,n,z,x,B){const D=f.clone();
for(f=f.backwardLength+0;D.prev()&&!(f>=x);)this._placeOnSegment(D,n,f,z,-1,B),f+=D.length+0};g._placeForward=function(f,n,z,x,B){const D=f.clone();for(f=f.remainingLength+0;D.next()&&!(f>=x);)this._placeOnSegment(D,n,f,z,1,B),f+=D.length+0};g._placeFirst=function(f,n,z,x=!1){const B=this._current.inShaping;var D=B.glyphs;const F=this._current.zoomLevel,{out:G,inId:H}=this._current;for(const J of D)D=J.x>B.bounds.x?z:1-z,D=Math.max(0,F+Math.log2(Math.abs(J.x+J.width/2-B.bounds.x)/(D*f.remainingLength+
(1-D)*f.backwardLength))),D=Math.max(n,x?0:D),J.maxZoom=25,J.angle=f.angle+(1-z)*Math.PI,J.minZoom=D,this._writeGlyph(G,H,f.x,f.y,J),z&&this._isVisible(J.minZoom,J.maxZoom)&&(D=J.bounds,G.metricBoxWrite(D.center[0],D.center[1],D.width,D.height))};g._placeOnSegment=function(f,n,z,x,B,D){var F=this._current.inShaping.glyphs;const {out:G,inId:H}=this._current,J=this._current.inShaping,L=this._current.zoomLevel;var K=f.x+f.dx/f.length*-B*z,U=f.y+f.dy/f.length*-B*z;for(const Z of F)if((F=Z.x>J.bounds.x?
D:1-D)&&1===B||!F&&-1===B){var X=Math.abs(Z.x+Z.width/2-J.bounds.x);F=Math.max(0,L+Math.log2(X/z)-.1);X=Math.max(x,L+Math.log2(X/(z+f.length+0)));0!==F&&(Z.angle=f.angle+(1-D)*Math.PI,Z.minZoom=X,Z.maxZoom=F,this._writeGlyph(G,H,K,U,Z),D&&this._isVisible(Z.minZoom,Z.maxZoom)&&(F=Z.bounds,G.metricBoxWrite(F.center[0]+(f.x-n.x),F.center[1]+(f.y-n.y),F.width,F.height)))}};g._writeGlyphs=function(f,n,z,x,B=this._minZoom){if(!(0>z.x||512<=z.x||0>z.y||512<=z.y)){var D=z.x+this._refOffsetX;z=z.y-this._refOffsetY;
for(const F of x.glyphs)F.minZoom=B,F.maxZoom=this._maxZoom,this._writeGlyph(f,n,D,z,F);x=x.boundsT;f.metricStart(n,B,D,z,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);f.metricBoxWrite(x.center[0],x.center[1],x.width,x.height);f.metricEnd()}};g._writeVertexCommon=function(f,n,z,x){const B=this._color,D=this._haloColor,F=d.i8888to32(0,0,this._size,this._haloSize);x=d.i8888to32(Math.floor(10*Math.max(x.minZoom,this._minZoom)),Math.floor(10*Math.min(x.maxZoom,this._maxZoom)),
this._outLineLabelAngle,0);f.vertexWrite(z);f.vertexWrite(n);f.vertexWrite(B);f.vertexWrite(D);f.vertexWrite(F);f.vertexWrite(this._refSymbolAndPlacementOffset);f.vertexWrite(x)};q._createClass(k,[{key:"_shapedBox",get:function(){return A.unwrap(this._shapingInfo).bounds}}]);return k}(r)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(q,t,E,C){function A(a){return a.length-
1}function y(a){let b=0;for(let d=0;d<A(a);d++)b+=m(a,d);return b}function m(a,b,d=1){const [e,p]=a[b+1];return Math.sqrt(e*e+p*p)*d}function l(a,b,d,e,p){if(!(d<b)){var r=e.clone().seek(d/2);E.isNone(r)||(a(r.clone(),d,p),d=(d-b)/2,r=E.unwrap(r.seek(b/2)),l(a,b,d,e,p+1),l(a,b,d,r,p+1))}}let c=function(){function a(d,e,p,r,v){this._segments=d;this._index=e;this._distance=p;this._xStart=r;this._yStart=v;this._done=!1}a.create=function(d){return new a(d,0,0,d[0][0],d[0][1])};var b=a.prototype;b.clone=
function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};b.equals=function(d){return this._index===d._index||d._index===this._index-1&&(0===this._distance||1===d._distance)||d._index===this._index+1&&(1===this._distance||0===d._distance)};b.leq=function(d){return this._index<d._index||this._index===d._index&&this._distance<=d._distance};b.geq=function(d){return this._index>d._index||this._index===d._index&&this._distance>=d._distance};b.hasPrev=function(){return 0<=
this._index-1};b.hasNext=function(){return this._index+1<A(this._segments)};b.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};b.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};b._seekBackwards=function(d,e){var p=this.backwardLength;if(d<=p)return this._distance=(p-d)/this.length,this;for(p=this.backwardLength;this.prev();){if(p+
this.length>d)return this._seekBackwards(d-p);p+=this.length}this._distance=0;return e?this:null};b.seek=function(d,e=!1){if(0>d)return this._seekBackwards(Math.abs(d),e);if(d<=this.remainingLength)return this._distance=(this.backwardLength+d)/this.length,this;let p=this.remainingLength;for(;this.next();){if(p+this.length>d)return this.seek(d-p,e);p+=this.length}this._distance=1;return e?this:null};t._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",
get:function(){const d=this.dy;let e=Math.acos((0*d+-1*-this.dx)/(1*this.length));0<d&&(e=2*Math.PI-e);return e}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:d,dy:e}=this;return Math.sqrt(d*d+e*e)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return a}();q.SegmentCursor=c;q.pathDivide=function(a,b,d,e=!0){const p=y(a);a=c.create(a);const r=p/2;if(e){e=Math.floor(Math.max((p-b)/2,0)/b);a.seek(r-e*b);for(let v=-e;v<=e;v++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&d(a.clone(),v,r+v*b,p),a.seek(b)}else a.seek(r),d(a.clone(),0,r+0*b,p)};q.pathLength=y;q.pathSubdivide=function(a,b,d){l(d,b,y(a),c.create(a),0)};q.segmentAt=function(a,b){return a[b+1]};q.segmentCount=A;q.segmentLength=m;q.smoothPaths=function(a,b){for(let D=0;D<a.length;D++){var d=a[D];
const F=[];F.push(d[0]);for(var e=1;e<d.length;e++){let [G,H]=F[e-1];G+=d[e][0];H+=d[e][1];F.push([G,H])}a:{d=F;e=b;if(0>=e)break a;const G=d.length;if(3>G)break a;const H=[];var p=0;H.push(0);for(var r=1;r<G;r++)p+=C.dist(d[r],d[r-1]),H.push(p);e=Math.min(e,.2*p);p=[];p.push(d[0][0]);p.push(d[0][1]);r=d[G-1][0];const J=d[G-1][1];var v=C.sub([0,0],d[0],d[1]);C.normalize(v);d[0][0]+=e*v[0];d[0][1]+=e*v[1];C.sub(v,d[G-1],d[G-2]);C.normalize(v);d[G-1][0]+=e*v[0];d[G-1][1]+=e*v[1];for(v=1;v<G;v++)H[v]+=
e;H[G-1]+=e;v=.5*e;for(let L=1;L<G-1;L++){let K=0,U=0,X=0;for(var h=L-1;0<=h&&!(H[h+1]<H[L]-v);h--){var w=v+H[h+1]-H[L],u=H[h+1]-H[h],k=H[L]-H[h]<v?1:w/u;if(1E-6>Math.abs(k))break;var g=k*k,f=k*w-.5*g*u,n=k*u/e,z=d[h+1],x=d[h][0]-z[0],B=d[h][1]-z[1];K+=n/f*(z[0]*k*w+.5*g*(w*x-u*z[0])-g*k*u*x/3);U+=n/f*(z[1]*k*w+.5*g*(w*B-u*z[1])-g*k*u*B/3);X+=n}for(h=L+1;h<G&&!(H[h-1]>H[L]+v);h++){w=v-H[h-1]+H[L];u=H[h]-H[h-1];k=H[h]-H[L]<v?1:w/u;if(1E-6>Math.abs(k))break;g=k*k;f=k*w-.5*g*u;n=k*u/e;z=d[h-1];x=d[h][0]-
z[0];B=d[h][1]-z[1];K+=n/f*(z[0]*k*w+.5*g*(w*x-u*z[0])-g*k*u*x/3);U+=n/f*(z[1]*k*w+.5*g*(w*B-u*z[1])-g*k*u*B/3);X+=n}p.push(K/X);p.push(U/X)}p.push(r);p.push(J);for(let L=0,K=0;L<G;L++)d[L][0]=p[K++],d[L][1]=p[K++]}d=[];d.push(F[0]);for(e=1;e<F.length;e++){const [G,H]=F[e-1],[J,L]=F[e];d.push([Math.round(J-G),Math.round(L-H)])}a[D]=d}return a};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],
function(q){function t(E,C){return Math.sqrt(E*E+C*C)}q.DEFAULT_MAX_ZOOM=100;q.DEFAULT_MIN_ZOOM=0;q.dist=function(E,C){return t(E[0]-C[0],E[1]-C[1])};q.getLimitCosine=function(E=2){return 1/Math.max(E,1)};q.getMinMaxZoom=function(E,C){const A=!!E.minScale&&C.scaleToZoom(E.minScale)||0;E=!!E.maxScale&&C.scaleToZoom(E.maxScale)||100;return[A,E]};q.isExtent=function(E){return void 0!==E.xmin&&void 0!==E.ymin&&void 0!==E.xmax&&void 0!==E.ymax};q.isFunction=function(E){return"function"===typeof E};q.isMultipoint=
function(E){return void 0!==E.points};q.isPoint=function(E){return void 0!==E.x&&void 0!==E.y};q.isPolygon=function(E){return void 0!==E.rings};q.isPolyline=function(E){return void 0!==E.paths};q.len=t;q.normalize=function(E){const C=t(E[0],E[1]);E[0]/=C;E[1]/=C};q.sub=function(E,C,A){E[0]=C[0]-A[0];E[1]=C[1]-A[1];return E};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){return function(e){function p(r,v,h,w,u,k,g,f,n,z,x,B,D,F,G,H,J,L,K=!1,U,X){var Z=e.call(this)||this;Z._xOffset=E.pt2px(D);Z._yOffset=E.pt2px(F);Z._decoration=z||"none";Z._color=u;Z._haloColor=k;Z._haloSize=Math.min(Math.floor(5*E.pt2px(E.toPt(h))),127);Z._size=Math.min(Math.round(E.pt2px(v)),127);v=Math.min(Math.round(E.pt2px(w||v)),127);Z._referenceSize=Math.round(Math.sqrt(256*v));Z._scale=Z._size/m.GLYPH_SIZE;Z._angle=B;Z._justify=A.getJustification(g||"center");
Z._xAlignD=A.getXAnchorDirection(g||"center");Z._yAlignD=A.getYAnchorDirection(f||"baseline");Z._baseline="baseline"===(f||"baseline");Z._bitset=(n===C.Alignment.MAP?1:0)|(x?1:0)<<1;r=c.MaterialKeyBase.load(r);r.sdf=!0;Z._materialKey=r.data;Z._lineWidth=E.pt2px(G)||512;Z._lineHeight=H||1;Z._textPlacement=J;Z._effects=L;Z._isCIM=K;Z._minMaxZoom=l.i1616to32(Math.round(U*m.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(X*m.MIN_MAX_ZOOM_PRECISION_FACTOR));return Z}q._inheritsLoose(p,e);p.fromText=function(r,
v){const h=new p(r.materialKey,r.font.size,r.haloSize||0,r.font.size,r.color&&y.premultiplyAlphaRGBAArray(r.color)||0,r.haloColor&&y.premultiplyAlphaRGBAArray(r.haloColor)||0,r.horizontalAlignment,r.verticalAlignment,C.Alignment.SCREEN,r.font.decoration,!1,r.angle||0,r.xoffset,r.yoffset,r.lineWidth,r.lineHeight,null,null,!1,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM),[,w]=t.bidiText(r.text);h.bindTextInfo(v,w);h._vertexBoundsScale=r.maxVVSize?r.maxVVSize/r.font.size:1;return h};p.fromCIMText=function(r,
v,h){var w=r.scaleFactor||1;const u=r.size*r.sizeRatio*w,[k,g]=a.getMinMaxZoom(r.scaleInfo,h);h=new p(r.materialKey,u,r.outlineSize*r.sizeRatio,r.referenceSize,y.premultiplyAlphaRGBA(r.color),y.premultiplyAlphaRGBA(r.outlineColor),r.horizontalAlignment,r.verticalAlignment,r.alignment,r.decoration,r.colorLocked,r.angle,r.offsetX*r.sizeRatio*w,r.offsetY*r.sizeRatio*w,512,1,r.markerPlacement,r.effects,!0,k,g);[,w]=t.bidiText(r.text);h.bindTextInfo(v,w);h._vertexBoundsScale=r.maxVVSize?r.maxVVSize/u:
1;return h};return p}(b(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(q,t,E,C,A,y,m,l,c,a){return b=>function(d){function e(...r){r=
d.call(this,...r)||this;r._isCIM=!1;r._vertexBoundsScale=1;r.geometryType=m.WGLGeometryType.TEXT;r._aux=l.i8888to32(0,0,r._referenceSize,r._bitset);return r}q._inheritsLoose(e,d);var p=e.prototype;p.bindTextInfo=function(r,v){this._shapingInfo=r&&r.length?t.applySome(r,h=>a.shapeGlyphs(h,v,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:y.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};p._write=function(r,v,h,w){const u=v.getDisplayId();this._writeGeometry(r,v,u,h,w)};p._writeGeometry=function(r,v,h,w,u){const k=this._shapingInfo;if(!t.isNone(k)){if(t.isSome(this._textPlacement))return v=u??v.readLegacyGeometryForDisplay(),this._writePlacedText(r,h,v,k,w);w=u?C.deltaDecodeGeometry(C.convertFromGeometry(u),2):"esriGeometryPolygon"===v.geometryType?v.readCentroid():v.readGeometryForDisplay();
if(!t.isNone(w)){if(w.isPoint){const [g,f]=w.coords;return!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>g||512<=g||0>f||512<=f)?void 0:this._writeGlyphs(r,h,{x:g,y:f},k)}w.forEachVertex((g,f)=>this._writeGlyphs(r,h,{x:g,y:f},k))}}};p._writePlacedText=function(r,v,h,w,u){var k=t.unwrap(this._textPlacement);if(h=A.CIMMarkerPlacementHelper.getPlacement(h,k,E.pt2px(1),u.geometryEngine))for(var g=h.next();null!=g;)u=-g.getAngle(),w.setRotation(u),k=g.tx,g=-g.ty,0>k||512<=k||0>g||512<=g||(this._writeGlyphs(r,
v,{x:k,y:g},w),w.setRotation(-u)),g=h.next()};p._writeGlyphs=function(r,v,h,w){const u=c.MaterialKeyBase.load(this._materialKey),k=l.i1616to32(Math.round(8*h.x),Math.round(8*h.y)),g=this._vertexBoundsScale,f=w.bounds,n=2*Math.max(f.width,f.height);for(const z of w.glyphs)u.textureBinding=z.textureBinding,r.recordStart(v,u.data,this.geometryType,!0),r.vertexBounds(h.x+f.x+this._xOffset,h.y+f.y-this._yOffset,n*g,n*g),this._writeVertices(r,v,k,z),r.recordEnd()};p._writeGlyph=function(r,v,h,w,u){var k=
c.MaterialKeyBase.load(this._materialKey);const g=l.i1616to32(Math.round(8*h),Math.round(8*w));k.textureBinding=u.textureBinding;r.recordStart(v,k.data,this.geometryType,!0);k=u.bounds;const f=this._vertexBoundsScale;r.vertexBounds(h+k.x*f,w+k.y*f,k.width*f,k.height*f);this._writeVertices(r,v,g,u);r.recordEnd()};p._writeVertices=function(r,v,h,w){const u=r.vertexCount();this._writeVertexCommon(r,v,h,w);r.vertexWrite(w.offsets.upperLeft);r.vertexWrite(w.texcoords.upperLeft);r.vertexEnd();this._writeVertexCommon(r,
v,h,w);r.vertexWrite(w.offsets.upperRight);r.vertexWrite(w.texcoords.upperRight);r.vertexEnd();this._writeVertexCommon(r,v,h,w);r.vertexWrite(w.offsets.lowerLeft);r.vertexWrite(w.texcoords.lowerLeft);r.vertexEnd();this._writeVertexCommon(r,v,h,w);r.vertexWrite(w.offsets.lowerRight);r.vertexWrite(w.texcoords.lowerRight);r.vertexEnd();r.indexWrite(u+0);r.indexWrite(u+1);r.indexWrite(u+2);r.indexWrite(u+1);r.indexWrite(u+3);r.indexWrite(u+2)};p._writeVertexCommon=function(r,v,h,w){w=this._color;const u=
this._haloColor,k=l.i8888to32(0,0,this._referenceSize,this._bitset),g=l.i8888to32(0,0,this._size,this._haloSize);r.vertexWrite(h);r.vertexWrite(v);r.vertexWrite(w);r.vertexWrite(u);r.vertexWrite(g);r.vertexWrite(k);r.vertexWrite(this._minMaxZoom)};return e}(b)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(q,t,E){let C=function(){function A(){}A.getPlacement=function(y,m,l,c){const a=E.getPlacementOperator(m);if(!a)return null;
y=t.cloneAndDecodeGeometry(y);return a.execute(y,m,l,c)};return A}();q.CIMMarkerPlacementHelper=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(q,t){return function(){function E(){}var C=E.prototype;C.bindFeature=function(A,y,m){};C.write=function(A,y,m,l){if(q.isNone(this._effects)||
0===this._effects?.length)return this._write(A,y,l);m=t.CIMEffectHelper.executeEffects(this._effects,y.readLegacyGeometryForDisplay(),l.geometryEngine);let c=t.CIMEffectHelper.next(m);for(;c;)this._write(A,y,l,c),c=t.CIMEffectHelper.next(m)};C._write=function(A,y,m,l){};return E}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(q,t,E,C,A){const y=96/72;let m=function(){function l(){}
l.executeEffects=function(c,a,b){a=E.cloneAndDecodeGeometry(a);a=new C.SimpleGeometryCursor(a);for(const d of c)(c=A.getEffectOperator(d))&&(a=c.execute(a,d,y,b));return a};l.next=function(c){c=c.next();E.deltaEncodeGeometry(c);return c};l.applyEffects=function(c,a,b){if(!c)return a;a=new C.SimpleGeometryCursor(a);for(var d of c)(c=A.getEffectOperator(d))&&(a=c.execute(a,d,1,b));for(b=null;d=a.next();)b?t.isPolyline(b)?t.isPolyline(d)&&b.paths.push(...d.paths):t.isPolygon(b)&&t.isPolygon(d)&&b.rings.push(...d.rings):
b=d;return b};return l}();q.CIMEffectHelper=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p){return function(r){function v(h,w,u,k,g,f,n,z,x,B,D,F,G,H,J,L,K,U,X,Z,aa,da,R){var M=r.call(this)||this;M.angle=k;M.height=n;M.width=f;M.xOffset=w*X;M.yOffset=u*X;M._markerPlacement=Z;M._effects=aa;M._anchorX=L;M._anchorY=K;M._minMaxZoom=a.i1616to32(Math.round(da*l.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(R*l.MIN_MAX_ZOOM_PRECISION_FACTOR));w=(H===y.Alignment.MAP?l.BITSET_MARKER_ALIGNMENT_MAP:l.BITSET_MARKER_ALIGNMENT_SCREEN)|(D?l.BITSET_GENERIC_LOCK_COLOR:0)|
(G?l.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(F?l.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);u=J&&J.sdf;h=b.MarkerMaterialKey.load(h);h.sdf=u;h.pattern=!0;h.textureBinding=J.textureBinding;M._materialKey=h.data;M._fillColor=g;M._outlineColor=x;M._sizeOutlineWidth=a.i8888to32(Math.round(Math.min(Math.sqrt(128*f),255)),Math.round(Math.min(Math.sqrt(128*n),255)),Math.round(Math.min(Math.sqrt(128*B),255)),Math.round(Math.min(Math.sqrt(128*z),255)));g=J.rect.x+l.SPRITE_PADDING;z=J.rect.y+l.SPRITE_PADDING;
x=g+J.width;J=z+J.height;M._offsets.xUpperLeft=g;M._offsets.yUpperLeft=z;M._offsets.xUpperRight=x;M._offsets.yUpperRight=z;M._offsets.xBottomLeft=g;M._offsets.yBottomLeft=J;M._offsets.xBottomRight=x;M._offsets.yBottomRight=J;h.symbologyType===c.WGLSymbologyType.PIE_CHART?(M._texUpperLeft=a.i1616to32(0,1),M._texUpperRight=a.i1616to32(1,1),M._texBottomLeft=a.i1616to32(0,0),M._texBottomRight=a.i1616to32(1,0)):(M._texUpperLeft=a.i1616to32(g,z),M._texUpperRight=a.i1616to32(x,z),M._texBottomLeft=a.i1616to32(g,
J),M._texBottomRight=a.i1616to32(x,J));f=f*U*X;n=n*U*X;M._bitestAndDistRatio=a.i1616to32(w,Math.round(64*U));M._computedWidth=f;M._computedHeight=n;f=A.create();n=C.create();M._applyTransformation(n,f);return M}q._inheritsLoose(v,r);v.fromCIMMarker=function(h,w,u){const k=h.size,g=(w&&w.width||1)/(w&&w.height||1)*h.scaleX;var f=h.scaleSymbolsProportionally&&h.frameHeight?k/h.frameHeight:1;let n=m.premultiplyAlphaRGBA(h.color);const z=m.premultiplyAlphaRGBA(h.outlineColor),x=E.pt2px(k),B=x*g,D=E.pt2px(h.offsetX||
0),F=E.pt2px(h.offsetY||0);f*=E.pt2px(h.outlineWidth||0);const G=h.alignment||y.Alignment.SCREEN,H=E.pt2px(h.referenceSize),[J,L]=d.getMinMaxZoom(h.scaleInfo,u);w.sdf||0!==n||(n=-1);u=h.rotation||0;h.rotateClockwise||(u=-u);let K=0,U=0;const X=h.anchorPoint;X&&(h.isAbsoluteAnchorPoint?k&&(K=X.x/(k*g),U=X.y/k):(K=X.x,U=X.y));w=new v(h.materialKey,D,F,u,n,B,x,H,z,f,h.colorLocked,h.scaleSymbolsProportionally,!1,G,w,K,U,h.sizeRatio,t.unwrapOr(h.scaleFactor,1),h.markerPlacement,h.effects,J,L);w._vertexBoundsScaleX=
h.maxVVSize?h.maxVVSize/B:1;w._vertexBoundsScaleY=h.maxVVSize?h.maxVVSize/x:1;return w};v.fromPictureMarker=function(h,w){const u=Math.round(E.pt2px(h.width)),k=Math.round(E.pt2px(h.height)),g=l.PICTURE_FILL_COLOR,f=Math.round(E.pt2px(h.xoffset||0)),n=Math.round(E.pt2px(h.yoffset||0));w=new v(h.materialKey,f,n,h.angle,g,u,k,k,0,0,!1,!1,!1,y.Alignment.SCREEN,w,0,0,1,1,null,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM);w._vertexBoundsScaleX=h.maxVVSize?h.maxVVSize/h.width:1;w._vertexBoundsScaleY=h.maxVVSize?
h.maxVVSize/h.height:1;return w};v.fromSimpleMarker=function(h,w){const u=m.premultiplyAlphaRGBAArray(h.color),k=Math.round(E.pt2px(h.size)),g=Math.round(E.pt2px(h.xoffset||0)),f=Math.round(E.pt2px(h.yoffset||0)),n=h.style;var z=h.outline;const x=(z&&z.color&&m.premultiplyAlphaRGBAArray(z.color))|0;z=(z&&z.width&&Math.round(E.pt2px(z.width)))|0;w=new v(h.materialKey,g,f,h.angle,u,k,k,k,x,z,!1,!1,"esriSMSCross"===n||"esriSMSX"===n,y.Alignment.SCREEN,w,0,0,1.96875,1,null,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM);
w.boundsType="esriSMSCircle"===n?"circle":"square";w._vertexBoundsScaleX=h.maxVVSize?h.maxVVSize/h.size:1;w._vertexBoundsScaleY=h.maxVVSize?h.maxVVSize/h.size:1;return w};v.fromLineSymbolMarker=function(h,w){const u=m.premultiplyAlphaRGBAArray(h.color),k=Math.round(E.pt2px(6*h.lineWidth)),g="cross"===h.style||"x"===h.style;switch(h.placement){case "begin-end":var f=y.ExtremityPlacement.Both;break;case "begin":f=y.ExtremityPlacement.JustBegin;break;case "end":f=y.ExtremityPlacement.JustEnd;break;default:f=
y.ExtremityPlacement.None}f={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:f,offsetAlongLine:0};w=new v(h.materialKey,0,0,0,u,k,k,k/6,u,g?Math.round(E.pt2px(h.lineWidth)):0,!1,!1,g,y.Alignment.MAP,w,0,0,1.96875,1,f,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM);w.boundsType="circle"===h.style?"circle":"square";return w};return v}(e(p))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){const p=3.14159265359/180;return r=>function(v){function h(...u){u=v.call(this,...u)||this;u.angle=0;u.xOffset=0;u.yOffset=0;u.width=0;u.height=0;u.boundsType="square";u._anchorX=0;u._anchorY=0;u._computedWidth=0;u._computedHeight=0;u._vertexBoundsScaleX=1;u._vertexBoundsScaleY=1;u._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};u.geometryType=b.WGLGeometryType.MARKER;return u}q._inheritsLoose(h,
v);var w=h.prototype;w._write=function(u,k,g,f){const n=k.getDisplayId();u.recordStart(n,this._materialKey,this.geometryType,!0);this._writeGeometry(u,k,n,g,f);u.recordEnd()};w._writeGeometry=function(u,k,g,f,n){if(t.isSome(this._markerPlacement))return this._writePlacedMarkers(u,k,f,n);if(!n&&"esriGeometryPoint"===k.geometryType)return f=k.getX(),k=k.getY(),!u.hasAggregates&&u.hasPixelBufferEnabled&&(0>f||513<=f||0>k||513<=k)?void 0:this._writeVertices(u,g,this._getPos(f,k),f,k);k=n?l.deltaDecodeGeometry(l.convertFromGeometry(n),
2):"esriGeometryPolygon"===k.geometryType?k.readCentroid():k.readGeometryForDisplay();if(!t.isNone(k)){if(k.isPoint){const [z,x]=k.coords;return!u.hasAggregates&&u.hasPixelBufferEnabled&&(0>z||512<=z||0>x||512<=x)?void 0:this._writeVertices(u,g,this._getPos(z,x),z,x)}k.forEachVertex((z,x)=>{const B=2*a.TILE_SIZE;z<-B||z>=B||x<-B||x>=B||this._writeVertices(u,g,this._getPos(z,x),z,x)})}};w._writePlacedMarkers=function(u,k,g,f){f=f??k.readLegacyGeometryForDisplay();if(g=c.CIMMarkerPlacementHelper.getPlacement(f,
t.unwrap(this._markerPlacement),E.pt2px(1),g.geometryEngine)){k=k.getDisplayId();f=m.create();for(var n=A.create(),z=g.next();null!=z;){const x=z.tx,B=-z.ty;-128<=x&&640>=x&&-128<=B&&640>=B&&(this._applyTransformation(n,f,-z.getAngle()/p),this._writeVertices(u,k,this._getPos(x,B),x,B));z=g.next()}}};w._writeVertices=function(u,k,g,f,n){const z=e.MarkerMaterialKey.load(this._materialKey);switch(z.symbologyType){case b.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(u,k,g);default:return this._writeMarkerVertices(u,
k,z,g,f,n)}};w._writeMarkerVertices=function(u,k,g,f,n,z){var x=g.vvRotation;g=u.vertexCount();let B=this._computedWidth*this._vertexBoundsScaleX;var D=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(B=D=Math.max(B,D));x&&(x=Math.max(this.xOffset,this.yOffset),B+=x,D+=x);u.vertexBounds(n+this.xOffset,z-this.yOffset,B,D);u.vertexWrite(f);u.vertexWrite(this._offsetUpperLeft);u.vertexWrite(this._texUpperLeft);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(k);u.vertexWrite(this._fillColor);
u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(f);u.vertexWrite(this._offsetUpperRight);u.vertexWrite(this._texUpperRight);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(k);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(f);u.vertexWrite(this._offsetBottomLeft);u.vertexWrite(this._texBottomLeft);
u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(k);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(f);u.vertexWrite(this._offsetBottomRight);u.vertexWrite(this._texBottomRight);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(k);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();
this._writeIndices(u,g)};w._writeHeatmapVertices=function(u,k,g){const f=u.vertexCount();u.vertexWrite(g);u.vertexWrite(this._offsetUpperLeft);u.vertexWrite(k);u.vertexEnd();u.vertexWrite(g);u.vertexWrite(this._offsetUpperRight);u.vertexWrite(k);u.vertexEnd();u.vertexWrite(g);u.vertexWrite(this._offsetBottomLeft);u.vertexWrite(k);u.vertexEnd();u.vertexWrite(g);u.vertexWrite(this._offsetBottomRight);u.vertexWrite(k);u.vertexEnd();this._writeIndices(u,f)};w._writeIndices=function(u,k){u.indexWrite(k+
0);u.indexWrite(k+1);u.indexWrite(k+2);u.indexWrite(k+1);u.indexWrite(k+3);u.indexWrite(k+2)};w._applyTransformation=function(u,k,g=0){C.fromTranslation(u,m.fromValues(this.xOffset,-this.yOffset));0!==this.angle+g&&C.rotate(u,u,p*(this.angle+g));g=this._computedWidth;const f=this._computedHeight,n=-(.5+this._anchorX)*g,z=-(.5-this._anchorY)*f;y.set(k,n,z);y.transformMat2d(k,k,u);this._offsetUpperLeft=d.i1616to32(16*k[0],16*k[1]);this._offsets.xUpperLeft=k[0];this._offsets.yUpperLeft=k[1];y.set(k,
n+g,z);y.transformMat2d(k,k,u);this._offsetUpperRight=d.i1616to32(16*k[0],16*k[1]);this._offsets.xUpperRight=k[0];this._offsets.yUpperRight=k[1];y.set(k,n,z+f);y.transformMat2d(k,k,u);this._offsetBottomLeft=d.i1616to32(16*k[0],16*k[1]);this._offsets.xBottomLeft=k[0];this._offsets.yBottomLeft=k[1];y.set(k,n+g,z+f);y.transformMat2d(k,k,u);this._offsetBottomRight=d.i1616to32(16*k[0],16*k[1]);this._offsets.xBottomRight=k[0];this._offsets.yBottomRight=k[1]};w._getPos=function(u,k){return d.i1616to32(Math.round(8*
u),Math.round(8*k))};return h}(r)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u,k){function g(F,G){const H=F.length;F.push(null);G.then(J=>F[H]=J);return F}function f(F){return!!(F&1)}const n=C.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),z=[];C={isOutline:!1,placement:null,symbologyType:m.WGLSymbologyType.DEFAULT,vvFlags:0};const x={...y.errorPointSymbolJSON,hash:JSON.stringify(y.errorPointSymbolJSON),materialKey:l.createMaterialKey(m.WGLGeometryType.MARKER,C)},B={...y.errorPolylineSymbolJSON,hash:JSON.stringify(y.errorPolylineSymbolJSON),
materialKey:l.createMaterialKey(m.WGLGeometryType.LINE,C)},D={...y.errorPolygonSymbolJSON,hash:JSON.stringify(y.errorPolygonSymbolJSON),materialKey:l.createMaterialKey(m.WGLGeometryType.FILL,C)};y=function(){function F(H,J){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new h.Lock;this._fetchResource=H;this._tileInfo=J}var G=F.prototype;
G.createTemplateGroup=function(H,J){this._initErrorTemplates();const L=H.hash;if(this._symbolToTemplate.has(L))return this._symbolToTemplate.get(L);const K=[];J&&this._createMeshTemplates(K,J,!0);this._createMeshTemplates(K,H,!1);J=this._createGroupId;var U;if(U="expanded-cim"===H.type)a:{if(H.layers)for(const X of H.layers)if("function"===typeof X.materialHash){U=!0;break a}U=!1}H=J.call(this,U);this._idToTemplateGroup.set(H,K);this._symbolToTemplate.set(L,H);return H};G.getTemplateGroup=function(H){return this._idToTemplateGroup.has(H)?
this._idToTemplateGroup.get(H):z};G.getDynamicTemplateGroup=function(H){if(!this._idToTemplateGroup.has(H))return z;f(H)||n.error("mapview-template-store",`Id ${H} does not refer to a dynamic template`);return this._idToTemplateGroup.get(H)};G.getMosaicItem=function(H,J){const L=this._createTemplateId(),K=new Promise(U=>this._idToResolver.set(L,U));this._fetchQueue.push({symbol:H,id:L,glyphIds:J});return K};G.finalize=function(H){return this._fetchQueue.length||this._lock.isHeld()?h.withLock(this._lock,
this._fetchAllQueuedResources.bind(this),H):Promise.resolve()};G._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],D,!1),marker:this._createMeshTemplates([],x,!1),line:this._createMeshTemplates([],B,!1)})};G._fetchAllQueuedResources=function(H){if(!this._fetchQueue.length)return Promise.resolve();const J=this._fetchQueue,L=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(L).then(()=>this._fetchResource(J,H).then(K=>
{for(const {id:U,mosaicItem:X}of K)this._idToResolver.get(U)(X),this._idToResolver.delete(U)})).catch(K=>{A.isAbortError(K)?this._fetchQueue=this._fetchQueue.concat(J):"worker:port-closed"!==K.name&&n.error(new E("mapview-template-store","Unable to fetch requested texture resources",K))})};G._createGroupId=function(H){return this._idCounter++<<1|(H?1:0)};G._createTemplateId=function(){return this._templateIdCounter++};G._createSMS=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=
yield this.getMosaicItem(J);return w.ok(L,n)?r.fromSimpleMarker(J,L):this._markerError});return function(J){return H.apply(this,arguments)}}();G._createPMS=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=yield this.getMosaicItem(J);return w.ok(L,n)?r.fromPictureMarker(J,L):this._markerError});return function(J){return H.apply(this,arguments)}}();G._createSFS=function(){var H=t._asyncToGenerator(function*(J,L){const {spriteMosaicItem:K}=yield this.getMosaicItem(J);return w.ok(K,
n)?e.fromSimpleFill(J,K,L):this._fillError});return function(J,L){return H.apply(this,arguments)}}();G._createPFS=function(){var H=t._asyncToGenerator(function*(J,L){const {spriteMosaicItem:K}=yield this.getMosaicItem(J);return w.ok(K,n)?e.fromPictureFill(J,K,L):this._fillError});return function(J,L){return H.apply(this,arguments)}}();G._createSLS=function(){var H=t._asyncToGenerator(function*(J,L){({spriteMosaicItem:L}=yield this.getMosaicItem(J));return w.ok(L,n)?p.fromSimpleLine(J,L):this._lineError});
return function(J,L){return H.apply(this,arguments)}}();G._createLMS=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=yield this.getMosaicItem(J);return w.ok(L,n)?r.fromLineSymbolMarker(J,L):this._markerError});return function(J){return H.apply(this,arguments)}}();G._createTS=function(){var H=t._asyncToGenerator(function*(J){const {glyphMosaicItems:L}=yield this.getMosaicItem(J);return v.fromText(J,L)});return function(J){return H.apply(this,arguments)}}();G._createCIMText=
function(){var H=t._asyncToGenerator(function*(J){const {glyphMosaicItems:L}=yield this.getMosaicItem(k.cimLayerToRasterizationInfo(J),u.codepoints(J.text));return w.ok(L,n)?v.fromCIMText(J,L,this._tileInfo):this._textError});return function(J){return H.apply(this,arguments)}}();G._createCIMFill=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=yield this.getMosaicItem(k.cimLayerToRasterizationInfo(J));return w.ok(L,n)?e.fromCIMFill(J,L,this._tileInfo):this._fillError});
return function(J){return H.apply(this,arguments)}}();G._createCIMLine=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=yield this.getMosaicItem(k.cimLayerToRasterizationInfo(J));return w.ok(L,n)?p.fromCIMLine(J,L,this._tileInfo):this._lineError});return function(J){return H.apply(this,arguments)}}();G._createCIMMarker=function(){var H=t._asyncToGenerator(function*(J){const {spriteMosaicItem:L}=yield this.getMosaicItem(k.cimLayerToRasterizationInfo(J));return w.ok(L,n)?
r.fromCIMMarker(J,L,this._tileInfo):this._markerError});return function(J){return H.apply(this,arguments)}}();G._createCIM=function(){var H=t._asyncToGenerator(function*(J){const L=J.templateHash;if(this._cimTemplateCache.has(L))return this._cimTemplateCache.get(L);let K;switch(J.type){case "marker":K=yield this._createCIMMarker(J);break;case "line":K=yield this._createCIMLine(J);break;case "fill":K=yield this._createCIMFill(J);break;case "text":K=yield this._createCIMText(J)}this._cimTemplateCache.set(L,
K);return K});return function(J){return H.apply(this,arguments)}}();G._createDynamicCIM=function(){var H=t._asyncToGenerator(function*(J){const L=J.templateHash;if(this._cimTemplateCache.has(L))return this._cimTemplateCache.get(L);let K;switch(J.type){case "marker":K=b.fromCIMMarker(J,this._tileInfo);break;case "line":K=a.fromCIMLine(J,this._tileInfo);break;case "fill":K=c.fromCIMFill(J,this._tileInfo);break;case "text":K=d.fromCIMText(J,this._tileInfo)}this._cimTemplateCache.set(L,K);return K});
return function(J){return H.apply(this,arguments)}}();G._createPrimitiveMeshTemplates=function(H,J,L){switch(J.type){case "esriSMS":return g(H,this._createSMS(J));case "esriPMS":return g(H,this._createPMS(J));case "esriSFS":return g(H,this._createSFS(J,L));case "line-marker":return g(H,this._createLMS(J));case "esriPFS":return g(H,this._createPFS(J,L));case "esriSLS":return g(H,this._createSLS(J,!1));case "esriTS":return g(H,this._createTS(J));default:return n.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),
H}};G._createMeshTemplates=function(H,J,L){if(J.type.includes("3d"))return n.error("3D symbols are not supported with MapView"),H;if("expanded-cim"===J.type){for(const K of J.layers)"function"===typeof K.materialHash?g(H,this._createDynamicCIM(K)):g(H,this._createCIM(K));return H}if("composite-symbol"===J.type){for(const K of J.layers)this._createPrimitiveMeshTemplates(H,K,L);return H}return"cim"===J.type||"label"===J.type||"web-style"===J.type?H:this._createPrimitiveMeshTemplates(H,J,L)};t._createClass(F,
[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return F}();q.WGLTemplateStore=y;q.errorPointSchema2D=x;q.errorPolygonSchema2D=D;q.errorPolylineSchema2D=B;q.isDynamicId=f;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(q,t,E,C,A,y,m,l,c,a,b,d){return function(e){function p(r,v,h){var w=e.call(this,r)||this;w._minMaxZoom=m.i1616to32(Math.round(v*
A.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(h*A.MIN_MAX_ZOOM_PRECISION_FACTOR));c.isFunction(r.color)?w._dynamicPropertyMap.set("fillColor",(z,x,B)=>(z=r.color(z,x,B))&&C.premultiplyAlphaRGBA(z)||0):(v=r.color,w.fillColor=v&&C.premultiplyAlphaRGBA(v)||0);const u="CIMMarkerPlacementInsidePolygon"===r.cim.placement?.type&&r.cim.placement.shiftOddRows?2:1,k=r.height;c.isFunction(k)?w._dynamicPropertyMap.set("_height",(z,x,B)=>k(z,x,B)*u):w._height=(k||0)*u;const g=r.offsetX;c.isFunction(g)?w._dynamicPropertyMap.set("_offsetX",
(z,x,B)=>E.pt2px(g(z,x,B))):w._offsetX=E.pt2px(g||0);const f=r.offsetY;c.isFunction(f)?w._dynamicPropertyMap.set("_offsetY",(z,x,B)=>E.pt2px(-f(z,x,B))):w._offsetY=E.pt2px(-f||0);v=r.scaleX;c.isFunction(v)?w._dynamicPropertyMap.set("_scaleX",v):w._scaleX=v||1;const n=r.angle;c.isFunction(n)?w._dynamicPropertyMap.set("_angle",(z,x,B)=>y.degToByte(n(z,x,B))):w._angle=y.degToByte(n)||0;t.isSome(r.effects)&&(v=r.effects,c.isFunction(v)?w._dynamicPropertyMap.set("_effects",v):w._effects=v);w._cimFillLayer=
r;w._bitset=(r.colorLocked?A.BITSET_GENERIC_LOCK_COLOR:0)|(r.applyRandomOffset?A.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(r.sampleAlphaOnly?A.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);w._fillMaterialKey=r.materialKey;return w}q._inheritsLoose(p,e);p.fromCIMFill=function(r,v){const [h,w]=c.getMinMaxZoom(r.scaleInfo,v);return new p(r,h,w)};p.prototype.bindFeature=function(r,v,h){const w=r.readLegacyFeature();this._dynamicPropertyMap.forEach((g,f)=>{this[f]=g(w,v,h)});r=l.FillMaterialKey.load(this._fillMaterialKey);
var u=this._materialCache,k=this._cimFillLayer.materialHash;k=k(w,v,h);k=u.get(k);u=null;k&&d.ok(k.spriteMosaicItem)&&(u=k.spriteMosaicItem);if(u){const {rect:g,width:f,height:n}=u;k=g.x+A.SPRITE_PADDING;const z=g.y+A.SPRITE_PADDING,x=k+f,B=z+n;let D=Math.round(E.pt2px(this._height));0>=D&&(D=B-z);let F=Math.round(E.pt2px(this._height/n*f||0));0>=F&&(F=x-k);const G=this._scaleX;this.tl=m.i1616to32(k,z);this.br=m.i1616to32(x,B);this.aux21=m.i1616to32(F,D);this.aux22=m.i1616to32(this._offsetX,this._offsetY);
this.aux3=m.i8888to32(128*G,128,this._angle,0);r.sdf=u.sdf;r.pattern=!0;r.textureBinding=u.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,r.sdf=!1,r.pattern=!1,r.textureBinding=0;this._materialKey=r.data};return p}(a(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c){return a=>function(b){function d(...p){p=b.call(this,...p)||this;p.forceLibtess=!1;p._bitset=0;p._lineTemplate=null;p.geometryType=C.WGLGeometryType.FILL;return p}q._inheritsLoose(d,b);var e=d.prototype;e._maybeAddLineTemplate=function(p){this._lineTemplate=c.fromFillOutline(p)};e._write=function(p,r,v,h){v="esriGeometryPoint"===r.geometryType;const w=m.FillMaterialKey.load(this._materialKey);p.recordStart(r.getDisplayId(),this._materialKey,this.geometryType,v);this._writeGeometry(p,
r,w,h,v);m.hasOutlineFillSymbology(w)&&t.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(p,r,h,v);p.recordEnd()};e._writeGeometry=function(p,r,v,h,w){h=this._getGeometry(r,h,w);t.isNone(h)||(w=[],100<h.maxLength||this.forceLibtess||!l.triangulate(w,h)?(h=l.triangulateLibtess(h),this._writeVertices(p,r,h,[h.length/2],v)):w.length&&this._writeVertices(p,r,h.coords,h.lengths,v,w))};e._writeVertex=function(p,r,v,h,w,u){const k=A.i1616to32(1*h,1*w);p.vertexBounds(h,w,0,0);p.vertexWrite(k);
p.vertexWrite(r);v.symbologyType===C.WGLSymbologyType.DOT_DENSITY?p.vertexWriteF32(1/Math.abs(u.readGeometryArea())):(p.vertexWrite(this.fillColor),r=m.hasSimpleSymbology(v),r||(p.vertexWrite(this.tl),p.vertexWrite(this.br)),p.vertexWrite(this.aux21),p.vertexWrite(this.aux22),p.vertexWrite(this.aux3),r||p.vertexWrite(this._minMaxZoom))};e._writeVertices=function(p,r,v,h,w,u){var k=r.getDisplayId();k|=this._bitset<<24;var g=h.reduce((n,z)=>n+z);const f=y.getStrides(w.geometryType,w.symbologyType).geometry/
4;h=p.vertexCount();p.vertexEnsureSize(f*g);g=0;if(u)for(const n of u)this._writeVertex(p,k,w,v[2*n],v[2*n+1],r),g++;else for(u=0;u<v.length;u+=2)this._writeVertex(p,k,w,Math.round(v[u]),Math.round(v[u+1]),r),g++;p.indexEnsureSize(g);for(r=0;r<g;r++)p.indexWrite(r+h)};e._getGeometry=function(p,r,v){return(p=r?E.deltaDecodeGeometry(E.convertFromGeometry(r),2):p.readGeometryForDisplay())?l.clipMarshall(p,v?256:8):null};return d}(a)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(q,t,E,C,A,y,m,l,c){function a(p,r,v){let h=0;for(let w=1;w<v;w++)h+=(p[2*(r+w)]-p[2*(r+w-1)])*(p[2*(r+w)+1]+p[2*(r+w-1)+1]);return h}function b(p,r,v,h,w){let u=0;for(;v<h;v+=3){const k=2*(p[v]-w),g=2*(p[v+1]-w),f=2*(p[v+2]-w);u+=Math.abs((r[k]-r[f])*(r[g+1]-r[k+1])-(r[k]-r[g])*(r[f+1]-r[k+1]))}return u}const d=new l.TileClipper(0,0,0,1,0),e=new l.TileClipper(0,0,0,1,0);d.setExtent(y.TILE_SIZE);e.setExtent(y.TILE_SIZE);q.area=a;q.clipLinesMarshall=function(p,r){e.setPixelMargin(r);const v=
-r;r=y.TILE_SIZE+r;let h=[];var w=!1;let u=0;for(;u<p.length;){const k=[],g=p[u];if(!g)return null;e.reset(m.GeometryType.LineString);let [f,n]=g[0];if(w)e.moveTo(f,n);else{if(f<v||f>r||n<v||n>r){w=!0;continue}k.push({x:f,y:n})}let z=!1;const x=g.length;for(let B=1;B<x;++B)if(f+=g[B][0],n+=g[B][1],w)e.lineTo(f,n);else{if(f<v||f>r||n<v||n>r){z=!0;break}k.push({x:f,y:n})}if(z)w=!0;else{if(w){if(w=e.resultWithStarts())for(const B of w)h.push(B)}else h.push({line:k,start:0});u++;w=!1}}h=h.filter(k=>1<
k.line.length);return 0===h.length?null:h};q.clipMarshall=function(p,r){if(t.isNone(p))return null;a:{var v=y.TILE_SIZE+128;var h=0;for(var w=0;w<p.lengths.length;w++){var u=p.lengths[w];for(var k=0;k<u;k++){const g=p.coords[2*(k+h)],f=p.coords[2*(k+h)+1];if(-128>g||g>v||-128>f||f>v){v=!0;break a}}h+=u}v=!1}if(!v)return p;d.setPixelMargin(r);d.reset(m.GeometryType.Polygon);r=0;for(v=0;v<p.lengths.length;v++){h=p.lengths[v];w=p.coords[2*(0+r)];u=p.coords[2*(0+r)+1];d.moveTo(w,u);for(k=1;k<h;k++)w=
p.coords[2*(k+r)],u=p.coords[2*(k+r)+1],d.lineTo(w,u);d.close();r+=h}v=d.result(!1);if(!v)return null;p=[];r=[];for(const g of v){v=0;for(const f of g)r.push(f.x),r.push(f.y),v++;p.push(v)}return new A(p,r)};q.triangleAreaArray=b;q.triangulate=function(p,r){const {coords:v,lengths:h,hasIndeterminateRingOrder:w}=r;if(w)return!1;r=0;for(var u=0;u<h.length;){let f=u,n=h[u];u=a(v,r,n);for(var k=[];++f<h.length;){var g=h[f];const z=a(v,r+n,g);if(!(0<z))break;u+=z;k.push(r+n);n+=g}g=p.length;c.bufcut(p,
v,r,r+n,k,2,0);k=b(p,v,g,p.length,0);u=Math.abs(u);if(1E-5<Math.abs((k-u)/Math.max(1E-7,u)))return p.length=0,!1;u=f;r+=n}return!0};q.triangulateEarcut=function(p,r,v){const {coords:h,lengths:w,hasIndeterminateRingOrder:u}=r;if(u)return!1;let k=0;for(var g=0;g<w.length;){let n=g,z=w[g];for(g=[];++n<w.length;){var f=w[n];if(!(0<a(h,k+z,f)))break;g.push(k+z-k);z+=f}f=r.coords.slice(2*k,2*(k+z));g=E.earcut(f,g,2);for(const x of g)p.push(x+v+k);g=n;k+=z}return!0};q.triangulateLibtess=function(p){const {coords:r,
lengths:v}=p;({buffer:p}=C.triangulate(r,v));return p};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/earcut":function(){define(["exports"],function(q){var t={exports:{}};(function(E){(function(C){C=C();void 0!==C&&(E.exports=C)})(function(){function C(x,B,D){D=D||2;var F=B&&B.length,G=F?B[0]*D:x.length,H=A(x,0,G,D,!0),J=[];if(!H||H.next===H.prev)return J;var L;if(F){var K=H;var U=D;H=[];var X;F=0;for(X=B.length;F<X;F++){var Z=B[F]*U;var aa=
F<X-1?B[F+1]*U:x.length;Z=A(x,Z,aa,U,!1);Z===Z.next&&(Z.steiner=!0);aa=H;var da=aa.push,R=Z,M=Z;do{if(R.x<M.x||R.x===M.x&&R.y<M.y)M=R;R=R.next}while(R!==Z);da.call(aa,M)}H.sort(c);for(F=0;F<H.length;F++)U=H[F],B=K,(K=b(U,B))?(X=k(K,U),U=y(K,K.next),X=a(X),y(X,X.next),U=a(U),K=a(B===K?U:B)):K=B,K=y(K,K.next);H=K}if(x.length>80*D){var Q=L=x[0];var N=F=x[1];for(U=D;U<G;U+=D)B=x[U],K=x[U+1],B<Q&&(Q=B),K<N&&(N=K),B>L&&(L=B),K>F&&(F=K);L=Math.max(L-Q,F-N);L=0!==L?1/L:0}m(H,J,D,Q,N,L);return J}function A(x,
B,D,F,G){if(G===0<z(x,B,D,F))for(G=B;G<D;G+=F)var H=g(G,x[G],x[G+1],H);else for(G=D-F;G>=B;G-=F)H=g(G,x[G],x[G+1],H);H&&r(H,H.next)&&(x=H.next,f(H),H=x);return H}function y(x,B){if(!x)return x;B||(B=x);do{var D=!1;if(x.steiner||!r(x,x.next)&&0!==p(x.prev,x,x.next))x=x.next;else{B=x.prev;f(x);x=B;if(x===x.next)break;D=!0}}while(D||x!==B);return B}function m(x,B,D,F,G,H,J){if(x){if(!J&&H){var L=x,K=L;do null===K.z&&(K.z=d(K.x,K.y,F,G,H)),K.prevZ=K.prev,K=K.nextZ=K.next;while(K!==L);K.prevZ.nextZ=null;
K.prevZ=null;L=K;var U,X,Z,aa,da=1;do{K=L;var R=L=null;for(X=0;K;){X++;var M=K;for(U=Z=0;U<da&&(Z++,M=M.nextZ,M);U++);for(aa=da;0<Z||0<aa&&M;)0!==Z&&(0===aa||!M||K.z<=M.z)?(U=K,K=K.nextZ,Z--):(U=M,M=M.nextZ,aa--),R?R.nextZ=U:L=U,U.prevZ=R,R=U;K=M}R.nextZ=null;da*=2}while(1<X)}for(L=x;x.prev!==x.next;){K=x.prev;M=x.next;if(H)R=l(x,F,G,H);else a:if(R=x,X=R.prev,Z=R,da=R.next,0<=p(X,Z,da))R=!1;else{for(U=R.next.next;U!==R.prev;){if(e(X.x,X.y,Z.x,Z.y,da.x,da.y,U.x,U.y)&&0<=p(U.prev,U,U.next)){R=!1;break a}U=
U.next}R=!0}if(R)B.push(K.i/D),B.push(x.i/D),B.push(M.i/D),f(x),L=x=M.next;else if(x=M,x===L){if(!J)m(y(x),B,D,F,G,H,1);else if(1===J){x=y(x);J=B;L=D;K=x;do M=K.prev,R=K.next.next,!r(M,R)&&v(M,K,K.next,R)&&u(M,R)&&u(R,M)&&(J.push(M.i/L),J.push(K.i/L),J.push(R.i/L),f(K),f(K.next),K=x=R),K=K.next;while(K!==x);x=y(K);m(x,B,D,F,G,H,2)}else if(2===J)a:{J=x;do{for(L=J.next.next;L!==J.prev;){if(K=J.i!==L.i){R=R=R=R=void 0;K=J;M=L;if(R=K.next.i!==M.i&&K.prev.i!==M.i){b:{R=K;do{if(R.i!==K.i&&R.next.i!==K.i&&
R.i!==M.i&&R.next.i!==M.i&&v(R,R.next,K,M)){R=!0;break b}R=R.next}while(R!==K);R=!1}R=!R}if(R){if(R=u(K,M)&&u(M,K)){R=K;X=!1;Z=(K.x+M.x)/2;da=(K.y+M.y)/2;do R.y>da!==R.next.y>da&&R.next.y!==R.y&&Z<(R.next.x-R.x)*(da-R.y)/(R.next.y-R.y)+R.x&&(X=!X),R=R.next;while(R!==K);R=X}R=R&&(p(K.prev,K,M.prev)||p(K,M.prev,M))||r(K,M)&&0<p(K.prev,K,K.next)&&0<p(M.prev,M,M.next)}K=R}if(K){x=k(J,L);J=y(J,J.next);x=y(x,x.next);m(J,B,D,F,G,H);m(x,B,D,F,G,H);break a}L=L.next}J=J.next}while(J!==x)}break}}}}function l(x,
B,D,F){var G=x.prev,H=x.next;if(0<=p(G,x,H))return!1;var J=G.x>x.x?G.x>H.x?G.x:H.x:x.x>H.x?x.x:H.x,L=G.y>x.y?G.y>H.y?G.y:H.y:x.y>H.y?x.y:H.y,K=d(G.x<x.x?G.x<H.x?G.x:H.x:x.x<H.x?x.x:H.x,G.y<x.y?G.y<H.y?G.y:H.y:x.y<H.y?x.y:H.y,B,D,F);B=d(J,L,B,D,F);D=x.prevZ;for(F=x.nextZ;D&&D.z>=K&&F&&F.z<=B;){if(D!==x.prev&&D!==x.next&&e(G.x,G.y,x.x,x.y,H.x,H.y,D.x,D.y)&&0<=p(D.prev,D,D.next))return!1;D=D.prevZ;if(F!==x.prev&&F!==x.next&&e(G.x,G.y,x.x,x.y,H.x,H.y,F.x,F.y)&&0<=p(F.prev,F,F.next))return!1;F=F.nextZ}for(;D&&
D.z>=K;){if(D!==x.prev&&D!==x.next&&e(G.x,G.y,x.x,x.y,H.x,H.y,D.x,D.y)&&0<=p(D.prev,D,D.next))return!1;D=D.prevZ}for(;F&&F.z<=B;){if(F!==x.prev&&F!==x.next&&e(G.x,G.y,x.x,x.y,H.x,H.y,F.x,F.y)&&0<=p(F.prev,F,F.next))return!1;F=F.nextZ}return!0}function c(x,B){return x.x-B.x}function a(x){if(x.next.prev===x)return x;let B=x;do{const D=B.next;if(D.prev===B||D===B||D===x)break;B=D}while(1);return B}function b(x,B){var D=B,F=x.x,G=x.y,H=-Infinity;do{if(G<=D.y&&G>=D.next.y&&D.next.y!==D.y){var J=D.x+(G-
D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(J<=F&&J>H){H=J;if(J===F){if(G===D.y)return D;if(G===D.next.y)return D.next}var L=D.x<D.next.x?D:D.next}}D=D.next}while(D!==B);if(!L)return null;if(F===H)return L;B=L;J=L.x;var K=L.y,U=Infinity;D=L;do{if(F>=D.x&&D.x>=J&&F!==D.x&&e(G<K?F:H,G,J,K,G<K?H:F,G,D.x,D.y)){var X=Math.abs(G-D.y)/(F-D.x);var Z;if((Z=u(D,x))&&!(Z=X<U)&&(Z=X===U)&&!(Z=D.x>L.x)&&(Z=D.x===L.x)){Z=L;var aa=D;Z=0>p(Z.prev,Z,aa.prev)&&0>p(aa.next,Z,Z.next)}Z&&(L=D,U=X)}D=D.next}while(D!==B);return L}
function d(x,B,D,F,G){x=32767*(x-D)*G;B=32767*(B-F)*G;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;B=(B|B<<8)&16711935;B=(B|B<<4)&252645135;B=(B|B<<2)&858993459;return(x|x<<1)&1431655765|((B|B<<1)&1431655765)<<1}function e(x,B,D,F,G,H,J,L){return 0<=(G-J)*(B-L)-(x-J)*(H-L)&&0<=(x-J)*(F-L)-(D-J)*(B-L)&&0<=(D-J)*(H-L)-(G-J)*(F-L)}function p(x,B,D){return(B.y-x.y)*(D.x-B.x)-(B.x-x.x)*(D.y-B.y)}function r(x,B){return x.x===B.x&&x.y===B.y}function v(x,B,D,F){var G=w(p(x,B,D)),H=w(p(x,
B,F)),J=w(p(D,F,x)),L=w(p(D,F,B));return G!==H&&J!==L||0===G&&h(x,D,B)||0===H&&h(x,F,B)||0===J&&h(D,x,F)||0===L&&h(D,B,F)?!0:!1}function h(x,B,D){return B.x<=Math.max(x.x,D.x)&&B.x>=Math.min(x.x,D.x)&&B.y<=Math.max(x.y,D.y)&&B.y>=Math.min(x.y,D.y)}function w(x){return 0<x?1:0>x?-1:0}function u(x,B){return 0>p(x.prev,x,x.next)?0<=p(x,B,x.next)&&0<=p(x,x.prev,B):0>p(x,B,x.prev)||0>p(x,x.next,B)}function k(x,B){var D=new n(x.i,x.x,x.y),F=new n(B.i,B.x,B.y),G=x.next,H=B.prev;x.next=B;B.prev=x;D.next=
G;G.prev=D;F.next=D;D.prev=F;H.next=F;F.prev=H;return F}function g(x,B,D,F){x=new n(x,B,D);F?(x.next=F.next,x.prev=F,F.next.prev=x,F.next=x):(x.prev=x,x.next=x);return x}function f(x){x.next.prev=x.prev;x.prev.next=x.next;x.prevZ&&(x.prevZ.nextZ=x.nextZ);x.nextZ&&(x.nextZ.prevZ=x.prevZ)}function n(x,B,D){this.i=x;this.x=B;this.y=D;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function z(x,B,D,F){for(var G=0,H=D-F;B<D;B+=F)G+=(x[H]-x[B])*(x[B+1]+x[H+1]),H=B;return G}C.deviation=
function(x,B,D,F){var G=B&&B.length,H=Math.abs(z(x,0,G?B[0]*D:x.length,D));if(G){G=0;for(var J=B.length;G<J;G++)H-=Math.abs(z(x,B[G]*D,G<J-1?B[G+1]*D:x.length,D))}for(G=B=0;G<F.length;G+=3){J=F[G]*D;var L=F[G+1]*D,K=F[G+2]*D;B+=Math.abs((x[J]-x[K])*(x[L+1]-x[J+1])-(x[J]-x[L])*(x[K+1]-x[J+1]))}return 0===H&&0===B?0:Math.abs((B-H)/H)};C.flatten=function(x){for(var B=x[0][0].length,D={vertices:[],holes:[],dimensions:B},F=0,G=0;G<x.length;G++){for(var H=0;H<x[G].length;H++)for(var J=0;J<B;J++)D.vertices.push(x[G][H][J]);
0<G&&(F+=x[G-1].length,D.holes.push(F))}return D};return C})})(t);q.earcut=t.exports})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],function(q){let t=function(){function E(A,y){this.x=A;this.y=y}var C=E.prototype;C.clone=function(){return new E(this.x,this.y)};C.equals=function(A,y){return A===this.x&&y===this.y};C.isEqual=function(A){return A.x===this.x&&A.y===this.y};C.setCoords=function(A,y){this.x=A;this.y=y};C.normalize=function(){var A=this.x;const y=this.y;A=Math.sqrt(A*
A+y*y);this.x/=A;this.y/=A};C.rightPerpendicular=function(){const A=this.x;this.x=this.y;this.y=-A};C.move=function(A,y){this.x+=A;this.y+=y};C.assign=function(A){this.x=A.x;this.y=A.y};C.assignAdd=function(A,y){this.x=A.x+y.x;this.y=A.y+y.y};C.assignSub=function(A,y){this.x=A.x-y.x;this.y=A.y-y.y};C.rotate=function(A,y){const m=this.x,l=this.y;this.x=m*A-l*y;this.y=m*y+l*A};C.scale=function(A){this.x*=A;this.y*=A};C.length=function(){const A=this.x,y=this.y;return Math.sqrt(A*A+y*y)};E.distance=
function(A,y){const m=y.x-A.x;A=y.y-A.y;return Math.sqrt(m*m+A*A)};E.add=function(A,y){return new E(A.x+y.x,A.y+y.y)};E.sub=function(A,y){return new E(A.x-y.x,A.y-y.y)};return E}();q.GeometryType=void 0;(function(E){E[E.Unknown=0]="Unknown";E[E.Point=1]="Point";E[E.LineString=2]="LineString";E[E.Polygon=3]="Polygon"})(q.GeometryType||(q.GeometryType={}));q.Point=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","./definitions","./Geometry","./GeometryUtils"],function(q,t,E,C,A){let y=function(b,d,e){this.ratio=b;this.x=d;this.y=e},m=function(){function b(e,p,r,v=8,h=8){this._lines=[];this._starts=[];this.validateTessellation=!0;this._pixelRatio=v;this._pixelMargin=h;this._tileSize=E.TILE_SIZE*v;this._dz=e;this._yPos=p;this._xPos=r}var d=b.prototype;d.setPixelMargin=function(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))};d.setExtent=
function(e){this._extent=e;this._finalRatio=this._tileSize/e*(1<<this._dz);let p=this._pixelRatio*this._pixelMargin;p/=this._finalRatio;e>>=this._dz;p>e&&(p=e);this._margin=p;this._xmin=e*this._xPos-p;this._ymin=e*this._yPos-p;this._xmax=this._xmin+e+2*p;this._ymax=this._ymin+e+2*p};d.reset=function(e){this._type=e;this._lines=[];this._starts=[];this._line=null;this._start=0};d.moveTo=function(e,p){this._pushLine();this._prevIsIn=this._isIn(e,p);this._moveTo(e,p,this._prevIsIn);this._prevPt=new C.Point(e,
p);this._firstPt=new C.Point(e,p);this._dist=0};d.lineTo=function(e,p){const r=this._isIn(e,p),v=new C.Point(e,p),h=C.Point.distance(this._prevPt,v);if(r)if(this._prevIsIn)this._lineTo(e,p,!0);else{var w=this._prevPt;var u=v;e=this._intersect(u,w);this._start=this._dist+h*(1-this._r);this._lineTo(e.x,e.y,!0);this._lineTo(u.x,u.y,!0)}else if(this._prevIsIn)u=this._prevPt,w=v,e=this._intersect(u,w),this._lineTo(e.x,e.y,!0),this._lineTo(w.x,w.y,!1);else{const g=this._prevPt;if(!(g.x<=this._xmin&&v.x<=
this._xmin||g.x>=this._xmax&&v.x>=this._xmax||g.y<=this._ymin&&v.y<=this._ymin||g.y>=this._ymax&&v.y>=this._ymax)){e=[];if(g.x<this._xmin&&v.x>this._xmin||g.x>this._xmin&&v.x<this._xmin){p=(this._xmin-g.x)/(v.x-g.x);var k=g.y+p*(v.y-g.y);k<=this._ymin?u=!1:k>=this._ymax?u=!0:e.push(new y(p,this._xmin,k))}if(g.x<this._xmax&&v.x>this._xmax||g.x>this._xmax&&v.x<this._xmax)p=(this._xmax-g.x)/(v.x-g.x),k=g.y+p*(v.y-g.y),k<=this._ymin?u=!1:k>=this._ymax?u=!0:e.push(new y(p,this._xmax,k));if(g.y<this._ymin&&
v.y>this._ymin||g.y>this._ymin&&v.y<this._ymin)p=(this._ymin-g.y)/(v.y-g.y),k=g.x+p*(v.x-g.x),k<=this._xmin?w=!1:k>=this._xmax?w=!0:e.push(new y(p,k,this._ymin));if(g.y<this._ymax&&v.y>this._ymax||g.y>this._ymax&&v.y<this._ymax)p=(this._ymax-g.y)/(v.y-g.y),k=g.x+p*(v.x-g.x),k<=this._xmin?w=!1:k>=this._xmax?w=!0:e.push(new y(p,k,this._ymax));if(0===e.length)w?u?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):u?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,
this._ymin,!0);else if(1<e.length&&e[0].ratio>e[1].ratio)this._start=this._dist+h*e[1].ratio,this._lineTo(e[1].x,e[1].y,!0),this._lineTo(e[0].x,e[0].y,!0);else for(this._start=this._dist+h*e[0].ratio,w=0;w<e.length;w++)this._lineTo(e[w].x,e[w].y,!0)}this._lineTo(v.x,v.y,!1)}this._dist+=h;this._prevIsIn=r;this._prevPt=v};d.close=function(){if(2<this._line.length){var e=this._firstPt,p=this._prevPt;e.x===p.x&&e.y===p.y||this.lineTo(e.x,e.y);e=this._line;for(p=e.length;4<=p;)if(e[0].x===e[1].x&&e[0].x===
e[p-2].x||e[0].y===e[1].y&&e[0].y===e[p-2].y)e.pop(),e[0].x=e[p-2].x,e[0].y=e[p-2].y,--p;else break}};d.result=function(e=!0){this._pushLine();if(0===this._lines.length)return null;this._type===C.GeometryType.Polygon&&e&&a.simplify(this._tileSize,this._margin*this._finalRatio,this._lines);return this._lines};d.resultWithStarts=function(){if(this._type!==C.GeometryType.LineString)throw Error("Only valid for lines");this._pushLine();const e=this._lines,p=e.length;if(0===p)return null;const r=[];for(let v=
0;v<p;v++)r.push({line:e[v],start:this._starts[v]||0});return r};d._isIn=function(e,p){return e>=this._xmin&&e<=this._xmax&&p>=this._ymin&&p<=this._ymax};d._intersect=function(e,p){let r,v,h;if(p.x>=this._xmin&&p.x<=this._xmax)v=p.y<=this._ymin?this._ymin:this._ymax,h=(v-e.y)/(p.y-e.y),r=e.x+h*(p.x-e.x);else if(p.y>=this._ymin&&p.y<=this._ymax)r=p.x<=this._xmin?this._xmin:this._xmax,h=(r-e.x)/(p.x-e.x),v=e.y+h*(p.y-e.y);else{v=p.y<=this._ymin?this._ymin:this._ymax;r=p.x<=this._xmin?this._xmin:this._xmax;
const w=(r-e.x)/(p.x-e.x),u=(v-e.y)/(p.y-e.y);w<u?(h=w,v=e.y+w*(p.y-e.y)):(h=u,r=e.x+u*(p.x-e.x))}this._r=h;return new C.Point(r,v)};d._pushLine=function(){this._line&&(this._type===C.GeometryType.Point?0<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===C.GeometryType.LineString?1<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===C.GeometryType.Polygon&&3<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)));
this._line=[];this._start=0};d._moveTo=function(e,p,r){this._type!==C.GeometryType.Polygon?r&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),p=Math.round((p-(this._ymin+this._margin))*this._finalRatio),this._line.push(new C.Point(e,p))):(r||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),p<this._ymin&&(p=this._ymin),p>this._ymax&&(p=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),p=Math.round((p-(this._ymin+this._margin))*this._finalRatio),this._line.push(new C.Point(e,
p)),this._isV=this._isH=!1)};d._lineTo=function(e,p,r){if(this._type!==C.GeometryType.Polygon)if(r){e=Math.round((e-(this._xmin+this._margin))*this._finalRatio);p=Math.round((p-(this._ymin+this._margin))*this._finalRatio);if(0<this._line.length&&(r=this._line[this._line.length-1],r.equals(e,p)))return;this._line.push(new C.Point(e,p))}else this._line&&0<this._line.length&&this._pushLine();else if(r||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),p<this._ymin&&(p=this._ymin),p>this._ymax&&
(p=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),p=Math.round((p-(this._ymin+this._margin))*this._finalRatio),this._line&&0<this._line.length){r=this._line[this._line.length-1];const v=r.x===e,h=r.y===p;v&&h||(this._isH&&v?(r.x=e,r.y=p,r=this._line[this._line.length-2],r.x===e&&r.y===p?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(r=this._line[this._line.length-2],this._isH=r.x===e,this._isV=r.y===p)):(this._isH=r.x===e,this._isV=r.y===p)):this._isV&&h?
(r.x=e,r.y=p,r=this._line[this._line.length-2],r.x===e&&r.y===p?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(r=this._line[this._line.length-2],this._isH=r.x===e,this._isV=r.y===p)):(this._isH=r.x===e,this._isV=r.y===p)):(this._line.push(new C.Point(e,p)),this._isH=v,this._isV=h))}else this._line.push(new C.Point(e,p))};return b}(),l=function(){function b(){}var d=b.prototype;d.setExtent=function(e){this._ratio=4096===e?1:4096/e};d.reset=function(e){this._lines=[];this._line=null};
d.moveTo=function(e,p){this._line&&this._lines.push(this._line);this._line=[];const r=this._ratio;this._line.push(new C.Point(e*r,p*r))};d.lineTo=function(e,p){const r=this._ratio;this._line.push(new C.Point(e*r,p*r))};d.close=function(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])};d.result=function(){this._line&&this._lines.push(this._line);return 0===this._lines.length?null:this._lines};t._createClass(b,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return b}();
var c;(function(b){b[b.sideLeft=0]="sideLeft";b[b.sideRight=1]="sideRight";b[b.sideTop=2]="sideTop";b[b.sideBottom=3]="sideBottom"})(c||(c={}));let a=function(){function b(){}b.simplify=function(d,e,p){if(p){var r=-e,v=d+e,h=-e,w=d+e;d=[];e=[];var u=p.length;for(let k=0;k<u;++k){const g=p[k];if(!g||2>g.length)continue;let f=g[0],n;const z=g.length;for(let x=1;x<z;++x)n=g[x],f.x===n.x&&(f.x<=r&&(f.y>n.y?(d.push(k),d.push(x),d.push(c.sideLeft),d.push(-1)):(e.push(k),e.push(x),e.push(c.sideLeft),e.push(-1))),
f.x>=v&&(f.y<n.y?(d.push(k),d.push(x),d.push(c.sideRight),d.push(-1)):(e.push(k),e.push(x),e.push(c.sideRight),e.push(-1)))),f.y===n.y&&(f.y<=h&&(f.x<n.x?(d.push(k),d.push(x),d.push(c.sideTop),d.push(-1)):(e.push(k),e.push(x),e.push(c.sideTop),e.push(-1))),f.y>=w&&(f.x>n.x?(d.push(k),d.push(x),d.push(c.sideBottom),d.push(-1)):(e.push(k),e.push(x),e.push(c.sideBottom),e.push(-1)))),f=n}0!==d.length&&0!==e.length&&(b.fillParent(p,e,d),b.fillParent(p,d,e),r=[],b.calcDeltas(r,e,d),b.calcDeltas(r,d,e),
b.addDeltas(r,p))}};b.fillParent=function(d,e,p){const r=p.length,v=e.length;for(let g=0;g<v;g+=4){var h=e[g],w=e[g+1];const f=e[g+2],n=d[h][w-1];h=d[h][w];w=8092;let z=-1;for(let x=0;x<r;x+=4){if(p[x+2]!==f)continue;var u=p[x];const B=p[x+1];var k=d[u][B-1];u=d[u][B];switch(f){case c.sideLeft:case c.sideRight:A.between(n.y,k.y,u.y)&&A.between(h.y,k.y,u.y)&&(k=Math.abs(u.y-k.y),k<w&&(w=k,z=x));break;case c.sideTop:case c.sideBottom:A.between(n.x,k.x,u.x)&&A.between(h.x,k.x,u.x)&&(k=Math.abs(u.x-k.x),
k<w&&(w=k,z=x))}}e[g+3]=z}};b.calcDeltas=function(d,e,p){const r=e.length;for(let v=0;v<r;v+=4){const h=b.calcDelta(v,e,p,[]);d.push(e[v]);d.push(e[v+1]);d.push(e[v+2]);d.push(h)}};b.calcDelta=function(d,e,p,r){d=e[d+3];if(-1===d)return 0;const v=r.length;if(1<v&&r[v-2]===d)return 0;r.push(d);return b.calcDelta(d,p,e,r)+1};b.addDeltas=function(d,e){const p=d.length;let r=0;for(var v=0;v<p;v+=4){var h=d[v+3];h>r&&(r=h)}for(v=0;v<p;v+=4){h=e[d[v]];const w=d[v+1],u=r-d[v+3];switch(d[v+2]){case c.sideLeft:h[w-
1].x-=u;h[w].x-=u;1===w&&(h[h.length-1].x-=u);w===h.length-1&&(h[0].x-=u);break;case c.sideRight:h[w-1].x+=u;h[w].x+=u;1===w&&(h[h.length-1].x+=u);w===h.length-1&&(h[0].x+=u);break;case c.sideTop:h[w-1].y-=u;h[w].y-=u;1===w&&(h[h.length-1].y-=u);w===h.length-1&&(h[0].y-=u);break;case c.sideBottom:h[w-1].y+=u,h[w].y+=u,1===w&&(h[h.length-1].y+=u),w===h.length-1&&(h[0].y+=u)}}};return b}();q.SimpleBuilder=l;q.TileClipper=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(q){function t(g,f,n,z,x,B,D){let F;n=0;for(let G=z,H=x-B;G<x;G+=B)n+=(g[H+f*B]-g[G+f*B])*(g[G+1+f*B]+g[H+1+f*B]),H=G;if(D===0<n)for(;z<x;z+=B)F=y(z+f*B,g[z+f*B],g[z+1+f*B],F);else for(x-=B;x>=z;x-=B)F=y(x+f*B,g[x+f*B],g[x+1+f*B],F);F&&r(F,F.next)&&(m(F),F=F.next);return F}function E(g,f=g){if(!g)return g;let n;do if(n=!1,g.steiner||!r(g,g.next)&&0!==a(g.prev,g,g.next))g=g.next;else{m(g);g=f=g.prev;if(g===g.next)break;
n=!0}while(n||g!==f);return f}function C(g,f,n,z,x,B,D,F){if(g){!F&&B&&(g=c(g,z,x,B));for(var G=g;g.prev!==g.next;){var H=g.prev,J=g.next;if(B)var L=A(g,z,x,B);else a:{L=g;var K=L.prev,U=L;const X=L.next;if(0<=a(K,U,X)){L=!1;break a}let Z=L.next.next;const aa=Z;let da=0;for(;Z!==L.prev&&(0===da||Z!==aa);){da++;if(d(K.x,K.y,U.x,U.y,X.x,X.y,Z.x,Z.y)&&0<=a(Z.prev,Z,Z.next)){L=!1;break a}Z=Z.next}L=!0}if(L)f.push(H.index/n+D),f.push(g.index/n+D),f.push(J.index/n+D),m(g),G=g=J.next;else if(g=J,g===G){if(!F)C(E(g),
f,n,z,x,B,D,1);else if(1===F){F=f;G=n;H=D;J=g;do L=J.prev,K=J.next.next,!r(L,K)&&b(L,J,J.next,K)&&e(L,K)&&e(K,L)&&(F.push(L.index/G+H),F.push(J.index/G+H),F.push(K.index/G+H),m(J),m(J.next),J=g=K),J=J.next;while(J!==g);g=J;C(g,f,n,z,x,B,D,2)}else if(2===F)a:{F=g;do{for(G=F.next.next;G!==F.prev;){if(H=F.index!==G.index){L=L=L=void 0;H=F;J=G;if(L=H.next.index!==J.index&&H.prev.index!==J.index){b:{L=H;do{if(L.index!==H.index&&L.next.index!==H.index&&L.index!==J.index&&L.next.index!==J.index&&b(L,L.next,
H,J)){L=!0;break b}L=L.next}while(L!==H);L=!1}L=!L}if(L=L&&e(H,J)&&e(J,H)){L=H;K=!1;U=(H.x+J.x)/2;J=(H.y+J.y)/2;do L.y>J!==L.next.y>J&&L.next.y!==L.y&&U<(L.next.x-L.x)*(J-L.y)/(L.next.y-L.y)+L.x&&(K=!K),L=L.next;while(L!==H);L=K}H=L}if(H){g=h(F,G);F=E(F,F.next);g=E(g,g.next);C(F,f,n,z,x,B,D,0);C(g,f,n,z,x,B,D,0);break a}G=G.next}F=F.next}while(F!==g)}break}}}}function A(g,f,n,z){const x=g.prev,B=g.next;if(0<=a(x,g,B))return!1;const D=x.x>g.x?x.x>B.x?x.x:B.x:g.x>B.x?g.x:B.x,F=x.y>g.y?x.y>B.y?x.y:B.y:
g.y>B.y?g.y:B.y,G=p(x.x<g.x?x.x<B.x?x.x:B.x:g.x<B.x?g.x:B.x,x.y<g.y?x.y<B.y?x.y:B.y:g.y<B.y?g.y:B.y,f,n,z);f=p(D,F,f,n,z);n=g.prevZ;for(z=g.nextZ;n&&n.z>=G&&z&&z.z<=f;){if(n!==g.prev&&n!==g.next&&d(x.x,x.y,g.x,g.y,B.x,B.y,n.x,n.y)&&0<=a(n.prev,n,n.next))return!1;n=n.prevZ;if(z!==g.prev&&z!==g.next&&d(x.x,x.y,g.x,g.y,B.x,B.y,z.x,z.y)&&0<=a(z.prev,z,z.next))return!1;z=z.nextZ}for(;n&&n.z>=G;){if(n!==g.prev&&n!==g.next&&d(x.x,x.y,g.x,g.y,B.x,B.y,n.x,n.y)&&0<=a(n.prev,n,n.next))return!1;n=n.prevZ}for(;z&&
z.z<=f;){if(z!==g.prev&&z!==g.next&&d(x.x,x.y,g.x,g.y,B.x,B.y,z.x,z.y)&&0<=a(z.prev,z,z.next))return!1;z=z.nextZ}return!0}function y(g,f,n,z){g=w.create(g,f,n);z?(g.next=z.next,g.prev=z,z.next.prev=g,z.next=g):(g.prev=g,g.next=g);return g}function m(g){g.next.prev=g.prev;g.prev.next=g.next;g.prevZ&&(g.prevZ.nextZ=g.nextZ);g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function l(g,f){let n=f;const z=g.x,x=g.y;let B=-Infinity,D;do{if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){var F=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-
n.y);if(F<=z&&F>B){B=F;if(F===z){if(x===n.y)return n;if(x===n.next.y)return n.next}D=n.x<n.next.x?n:n.next}}n=n.next}while(n!==f);if(!D)return null;if(z===B)return D.prev;f=D;F=D.x;const G=D.y;let H=Infinity,J;for(n=D.next;n!==f;)z>=n.x&&n.x>=F&&z!==n.x&&d(x<G?z:B,x,F,G,x<G?B:z,x,n.x,n.y)&&(J=Math.abs(x-n.y)/(z-n.x),(J<H||J===H&&n.x>D.x)&&e(n,g)&&(D=n,H=J)),n=n.next;return D}function c(g,f,n,z){for(var x;x!==g;x=x.next){x=x||g;null===x.z&&(x.z=p(x.x,x.y,f,n,z));if(x.prev.next!==x||x.next.prev!==x)return x.prev.next=
x,x.next.prev=x,c(g,f,n,z);x.prevZ=x.prev;x.nextZ=x.next}g.prevZ.nextZ=null;g.prevZ=null;a:for(n=1;;){z=g;f=g=null;let B=0;for(;z;){B++;x=z;let D=0;for(;D<n&&x;D++)x=x.nextZ;let F=n;for(;0<D||0<F&&x;){let G;0===D?(G=x,x=x.nextZ,F--):0!==F&&x?z.z<=x.z?(G=z,z=z.nextZ,D--):(G=x,x=x.nextZ,F--):(G=z,z=z.nextZ,D--);f?f.nextZ=G:g=G;G.prevZ=f;f=G}z=x}f.nextZ=null;n*=2;if(2>B)break a}return g}function a(g,f,n){return(f.y-g.y)*(n.x-f.x)-(f.x-g.x)*(n.y-f.y)}function b(g,f,n,z){return r(g,f)&&r(n,z)||r(g,z)&&
r(n,f)?!0:0<a(g,f,n)!==0<a(g,f,z)&&0<a(n,z,g)!==0<a(n,z,f)}function d(g,f,n,z,x,B,D,F){return 0<=(x-D)*(f-F)-(g-D)*(B-F)&&0<=(g-D)*(z-F)-(n-D)*(f-F)&&0<=(n-D)*(B-F)-(x-D)*(z-F)}function e(g,f){return 0>a(g.prev,g,g.next)?0<=a(g,f,g.next)&&0<=a(g,g.prev,f):0>a(g,f,g.prev)||0>a(g,g.next,f)}function p(g,f,n,z,x){g=32767*(g-n)*x;f=32767*(f-z)*x;g=(g|g<<8)&16711935;g=(g|g<<4)&252645135;g=(g|g<<2)&858993459;f=(f|f<<8)&16711935;f=(f|f<<4)&252645135;f=(f|f<<2)&858993459;return(g|g<<1)&1431655765|((f|f<<1)&
1431655765)<<1}function r(g,f){return g.x===f.x&&g.y===f.y}function v(g,f){return g.x-f.x}function h(g,f){const n=w.create(g.index,g.x,g.y),z=w.create(f.index,f.x,f.y),x=g.next,B=f.prev;g.next=f;f.prev=g;n.next=x;x.prev=n;z.next=n;n.prev=z;B.next=z;z.prev=B;return z}let w=function(){function g(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}g.create=function(f,n,z){const x=k<u.length?u[k++]:new g;x.index=f;x.x=n;x.y=z;x.prev=null;x.next=null;x.z=
null;x.prevZ=null;x.nextZ=null;x.steiner=!1;return x};return g}();const u=[];let k=0;for(let g=0;8096>g;g++)u.push(new w);q.bufcut=function(g,f,n,z,x,B,D){k=0;var F=(z-n)*B,G=x&&x.length;const H=G?(x[0]-n)*B:F;var J=t(f,n,z,0,H,B,!0);if(J&&J.next!==J.prev){var L;if(G){const aa=[];for(let da=0,R=x.length;da<R;da++){const M=t(f,n,z,x[da]*B,da<R-1?x[da+1]*B:z*B,B,!1);M===M.next&&(M.steiner=!0);G=aa;var K=G.push;let Q=M,N=M;do{if(Q.x<N.x||Q.x===N.x&&Q.y<N.y)N=Q;Q=Q.next}while(Q!==M);K.call(G,N)}aa.sort(v);
for(var U of aa)if(z=U,x=l(z,J))z=h(x,z),E(z,z.next),J=E(x,x.next)}if(F>80*B){var X=F=f[n*B];var Z=L=f[1+n*B];for(U=B;U<H;U+=B)z=f[U+n*B],x=f[U+1+n*B],X=Math.min(X,z),Z=Math.min(Z,x),F=Math.max(F,z),L=Math.max(L,x);L=Math.max(F-X,L-Z);L=0!==L?1/L:0}C(J,g,B,X,Z,L,D,0)}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){return function(e){function p(r,v,h,w,u,k,g,f,n,z,x,B,D,F,G,H,J,L,K,U){var X=e.call(this)||this;r=c.LineMaterialKey.load(r);v&&(r.sdf=v.sdf,r.pattern=!0,r.textureBinding=v.textureBinding);X._capType=w;X._joinType=u;X._miterLimitCosine=a.getLimitCosine(k);X.tessellationProperties._fillColor=g;X.tessellationProperties._tl=f;X.tessellationProperties._br=n;X._hasPattern=z;X._isDashed=x;X._zOrder=J;X._effects=L;X._minMaxZoom=m.i1616to32(Math.round(K*y.MIN_MAX_ZOOM_PRECISION_FACTOR),
Math.round(U*y.MIN_MAX_ZOOM_PRECISION_FACTOR));X._materialKey=r.data;X.tessellationProperties._bitset=(D?y.BITSET_GENERIC_LOCK_COLOR:0)|(F?y.BITSET_TYPE_FILL_OUTLINE:0)|(B?y.BITSET_LINE_SCALE_DASH:0)|(G?y.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);X.tessellationProperties._halfWidth=.5*h;X.tessellationProperties._halfReferenceWidth=.5*H;X.tessellationProperties.offset=0;X._initializeTessellator(!1);return X}q._inheritsLoose(p,e);p.fromCIMLine=function(r,v,h){var w=r.color,u=r.scaleFactor||1;const k=!!r.dashTemplate;
let g=r.cap;k&&g===C.CapType.ROUND&&(g=C.CapType.SQUARE);const f=r.join;u*=E.pt2px(r.width);const n=E.pt2px(r.referenceWidth),z=E.pt2px(r.miterLimit);w=w&&A.premultiplyAlphaRGBA(w)||0;const [x,B]=a.getMinMaxZoom(r.scaleInfo,h);if(!v)return new p(r.materialKey,v,u,g,f,z,w,0,0,!1,k,r.scaleDash,r.colorLocked,!1,r.sampleAlphaOnly,n,r.zOrder,r.effects,x,B);const {rect:D,width:F,height:G}=v;var H=D.x+y.SPRITE_PADDING;const J=D.y+y.SPRITE_PADDING;h=H+F;const L=J+G;H=m.i1616to32(H,J);h=m.i1616to32(h,L);return new p(r.materialKey,
v,u,g,f,z,w,H,h,!0,k,r.scaleDash,r.colorLocked,!1,r.sampleAlphaOnly,n,r.zOrder,r.effects,x,B)};p.fromFillOutline=function(r){const v=c.FillMaterialKey.load(r.materialKey);return c.hasOutlineFillSymbology(v)&&r.outline&&"esriSLSSolid"===r.outline?.style?p.fromSimpleLine({hash:"",materialKey:r.materialKey,...r.outline},null,!0):null};p.fromSimpleLine=function(r,v,h=!1){var {color:w}=r;const u="esriSLSSolid"!==r.style&&"esriSLSNull"!==r.style,k=l.getCapType(r.cap||"round"),g=l.getJoinType(r.join||"round");
w=w&&"esriSLSNull"!==r.style&&A.premultiplyAlphaRGBAArray(w)||0;"esriSLSNull"===r.style&&(w=0);const f=E.pt2px(r.width),n=r.miterLimit;if(!v)return new p(r.materialKey,v,f,k,g,n,w,0,0,!1,u,!0,!1,h,!1,f,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);const {rect:z,width:x,height:B}=v;var D=z.x+y.SPRITE_PADDING;const F=z.y+y.SPRITE_PADDING;var G=D+x;const H=F+B;D=m.i1616to32(D,F);G=m.i1616to32(G,H);return new p(r.materialKey,v,f,k,g,n,w,D,G,!0,u,!0,!1,h,!1,f,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM)};
p.fromPictureLineSymbol=function(r,v,h,w){t.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");return null};return p}(b(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(q,t,E,C,A,y,m,l){const c=(d,e,
p)=>(r,v,h,w,u,k,g,f,n,z,x)=>{h=A.i1616to32(x,Math.ceil(16*d._halfWidth));g=A.i8888to32(Math.round(16*g),Math.round(16*f),Math.round(16*n),Math.round(16*z));u=A.i8888to32(16*u,16*k,0,d._bitset);k=d.out;k.vertexBounds(r,v,e,p);k.vertexWrite(A.i1616to32(8*r,8*v));k.vertexWrite(d.id);k.vertexWrite(d._fillColor);k.vertexWrite(g);k.vertexWrite(h);k.vertexWrite(d._tl);k.vertexWrite(d._br);k.vertexWrite(u);k.vertexWrite(A.i1616to32(Math.ceil(16*d._halfReferenceWidth),0));k.vertexWrite(d.minMaxZoom);k.vertexEnd();
return d.offset+d.vertexCount++},a=(d,e,p)=>(r,v,h,w,u,k,g,f,n,z,x)=>{h=A.i1616to32(16*d._halfWidth,16*d._halfReferenceWidth);g=A.i8888to32(16*g+128,16*f+128,16*n+128,16*z+128);f=d.out;n=d._bitset<<24|d.id;f.vertexBounds(r,v,e,p);f.vertexWrite(A.i1616to32(8*r,8*v));f.vertexWrite(n);f.vertexWrite(d._fillColor);r=m.hasSimpleSymbology(d.key);r||(f.vertexWrite(0),f.vertexWrite(0));f.vertexWrite(0);f.vertexWrite(h);f.vertexWrite(g);r||f.vertexWrite(d.minMaxZoom);f.vertexEnd();return d.offset+d.vertexCount++},
b=d=>(e,p,r)=>{const v=d.out;v.indexWrite(e);v.indexWrite(p);v.indexWrite(r);d.indexCount+=3};return d=>function(e){function p(...v){v=e.call(this,...v)||this;v.tessellationProperties={};v._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};v.geometryType=C.WGLGeometryType.LINE;return v}q._inheritsLoose(p,e);var r=p.prototype;r.writeGeometry=function(v,h,w,u){this._writeGeometry(v,h,w,u)};r._initializeTessellator=function(v){var h=m.LineMaterialKey.load(this._materialKey),w=m.FillMaterialKey.load(this._materialKey),
u=this._tessellationOptions;h=h.vvSizeFieldStops||h.vvSizeMinMaxValue||h.vvSizeScaleStops||h.vvSizeUnitValue;v=this.tessellationProperties._halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD&&!v&&!h;this.tessellationProperties.minMaxZoom=this._minMaxZoom;u.wrapDistance=65535;u.textured=this._isDashed||this._hasPattern;u.offset=this.tessellationProperties.offset;u.halfWidth=this.tessellationProperties._halfWidth;u=v?0:1;w=m.hasOutlineFillSymbology(w)?a:c;this._lineTessellator=new y.LineTessellation(w(this.tessellationProperties,
u,u),b(this.tessellationProperties),v)};r._write=function(v,h,w,u){w="esriGeometryPoint"===h.geometryType;v.recordStart(h.getDisplayId(),this._materialKey,this.geometryType,w);this._writeGeometry(v,h,u,w);v.recordEnd()};r._writeGeometry=function(v,h,w,u){w=w??h.readLegacyGeometryForDisplay();u=this._getLines(w,u);t.isNone(u)||this._writeVertices(v,h,u)};r._getLines=function(v,h){if(t.isNone(v))return null;v=v.paths||v.rings;return t.isNone(v)?null:l.clipLinesMarshall(v,h?256:16)};r._writeVertices=
function(v,h,w){const u=h.getDisplayId(),k=v.vertexCount(),g=this.tessellationProperties;h=this._tessellationOptions;g.out=v;g.id=u;g.indexCount=0;g.vertexCount=0;g.offset=k;h.capType=this._capType;h.joinType=this._joinType;v=m.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=m.hasOutlineFillSymbology(v)?v:m.LineMaterialKey.load(this._materialKey);for(const {line:f,start:n}of w)h.initialDistance=n%65535,this._lineTessellator.tessellate(f,h)};return p}(d)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports",
"../../../../symbols/cim/enums","./definitions"],function(q,t,E){function C(d,e){return d.x===e.x&&d.y===e.y}function A(d,e){d.x=e.y;d.y=-e.x;return d}function y(d,e){d.x=-e.y;d.y=e.x;return d}function m(d,e){d.x=e.x;d.y=e.y;return d}function l(d,e){d.x=-e.x;d.y=-e.y;return d}function c(d){return Math.sqrt(d.x*d.x+d.y*d.y)}function a(d,e,p,r){d.x=e.x*p+e.y*r;d.y=e.x*r-e.y*p;return d}let b=function(){function d(p,r,v){this._writeVertex=p;this._writeTriangle=r;this._canUseThinTessellation=v;this._prevNormal=
{x:void 0,y:void 0};this._nextNormal={x:void 0,y:void 0};this._textureNormalLeft={x:0,y:1};this._textureNormalRight={x:0,y:-1};this._textureNormal={x:void 0,y:void 0};this._joinNormal={x:void 0,y:void 0};this._inner={x:void 0,y:void 0};this._outer={x:void 0,y:void 0};this._roundStart={x:void 0,y:void 0};this._roundEnd={x:void 0,y:void 0};this._startBreak={x:void 0,y:void 0};this._endBreak={x:void 0,y:void 0};this._innerPrev={x:void 0,y:void 0};this._innerNext={x:void 0,y:void 0};this._bevelStart=
{x:void 0,y:void 0};this._bevelEnd={x:void 0,y:void 0};this._bevelMiddle={x:void 0,y:void 0}}var e=d.prototype;e.tessellate=function(p,r){if(p){var v=p.length;if(!(1>=v)){var h=0;for(let w=1;w<v;w++)C(p[w],p[h])||++h===w||(p[h]=p[w]);p.length=h+1}}this._canUseThinTessellation&&r.halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD&&!r.offset?this._tessellateThin(p,r):this._tessellate(p,r)};e._tessellateThin=function(p,r){if(!(2>p.length)){var v=r.wrapDistance||65535;r=r.initialDistance||0;var h=!1,w=p[0].x,
u=p[0].y,k=p.length;for(let z=1;z<k;++z){h&&(h=!1,r=0);let x=p[z].x,B=p[z].y;var g=x-w;let D=B-u;var f=Math.sqrt(g*g+D*D);g/=f;D/=f;if(r+f>v){h=!0;var n=(v-r)/f;f=v-r;x=(1-n)*w+n*x;B=(1-n)*u+n*B;--z}n=this._writeVertex(w,u,0,0,g,D,D,-g,0,-1,r);w=this._writeVertex(w,u,0,0,g,D,-D,g,0,1,r);r+=f;f=this._writeVertex(x,B,0,0,g,D,D,-g,0,-1,r);g=this._writeVertex(x,B,0,0,g,D,-D,g,0,1,r);this._writeTriangle(n,w,f);this._writeTriangle(w,f,g);w=x;u=B}}};e._tessellate=function(p,r){var v=p[p.length-1];const h=
C(p[0],v);if(!(p.length<(h?3:2))){var w=r.pixelCoordRatio,u=null!=r.capType?r.capType:t.CapType.BUTT,k=null!=r.joinType?r.joinType:t.JoinType.MITER,g=null!=r.miterLimit?Math.min(r.miterLimit,4):2,f=null!=r.roundLimit?Math.min(r.roundLimit,1.05):1.05,n=null!=r.halfWidth?r.halfWidth:2,z=!!r.textured,x=null,B=this._prevNormal,D=this._nextNormal,F=-1,G=-1,H=this._joinNormal,J=this._textureNormalLeft,L=this._textureNormalRight,K=this._textureNormal,U=-1,X=-1,Z=r.wrapDistance||65535,aa=r.initialDistance||
0,da=this._writeVertex,R=this._writeTriangle;r=(ia,la,ka,ja,ma,na)=>{ia=da(Q,N,T,ba,ka,ja,ia,la,ma,na,aa);0<=U&&0<=X&&0<=ia&&R(U,X,ia);U=X;return X=ia};if(h){var M=p[p.length-2];D.x=v.x-M.x;D.y=v.y-M.y;G=c(D);D.x/=G;D.y/=G}v=!1;for(let ia=0;ia<p.length;++ia){v&&(v=!1,aa=0);M&&(B.x=-D.x,B.y=-D.y,F=G,aa+F>Z&&(v=!0));v?(x=(Z-aa)/F,F=Z-aa,M={x:(1-x)*M.x+x*p[ia].x,y:(1-x)*M.y+x*p[ia].y},--ia):M=p[ia];var Q=M.x;var N=M.y;var S=0>=ia&&!v,W=ia===p.length-1;S||(aa+=F);(x=W?h?p[1]:null:p[ia+1])?(D.x=x.x-Q,
D.y=x.y-N,G=c(D),D.x/=G,D.y/=G):(D.x=void 0,D.y=void 0);if(!h){if(S){y(H,D);var T=H.x;var ba=H.y;u===t.CapType.SQUARE&&(r(-D.y-D.x,D.x-D.y,D.x,D.y,0,-1),r(D.y-D.x,-D.x-D.y,D.x,D.y,0,1));u===t.CapType.ROUND&&(r(-D.y-D.x,D.x-D.y,D.x,D.y,-1,-1),r(D.y-D.x,-D.x-D.y,D.x,D.y,-1,1));if(u===t.CapType.ROUND||u===t.CapType.BUTT)r(-D.y,D.x,D.x,D.y,0,-1),r(D.y,-D.x,D.x,D.y,0,1);continue}if(W){A(H,B);T=H.x;ba=H.y;if(u===t.CapType.ROUND||u===t.CapType.BUTT)r(B.y,-B.x,-B.x,-B.y,0,-1),r(-B.y,B.x,-B.x,-B.y,0,1);u===
t.CapType.SQUARE&&(r(B.y-B.x,-B.x-B.y,-B.x,-B.y,0,-1),r(-B.y-B.x,B.x-B.y,-B.x,-B.y,0,1));u===t.CapType.ROUND&&(r(B.y-B.x,-B.x-B.y,-B.x,-B.y,1,-1),r(-B.y-B.x,B.x-B.y,-B.x,-B.y,1,1));continue}}var I=void 0;S=-(B.x*D.y-B.y*D.x);.01>Math.abs(S)?0<B.x*D.x+B.y*D.y?(H.x=B.x,H.y=B.y,S=1,I=Number.MAX_VALUE,x=!0):(y(H,D),I=S=1,x=!1):(H.x=(B.x+D.x)/S,H.y=(B.y+D.y)/S,I=c(H),x=(I-1)*n*w,x=4<I||x>F&&x>G);T=H.x;ba=H.y;var P=k;switch(k){case t.JoinType.BEVEL:1.05>I&&(P=t.JoinType.MITER);break;case t.JoinType.ROUND:I<
f&&(P=t.JoinType.MITER);break;case t.JoinType.MITER:I>g&&(P=t.JoinType.BEVEL)}switch(P){case t.JoinType.MITER:r(H.x,H.y,-B.x,-B.y,0,-1);r(-H.x,-H.y,-B.x,-B.y,0,1);if(W)break;z&&(x=v?0:aa,U=this._writeVertex(Q,N,T,ba,D.x,D.y,H.x,H.y,0,-1,x),X=this._writeVertex(Q,N,T,ba,D.x,D.y,-H.x,-H.y,0,1,x));break;case t.JoinType.BEVEL:S=0>S;var O=void 0;S?(P=U,U=X,X=P,O=J,P=L):(O=L,P=J);var V=void 0,Y=void 0;x?(V=S?y(this._innerPrev,B):A(this._innerPrev,B),Y=S?A(this._innerNext,D):y(this._innerNext,D)):V=Y=S?l(this._inner,
H):m(this._inner,H);I=S?A(this._bevelStart,B):y(this._bevelStart,B);r(V.x,V.y,-B.x,-B.y,O.x,O.y);V=r(I.x,I.y,-B.x,-B.y,P.x,P.y);if(W)break;W=S?y(this._bevelEnd,D):A(this._bevelEnd,D);x?(x=this._writeVertex(Q,N,T,ba,-B.x,-B.y,0,0,0,0,aa),U=this._writeVertex(Q,N,T,ba,D.x,D.y,Y.x,Y.y,O.x,O.y,aa),X=this._writeVertex(Q,N,T,ba,D.x,D.y,W.x,W.y,P.x,P.y,aa),this._writeTriangle(V,x,X)):(z?(x=this._bevelMiddle,x.x=(I.x+W.x)/2,x.y=(I.y+W.y)/2,a(K,x,-B.x,-B.y),r(x.x,x.y,-B.x,-B.y,K.x,K.y),a(K,x,D.x,D.y),U=this._writeVertex(Q,
N,T,ba,D.x,D.y,x.x,x.y,K.x,K.y,aa),X=this._writeVertex(Q,N,T,ba,D.x,D.y,Y.x,Y.y,O.x,O.y,aa)):(x=U,U=X,X=x),r(W.x,W.y,D.x,D.y,P.x,P.y));S&&(x=U,U=X,X=x);break;case t.JoinType.ROUND:S=0>S;var ca=void 0;S?(P=U,U=X,X=P,P=J,ca=L):(P=L,ca=J);var ea=S?l(this._inner,H):m(this._inner,H);x?(Y=S?y(this._innerPrev,B):A(this._innerPrev,B),O=S?A(this._innerNext,D):y(this._innerNext,D)):O=Y=ea;V=S?A(this._roundStart,B):y(this._roundStart,B);var fa=S?y(this._roundEnd,D):A(this._roundEnd,D);Y=r(Y.x,Y.y,-B.x,-B.y,
P.x,P.y);V=r(V.x,V.y,-B.x,-B.y,ca.x,ca.y);if(W)break;W=this._writeVertex(Q,N,T,ba,-B.x,-B.y,0,0,0,0,aa);x||this._writeTriangle(U,X,W);ea=l(this._outer,ea);ca=this._writeVertex(Q,N,T,ba,D.x,D.y,fa.x,fa.y,ca.x,ca.y,aa);let la,ka;if(fa=2<I){var ha=void 0;I!==Number.MAX_VALUE?(ea.x/=I,ea.y/=I,ha=B.x*ea.x+B.y*ea.y,ha=(I*(ha*ha-1)+1)/ha):ha=-1;la=S?A(this._startBreak,B):y(this._startBreak,B);la.x+=B.x*ha;la.y+=B.y*ha;ka=S?y(this._endBreak,D):A(this._endBreak,D);ka.x+=D.x*ha;ka.y+=D.y*ha}a(K,ea,-B.x,-B.y);
I=this._writeVertex(Q,N,T,ba,-B.x,-B.y,ea.x,ea.y,K.x,K.y,aa);a(K,ea,D.x,D.y);ea=z?this._writeVertex(Q,N,T,ba,D.x,D.y,ea.x,ea.y,K.x,K.y,aa):I;ha=W;const ja=z?this._writeVertex(Q,N,T,ba,D.x,D.y,0,0,0,0,aa):W;let ma=-1,na=-1;fa&&(a(K,la,-B.x,-B.y),ma=this._writeVertex(Q,N,T,ba,-B.x,-B.y,la.x,la.y,K.x,K.y,aa),a(K,ka,D.x,D.y),na=this._writeVertex(Q,N,T,ba,D.x,D.y,ka.x,ka.y,K.x,K.y,aa));z?fa?(this._writeTriangle(ha,V,ma),this._writeTriangle(ha,ma,I),this._writeTriangle(ja,ea,na),this._writeTriangle(ja,
na,ca)):(this._writeTriangle(ha,V,I),this._writeTriangle(ja,ea,ca)):fa?(this._writeTriangle(W,V,ma),this._writeTriangle(W,ma,na),this._writeTriangle(W,na,ca)):(this._writeTriangle(W,V,I),this._writeTriangle(W,ea,ca));x?U=this._writeVertex(Q,N,T,ba,D.x,D.y,O.x,O.y,P.x,P.y,aa):(U=z?this._writeVertex(Q,N,T,ba,D.x,D.y,O.x,O.y,P.x,P.y,aa):Y,this._writeTriangle(U,ja,ca));X=ca;S&&(x=U,U=X,X=x)}}}};return d}();q.LineTessellation=b;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(q,t,E,C,A){const y=t.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(m){function l(c){var a=m.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;a._dynamicPropertyMap=
new Map;a._cimLayer=c;return a}q._inheritsLoose(l,m);l.prototype.analyze=function(c,a,b,d,e){if(e&&0===e.length)return null;const p=e&&0<e.length,r=a.readLegacyFeature();a=a.getObjectId();const v=this._materialCache;var h=this._cimLayer.materialHash;if(!h)return y.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const w="function"===typeof h?h(r,b,d,a):h;if(v.has(w))return c=v.get(w),Promise.resolve(c);if(h=this._ongoingMaterialRequestMap.get(w))return h;
h=this._cimLayer;const u=E.analyzeCIMResource(h.cim,this._cimLayer.materialOverrides);u.mosaicHash=w;const {type:k,url:g}=h;a={cim:u,type:k,mosaicHash:w,url:g,size:null,dashTemplate:null,text:null,fontName:null,objectId:a,animatedSymbolProperties:null};switch(k){case "marker":a.size=C.evaluateValueOrFunction(h.size,r,b,d);a.animatedSymbolProperties=C.evaluateValueOrFunction(h.animatedSymbolProperties,r,b,d);break;case "line":a.dashTemplate=h.dashTemplate;break;case "text":a.text=C.evaluateValueOrFunction(h.text,
r,b,d),a.fontName=C.evaluateValueOrFunction(h.fontName,r,b,d)}c=c.getMosaicItem(a,e).then(f=>{p||(this._ongoingMaterialRequestMap.delete(w),v.set(w,f));return f}).catch(f=>{this._ongoingMaterialRequestMap.delete(w);y.error(".analyze()",f.message);return null});p||this._ongoingMaterialRequestMap.set(w,c);return c};return l}(A)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w,u){function k(I){switch(I){case "Butt":return d.CapType.BUTT;case "Square":return d.CapType.SQUARE;default:return d.CapType.ROUND}}function g(I){switch(I){case "Bevel":return d.JoinType.BEVEL;case "Miter":return d.JoinType.MITER;default:return d.JoinType.ROUND}}function f(I,P,O,V){let Y;I[P]?Y=I[P]:(Y={},I[P]=Y);Y[O]=V}function n(I){return(I=I.markerPlacement)&&I.angleToLine?d.Alignment.MAP:d.Alignment.SCREEN}function z(){z=t._asyncToGenerator(function*(I,
P,O,V,Y){V=V??[];if(!I)return V;let ca;const ea={};if("CIMSymbolReference"===I.type){if(ca=I.symbol,I=I.primitiveOverrides){var fa=[];for(const ia of I){var ha=ia.valueExpressionInfo;ha&&P?(ha=a.createRendererExpression(ha.expression,P.spatialReference,P.fields).then(la=>{m.isNone(la)||f(ea,ia.primitiveName,ia.propertyName,la)}),fa.push(ha)):null!=ia.value&&f(ea,ia.primitiveName,ia.propertyName,ia.value)}0<fa.length&&(yield Promise.all(fa))}}else return ba.error("Expect cim type to be 'CIMSymbolReference'"),
V;fa=[];b.CIMSymbolHelper.fetchResources(ca,O,fa);0<fa.length&&(yield Promise.all(fa));switch(ca.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":x(ca,I,ea,P,V,O,Y)}return V});return z.apply(this,arguments)}function x(I,P,O,V,Y,ca,ea){if(I){var fa=I.symbolLayers;if(fa){var ha=I.effects,ia=b.CIMSymbolHelper.getSize(I);if("CIMPointSymbol"===I.type&&"Map"===I.angleAlignment)var la=d.Alignment.MAP;for(var ka=fa.length;ka--;){var ja=fa[ka];if(!ja||!1===ja.enable)continue;let va;
ha&&ha.length&&(va=[...ha]);var ma=ja.effects;ma&&ma.length&&(ha?va.push(...ma):va=[...ma]);ma=[];b.OverrideHelper.findEffectOverrides(va,P,ma);ma=0<ma.length?Q(va,ma,O,V):va;var na=[];b.OverrideHelper.findApplicableOverrides(ja,P,na);switch(ja.type){case "CIMSolidFill":B(ja,ma,O,na,V,Y);break;case "CIMPictureFill":D(ja,ma,O,na,V,ca,Y);break;case "CIMHatchFill":F(ja,ma,O,na,V,Y);break;case "CIMGradientFill":var pa=O,oa=V,sa=Y;const [Ia,Qa]=T(na,ja.primitiveName,ma,null,null);var qa=c.numericHash(JSON.stringify(ja)+
Qa).toString();sa.push({type:"fill",templateHash:qa,materialHash:Ia?W(qa,pa,na,oa):qa,cim:ja,materialOverrides:null,colorLocked:ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1});break;case "CIMSolidStroke":G(ja,ma,O,na,V,Y,"CIMPolygonSymbol"===I.type,ia);break;case "CIMPictureStroke":H(ja,ma,O,na,V,Y,"CIMPolygonSymbol"===I.type,ia);break;case "CIMGradientStroke":pa=O;oa=V;sa=Y;qa="CIMPolygonSymbol"===I.type;
var ta=ia,wa=ja.primitiveName,Aa=void 0!==ja.width?ja.width:4,ua=k(ja.capStyle),xa=g(ja.joinStyle),za=ja.miterLimit;const [Ma,Ba]=T(na,wa,ma,null,null),Ea=c.numericHash(JSON.stringify(ja)+Ba).toString();sa.push({type:"line",templateHash:Ea,materialHash:Ma?W(Ea,pa,na,oa):Ea,cim:ja,materialOverrides:null,isOutline:qa,colorLocked:ja.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},width:R(wa,pa,"Width",oa,Aa),cap:R(wa,pa,"CapStyle",oa,ua),join:R(wa,pa,"JoinStyle",oa,xa),miterLimit:R(wa,pa,"MiterLimit",
oa,za),referenceWidth:ta,zOrder:aa(ja.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":J(ja,ma,O,na,V,Y);break;case "CIMPictureMarker":if(J(ja,ma,O,na,V,Y))break;"CIMLineSymbol"===I.type&&(la=n(ja));L(ja,ma,O,na,V,ca,Y,la,ia);break;case "CIMVectorMarker":if(J(ja,ma,O,na,V,Y))break;"CIMLineSymbol"===I.type&&(la=n(ja));pa=O;oa=V;sa=Y;qa=ca;ta=la;wa=ia;Aa=ea;if(xa=ja.markerGraphics){ua=0;ja.scaleSymbolsProportionally&&(za=ja.frame)&&(ua=za.ymax-za.ymin);za=N(ja.markerPlacement,
na,pa,oa);for(const Ha of xa)if(Ha&&(xa=Ha.symbol))switch(xa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":U(ja,ma,za,null,Ha,na,pa,oa,sa,qa,ta,wa,ua,Aa);break;case "CIMTextSymbol":K(ja,ma,za,Ha,pa,na,oa,sa,ta,wa,ua)}}break;default:ba.error("Cannot analyze CIM layer",ja.type)}}}}}function B(I,P,O,V,Y,ca){const ea=I.primitiveName,fa=r.fromCIMColor(I.color),[ha,ia]=T(V,ea,P,null,null),la=c.numericHash(JSON.stringify(I)+ia).toString();ca.push({type:"fill",templateHash:la,materialHash:ha?
()=>la:la,cim:I,materialOverrides:null,colorLocked:I.colorLocked,color:R(ea,O,"Color",Y,fa,da),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:P,applyRandomOffset:!1,sampleAlphaOnly:!0})}function D(I,P,O,V,Y,ca,ea){const fa=I.primitiveName,ha=I.tintColor?r.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},[ia,la]=T(V,fa,P,null,null);V=c.numericHash(JSON.stringify(I)+la).toString();const ka=c.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();let ja=r.getValue(I.scaleX);
if("width"in I){const ma=I.width;let na=1;ca=ca.getResource(I.url);m.isSome(ca)&&(na=ca.width/ca.height);ja/=I.height/ma*na}ea.push({type:"fill",templateHash:V,materialHash:ia?()=>ka:ka,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:P,color:R(fa,O,"TintColor",Y,ha,da),height:R(fa,O,"Height",Y,I.height),scaleX:R(fa,O,"ScaleX",Y,ja),angle:R(fa,O,"Rotation",Y,r.getValue(I.rotation)),offsetX:R(fa,O,"OffsetX",Y,r.getValue(I.offsetX)),offsetY:R(fa,O,"OffsetY",Y,r.getValue(I.offsetY)),url:I.url,
applyRandomOffset:!1,sampleAlphaOnly:!1})}function F(I,P,O,V,Y,ca){const ea=["Rotation","OffsetX","OffsetY"],fa=V.filter(ma=>ma.primitiveName!==I.primitiveName||!ea.includes(ma.propertyName)),ha=I.primitiveName,[ia,la]=T(V,ha,P,null,null);V=c.numericHash(JSON.stringify(I)+la).toString();const ka=c.numericHash(`${I.separation}${JSON.stringify(I.lineSymbol)}`).toString();let ja={r:255,g:255,b:255,a:1};if(I.lineSymbol){const ma=I.lineSymbol?.symbolLayers.find(na=>"CIMSolidStroke"===na.type);ma&&(ja=
r.fromCIMColor(ma.color))}ca.push({type:"fill",templateHash:V,materialHash:ia?W(ka,O,fa,Y):ka,cim:I,materialOverrides:fa,colorLocked:I.colorLocked,effects:P,color:ja,height:R(ha,O,"Separation",Y,I.separation),scaleX:1,angle:R(ha,O,"Rotation",Y,r.getValue(I.rotation)),offsetX:R(ha,O,"OffsetX",Y,r.getValue(I.offsetX)),offsetY:R(ha,O,"OffsetY",Y,r.getValue(I.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}function G(I,P,O,V,Y,ca,ea,fa){const ha=I.primitiveName,ia=r.fromCIMColor(I.color),la=void 0!==
I.width?I.width:4,ka=k(I.capStyle),ja=g(I.joinStyle),ma=I.miterLimit,[na,pa]=T(V,ha,P,null,null),oa=c.numericHash(JSON.stringify(I)+pa).toString();let sa;if(P&&P instanceof Array&&0<P.length&&(V=P[P.length-1],"CIMGeometricEffectDashes"===V.type&&"NoConstraint"===V.lineDashEnding&&null===V.offsetAlongLine)){P=[...P];var qa=P.pop();sa=qa.dashTemplate;qa=qa.scaleDash}ca.push({type:"line",templateHash:oa,materialHash:na?()=>oa:oa,cim:I,materialOverrides:null,isOutline:ea,colorLocked:I.colorLocked,effects:P,
color:R(ha,O,"Color",Y,ia,da),width:R(ha,O,"Width",Y,la),cap:R(ha,O,"CapStyle",Y,ka),join:R(ha,O,"JoinStyle",Y,ja),miterLimit:R(ha,O,"MiterLimit",Y,ma),referenceWidth:fa,zOrder:aa(I.name),dashTemplate:sa,scaleDash:qa,sampleAlphaOnly:!0})}function H(I,P,O,V,Y,ca,ea,fa){const ha=c.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),ia=I.primitiveName,la=r.fromCIMColor(I.tintColor),ka=void 0!==I.width?I.width:4,ja=k(I.capStyle),ma=g(I.joinStyle),na=I.miterLimit,[pa,oa]=T(V,ia,P,
null,null);V=c.numericHash(JSON.stringify(I)+oa).toString();ca.push({type:"line",templateHash:V,materialHash:pa?()=>ha:ha,cim:I,materialOverrides:null,isOutline:ea,colorLocked:I.colorLocked,effects:P,color:R(ia,O,"TintColor",Y,la,da),width:R(ia,O,"Width",Y,ka),cap:R(ia,O,"CapStyle",Y,ja),join:R(ia,O,"JoinStyle",Y,ma),miterLimit:R(ia,O,"MiterLimit",Y,na),referenceWidth:fa,zOrder:aa(I.name),dashTemplate:null,scaleDash:!1,url:I.url,sampleAlphaOnly:!1})}function J(I,P,O,V,Y,ca){const ea=I.markerPlacement;
if(!ea||"CIMMarkerPlacementInsidePolygon"!==ea.type)return!1;var fa=Math.abs(ea.stepX),ha=Math.abs(ea.stepY);if(0===fa||0===ha)return!0;const ia=["Rotation","OffsetX","OffsetY"],la=V.filter(oa=>oa.primitiveName!==I.primitiveName||!ia.includes(oa.propertyName)),ka="url"in I?I.url:null,[ja,ma]=T(V,ea.primitiveName,P,null,null);V=c.numericHash(JSON.stringify(I)+ma).toString();let na=null;if("Random"===ea.gridType){var pa=l.px2pt(w.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const oa=Math.max(Math.floor(pa/fa),
1),sa=Math.max(Math.floor(pa/ha),1);pa=ha*sa;na=qa=>qa?qa*sa:0;fa=oa*fa/pa}else ea.shiftOddRows?(pa=2*ha,na=oa=>oa?2*oa:0,fa=fa/ha*.5):(pa=ha,na=null,fa/=ha);ha={r:255,g:255,b:255,a:1};"tintColor"in I&&(ha=r.fromCIMColor(I.tintColor));ca.push({type:"fill",templateHash:V,materialHash:ja?W(V,O,la,Y):V,cim:I,materialOverrides:la,colorLocked:I.colorLocked,effects:P,color:R(ea.primitiveName,O,"TintColor",Y,ha,da),height:R(ea.primitiveName,O,"StepY",Y,pa,na),scaleX:fa,angle:R(ea.primitiveName,O,"GridAngle",
Y,ea.gridAngle),offsetX:R(ea.primitiveName,O,"OffsetX",Y,r.getValue(ea.offsetX)),offsetY:R(ea.primitiveName,O,"OffsetY",Y,r.getValue(ea.offsetY)),url:ka,applyRandomOffset:"Random"===ea.gridType,sampleAlphaOnly:!ka});return!0}function L(I,P,O,V,Y,ca,ea,fa,ha){const ia=I.primitiveName,la=r.getValue(I.size);let ka=r.getValue(I.scaleX,1);const ja=r.getValue(I.rotation),ma=r.getValue(I.offsetX),na=r.getValue(I.offsetY),pa=I.tintColor?r.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},oa=c.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}${JSON.stringify(I.animatedSymbolProperties)}`).toString(),
sa=N(I.markerPlacement,V,O,Y),qa=S(I.animatedSymbolProperties,V,O,Y),[ta,wa]=T(V,ia,P,sa,qa);V=c.numericHash(JSON.stringify(I)+wa).toString();const Aa=I.anchorPoint??{x:0,y:0};if("width"in I){const ua=I.width;let xa=1;ca=ca.getResource(I.url);m.isSome(ca)&&(xa=ca.width/ca.height);ka/=la/ua*xa}ea.push({type:"marker",templateHash:V,materialHash:I.animatedSymbolProperties&&!0===I.animatedSymbolProperties.randomizeStartTime?(ua,xa,za,va)=>{za=u.getMaterialGroup(va);ua=r.evaluateValueOrFunction(qa,ua,
xa);return oa+`-MATERIALGROUP(${za})`+`-ASP(${JSON.stringify(ua)})`}:ta?(ua,xa)=>{ua=r.evaluateValueOrFunction(qa,ua,xa);return oa+`-ASP(${JSON.stringify(ua)})`}:oa,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:P,scaleSymbolsProportionally:!1,alignment:fa,size:R(ia,O,"Size",Y,la),scaleX:R(ia,O,"ScaleX",Y,ka),rotation:R(ia,O,"Rotation",Y,ja),offsetX:R(ia,O,"OffsetX",Y,ma),offsetY:R(ia,O,"OffsetY",Y,na),color:R(ia,O,"TintColor",Y,pa,da),anchorPoint:{x:Aa.x,y:-Aa.y},isAbsoluteAnchorPoint:"Relative"!==
I.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:I.rotateClockwise,referenceSize:ha,sizeRatio:1,markerPlacement:sa,url:I.url,animatedSymbolProperties:qa})}function K(I,P,O,V,Y,ca,ea,fa,ha,ia,la){b.OverrideHelper.findApplicableOverrides(V,ca,[]);var ka=V.geometry;if("x"in ka&&"y"in ka){var ja=V.symbol,ma=r.fromCIMFontDecoration(ja),na=r.fromCIMFontStyle(ja.fontStyleName),pa=C.getFontFamily(ja.fontFamilyName);ja.font={family:pa,decoration:ma,...na};var oa=
I.frame,sa=ka.x-.5*(oa.xmin+oa.xmax),qa=ka.y-.5*(oa.ymin+oa.ymax),ta=I.size/la;la=I.primitiveName;ka=r.getValue(ja.height)*ta;oa=r.getValue(ja.angle);sa=r.getValue(I.offsetX)+(r.getValue(ja.offsetX)+sa)*ta;qa=r.getValue(I.offsetY)+(r.getValue(ja.offsetY)+qa)*ta;var wa=r.fromCIMColor(r.getFillColor(ja)),Aa=r.fromCIMColor(r.getStrokeColor(ja)),ua=r.getStrokeWidth(ja);ua||(Aa=r.fromCIMColor(r.getFillColor(ja.haloSymbol)),ua=ja.haloSize*ta);var [xa,za]=T(ca,la,P,O,null);ca=JSON.stringify(I.effects)+Number(I.colorLocked).toString()+
JSON.stringify(I.anchorPoint)+I.anchorPointUnits+JSON.stringify(I.markerPlacement)+I.size.toString();ca=c.numericHash(JSON.stringify(V)+ca+za).toString();var va=R(V.primitiveName,Y,"TextString",ea,V.textString,r.adjustTextCase,ja.textCase);if(null!=va){({fontStyleName:V}=ja);var Ia=pa+(V?"-"+V.toLowerCase():"-regular");"string"===typeof va&&va.includes("[")&&ja.fieldMap&&(va=r.createLabelOverrideFunction(ja.fieldMap,va,ja.textCase));fa.push({type:"text",templateHash:ca,materialHash:xa||"function"===
typeof va||va.match(/\[(.*?)\]/)?(Qa,Ma,Ba)=>Ia+"-"+r.evaluateValueOrFunction(va,Qa,Ma,Ba):Ia+"-"+c.numericHash(va),cim:ja,materialOverrides:null,colorLocked:I.colorLocked,effects:P,alignment:ha,anchorPoint:{x:I.anchorPoint?I.anchorPoint.x:0,y:I.anchorPoint?I.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,fontName:Ia,decoration:ma,weight:R(la,Y,"Weight",ea,na.weight),style:R(la,Y,"Size",ea,na.style),size:R(la,Y,"Size",ea,ka),angle:R(la,Y,"Rotation",ea,oa),offsetX:R(la,Y,"OffsetX",
ea,sa),offsetY:R(la,Y,"OffsetY",ea,qa),horizontalAlignment:r.fromCIMHorizontalAlignment(ja.horizontalAlignment),verticalAlignment:r.fromCIMVerticalAlignment(ja.verticalAlignment),text:va,color:wa,outlineColor:Aa,outlineSize:ua,referenceSize:ia,sizeRatio:1,markerPlacement:O})}}}function U(I,P,O,V,Y,ca,ea,fa,ha,ia,la,ka,ja,ma){var na=Y.symbol;const pa=na.symbolLayers;if(pa)if(ma)Z(I,P,O,V,Y,ea,ca,fa,ha,ia,la,ka,ja);else if(ma=pa.length,pa&&2===pa.length&&pa[0].enable&&pa[1].enable&&"CIMSolidStroke"===
pa[0].type&&"CIMSolidFill"===pa[1].type&&!pa[0].effects&&!pa[1].effects)X(I,P,O,V,Y,pa,ca,ea,fa,ha,la,ka,ja);else if(na=v.CIMEffectHelper.applyEffects(na.effects,Y.geometry,ia.geometryEngine))for(;ma--;){var oa=pa[ma];if(oa&&!1!==oa.enable)switch(oa.type){case "CIMSolidFill":case "CIMSolidStroke":var sa=v.CIMEffectHelper.applyEffects(oa.effects,na,ia.geometryEngine),qa=p.getExtent(sa);if(!qa)continue;const Aa="Relative"!==I.anchorPointUnits,[ua,xa,za]=p.getSDFMetrics(qa,I.frame,I.size,I.anchorPoint,
Aa);var ta="CIMSolidFill"===oa.type;sa={type:"sdf",geom:sa,asFill:ta};var wa=I.primitiveName;qa=r.getValue(I.size)??10;const va=r.getValue(I.rotation),Ia=r.getValue(I.offsetX),Qa=r.getValue(I.offsetY),Ma=oa.path,Ba=oa.primitiveName,Ea=ta?r.fromCIMColor(r.getFillColor(oa)):r.fromCIMColor(r.getStrokeColor(oa)),Ha=ta?{r:0,g:0,b:0,a:0}:r.fromCIMColor(r.getStrokeColor(oa)),Ga=r.getStrokeWidth(oa);if(!ta&&!Ga)break;ta=!1;let Ca="";for(const La of ca)if(La.primitiveName===Ba||La.primitiveName===wa)void 0!==
La.value?Ca+=`-${La.primitiveName}-${La.propertyName}-${JSON.stringify(La.value)}`:La.valueExpressionInfo&&(ta=!0);m.isSome(P)&&"function"===typeof P&&(ta=!0);wa=JSON.stringify({...I,markerGraphics:null});const Ja=c.numericHash(JSON.stringify(sa)+Ma).toString();oa={type:"marker",templateHash:c.numericHash(JSON.stringify(Y)+JSON.stringify(oa)+wa+Ca).toString(),materialHash:ta?()=>Ja:Ja,cim:sa,materialOverrides:null,colorLocked:I.colorLocked,effects:P,scaleSymbolsProportionally:I.scaleSymbolsProportionally,
alignment:la,anchorPoint:{x:xa,y:za},isAbsoluteAnchorPoint:Aa,size:R(I.primitiveName,ea,"Size",fa,qa),rotation:R(I.primitiveName,ea,"Rotation",fa,va),offsetX:R(I.primitiveName,ea,"OffsetX",fa,Ia),offsetY:R(I.primitiveName,ea,"OffsetY",fa,Qa),scaleX:1,frameHeight:ja,rotateClockwise:I.rotateClockwise,referenceSize:ka,sizeRatio:ua,color:R(Ba,ea,"Color",fa,Ea,da),outlineColor:R(Ba,ea,"Color",fa,Ha,da),outlineWidth:R(Ba,ea,"Width",fa,Ga),markerPlacement:O,animatedSymbolProperties:V,path:Ma};ha.push(oa);
break;default:Z(I,P,O,V,Y,ea,ca,fa,ha,ia,la,ka,ja)}}}function X(I,P,O,V,Y,ca,ea,fa,ha,ia,la,ka,ja){var ma=Y.geometry;const na=ca[0];ca=ca[1];var pa=p.getExtent(ma);if(pa){var oa="Relative"!==I.anchorPointUnits,[sa,qa,ta]=p.getSDFMetrics(pa,I.frame,I.size,I.anchorPoint,oa);ma={type:"sdf",geom:ma,asFill:!0};var wa=I.primitiveName;pa=r.getValue(I.size);var Aa=r.getValue(I.rotation),ua=r.getValue(I.offsetX),xa=r.getValue(I.offsetY),za=ca.path,va=ca.primitiveName,Ia=na.primitiveName,Qa=r.fromCIMColor(r.getFillColor(ca)),
Ma=r.fromCIMColor(r.getStrokeColor(na)),Ba=r.getStrokeWidth(na),Ea=!1,Ha="";for(const Ca of ea)if(Ca.primitiveName===va||Ca.primitiveName===Ia||Ca.primitiveName===wa)void 0!==Ca.value?Ha+=`-${Ca.primitiveName}-${Ca.propertyName}-${JSON.stringify(Ca.value)}`:Ca.valueExpressionInfo&&(Ea=!0);ea=JSON.stringify({...I,markerGraphics:null});var Ga=c.numericHash(JSON.stringify(ma)+za).toString();I={type:"marker",templateHash:c.numericHash(JSON.stringify(Y)+JSON.stringify(ca)+JSON.stringify(na)+ea+Ha).toString(),
materialHash:Ea?()=>Ga:Ga,cim:ma,materialOverrides:null,colorLocked:I.colorLocked,effects:P,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:la,anchorPoint:{x:qa,y:ta},isAbsoluteAnchorPoint:oa,size:R(I.primitiveName,fa,"Size",ha,pa),rotation:R(I.primitiveName,fa,"Rotation",ha,Aa),offsetX:R(I.primitiveName,fa,"OffsetX",ha,ua),offsetY:R(I.primitiveName,fa,"OffsetY",ha,xa),scaleX:1,frameHeight:ja,rotateClockwise:I.rotateClockwise,referenceSize:ka,sizeRatio:sa,color:R(va,fa,"Color",ha,
Qa,da),outlineColor:R(Ia,fa,"Color",ha,Ma,da),outlineWidth:R(Ia,fa,"Width",ha,Ba),markerPlacement:O,path:za,animatedSymbolProperties:V};ia.push(I)}}function Z(I,P,O,V,Y,ca,ea,fa,ha,ia,la,ka,ja){Y={type:I.type,enable:!0,name:I.name,colorLocked:I.colorLocked,primitiveName:I.primitiveName,anchorPoint:I.anchorPoint,anchorPointUnits:I.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:I.rotateClockwise,rotation:0,size:I.size,billboardMode3D:I.billboardMode3D,depth3D:I.depth3D,frame:I.frame,markerGraphics:[Y],
scaleSymbolsProportionally:I.scaleSymbolsProportionally,respectFrame:I.respectFrame,clippingPath:I.clippingPath};const ma=["Rotation","OffsetX","OffsetY"],na=ea.filter(ua=>ua.primitiveName!==I.primitiveName||!ma.includes(ua.propertyName));var pa="";for(var oa of ea)void 0!==oa.value&&(pa+=`-${oa.primitiveName}-${oa.propertyName}-${JSON.stringify(oa.value)}`);const [sa,qa,ta]=b.CIMSymbolHelper.getTextureAnchor(Y,ia);ea=I.primitiveName;ia=r.getValue(I.rotation);oa=r.getValue(I.offsetX);const wa=r.getValue(I.offsetY);
pa=c.numericHash(JSON.stringify(Y)+pa).toString();const Aa=0<na.length||m.isSome(P)&&"function"===typeof P;P={type:"marker",templateHash:pa,materialHash:Aa?W(pa,ca,na,fa):pa,cim:Y,materialOverrides:na,colorLocked:I.colorLocked,effects:P,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:la,anchorPoint:{x:sa,y:qa},isAbsoluteAnchorPoint:!1,size:I.size,rotation:R(ea,ca,"Rotation",fa,ia),offsetX:R(ea,ca,"OffsetX",fa,oa),offsetY:R(ea,ca,"OffsetY",fa,wa),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ja,rotateClockwise:I.rotateClockwise,referenceSize:ka,sizeRatio:ta/l.pt2px(I.size),markerPlacement:O,animatedSymbolProperties:V};ha.push(P)}function aa(I){return I&&0===I.indexOf("Level_")&&(I=parseInt(I.substr(6),10),!isNaN(I))?I:0}function da(I){if(!I||0===I.length)return null;I=(new E(I)).toRgba();return{r:I[0],g:I[1],b:I[2],a:I[3]}}function R(I,P,O,V,Y,ca,ea){if(I=P[I]){const fa=I[O];if("string"===typeof fa||"number"===typeof fa||fa instanceof Array)return ca?
ca.call(null,fa,ea):fa;if(null!=fa&&fa instanceof a.ArcadeExpression)return(ha,ia,la)=>{ha=h(fa,ha,{$view:la},V.geometryType,ia);null!==ha&&ca&&(ha=ca.call(null,ha,ea));return null!==ha?ha:Y}}return Y}function M(I){return I?I.charAt(0).toLowerCase()+I.substr(1):I}function Q(I,P,O,V){for(const Y of P)if(Y.valueExpressionInfo){const ca=O[Y.primitiveName]&&O[Y.primitiveName][Y.propertyName];ca instanceof a.ArcadeExpression&&(Y.fn=(ea,fa,ha)=>h(ca,ea,{$view:ha},V.geometryType,fa))}return(Y,ca,ea)=>{for(var fa of P)fa.fn&&
(fa.value=fa.fn(Y,ca,ea));Y=[];for(let ha of I){if(ca=ha?.primitiveName){ea=!1;for(const ia of P)ia.primitiveName===ca&&(fa=M(ia.propertyName),null!=ia.value&&ia.value!==ha[fa]&&(ea||(ha=A.clone(ha),ea=!0),ha[fa]=ia.value))}Y.push(ha)}return Y}}function N(I,P,O,V){const Y=[];b.OverrideHelper.findApplicableOverrides(I,P,Y);if(0===Y.length)return I;for(const ca of Y)if(ca.valueExpressionInfo){const ea=O[ca.primitiveName]&&O[ca.primitiveName][ca.propertyName];ea instanceof a.ArcadeExpression&&(ca.fn=
(fa,ha,ia)=>h(ea,fa,{$view:ia},V.geometryType,ha))}return(ca,ea,fa)=>{for(const ha of Y)ha.fn&&(ha.value=ha.fn(ca,ea,fa));ca=A.clone(I);ea=I.primitiveName;for(const ha of Y)ha.primitiveName===ea&&(fa=M(ha.propertyName),null!=ha.value&&ha.value!==ca[fa]&&(ca[fa]=ha.value));return ca}}function S(I,P,O,V){const Y=[];b.OverrideHelper.findApplicableOverrides(I,P,Y);if(0===Y.length)return I;for(const ca of Y)if(ca.valueExpressionInfo){const ea=O[ca.primitiveName]&&O[ca.primitiveName][ca.propertyName];ea instanceof
a.ArcadeExpression&&(ca.fn=(fa,ha,ia)=>h(ea,fa,{$view:ia},V.geometryType,ha))}return(ca,ea,fa)=>{for(var ha of Y)ha.fn&&(ha.value=ha.fn(ca,ea,fa));ca=A.clone(I);ea=I.primitiveName;for(const ia of Y)ia.primitiveName===ea&&(fa=M(ia.propertyName),null!=ia.value&&(ha=e.quantizeIfNeeded(ia.value,ia.propertyName),ha!==ca[fa]&&(ca[fa]=ha)));return ca}}function W(I,P,O,V){for(const Y of O)if(Y.valueExpressionInfo){const ca=P[Y.primitiveName]&&P[Y.primitiveName][Y.propertyName];ca instanceof a.ArcadeExpression&&
(Y.fn=(ea,fa,ha)=>h(ca,ea,{$view:ha},V.geometryType,fa))}return(Y,ca,ea)=>{for(const fa of O)fa.fn&&(fa.value=fa.fn(Y,ca,ea));return c.numericHash(I+b.OverrideHelper.buildOverrideKey(O)).toString()}}function T(I,P,O,V,Y){let ca=!1,ea="";for(const fa of I)fa.primitiveName===P&&(void 0!==fa.value?ea+=`-${fa.primitiveName}-${fa.propertyName}-${JSON.stringify(fa.value)}`:fa.valueExpressionInfo&&(ca=!0));m.isSome(O)&&"function"===typeof O&&(ca=!0);m.isSome(V)&&"function"===typeof V&&(ca=!0);m.isSome(Y)&&
"function"===typeof Y&&(ca=!0);return[ca,ea]}const ba=y.getLogger("esri.symbols.cim.cimAnalyzer");q.analyzeCIMResource=function(I,P){if(!P||0===P.length)return I;I=A.clone(I);b.OverrideHelper.applyOverrides(I,P);return I};q.analyzeCIMSymbol=function(I,P,O,V,Y){return z.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(q){const t=new Set(["StartTimeOffset","Duration",
"RepeatDelay"]);q.quantizeIfNeeded=function(E,C){return t.has(C)?.05*Math.max(Math.round(E/.05),1):E};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b){return function(d){function e(p,r,v){var h=d.call(this,p)||this;h._minMaxZoom=y.i1616to32(Math.round(r*A.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(v*A.MIN_MAX_ZOOM_PRECISION_FACTOR));h._cimLineLayer=p;let w=0;l.isFunction(p.width)||(w=.5*E.pt2px(p.width));h._dynamicPropertyMap.set("_halfWidth",(g,f,n)=>l.isFunction(p.width)?.5*E.pt2px(p.width(g,f,n)):w);l.isFunction(p.cap)?h._dynamicPropertyMap.set("_capType",p.cap):h._capType=p.cap;l.isFunction(p.join)?h._dynamicPropertyMap.set("_joinType",
p.join):h._joinType=p.join;const u=p.color;l.isFunction(u)?h._dynamicPropertyMap.set("_fillColor",(g,f,n)=>C.premultiplyAlphaRGBA(u(g,f,n))):h._fillColor=u&&C.premultiplyAlphaRGBA(u)||0;const k=p.miterLimit;l.isFunction(k)?h._dynamicPropertyMap.set("_miterLimitCosine",(g,f,n)=>l.getLimitCosine(k(g,f,n))):h._miterLimitCosine=l.getLimitCosine(k);t.isSome(p.effects)&&(r=p.effects,l.isFunction(r)?h._dynamicPropertyMap.set("_effects",r):h._effects=r);h._scaleFactor=p.scaleFactor||1;h._isDashed=null!=p.dashTemplate;
h.tessellationProperties._bitset=(p.colorLocked?A.BITSET_GENERIC_LOCK_COLOR:0)|(p.scaleDash?A.BITSET_LINE_SCALE_DASH:0)|(p.sampleAlphaOnly?A.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);h._materialKey=p.materialKey;h._initializeTessellator(!0);return h}q._inheritsLoose(e,d);e.fromCIMLine=function(p,r){const [v,h]=l.getMinMaxZoom(p.scaleInfo,r);return new e(p,v,h)};e.prototype.bindFeature=function(p,r,v){const h=p.readLegacyFeature();this._dynamicPropertyMap.forEach((u,k)=>{this[k]=u(h,r,v)});this._halfWidth*=
this._scaleFactor;p=this._materialCache;var w=this._cimLineLayer.materialHash;w=w(h,r,v);w=p.get(w);p=null;w&&b.ok(w.spriteMosaicItem)&&(p=w.spriteMosaicItem);if(p){this._hasPattern=!0;const {rect:u,width:k,height:g}=p;w=u.x+A.SPRITE_PADDING;const f=u.y+A.SPRITE_PADDING,n=w+k,z=f+g;this.tessellationProperties._tl=y.i1616to32(w,f);this.tessellationProperties._br=y.i1616to32(n,z)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;w=m.LineMaterialKey.load(this._materialKey);p&&(w.sdf=p.sdf,w.pattern=!0,w.textureBinding=p.textureBinding);this._materialKey=w.data};return e}(c(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v){const h=m.create(),w=y.create();return function(u){function k(g,f,n){var z=u.call(this,g)||this;z._cimMarkerLayer=g;z._minMaxZoom=b.i1616to32(Math.round(f*a.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*a.MIN_MAX_ZOOM_PRECISION_FACTOR));const x=g.color;e.isFunction(x)?z._dynamicPropertyMap.set("_fillColor",(J,L,K)=>c.premultiplyAlphaRGBA(x(J,L,K))):z._fillColor=c.premultiplyAlphaRGBA(x);const B=g.outlineColor;e.isFunction(B)?z._dynamicPropertyMap.set("_outlineColor",
(J,L,K)=>c.premultiplyAlphaRGBA(B(J,L,K))):z._outlineColor=c.premultiplyAlphaRGBA(B);const D=g.size;e.isFunction(D)?z._dynamicPropertyMap.set("_size",(J,L,K)=>A.pt2px(D(J,L,K))):z._size=A.pt2px(D)||0;f=g.scaleX;e.isFunction(f)?z._dynamicPropertyMap.set("_scaleX",f):z._scaleX=f;const F=g.offsetX;e.isFunction(F)?z._dynamicPropertyMap.set("xOffset",(J,L,K)=>A.pt2px(F(J,L,K))):z.xOffset=A.pt2px(F)||0;const G=g.offsetY;e.isFunction(G)?z._dynamicPropertyMap.set("yOffset",(J,L,K)=>A.pt2px(G(J,L,K))):z.yOffset=
A.pt2px(G)||0;const H=g.outlineWidth;e.isFunction(H)?z._dynamicPropertyMap.set("_outlineWidth",(J,L,K)=>A.pt2px(H(J,L,K))):z._outlineWidth=A.pt2px(H)||0;f=g.rotation;e.isFunction(f)?z._dynamicPropertyMap.set("_angle",f):z._angle=f||0;C.isSome(g.effects)&&(f=g.effects,e.isFunction(f)?z._dynamicPropertyMap.set("_effects",f):z._effects=f);C.isSome(g.markerPlacement)&&(f=g.markerPlacement,e.isFunction(f)?z._dynamicPropertyMap.set("_markerPlacement",f):z._markerPlacement=f);z._scaleFactor=C.unwrapOr(g.scaleFactor,
1);z._bitSet=(g.alignment===l.Alignment.MAP?1:0)|(g.colorLocked?1:0)<<1|(g.scaleSymbolsProportionally?1:0)<<3;z._materialKey=g.materialKey;return z}q._inheritsLoose(k,u);k.fromCIMMarker=function(g,f){const [n,z]=e.getMinMaxZoom(g.scaleInfo,f);return new k(g,n,z)};k.prototype.bindFeature=function(g,f,n){const z=g.readLegacyFeature();g=g.getObjectId();this._dynamicPropertyMap.forEach((aa,da)=>{this[da]=aa(z,f,n)});var x=this._cimMarkerLayer.materialHash;g="function"===typeof x?x(z,f,n,g):x;if((g=this._materialCache.get(g))&&
v.ok(g.spriteMosaicItem)&&g.spriteMosaicItem){g=g.spriteMosaicItem;x=this._cimMarkerLayer.sizeRatio;var B=g.width/g.height*this._scaleX,D=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,F=this._size,G=F*B,H=this.xOffset,J=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var L=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/A.pt2px(this._cimMarkerLayer.frameHeight):1;L*=this._outlineWidth;var K=A.pt2px(this._cimMarkerLayer.referenceSize),
U=0,X=0,Z=this._cimMarkerLayer.anchorPoint;Z&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(U=A.pt2px(Z.x)/(this._size*B),X=A.pt2px(Z.y)/this._size):(U=Z.x,X=Z.y));this._anchorX=U;this._anchorY=X;this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*G),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*L),255)),Math.round(Math.min(Math.sqrt(128*K),255)));this.angle=D;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*x));B=g.rect.x+
a.SPRITE_PADDING;D=g.rect.y+a.SPRITE_PADDING;L=B+g.width;K=D+g.height;this._texUpperLeft=b.i1616to32(B,D);this._texUpperRight=b.i1616to32(L,D);this._texBottomLeft=b.i1616to32(B,K);this._texBottomRight=b.i1616to32(L,K);B=d.MarkerMaterialKey.load(this._materialKey);B.sdf=g.sdf;B.pattern=!0;B.textureBinding=g.textureBinding;this._materialKey=B.data;G=G*x*this._scaleFactor;F=F*x*this._scaleFactor;G*=g.rect.width/g.width;F*=g.rect.height/g.height;this._computedWidth=G;this._computedHeight=F;this._applyTransformation(w,
h);this.xOffset=H;this.yOffset=J}else E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new t("mapview-cim","Encountered an error when binding feature"))};return k}(p(r))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){return function(p){function r(h,w,u){var k=p.call(this,h)||this;k._horizontalAlignment="center";k._verticalAlignment="middle";k._textToGlyphs=new Map;k._minMaxZoom=l.i1616to32(Math.round(w*m.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(u*m.MIN_MAX_ZOOM_PRECISION_FACTOR));w=h.scaleFactor||1;k._cimTextLayer=h;const g=h.color;a.isFunction(g)?k._dynamicPropertyMap.set("_color",(B,D,F)=>y.premultiplyAlphaRGBA(g(B,D,F))):k._color=y.premultiplyAlphaRGBA(g);const f=h.outlineColor;
a.isFunction(f)?k._dynamicPropertyMap.set("_haloColor",(B,D,F)=>y.premultiplyAlphaRGBA(f(B,D,F))):k._haloColor=y.premultiplyAlphaRGBA(f);let n;a.isFunction(h.size)||(n=Math.min(Math.round(E.pt2px(h.size*h.sizeRatio)),127));k._dynamicPropertyMap.set("_size",(B,D,F)=>a.isFunction(h.size)?Math.min(Math.round(E.pt2px(h.size(B,D,F)*h.sizeRatio)),127):n);a.isFunction(h.outlineSize)?k._dynamicPropertyMap.set("_haloSize",(B,D,F)=>Math.min(Math.floor(5*E.pt2px(h.outlineSize(B,D,F)*h.sizeRatio)),127)):k._haloSize=
Math.min(Math.floor(5*E.pt2px(h.outlineSize*h.sizeRatio)),127);let z;a.isFunction(h.offsetX)||(z=Math.round(E.pt2px(h.offsetX*h.sizeRatio)));k._dynamicPropertyMap.set("_xOffset",(B,D,F)=>a.isFunction(h.offsetX)?Math.round(E.pt2px(h.offsetX(B,D,F)*h.sizeRatio)):z);let x;a.isFunction(h.offsetY)||(x=Math.round(E.pt2px(h.offsetY*h.sizeRatio)));k._dynamicPropertyMap.set("_yOffset",(B,D,F)=>a.isFunction(h.offsetY)?Math.round(E.pt2px(h.offsetY(B,D,F)*h.sizeRatio)):x);a.isFunction(h.angle)?k._dynamicPropertyMap.set("_angle",
h.angle):k._angle=h.angle;a.isFunction(h.horizontalAlignment)?k._dynamicPropertyMap.set("_horizontalAlignment",h.horizontalAlignment):k._horizontalAlignment=h.horizontalAlignment;a.isFunction(h.verticalAlignment)?k._dynamicPropertyMap.set("_verticalAlignment",h.verticalAlignment):k._verticalAlignment=h.verticalAlignment;t.isSome(h.effects)&&(u=h.effects,a.isFunction(u)?k._dynamicPropertyMap.set("_effects",u):k._effects=u);t.isSome(h.markerPlacement)&&(u=h.markerPlacement,a.isFunction(u)?k._dynamicPropertyMap.set("_markerPlacement",
u):k._textPlacement=u);a.isFunction(h.text)?k._dynamicPropertyMap.set("_text",h.text):k._text=h.text;k._scaleFactor=w;w=Math.min(Math.round(E.pt2px(h.referenceSize*h.sizeRatio)),127);k._referenceSize=Math.round(Math.sqrt(256*w));k._materialKey=h.materialKey;w=c.TextMaterialKey.load(k._materialKey);w.sdf=!0;k._bitset=(h.alignment===C.Alignment.MAP?1:0)|(h.colorLocked?1:0)<<1;k._materialKey=w.data;k._decoration="none";k._lineHeight=1;k._lineWidth=512;k._isCIM=!0;return k}q._inheritsLoose(r,p);r.fromCIMText=
function(h,w){const [u,k]=a.getMinMaxZoom(h.scaleInfo,w);return new r(h,u,k)};var v=r.prototype;v.analyze=function(){var h=q._asyncToGenerator(function*(w,u,k,g){var f=u.readLegacyFeature();var n=this._cimTextLayer;f="string"===typeof n.text?n.text:"function"===typeof n.text?n.text(f,k,g):"";(w=yield p.prototype.analyze.call(this,w,u,k,g,e.codepoints(f)))&&w.glyphMosaicItems&&this._textToGlyphs.set(f,w.glyphMosaicItems);return w});return function(w,u,k,g){return h.apply(this,arguments)}}();v.bindFeature=
function(h,w,u){const k=h.readLegacyFeature();this._dynamicPropertyMap.forEach((g,f)=>{this[f]=g(k,w,u)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/m.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=A.getXAnchorDirection(t.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=A.getYAnchorDirection(t.unwrapOr(this._verticalAlignment,"baseline")),h=this._textToGlyphs.get(this._text),this.bindTextInfo(h,!1)):
this._shapingInfo=null};return r}(b(d))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(q){q.codepoints=function(t){const E=Array(t.length);for(let C=0;C<t.length;C++)E[C]=t.charCodeAt(C);return E};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(q,t,E,C,A,y,m,l,c,a){return function(b){function d(e,p,r,v,h,w,u,k,g,f,n,z,x,B,D,F){var G=b.call(this)||this;G._effects=B;e=m.FillMaterialKey.load(e);p&&(e.sdf=p.sdf,e.pattern=!0,e.textureBinding=p.textureBinding);G.fillColor=r;G.tl=v;G.br=h;G.aux21=y.i1616to32(w,u);G.aux22=y.i1616to32(k,g);G.aux3=y.i8888to32(f,n,z,0);G._bitset=x;G._minMaxZoom=y.i1616to32(Math.round(D*C.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(F*C.MIN_MAX_ZOOM_PRECISION_FACTOR));G._materialKey=e.data;return G}q._inheritsLoose(d,
b);d.fromCIMFill=function(e,p,r){var v=e.color;v=v&&E.premultiplyAlphaRGBA(v)||0;const h=e.materialKey,[w,u]=l.getMinMaxZoom(e.scaleInfo,r);r=(e.colorLocked?C.BITSET_GENERIC_LOCK_COLOR:0)|(e.applyRandomOffset?C.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(e.sampleAlphaOnly?C.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!p)return new d(h,null,v,0,0,0,0,0,0,0,0,0,r,e.effects,w,u);const {rect:k,width:g,height:f}=p;var n=e.scaleX||1,z=k.x+C.SPRITE_PADDING;const x=k.y+C.SPRITE_PADDING;var B=z+g;const D=x+f;var F=
t.pt2px(e.height);let G=Math.round(F);0>=G&&(G=D-x);n=Math.round(n*F);0>=n&&(n=B-z);F=t.pt2px(e.offsetX||0);const H=t.pt2px(-e.offsetY||0);z=y.i1616to32(z,x);B=y.i1616to32(B,D);return new d(h,p,v,z,B,n,G,F,H,128,128,A.degToByte(e.angle),r,e.effects,w,u)};d.fromSimpleFill=function(e,p,r=!1){var {color:v}=e;v=v&&"esriSFSNull"!==e.style&&E.premultiplyAlphaRGBAArray(v)||0;r=r?C.BITSET_GENERIC_LOCK_COLOR:0;const h=e.materialKey;if(p){const {rect:k,width:g,height:f,pixelRatio:n}=p;var w=k.x+C.SPRITE_PADDING;
const z=k.y+C.SPRITE_PADDING;var u=w+g;const x=z+f;w=y.i1616to32(w,z);u=y.i1616to32(u,x);p=new d(h,p,v,w,u,g/n,f/n,0,0,128,128,0,r,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM)}else p=new d(h,null,v,0,0,0,0,0,0,0,0,0,r,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);p._maybeAddLineTemplate(e);return p};d.fromPictureFill=function(e,p,r=!1){const v=C.PICTURE_FILL_COLOR,{rect:h,width:w,height:u}=p;var k=h.x+C.SPRITE_PADDING,g=h.y+C.SPRITE_PADDING,f=k+w,n=g+u;k=y.i1616to32(k,g);f=y.i1616to32(f,n);n=Math.round(t.pt2px(e.width));
g=Math.round(t.pt2px(e.height));const z=t.pt2px(e.xoffset),x=t.pt2px(-e.yoffset);p=new d(e.materialKey,p,v,k,f,n,g,z,x,128*e.xscale,128*e.yscale,0,r?C.BITSET_GENERIC_LOCK_COLOR:0,null,l.DEFAULT_MIN_ZOOM,l.DEFAULT_MAX_ZOOM);p._maybeAddLineTemplate(e);return p};return d}(c(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(q,t,E){function C(){C=t._asyncToGenerator(function*(y,m,l){try{yield y.acquire(),
yield m(l),y.release()}catch(c){throw y.release(),c;}});return C.apply(this,arguments)}let A=function(){function y(){this._resolver=null}var m=y.prototype;m.isHeld=function(){return!!this._resolver};m.acquire=function(){var l=t._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=E.createResolver()});return function(){return l.apply(this,arguments)}}();m.release=function(){const l=this._resolver;this._resolver=null;l?.resolve()};return y}();
q.Lock=A;q.withLock=function(y,m,l){return C.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(q,t,E,C,A){const y=function(){var c=t._asyncToGenerator(function*(a,b,d,e){return Promise.all(a.map(p=>l(p,b,d,e)))});
return function(a,b,d,e){return c.apply(this,arguments)}}(),m=function(){var c=t._asyncToGenerator(function*(a,b,d){return new C.ExpandedCIM(yield E.analyzeCIMSymbol(a.data,b,d),a.data,a.rendererKey,a.maxVVSize)});return function(a,b,d){return c.apply(this,arguments)}}(),l=function(){var c=t._asyncToGenerator(function*(a,b,d,e){return a?"cim"===a.type?m(a,b,d):"web-style"===a.type?(a={type:"cim",data:yield A.fetchCIMSymbolReference(a,null,e),rendererKey:a.rendererKey,maxVVSize:a.maxVVSize},m(a,b,
d)):a:null});return function(a,b,d,e){return c.apply(this,arguments)}}();q.cimLayerToRasterizationInfo=function(c){if(!c)return null;const {type:a,cim:b,url:d,materialHash:e}=c,p={cim:b,type:a,mosaicHash:e,url:d,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(a){case "marker":p.size=c.size;p.path=c.path;p.animatedSymbolProperties=c.animatedSymbolProperties;break;case "line":p.dashTemplate=c.dashTemplate;break;case "text":p.text=c.text,p.fontName=
c.fontName}return p};q.expandSymbol=l;q.expandSymbols=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(q,t,E,C){const A={marker:E.WGLGeometryType.MARKER,fill:E.WGLGeometryType.FILL,line:E.WGLGeometryType.LINE,text:E.WGLGeometryType.TEXT};let y=function(){function m(l,
c,a,b){const d={minScale:c?.minScale,maxScale:c?.maxScale};var e=d.minScale||d.maxScale?d.minScale+"-"+d.maxScale:"";this.layers=l;this.data=c;this.hash=this._createHash()+e;this.rendererKey=a;c={isOutline:!1,placement:null,symbologyType:E.WGLSymbologyType.DEFAULT,vvFlags:a};for(const p of l)l=A[p.type],c.isOutline="line"===p.type&&p.isOutline,p.materialKey=C.createMaterialKey(l,c),p.maxVVSize=b,p.scaleInfo=d,p.templateHash+=e}m.prototype._createHash=function(){let l="";for(const c of this.layers)l+=
c.templateHash;return l};t._createClass(m,[{key:"type",get:function(){return"expanded-cim"}}]);return m}();q.ExpandedCIM=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a){function b(){b=t._asyncToGenerator(function*(v,h,w){if(!v.name)throw new C("style-symbol-reference-name-missing","Missing name in style symbol reference");if(v.styleName&&"Esri2DPointSymbolsStyle"===v.styleName)return d(v,w);try{const u=yield a.fetchStyle(v,h,w);return p(u,v.name,h,w)}catch(u){return y.throwIfAborted(u),null}});return b.apply(this,arguments)}function d(v,h){return e.apply(this,arguments)}function e(){e=t._asyncToGenerator(function*(v,h){v=a.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
v.name);try{const w=yield a.requestJSON(v,h);return a.makeCIMSymbolRef(w.data)}catch(w){return y.throwIfAborted(w),null}});return e.apply(this,arguments)}function p(v,h,w,u){return r.apply(this,arguments)}function r(){r=t._asyncToGenerator(function*(v,h,w,u){var k=v.data;v={portal:w&&A.isSome(w.portal)?w.portal:l.getDefault(),url:m.urlToObject(v.baseUrl),origin:"portal-item"};k=k.items.find(g=>g.name===h);if(!k)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${h}' could not be found`,
{symbolName:h});k=c.fromJSON(a.symbolUrlFromStyleItem(k,"cimRef"),v);E.isDevEnvironment()&&(k=E.adjustStaticAGOUrl(k));try{const g=yield a.requestJSON(k,u);return a.makeCIMSymbolRef(g.data)}catch(g){return y.throwIfAborted(g),null}});return r.apply(this,arguments)}q.fetchCIMSymbolReference=function(v,h,w){return b.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(q){const t=
/^devext.arcgis.com$/,E=/^qaext.arcgis.com$/,C=/^[\w-]*\.mapsdevext.arcgis.com$/,A=/^[\w-]*\.mapsqa.arcgis.com$/,y=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,t,E,/^jsapps.esri.com$/,C,A];q.adjustStaticAGOUrl=function(m,l){return m?(l=l||globalThis.location.hostname)?null!=l.match(t)||null!=l.match(C)?m.replace("static.arcgis.com","staticdev.arcgis.com"):null!=l.match(E)||null!=l.match(A)?m.replace("static.arcgis.com","staticqa.arcgis.com"):m:m:m};q.isDevEnvironment=function(m){m=m||globalThis.location.hostname;
return y.some(l=>null!=m?.match(l))};q.isTelemetryDevEnvironment=function(m){m=m||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(y).some(l=>null!=m?.match(l))};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(q,t,E,C,A,y,m,l,c){function a(n,z,x,B){return b.apply(this,arguments)}function b(){b=E._asyncToGenerator(function*(n,z,x,B){switch(n.type){case "simple":case "heatmap":return h.fromBasicRenderer(n,z,x,B);case "map":return k.fromUVRenderer(n,z,x,B);case "interval":return u.fromCBRenderer(n,z,x,B);case "dictionary":return f.fromDictionaryRenderer(n,z,x,B);case "pie-chart":return w.fromPieChartRenderer(n,z,x,B);case "subtype":return w.fromSubtypes(n,z,x,B)}});return b.apply(this,arguments)}
function d(n,z){return e.apply(this,arguments)}function e(){e=E._asyncToGenerator(function*(n,z){const x=n||1;if("number"===typeof x)return(D,F,G)=>x;const B=yield m.createRendererExpression(x,z.spatialReference,z.fields);return(D,F,G)=>l(B,D,{$view:G},z.geometryType,F)||1});return e.apply(this,arguments)}function p(){return r.apply(this,arguments)}function r(){r=E._asyncToGenerator(function*(){g||(g=new Promise((n,z)=>q(["../../../layers/features/createSymbolSchema"],n,z)));return g});return r.apply(this,
arguments)}const v=A.getLogger("esri/views/2d/engine/webgl/util/Matcher");let h=function(){function n(){this.type="feature";this._defaultResult=null}n.fromBasicRenderer=function(){var x=E._asyncToGenerator(function*(B,D,F,G){const H=new n;B.symbol&&(B=yield c.expandSymbol(B.symbol,F,G),D=D.createTemplateGroup(B,null),H.setDefault(D));return H});return function(B,D,F,G){return x.apply(this,arguments)}}();n.fromPieChartRenderer=function(){var x=E._asyncToGenerator(function*(B,D,F,G){const H=new n;if(B.markerSymbol){const J=
yield c.expandSymbol(B.markerSymbol,F,G);let L;B.fillSymbol&&(L=yield c.expandSymbol(B.fillSymbol,F,G));B=D.createTemplateGroup(J,L);H.setDefault(B)}return H});return function(B,D,F,G){return x.apply(this,arguments)}}();var z=n.prototype;z.size=function(){return 1};z.getDefault=function(){return this._defaultResult};z.setDefault=function(x){this._defaultResult=x};z.match=function(x,B,D,F,G){return this.getDefault()};z.analyze=function(){var x=E._asyncToGenerator(function*(B,D,F,G,H,J){return null});
return function(B,D,F,G,H,J){return x.apply(this,arguments)}}();return n}(),w=function(n){function z(x,B){var D=n.call(this)||this;D._subMatchers=x;D._subtypeField=B;return D}E._inheritsLoose(z,n);z.fromSubtypes=function(){var x=E._asyncToGenerator(function*(B,D,F,G){const H=new Map,J=[];for(const L in B.renderers){const K=parseInt(L,10),U=a(B.renderers[L],D,F,G).then(X=>H.set(K,X));J.push(U)}yield Promise.all(J);return new z(H,B.subtypeField)});return function(B,D,F,G){return x.apply(this,arguments)}}();
z.prototype.match=function(x,B,D,F,G){var H=B.readAttribute(this._subtypeField);return(H=this._subMatchers.get(H))?H.match(x,B,D,F,G):null};return z}(h),u=function(n){function z(B,D,F,G){var H=n.call(this)||this;H.type="interval";H._intervals=[];H._isMaxInclusive=D;H._fieldIndex=G;H._field=B;H._normalizationInfo=F;return H}E._inheritsLoose(z,n);z.fromCBRenderer=function(){var B=E._asyncToGenerator(function*(D,F,G,H){const {isMaxInclusive:J,normalizationField:L,normalizationTotal:K,normalizationType:U}=
D,X=new z(D.field,J,{normalizationField:L,normalizationTotal:K,normalizationType:U},D.fieldIndex),Z=yield c.expandSymbol(D.backgroundFillSymbol,G,H);yield Promise.all(D.intervals.map(function(){var aa=E._asyncToGenerator(function*(da){var R=yield c.expandSymbol(da.symbol,G,H);R=yield F.createTemplateGroup(R,Z);X.add({min:da.min,max:da.max},R)});return function(da){return aa.apply(this,arguments)}}()));if(D=yield c.expandSymbol(D.defaultSymbol,G,H))D=yield F.createTemplateGroup(D,Z),X.setDefault(D);
return X});return function(D,F,G,H){return B.apply(this,arguments)}}();var x=z.prototype;x.add=function(B,D){this._intervals.push({interval:B,result:D});this._intervals.sort((F,G)=>F.interval.min-G.interval.min)};x.size=function(){return n.prototype.size.call(this)+this._intervals.length};x.match=function(B,D,F,G,H){if(null==this._fieldIndex&&!this._field)return this.getDefault();B=null!=this._fieldIndex?D.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(D);if(null===B||void 0===
B||isNaN(B)||Infinity===B||-Infinity===B)return this.getDefault();for(D=0;D<this._intervals.length;D++){const {interval:J,result:L}=this._intervals[D];F=this._isMaxInclusive?B<=J.max:B<J.max;if(B>=J.min&&F)return L}return this.getDefault()};x._needsNormalization=function(){const B=this._normalizationInfo;return B&&(B.normalizationField||B.normalizationTotal||B.normalizationType)};x._getValueFromField=function(B){const D=B.readAttribute(this._field);if(!this._needsNormalization()||null==D)return D;
const {normalizationField:F,normalizationTotal:G,normalizationType:H}=this._normalizationInfo;B=!!F&&B.readAttribute(F);if(H)switch(H){case "esriNormalizeByField":return(B||void 0)&&D/B;case "esriNormalizeByLog":return Math.log(D)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return D/G*100;default:v.error(`Found unknown normalization type: ${H}`)}else v.error("Normalization is required, but no type was set!")};return z}(h),k=function(n){function z(B,D,F){var G=n.call(this)||this;G.type="map";
G._nullResult=null;G._resultsMap=new Map;G._fieldsIndex=F;G._fields=B;G._seperator=D||"";return G}E._inheritsLoose(z,n);z.fromUVRenderer=function(){var B=E._asyncToGenerator(function*(D,F,G,H){const J=D.fieldDelimiter,L=[D.field];D.field2&&L.push(D.field2);D.field3&&L.push(D.field3);const K=yield c.expandSymbol(D.backgroundFillSymbol,G,H),U=new z(L,J,D.fieldIndex);yield Promise.all(D.map.map(function(){var X=E._asyncToGenerator(function*(Z){var aa=yield c.expandSymbol(Z.symbol,G,H);aa=yield F.createTemplateGroup(aa,
K);"\x3cNull\x3e"===Z.value?U.setNullResult(aa):U.add(Z.value,aa)});return function(Z){return X.apply(this,arguments)}}()));if(D=yield c.expandSymbol(D.defaultSymbol,G,H))D=yield F.createTemplateGroup(D,K),U.setDefault(D);return U});return function(D,F,G,H){return B.apply(this,arguments)}}();var x=z.prototype;x.setNullResult=function(B){this._nullResult=B};x.add=function(B,D){this._resultsMap.set(B.toString(),D)};x.size=function(){return n.prototype.size.call(this)+this._resultsMap.size};x.match=
function(B,D,F,G,H){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();B=null!=this._fieldsIndex?D.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(D);if(null!==this._nullResult&&(null==B||""===B||"\x3cNull\x3e"===B))return this._nullResult;if(null==B)return this.getDefault();B=B.toString();return this._resultsMap.has(B)?this._resultsMap.get(B):this.getDefault()};x._getValueFromFields=function(B){const D=[];for(const F of this._fields){const G=B.readAttribute(F);
null==G||""===G?D.push("\x3cNull\x3e"):D.push(G)}return D.join(this._seperator)};return z}(h),g,f=function(n){function z(B,D,F,G,H,J){var L=n.call(this)||this;L.type="dictionary";L._groupIdCache=new y(100);L._loader=B;L._fieldMap=B.fieldMap;L._symbolFields=B.getSymbolFields();L._templates=D;L._info=F;L._scaleFn=G;L._schemaUtilsModule=H;L._symbolOptions=J;return L}E._inheritsLoose(z,n);z.fromDictionaryRenderer=function(){var B=E._asyncToGenerator(function*(D,F,G,H){const [{DictionaryLoader:J},L]=yield Promise.all([new Promise((U,
X)=>q(["../../../../../renderers/support/DictionaryLoader"],U,X)),p()]);H=new J(D.url,D.config,D.fieldMap);yield H.fetchResources({spatialReference:G.spatialReference,fields:G.fields});const K=yield d(D.scaleExpression,G);return new z(H,F,G,K,L,D.symbolOptions)});return function(D,F,G,H){return B.apply(this,arguments)}}();var x=z.prototype;x._analyzeFeature=function(){var B=E._asyncToGenerator(function*(D,F,G,H,J){D=D.readLegacyFeature();const L=this._scaleFn(D,G,H);G=this._attributeHash(D)+"-"+L;
const K=this._groupIdCache.get(G);if(K)return K;H=yield this._loader.getSymbolAsync(D,{...H,spatialReference:this._info.spatialReference,abortOptions:J,fields:this._info.fields});H=this._schemaUtilsModule.createSymbolSchema(H,this._symbolOptions);F=c.expandSymbol(H,this._info,F,J).then(U=>{if("expanded-cim"!==U.type)return v.error(new C("mapview-bad-type",`Found unexpected type ${U.type} in dictionary response`)),null;U.hash+="-"+L;for(const X of U.layers)X.scaleFactor=L,X.templateHash+="-"+L;return this._templates.createTemplateGroup(U,
null)});this._groupIdCache.put(G,F,1);return F});return function(D,F,G,H,J){return B.apply(this,arguments)}}();x.analyze=function(){var B=E._asyncToGenerator(function*(D,F,G,H,J,L){D=F.getCursor();for(F=[];D.next();)F.push(this._analyzeFeature(D,G,H,J,L));return Promise.all(F)});return function(D,F,G,H,J,L){return B.apply(this,arguments)}}();x.match=function(B,D,F,G,H){return null};x._attributeHash=function(B){let D="";for(const F of this._symbolFields){const G=this._fieldMap[F];G&&(D+=B.attributes[G]+
"-")}return D};return z}(h);t.DictionaryMatcher=f;t.FeatureMatcher=h;t.IntervalMatcher=u;t.MapMatcher=k;t.SubtypeMatcher=w;t.createMatcher=a;Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../core/sql ../../../../core/accessorSupport/diffUtils ../../../../layers/support/labelingInfo ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/techniques/utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w){function u(I,P){let O=0,V=0,Y=a.WGLSymbologyType.DEFAULT;if(A.isSome(I)){V=r.getPtMaxVVSize(I,P);"visualVariables"in I&&(O=e.getVVFlags(I.visualVariables||[]),"dot-density"===I.type&&(Y=a.WGLSymbologyType.DOT_DENSITY));"heatmap"===I.type&&(Y=a.WGLSymbologyType.HEATMAP);if("dictionary"===I.type)return{maxVVSize:V,vvFlags:O,symbologyType:a.WGLSymbologyType.DEFAULT};if("pie-chart"===I.type)return{maxVVSize:V,vvFlags:O,symbologyType:a.WGLSymbologyType.PIE_CHART};
if(Y!==a.WGLSymbologyType.DOT_DENSITY&&Y!==a.WGLSymbologyType.HEATMAP){var ca=I.getSymbols();"backgroundFillSymbol"in I&&I.backgroundFillSymbol&&ca.push(I.backgroundFillSymbol);P=I=!0;for(const fa of ca)if("cim"===fa.type&&(P=!1),"simple-fill"===fa.type||"picture-fill"===fa.type){ca=(ca=fa.outline)&&"none"!==ca.style&&"solid"!==ca.style;var ea="simple-fill"===fa.type&&"none"!==fa.style&&"solid"!==fa.style;ea="picture-fill"===fa.type||ea||ca;ca&&(I=!1);ea&&(P=!1)}I?Y=P?a.WGLSymbologyType.OUTLINE_FILL_SIMPLE:
a.WGLSymbologyType.OUTLINE_FILL:P&&(Y=a.WGLSymbologyType.SIMPLE)}}return{vvFlags:O,maxVVSize:V,symbologyType:Y}}function k(I,P=!1){try{const V=H(I,P);var O="heatmap"===I.renderer?.type&&"raster"===v.getSupportedHeatmapRenderer()?{type:"heatmap"}:{type:"symbol"};const Y={};V.map(ea=>g(Y,I,ea));const ca=A.isSome(I.subtypeCode)?`${I.subtypeField} = ${I.subtypeCode}`:null;return{source:{definitionExpression:m.sqlAnd(I.definitionExpression,ca),fields:I.fields.map(ea=>ea.toJSON()),gdbVersion:I.gdbVersion,
historicMoment:I.historicMoment?.getTime(),outFields:I.availableFields,pixelBuffer:I.pixelBuffer,spatialReference:I.spatialReference.toJSON(),timeExtent:I.timeExtent?.toJSON(),customParameters:I.customParameters},attributes:{fields:{},indexCount:0},processors:V,tileRenderer:O,targets:Y}}catch(V){if("ValidationError"===V.fieldName)return T.error(V),null;throw V;}}function g(I,P,O){switch(O.target){case "feature":z(I,n(P),O);break;case "aggregate":if("featureReduction"in P){var V=P.featureReduction;
switch(V.type){case "selection":throw new t("ValidationError","Mapview does not support `selection` reduction type",V);case "binning":z(I,n(P),O);B(I,V,P.fields.map(Y=>Y.toJSON()),O);break;case "cluster":z(I,n(P),O),D(I,V,P.fields.map(Y=>Y.toJSON()),O)}}}}function f(I,P){for(const O in P){const V=P[O];if(V.target!==I.name)continue;const Y=I.attributes[O];Y?(Y.context.mesh=Y.context.mesh||V.context.mesh,Y.context.storage=Y.context.storage||V.context.storage):I.attributes[O]=V}return I}function n(I){return[A.unwrap(I.filter)?.toJSON()??
null,A.unwrap(A.unwrap(I.featureEffect)?.filter)?.toJSON()??null]}function z(I,P,O){I.feature||(I.feature={name:"feature",input:"source",filters:P,attributes:{}});f(I.feature,O.attributes.fields);return I}function x(I,P){const {onStatisticExpression:O,onStatisticField:V,statisticType:Y}=I;switch(Y){case "min":case "max":case "avg":case "avg_angle":case "sum":case "count":return"esriFieldTypeDouble";case "mode":if(O)return{returnType:P}=O,P?"string"===P?"esriFieldTypeString":"esriFieldTypeDouble":
(T.error(new t("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",I)),"esriFieldTypeString");P=P.find(ca=>ca.name===V);return P?P.type:(T.error(new t("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",I)),"esriFieldTypeString")}}function B(I,P,O,V){I.aggregate||(I.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:P.fixedBinLevel,fields:(P.fields??
[]).map(Y=>({...Y.toJSON(),type:x(Y,O)}))},attributes:{}});f(I.aggregate,V.attributes.fields);return I}function D(I,P,O,V){I.aggregate||(I.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:y.pt2px(P.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(y.pt2px(P.clusterMaxSize)/64),fields:(P.fields??[])?.map(Y=>({...Y.toJSON(),type:x(Y,O)}))}});f(I.aggregate,V.attributes.fields);return I}function F(I,P){return P.field?G(I,{...P,type:"field",field:P.field}):
P.valueExpression?G(I,{...P,type:"expression",valueExpression:P.valueExpression}):{field:null,fieldIndex:null}}function G(I,P){switch(P.type){case "expression":var O=P.valueExpression;if(!I.fields[O]){var V=I.indexCount++;I.fields[O]={...P,name:O,fieldIndex:V}}return{fieldIndex:I.fields[O].fieldIndex};case "label-expression":return O=JSON.stringify(P.label),I.fields[O]||(V=I.indexCount++,I.fields[O]={...P,name:O,fieldIndex:V}),{fieldIndex:I.fields[O].fieldIndex};case "field":O=P.field;if("aggregate"===
P.target&&I.fields[O])return{field:O};I.fields[O]={...P,name:O};return{field:O};case "statistic":return I.fields[P.name]={...P},{field:P.name}}}function H(I,P=!1){const O=[];let V=0;O.push(K(I,V++,P));return O}function J(I,P,O,V,Y,ca=!1){I=G(I,{type:"label-expression",target:O,context:{mesh:!0},resultType:"string",label:{labelExpression:P.labelExpression,labelExpressionInfo:P.labelExpressionInfo?{expression:P.labelExpressionInfo.expression}:null,symbol:!!P.symbol,where:P.where}});({fieldIndex:I}=
I);return{...p.createSymbolSchema(P,Y,ca),fieldIndex:I,target:O,index:V}}function L(I,P,O){const V="featureReduction"in P&&P.featureReduction;if(!V)return{fields:[],labels:[],matcher:null,rendererOverride:null};const Y=[];let ca=null,ea=w.toJSONGeometryType(P.geometryType),fa=[];var ha=null;if(V)switch(V.type){case "selection":return T.error(new t("ValidationError","Mapview does not support `selection` reduction type",V)),{fields:[],labels:[],matcher:null,rendererOverride:null};case "cluster":case "binning":Y.push(...(V.fields??
[])),"cluster"===V.type?ea="esriGeometryPoint":"binning"===V.type&&(ea="esriGeometryPolygon"),V.renderer&&!V.renderer.authoringInfo?.isAutoGenerated?("cluster"===V.type?{renderer:ha}=h.injectDynamicLevelDependentSizeVisualVariable(V.renderer,V,null):ha=V.renderer,P=u(V.renderer,V),ca=R(null,"aggregate",V.renderer,P,O),fa=V&&V.labelsVisible&&V.labelingInfo||[]):"cluster"===V.type&&(ha=h.createClusterRenderer(Y,P.renderer,V,null,!0),V.symbol&&(P=u(ha,V),ca={type:"simple",symbol:p.createSymbolSchema(V.symbol,
P,O),symbologyType:P.symbologyType}),fa=V&&V.labelsVisible&&V.labelingInfo||[])}X(I,Y);return{labels:c.validateLabelingInfo(fa,"binning"===V.type?"esriGeometryPolygon":ea),matcher:ca,fields:Y,rendererOverride:ha}}function K(I,P,O=!1){const V={indexCount:0,fields:{}};var Y="featureReduction"in I&&I.featureReduction;P=Y?"aggregate":"feature";if("sublayers"in I){var ca={type:"subtype",subtypeField:I.subtypeField,renderers:{},symbologyType:a.WGLSymbologyType.DEFAULT},ea={type:"subtype",mapping:{},target:"feature"},
fa={type:"subtype",classes:{}},ha={type:"symbol",target:"feature",aggregateFields:[],attributes:V,storage:ea,mesh:{matcher:ca,aggregateMatcher:null,labels:fa,sortKey:null}};Y=new Set;let ka=0;for(const {renderer:ja,subtypeCode:ma,labelingInfo:na,labelsVisible:pa}of I.sublayers){const oa={symbologyType:a.WGLSymbologyType.DEFAULT,vvFlags:0,maxVVSize:0};I=R(V,P,ja,oa,O);const sa=Z(V,P,ja),qa=pa&&na;if("visualVariables"in ja&&ja.visualVariables&&ja.visualVariables.length)throw new t("ValidationError",
"Visual variables are currently not supported for subtype layers");if("dictionary"===I.type)throw new t("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===I.type)throw new t("ValidationError","Nested subtype renderers is not supported");if(A.isSome(sa)&&"subtype"===sa.type)throw new t("ValidationError","Nested subtype storage is not supported");if(A.isSome(sa)&&A.isSome(sa.attributeMapping))throw new t("ValidationError","Non-visual-variable attributes are not supported in subtype layers");
if("heatmap"===I.type)throw new t("ValidationError","Heatmaps are not supported in subtype layers");if("pie-chart"===I.type)throw new t("ValidationError","Pie-charts are not supported in subtype layers");if(Y.has(ma))throw new t("ValidationError","Subtype codes for sublayers must be unique");Y.add(ma);ca.renderers[ma]=I;ea.mapping[ma]=sa;qa&&(fa.classes[ma]=qa.map(ta=>J(V,ta,"feature",ka++,oa,O)))}return ha}if("heatmap"===I.renderer.type&&"raster"===v.getSupportedHeatmapRenderer()){const {radius:ka,
fieldOffset:ja,field:ma}=I.renderer;return{type:"heatmap",aggregateFields:[],attributes:V,target:P,storage:null,mesh:{radius:ka,fieldOffset:ja,field:F(V,{target:P,field:ma,resultType:"numeric"}).field}}}ca=L(V,I,O);fa=w.toJSONGeometryType(I.geometryType);ha=ca.rendererOverride??I.renderer;const ia=u(ha,Y);ea=R(V,P,ha,ia,O);ha=Z(V,P,ha);Y=U(V,I.orderBy,Y);let la=0;I=[...c.validateLabelingInfo(I.labelsVisible&&I.labelingInfo||[],fa).map(ka=>J(V,ka,"feature",la++,ia,O)),...ca.labels.map(ka=>J(V,ka,"aggregate",
la++,ia,O))];return{type:"symbol",target:P,attributes:V,aggregateFields:ca.fields,storage:ha,mesh:{matcher:ea,labels:{type:"simple",classes:I},aggregateMatcher:ca.matcher,sortKey:Y}}}function U(I,P,O){if(A.isSome(O)||A.isNone(P)||!P.length)return null;1<P.length&&T.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${P.length}. All but the first will be discarded`);P=P[0];O="ascending"===P.order?"asc":"desc";if(P.field)return{field:P.field,order:O};if(P.valueExpression)return{fieldIndex:G(I,
{type:"expression",target:"feature",valueExpression:P.valueExpression,resultType:"numeric"}).fieldIndex,order:O};T.error(new t("ValidationError","Expected to find a field or valueExpression for OrderByInfo",P));return null}function X(I,P){const O={mesh:!0,storage:!0};for(const V of P){const {name:Y,onStatisticField:ca,onStatisticExpression:ea,statisticType:fa}=V;let ha=P=null;ea?ha=G(I,{type:"expression",target:"feature",valueExpression:ea.expression,resultType:"numeric"}).fieldIndex:P=G(I,{type:"field",
target:"feature",field:ca,resultType:"numeric"}).field;G(I,{type:"statistic",target:"aggregate",name:Y,context:O,inField:P,inFieldIndex:ha,statisticType:fa})}}function Z(I,P,O){let V;switch(O.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":V={visualVariables:!0,attributes:null};break;default:V=d.getTechniqueFromRenderer(O).getStorageSpec(O)}return aa(I,P,V,O)}function aa(I,P,O,V){if(A.isNone(O))return null;const {visualVariables:Y,attributes:ca}=O;O=null;Y&&"visualVariables"in
V&&(O=da(I,P,V.visualVariables));const ea=A.isSome(O)?4:0;V=null;A.isSome(ca)&&(V=ca.map((fa,ha)=>{const {field:ia,fieldIndex:la}=F(I,{valueExpression:fa.valueExpression,field:fa.field,resultType:"numeric",target:P});return{binding:ha+ea,field:ia,fieldIndex:la}}));return{type:"simple",target:P,attributeMapping:V,vvMapping:O}}function da(I,P,O){if(!O||!O.length)return[];const V={storage:!0};return v.simplifyVisualVariables(O).map(Y=>{const ca=b.getVVType(Y.type),{field:ea,fieldIndex:fa}=F(I,{target:P,
valueExpression:Y.valueExpression,field:Y.field,context:V,resultType:"numeric"});switch(Y.type){case "size":return"$view.scale"===Y.valueExpression?null:{type:"size",binding:ca,field:ea,fieldIndex:fa,normalizationField:F(I,{target:P,field:Y.normalizationField,context:V,resultType:"numeric"}).field,valueRepresentation:Y.valueRepresentation??null};case "color":return{type:"color",binding:ca,field:ea,fieldIndex:fa,normalizationField:F(I,{target:P,field:Y.normalizationField,context:V,resultType:"numeric"}).field};
case "opacity":return{type:"opacity",binding:ca,field:ea,fieldIndex:fa,normalizationField:F(I,{target:P,field:Y.normalizationField,context:V,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:ca,field:ea,fieldIndex:fa}}}).filter(Y=>Y)}function R(I,P,O,V,Y=!1){I=A.unwrapOr(I,{indexCount:0,fields:{}});switch(O.type){case "simple":case "dot-density":return M(I,O,V,Y);case "class-breaks":return N(I,P,O,V,Y);case "unique-value":return S(I,P,O,V,Y);case "dictionary":return{type:"dictionary",
config:O.config,fieldMap:O.fieldMap,scaleExpression:O.scaleExpression,url:O.url,symbolOptions:V,symbologyType:V.symbologyType};case "heatmap":return W(I,O,V,Y);case "pie-chart":return Q(I,O,V,Y)}}function M(I,P,O,V=!1){I=P.getSymbols();return{type:"simple",symbol:p.createSymbolSchema(I.length?I[0]:null,O,V),symbologyType:O.symbologyType}}function Q(I,P,O,V=!1){I=P.getSymbols();P=1<I.length?I[1]:null;return{type:"pie-chart",markerSymbol:p.createSymbolSchema(I[0],O,V),fillSymbol:p.createSymbolSchema(P,
O,V),symbologyType:O.symbologyType}}function N(I,P,O,V,Y=!1){const ca=O.backgroundFillSymbol,{field:ea,fieldIndex:fa}=F(I,{target:P,field:O.field,valueExpression:O.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});P=O.normalizationType;P="log"===P?"esriNormalizeByLog":"percent-of-total"===P?"esriNormalizeByPercentOfTotal":"field"===P?"esriNormalizeByField":null;const ha=O.classBreakInfos.map(ia=>({symbol:p.createSymbolSchema(ia.symbol,V,Y),min:ia.minValue,max:ia.maxValue})).sort((ia,
la)=>ia.min-la.min);return{type:"interval",attributes:I.fields,field:ea,fieldIndex:fa,backgroundFillSymbol:p.createSymbolSchema(ca,V,Y),defaultSymbol:p.createSymbolSchema(O.defaultSymbol,V,Y),intervals:ha,normalizationField:O.normalizationField,normalizationTotal:O.normalizationTotal,normalizationType:P,isMaxInclusive:O.isMaxInclusive,symbologyType:V.symbologyType}}function S(I,P,O,V,Y=!1){const ca=[],ea=O.backgroundFillSymbol;P={target:P,context:{mesh:!0},resultType:"string"};if(O.field&&"string"!==
typeof O.field)throw new t("ValidationError","Expected renderer.field to be a string",O);const {field:fa,fieldIndex:ha}=F(I,{...P,field:O.field,valueExpression:O.valueExpression});for(const ia of O.uniqueValueInfos)ca.push({value:""+ia.value,symbol:p.createSymbolSchema(ia.symbol,V,Y)});return{type:"map",attributes:I.fields,field:fa,fieldIndex:ha,field2:F(I,{...P,field:O.field2}).field,field3:F(I,{...P,field:O.field3}).field,fieldDelimiter:O.fieldDelimiter,backgroundFillSymbol:p.createSymbolSchema(ea,
V),defaultSymbol:p.createSymbolSchema(O.defaultSymbol,V),map:ca,symbologyType:V.symbologyType}}function W(I,P,O,V=!1){I=P.getSymbols();return{type:"heatmap",symbol:p.createSymbolSchema(I.length?I[0]:null,O,V),symbologyType:O.symbologyType}}const T=C.getLogger("esri.views.2d.layers.features.schemaUtils");let ba=null;q.createSymbolSchema=p.createSymbolSchema;q.addAggregateFields=X;q.createMatcherSchema=R;q.createRendererAttributeSchema=F;q.createSchema=function(I){if(E("esri-2d-update-debug")){const P=
k(I,!0);console.debug("Created new schema",P);console.debug("Schema diff",l.diff(ba,P));ba=P}return k(I)};q.createSymbolSchemaOptions=u;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(q,t,E){q.getVVFlags=function(C){if(!C)return t.WGLVVFlag.NONE;let A=0;for(const y of C)"size"===y.type?(C=E.getTypeOfSizeVisualVariable(y),A|=C,"outline"===
y.target&&(A|=C<<4)):"color"===y.type?A|=t.WGLVVFlag.COLOR:"opacity"===y.type?A|=t.WGLVVFlag.OPACITY:"rotation"===y.type&&(A|=t.WGLVVFlag.ROTATION);return A};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(q,t,E,C,A){q.getTypeOfSizeVisualVariable=function(y){if(A.isNumber(y.minDataValue)&&A.isNumber(y.maxDataValue)&&
null!=y.minSize&&null!=y.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((y.expression&&"view.scale"===y.expression||y.valueExpression&&"$view.scale"===y.valueExpression)&&Array.isArray(y.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&"$view.scale"!==y.valueExpression)&&(Array.isArray(y.stops)||"levels"in y&&y.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&
"$view.scale"!==y.valueExpression)&&null!=y.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;E.getLogger("esri.views.2d.engine.webgl").error(new t("mapview-bad-type","Found invalid size VisualVariable",y));return C.WGLVVFlag.NONE};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports","../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(q,t,E){function C(m){switch(m.type){case "line-marker":return{type:"line-marker",
color:m.color?.toJSON(),placement:m.placement,style:m.style};default:return m.constructor.fromJSON(m.toJSON()).toJSON()}}function A(m,l,c){var a=E.createMaterialKey(t.WGLGeometryType.FILL,l);a=c?E.hydrateMaterialKey(a):a;var b=m.clone();m=b.outline;const d=E.isOutlineFillSymbology(l.symbologyType);d||(b.outline=null);b={materialKey:a,hash:b.hash(),...C(b)};if(d)return b;a=[];a.push(b);m&&(l=E.createMaterialKey(t.WGLGeometryType.LINE,{...l,isOutline:!0}),c={materialKey:c?E.hydrateMaterialKey(l):l,
hash:m.hash(),...C(m)},a.push(c));return{type:"composite-symbol",layers:a,hash:a.reduce((e,p)=>p.hash+e,"")}}function y(m,l,c){var a=E.isOutlineFillSymbology(l.symbologyType)?t.WGLSymbologyType.DEFAULT:l.symbologyType;a=E.createMaterialKey(t.WGLGeometryType.LINE,{...l,symbologyType:a});const b=c?E.hydrateMaterialKey(a):a;m=m.clone();a=m.marker;m.marker=null;const d=[];d.push({materialKey:b,hash:m.hash(),...C(m)});a&&(l=E.createMaterialKey(t.WGLGeometryType.MARKER,l),c=c?E.hydrateMaterialKey(l):l,
a.color=a.color??m.color,d.push({materialKey:c,hash:a.hash(),lineWidth:m.width,...C(a)}));return{type:"composite-symbol",layers:d,hash:d.reduce((e,p)=>p.hash+e,"")}}q.createSymbolSchema=function(m,l,c=!1){if(!m)return null;switch(m.type){case "simple-fill":case "picture-fill":return A(m,l,c);case "simple-marker":case "picture-marker":var a=E.createMaterialKey(t.WGLGeometryType.MARKER,l);c=c?E.hydrateMaterialKey(a):a;a=C(m);return{materialKey:c,hash:m.hash(),...a,angle:m.angle,maxVVSize:l.maxVVSize};
case "simple-line":return y(m,l,c);case "text":return a=E.createMaterialKey(t.WGLGeometryType.TEXT,l),c=c?E.hydrateMaterialKey(a):a,a=C(m),{materialKey:c,hash:m.hash(),...a,angle:m.angle,maxVVSize:l.maxVVSize};case "label":return a=m.toJSON(),l=E.createMaterialKey(t.WGLGeometryType.LABEL,{...l,placement:a.labelPlacement}),{materialKey:c?E.hydrateMaterialKey(l):l,hash:m.hash(),...a,labelPlacement:a.labelPlacement};case "cim":return{type:"cim",rendererKey:l.vvFlags,data:m.data,maxVVSize:l.maxVVSize};
case "CIMSymbolReference":return{type:"cim",rendererKey:l.vvFlags,data:m,maxVVSize:l.maxVVSize};case "web-style":return{...C(m),type:"web-style",hash:m.hash(),rendererKey:l.vvFlags,maxVVSize:l.maxVVSize};default:throw Error(`symbol not supported ${m.type}`);}};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(q,t,E,C,A,y,m,l){function c(g,f){if(!("visualVariables"in g&&g.hasVisualVariables("size")))return 0;g=g.getVisualVariablesForType("size");if(!g[0])return 0;g=g[0];if(f&&"cluster_count"===g.field&&"cluster"===f.type)return f.clusterMaxSize;if("outline"===g.target)return 0;if("stops"===g.transformationType)return g.stops.map(n=>n.size).reduce(h,0);if("clamped-linear"===g.transformationType){let n=f=-Infinity;f="number"===typeof g.maxSize?g.maxSize:g.maxSize.stops.map(z=>z.size).reduce(h,0);
n="number"===typeof g.minSize?g.minSize:g.minSize.stops.map(z=>z.size).reduce(h,0);return Math.max(f,n)}if("real-world-size"===g.transformationType)return 30}function a(){a=t._asyncToGenerator(function*(g,f,n,z,x,B){if(!g||B&&"cluster"===B.type)return 0;if("heatmap"===g.type)return Math.round(E.pt2px(g.radius));if("dot-density"===g.type)return 0;if("dictionary"===g.type)return"esriGeometryPoint"===f||"esriGeometryMultipoint"===f?100:200;B=g.getSymbols();g=c(g);const D=[];for(const F of B)D.push(p(F,
g,n,f,z,x));f=yield Promise.all(D);return E.pt2px(f.reduce(h,0))});return a.apply(this,arguments)}function b(g,f){return null==g?f:g}function d(g,f,n,z,x,B){return e.apply(this,arguments)}function e(){e=t._asyncToGenerator(function*(g,f,n,z,x,B){if("simple-marker"===g.type)return f=Math.max(b(g.size,12),f),v(g)+.707*f;if("picture-marker"===g.type)return n=Math.max(b(g.height,12),f),f=b(g.width,12)*(n/b(g.height,12))/2,n/=2,v(g)+Math.sqrt(f*f+n*n);if("text"===g.type){if(n=g.text&&g.text.length){f=
[];for(z=0;z<n;z++)f.push({...k,code:g.text.charCodeAt(z)});f={glyphMosaicItems:f}}else f={glyphMosaicItems:[k]};m.getTextSymbolSize(u,g.toJSON(),f);return Math.max(Math.abs(u[0]),Math.abs(u[1]))+Math.max(u[2],u[3])}return"simple-line"===g.type?(n=Math.max(b(g.width,.75),f)/2,g.marker?Math.max(6*g.width,2*f):n):"simple-fill"===g.type||"picture-fill"===g.type?(n=Math,z=n.max,g=null==g.outline?0:b(g.outline.width,0),z.call(n,g,f)/2):"cim"===g.type?(yield l.expandSymbol({type:"cim",rendererKey:0,data:g.data,
maxVVSize:f},{geometryType:z,fields:x,spatialReference:B},n),(g=C.CIMSymbolHelper.getEnvelope(g.data,null,n))?Math.sqrt(g.width*g.width+g.height*g.height):0):"web-style"===g.type?d(yield g.fetchCIMSymbol(),f,n,z,x,B):0});return e.apply(this,arguments)}function p(g,f,n,z,x,B){return r.apply(this,arguments)}function r(){r=t._asyncToGenerator(function*(g,f,n,z,x,B){return g.type in w?Math.min(yield d(g,f,n,z,x,B),75):0});return r.apply(this,arguments)}function v(g){const f=b(g.xoffset,0);g=b(g.yoffset,
0);return Math.sqrt(f*f+g*g)}function h(g,f){return Math.max(g,f)}const w={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},u=[0,0,0,0],k={sdf:!0,code:99,metrics:y.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new A(0,0,24,24),page:0,textureBinding:2};q.computePxBuffer=function(g,f,n,z,x,B){return a.apply(this,arguments)};q.getPtMaxVVSize=c;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a){q.PIXEL_BUFFER=50;q.TILE_SIZE=512;q.getTextSymbolSize=function(b,d,e){if(!e||0===e.glyphMosaicItems.length)return b;const p=t.bidiText(d.text)[1];d=a.shapeGlyphs(e.glyphMosaicItems,p,{scale:C.pt2px(d.font.size)/c.GLYPH_SIZE,angle:d.angle??0,xOffset:d.xoffset??0,yOffset:d.yoffset??0,hAlign:l.getXAnchorDirection(d.horizontalAlignment||"center"),vAlign:l.getYAnchorDirection(d.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(d.lineWidth||512,512)),lineHeight:c.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(d.lineHeight||1,4)),decoration:d.font.decoration||"none",isCIM:!1}).bounds;b[0]=C.pt2px(d.x-d.halfWidth);b[1]=C.pt2px(d.y-d.halfHeight);b[2]=C.pt2px(d.width);b[3]=C.pt2px(d.height);return b};q.graphicGeometryToNumber=function(b){switch(E.unwrap(b.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};q.intersectingInternationalDateline=function(b,d){d=m.getInfo(d);if(!d)return null;const [e,p]=d.valid;return b[2]>p?[y.create([b[0],b[1],p,b[3]]),
y.create([e,b[1],e+b[2]-p,b[3]])]:b[0]<e?[y.create([e,b[1],b[2],b[3]]),y.create([p-(e-b[0]),b[1],p,b[3]])]:null};q.isMarkerSymbol=function(b){return"simple-marker"===b||"picture-marker"===b||"esriSMS"===b||"esriPMS"===b};q.isTextSymbol=function(b){return"text"===b||"esriTS"===b};q.polygonFromExtent=function(b){if(!b)return null;const {xmin:d,ymin:e,xmax:p,ymax:r,spatialReference:v}=b;return new A({rings:[[[d,e],[d,r],[p,r],[p,e],[d,e]]],spatialReference:v})};Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define("exports ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/screenUtils ../../../../webgl/capabilities".split(" "),function(q,t,E,C,A,y){function m(b){return("size"===b.type||"color"===b.type||"opacity"===b.type)&&null!=b.stops}function l(b){var d=b.type;var e=b.stops;if(8>=e.length)d=e;else if(a.warn(`Found ${e.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),
16<e.length){const [f,...n]=e;var p=n.pop(),r=n[0].value,v=n[n.length-1].value,h=(v-r)/6;const z=[];for(;r<v;r+=h){for(var w=0;r>=n[w].value;)w++;var u=n[w],k=e[w-1],g=r-k.value;u=u.value===k.value?1:g/(u.value-k.value);"color"===d?(k=n[w],w=e[w-1],g=k.color.clone(),g.r=(1-u)*w.color.r+u*g.r,g.g=(1-u)*w.color.g+u*g.g,g.b=(1-u)*w.color.b+u*g.b,g.a=(1-u)*w.color.a+u*g.a,z.push({value:r,color:g,label:k.label})):"size"===d?(k=n[w],g=e[w-1],w=A.toPt(k.size),g=A.toPt(g.size),z.push({value:r,size:(1-u)*
g+u*w,label:k.label})):(k=n[w],z.push({value:r,opacity:(1-u)*e[w-1].opacity+u*k.opacity,label:k.label}))}d=[f,...z,p]}else{const [f,...n]=e;for(d=n.pop();6<n.length;){p=e=0;for(v=1;v<n.length;v++)h=Math.abs(n[v].value-n[v-1].value),h>p&&(p=h,e=v);n.splice(e,1)}d=[f,...n,d]}b.stops=d;return b}function c(){if(E("heatmap-force-raster"))return"raster";const {supportsTextureFloat:b,supportsTextureHalfFloat:d,supportsColorBufferFloat:e,supportsColorBufferFloatBlend:p,supportsColorBufferHalfFloat:r}=y.getWebGLCapabilities("2d");
return b&&e&&p||d&&r?"symbol":E("heatmap-allow-raster-fallback")?"raster":"none"}const a=C.getLogger("esri.views.2d.layers.features.support.rendererUtils");q.getSupportedHeatmapRenderer=c;q.isRendererSupported=function(b){if(!b)return!0;switch(b.type){case "dot-density":if(!y.getWebGLCapabilities("2d").supportsTextureFloat)return a.error(new t("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case "heatmap":if(b=c(),"none"===b||"raster"===
b&&!E("heatmap-force-raster")){const d=y.getWebGLCapabilities("2d"),e=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(p=>!d[p]).join(", ");if("none"===b)return a.errorOnce(new t("webgl-missing-extension",`Missing WebGL${d.type} requirements for Heatmap: ${e}`)),!1;"raster"===b&&a.warnOnce(`Missing WebGL${d.type} requirements for accelerated Heatmap: ${e}. Feature support may be limited.`)}}return!0};
q.simplifyVVRenderer=b=>{if(!("visualVariables"in b&&b.visualVariables&&b.visualVariables.length))return b;b=b.clone();const d=b.visualVariables.map(e=>m(e)?l(e):e);b.visualVariables=d;return b};q.simplifyVisualVariables=function(b){return b.map(d=>m(d)?l(d.clone()):d)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(q,t){const E=new t.JSONMap({esriGeometryPoint:"point",
esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});q.analyzeRings=function(C,A,y){const m=[],l=[];let c=0,a=0;for(const b of C){C=a;let d=b[0][0],e=b[0][1];m[a++]=d;m[a++]=e;let p=0;for(let r=1;r<b.length;++r){const v=d,h=e;d=b[r][0];e=b[r][1];p+=e*v-d*h;m[a++]=d;m[a++]=e}A(p/2);0<p?(0<C-c&&(y(c,C,m,l),c=C),l.length=0):0>p?0<C-c?l.push(.5*(C-c)):a=C:a=C}0<a-c&&y(c,a,m,l)};q.canUseMajorityInterpolationOnDataSource=
function(C){const {bandCount:A,attributeTable:y,colormap:m,pixelType:l}=C.rasterInfo;return 1===A&&(null!=y||null!=m||"u8"===l||"s8"===l)};q.toJSONGeometryType=function(C){return E.toJSON(C)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v){function h(n,z){return x=>z(n(x))}const w=A.getLogger("esri.views.layers.2d.features.support.AttributeStore"),u=p.createDebugLogger(p.DEBUG_ATTR_UPDATES,w);var k=C("esri-shared-array-buffer"),g=C("esri-atomics");let f=function(){function n(x,B,D,F){this.size=0;this.texelSize=4;const {pixelType:G,layout:H,textureOnly:J}=F;this.textureOnly=J||!1;this.pixelType=G;this._ctype=B;this.layout=H;this._resetRange();this._shared=x;this.size=D;J||(this.data=this._initData(G,
D,x,B))}var z=n.prototype;z.unsetComponentAllTexels=function(x,B){const D=m.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)D[F*this.texelSize+x]&=~B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponentAllTexels=function(x,B){const D=m.unwrap(this.data);for(let F=0;F<this.size*this.size;F++)D[F*this.texelSize+x]|=255&B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponent=function(x,B,D){const F=m.unwrap(this.data);for(const G of D)F[G*this.texelSize+x]|=B,
this.dirtyStart=Math.min(this.dirtyStart,G),this.dirtyEnd=Math.max(this.dirtyEnd,G)};z.setComponentTexel=function(x,B,D){m.unwrap(this.data)[D*this.texelSize+x]|=B;this.dirtyStart=Math.min(this.dirtyStart,D);this.dirtyEnd=Math.max(this.dirtyEnd,D)};z.unsetComponentTexel=function(x,B,D){m.unwrap(this.data)[D*this.texelSize+x]&=~B;this.dirtyStart=Math.min(this.dirtyStart,D);this.dirtyEnd=Math.max(this.dirtyEnd,D)};z.getData=function(x,B){x=d.getDisplayIdTexel(x);return m.unwrap(this.data)[x*this.texelSize+
B]};z.setData=function(x,B,D){x=d.getDisplayIdTexel(x);0===(this.layout&1<<B)?w.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[x*this.texelSize+B]=D,this.dirtyStart=Math.min(this.dirtyStart,x),this.dirtyEnd=Math.max(this.dirtyEnd,x))};z.lock=function(){this.pixelType===v.PixelType.UNSIGNED_BYTE&&this._shared&&g&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};z.unlock=function(){this.pixelType===v.PixelType.UNSIGNED_BYTE&&this._shared&&g&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};z.expand=function(x){this.size=x;if(!this.textureOnly){x=this._initData(this.pixelType,x,this._shared,this._ctype);const B=m.unwrap(this.data);x.set(B);this.data=x}};z.toMessage=function(){const x=this.dirtyStart,B=this.dirtyEnd;var D=this.texelSize;if(x>B)return null;this._resetRange();const F=!this._shared&&"local"!==this._ctype,G=this.pixelType,H=this.layout,J=m.unwrap(this.data);D=F&&J.slice(x*D,(B+1)*D)||null;return{start:x,end:B,data:D,pixelType:G,
layout:H}};z._initData=function(x,B,D,F){D=D&&"local"!==F?SharedArrayBuffer:ArrayBuffer;x=e.getPixelArrayCtor(x);B=new x(new D(B*B*4*x.BYTES_PER_ELEMENT));for(x=0;x<B.length;x+=4)B[x+1]=255;return B};z._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};t._createClass(n,[{key:"buffer",get:function(){return m.applySome(this.data,x=>x.buffer)}}]);return n}();return function(){function n(x,B,D=()=>{}){this._client=x;this.config=B;this._notifyChange=D;this._attributeComputeMap=new Map;
this._blocks=[];this._filters=Array(b.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;x=B.supportsTextureFloat?v.PixelType.FLOAT:v.PixelType.UNSIGNED_BYTE;u(`Creating AttributeStore ${k?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:v.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:v.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:v.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:x,layout:15},{pixelType:x,layout:15},{pixelType:x,layout:15},{pixelType:x,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var z=n.prototype;z.destroy=function(){this._abortController.abort()};z.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};z.update=function(x,B){this.config=B;B=B.schema.processors[0].storage;const D=c.diff(this._schema,B);if(x.targets.feature||x.targets.aggregate)x.storage.data=!0;if(D&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
D),x.storage.data=!0,this._schema=B,this._attributeComputeMap.clear(),!m.isNone(B))){switch(B.target){case "feature":this._targetType=d.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=d.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===B.type)for(const F in B.mapping){if(x=B.mapping[F],m.isSome(x)&&m.isSome(x.vvMapping))for(const G of x.vvMapping)this._bindAttribute(G)}else{if(m.isSome(B.vvMapping))for(const F of B.vvMapping)this._bindAttribute(F);if(m.isSome(B.attributeMapping))for(const F of B.attributeMapping)this._bindAttribute(F)}}};
z.onTileData=function(x,B){if(!m.isNone(B.addOrUpdate))for(x=B.addOrUpdate.getCursor();x.next();)B=x.getDisplayId(),this.setAttributeData(B,x)};z.setHighlight=function(){var x=t._asyncToGenerator(function*(B,D){const F=this._getBlock(0);D=D.map(G=>d.getDisplayIdTexel(G));F.lock();F.unsetComponentAllTexels(0,1);F.setComponent(0,1,D);F.unlock();this._idsToHighlight.clear();for(const G of B)this._idsToHighlight.add(G);yield this.sendUpdates()});return function(B,D){return x.apply(this,arguments)}}();
z.updateFilters=function(){var x=t._asyncToGenerator(function*(B,D,F){const {service:G,spatialReference:H}=F;({filters:D}=D);D=D.map((J,L)=>this._updateFilter(J,L,G,H));(yield Promise.all(D)).some(J=>J)&&(B.storage.filters=!0,C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(B,D,F){return x.apply(this,arguments)}}();z.setData=function(x,B,D,F){const G=d.getDisplayIdTexel(x);this._ensureSizeForTexel(G);this._getBlock(B).setData(x,D,F)};
z.getData=function(x,B,D){return this._getBlock(B).getData(x,D)};z.getHighlightFlag=function(x){return this._idsToHighlight.has(x)?b.HIGHLIGHT_FLAG:0};z.unsetAttributeData=function(x){x=d.getDisplayIdTexel(x);this._getBlock(0).setData(x,0,0)};z.setAttributeData=function(x,B){const D=d.getDisplayIdTexel(x);this._ensureSizeForTexel(D);this._getBlock(0).setData(D,0,this.getFilterFlags(B));if(this._targetType===d.getDisplayIdType(x)){x=this._attributeComputeMap;var F=this.config.supportsTextureFloat?
1:2;x.size&&x.forEach((G,H)=>{const J=H*F%4;H=this._getBlock(Math.floor(H*F/4)+b.ATTRIBUTE_DATA_VV);G=G(B);if(this.config.supportsTextureFloat)H.setData(D,J,G);else if(G===b.NAN_MAGIC_NUMBER)H.setData(D,J,255),H.setData(D,J+1,255);else{G=y.clamp(Math.round(G),-32767,32766)+32768;const L=(G&65280)>>8;H.setData(D,J,G&255);H.setData(D,J+1,L)}})}};z.sendUpdates=function(){C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;
if(this._currUpdate)return this._nextUpdate=l.createResolver(),this._nextUpdate.promise;const x={blocks:this._blocks.map(B=>m.isSome(B)?B.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var B=()=>{this._currUpdate=null;if(this._nextUpdate){const D=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>D.resolve())}else C("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};C("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate::client.update");B=this._client.update(x,this._signal).then(B).catch(B);this._client.render(this._signal);return B}).catch(B=>{if(l.isAbortError(B))return this._createResourcesPromise=null,this._createResources();this._notifyChange();w.error(new E("mapview-attribute-store","Encountered an error during client update",B))})};z._ensureSizeForTexel=function(x){for(;x>=this._size*this._size&&!this._expand(););};z._bindAttribute=function(x){function B(){return x.normalizationField?
G=>{const H=G.readAttribute(x.normalizationField);return H?G.readAttribute(x.field)/H:null}:G=>G.readAttribute(x.field)}function D(){x.normalizationField&&w.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return G=>G.getComputedNumericAtIndex(x.fieldIndex)}let F;if(null!=x.fieldIndex)F=D();else if(x.field)F=B();else return;x.valueRepresentation&&(F=h(F,G=>r.getVisualVariableSizeValueRepresentationRatio(G,x.valueRepresentation)));this._attributeComputeMap.set(x.binding,
h(F,G=>null===G||isNaN(G)||Infinity===G||-Infinity===G?b.NAN_MAGIC_NUMBER:G))};z._createResources=function(){if(m.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(b.ATTRIBUTE_DATA_ANIMATION);this._getBlock(b.ATTRIBUTE_DATA_GPGPU);u("Initializing AttributeStore");var x={shared:k&&"local"!==this._client.type,size:this._size,blocks:m.mapMany(this._blocks,B=>({textureOnly:B.textureOnly,buffer:B.buffer,pixelType:B.pixelType}))};this._createResourcesPromise=x=this._client.initialize(x,
this._signal).catch(B=>{l.isAbortError(B)?this._createResourcesPromise=null:w.error(new E("mapview-attribute-store","Encountered an error during client initialization",B))});x.then(()=>m.isNone(this._createResourcesPromise)?this._createResources():void 0);return x};z._getBlock=function(x){var B=this._blocks[x];if(m.isSome(B))return B;u(`Initializing AttributeBlock at index ${x}`);B=new f(k,this._client.type,this._size,this._blockDescriptors[x]);this._blocks[x]=B;this._createResourcesPromise=null;
return B};z._expand=function(){if(this._size<this.config.maxTextureSize){const x=this._size<<=1;u("Expanding block size to",x,this._blocks);m.forEachSome(this._blocks,B=>B.expand(x));this._createResourcesPromise=null;this._size=x;return 0}w.error(new E("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};z._updateFilter=function(){var x=t._asyncToGenerator(function*(B,D,F,G){const H=this._filters[D],J=m.isSome(H)&&H.hash;if(!H&&!B||J===JSON.stringify(B))return!1;if(m.isNone(B)){if(!H)return!1;
B=1<<D+1;F=this._getBlock(0);this._filters[D]=null;F.setComponentAllTexels(0,B);this.sendUpdates();return!0}yield(yield this._getFilter(D,F)).update(B,G);return!0});return function(B,D,F,G){return x.apply(this,arguments)}}();z._getFilter=function(){var x=t._asyncToGenerator(function*(B,D){var F=this._filters[B];if(m.isSome(F))return F;({default:F}=yield new Promise((G,H)=>q(["./FeatureFilter"],J=>G(Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}))),
H)));D=new F({geometryType:D.geometryType,hasM:!1,hasZ:!1,timeInfo:D.timeInfo,fieldsIndex:new a(D.fields)});return this._filters[B]=D});return function(B,D){return x.apply(this,arguments)}}();z.isVisible=function(x){return!!(this._getBlock(0).getData(x,0)&2)};z.getFilterFlags=function(x){let B=0;var D=d.getDisplayIdFilterMask(x.getDisplayId());for(let G=0;G<this._filters.length;G++){var F=this._filters[G];F=!(D&1<<G)||m.isNone(F)||F.check(x);B|=(F?1:0)<<G}D=0;this._idsToHighlight.size&&(x=x.getObjectId(),
D=this.getHighlightFlag(x));return B<<1|D};t._createClass(n,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return n}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(q){q.DEBUG_ATTR_UPDATES=!1;q.createDebugLogger=(t,E)=>t&&((...C)=>E.warn("DEBUG:",...C))||(()=>null);Object.defineProperties(q,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(q,t,E,C,A,y,m){function l(r){return{value:r.value,size:E.toPt(r.size)}}function c(r){return r.map(v=>l(v))}function a(r){return"string"===
typeof r||"number"===typeof r?E.toPt(r):{type:"size",expression:r.expression,stops:c(r.stops)}}function b(r){const v={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof r.field)if(r.stops){if(8<r.stops.length)return null;r=r.stops;for(var h=0;8>h;++h){const w=r[Math.min(h,r.length-1)];v.values[h]=w.value;v.opacities[h]=w.opacity}}else return null;else if(r.stops&&0<=r.stops.length)for(r=r.stops&&0<=r.stops.length&&r.stops[0].opacity,h=0;8>h;h++)v.values[h]=Infinity,v.opacities[h]=
r;else return null;return v}function d(r,v,h){r[4*v]=h.r/255;r[4*v+1]=h.g/255;r[4*v+2]=h.b/255;r[4*v+3]=h.a}function e(r){if(t.isNone(r)||r.normalizationField)return null;const v={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof r.field)if(r.stops){if(8<r.stops.length)return null;v.field=r.field;r=r.stops;for(var h=0;8>h;++h){const w=r[Math.min(h,r.length-1)];v.values[h]=w.value;d(v.colors,h,w.color)}}else return null;
else if(r.stops&&0<=r.stops.length)for(r=r.stops&&0<=r.stops.length&&r.stops[0].color,h=0;8>h;h++)v.values[h]=Infinity,d(v.colors,h,r);else return null;for(r=0;32>r;r+=4)C.premultiplyAlpha(v.colors,r,!0);return v}const p=r=>{const v=[],h=[];r=c(r);const w=r.length;for(let u=0;6>u;u++){const k=r[Math.min(u,w-1)];v.push(k.value);h.push(null==k.size?A.NAN_MAGIC_NUMBER:E.pt2px(k.size))}return{values:new Float32Array(v),sizes:new Float32Array(h)}};q.convertColorVariable=e;q.convertVisualVariables=function(r){const v=
r&&0<r.length?{}:null,h=v?{}:null;if(!v)return{vvFields:v,vvRanges:h};for(const w of r)if(w.field&&(v[w.type]=w.field),"size"===w.type)switch(h.size||(h.size={}),r=w,m.getTypeOfSizeVisualVariable(r)){case y.WGLVVFlag.SIZE_MINMAX_VALUE:h.size.minMaxValue={minDataValue:r.minDataValue,maxDataValue:r.maxDataValue,minSize:a(r.minSize),maxSize:a(r.maxSize)};break;case y.WGLVVFlag.SIZE_SCALE_STOPS:h.size.scaleStops={stops:c(r.stops)};break;case y.WGLVVFlag.SIZE_FIELD_STOPS:if(r.levels){const u={};for(const k in r.levels)u[k]=
p(r.levels[k]);h.size.fieldStops={type:"level-dependent",levels:u}}else h.size.fieldStops={type:"static",...p(r.stops)};break;case y.WGLVVFlag.SIZE_UNIT_VALUE:h.size.unitValue={unit:r.valueUnit,valueRepresentation:r.valueRepresentation}}else"color"===w.type?h.color=e(w):"opacity"===w.type?h.opacity=b(w):"rotation"===w.type&&(h.rotation={type:w.rotationType});return{vvFields:v,vvRanges:h}};q.getVisualVariableSizeValueRepresentationRatio=function(r,v){if(!r||!v)return r;switch(v){case "radius":case "distance":return 2*
r;case "area":return Math.sqrt(r)}return r};q.normalizeSizeElement=a;q.normalizeSizeStops=c;q.stopToSizeStop=l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(q,t,E,C){function A(m,l,c){if(!(m.length>l))for(;m.length<=l;)m.push(c)}let y=function(){function m(){this._numerics=[];
this._strings=[];this._idGenerator=new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var l=m.prototype;l.createBitset=function(){const c=this._bitsets.length;this._bitsets.push(C.StaticBitSet.create(this._allocatedSize,t.DISPLAY_ID_TEXEL_MASK));return c+1};l.getBitset=function(c){return this._bitsets[c-1]};l._expand=function(){this._allocatedSize<<=1;for(const c of this._bitsets)c.resize(this._allocatedSize)};l._ensureNumeric=function(c,a){this._numerics[c]||
(this._numerics[c]=[]);A(this._numerics[c],a,0)};l._ensureInstanceId=function(c){A(this._instanceIds,c,0)};l._ensureString=function(c,a){this._strings[c]||(this._strings[c]=[]);A(this._strings[c],a,null)};l.createDisplayId=function(c=!1){const a=this._idGenerator.createId();a>this._allocatedSize&&this._expand();return t.createDisplayId(a,c)};l.releaseDisplayId=function(c){for(const a of this._bitsets)a.unset(c);return this._idGenerator.releaseId(c&t.DISPLAY_ID_TEXEL_MASK)};l.getComputedNumeric=function(c,
a){return this.getComputedNumericAtIndex(c&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedNumeric=function(c,a,b){return this.setComputedNumericAtIndex(c&t.DISPLAY_ID_TEXEL_MASK,b,0)};l.getComputedString=function(c,a){return this.getComputedStringAtIndex(c&t.DISPLAY_ID_TEXEL_MASK,0)};l.setComputedString=function(c,a,b){return this.setComputedStringAtIndex(c&t.DISPLAY_ID_TEXEL_MASK,0,b)};l.getComputedNumericAtIndex=function(c,a){c&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,c);return this._numerics[a][c]};
l.setComputedNumericAtIndex=function(c,a,b){c&=t.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,c);this._numerics[a][c]=b};l.getInstanceId=function(c){c&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(c);return this._instanceIds[c]};l.setInstanceId=function(c,a){c&=t.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(c);this._instanceIds[c]=a};l.getComputedStringAtIndex=function(c,a){c&=t.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,c);return this._strings[a][c]};l.setComputedStringAtIndex=function(c,a,b){c&=
t.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,c);this._strings[a][c]=b};l.getXMin=function(c){return this._bounds[4*(c&t.DISPLAY_ID_TEXEL_MASK)]};l.getYMin=function(c){return this._bounds[4*(c&t.DISPLAY_ID_TEXEL_MASK)+1]};l.getXMax=function(c){return this._bounds[4*(c&t.DISPLAY_ID_TEXEL_MASK)+2]};l.getYMax=function(c){return this._bounds[4*(c&t.DISPLAY_ID_TEXEL_MASK)+3]};l.setBounds=function(c,a){a=a.readHydratedGeometry();if(!a||!a.coords.length)return!1;let b=Infinity,d=Infinity,e=-Infinity,p=-Infinity;
a.forEachVertex((r,v)=>{b=Math.min(b,r);d=Math.min(d,v);e=Math.max(e,r);p=Math.max(p,v)});c&=t.DISPLAY_ID_TEXEL_MASK;A(this._bounds,4*c+4,0);this._bounds[4*c]=b;this._bounds[4*c+1]=d;this._bounds[4*c+2]=e;this._bounds[4*c+3]=p;return!0};return m}();q.ComputedAttributeStorage=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(q,
t){let E=function(){function C(){this._freeIds=[];this._idCounter=1}var A=C.prototype;A.createId=function(y=!1){return t.createDisplayId(this._getFreeId(),y)};A.releaseId=function(y){this._freeIds.push(y)};A._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return C}();q.DisplayIdGenerator=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),
function(q,t,E,C,A,y){y=function(m){function l(a,b,d){a=m.call(this,a,b,null)||this;a._transform=d;return a}t._inheritsLoose(l,m);l.from=function(a,b,d){const e=A.FeatureSetReader.createInstance(),p=[];a=a.filter(r=>!!r.geometry);for(const r of a)a=E.getJsonType(r.geometry),C.convertFromGraphics(p,[r],a,!1,!1,b);return new l(e,p,d)};var c=l.prototype;c.readGraphic=function(){return this._current};c.getCursor=function(){return this.copy()};c.copy=function(){const a=new l(this.instance,this._features,
this._transform);this.copyInto(a);return a};t._createClass(l,[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return l}(y.FeatureSetReaderJSON);q.GraphicsReader=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a){let b=0;E=C("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const d=E[0],e=E[1],p=E[2],r=E[3];E=C("featurelayer-simplify-payload-size-factors")??[1,2,4];const v=E[0],h=E[1],w=E[2],u=C("featurelayer-simplify-mobile-factor")??2,k=C("esri-mobile");C=function(){function g(n,z){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.instance=n;this._layerSchema=z}g.createInstance=function(){b++;return b=65535<b?0:b};var f=g.prototype;f.getAreaSimplificationThreshold=function(n,z){let x=1;const B=k?u:1;4E6<z?x=w*B:1E6<z?x=h*B:5E5<z?x=v*B:1E5<z&&(x=B);z=0;4E3<n?z=r*x:2E3<n?z=p*x:100<n?z=e:15<n&&(z=d);n=8;4>this._level?n=1:5>this._level?n=2:6>this._level&&(n=4);return z*n};f.createQuantizedExtrudedQuad=function(n,z){return new l([5],[n-1,z,1,-1,1,1,-1,1,-1,-1])};f.setArcadeSpatialReference=function(n){this._arcadeSpatialReference=
n};f.attachStorage=function(n){this._storage=n};f.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};f.getStorage=function(){return this._storage};f.getComputedNumeric=function(n){return this.getComputedNumericAtIndex(0)};f.setComputedNumeric=function(n,z){return this.setComputedNumericAtIndex(z,0)};f.getComputedString=function(n){return this.getComputedStringAtIndex(0)};f.setComputedString=function(n,z){return this.setComputedStringAtIndex(0,z)};f.getComputedNumericAtIndex=
function(n){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),n)};f.setComputedNumericAtIndex=function(n,z){this._storage.setComputedNumericAtIndex(this.getDisplayId(),n,z)};f.getComputedStringAtIndex=function(n){return this._storage.getComputedStringAtIndex(this.getDisplayId(),n)};f.setComputedStringAtIndex=function(n,z){return this._storage.setComputedStringAtIndex(this.getDisplayId(),n,z)};f.transform=function(n,z,x,B){const D=this.copy();D._tx+=n;D._ty+=z;D._sx*=x;D._sy*=B;return D};
f.readAttribute=function(n,z=!1){var x=this._readAttribute(n,z);if(void 0!==x)return x;for(const B of this._joined)if(B.setIndex(this.getIndex()),x=B._readAttribute(n,z),void 0!==x)return x};f.readAttributes=function(){const n=this._readAttributes();for(const z of this._joined){z.setIndex(this.getIndex());const x=z._readAttributes();for(const B of Object.keys(x))n[B]=x[B]}return n};f.joinAttributes=function(n){this._joined.push(n)};f.readArcadeFeature=function(){return this};f.geometry=function(){var n=
this.readHydratedGeometry();n=m.convertToGeometry(n,this.geometryType,this.hasZ,this.hasM);if(n=a.fromJSON(n))n.spatialReference=this._arcadeSpatialReference;return n};f.field=function(n){if(this.hasField(n))return this.readAttribute(n,!0);for(const z of this._joined)if(z.setIndex(this.getIndex()),z.hasField(n))return z._readAttribute(n,!0);throw Error(`Field ${n} does not exist`);};f.setField=function(n,z){throw Error("Unable to update feature attribute values, feature is readonly");};f.keys=function(){return this.getFieldNames()};
f.castToText=function(n=!1){if(!n)return JSON.stringify(this.readLegacyFeature());n=this.readLegacyFeature();if(!n)return JSON.stringify(null);n={geometry:n.geometry,attributes:{...(n.attributes?n.attributes:{})}};for(const z in n.attributes){const x=n.attributes[z];x instanceof Date&&(n.attributes[z]=x.getTime())}return JSON.stringify(n)};f.gdbVersion=function(){return null};f.fullSchema=function(){return this._layerSchema};f.castAsJson=function(n=null){return{attributes:this._readAttributes(),geometry:!0===
n?.keepGeometryType?this.geometry():this.geometry().toJSON()}};f.castAsJsonAsync=function(n,z=null){return Promise.resolve(this.castAsJson(z))};f.removeIds=function(n){if(A.isNone(this._objectIdToIndex)){var z=new Map;const x=this.getCursor();for(;x.next();){const B=A.unwrapOrThrow(x.getObjectId());z.set(B,x.getIndex())}this._objectIdToIndex=z}z=this._objectIdToIndex;for(const x of n)z.has(x)&&this.removeAtIndex(z.get(x))};f.removeAtIndex=function(n){A.isNone(this._deleted)&&(this._deleted=c.StaticBitSet.create(this.getSize()));
this._deleted.set(n)};f.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};f.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};f.features=function*(){const n=this.getCursor();for(;n.next();)yield n.readOptimizedFeature()};f._getExists=function(){return A.isNone(this._deleted)||!this._deleted.has(this.getIndex())};f._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const n=this.readUnquantizedGeometry();if(!n||n.hasIndeterminateRingOrder)return null;
const z=A.unwrapOr(this.getQuantizationTransform(),null);return y.getCentroidOptimizedGeometry(new l,n,this.hasM,this.hasZ,z)};f.copyInto=function(n){n.seen=this.seen;n._storage=this._storage;n._arcadeSpatialReference=this._arcadeSpatialReference;n._joined=this._joined;n._tx=this._tx;n._ty=this._ty;n._sx=this._sx;n._sy=this._sy;n._deleted=this._deleted;n._objectIdToIndex=this._objectIdToIndex};t._createClass(g,[{key:"isEmpty",get:function(){return A.isSome(this._deleted)&&this._deleted.countSet()===
this.getSize()}},{key:"level",set:function(n){this._level=n}}]);return g}();q.FeatureSetReader=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(q,t){function E(A,y,m,l,c,a,b=1){a=c?a?4:3:a?3:2;let d=m,e=m+a,p=0,r=0,v=m=0,h=0;for(let w=0,u=l-1;w<u;w++,d+=a,e+=a){l=y[d];const k=y[d+1],g=y[d+2],f=y[e],n=y[e+1],z=y[e+2];let x=l*n-f*k;v+=x;p+=(l+f)*x;r+=(k+n)*x;c&&(x=l*
z-f*g,m+=(g+z)*x,h+=x);l<A[0]&&(A[0]=l);l>A[1]&&(A[1]=l);k<A[2]&&(A[2]=k);k>A[3]&&(A[3]=k);c&&(g<A[4]&&(A[4]=g),g>A[5]&&(A[5]=g))}0<v*b&&(v*=-1);0<h*b&&(h*=-1);if(!v)return null;A=[p,r,.5*v];c&&(A[3]=m,A[4]=.5*h);return A}function C(A,y,m,l,c){c=l?c?4:3:c?3:2;let a=y,b=y+c,d=0,e=0,p=0,r=0;for(let u=0,k=m-1;u<k;u++,a+=c,b+=c){var v=A[a];const g=A[a+1],f=A[a+2],n=A[b],z=A[b+1],x=A[b+2];if(l){var h=n-v;var w=z-g;const B=x-f;h=Math.sqrt(h*h+w*w+B*B)}else h=n-v,w=z-g,h=Math.sqrt(h*h+w*w);h&&(d+=h,l?(v=
[v+.5*(n-v),g+.5*(z-g),f+.5*(x-f)],e+=h*v[0],p+=h*v[1],r+=h*v[2]):(v=[v+.5*(n-v),g+.5*(z-g)],e+=h*v[0],p+=h*v[1]))}return 0<d?l?[e/d,p/d,r/d]:[e/d,p/d]:0<m?l?[A[y],A[y+1],A[y+2]]:[A[y],A[y+1]]:null}q.getCentroidOptimizedGeometry=function(A,y,m,l,c){if(t.isNone(y)||!y.lengths.length)return null;const a="upperLeft"===c?.originPosition?-1:1;A.lengths.length&&(A.lengths.length=0);A.coords.length&&(A.coords.length=0);c=A.coords;const b=[],d=m?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:e,coords:p}=y,r=m?l?4:3:l?3:2;let v=0;for(var h of e){const w=E(d,p,v,h,m,l,a);w&&b.push(w);v+=h*r}b.sort((w,u)=>{let k=a*w[2]-a*u[2];0===k&&m&&(k=w[4]-u[4]);return k});b.length&&(h=6*b[0][2],c[0]=b[0][0]/h,c[1]=b[0][1]/h,m&&(h=6*b[0][4],c[2]=0!==h?b[0][3]/h:0),c[0]<d[0]||c[0]>d[1]||c[1]<d[2]||c[1]>d[3]||m&&(c[2]<
d[4]||c[2]>d[5]))&&(c.length=0);if(!c.length)if(y=y.lengths[0]?C(p,0,e[0],m,l):null)c[0]=y[0],c[1]=y[1],m&&2<y.length&&(c[2]=y[2]);else return null;return A};q.lineCentroid=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(q,t,E,C,A,y){function m({coords:c,lengths:a}){let b=0;for(const d of a){for(a=1;a<d;a++)c[2*(b+a)]+=c[2*(b+a)-2],c[2*(b+a)+1]+=c[2*(b+a)-1];b+=d}}let l=function(c){function a(d,e,p){d=c.call(this,d,p)||this;d._exceededTransferLimit=!1;d._featureIndex=-1;d._dateFields=new Set;d._geometryType=p?.geometryType;d._features=e;return d}t._inheritsLoose(a,c);a.fromFeatures=function(d,e){const {objectIdField:p,geometryType:r}=e,v=C.convertFromFeatures([],d,r,!1,!1,p);for(let h=0;h<v.length;h++)v[h].displayId=
d[h].displayId;return a.fromOptimizedFeatures(v,e)};a.fromFeatureSet=function(d,e){d=C.convertFromFeatureSet(d,e.objectIdField);return a.fromOptimizedFeatureSet(d,e)};a.fromOptimizedFeatureSet=function(d,e){const {features:p}=d;e=a.fromOptimizedFeatures(p,e);e._exceededTransferLimit=d.exceededTransferLimit;e._transform=d.transform;for(const r of d.fields)"esriFieldTypeDate"===r.type&&e._dateFields.add(r.name);return e};a.fromOptimizedFeatures=function(d,e,p){const r=y.FeatureSetReader.createInstance();
d=new a(r,d,e);d._transform=p;return d};var b=a.prototype;b.removeIds=function(d){const e=new Set(d);this._features=this._features.filter(p=>!(p.objectId&&e.has(p.objectId)))};b.append=function(d){for(const e of d)this._features.push(e)};b.getSize=function(){return this._features.length};b.getCursor=function(){return this.copy()};b.getQuantizationTransform=function(){return this._transform};b.getAttributeHash=function(){let d="";for(const e in this._current.attributes)d+=this._current.attributes[e];
return d};b.getIndex=function(){return this._featureIndex};b.setIndex=function(d){this._featureIndex=d};b.getObjectId=function(){return this._current.objectId};b.getDisplayId=function(){return this._current.displayId};b.setDisplayId=function(d){this._current.displayId=d};b.getGroupId=function(){return this._current.groupId};b.setGroupId=function(d){this._current.groupId=d};b.copy=function(){const d=new a(this.instance,this._features,this.fullSchema());this.copyInto(d);return d};b.next=function(){for(;++this._featureIndex<
this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};b.readLegacyFeature=function(){return C.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};b.readOptimizedFeature=function(){return this._current};b.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};b.readLegacyGeometry=function(){const d=this.readGeometry();return C.convertToGeometry(d,this.geometryType,this.hasZ,this.hasM)};b.readLegacyCentroid=
function(){const d=this.readCentroid();return E.isNone(d)?null:{x:d.coords[0]*this._sx+this._tx,y:d.coords[1]*this._sy+this._ty}};b.readGeometryArea=function(){return A.hasGeometry(this._current)?C.getQuantizedArea(this._current.geometry,2):0};b.readUnquantizedGeometry=function(){var d=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!d)return d;d=d.clone();m(d);return d};b.readHydratedGeometry=function(){var d=this._current.geometry;if(E.isNone(d))return null;d=d.clone();E.isSome(this._transform)&&
C.unquantizeOptimizedGeometry(d,d,this.hasZ,this.hasM,this._transform);return d};b.getXHydrated=function(){if(!A.hasGeometry(this._current))return 0;const d=this._current.geometry.coords[0],e=this.getQuantizationTransform();return E.isNone(e)?d:d*e.scale[0]+e.translate[0]};b.getYHydrated=function(){if(!A.hasGeometry(this._current))return 0;const d=this._current.geometry.coords[1],e=this.getQuantizationTransform();return E.isNone(e)?d:e.translate[1]-d*e.scale[1]};b.getX=function(){return A.hasGeometry(this._current)?
this._current.geometry.coords[0]*this._sx+this._tx:0};b.getY=function(){return A.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};b.readGeometry=function(){if(!A.hasGeometry(this._current)){if(E.isSome(this._current.centroid)){const [p,r]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(p,r)}return null}const d=this._current.geometry.clone();if(d.isPoint)return d.coords[0]=d.coords[0]*this._sx+this._tx,d.coords[1]=d.coords[1]*this._sy+this._ty,
d;let e=0;for(const p of d.lengths)d.coords[2*e]=d.coords[2*e]*this._sx+this._tx,d.coords[2*e+1]=d.coords[2*e+1]*this._sy+this._ty,e+=p;return d};b.readCentroid=function(){return A.hasGeometry(this._current)?this._computeCentroid():this._current.centroid};b.hasField=function(d){return d in this._current.attributes?!0:this.getFieldNames().map(e=>e.toLowerCase()).includes(d.toLowerCase())};b.getFieldNames=function(){return Object.keys(this._current.attributes)};b._readAttribute=function(d,e){var p=
this._current.attributes[d];if(void 0!==p)return null!=p&&e&&this._dateFields.has(d)?new Date(p):p;p=this.readAttributes();d=d.toLocaleLowerCase().trim();for(const r in p)if(r.toLocaleLowerCase().trim()===d)return d=this._current.attributes[r],null!=d&&e&&this._dateFields.has(r)?new Date(d):d};b.copyInto=function(d){c.prototype.copyInto.call(this,d);d._featureIndex=this._featureIndex;d._transform=this._transform;d._dateFields=this._dateFields};b._readAttributes=function(){return this._current.attributes};
t._createClass(a,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return a}(y.FeatureSetReader);q.FeatureSetReaderJSON=
l;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b){function d(h,w,u,k,g){p.minX=w;p.minY=u;p.maxX=k;p.maxY=g;return h.search(p)}function e(h){return{minX:h.bounds[0],minY:h.bounds[1],maxX:h.bounds[2],maxY:h.bounds[3]}}const p={minX:0,minY:0,maxX:0,maxY:0},r=C.create(),v=(h,w)=>{const u=b.graphicGeometryToNumber(h.graphic),k=b.graphicGeometryToNumber(w.graphic);return u===k?w.zorder-h.zorder:u-k};return function(){function h(u,k,g,f,n,z,x){this._graphics=f;this._onAdd=n;this._onRemove=z;this._hashToCIM=x;this._index=
E.rbush(9,e);this._itemByGraphic=new Map;this._inflatedSizeHelper=new c.CIMSymbolInflatedSizeHelper;this._tileInfoView=u;this._uidFieldName=g;if(u=u.getClosestInfoForScale(k))this._resolution=this._tileInfoView.getTileResolution(u.level)}var w=h.prototype;w.setResourceManager=function(u){this._cimResourceManager=u;this._hittestDrawHelper=new l.HittestDrawHelper(u)};w.hitTest=function(u,k,g,f,n){u=y.normalizeMapX(u,this._tileInfoView.spatialReference);var z=.5*f*window.devicePixelRatio*g;r[0]=u-z;
r[1]=k-z;r[2]=u+z;r[3]=k+z;g=.5*f*(g+b.PIXEL_BUFFER);k=d(this._index,u-g,k-g,u+g,k+g);if(!k||0===k.length)return[];u=[];g=C.create();z=C.create();for(var x of k){const {geometry:B,symbolResource:D}=x;this._getSymbolBounds(g,D,B,z,n);z[3]=z[2]=z[1]=z[0]=0;C.intersects(g,r)&&x.graphic.visible&&u.push(x)}if(0===u.length)return[];x=this._hittestDrawHelper;k=[];for(const B of u){const {geometry:D,symbolResource:F}=B,{hash:G,textInfo:H}=F;(u=this._hashToCIM.get(G))&&x.hitTest(r,u.symbol,D,H,n,f)&&k.push(B)}k.sort(v);
return k.map(B=>B.graphic)};w.getGraphicsData=function(u,k,g){const f=this._searchForItems(k);if(0===f.length||0===g.length)return[];f.sort((G,H)=>G.zorder-H.zorder);f[0].insertAfter=-1;for(var n=1;n<f.length;n++)f[n].insertAfter=f[n-1].graphic.uid;f.sort((G,H)=>G.graphic.uid-H.graphic.uid);g.sort((G,H)=>G.uid-H.uid);let z=n=0,x;const B=k.resolution,D=[],F={originPosition:"upperLeft",scale:[B,B],translate:[k.bounds[0],k.bounds[3]]};for(const G of g){for(z=-2;n<f.length;)if(x=f[n],n++,G.uid===x.graphic.uid){z=
x.insertAfter;break}if(!x.geometry||-2===z)continue;g=x.getGeometryQuantized(F,k.bounds,this._tileInfoView.spatialReference,B);const H={...x.graphic.attributes};H[this._uidFieldName]=G.uid;null==x.groupId&&(x.groupId=u.createTemplateGroup(x.symbol,null));D.push({centroid:a.getCentroidQuantized(x,F),geometry:g,attributes:H,symbol:x.symbol,groupId:x.groupId,insertAfter:z,zorder:x.zorder})}D.sort((G,H)=>G.zorder-H.zorder);return D};w.queryTileData=function(u,k){if(0===this._graphics.length)return[];
const {bounds:g,resolution:f}=k,n=this._searchForItems(k),z=[];if(0===n.length)return z;this._createTileGraphics(z,u,n,{originPosition:"upperLeft",scale:[f,f],translate:[g[0],g[3]]},k);return z};w.has=function(u){return this._itemByGraphic.has(u)};w.getBounds=function(u){return(u=this._itemByGraphic.get(u))?u.bounds:null};w.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(u=>u.graphic.visible).map(u=>u.bounds)};w.addOrModify=function(u,k,g){if(u&&!q.isNone(k)){this.has(u)&&
this.remove(u);this._onAdd(u);var f=[0,0,0,0],n=this._getSymbolBounds(null,k,g,f,0);k=a.acquire(u,k,g,q.isSome(n)?n:null,f);this._itemByGraphic.set(u,k);g&&this._index.insert(k);return k.bounds}};w.remove=function(u){if(this._itemByGraphic.has(u)){this._onRemove(u);var k=this._itemByGraphic.get(u);k.bounds&&this._index.remove(k);this._itemByGraphic.delete(u)}};w.updateZ=function(){const u=this._graphics.items;for(let g=0;g<u.length;g++){var k=u[g];if(k=this._itemByGraphic.get(k))k.zorder=g}};w.update=
function(u,k,g){const f=this._itemByGraphic.get(u);f.groupId=null;const n=C.clone(f.bounds);this._index.remove(f);const z=this._getSymbolBounds(f.bounds,k,g,f.size,0);q.isSome(z)&&f.set(u,k,g,z,f.size);g&&this._index.insert(f);return{oldBounds:n,newBounds:f.bounds}};w.updateLevel=function(u){if(this._resolution!==u){this._resolution=u;this._index.clear();var k=this._itemByGraphic;u=[];for(const [,g]of k)k=this._getSymbolBounds(g.bounds,g.symbolResource,g.geometry,g.size,0),g.geometry&&q.isSome(k)&&
(g.bounds=k,u.push(g));this._index.load(u)}};w.clear=function(){this._itemByGraphic.clear();this._index.clear()};w._createTileGraphics=function(u,k,g,f,n){const z=this._uidFieldName,x=this._tileInfoView.spatialReference,{bounds:B,resolution:D}=n;g.sort((J,L)=>J.zorder-L.zorder);let F,G,H;for(let J=0;J<g.length;J++){G=g[J];n=G.graphic;F=G.getGeometryQuantized(f,B,x,D);H=0===J?-1:g[J-1].graphic.uid;const L={...G.graphic.attributes};L[z]=n.uid;null==G.groupId&&(G.groupId=k.createTemplateGroup(G.symbol,
null));u.push({centroid:a.getCentroidQuantized(G,f),geometry:F,attributes:L,symbol:G.symbol,groupId:G.groupId,insertAfter:H,zorder:G.zorder})}};w._searchForItems=function(u){var k=this._tileInfoView.spatialReference,g=u.bounds;if(k.isWrappable){const [f,n]=m.getInfo(k).valid;k=1E-5>Math.abs(g[2]-n);const z=1E-5>Math.abs(g[0]-f);if(!(k&&z||!k&&!z))return u=u.resolution,u=k?C.create([f,g[1],f+u*b.PIXEL_BUFFER,g[3]]):C.create([n-u*b.PIXEL_BUFFER,g[1],n,g[3]]),g=d(this._index,g[0],g[1],g[2],g[3]),u=d(this._index,
u[0],u[1],u[2],u[3]),[...(new Set([...g,...u]))]}return d(this._index,g[0],g[1],g[2],g[3])};w._getSymbolBounds=function(u,k,g,f,n){if(!k||!k.symbol||!g)return null;u||(u=C.create());A.getBoundsXY(u,g);if(!f||0===f[0]&&0===f[1]&&0===f[2]&&0===f[3]){const {hash:z,textInfo:x}=k;k=this._hashToCIM.get(z);if(!k)return null;f||(f=[0,0,0,0]);n=this._inflatedSizeHelper.getSymbolInflateSize(f,k.symbol,this._cimResourceManager,n,x);f[0]=t.pt2px(n[0]);f[1]=t.pt2px(n[1]);f[2]=t.pt2px(n[2]);f[3]=t.pt2px(n[3])}n=
this._resolution;f=c.CIMSymbolInflatedSizeHelper.safeSize(f);u[0]-=f*n;u[1]-=f*n;u[2]+=f*n;u[3]+=f*n;return u};return h}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry".split(" "),
function(q,t,E,C,A,y,m,l,c){function a(e){e.coords.length=0;e.lengths.length=0}const b=new c,d=new c;c=function(){function e(){this.bounds=E.create();this.graphic=null}e.acquire=function(r=null,v,h,w,u){let k;0===e._pool.length?k=new e:(k=e._pool.pop(),this._set.delete(k));k.acquire(r,v,h,w,u);return k};e.release=function(r){r&&!this._set.has(r)&&(r.release(),this._pool.push(r),this._set.add(r))};e.getCentroidQuantized=function(r,v){if(A.isPolygon(r.geometry)){const h=r.symbol;if(t.isNone(h))return null;
if(0<h?.layers.length&&h.layers.some(w=>"text"===w.type||"marker"===w.type))return r=C.polygonCentroid(r.geometry),null!==r?y.quantizePoint(v,{},{x:r[0],y:r[1]},!1,!1):null}return null};var p=e.prototype;p.acquire=function(r=null,v,h,w,u){r&&this.set(r,v,h,w,u)};p.release=function(){this.geometry=this.symbolResource=this.graphic=null};p.set=function(r,v,h,w,u){this.graphic=r;this.geometry=h;this.symbolResource=v;this.bounds=w;u&&(this.size=u)};p.getGeometryQuantized=function(r,v,h,w){var u=this.geometry;
const k=A.getJsonType(u);if(t.isNone(k))return null;switch(k){case "esriGeometryPolygon":({rings:u}=u);if(!u||0===u.length)return null;h=1===u.length&&2===u[0].length?y.quantizeGeometry(r,{paths:[[u[0][0],u[0][1]]]}):y.quantizeGeometry(r,this.geometry);if(!h&&(h=y.quantizeGeometry(r,{x:u[0][0][0],y:u[0][0][1]}))){const {x:f,y:n}=h;return{rings:[[[f-1,n],[1,-1],[1,1],[-1,1],[-1,-1]]]}}return h;case "esriGeometryPolyline":return a(b),a(d),l.convertFromPolyline(b,u),l.generalizeOptimizedGeometry(d,b,
u.hasZ,u.hasM,"esriGeometryPolyline",r.scale[0]),l.quantizeOptimizedGeometry(b,d,u.hasZ,u.hasM,"esriGeometryPolyline",r),l.convertToPolyline(b,u.hasZ,u.hasM);case "esriGeometryMultipoint":const g=.5*w*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]);h=m.getInfo(h);u=u.points;if(h){const [f,n]=h.valid,z=n-f;u=u.filter(x=>{if(x[0]+g>n||x[0]-g<f){const B=[...x];B[0]=x[0]+g>n?B[0]-z:B[0]+z;return E.containsPointWithMargin(v,x,g)||E.containsPointWithMargin(v,
B,g)}return E.containsPointWithMargin(v,x,g)})}return 0===u.length?{points:u}:y.quantizeGeometry(r,{points:u})}return y.quantizeGeometry(r,this.geometry)};q._createClass(e,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return e}();c._pool=[];c._set=new Set;return c})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,t,E,C,A,y,m,l){q.GraphicsView=c=>{c=function(a){function b(){var d=a.apply(this,arguments)||this;d.graphics=null;d.renderer=null;return d}t._inheritsLoose(b,a);return b}(C.IdentifiableMixin(c));E.__decorate([A.property()],c.prototype,"graphics",void 0);E.__decorate([A.property()],c.prototype,"renderer",void 0);E.__decorate([A.property()],c.prototype,"updating",void 0);E.__decorate([A.property()],c.prototype,"view",void 0);return c=E.__decorate([l.subclass("esri.views.layers.GraphicsView")],
c)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(q,t,E){return function(C){function A(){return C.apply(this,arguments)||this}q._inheritsLoose(A,C);var y=A.prototype;y.renderChildren=function(m){this.attributeView.update();this.children.some(l=>l.hasData)&&(this.attributeView.bindTextures(m.context,
!1),C.prototype.renderChildren.call(this,m),m.drawPhase===t.WGLDrawPhase.MAP&&this._renderChildren(m),this.hasHighlight()&&m.drawPhase===t.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(m),this._boundsRenderer&&this._boundsRenderer.doRender(m))};y._renderHighlight=function(m){var {painter:l}=m;l=l.effects.highlight;l.bind(m);this._renderChildren(m,l.defines);l.draw(m);l.unbind()};return A}(E)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/FeatureContainer","./GraphicBoundsRenderer","../../../webgl/enums"],function(q,t,E,C){return function(A){function y(l){l=A.call(this,l)||this;l.hasHighlight=()=>!0;return l}q._inheritsLoose(y,A);var m=y.prototype;m.destroy=function(){A.prototype.destroy.call(this);this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)};m.enableRenderingBounds=function(l){this._boundsRenderer=new E(l);this.requestRender()};m.onTileData=function(l,c){l.patch(c);this.contains(l)||
this.addChild(l);this.requestRender()};m.onTileError=function(l){l.clear();this.contains(l)||this.addChild(l)};m._renderChildren=function(l,c){for(const a of this.children)a.isReady&&a.hasData&&(a.commit(l),l.context.setStencilFunction(C.CompareFunction.EQUAL,a.stencilRef,255),a._displayList.replay(l,a,c))};q._createClass(y,[{key:"hasLabels",get:function(){return!1}}]);return y}(t.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(q,t,E,C,A,y,m){y=function(l){function c(b){var d=l.call(this,b)||this;d._rendererInfo=new m.WGLRendererInfo;d._materialItemsRequestQueue=new C;d.attributeView=new A.AttributeStoreView(()=>d.onAttributeStoreUpdate());return d}t._inheritsLoose(c,l);var a=c.prototype;a.destroy=function(){this.children.forEach(b=>b.destroy());this.removeAllChildren();this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(b,d,e){this._rendererInfo.setInfo(b,d,e);this.requestRender()};
a.getMaterialItems=function(){var b=t._asyncToGenerator(function*(d,e){if(!d||0===d.length)return null;const p=E.createResolver();this._materialItemsRequestQueue.push({items:d,abortOptions:e,resolver:p});this.requestRender();return p.promise});return function(d,e){return b.apply(this,arguments)}}();a.doRender=function(b){b.context.capabilities.enable("textureFloat");b.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let d=this._materialItemsRequestQueue.pop();for(;d;)this._processMaterialItemRequest(b,
d),d=this._materialItemsRequestQueue.pop()}l.prototype.doRender.call(this,b)};a.renderChildren=function(b){for(const d of this.children)d.commit(b);this._rendererInfo.update(b.state);l.prototype.renderChildren.call(this,b)};a.updateTransforms=function(b){if(this.children.some(d=>d.hasData))for(const d of this.children)d.setTransform(b)};a.createRenderParams=function(b){b=l.prototype.createRenderParams.call(this,b);b.rendererInfo=this._rendererInfo;b.attributeView=this.attributeView;return b};a.onAttributeStoreUpdate=
function(){};a._processMaterialItemRequest=function(b,{items:d,abortOptions:e,resolver:p}){const {painter:r,pixelRatio:v}=b;b=d.map(h=>r.textureManager.rasterizeItem(h.symbol,v,h.glyphIds,e));Promise.all(b).then(h=>{this.stage?(h=h.map((w,u)=>({id:d[u].id,mosaicItem:w})),p.resolve(h)):p.reject()},p.reject)};return c}(y);q.FeatureContainer=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p){const r=A.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),v=b.createDebugLogger(b.DEBUG_ATTR_UPDATES,r);let h=function(){function w(k,g,f){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:n,pixelType:z,textureOnly:x}=k;k=a.getPixelArrayCtor(z);this.shared=f;this.pixelType=z;this.size=g;this.textureOnly=x;x||(this.data=new k(y.unwrap(n)));this._resetRange()}var u=w.prototype;u.destroy=function(){y.applySome(this._texture,
k=>k.dispose());for(const k in this._fbos)y.applySome(this._fbos[k],g=>{"0"===k&&g.detachColorTexture();g.dispose()}),this._fbos[k]=null;this._texture=null};u.setData=function(k,g,f){k=c.getDisplayIdTexel(k);const n=y.unwrap(this.data);g=k*this.texelSize+g;!n||g>=n.length||(n[g]=f,this.dirtyStart=Math.min(this.dirtyStart,k),this.dirtyEnd=Math.max(this.dirtyEnd,k))};u.getData=function(k,g){if(y.isNone(this.data))return null;k=c.getDisplayIdTexel(k)*this.texelSize+g;return!this.data||k>=this.data.length?
null:this.data[k]};u.getTexture=function(k){return y.unwrapOr(this._texture,()=>this._initTexture(k))};u.getFBO=function(k,g=0){if(y.isNone(this._fbos[g])){const f={colorTarget:d.TargetType.TEXTURE,depthStencilTarget:d.DepthStencilTargetType.NONE},n=0===g?this.getTexture(k):this._textureDesc;this._fbos[g]=new e.FramebufferObject(k,f,n)}return this._fbos[g]};u.updateTexture=function(k,g){if(!this.locked){try{const f=this.dirtyStart,n=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const z=
y.unwrap(this.data).buffer,x=this.getTexture(k),B=(f-f%this.size)/this.size,D=(n-n%this.size)/this.size,F=B*this.size*4,G=4*(this.size+D*this.size)-F,H=a.getPixelArrayCtor(this.pixelType),J=new H(z,F*H.BYTES_PER_ELEMENT,G),L=this.size;k=D-B+1;if(k>this.size){r.error(new E("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}x.updateData(0,0,B,L,k,J)}catch(f){}g()}};u.update=function(k){const {data:g,start:f,end:n}=k;if(y.isSome(g)){const z=this.data,x=f*this.texelSize;for(let B=
0;B<g.length;B++)k.layout&1<<B%this.texelSize&&(z[x+B]=g[B])}this.dirtyStart=Math.min(this.dirtyStart,f);this.dirtyEnd=Math.max(this.dirtyEnd,n)};u.resize=function(k,g){const f=this.size;this.size=g;this.textureOnly?f!==this.size&&(this._lastTexture=this._texture,this._texture=null):(g=a.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new g(y.unwrap(k.buffer)))};u._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};u._initTexture=function(k){const g=new p.Texture(k,this._textureDesc,
y.unwrapOr(this.data,void 0));if(y.isSome(this._lastTexture)&&this._fbos[0]){const z=this._lastTexture.descriptor.width,x=this._lastTexture.descriptor.height,B=this._lastTexture.descriptor.dataType,D=this._lastTexture.descriptor.pixelFormat,F=this.getFBO(k);var f=a.getPixelBytes(B),n=a.getPixelArrayCtor(B);f=new ArrayBuffer(z*x*f*this.texelSize);n=new n(f);f=k.getBoundFramebufferObject();const {x:G,y:H,width:J,height:L}=k.getViewport();k.bindFramebuffer(F);F.readPixels(0,0,z,x,D,B,n);g.updateData(0,
0,0,2*z,x/2,n);k.setViewport(G,H,J,L);k.bindFramebuffer(f)}this.destroy();return this._texture=g};t._createClass(w,[{key:"_textureDesc",get:function(){return{target:d.TextureType.TEXTURE_2D,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:d.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:d.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===d.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&C("esri-atomics")&&this.data?
1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return w}();A=function(){function w(k){this._onUpdate=k;this._locked=this._forceNextUpload=this._initialized=!1}var u=w.prototype;u.initialize=function(k){const {blocks:g,shared:f,size:n}=k;this.shared=f;this.size=n;v("Initializing AttributeStoreView",k);if(y.isNone(this._data))this._data=y.mapMany(g,z=>new h(z,n,f));else for(k=0;k<this._data.length;k++){const z=this._data[k],x=g[k];y.isSome(x)&&
(y.isNone(z)?this._data[k]=new h(x,n,f):z.resize(x,n))}this._initialized=!0};u.destroy=function(){y.applySome(this._data,k=>y.mapMany(k,g=>g.destroy()));y.applySome(this._defaultTexture,k=>k.dispose())};u.isEmpty=function(){return y.isNone(this._data)};u.isUpdating=function(){const k=y.isSome(this._pendingAttributeUpdate);C("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${k}\n  -> hasPendingUpdate ${k}`);return k};u.getBlock=function(k){return y.isNone(this._data)?null:this._data[k]};
u.setLabelMinZoom=function(k,g){this.setData(k,0,1,g)};u.getLabelMinZoom=function(k){return this.getData(k,0,1,255)};u.getFilterFlags=function(k){return this.getData(k,0,0,0)};u.getVVSize=function(k){return this.getData(k,l.ATTRIBUTE_DATA_VV,0,0)};u.getData=function(k,g,f,n){if(!this._data)return 0;g=y.unwrap(this._data)[g];if(y.isNone(g))return 0;k=g.getData(k,f);return y.isSome(k)?k:n};u.setData=function(k,g,f,n){g=y.unwrap(this._data)[g];y.unwrap(g).setData(k,f,n)};u.lockTextureUpload=function(){this._locked=
!0};u.unlockTextureUpload=function(){this._locked=!1};u.forceTextureUpload=function(){this._forceNextUpload=!0};u.requestUpdate=function(){var k=t._asyncToGenerator(function*(g){if(this._pendingAttributeUpdate)r.error(new E("mapview-webgl","Tried to update attribute data with a pending update"));else{var f=m.createResolver();v("AttributeStoreView Update Requested",g);this._pendingAttributeUpdate={data:g,resolver:f};this._onUpdate();return f.promise}});return function(g){return k.apply(this,arguments)}}();
u.update=function(){if(this._initialized&&y.isSome(this._pendingAttributeUpdate)){C("esri-2d-update-debug")&&console.debug("AttributeStoreView::update");const {data:k,resolver:g}=this._pendingAttributeUpdate,f=y.unwrap(this._data);for(let n=0;n<k.blocks.length;n++){const z=k.blocks[n];y.applySome(f[n],x=>y.applySome(z,B=>{v(`Updating block ${n}`,B);x.update(B)}))}this._pendingAttributeUpdate=null;g();this._onUpdate()}};u.bindTextures=function(k,g=!0){const f=this._getDefaultTexture(k);if(this._initialized){var n=
y.unwrap(this._data);if(!this._locked||this._forceNextUpload)y.forEachSome(n,z=>z.updateTexture(k,()=>this._onUpdate())),this._forceNextUpload=!1;k.bindTexture(y.mapOr(n[l.ATTRIBUTE_DATA_FILTER_FLAGS],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_0);g&&(k.bindTexture(y.mapOr(n[l.ATTRIBUTE_DATA_GPGPU],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_GPGPU),k.bindTexture(y.mapOr(n[l.ATTRIBUTE_DATA_ANIMATION],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),k.bindTexture(y.mapOr(n[l.ATTRIBUTE_DATA_VV],
f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),k.bindTexture(y.mapOr(n[l.ATTRIBUTE_DATA_DD1],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),k.bindTexture(y.mapOr(n[l.TEXTURE_BINDING_ATTRIBUTE_DATA_4],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),k.bindTexture(y.mapOr(n[l.TEXTURE_BINDING_ATTRIBUTE_DATA_5],f,z=>z.getTexture(k)),l.TEXTURE_BINDING_ATTRIBUTE_DATA_5))}else k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_0),g&&(k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_1),
k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_2),k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_3),k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_4),k.bindTexture(f,l.TEXTURE_BINDING_ATTRIBUTE_DATA_5),k.bindTexture(f,l.TEXTURE_BINDING_GPGPU))};u._getDefaultTexture=function(k){y.isNone(this._defaultTexture)&&(this._defaultTexture=new p.Texture(k,{wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.NEAREST,
width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return w}();q.AttributeStoreView=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(q,t,E,C,A,y){const m=(l,c)=>0!==l.key.level-c.key.level?l.key.level-c.key.level:0!==l.key.row-
c.key.row?l.key.row-c.key.row:l.key.col-c.key.col;return function(l){function c(b){var d=l.call(this)||this;d._tileInfoView=b;return d}q._inheritsLoose(c,l);var a=c.prototype;a.renderChildren=function(b){this.sortChildren(m);this.setStencilReference(b);l.prototype.renderChildren.call(this,b)};a.createRenderParams=function(b){const {state:d}=b;b=l.prototype.createRenderParams.call(this,b);b.requiredLevel=this._tileInfoView.getClosestInfoForScale(d.scale).level;b.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(d.scale);
return b};a.prepareRenderPasses=function(b){const d=l.prototype.prepareRenderPasses.call(this,b);d.push(b.registerRenderPass({name:"stencil",brushes:[y],drawPhase:E.WGLDrawPhase.DEBUG|E.WGLDrawPhase.MAP|E.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));t("esri-tiles-debug")&&d.push(b.registerRenderPass({name:"tileInfo",brushes:[A],drawPhase:E.WGLDrawPhase.DEBUG,target:()=>this.children}));return d};a.getStencilTarget=function(){return this.children};a.setStencilReference=function(b){b=
1;for(const d of this.children)d.stencilRef=b++};q._createClass(c,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return c}(C)})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(q,t,E,C,A,y,m,l){return function(c){function a(){var d=c.apply(this,arguments)||this;d.name=d.constructor.name;return d}
q._inheritsLoose(a,c);var b=a.prototype;b.beforeRender=function(d){c.prototype.beforeRender.call(this,d);this.updateTransforms(d.state)};b._createTransforms=function(){return{dvs:C.create()}};b.doRender=function(d){d=this.createRenderParams(d);const {painter:e,globalOpacity:p,profiler:r,drawPhase:v}=d,h=v===l.WGLDrawPhase.LABEL||v===l.WGLDrawPhase.HIGHLIGHT?1:p*this.computedOpacity;r.recordContainerStart(this.name);e.beforeRenderLayer(d,this._clippingInfos?255:0,h);this.renderChildren(d);e.compositeLayer(d,
h);r.recordContainerEnd()};b.renderChildren=function(d){E.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(d.painter));for(const e of this._renderPasses)try{e.render(d)}catch(p){}};b.createRenderParams=function(d){d.requireFBO=this.requiresDedicatedFBO;return d};b.prepareRenderPasses=function(d){return[d.registerRenderPass({name:"clip",brushes:[A.brushes.clip],target:()=>this._clippingInfos,drawPhase:l.WGLDrawPhase.MAP|l.WGLDrawPhase.LABEL|l.WGLDrawPhase.LABEL_ALPHA|l.WGLDrawPhase.DEBUG|
l.WGLDrawPhase.HIGHLIGHT})]};b.updateTransforms=function(d){for(const e of this.children)e.setTransform(d)};b.onAttach=function(){c.prototype.onAttach.call(this);this._updateClippingInfo()};b.onDetach=function(){c.prototype.onDetach.call(this);this._updateClippingInfo()};b._updateClippingInfo=function(){E.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(e=>e.destroy()),this._clippingInfos=null);if(this.stage){var d=this._clips;E.isSome(d)&&d.length&&(this._clippingInfos=d.items.map(e=>m.fromClipArea(this.stage,
e)));this.requestRender()}};q._createClass(a,[{key:"clips",set:function(d){this._clips=d;this.children.forEach(e=>e.clips=d);this._updateClippingInfo()}}]);return a}(y.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/reactiveUtils ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(q,t,E,
C,A,y,m,l,c){return function(a){function b(e,p){var r=a.call(this)||this;r._clip=p;r._cache={};r.stage=e;r._handle=A.watch(()=>p.version,()=>r._invalidate());r.ready();return r}q._inheritsLoose(b,a);b.fromClipArea=function(e,p){return new b(e,p)};var d=b.prototype;d._destroyGL=function(){C.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);C.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};d.destroy=function(){this._destroyGL();this._handle.remove()};
d.getVAO=function(e,p,r,v){const [h,w]=p.size;if("geometry"===this._clip.type||this._lastWidth!==h||this._lastHeight!==w)this._lastWidth=h,this._lastHeight=w,this._destroyGL();if(C.isNone(this._cache.vao)){p=this._createMesh(p,this._clip);const u=p.getIndexBuffer(e),k=p.getVertexBuffers(e);this._cache.mesh=p;this._cache.vao=new c.VertexArrayObject(e,r,v,k,u)}return this._cache.vao};d._createTransforms=function(){return{dvs:y.create()}};d._invalidate=function(){this._destroyGL();this.requestRender()};
d._createScreenRect=function(e,p){const [r,v]=e.size;e="string"===typeof p.left?parseFloat(p.left)/100*r:p.left;const h="string"===typeof p.right?parseFloat(p.right)/100*r:p.right,w="string"===typeof p.top?parseFloat(p.top)/100*v:p.top;p="string"===typeof p.bottom?parseFloat(p.bottom)/100*v:p.bottom;return{x:e,y:w,width:Math.max(r-h-e,0),height:Math.max(v-p-w,0)}};d._createMesh=function(e,p){switch(p.type){case "rect":return l.fromRect(this._createScreenRect(e,p));case "path":return l.fromPath(p);
case "geometry":return l.fromGeometry(e,p);default:return E.getLogger("esri.views.2d.engine.webgl.ClippingInfo").error(new t("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),l.fromRect({x:0,y:0,width:1,height:1})}};return b}(m.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){const e=({coords:p,lengths:r},v)=>{const h=[];for(let k=0,g=0;k<r.length;g+=r[k],k+=1){const f=g;for(var w=[];k<r.length-1;k+=1,g+=r[k]){var u=g+r[k];let n=0;for(let z=1;z<r[k+1];z++)n+=(p[2*(u+z)]-p[2*(u+z-1)])*(p[2*(u+z)+1]+p[2*(u+z-1)+1]);if(!(v?0<n:0>n))break;w.push(g+r[k]-f)}u=p.slice(2*f,2*(g+r[k]));w=A.earcut(u,w,2);for(const n of w)h.push(n+f)}return h};return function(){function p(v,h,w,u=!1){this._cache={};this.vertices=v;this.indices=h;this.primitiveType=
w;this.isMapSpace=u}p.fromRect=function({x:v,y:h,width:w,height:u}){return p.fromScreenExtent({xmin:v,ymin:h,xmax:v+w,ymax:h+u})};p.fromPath=function(v){var h=l.convertFromNestedArray(new c,v.path,!1,!1);v=h.coords;h=new Uint32Array(e(h,!0));const w=new Uint32Array(v.length/2);for(let u=0;u<w.length;u++)w[u]=a.i1616to32(Math.floor(v[2*u]),Math.floor(v[2*u+1]));return new p({geometry:w},h,d.PrimitiveType.TRIANGLES)};p.fromGeometry=function(v,h){const w=h.geometry.type;switch(w){case "polygon":return p.fromPolygon(v,
h.geometry);case "extent":return p.fromMapExtent(v,h.geometry);default:return E.getLogger("esri.views.2d.engine.webgl.Mesh2D").error(new t("mapview-bad-type",`Unable to create a mesh from type ${w}`,h)),p.fromRect({x:0,y:0,width:1,height:1})}};p.fromPolygon=function(v,h){var w=l.convertFromPolygon(new c,h,!1,!1);h=w.coords;w=new Uint32Array(e(w,!1));const u=new Uint32Array(h.length/2),k=m.create(),g=m.create();for(let f=0;f<u.length;f++)y.set(k,h[2*f],h[2*f+1]),v.toScreen(g,k),u[f]=a.i1616to32(Math.floor(g[0]),
Math.floor(g[1]));return new p({geometry:u},w,d.PrimitiveType.TRIANGLES,!0)};p.fromScreenExtent=function({xmin:v,xmax:h,ymin:w,ymax:u}){v={geometry:new Uint32Array([a.i1616to32(v,w),a.i1616to32(h,w),a.i1616to32(v,u),a.i1616to32(v,u),a.i1616to32(h,w),a.i1616to32(h,u)])};h=new Uint32Array([0,1,2,3,4,5]);return new p(v,h,d.PrimitiveType.TRIANGLES)};p.fromMapExtent=function(v,h){const [w,u]=v.toScreen([0,0],[h.xmin,h.ymin]),[k,g]=v.toScreen([0,0],[h.xmax,h.ymax]);v={geometry:new Uint32Array([a.i1616to32(w,
u),a.i1616to32(k,u),a.i1616to32(w,g),a.i1616to32(w,g),a.i1616to32(k,u),a.i1616to32(k,g)])};h=new Uint32Array([0,1,2,3,4,5]);return new p(v,h,d.PrimitiveType.TRIANGLES)};var r=p.prototype;r.destroy=function(){C.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const v in this._cache.vertexBuffers)C.isSome(this._cache.vertexBuffers[v])&&this._cache.vertexBuffers[v].dispose()};r.getIndexBuffer=function(v,h=d.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=b.BufferObject.createIndex(v,
h,this.indices));return this._cache.indexBuffer};r.getVertexBuffers=function(v,h=d.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((w,u)=>({...w,[u]:b.BufferObject.createVertex(v,h,this.vertices[u])}),{}));return this._cache.vertexBuffers};q._createClass(p,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var v=d.DataType.UNSIGNED_BYTE;break a;case 2:v=d.DataType.UNSIGNED_SHORT;break a;case 4:v=d.DataType.UNSIGNED_INT;
break a;default:throw new t("Cannot get DataType of array");}return v}}]);return p}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(q,t,E,C,A,y,m,l,c,a){function b(e,p){const r=p.length;if(e<p[0].value||1===
r)return p[0].size;for(let v=1;v<r;v++)if(e<p[v].value)return p[v-1].size+(e-p[v-1].value)/(p[v].value-p[v-1].value)*(p[v].size-p[v-1].size);return p[r-1].size}let d=function(){function e(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",
vvOpacityEnabled:!1};this._technique=l.Technique}var p=e.prototype;p.getSizeVVFieldStops=function(r){const v=this._vvSizeFieldStops;switch(v.type){case "static":return v;case "level-dependent":return E.unwrapOr(v.levels[r],()=>{var h=Infinity,w=0;for(var u in v.levels){const k=parseFloat(u),g=Math.abs(r-k);g<h&&(h=g,w=k)}if(Infinity===h)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};h=2**((r-w)/2);w=E.unwrap(v.levels[w]);u=new Float32Array(w.values);u[2]*=h;u[3]*=
h;return{sizes:E.unwrap(w.sizes),values:u}})}};p.update=function(r){E.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,r)};p.setInfo=function(r,v,h){this._updateEffects(h);this._vvInfo=v;this._technique=c.getTechniqueFromRenderer(r);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,r)};p.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:a.getWebGLCapabilities("2d").supportsTextureFloat}};
p.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};p._updateEffects=function(r){E.isSome(r)?this.outsideLabelsVisible=r.excludedLabelsVisible:this.outsideLabelsVisible=!1};p._updateVisualVariables=function(r,v){const h=this._vvMaterialParameters;h.vvOpacityEnabled=!1;h.vvSizeEnabled=!1;h.vvColorEnabled=!1;h.vvRotationEnabled=!1;if(r){var w=r.size;if(w){h.vvSizeEnabled=!0;if(w.minMaxValue){const k=w.minMaxValue;let g;if(m.isDefined(k.minSize)&&
m.isDefined(k.maxSize))if(m.isNumber(k.minSize)&&m.isNumber(k.maxSize)){g=C.pt2px(k.minSize);var u=C.pt2px(k.maxSize)}else u=v.scale,g=C.pt2px(b(u,k.minSize.stops)),u=C.pt2px(b(u,k.maxSize.stops));this.vvSizeMinMaxValue.set([k.minDataValue,k.maxDataValue,g,u])}w.scaleStops&&(this.vvSizeScaleStopsValue=C.pt2px(b(v.scale,w.scaleStops.stops)));w.unitValue&&(this.vvSizeUnitValueToPixelsRatio=A.getMetersPerUnitForSR(v.spatialReference)/y.meterIn[w.unitValue.unit]/v.resolution);w.fieldStops&&(this._vvSizeFieldStops=
w.fieldStops)}if(v=r.color)h.vvColorEnabled=!0,this.vvColorValues.set(v.values),this.vvColors.set(v.colors);if(v=r.opacity)h.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities);if(r=r.rotation)h.vvRotationEnabled=!0,h.vvRotationType=r.type}};t._createClass(e,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return e}();q.WGLRendererInfo=d;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),function(q,t,E,C,A,y,m,l,c,a,b){const d=Math.PI/180,e=()=>l.createProgramDescriptor("bounds",
{geometry:[{location:0,name:"a_position",count:2,type:a.DataType.FLOAT}]});return function(p){function r(h){var w=p.call(this)||this;w._dvsMat3=E.create();w._localOrigin={x:0,y:0};w._getBounds=h;return w}q._inheritsLoose(r,p);var v=r.prototype;v.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=null);this._program&&(this._program.dispose(),this._program=null)};v.doRender=function(h){const {context:w}=h,u=this._getBounds();1>u.length||(this._createShaderProgram(w),
this._updateMatricesAndLocalOrigin(h),this._updateBufferData(w,u),w.setBlendingEnabled(!0),w.setDepthTestEnabled(!1),w.setStencilWriteMask(0),w.setStencilTestEnabled(!1),w.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),w.setColorMask(!0,!0,!0,!0),h=this._program,w.bindVAO(this._vao),w.useProgram(h),h.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),w.gl.lineWidth(1),w.drawElements(a.PrimitiveType.LINES,8*u.length,a.DataType.UNSIGNED_INT,0),w.bindVAO())};v._createTransforms=function(){return{dvs:E.create()}};
v._createShaderProgram=function(h){this._program||(this._program=h.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",e().attributes))};v._updateMatricesAndLocalOrigin=
function(h){var {state:w}=h;const {displayMat3:u,size:k,resolution:g,pixelRatio:f,rotation:n,viewpoint:z}=w;h=d*n;const {x,y:B}=z.targetGeometry;w=y.normalizeMapX(x,w.spatialReference);this._localOrigin.x=w;this._localOrigin.y=B;w=f*k[0];const D=f*k[1],F=g*w,G=g*D,H=t.identity(this._dvsMat3);t.multiply(H,H,u);t.translate(H,H,C.fromValues(w/2,D/2));t.scale(H,H,A.fromValues(k[0]/F,-D/G,1));t.rotate(H,H,-h)};v._updateBufferData=function(h,w){const {x:u,y:k}=this._localOrigin,g=new Float32Array(8*w.length),
f=new Uint32Array(8*w.length);let n=0,z=0;for(const x of w)x&&(g[2*n]=x[0]-u,g[2*n+1]=x[1]-k,g[2*n+2]=x[0]-u,g[2*n+3]=x[3]-k,g[2*n+4]=x[2]-u,g[2*n+5]=x[3]-k,g[2*n+6]=x[2]-u,g[2*n+7]=x[1]-k,f[z+0]=n+0,f[z+1]=n+3,f[z+2]=n+3,f[z+3]=n+2,f[z+4]=n+2,f[z+5]=n+1,f[z+6]=n+1,f[z+7]=n+0,n+=4,z+=8);this._vertexBuffer?this._vertexBuffer.setData(g.buffer):this._vertexBuffer=c.BufferObject.createVertex(h,a.Usage.DYNAMIC_DRAW,g.buffer);this._indexBuffer?this._indexBuffer.setData(f):this._indexBuffer=c.BufferObject.createIndex(h,
a.Usage.DYNAMIC_DRAW,f);this._vao||(w=e(),this._vao=new b.VertexArrayObject(h,w.attributes,w.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return r}(m.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(q){function t(){return new Float32Array(3)}function E(h){const w=new Float32Array(3);w[0]=h[0];w[1]=h[1];w[2]=h[2];return w}function C(h,w,u){const k=new Float32Array(3);k[0]=h;k[1]=w;k[2]=u;return k}function A(h,w){return new Float32Array(h,w,3)}function y(){return t()}
function m(){return C(1,1,1)}function l(){return C(1,0,0)}function c(){return C(0,1,0)}function a(){return C(0,0,1)}const b=t(),d=m(),e=l(),p=c(),r=a(),v=Object.freeze(Object.defineProperty({__proto__:null,create:t,clone:E,fromValues:C,createView:A,zeros:y,ones:m,unitX:l,unitY:c,unitZ:a,ZEROS:b,ONES:d,UNIT_X:e,UNIT_Y:p,UNIT_Z:r},Symbol.toStringTag,{value:"Module"}));q.ONES=d;q.UNIT_X=e;q.UNIT_Y=p;q.UNIT_Z=r;q.ZEROS=b;q.clone=E;q.create=t;q.createView=A;q.fromValues=C;q.ones=m;q.unitX=l;q.unitY=c;
q.unitZ=a;q.vec3f32=v;q.zeros=y})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),function(q,t,E,
C,A,y,m,l,c,a,b,d,e,p){const r=new E({targetGeometry:new c}),v=[0,0];E=function(h){function w(k){k=h.call(this,k)||this;k._endTimer=null;k.animationManager=null;return k}q._inheritsLoose(w,h);var u=w.prototype;u.initialize=function(){this.pan=new d({navigation:this});this.rotate=new p({navigation:this});this.pinch=new e({navigation:this});this.zoomBox=new b({view:this.view,navigation:this})};u.destroy=function(){this.pan.destroy();this.rotate.destroy();this.pinch.destroy();this.zoomBox.destroy();
this.pan=this.rotate=this.pinch=this.zoomBox=this.animationManager=null};u.begin=function(){this._set("interacting",!0)};u.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};u.zoom=function(){var k=q._asyncToGenerator(function*(g,f=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>g?this.zoomIn(f):this.zoomOut(f);this.setViewpoint(f,g,0,[0,0])});return function(g){return k.apply(this,arguments)}}();
u.zoomIn=function(){var k=q._asyncToGenerator(function*(g){var f=this.view;f=f.constraints.snapToNextScale(f.scale);return this._zoomToScale(f,g)});return function(g){return k.apply(this,arguments)}}();u.zoomOut=function(){var k=q._asyncToGenerator(function*(g){var f=this.view;f=f.constraints.snapToPreviousScale(f.scale);return this._zoomToScale(f,g)});return function(g){return k.apply(this,arguments)}}();u.setViewpoint=function(k,g,f,n){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
k,g,f,n);this.end()};u.setViewpointImmediate=function(k,g=0,f=[0,0],n=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,n,k,g,f)};u.continousRotateClockwise=function(){const k=this.get("view.viewpoint");this.animationManager.animateContinous(k,g=>{a.rotateBy(g,g,-1)})};u.continousRotateCounterclockwise=function(){const k=this.get("view.viewpoint");this.animationManager.animateContinous(k,g=>{a.rotateBy(g,g,1)})};u.resetRotation=function(){this.view.rotation=
0};u.continousPanLeft=function(){this._continuousPan([-10,0])};u.continousPanRight=function(){this._continuousPan([10,0])};u.continousPanUp=function(){this._continuousPan([0,10])};u.continousPanDown=function(){this._continuousPan([0,-10])};u.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};u._continuousPan=function(k){this.animationManager.animateContinous(this.view.viewpoint,
g=>{a.translateBy(g,g,k);this.view.constraints.constrainByGeometry(g)})};u._startTimer=function(k){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const g=performance.now()-this._lastEventTimestamp;250>g?this._endTimer=this._startTimer(g):this._set("interacting",!1)},k)};u._getDefaultAnchor=function(){const {size:k,padding:{left:g,right:f,top:n,bottom:z}}=this.view;v[0]=.5*(k[0]-f+g);v[1]=.5*(k[1]-z+n);return v};u._zoomToScale=function(){var k=q._asyncToGenerator(function*(g,
f=this._getDefaultAnchor()){const {view:n}=this,{constraints:z,scale:x,viewpoint:B,size:D,padding:F}=n,G=z.canZoomInTo(g),H=z.canZoomOutTo(g);if(!(g<x&&!G||g>x&&!H))return a.padAndScaleAndRotateBy(r,B,g/x,0,f,D,F),z.constrainByGeometry(r),n.goTo(r,{animate:!0})});return function(g){return k.apply(this,arguments)}}();u._scaleRotateTranslateViewpoint=function(k,g,f,n,z){var {view:x}=this;const {size:B,padding:D,constraints:F,scale:G,viewpoint:H}=x;var J=G*f;x=F.canZoomInTo(J);J=F.canZoomOutTo(J);if(1>
f&&!x||1<f&&!J)f=1;a.translateBy(H,H,z);a.padAndScaleAndRotateBy(k,H,f,n,g,B,D);return F.constrainByGeometry(k)};return w}(C);t.__decorate([A.property()],E.prototype,"animationManager",void 0);t.__decorate([A.property({type:Boolean,readOnly:!0})],E.prototype,"interacting",void 0);t.__decorate([A.property()],E.prototype,"pan",void 0);t.__decorate([A.property()],E.prototype,"pinch",void 0);t.__decorate([A.property()],E.prototype,"rotate",void 0);t.__decorate([A.property()],E.prototype,"view",void 0);
t.__decorate([A.property()],E.prototype,"zoomBox",void 0);return E=t.__decorate([l.subclass("esri.views.2d.navigation.MapViewNavigation")],E)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(q,t,E,C,A,y,m,l,c){E=function(a){function b(e){e=a.call(this,e)||this;e._container=null;e._overlay=null;e._backgroundShape=null;e._boxShape=null;e._box={x:0,y:0,width:0,height:0};e._redraw=e._redraw.bind(q._assertThisInitialized(e));return e}q._inheritsLoose(b,a);var d=b.prototype;d.destroy=function(){this.view=null};d._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};d._update=function(e,p,r,v){this._box.x=e;this._box.y=p;this._box.width=r;this._box.height=
v;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};d._end=function(e,p,r,v,h){const w=this.view;e=w.toMap(C.createScreenPoint(e+.5*r,p+.5*v));r=Math.max(r/w.width,v/w.height);-1===h&&(r=1/r);this._destroyOverlay();this.navigation.end();w.goTo({center:e,scale:w.scale*r})};d._updateBox=function(e,p,r,v){const h=this._boxShape;h.setAttributeNS(null,"x",""+e);h.setAttributeNS(null,"y",""+p);h.setAttributeNS(null,"width",""+r);h.setAttributeNS(null,"height",""+v);h.setAttributeNS(null,"class",
"esri-zoom-box__outline")};d._updateBackground=function(e,p,r,v){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(e,p,r,v,this.view.width,this.view.height))};d._createContainer=function(){const e=document.createElement("div");e.className="esri-zoom-box__container";this.view.root.appendChild(e);this._container=e};d._createOverlay=function(){var e=this.view.width,p=this.view.height;const r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttributeNS(null,"d","M 0 0 L "+
e+" 0 L "+e+" "+p+" L 0 "+p+" Z");r.setAttributeNS(null,"class","esri-zoom-box__overlay-background");e=document.createElementNS("http://www.w3.org/2000/svg","rect");p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");p.setAttributeNS(null,"class","esri-zoom-box__overlay");p.appendChild(r);p.appendChild(e);this._container.appendChild(p);this._backgroundShape=r;this._boxShape=e;this._overlay=p};
d._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};d._toSVGPath=function(e,p,r,v,h,w){r=e+r;v=p+v;return"M 0 0 L "+h+" 0 L "+h+" "+w+" L 0 "+w+" ZM "+e+" "+p+" L "+e+" "+v+" L "+r+" "+v+" L "+r+" "+p+" Z"};d._handleDrag=function(e,p){var r=e.x,v=e.y,h=e.origin.x;const w=e.origin.y;let u;r>h?(u=h,h=r-h):(u=r,h-=r);v>w?(r=w,v-=w):(r=v,v=w-v);switch(e.action){case "start":this._start();
break;case "update":this._update(u,r,h,v);break;case "end":this._end(u,r,h,v,p)}e.stopPropagation()};d._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:e,y:p,width:r,height:v}=this._box;this._updateBox(e,p,r,v);this._updateBackground(e,p,r,v);this._rafId=requestAnimationFrame(this._redraw)}};q._createClass(b,[{key:"view",set:function(e){this._handles&&this._handles.forEach(p=>{p.remove()});this._handles=null;this._destroyOverlay();this._set("view",e);e&&(e.on("drag",["Shift"],
p=>this._handleDrag(p,1),c.ViewEventPriorities.INTERNAL),e.on("drag",["Shift","Ctrl"],p=>this._handleDrag(p,-1),c.ViewEventPriorities.INTERNAL))}}]);return b}(E);t.__decorate([A.property()],E.prototype,"navigation",void 0);t.__decorate([A.property()],E.prototype,"view",null);return E=t.__decorate([l.subclass("esri.views.2d.navigation.ZoomBox")],E)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v){E=function(h){function w(k){var g=h.call(this,k)||this;g.animationTime=0;g.momentumEstimator=new r.PanPlanarMomentumEstimator(500,6,.92);g.momentum=null;g.tmpMomentum=e.create();g.momentumFinished=!1;g.viewpoint=new C({targetGeometry:new v,scale:0,rotation:0});y.when(()=>g.momentumFinished,()=>g.navigation.stop());return g}q._inheritsLoose(w,h);var u=w.prototype;u.begin=function(k,g){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(g);
this._previousDrag=g};u.update=function(k,g){this.addToEstimator(g);let f=g.center.x,n=g.center.y;const z=this._previousDrag;f=z?z.center.x-f:-f;n=z?n-z.center.y:n;k.viewpoint=p.translateBy(this.viewpoint,k.viewpoint,[f||0,n||0]);this._previousDrag=g};u.end=function(k,g){this.addToEstimator(g);this.momentum=k.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(k);this._previousDrag=null;this.navigation.end()};u.addToEstimator=
function(k){var g=k.center.x;const f=k.center.y,n=m.createScreenPointArray(-g,f);g=e.fromValues(-g,f,0);this.momentumEstimator.add(n,g,.001*k.timestamp)};u.onAnimationUpdate=function(k){this.navigation.animationManager.animateContinous(k.viewpoint,(g,f)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);f*=.001;if(!this.momentumFinished){const n=this.momentum.valueDelta(this.animationTime,f);d.scale(this.tmpMomentum,this.momentum.direction,n);p.translateBy(g,g,this.tmpMomentum);
k.constraints.constrainByGeometry(g)}this.animationTime+=f})};u.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return w}(A);t.__decorate([l.property()],E.prototype,"momentumFinished",void 0);t.__decorate([l.property()],E.prototype,"viewpoint",void 0);t.__decorate([l.property()],E.prototype,"navigation",void 0);return E=t.__decorate([b.subclass("esri.views.2d.navigation.actions.Pan")],E)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(q,t,E,C,A,y){let m=function(l){function c(a,b,d,e,p){a=l.call(this,a,b,d)||this;a._sceneVelocity=e;a.direction=p;return a}t._inheritsLoose(c,l);c.prototype.value=function(a){return l.prototype.valueFromInitialVelocity.call(this,this._sceneVelocity,a)};return c}(y.Momentum);y=function(){function l(a=300,b=12,d=.84){this._minimumInitialVelocity=a;this._stopVelocity=b;this._friction=d;this.enabled=!0;this._time=new A.FilteredFiniteDifference(.6);this._screen=[new A.FilteredFiniteDifference(.4),
new A.FilteredFiniteDifference(.4)];this._scene=[new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6)];this._tmpDirection=C.create()}var c=l.prototype;c.add=function(a,b,d){!this.enabled||this._time.hasLastValue()&&.015>this._time.computeDelta(d)||(this._screen[0].update(a[0]),this._screen[1].update(a[1]),this._scene[0].update(b[0]),this._scene[1].update(b[1]),this._scene[2].update(b[2]),this._time.update(d))};c.reset=function(){this._screen[0].reset();
this._screen[1].reset();this._scene[0].reset();this._scene[1].reset();this._scene[2].reset();this._time.reset()};c.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;var a=this._screen[0].filteredDelta,b=this._screen[1].filteredDelta;a=null==a||null==b?0:Math.sqrt(a*a+b*b);b=this._time.filteredDelta;a=null==b||null==a?0:a/b;return Math.abs(a)<this._minimumInitialVelocity?null:this.createMomentum(a,this._stopVelocity,this._friction)};
c.createMomentum=function(a,b,d){E.set(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const e=E.length(this._tmpDirection);0<e&&E.scale(this._tmpDirection,this._tmpDirection,1/e);const p=this._time.filteredDelta;return new m(a,b,d,null==p?0:e/p,this._tmpDirection)};return l}();q.PanPlanarMomentum=m;q.PanPlanarMomentumEstimator=y;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports"],
function(q){let t=function(){function E(A){this._gain=A;this.filteredDelta=this.lastValue=void 0}var C=E.prototype;C.update=function(A){if(this.hasLastValue()){const y=this.computeDelta(A);this._updateDelta(y)}this.lastValue=A};C.reset=function(){this.filteredDelta=this.lastValue=void 0};C.hasLastValue=function(){return void 0!==this.lastValue};C.hasFilteredDelta=function(){return void 0!==this.filteredDelta};C.computeDelta=function(A){return void 0===this.lastValue?NaN:A-this.lastValue};C._updateDelta=
function(A){this.filteredDelta=void 0!==this.filteredDelta?(1-this._gain)*this.filteredDelta+this._gain*A:A};return E}();q.FilteredFiniteDifference=t;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(q,t){let E=function(){function C(y,m,l){this._initialVelocity=y;this._stopVelocity=m;this._friction=l;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/
this._stopVelocity)/Math.log(1-this._friction))}var A=C.prototype;A.isFinished=function(y){return y>this.duration};A.value=function(y){return this.valueFromInitialVelocity(this._initialVelocity,y)};A.valueDelta=function(y,m){const l=this.value(y);return this.value(y+m)-l};A.valueFromInitialVelocity=function(y,m){m=Math.min(m,this.duration);const l=1-this.friction;return y*(l**m-1)/Math.log(l)};t._createClass(C,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);
return C}();q.Momentum=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v){E=function(h){function w(k){var g=h.call(this,k)||this;g._animationTime=0;g._momentumFinished=!1;g._rotationMomentumEstimator=new p.RotationMomentumEstimator(.6,.15,.95);g._rotationDirection=1;g._zoomDirection=1;g._zoomMomentumEstimator=new r.ZoomMomentumEstimator;g._zoomOnly=null;g.zoomMomentum=null;g.rotateMomentum=null;g.viewpoint=new C({targetGeometry:new v,scale:0,rotation:0});g.addHandles(y.when(()=>g._momentumFinished,()=>g.navigation.stop()));return g}
q._inheritsLoose(w,h);var u=w.prototype;u.begin=function(k,g){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=g.angle;this._previousRadius=this._startRadius=g.radius;this._previousCenter=g.center;this._updateTimestamp=null;k.constraints.rotationEnabled&&this.addToRotateEstimator(0,g.timestamp);this.addToZoomEstimator(g,1)};u.update=function(k,g){null===this._updateTimestamp&&(this._updateTimestamp=
g.timestamp);const f=g.angle,n=g.radius,z=g.center,x=Math.abs(180*(f-this._startAngle)/Math.PI),B=Math.abs(n-this._startRadius),D=this._startRadius/n;if(this._previousRadius){const F=n/this._previousRadius;let G=180*(f-this._previousAngle)/Math.PI;this._rotationDirection=0<=G?1:-1;this._zoomDirection=1<=F?1:-1;k.constraints.rotationEnabled?(null===this._zoomOnly&&200<g.timestamp-this._updateTimestamp&&(this._zoomOnly=0<B-x),null===this._zoomOnly||this._zoomOnly?G=0:this.addToRotateEstimator(f-this._startAngle,
g.timestamp)):G=0;this.addToZoomEstimator(g,D);this.navigation.setViewpoint([z.x,z.y],1/F,G,[this._previousCenter.x-z.x,z.y-this._previousCenter.y])}this._previousAngle=f;this._previousRadius=n;this._previousCenter=z};u.end=function(k){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(k);this.navigation.end()};u.addToRotateEstimator=
function(k,g){this._rotationMomentumEstimator.add(k,.001*g)};u.addToZoomEstimator=function(k,g){this._zoomMomentumEstimator.add(g,.001*k.timestamp)};u.canZoomIn=function(k){const g=k.scale;k=k.constraints.effectiveMaxScale;return 0===k||g>k};u.canZoomOut=function(k){const g=k.scale;k=k.constraints.effectiveMinScale;return 0===k||g<k};u.onAnimationUpdate=function(k){this.navigation.animationManager.animateContinous(k.viewpoint,(g,f)=>{var n=!this.canZoomIn(k)&&1<this._zoomDirection||!this.canZoomOut(k)&&
1>this._zoomDirection,z=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);n=n||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);f*=.001;this._momentumFinished=z&&n;if(!this._momentumFinished){z=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,f))*this._rotationDirection*180/Math.PI:0;n=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,f)):1;const B=d.create();var x=d.create();if(this._previousCenter){b.set(B,
this._previousCenter.x,this._previousCenter.y);e.getPaddingScreenTranslation(x,k.size,k.padding);b.add(B,B,x);const {constraints:D,scale:F}=k;x=F*n;1>n&&!D.canZoomInTo(x)?(n=F/D.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<n&&!D.canZoomOutTo(x)&&(n=F/D.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);e.scaleAndRotateBy(g,k.viewpoint,n,z,B,k.size);k.constraints.constrainByGeometry(g)}}this._animationTime+=f})};u.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return w}(A);t.__decorate([m.property()],E.prototype,"_momentumFinished",void 0);t.__decorate([m.property()],E.prototype,"viewpoint",void 0);t.__decorate([m.property()],E.prototype,"navigation",void 0);return E=t.__decorate([a.subclass("esri.views.2d.navigation.actions.Pinch")],E)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(q,t,E){E=function(C){function A(y=3,m=.01,l=.95,c=12){return C.call(this,y,m,l,c)||this}t._inheritsLoose(A,C);A.prototype.add=function(y,m){const l=this.value.lastValue;if(null!=l){for(y-=l;y>Math.PI;)y-=2*Math.PI;for(;y<-Math.PI;)y+=2*Math.PI;y=l+y}C.prototype.add.call(this,y,m)};return A}(E.MomentumEstimator);q.RotationMomentumEstimator=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/navigation/MomentumEstimator":function(){define(["exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(q,t,E,C){let A=function(){function y(l=2.5,c=.01,a=.95,b=12){this._minimumInitialVelocity=l;this._stopVelocity=c;this._friction=a;this._maxVelocity=b;this.enabled=!0;this.value=new E.FilteredFiniteDifference(.8);this.time=new E.FilteredFiniteDifference(.3)}var m=y.prototype;m.add=function(l,c){if(this.enabled&&null!=c){if(this.time.hasLastValue()){if(.01>
this.time.computeDelta(c))return;if(this.value.hasFilteredDelta()){const a=this.value.computeDelta(l);0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(c);this.value.update(l)}};m.reset=function(){this.value.reset();this.time.reset()};m.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let l=this.value.filteredDelta/this.time.filteredDelta;l=t.clamp(l,-this._maxVelocity,this._maxVelocity);return Math.abs(l)<this._minimumInitialVelocity?
null:this.createMomentum(l,this._stopVelocity,this._friction)};m.createMomentum=function(l,c,a){return new C.Momentum(l,c,a)};return y}();q.MomentumEstimator=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(q,t,E,C){let A=function(y){function m(c,a,b){return y.call(this,c,a,b)||this}t._inheritsLoose(m,
y);var l=m.prototype;l.value=function(c){c=y.prototype.value.call(this,c);return Math.exp(c)};l.valueDelta=function(c,a){const b=y.prototype.value.call(this,c);c=y.prototype.value.call(this,c+a);return Math.exp(c-b)};return m}(E.Momentum);E=function(y){function m(c=2.5,a=.01,b=.95,d=12){return y.call(this,c,a,b,d)||this}t._inheritsLoose(m,y);var l=m.prototype;l.add=function(c,a){y.prototype.add.call(this,Math.log(c),a)};l.createMomentum=function(c,a,b){return new A(c,a,b)};return m}(C.MomentumEstimator);
q.ZoomMomentum=A;q.ZoomMomentumEstimator=E;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e){const p=b.create(),r=b.create();E=function(v){function h(u){u=v.call(this,u)||this;u._previousCenter=b.create();u.viewpoint=new C({targetGeometry:new e,scale:0,rotation:0});return u}q._inheritsLoose(h,v);var w=h.prototype;w.begin=function(u,k){this.navigation.begin();a.set(this._previousCenter,k.center.x,k.center.y)};w.update=function(u,k){const {state:{size:g,padding:f}}=u;a.set(p,k.center.x,k.center.y);d.getAnchor(r,g,f);u.viewpoint=d.rotateBy(this.viewpoint,
u.state.paddedViewState.viewpoint,d.angleBetween(r,this._previousCenter,p));a.copy(this._previousCenter,p)};w.end=function(){this.navigation.end()};return h}(A);t.__decorate([y.property()],E.prototype,"viewpoint",void 0);t.__decorate([y.property()],E.prototype,"navigation",void 0);return E=t.__decorate([c.subclass("esri.views.2d.actions.Rotate")],E)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/asyncUtils ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/reactiveUtils ../../../core/urlUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d,e,p,r,v,h,w){return function(u){function k(){var f=u.call(this)||this;f._handles=new C;f._resourcePixelRatio=1;f.visible=!1;return f}q._inheritsLoose(k,u);var g=k.prototype;g.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};g._createTransforms=function(){return{dvs:c.create()}};g.doRender=function(f){const n=f.context;if(!this._resourcesTask)this._reloadResources();
else if(f.drawPhase===d.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(f);var z=this._magnifier;if(!y.isNone(z.position)){var x=f.pixelRatio,B=z.size*x,D=Math.ceil(1/z.factor*B);this._readbackTexture.resize(D,D);var {size:F}=f.state;f=x*F[0];F=x*F[1];var G=.5*D,H=.5*D,J=A.clamp(x*z.position.x,G,f-G-1),L=A.clamp(F-x*z.position.y,H,F-H-1);n.setBlendingEnabled(!0);G=J-G;H=L-H;var K=this._readbackTexture;n.bindTexture(K,0);n.gl.copyTexImage2D(K.descriptor.target,0,K.descriptor.pixelFormat,
G,H,D,D,0);D=(D=this.background?.color)?[D.a*D.r/255,D.a*D.g/255,D.a*D.b/255,D.a]:[1,1,1,1];J=-1+(J+z.offset.x*x)/f*2;x=-1+(L-z.offset.y*x)/F*2;f=B/f*2;B=B/F*2;F=this._program;n.bindVAO(this._vertexArrayObject);n.bindTexture(this._overlayTexture,6);n.bindTexture(this._maskTexture,7);n.useProgram(F);F.setUniform4fv("u_background",D);F.setUniform1i("u_readbackTexture",0);F.setUniform1i("u_overlayTexture",6);F.setUniform1i("u_maskTexture",7);F.setUniform4f("u_drawPos",J,x,f,B);F.setUniform1i("u_maskEnabled",
z.maskEnabled?1:0);F.setUniform1i("u_overlayEnabled",z.overlayEnabled?1:0);n.setStencilTestEnabled(!1);n.setColorMask(!0,!0,!0,!0);n.drawArrays(v.PrimitiveType.TRIANGLE_STRIP,0,4);n.bindVAO()}}};g._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};g._reloadResources=function(){var f=this;this._resourcesTask&&this._resourcesTask.abort();const n=y.isSome(this._magnifier)?this._magnifier.maskUrl:null,z=y.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=
E.createTask(function(){var x=q._asyncToGenerator(function*(B){const D=y.isNone(n)||y.isNone(z)?p.loadMagnifierResources(B):null,F=y.isSome(n)?t(n,{responseType:"image",signal:B}).then(J=>J.data):D.then(J=>J.mask);B=y.isSome(z)?t(z,{responseType:"image",signal:B}).then(J=>J.data):D.then(J=>J.overlay);const [G,H]=yield Promise.all([F,B]);f.mask=G;f.overlay=H;f._disposeRenderResources();f.requestRender()});return function(B){return x.apply(this,arguments)}}())};g._disposeRenderResources=function(){this._readbackTexture=
y.disposeMaybe(this._readbackTexture);this._overlayTexture=y.disposeMaybe(this._overlayTexture);this._maskTexture=y.disposeMaybe(this._maskTexture);this._vertexArrayObject=y.disposeMaybe(this._vertexArrayObject);this._program=y.disposeMaybe(this._program)};g._updateResources=function(f){f.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var n=f.context;this._resourcePixelRatio=f.pixelRatio;var z=Math.ceil(this._magnifier.size*f.pixelRatio);this._program=
e.createMagnifierProgram(n);var x=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new w.VertexArrayObject(n,e.magnifierProgramTemplate.attributes,b.Pos2us,{geometry:r.BufferObject.createVertex(n,v.Usage.STATIC_DRAW,x)});this.overlay.width=z;this.overlay.height=z;this._overlayTexture=new h.Texture(n,{target:v.TextureType.TEXTURE_2D,pixelFormat:v.PixelFormat.RGBA,internalFormat:v.PixelFormat.RGBA,dataType:v.PixelType.UNSIGNED_BYTE,wrapMode:v.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:v.TextureSamplingMode.NEAREST,
flipped:!0,preMultiplyAlpha:l.isSVG(this.overlay.src)&&f.context.driverTest.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);this.mask.width=z;this.mask.height=z;this._maskTexture=new h.Texture(n,{target:v.TextureType.TEXTURE_2D,pixelFormat:v.PixelFormat.ALPHA,internalFormat:v.PixelFormat.ALPHA,dataType:v.PixelType.UNSIGNED_BYTE,wrapMode:v.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:v.TextureSamplingMode.NEAREST,flipped:!0},this.mask);f=1/this._magnifier.factor;this._readbackTexture=new h.Texture(n,
{target:v.TextureType.TEXTURE_2D,pixelFormat:v.PixelFormat.RGBA,internalFormat:v.PixelFormat.RGBA,dataType:v.PixelType.UNSIGNED_BYTE,wrapMode:v.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:v.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(f*z),height:Math.ceil(f*z)})}};q._createClass(k,[{key:"background",get:function(){return this._background},set:function(f){this._background=f;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(f){this._magnifier=f;this._handles.removeAll();
this._handles.add([m.watch(()=>f.version,()=>{this.visible=f.visible&&y.isSome(f.position)&&0<f.size;this.requestRender()},m.initial),m.watch(()=>[f.maskUrl,f.overlayUrl],()=>this._reloadResources()),m.watch(()=>f.size,()=>{this._disposeRenderResources();this.requestRender()})])}}]);return k}(a.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],function(q,t,E){const C={shaders:{vertexShader:t.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:t.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};q.createMagnifierProgram=function(A){return E.createProgram(A,C)};q.magnifierProgramTemplate=C;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../support/requestImageUtils"],function(q,t,E,C,A){function y(){y=E._asyncToGenerator(function*(l){var c=
new Promise((b,d)=>q(["./mask-svg"],e=>b(m(e)),d)),a=new Promise((b,d)=>q(["./overlay-svg"],e=>b(m(e)),d));c=A.requestImage((yield c).default,{signal:l});a=A.requestImage((yield a).default,{signal:l});a={mask:yield c,overlay:yield a};C.throwIfAborted(l);return a});return y.apply(this,arguments)}const m=l=>Object.freeze(Object.defineProperty({__proto__:null,default:l},Symbol.toStringTag,{value:"Module"}));t.loadMagnifierResources=function(l){return y.apply(this,arguments)};Object.defineProperties(t,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(q,t,E){function C(){C=t._asyncToGenerator(function*(A,y){({data:A}=yield E(A,{responseType:"image",...y}));return A});return C.apply(this,arguments)}q.requestImage=function(A,y){return C.apply(this,arguments)};Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports",
"../../../chunks/mat4"],function(q,t){q.mat4=t.mat4;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(q,t){q.mat4f32=t.mat4f32;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(q,t){q.vec3f32=t.vec3f32;Object.defineProperties(q,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(q,t){q.vec4f32=t.vec4f32;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/context-util ../../webgl/enums ../../webgl/Texture".split(" "),
function(q,t,E,C,A,y,m,l,c,a,b,d){function e(v){return v&&"render"in v}function p(v){const h=document.createElement("canvas");h.width=v.width;h.height=v.height;v.render(h.getContext("2d"));return h}function r(v){return e(v)?v instanceof c?E.applySome(v.getRenderedRasterPixels(),h=>h.renderedRasterPixels):p(v):v}l=function(v){function h(u=null,k){var g=v.call(this)||this;g.blendFunction="standard";g._sourceWidth=0;g._sourceHeight=0;g._textureInvalidated=!1;g.stencilRef=0;g.coordScale=[1,1];g._height=
void 0;g.pixelRatio=1;g.resolution=0;g.rotation=0;g._source=null;g._width=void 0;g.x=0;g.y=0;g.immutable=k.immutable??!1;g.requestRenderOnSourceChangedEnabled=k.requestRenderOnSourceChangedEnabled??!0;g.source=u;g.requestRender=g.requestRender.bind(t._assertThisInitialized(g));return g}t._inheritsLoose(h,v);var w=h.prototype;w.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null);E.isSome(this._uploadStatus)&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)};
w.beforeRender=function(u){v.prototype.beforeRender.call(this,u);this.updateTexture(u)};w.setSourceAsync=function(){var u=t._asyncToGenerator(function*(k,g){E.isSome(this._uploadStatus)&&this._uploadStatus.controller.abort();const f=new AbortController,n=C.createResolver();C.onAbortOrThrow(g,()=>f.abort());C.onAbortOrThrow(f,z=>n.reject(z));this._uploadStatus={controller:f,resolver:n};this.source=k;return n.promise});return function(k,g){return u.apply(this,arguments)}}();w.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};w.updateTransitionProperties=function(u,k){64<=u&&(this.inFadeTransition=this.fadeTransitionEnabled=!1);v.prototype.updateTransitionProperties.call(this,u,k)};w.setTransform=function(u){const k=A.identity(this.transforms.dvs),[g,f]=u.toScreenNoRotation([0,0],[this.x,this.y]);var n=this.resolution/this.pixelRatio/u.resolution;const z=n*this.width;n*=this.height;const x=Math.PI*this.rotation/180;A.translate(k,
k,m.fromValues(g,f));A.translate(k,k,m.fromValues(z/2,n/2));A.rotate(k,k,-x);A.translate(k,k,m.fromValues(-z/2,-n/2));A.scaleByVec2(k,k,m.fromValues(z,n));A.multiply(this.transforms.dvs,u.displayViewMat3,k)};w.setSamplingProfile=function(u){this._texture&&(u.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(u.samplingMode))};w.bind=function(u,k){this._texture&&u.bindTexture(this._texture,k)};w.updateTexture=function(){var u=t._asyncToGenerator(function*({context:k,
painter:g}){if(this._textureInvalidated)if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(k)),this.source){this._texture.resize(this._sourceWidth,this._sourceHeight);k=r(this.source);try{if(E.isSome(this._uploadStatus)){const {controller:f,resolver:n}=this._uploadStatus,z={signal:f.signal},{width:x,height:B}=this;yield g.textureUploadManager.enqueueTextureUpdate({data:k,texture:this._texture,width:x,height:B},z);n.resolve();this._uploadStatus=null}else this._texture.setData(k);
this.ready()}catch(f){C.throwIfNotAbortError(f)}}else this._texture.setData(null)});return function(k){return u.apply(this,arguments)}}();w.onDetach=function(){this.destroy()};w._createTransforms=function(){return{dvs:y.create()}};w._createTexture=function(u){const k=this.immutable&&u.type===a.ContextType.WEBGL2;return new d.Texture(u,{target:b.TextureType.TEXTURE_2D,pixelFormat:b.PixelFormat.RGBA,internalFormat:k?b.SizedPixelFormat.RGBA8:b.PixelFormat.RGBA,dataType:b.PixelType.UNSIGNED_BYTE,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE,
isImmutable:k,width:this._sourceWidth,height:this._sourceHeight})};t._createClass(h,[{key:"isSourceScaled",get:function(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this._sourceHeight},set:function(u){this._height=u}},{key:"source",get:function(){return this._source},set:function(u){if(null!=u||null!=this._source)this._source=u,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,
this._sourceWidth=this._source.naturalWidth):(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width),this.invalidateTexture()}},{key:"width",get:function(){return void 0!==this._width?this._width:this._sourceWidth},set:function(u){this._width=u}}]);return h}(l.DisplayObject);q.Bitmap=l;q.isImageSource=e;q.rasterize=p;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../core/maybe"],function(q,t){return function(){function E(A,y,m){this.pixelBlock=A;this.extent=y;this.originalPixelBlock=m}var C=E.prototype;C.render=function(A){var y=this.pixelBlock;if(!t.isNone(y)){var m=this.filter({pixelBlock:y});t.isNone(m.pixelBlock)||(y=m.pixelBlock.getAsRGBA(),m=A.createImageData(m.pixelBlock.width,m.pixelBlock.height),m.data.set(y),A.putImageData(m,0,0))}};C.getRenderedRasterPixels=function(){const A=this.filter({pixelBlock:this.pixelBlock});return t.isNone(A.pixelBlock)?
null:{width:A.pixelBlock.width,height:A.pixelBlock.height,renderedRasterPixels:new Uint8Array(A.pixelBlock.getAsRGBA().buffer)}};q._createClass(E,[{key:"width",get:function(){return t.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return t.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return E}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],
function(q,t,E,C,A){A=function(y){function m(){var c=y.apply(this,arguments)||this;c._hasCrossfade=!1;return c}t._inheritsLoose(m,y);var l=m.prototype;l.beforeRender=function(c){y.prototype.beforeRender.call(this,c);this._manageFade()};l.prepareRenderPasses=function(c){const a=c.registerRenderPass({name:"bitmap",brushes:[E.brushes.bitmap],target:()=>this.children,drawPhase:C.WGLDrawPhase.MAP});return[...y.prototype.prepareRenderPasses.call(this,c),a]};l._manageFade=function(){2<=this.children.reduce((c,
a)=>c+(a.inFadeTransition?1:0),0)?(this.children.forEach(c=>c.blendFunction="additive"),this._hasCrossfade=!0):(this.children.forEach(c=>c.blendFunction="standard"),this._hasCrossfade=!1)};t._createClass(m,[{key:"requiresDedicatedFBO",get:function(){return this._hasCrossfade}}]);return m}(A);q.BitmapContainer=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(q,t,E,C,A){A=function(y){function m(c,a,b,d,e,p,r=null){var v=y.call(this,c,a,b,d,e,p)||this;v.bitmap=new C.Bitmap(r,{immutable:!1,requestRenderOnSourceChangedEnabled:!1});v.bitmap.coordScale=[e,p];v.bitmap.once("isReady",()=>v.ready());return v}t._inheritsLoose(m,y);var l=m.prototype;l.destroy=function(){y.prototype.destroy.call(this);this.bitmap.destroy()};l.beforeRender=function(c){y.prototype.beforeRender.call(this,c);
this.bitmap.beforeRender(c)};l.afterRender=function(c){y.prototype.afterRender.call(this,c);this.bitmap.afterRender(c)};l._createTransforms=function(){return{dvs:E.create(),tileMat3:E.create()}};l.setTransform=function(c){y.prototype.setTransform.call(this,c);this.bitmap.transforms.dvs=this.transforms.dvs};l.onAttach=function(){this.bitmap.stage=this.stage};l.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};t._createClass(m,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},
set:function(c){this.bitmap.stencilRef=c}}]);return m}(A.TiledDisplayObject);q.BitmapTile=A;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),function(q,t,E,C,A,y,m){m=function(l){function c(){return l.apply(this,arguments)||this}t._inheritsLoose(c,
l);var a=c.prototype;a.createTile=function(b){const d=this._tileInfoView.getTileBounds(E.create(),b),e=this._tileInfoView.getTileResolution(b.level),[p,r]=this._tileInfoView.tileInfo.size;return new C.BitmapTile(b,e,d[0],d[3],p,r)};a.prepareRenderPasses=function(b){const d=b.registerRenderPass({name:"bitmap (tile)",brushes:[A.brushes.bitmap],target:()=>this.children.map(e=>e.bitmap),drawPhase:y.WGLDrawPhase.MAP});return[...l.prototype.prepareRenderPasses.call(this,b),d]};a.doRender=function(b){this.visible&&
b.drawPhase===y.WGLDrawPhase.MAP&&l.prototype.doRender.call(this,b)};t._createClass(c,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(b=>"additive"===b.bitmap.blendFunction)}}]);return c}(m);q.BitmapTileContainer=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(q,t,E,C,A,y,m){q.Stage=t.Stage;q.LabelManager=E;q.GraphicsView2D=C;q.GraphicContainer=A;q.MapViewNavigation=y;q.MagnifierView2D=m;Object.defineProperties(q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});