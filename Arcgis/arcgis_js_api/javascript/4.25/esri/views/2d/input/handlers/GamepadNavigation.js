// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Handles ../../../../core/reactiveUtils ../../../../core/scheduling ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadAndKeyboardUtils".split(" "),function(l,p,q,m,r,n,g,h){g=function(e){function k(b){var a=e.call(this,!0)||this;a._view=b;a._frameTask=null;a._watchHandles=new q;a._currentDevice=null;a._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0};a._handle=a.registerIncoming("gamepad",
c=>a._handleGamePadEvent(c));a._handle.pause();return a}p._inheritsLoose(k,e);var f=k.prototype;f.onInstall=function(b){e.prototype.onInstall.call(this,b);this._watchHandles.add([m.watch(()=>this._view.navigation.gamepad?.enabled,a=>{a?(this._handle.resume(),this._frameTask||(this._frameTask=r.addFrameTask({update:c=>this._frameUpdate(c.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},m.initial)])};f.onUninstall=function(){this._watchHandles.removeAll();
this._frameTask&&(this._frameTask.remove(),this._frameTask=null);e.prototype.onUninstall.call(this)};f._handleGamePadEvent=function(b){const a=this._view.navigation.gamepad.device;a&&b.data.device!==a||this._currentDevice&&this._currentDevice!==b.data.device||("end"===b.data.action?(this._currentDevice=null,h.resetTransformation(this._transformation)):(this._currentDevice=b.data.device,h.extractTransformation(b.data,this._view.navigation.gamepad,this._transformation)))};f._frameUpdate=function(b){const a=
this._transformation;if(!h.isZeroTransformation(a)){var c=this._view.viewpoint.clone(),d=.7*this._view.navigation.gamepad.velocityFactor*b;n.translateBy(c,c,[a.translation[0]*d,-a.translation[1]*d]);d=this._view.size;n.scaleAndRotateBy(c,c,1+6E-4*a.translation[2]*b,this._view.constraints.rotationEnabled?.06*-a.heading*b:0,[d[0]/2,d[1]],d);b=this._view.constraints.constrain(c,this._view.viewpoint);this._view.viewpoint=b}};return k}(g.InputHandler);l.GamepadNavigation=g;Object.defineProperties(l,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})});