// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/clock ../../../core/MapUtils ../../../core/maybe ../../../core/screenUtils ../DragEventSeparator ../InputHandler ./SingleAndDoubleClick ./support".split(" "),function(r,t,w,x,u,l,y,p,m,q){p=function(v){function n(a=m.DefaultParameters.maximumDoubleClickDelay,b=m.DefaultParameters.maximumDoubleClickDistance,e=m.DefaultParameters.maximumDoubleTouchDelay,c=m.DefaultParameters.maximumDoubleTouchDistance,h=w.clock){var d=v.call(this,
!1)||this;d._maximumDoubleClickDelay=a;d._maximumDoubleClickDistance=b;d._maximumDoubleTouchDelay=e;d._maximumDoubleTouchDistance=c;d._clock=h;d._doubleTapDragReady=!1;d._doubleTapDragActive=!1;d._dragStartCenter=l.createScreenPoint(0,0);d._pointerState=new Map;d._doubleTapDrag=d.registerOutgoing("double-tap-drag");d._dragEventSeparator=new y.DragEventSeparator({start:(f,k)=>d._dragStart(f,k),update:(f,k)=>d._dragUpdate(k),end:(f,k)=>d._dragEnd(k)});d.registerIncoming("drag",f=>d._dragEventSeparator.handle(f));
d.registerIncoming("pointer-down",f=>d._handlePointerDown(f));d.registerIncoming("pointer-up",()=>d._handlePointerUp());return d}t._inheritsLoose(n,v);var g=n.prototype;g.onUninstall=function(){this._pointerState.forEach(a=>{a.doubleTapTimeout=u.removeMaybe(a.doubleTapTimeout)})};g._clearPointerDown=function(a){const b=this._pointerState.get(a);b&&(b.doubleTapTimeout=u.removeMaybe(b.doubleTapTimeout),this._pointerState.delete(a),this.refreshHasPendingInputs())};g._createDoubleTapDragData=function(a,
b,e){const {button:c,buttons:h,pointer:d,pointers:f,pointerType:k,timestamp:z}=e;return{action:a,delta:b,button:c,buttons:h,pointer:d,pointers:f,pointerType:k,timestamp:z}};g._dragStart=function(a,b){if(this._doubleTapDragReady&&1===a){this._doubleTapDragReady=!1;this._doubleTapDragActive=!0;var {data:e,modifiers:c}=b;({center:a}=e);this._dragStartCenter=a;a=this._createDoubleTapDragData("begin",l.createScreenPoint(0,0),e);this._doubleTapDrag.emit(a,void 0,c);b.stopPropagation()}};g._dragUpdate=function(a){if(this._doubleTapDragActive){var {data:b,
modifiers:e}=a,{center:c}=b;c=l.createScreenPoint(c.x-this._dragStartCenter.x,c.y-this._dragStartCenter.y);c=this._createDoubleTapDragData("update",c,b);this._doubleTapDrag.emit(c,void 0,e);a.stopPropagation()}};g._dragEnd=function(a){if(this._doubleTapDragActive){var {data:b,modifiers:e}=a,{center:c}=b;c=l.createScreenPoint(c.x-this._dragStartCenter.x,c.y-this._dragStartCenter.y);c=this._createDoubleTapDragData("end",c,b);this._doubleTapDrag.emit(c,void 0,e);this._doubleTapDragActive=!1;a.stopPropagation()}};
g._handlePointerDown=function(a){const {data:b}=a,e=q.getPointerId(b),c=this._pointerState.get(e);var {pointerType:h}=b.native;c?(h="touch"===h?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance,this._clearPointerDown(e),q.manhattanDistance(c.event.data,b)>h?this._storePointerDown(a):this._doubleTapDragReady=!0):this._storePointerDown(a)};g._handlePointerUp=function(){this._doubleTapDragReady=!1};g._storePointerDown=function(a){var {data:b}=a;const {pointerType:e}=b.native,c=q.getPointerId(b);
b=this._clock.setTimeout(()=>this._clearPointerDown(c),"touch"===e?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay);this._pointerState.set(c,{event:a,doubleTapTimeout:b});this.refreshHasPendingInputs()};t._createClass(n,[{key:"hasPendingInputs",get:function(){return x.someMap(this._pointerState,a=>null!=a.doubleTapTimeout)}}]);return n}(p.InputHandler);r.DoubleTapDrag=p;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});