// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Error ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/commonProperties ../../layers/support/rasterFunctions/rasterProjectionHelper ./support/popupUtils".split(" "),function(q,g,A,w,m,h,F,G,B,C,r,D){return e=>{e=function(x){function n(){var b=x.apply(this,arguments)||
this;b._rasterFieldPrefix="Raster.";b.layer=null;b.view=null;b.tileInfo=null;return b}q._inheritsLoose(n,x);var p=n.prototype;p._getfullExtent=function(){return this.projectFullExtent(this.view.spatialReference)};p.supportsSpatialReference=function(b){return!!this.projectFullExtent(b)};p.projectFullExtent=function(b){const c=m.unwrap(this.layer.fullExtent),a=r.getDefaultDatumTransformationForDataset(c,b,!1);return r.projectExtent(c,b,a)};p.fetchPopupFeatures=function(){var b=q._asyncToGenerator(function*(c,
a){const {layer:f}=this;if(!c)throw new w("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:f});var {popupEnabled:k}=f;a=D.getFetchPopupTemplate(f,a);if(!k||m.isNone(a))throw new w("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:k,popupTemplate:a});k=[];const {value:l,magdirValue:y}=yield f.identify(c,{timeExtent:this.timeExtent});let t="";if(l&&l.length){t="imagery-tile"===f.type&&f.hasStandardTime()&&null!=l[0]?
l.map(u=>f.getStandardTimeValue(u)).join(", "):l.join(", ");c={ObjectId:0};c["Raster.ServicePixelValue"]=t;a=f.rasterInfo.attributeTable;if(m.isSome(a)){const {fields:u,features:E}=a,z=u.find(({name:v})=>"value"===v.toLowerCase());if(a=z?E.find(v=>String(v.attributes[z.name])===t):null)for(var d in a.attributes)a.attributes.hasOwnProperty(d)&&(c[this._rasterFieldPrefix+d]=a.attributes[d])}d=f.rasterInfo.dataType;if("vector-magdir"===d||"vector-uv"===d)c["Raster.Magnitude"]=y?.[0],c["Raster.Direction"]=
y?.[1];d=new A(this.fullExtent.clone(),null,c);d.layer=f;d.sourceLayer=d.layer;k.push(d)}return k});return function(c,a){return b.apply(this,arguments)}}();q._createClass(n,[{key:"fullExtent",get:function(){return this._getfullExtent()}},{key:"hasTilingEffects",get:function(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}},{key:"datumTransformation",get:function(){return r.getDefaultDatumTransformationForDataset(m.unwrap(this.layer.fullExtent),
this.view.spatialReference,!0)}}]);return n}(e);g.__decorate([h.property()],e.prototype,"layer",void 0);g.__decorate([h.property(C.combinedViewLayerTimeExtentProperty)],e.prototype,"timeExtent",void 0);g.__decorate([h.property()],e.prototype,"view",void 0);g.__decorate([h.property()],e.prototype,"fullExtent",null);g.__decorate([h.property()],e.prototype,"tileInfo",void 0);g.__decorate([h.property({readOnly:!0})],e.prototype,"hasTilingEffects",null);return e=g.__decorate([B.subclass("esri.views.layers.ImageryTileLayerView")],
e)}});