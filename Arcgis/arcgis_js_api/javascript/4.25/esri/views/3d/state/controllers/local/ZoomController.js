// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../core/Logger ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/Error ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec2 ../../../../../chunks/vec2f64 ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ../../../../../geometry/support/plane ../../../camera/constraintUtils ../../../camera/constraintUtils/ConstraintTypes ../../../camera/constraintUtils/InteractionType ../../../camera/constraintUtils/TiltMode ../InteractiveController ../../utils/navigationUtils ../../../webgl-engine/lib/verticalOffsetUtils".split(" "),
function(k,p,w,x,y,z,H,I,J,K,L,A,m,q,b,e,r,t,B,C,D,E,f,F){k.ZoomController=function(u){function l(){var a=u.apply(this,arguments)||this;a._tmpP=e.create();a._tmpDir=e.create();a._tmpN=e.create();a._tmpP0=q.create();a._tmpPoi=e.create();a._tmpRayDir=e.create();a.dragBeginPoint=z.createScreenPointArray();a._normalizedAnchorPoint=q.create();a._constraintOptions={selection:B.ConstraintTypes.ALL,interactionType:C.InteractionType.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:e.create(),
tiltMode:D.TiltMode.TUMBLE};a._plane=r.create();return a}p._inheritsLoose(l,u);var n=l.prototype;n.begin=function(a){if(this.active){m.copy(this.dragBeginPoint,a);f.normalizeCoordinate(this.startCamera,a,this._normalizedAnchorPoint);var d=this._intersectionHelper.intersectScreenFreePointFallback(a,this._tmpP,0===this.view.map.ground.opacity?G:{});b.subtract(this._tmpDir,this._tmpP,this.startCamera.eye);var g=b.length(this._tmpDir);b.normalize(this._tmpDir,this._tmpDir);var c;this.view.camera.position.hasZ&&
(c=Math.abs(this.view.camera.position.z));c=x.clamp(f.PIVOT_DISTANCE_MODIFIER*c,f.DISTANCE_CLAMP_VALUES[0],f.DISTANCE_CLAMP_VALUES[1]);a=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,a[0],a[1],this.view.state.camera,f.SCREEN_PIXEL_AREA);c=y.isSome(a)?Math.min(c,a):c;c=d?Math.min(c,g):c;b.scale(this._tmpDir,this._tmpDir,c);b.add(this._tmpP,this.startCamera.eye,this._tmpDir);b.subtract(this._tmpN,this.startCamera.eye,this.startCamera.center);b.normalize(this._tmpN,this._tmpN);
0>this._tmpN[1]&&b.negate(this._tmpN,this._tmpN);r.fromPositionAndNormal(this._tmpP,this._tmpN,this._plane);this._constraintOptions.interactionStartCamera=this.startCamera}};n.update=function(a){if(this.active){f.intersectPlaneFromScreenPoint(this._plane,this.currentCamera,this.dragBeginPoint,this._tmpPoi)||b.copy(this._tmpPoi,this.currentCamera.center);f.normalizeCoordinate(this.currentCamera,a,this._tmpP0);var d=4*(this._tmpP0[1]-this._normalizedAnchorPoint[1]);m.copy(this._normalizedAnchorPoint,
this._tmpP0);b.subtract(this._tmpRayDir,this._tmpPoi,this.currentCamera.eye);var g=b.length(this._tmpRayDir),c=g*(1-d);b.copy(this._constraintOptions.interactionDirection,this._tmpRayDir);b.scale(this._constraintOptions.interactionDirection,this._constraintOptions.interactionDirection,Math.sign(d)/g);var v=this.view.state.constraints.minimumPoiDistance;0<=d&&c<v&&(c=v,d=-(c-g)/g);1E-6>Math.abs(g-c)||(b.scale(this._tmpRayDir,this._tmpRayDir,d),this.currentCamera.eye=b.add(h,this.currentCamera.eye,
this._tmpRayDir),b.lerp(h,this.currentCamera.center,this._tmpPoi,d),h[2]=this._tmpPoi[2]>this.startCamera.center[2]?Math.max(this.startCamera.center[2],h[2]):Math.min(this.startCamera.center[2],h[2]),this.currentCamera.center=h,this._constraintOptions.interactionFactor=t.pixelDistanceToInteractionFactor(m.distance(this.dragBeginPoint,a)),t.applyAll(this.view,this.currentCamera,this._constraintOptions),this.commitCamera())}};n.end=function(){this.active&&this.finishController()};p._createClass(l,[{key:"_intersectionHelper",
get:function(){return this.view.sceneIntersectionHelper}}]);return l}(E.InteractiveController);k.ZoomController=w.__decorate([A.subclass("esri.views.3d.state.controllers.local.ZoomController")],k.ZoomController);const h=e.create(),G={exclude:new Set([F.TERRAIN_ID])};Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});