// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports"],function(ha){function M(a,b,d,f,e,c){if(!(1E-6>b[0]*b[0]+b[1]*b[1]+b[2]*b[2]))for(z(ia,d,b),z(ja,f,b),z(ka,e,b),Q(a,b,l),R[1]=l[0],S[1]=l[1],Z[1]=S[1]-R[1],d=[d,f,e],f=[ia,ja,ka],e=0;3>e;++e){Q(a,d[e],l);R[0]=l[0];S[0]=l[1];Q(a,f[e],l);R[2]=l[0];S[2]=l[1];Z[0]=S[0]-R[0];Z[2]=S[2]-R[2];const m=da(Z);m<c.quality&&(u(c.b0,d[e]),u(c.b1,b),u(c.b2,f[e]),c.quality=m)}}function Q(a,b,d){const {data:f,size:e}=a;d[0]=Number.POSITIVE_INFINITY;d[1]=Number.NEGATIVE_INFINITY;for(a=0;a<f.length;a+=
e){const c=f[a]*b[0]+f[a+1]*b[1]+f[a+2]*b[2];d[0]=Math.min(d[0],c);d[1]=Math.max(d[1],c)}}function la(a,b,d){u(d.center,a);N(d.halfSize,b,.5);d.quaternion[0]=0;d.quaternion[1]=0;d.quaternion[2]=0;d.quaternion[3]=1}function ma(a,b,d,f,e,c){Q(a,b,l);e[0]=l[0];c[0]=l[1];Q(a,d,l);e[1]=l[0];c[1]=l[1];Q(a,f,l);e[2]=l[0];c[2]=l[1]}function na(a,b,d,f,e,c,m){G[0]=a[0];G[1]=a[1];G[2]=a[2];G[3]=b[0];G[4]=b[1];G[5]=b[2];G[6]=d[0];G[7]=d[1];G[8]=d[2];var k=m.quaternion,g=G,h=g[0]+g[4]+g[8];if(0<h)h=Math.sqrt(h+
1),k[3]=.5*h,h=.5/h,k[0]=(g[5]-g[7])*h,k[1]=(g[6]-g[2])*h,k[2]=(g[1]-g[3])*h;else{h=0;g[4]>g[0]&&(h=1);g[8]>g[3*h+h]&&(h=2);const x=(h+1)%3,p=(h+2)%3;let r=Math.sqrt(g[3*h+h]-g[3*x+x]-g[3*p+p]+1);k[h]=.5*r;r=.5/r;k[3]=(g[3*x+p]-g[3*p+x])*r;k[x]=(g[3*x+h]+g[3*h+x])*r;k[p]=(g[3*p+h]+g[3*h+p])*r}aa(T,f,e);N(T,T,.5);N(m.center,a,T[0]);N(ba,b,T[1]);aa(m.center,m.center,ba);N(ba,d,T[2]);aa(m.center,m.center,ba);N(m.halfSize,c,.5)}function da(a){return a[0]*a[1]+a[0]*a[2]+a[1]*a[2]}function aa(a,b,d){a[0]=
b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2]}function A(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2]}function N(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d}function u(a,b,d=0){a[0]=b[d+0];a[1]=b[d+1];a[2]=b[d+2]}function z(a,b,d){const f=b[0],e=b[1];b=b[2];const c=d[0],m=d[1];d=d[2];a[0]=e*d-b*m;a[1]=b*c-f*d;a[2]=f*m-e*c}function n(a,b){var d=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];0<d&&(d=1/Math.sqrt(d),a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d)}function ea(a,b){const d=b[0]-a[0],f=b[1]-a[1];a=b[2]-a[2];return d*
d+f*f+a*a}const X=[0,0,0],ca=[0,0,0],O=[0,0,0],H=[0,0,0],B=[0,0,0],C=[0,0,0],D=[0,0,0],I=[0,0,0],J=[0,0,0],K=[0,0,0],E=[0,0,0],l=[0,0],ia=[0,0,0],ja=[0,0,0],ka=[0,0,0],S=[0,0,0],R=[0,0,0],Z=[0,0,0],fa=[0,0,0],v=[0,0,0],U=[0,0,0],Y=[0,0,0],V=[0,0,0],W=[0,0,0],oa=[0,0,0],ba=[0,0,0],G=[1,0,0,0,1,0,0,0,1],T=[0,0,0];let qa=function(a){this.minVert=Array(7);this.maxVert=Array(7);this.buffer=new ArrayBuffer(448);var b=0;this.minProj=new Float64Array(this.buffer,b,7);b+=56;this.maxProj=new Float64Array(this.buffer,
b,7);b+=56;for(var d=0;7>d;++d)this.minVert[d]=new Float64Array(this.buffer,b,3),b+=24;for(d=0;7>d;++d)this.maxVert[d]=new Float64Array(this.buffer,b,3),b+=24;for(b=0;7>b;++b)this.minProj[b]=Number.POSITIVE_INFINITY,this.maxProj[b]=Number.NEGATIVE_INFINITY;b=Array(7);d=Array(7);const {data:f,size:e}=a;for(a=0;a<f.length;a+=e){var c=f[a];c<this.minProj[0]&&(this.minProj[0]=c,b[0]=a);c>this.maxProj[0]&&(this.maxProj[0]=c,d[0]=a);c=f[a+1];c<this.minProj[1]&&(this.minProj[1]=c,b[1]=a);c>this.maxProj[1]&&
(this.maxProj[1]=c,d[1]=a);c=f[a+2];c<this.minProj[2]&&(this.minProj[2]=c,b[2]=a);c>this.maxProj[2]&&(this.maxProj[2]=c,d[2]=a);c=f[a]+f[a+1]+f[a+2];c<this.minProj[3]&&(this.minProj[3]=c,b[3]=a);c>this.maxProj[3]&&(this.maxProj[3]=c,d[3]=a);c=f[a]+f[a+1]-f[a+2];c<this.minProj[4]&&(this.minProj[4]=c,b[4]=a);c>this.maxProj[4]&&(this.maxProj[4]=c,d[4]=a);c=f[a]-f[a+1]+f[a+2];c<this.minProj[5]&&(this.minProj[5]=c,b[5]=a);c>this.maxProj[5]&&(this.maxProj[5]=c,d[5]=a);c=f[a]-f[a+1]-f[a+2];c<this.minProj[6]&&
(this.minProj[6]=c,b[6]=a);c>this.maxProj[6]&&(this.maxProj[6]=c,d[6]=a)}for(a=0;7>a;++a)c=b[a],u(this.minVert[a],f,c),c=d[a],u(this.maxVert[a],f,c)},ra=function(){this.b0=[1,0,0];this.b1=[0,1,0];this.b2=[0,0,1];this.quality=0};ha.computeOBB=function(a,b){const {data:d,size:f}=a;var e=d.length/f;if(!(0>=e)){var c=new qa(a);aa(X,c.minProj,c.maxProj);N(X,X,.5);A(ca,c.maxProj,c.minProj);var m=da(ca),k=new ra;k.quality=m;14>e&&(a={data:new Float64Array(c.buffer,112,42),size:3});var g=[0,0,0],h=[0,0,0],
x=[0,0,0];e=[0,0,0];var p=[0,0,0],r=[0,0,0],q=[0,0,0];var w=a;var y=ea(c.maxVert[0],c.minVert[0]),t=0;for(var F=1;7>F;++F){const L=ea(c.maxVert[F],c.minVert[F]);L>y&&(y=L,t=F)}u(g,c.minVert[t]);u(h,c.maxVert[t]);if(1E-6>ea(g,h))w=1;else{A(e,g,h);n(e,e);const {data:L,size:sa}=w;c=Number.NEGATIVE_INFINITY;y=0;for(t=0;t<L.length;t+=sa)E[0]=L[t]-g[0],E[1]=L[t+1]-g[1],E[2]=L[t+2]-g[2],F=e[0]*E[0]+e[1]*E[1]+e[2]*E[2],F=E[0]*E[0]+E[1]*E[1]+E[2]*E[2]-F*F/(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),F>c&&(c=F,y=t);u(x,
L,y);1E-6>c?w=2:(A(p,h,x),n(p,p),A(r,x,g),n(r,r),z(q,p,e),n(q,q),M(w,q,e,p,r,k),w=0)}switch(w){case 1:la(X,ca,b);return;case 2:m=a;u(v,e);Math.abs(e[0])>Math.abs(e[1])&&Math.abs(e[0])>Math.abs(e[2])?v[0]=0:Math.abs(e[1])>Math.abs(e[2])?v[1]=0:v[2]=0;1E-6>v[0]*v[0]+v[1]*v[1]+v[2]*v[2]&&(v[0]=v[1]=v[2]=1);z(U,e,v);n(U,U);z(Y,e,U);n(Y,Y);ma(m,e,U,Y,V,W);A(oa,W,V);na(e,U,Y,V,W,oa,b);return}w=a;c=l;const {data:P,size:pa}=w;u(H,P);u(O,H);c[0]=fa[0]*q[0]+fa[1]*q[1]+fa[2]*q[2];c[1]=c[0];for(y=pa;y<P.length;y+=
pa)t=P[y]*q[0]+P[y+1]*q[1]+P[y+2]*q[2],t<c[0]&&(c[0]=t,u(H,P,y)),t>c[1]&&(c[1]=t,u(O,P,y));q=g[0]*q[0]+g[1]*q[1]+g[2]*q[2];l[1]-1E-6<=q&&(O[0]=void 0);l[0]+1E-6>=q&&(H[0]=void 0);void 0!==O[0]&&(A(B,O,g),n(B,B),A(C,O,h),n(C,C),A(D,O,x),n(D,D),z(I,C,e),n(I,I),z(J,D,p),n(J,J),z(K,B,r),n(K,K),M(w,I,e,C,B,k),M(w,J,p,D,C,k),M(w,K,r,B,D,k));void 0!==H[0]&&(A(B,H,g),n(B,B),A(C,H,h),n(C,C),A(D,H,x),n(D,D),z(I,C,e),n(I,I),z(J,D,p),n(J,J),z(K,B,r),n(K,K),M(w,I,e,C,B,k),M(w,J,p,D,C,k),M(w,K,r,B,D,k));ma(a,k.b0,
k.b1,k.b2,V,W);a=[0,0,0];A(a,W,V);k.quality=da(a);k.quality<m?na(k.b0,k.b1,k.b2,V,W,a,b):la(X,ca,b)}};Object.defineProperties(ha,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});