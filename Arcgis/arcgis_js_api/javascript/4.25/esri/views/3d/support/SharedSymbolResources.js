// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Handles ../../../core/handleUtils ../../../core/maybe ../../../core/reactiveUtils ../../../geometry/projectionEllipsoid ../layers/graphics/ObjectResourceCache ./index ./StreamTextureCollection ../webgl-engine/lib/screenSizePerspectiveUtils ../../webgl/enums".split(" "),function(g,m,n,p,h,q,e,r,t,u,v,k,l){let y=function(){function f(a){this.streamDataRequester=this.textures=null;this._graphicsOwners=[];
this.cimSymbolRasterizer=this._screenSizePerspectiveHandles=null;this._viewState=a.viewState;this._view=a.view;this._pointsOfInterest=a.pointsOfInterest;this.streamDataRequester=a.resourceController.createStreamDataRequester(u.ClientType.SYMBOLOGY);this.objectResourceCache=new t.ObjectResourceCache((w,x)=>a.resourceController.memoryController.newCache(w,x));this.textures=new v.StreamTextureCollection(this.streamDataRequester,a.view._stage,{preMultiplyAlpha:!0,wrap:{s:l.TextureWrapMode.CLAMP_TO_EDGE,
t:l.TextureWrapMode.CLAMP_TO_EDGE}},a.resourceController.scheduler);const b=r.getReferenceEllipsoid(this._view.spatialReference).radius;this.screenSizePerspectiveSettings=k.getSettings(a.viewingMode,b);this.screenSizePerspectiveSettingsLabels=k.getLabelSettings(a.viewingMode,b)}var c=f.prototype;c.destroy=function(){q.destroyMaybe(this.textures);this.streamDataRequester=this.textures=null};c.addGraphicsOwner=function(a){if(!a)return h.makeHandle();this._graphicsOwners.push(a);const b=e.watch(()=>
a.layer?.screenSizePerspectiveEnabled,()=>this._updateScreenSizePerspectiveEnabled());this._updateScreenSizePerspectiveEnabled();return h.makeHandle(()=>{b.remove();n.removeUnordered(this._graphicsOwners,a);this._updateScreenSizePerspectiveEnabled()})};c._updateScreenSizePerspectiveEnabled=function(){var a=this._graphicsOwners.some(b=>!0===b.layer?.screenSizePerspectiveEnabled);a&&!this._screenSizePerspectiveHandles?(this._screenSizePerspectiveHandles=new p,a=()=>this._updateScreenSizePerspectiveSettings(),
this._screenSizePerspectiveHandles.add([e.watch(()=>this._pointsOfInterest.centerOnSurfaceInfrequent.distance,a,e.sync),this._viewState.events.on("camera-projection-changed",a)]),this._updateScreenSizePerspectiveSettings()):!a&&this._screenSizePerspectiveHandles&&(this._screenSizePerspectiveHandles.destroy(),this._screenSizePerspectiveHandles=null)};c._updateScreenSizePerspectiveSettings=function(){d.distance=this._pointsOfInterest.centerOnSurfaceInfrequent.distance;d.fovY=this._viewState.camera.fovY;
this.screenSizePerspectiveSettings.update(d);this.screenSizePerspectiveSettingsLabels.update(d);this._view._stage.renderView.requestRender()};m._createClass(f,[{key:"test",get:function(){return{screenSizePerspectiveHandles:this._screenSizePerspectiveHandles}}}]);return f}();const d={distance:0,fovY:0};g.SharedSymbolResources=y;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});