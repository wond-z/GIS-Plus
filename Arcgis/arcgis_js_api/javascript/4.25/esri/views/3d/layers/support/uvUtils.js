// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/maybe ../../../../chunks/mat4f64 ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../geometry/projection ../../../../geometry/projectionEllipsoid ../../../../geometry/support/plane ../../../../geometry/support/buffer/BufferView ../../../ViewingMode".split(" "),function(B,J,K,C,D,b,n,L,M,E,N,O){function F(x,e,a,d,g,c,k){b.set(x,e*g[0]+a*c[0]+d*k[0],e*g[1]+a*c[1]+d*k[1],e*g[2]+a*c[2]+d*k[2])}const G=n.create(),
l=n.create(),I=E.create(),m=n.create(),h=n.create(),w=n.create(),f=D.create(),t=D.create(),p=D.create(),r=n.create(),u=n.create(),v=n.create(),q=K.create(),y=n.create(),z=n.create(),H=n.create(),A=n.create();B.createMapSpaceUVCoords=function(x,e,a,d,g=1){b.set(m,1,0,0);b.set(h,0,1,0);b.set(w,0,0,1);b.set(A,0,0,0);for(var c=0;c<e.count-1;c++)e.getVec(c,l),b.add(A,A,l);b.scale(G,A,1/(e.count-1));c=e.count-1;if(E.fromManyPointsSampleAt(e,I,0,Math.floor(c/3),Math.floor(2/3*c))){J.isSome(a)?(a.basisMatrixAtPosition(G,
q),b.set(y,q[0],q[1],q[2]),b.set(z,q[4],q[5],q[6]),b.set(H,q[8],q[9],q[10])):(b.set(y,1,0,0),b.set(z,0,1,0),b.set(H,0,0,1));a=E.normal(I);0>b.dot(a,H)&&b.scale(a,a,-1);b.copy(w,a);c=b.dot(a,z);var k=b.dot(a,y);Math.abs(c)<Math.abs(k)?(b.scaleAndAdd(m,y,a,-k),b.normalize(m,m),b.cross(h,m,a),b.normalize(h,h),b.scale(h,h,-1)):(b.scaleAndAdd(h,z,a,-c),b.normalize(h,h),b.cross(m,h,a),b.normalize(m,m))}C.set(f,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);C.set(t,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);
for(a=0;a<e.count;a++)e.getVec(a,l),c=b.dot(m,l),k=b.dot(h,l),f[0]=Math.min(f[0],c),f[1]=Math.min(f[1],k),t[0]=Math.max(t[0],c),t[1]=Math.max(t[1],k);a=b.dot(w,G);F(r,f[0],f[1],a,m,h,w);F(u,t[0],f[1],a,m,h,w);F(v,f[0],t[1],a,m,h,w);b.subtract(u,u,r);b.scale(u,u,.5);b.subtract(v,v,r);b.scale(v,v,.5);b.add(r,r,u);b.add(r,r,v);a=f[1]%g;p[0]=f[0]-f[0]%g;p[1]=f[1]-a;for(a=0;a<e.count;a++)for(e.getVec(a,l),x.setValues(a,(b.dot(m,l)-p[0])/g,(b.dot(h,l)-p[1])/g,p[0]/g,p[1]/g),c=0;3>c;c++)d.set(a,c,r[c]),
d.set(a,c+3,u[c]),d.set(a,c+6,v[c])};B.createMapSpaceUVCoordsDraped=function(x,e,a,d,g=1){if(a.isGeographic&&d===O.ViewingMode.Global){d=new Float64Array(e.typedBuffer.length);const c=3*e.count;a=M.getReferenceEllipsoid(a);for(let k=0;k<c;k+=3)L.lonLatToWebMercatorComparable(e.typedBuffer,k,d,k,a);e=N.BufferViewVec3f64.fromTypedArray(d)}C.set(f,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(d=0;d<e.count;d++)e.getVec(d,l),f[0]=Math.min(f[0],l[0]),f[1]=Math.min(f[1],l[1]);d=f[1]%g;p[0]=f[0]-
f[0]%g;p[1]=f[1]-d;for(d=0;d<e.count;d++)e.getVec(d,l),x.setValues(d,(l[0]-p[0])/g,(l[1]-p[1])/g,p[0]/g,p[1]/g)};Object.defineProperties(B,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});