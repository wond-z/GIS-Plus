// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ../../glTF/DefaultLoadingContext ../../glTF/loader ./wosrLoader".split(" "),function(n,q,h,l,r,t,u){let w=function(){function p(a){this._gltfLoading=new Map;this._wosrLoading=new Map;this._gltfMemCache=a("gltf-resources",()=>{});this._wosrMemCache=a("wosr-resources",()=>{})}var k=p.prototype;k.destroy=function(){this._gltfLoading.forEach(a=>a.abortController.abort());this._wosrLoading.forEach(a=>
a.abortController.abort());this._gltfMemCache.destroy();this._wosrMemCache.destroy()};k.loadGLTF=function(a,b,c){const d=c?`gltfPBR:${a}`:`gltf:${a}`,e=this._gltfMemCache.get(d);return h.isSome(e)?Promise.resolve(e):this._loadOnce(this._gltfLoading,this._gltfMemCache,d,f=>t.loadGLTF(new r.DefaultLoadingContext(f.streamDataRequester),a,f,c),b)};k.loadWOSR=function(a,b){const c=`wosr:${a}:${b.disableTextures}`,d=this._wosrMemCache.get(c);return h.isSome(d)?Promise.resolve(d):this._loadOnce(this._wosrLoading,
this._wosrMemCache,c,e=>u.load(a,e),b)};k._loadOnce=function(){var a=q._asyncToGenerator(function*(b,c,d,e,f){l.throwIfAborted(f);const v=l.onAbort(f,()=>this._abortLoad(b,d));var g=b.get(d);g?g.refCount++:(g=new AbortController,e=e({...f,signal:g.signal}),g={refCount:1,abortController:g,promise:e},b.set(d,g));try{const m=yield g.promise;c.put(d,m,m.size);b.delete(d);l.throwIfAborted(f);return m}finally{h.removeMaybe(v)}});return function(b,c,d,e,f){return a.apply(this,arguments)}}();k._abortLoad=
function(a,b){const c=a.get(b);h.isSome(c)&&0<--c.refCount||(a.delete(b),h.isSome(c)&&c.abortController.abort())};return p}();n.ObjectResourceCache=w;Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});