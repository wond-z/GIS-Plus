// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../lib/GLTextureMaterial ../lib/Material ../lib/RenderSlot ../lib/VertexAttribute ./VisualVariablePassParameters ../shaders/LineMarkerTechnique ../shaders/LineMarkerTechniqueConfiguration ../shaders/RibbonLineTechniqueConfiguration".split(" "),function(B,C,N,x,E,O,n,P,D,p,g,Q,F,y,G){let T=function(m){function h(a){a=
m.call(this,a,new H)||this;a._vertexAttributeLocations=F.vertexAttributeLocations;a._configuration=new y.LineMarkerTechniqueConfiguration;a._layout=a.createLayout();return a}C._inheritsLoose(h,m);var b=h.prototype;b.dispose=function(){};b.getConfiguration=function(a,c){this._configuration.output=a;this._configuration.space=c.slot===p.RenderSlot.DRAPED_MATERIAL?y.LineMarkerSpace.Draped:this.parameters.worldSpace?y.LineMarkerSpace.World:y.LineMarkerSpace.Screen;this._configuration.hideOnShortSegments=
this.parameters.hideOnShortSegments;this._configuration.hasCap=this.parameters.cap!==G.CapType.BUTT;this._configuration.anchor=this.parameters.anchor;this._configuration.hasTip=this.parameters.hasTip;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.hasOccludees=this.parameters.hasOccludees;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.vvColor=this.parameters.vvColorEnabled;this._configuration.vvOpacity=this.parameters.vvOpacityEnabled;
this._configuration.vvSize=this.parameters.vvSizeEnabled;this._configuration.occluder=this.parameters.renderOccluded===D.RenderOccludedFlag.OccludeAndTransparentStencil;this._configuration.transparencyPassType=c.transparencyPassType;this._configuration.hasMultipassTerrain=c.multipassTerrain.enabled;this._configuration.cullAboveGround=c.multipassTerrain.cullAboveGround;return this._configuration};b.intersect=function(){};b.createLayout=function(){const a=O.newLayout().vec3f(g.VertexAttribute.POSITION).vec2f(g.VertexAttribute.UV0).vec3f(g.VertexAttribute.AUXPOS1);
this.parameters.worldSpace&&a.vec3f(g.VertexAttribute.NORMAL);this.parameters.vvSizeEnabled?a.f32(g.VertexAttribute.SIZEFEATUREATTRIBUTE):a.f32(g.VertexAttribute.SIZE);this.parameters.vvColorEnabled?a.f32(g.VertexAttribute.COLORFEATUREATTRIBUTE):a.vec4f(g.VertexAttribute.COLOR);this.parameters.vvOpacityEnabled&&a.f32(g.VertexAttribute.OPACITYFEATUREATTRIBUTE);return a};b.createBufferWriter=function(){return new R(this._layout,this.parameters)};b.requiresSlot=function(a,c){return c===n.ShaderOutput.Color||
c===n.ShaderOutput.Alpha||c===n.ShaderOutput.Highlight||c===n.ShaderOutput.Depth?a===p.RenderSlot.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===D.RenderOccludedFlag.OccludeAndTransparentStencil?a===p.RenderSlot.OPAQUE_MATERIAL||a===p.RenderSlot.OCCLUDER_MATERIAL||a===p.RenderSlot.TRANSPARENT_OCCLUDER_MATERIAL:c===n.ShaderOutput.Color||c===n.ShaderOutput.Alpha?a===(this.parameters.writeDepth?p.RenderSlot.TRANSPARENT_MATERIAL:p.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):a===p.RenderSlot.OPAQUE_MATERIAL:
!1};b.createGLMaterial=function(a){return new S(a)};return h}(D.Material),S=function(m){function h(){return m.apply(this,arguments)||this}C._inheritsLoose(h,m);var b=h.prototype;b._updateParameters=function(a){this.updateTexture(this._material.parameters.textureId);this._material.setParameters(this.textureBindParameters);return this.ensureTechnique(F.LineMarkerTechnique,a)};b._updateOccludeeState=function(a){a.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:a.hasOccludees})};
b.beginSlot=function(a){this._output!==n.ShaderOutput.Color&&this._output!==n.ShaderOutput.Alpha||this._updateOccludeeState(a);return this._updateParameters(a)};return h}(P.GLTextureMaterial),H=function(m){function h(){var b=m.apply(this,arguments)||this;b.width=0;b.color=[1,1,1,1];b.placement="end";b.cap=G.CapType.BUTT;b.anchor=y.LineMarkerAnchor.Center;b.hasTip=!1;b.worldSpace=!1;b.hideOnShortSegments=!1;b.writeDepth=!0;b.hasSlicePlane=!1;b.vvFastUpdate=!1;b.hasOccludees=!1;return b}C._inheritsLoose(h,
m);return h}(Q.VisualVariablePassParameters),R=function(){function m(b,a){this.vertexBufferLayout=b;this._parameters=a}var h=m.prototype;h.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};h.elementCount=function(){return"begin-end"===this._parameters.placement?12:6};h.write=function(b,a,c,r,U){const q=c.vertexAttributes.get(g.VertexAttribute.POSITION).data,I=q.length/3;let z=[1,0,0];a=c.vertexAttributes.get(g.VertexAttribute.NORMAL);this._parameters.worldSpace&&N.isSome(a)&&(z=
a.data);let J=1,K=0;this._parameters.vvSizeEnabled?K=c.vertexAttributes.get(g.VertexAttribute.SIZEFEATUREATTRIBUTE).data[0]:c.vertexAttributes.has(g.VertexAttribute.SIZE)&&(J=c.vertexAttributes.get(g.VertexAttribute.SIZE).data[0]);let t=[1,1,1,1],L=0;this._parameters.vvColorEnabled?L=c.vertexAttributes.get(g.VertexAttribute.COLORFEATUREATTRIBUTE).data[0]:c.vertexAttributes.has(g.VertexAttribute.COLOR)&&(t=c.vertexAttributes.get(g.VertexAttribute.COLOR).data);let M=0;this._parameters.vvOpacityEnabled&&
(M=c.vertexAttributes.get(g.VertexAttribute.OPACITYFEATUREATTRIBUTE).data[0]);const e=new Float32Array(r.buffer);let f=this.vertexBufferLayout.stride/4*U;const v=(d,u,k,l)=>{e[f++]=d[0];e[f++]=d[1];e[f++]=d[2];e[f++]=k[0];e[f++]=k[1];e[f++]=u[0];e[f++]=u[1];e[f++]=u[2];this._parameters.worldSpace&&(e[f++]=z[0],e[f++]=z[1],e[f++]=z[2]);this._parameters.vvSizeEnabled?e[f++]=K:e[f++]=J;this._parameters.vvColorEnabled?e[f++]=L:(d=Math.min(4*l,t.length-4),e[f++]=t[d+0],e[f++]=t[d+1],e[f++]=t[d+2],e[f++]=
t[d+3]);this._parameters.vvOpacityEnabled&&(e[f++]=M)};let A;(function(d){d[d.ASCENDING=1]="ASCENDING";d[d.DESCENDING=-1]="DESCENDING"})(A||(A={}));c=(d,u)=>{const k=x.set(V,q[3*d],q[3*d+1],q[3*d+2]),l=W;let w=d+u;do x.set(l,q[3*w],q[3*w+1],q[3*w+2]),w+=u;while(x.equals(k,l)&&0<=w&&w<I);b&&(x.transformMat4(k,k,b),x.transformMat4(l,l,b));v(k,l,[-1,-1],d);v(k,l,[1,-1],d);v(k,l,[1,1],d);v(k,l,[-1,-1],d);v(k,l,[1,1],d);v(k,l,[-1,1],d)};r=this._parameters.placement;"begin"!==r&&"begin-end"!==r||c(0,A.ASCENDING);
"end"!==r&&"begin-end"!==r||c(I-1,A.DESCENDING)};return m}();const V=E.create(),W=E.create();B.LineMarkerMaterial=T;B.Parameters=H;Object.defineProperties(B,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});