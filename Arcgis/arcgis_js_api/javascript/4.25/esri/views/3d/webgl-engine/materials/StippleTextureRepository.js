// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/floatRGBA ../../../../core/maybe ../core/shaderModules/interfaces ../../../webgl/enums ../../../webgl/Texture".split(" "),function(k,v,w,l,x,m,y){function q(c){return c.pattern.map(d=>Math.round(d*c.pixelRatio))}function t(c){if(l.isNone(c))return 1;c=q(c);return Math.floor(c.reduce((d,a)=>d+a))}function u(c){return q(c).reduce((d,a)=>Math.max(d,a))}let D=function(){function c(a){this._rctx=a;this._cache=new Map}var d=c.prototype;
d.dispose=function(){this._cache.forEach(a=>l.disposeMaybe(a.stippleTexture));this._cache.clear()};d._acquire=function(a){if(l.isNone(a))return null;const b=this._patternId(a);var f=this._cache.get(b);if(f)return f.refCount++,f;var g=q(a),e=1/a.pixelRatio;f=t(a);a=u(a);const z=(Math.floor(.5*(a-1))+.5)*e;a=[];let r=1;for(var h of g){for(let n=0;n<h;n++)a.push(r*(Math.min(n,h-1-n)+.5)*e/z*.5+.5);r=-r}h=Math.round(g[0]/2);h=[...a.slice(h),...a.slice(0,h)];f+=2;g=new Uint8Array(4*f);e=4;for(var p of h)w.packFloatRGBA(p,
g,e),e+=4;g.copyWithin(0,e-4,e);g.copyWithin(e,4,8);const {encodedData:A,paddedPixels:B}={encodedData:g,paddedPixels:f};p=new C(new y.Texture(this._rctx,{width:B,height:1,internalFormat:m.PixelFormat.RGBA,pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE},A));this._cache.set(b,p);return p};d.release=function(a){if(!l.isNone(a)){a=this._patternId(a);var b=this._cache.get(a);b&&(b.refCount--,0===b.refCount&&(l.isSome(b.stippleTexture)&&b.stippleTexture.dispose(),
this._cache.delete(a)))}};d.swap=function(a,b){b=this._acquire(b);this.release(a);return b};d._patternId=function(a){return`${a.pattern.join(",")}-r${a.pixelRatio}`};return c}(),C=function(c){function d(a){var b=c.call(this)||this;b.stippleTexture=a;b.refCount=1;return b}v._inheritsLoose(d,c);return d}(x.NoParameters);k.STIPPLE_TEXTURE_PADDING=2;k.StippleTextureRepository=D;k.computeLongestPattern=u;k.computeTextureSize=t;Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});