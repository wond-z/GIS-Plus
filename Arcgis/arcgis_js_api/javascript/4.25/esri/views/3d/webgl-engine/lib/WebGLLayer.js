// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Evented ../../../../core/Handles ../../../../core/maybe ../../../../core/PooledArray ./basicInterfaces ./ContentObject ./ContentObjectType ./DirtyEvents ./Octree".split(" "),function(h,l,p,q,e,r,m,k,n,t,u){k=function(f){function g(a,b=""){var c=f.call(this)||this;c.apiLayerUid=b;c.type=n.ContentObjectType.Layer;c.events=new p;c.isSliceable=!1;c._objects=new r;c._stageHandles=new q;c.apiLayerUid=b;c.isVisible=a?.isVisible??
!0;c.isPickable=a?.isPickable??!0;c.updatePolicy=a?.updatePolicy??m.UpdatePolicy.ASYNC;return c}l._inheritsLoose(g,f);var d=g.prototype;d.destroy=function(){this.detachStage();this._stage=null};d.attachStage=function(a){this.detachStage();this._stage=a;for(const b of t.DirtyEventNames)this._stageHandles.add(this.events.on(b,c=>a.handleEvent(b,c)))};d.detachStage=function(){this._stageHandles.removeAll();this.invalidateSpatialQueryAccelerator()};d.add=function(a){this._objects.push(a);a.parentLayer=
this;this.events.emit("layerObjectAdded",{layer:this,object:a});e.isSome(this._octree)&&this._octree.add([a])};d.remove=function(a){this._objects.removeUnordered(a)&&(a.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:a}),e.isSome(this._octree)&&this._octree.remove([a]))};d.addMany=function(a){this._objects.pushArray(a);for(const b of a)b.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:a});e.isSome(this._octree)&&this._octree.add(a)};d.removeMany=
function(a){const b=[];this._objects.removeUnorderedMany(a,a.length,b);if(0!==b.length){for(const c of b)c.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:b});e.isSome(this._octree)&&this._octree.remove(b)}};d.sync=function(){e.isSome(this._stage)&&this.updatePolicy!==m.UpdatePolicy.SYNC&&this._stage.syncLayer(this.id)};d.notifyObjectBBChanged=function(a,b){e.isSome(this._octree)&&this._octree.update(a,b)};d.getSpatialQueryAccelerator=function(){e.isNone(this._octree)&&
50<this._objects.length&&this._createOctree();return this._octree};d.shaderTransformationChanged=function(){this.invalidateSpatialQueryAccelerator();this.events.emit("shaderTransformationChanged",this)};d.invalidateSpatialQueryAccelerator=function(){this._octree=e.destroyMaybe(this._octree)};d._createOctree=function(){this._octree=new u(a=>a.boundingVolumeWorldSpace.bounds);this._octree.add(this._objects.data,this._objects.length)};l._createClass(g,[{key:"objects",get:function(){return this._objects}}]);
return g}(k.ContentObject);h.WebGLLayer=k;h.isWebGLLayer=function(f){return e.isSome(f)&&f.type===n.ContentObjectType.Layer};Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});