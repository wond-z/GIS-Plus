// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/Logger ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./AnalysisView3D ./Dimension/DimensionController ./Dimension/DimensionTool ./Dimension/DimensionVisualization ./Dimension/LengthDimensionComputation ./support/projectionUtils ../../analysis/analysisViewUtils ../../analysis/DimensionAnalysisView".split(" "),
function(m,c,b,u,v,g,p,e,E,F,w,x,y,z,A,B,q,n,C){b=function(r){function l(a){a=r.call(this,a)||this;a.type="dimension-view-3d";a.tool=null;a.computations=new u;a.selectedDimension=null;a._dimensionsToComputations=new Map;a._placementTask=null;a._projectAndAlignPoint=null;return a}m._inheritsLoose(l,r);var h=l.prototype;h.initialize=function(){this._projectAndAlignPoint=a=>{if(g.isNone(a))return null;const {spatialReference:d,elevationProvider:k}=this.view,f=q.applyProjectionAndElevationAlignment(a,
d,k);g.isNone(f)&&q.logFailedGeometryProjectionError(this.analysis,a.spatialReference,v.getLogger(this.declaredClass));return f};this.addHandles([n.connectAnalysisViewToTool(this,z.DimensionTool),p.on(()=>this.analysis.dimensions,"after-add",a=>this._onDimensionAdd(a.item),{onListenerAdd:a=>{for(const d of a)this._onDimensionAdd(d)},onListenerRemove:()=>{this._onDimensionsClear()}}),p.on(()=>this.analysis.dimensions,"after-remove",a=>this._onDimensionRemove(a.item))]);this._analysisVisualization=
new A.DimensionVisualization({analysisViewData:this,view:this.view});this._analysisController=new y.DimensionController({analysisViewData:this,view:this.view})};h.destroy=function(){this._placementTask=g.abortMaybe(this._placementTask);this._analysisVisualization=g.destroyMaybe(this._analysisVisualization);n.removeAnalysisViewTool(this)};h.createLengthDimensions=function(){var a=m._asyncToGenerator(function*(d){this.selectedDimension=null;this._placementTask=g.abortMaybe(this._placementTask);this._placementTask=
n.activateAnalysisViewTool(this,d);return this._placementTask.promise});return function(d){return a.apply(this,arguments)}}();h._onDimensionAdd=function(a){const {computations:d,_dimensionsToComputations:k}=this;if(!k.has(a)){var f=new B.LengthDimensionComputation({dimension:a,projectAndAlignPoint:this._projectAndAlignPoint});d.add(f);k.set(a,f)}};h._onDimensionRemove=function(a){const {computations:d,_dimensionsToComputations:k}=this,f=d.findIndex(D=>D.dimension===a),t=d.getItemAt(f);t.dimension===
this.selectedDimension&&(this.selectedDimension=null);d.removeAt(f);k.delete(a);g.destroyMaybe(t)};h._onDimensionsClear=function(){this.computations.drain(a=>a.destroy());this._dimensionsToComputations.clear()};m._createClass(l,[{key:"updating",get:function(){return this._analysisVisualization?.loadingMessages??!1}},{key:"results",get:function(){return this.analysis.dimensions.map(a=>this._dimensionsToComputations.get(a).result)}},{key:"selectedComputation",get:function(){const {selectedDimension:a}=
this;return g.isNone(a)?null:this._dimensionsToComputations.get(a)}},{key:"testInfo",get:function(){return{visualization:this._analysisVisualization,controller:this._analysisController}}}]);return l}(C(x.AnalysisView3D(b)));c.__decorate([e.property({readOnly:!0})],b.prototype,"type",void 0);c.__decorate([e.property()],b.prototype,"tool",void 0);c.__decorate([e.property()],b.prototype,"updating",null);c.__decorate([e.property({readOnly:!0})],b.prototype,"results",null);c.__decorate([e.property({readOnly:!0})],
b.prototype,"computations",void 0);c.__decorate([e.property()],b.prototype,"selectedDimension",void 0);c.__decorate([e.property()],b.prototype,"selectedComputation",null);c.__decorate([e.property()],b.prototype,"_analysisVisualization",void 0);c.__decorate([e.property()],b.prototype,"_analysisController",void 0);c.__decorate([e.property()],b.prototype,"_dimensionsToComputations",void 0);c.__decorate([e.property()],b.prototype,"_placementTask",void 0);return b=c.__decorate([w.subclass("esri.views.3d.analysis.DimensionAnalysisView3D")],
b)});