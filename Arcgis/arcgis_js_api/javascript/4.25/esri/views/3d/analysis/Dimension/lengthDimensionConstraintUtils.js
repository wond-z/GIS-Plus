// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../analysis/dimensionUtils ../../../../core/has ../../../../core/maybe ../../../../chunks/vec3 ../../../../geometry/support/vectorStacks ./lengthDimensionManipulatorUtils ./lengthDimensionUtils ./settings".split(" "),function(d,t,x,f,k,n,u,q,v){d.LengthDimensionConstraint=void 0;(function(c){c[c.Horizontal=0]="Horizontal";c[c.Vertical=1]="Vertical";c[c.Direct=2]="Direct"})(d.LengthDimensionConstraint||(d.LengthDimensionConstraint={}));d.applyConstraint=function(c,b,a){const {constraint:h,
elevationAlignedStartPoint:g,elevationAlignedEndPoint:l,unconstrainedGeometry:r,view:w}=a,{dimension:e,previousConstraint:p,preConstraintProperties:m}=c;if(!f.isNone(g)&&!f.isNone(l)){a=()=>{"startPoint"in b?e.startPoint=b.startPoint:"endPoint"in b&&(e.endPoint=b.endPoint)};if(f.isNone(h))a(),f.isSome(p)&&f.isSome(m)&&(e.measureType=m.measureType,e.orientation=m.orientation);else switch(e.measureType=t.LengthDimensionMeasureType.Direct,h){case d.LengthDimensionConstraint.Horizontal:h!==p&&(e.orientation=
0);"startPoint"in b?(a=b.startPoint,f.isSome(a)&&(a.z=l.z),e.startPoint=a):"endPoint"in b&&(a=b.endPoint,f.isSome(a)&&(a.z=g.z),e.endPoint=a);break;case d.LengthDimensionConstraint.Vertical:h!==p&&(e.orientation=u.automaticHeadingFromCamera(r,w));"startPoint"in b?(a=b.startPoint,f.isSome(a)&&(a.x=l.x,a.y=l.y),e.startPoint=a):"endPoint"in b&&(a=b.endPoint,f.isSome(a)&&(a.x=g.x,a.y=g.y),e.endPoint=a);break;case d.LengthDimensionConstraint.Direct:h!==p&&f.isSome(m)&&(e.orientation=m.orientation),a()}c.previousConstraint=
h}};d.computeConstraint=function(c,b){if(q.isGeodesicDimension(c))return d.LengthDimensionConstraint.Direct;({geometry:c}=c);if(f.isNone(c)||k.exactEquals(c.directSegment.startRenderSpace,c.directSegment.endRenderSpace))return null;const {constraintThresholdPx:a}=v.settings,{camera:h}=b.state;b=q.directUp(n.sv3d.get(),c,b.renderCoordsHelper);var g=q.directStartToEnd(n.sv3d.get(),c);b=k.scale(n.sv3d.get(),b,k.dot(g,b));g=k.subtract(n.sv3d.get(),g,b);g=k.squaredLength(g);b=k.squaredLength(b);const {startRenderSpace:l,
endRenderSpace:r}=c.directSegment;c=Math.max(h.computeRenderPixelSizeAt(l)*a,h.computeRenderPixelSizeAt(r)*a)**2;return g<c?d.LengthDimensionConstraint.Vertical:b<c?d.LengthDimensionConstraint.Horizontal:null};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});