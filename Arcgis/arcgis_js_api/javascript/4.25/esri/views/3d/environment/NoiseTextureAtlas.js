// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/NoiseTextureAtlas.glsl ./NoiseTextureAtlasConfiguration ./NoiseTextureAtlasDimensions ./NoiseTextureAtlasTechnique ../webgl-engine/lib/glUtil3D ../../webgl/enums ../../webgl/FramebufferObject".split(" "),
function(e,n,m,t,b,p,z,A,u,v,w,d,f,q,x,g,y){e.NoiseTextureAtlas=function(r){function h(a){var c=r.call(this,a)||this;c._needsRender=!0;c._passParameters=new w.NoiseTextureAtlasPassParameters;c._frameBuffer=new y.FramebufferObject(a.context.renderContext.rctx,{colorTarget:g.TargetType.TEXTURE,width:f.ATLAS_SIZE,height:f.ATLAS_SIZE},{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:g.TextureSamplingMode.LINEAR,
hasMipmap:!1,width:f.ATLAS_SIZE,height:f.ATLAS_SIZE});c._vao=x.createQuadVAO(a.context.renderContext.rctx);return c}n._inheritsLoose(h,r);var k=h.prototype;k._setDirty=function(){this._needsRender=!0};k.updateWeatherMap=function(a){if(this._passParameters.weatherTile[0]!==a[0]||this._passParameters.weatherTile[1]!==a[1])v.copy(this._passParameters.weatherTile,a),this._setDirty()};k.destroy=function(){this._fullTechniqueCached=b.releaseMaybe(this._fullTechniqueCached);this._weatherMapTechniqueCached=
b.releaseMaybe(this._weatherMapTechniqueCached);this._frameBuffer=b.disposeMaybe(this._frameBuffer);this._vao=b.disposeMaybe(this._vao)};k._render=function(a){if(b.isNone(this._vao)||b.isNone(this._frameBuffer))return null;var c=a===d.NoiseTextureRenderMode.Full?this._fullTechnique:this._weatherMapTechnique;a=this.context.renderContext.rctx;const l=a.getViewport();a.setViewport(0,0,f.ATLAS_SIZE,f.ATLAS_SIZE);a.bindFramebuffer(this._frameBuffer);c=a.bindTechnique(c,this._passParameters,null);a.bindVAO(this._vao);
c.assertCompatibleVertexAttributeLocations(this._vao);a.gl.drawArrays(a.gl.TRIANGLE_STRIP,0,4);a.setViewport(l.x,l.y,l.width,l.height);this._needsRender=!1;return this._frameBuffer.colorTexture};n._createClass(h,[{key:"_techniqueRepository",get:function(){return this.context.shaderTechniqueRepository}},{key:"textureAtlas",get:function(){b.isSome(this._texture)?b.isSome(this._weatherMapTechnique)&&this._weatherMapTechnique.compiled&&this._needsRender&&(this._texture=this._render(d.NoiseTextureRenderMode.WeatherMap)):
b.isSome(this._fullTechnique)&&this._fullTechnique.compiled&&(this._texture=this._render(d.NoiseTextureRenderMode.Full));return this._texture}},{key:"_fullTechnique",get:function(){if(b.isNone(this._fullTechniqueCached)){const a=new d.NoiseTextureAtlasTechniqueConfiguration;a.mode=d.NoiseTextureRenderMode.Full;this._fullTechniqueCached=this._techniqueRepository.acquire(q.NoiseTextureAtlasTechnique,a)}return this._fullTechniqueCached}},{key:"_weatherMapTechnique",get:function(){if(b.isNone(this._weatherMapTechniqueCached)){const a=
new d.NoiseTextureAtlasTechniqueConfiguration;a.mode=d.NoiseTextureRenderMode.WeatherMap;this._weatherMapTechniqueCached=this._techniqueRepository.acquire(q.NoiseTextureAtlasTechnique,a)}return this._weatherMapTechniqueCached}}]);return h}(t);m.__decorate([p.property({constructOnly:!0})],e.NoiseTextureAtlas.prototype,"context",void 0);m.__decorate([p.property({readOnly:!0})],e.NoiseTextureAtlas.prototype,"_techniqueRepository",null);e.NoiseTextureAtlas=m.__decorate([u.subclass("esri.views.3d.environment.NoiseTextureAtlas")],
e.NoiseTextureAtlas);Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});