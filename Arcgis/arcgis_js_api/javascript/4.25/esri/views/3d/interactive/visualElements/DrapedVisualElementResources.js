// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Identifiable ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../layers/interfaces ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/ModelDirtyTypes".split(" "),function(g,h,f,p,q,c,k,l,w,r,t,u,m){l=function(){function d(a){this._resourceFactory=
a;this._resources=null;this._visible=!0;this._attached=!1}var b=d.prototype;b.destroy=function(){this._destroyResources()};b.recreate=function(){this.attached&&this._createResources()};b.recreateGeometry=function(){this._resourceFactory.recreateGeometry?c.isNone(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()};b._createOrDestroyResources=function(){this._attached?c.isNone(this._resources)&&
this._createResources():this._destroyResources()};b._createResources=function(){this._destroyResources();const a=this._resourceFactory.createResources(),v=new e({view:this._resourceFactory.view}),n=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new e({view:this._resourceFactory.view}),external:a,geometriesAdded:!1};n&&(this._resources.drapeSourceRenderer=n.registerGeometryDrapeSource(v));this._syncGeometriesToRenderer()};b._destroyResources=function(){if(!c.isNone(this._resources)){this._ensureRenderGeometriesRemoved();
var a=this._resourceFactory.view.basemapTerrain?.overlayManager;a&&a.unregisterDrapeSource(this._resources.layerView);this._resources=null}};b._syncGeometriesToRenderer=function(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()};b._ensureRenderGeometriesRemoved=function(){c.isNone(this._resources)||c.isNone(this._resources.drapeSourceRenderer)||!this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,
m.DirtyOperation.UPDATE),this._resources.geometriesAdded=!1)};b._ensureRenderGeometriesAdded=function(){c.isNone(this._resources)||c.isNone(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,m.DirtyOperation.UPDATE),this._resources.geometriesAdded=!0)};h._createClass(d,[{key:"resources",get:function(){return c.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},
set:function(a){a!==this._visible&&(this._visible=a,this._syncGeometriesToRenderer())}},{key:"attached",get:function(){return this._attached},set:function(a){a!==this._attached&&(this._attached=a,this._createOrDestroyResources())}}]);return d}();let e=function(d){function b(a){a=d.call(this,a)||this;a.drapeSourceType=t.DrapeSourceType.Features;a.updatePolicy=u.UpdatePolicy.SYNC;return a}h._inheritsLoose(b,d);return b}(q.IdentifiableMixin(p));f.__decorate([k.property({constructOnly:!0})],e.prototype,
"view",void 0);f.__decorate([k.property({readOnly:!0})],e.prototype,"drapeSourceType",void 0);e=f.__decorate([r.subclass("DrapedVisualElementLayerView")],e);g.DrapedVisualElementResources=l;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});