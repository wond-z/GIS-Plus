// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4 ../../../../chunks/vec4f64 ../../../../geometry/projection ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./VisualElementResources ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(l,v,m,d,w,x,h,n,p,y,q,z,A,B,r,C,t,D){let G=function(){function k(a){this._geometry=this.view=null;this._size=3;this._color=n.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=n.fromValues(1,1,1,1);this._elevationInfo=null;this._resources=new z.VisualElementResources({view:a.view,createResources:b=>this._createResources(b),recreateGeometry:(b,e)=>{b.geometry=this._recreateGeometry(e,b.material);return d.isSome(b.geometry)?[b.geometry]:
[]}});let c=!0;for(const b in a)b in this?"attached"===b?c=a[b]:this[b]=a[b]:console.error("Cannot set unknown property",b);this.attached=c}var f=k.prototype;f.destroy=function(){this._resources.destroy()};f._updateMaterial=function(){const a=this._resources.resources;d.isNone(a)||a.material.setParameters(this._materialParameters(a.texture.id))};f._updateSizeAttribute=function(){var a=this._resources.resources;const c=this._resources.object;if(!d.isNone(a)&&!d.isNone(c)&&(a=a.geometry,!d.isNone(a))){a=
a.getMutableAttribute(t.VertexAttribute.SIZE).data;var b=this._geometrySize;a[0]=b;a[1]=b;c.geometryVertexAttrsUpdated(c.geometryRecords[0])}};f._materialParameters=function(a){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:E,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:a,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}};f._recreateGeometry=function(a,
c){const b=this._createRenderGeometry();d.isSome(b)&&a.addGeometry(b,c);return b};f._createResources=function(a){const c=r.createTexture(this._primitive,this._preferredTextureSize),b=new D.HUDMaterial(this._materialParameters(c.id));a=this._recreateGeometry(a,b);return{material:b,texture:c,geometry:a,forEach(e){e(c);e(b);d.isSome(this.geometry)&&e(this.geometry)}}};f.calculateMapBounds=function(a){if(d.isNone(this._resources.resources)||d.isNone(this._resources.resources.geometry))return!1;const c=
this._resources.resources.geometry.vertexAttributes.get(t.VertexAttribute.POSITION);p.projectVectorToVector(c.data,this.view.renderCoordsHelper.spatialReference,u,this.view.spatialReference);y.expandWithBuffer(a,u);return!0};f._createRenderGeometry=function(){var a=this.geometry;if(d.isNone(a))return null;const {renderCoordsHelper:c,elevationProvider:b}=this.view;var e=A.evaluateElevationAlignmentAtPoint(a,b,B.ElevationContext.fromElevationInfo(this.elevationInfo),c);const F=w.set(q.sv3d.get(),a.x,
a.y,e);e=q.sv3d.get();p.projectVectorToVector(F,a.spatialReference,e,c.spatialReference);a=this._geometrySize;return C.createPointGeometry(null,e,null,[a,a],[0,0,0,1])};v._createClass(k,[{key:"visible",get:function(){return this._resources.visible},set:function(a){this._resources.visible=a}},{key:"attached",get:function(){return this._resources.attached},set:function(a){this._resources.attached=a}},{key:"geometry",get:function(){return this._geometry},set:function(a){this._geometry=a;this._resources.recreateGeometry()}},
{key:"size",get:function(){return this._size},set:function(a){if(a!==this._size){const c=this._preferredTextureSize;this._size=a;c<this._preferredTextureSize?d.isSome(this._resources)&&this._resources.recreate():this._updateSizeAttribute()}}},{key:"color",get:function(){return this._color},set:function(a){h.exactEquals(a,this._color)||(h.copy(this._color,a),this._updateMaterial())}},{key:"pixelSnappingEnabled",get:function(){return this._pixelSnappingEnabled},set:function(a){this._pixelSnappingEnabled!==
a&&(this._pixelSnappingEnabled=a,this._updateMaterial())}},{key:"primitive",get:function(){return this._primitive},set:function(a){this._primitive!==a&&(this._primitive=a,d.isSome(this._resources)&&this._resources.recreate())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(a){a!==this._outlineSize&&(this._outlineSize=a,this._updateMaterial())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(a){h.exactEquals(a,this._outlineColor)||(h.copy(this._outlineColor,
a),this._updateMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(a){this._elevationInfo=a;this._resources&&this._resources.recreateGeometry()}},{key:"_geometrySize",get:function(){return this._size/g}},{key:"_preferredTextureSize",get:function(){return m.clamp(m.nextHighestPowerOfTwo(2*this._geometrySize),16,128)}}]);return k}();const g=r.DEFAULT_SYMBOL_SIZE_RATIO,E=[g/2,g/2,1-g/2,1-g/2],u=x.create();l.PointVisualElement=G;Object.defineProperties(l,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})});