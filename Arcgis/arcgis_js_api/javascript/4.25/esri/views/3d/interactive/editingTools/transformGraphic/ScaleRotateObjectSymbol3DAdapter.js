// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/HandleOwner ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass".split(" "),function(g,w,e,B,C,x,d,y,f,E,F,z){function A(t){return-x.deg2rad(t)}
g.ScaleRotateObjectSymbol3DAdapter=function(t){function q(a){a=t.call(this,a)||this;a.sizeAxis=null;a._interactionState=null;return a}w._inheritsLoose(q,t);var l=q.prototype;l.initialize=function(){this.addHandles(y.when(()=>d.isSome(this._interactionState)?this._interactionState.state:null,a=>{this._updateSymbol(a)},y.sync))};l.startInteraction=function(){const a=this._graphicSymbol,c=this.findLayerView();if(d.isSome(this._interactionState)||d.isNone(a)||d.isNone(c))return D;var b=a.symbolLayers.map(u=>
"object"===u.type?c.getSymbolLayerSize(a,u):null).toArray();const n=a.clone();this._interactionState=b=new p({originalSymbol:n,angle:this.angle,initialSizes:b});const k=()=>this._interactionState=null;return{state:b,done:k,cancel:()=>{this._graphicSymbol=n;k()}}};l.createUndoRecord=function(){let a=this.graphic.symbol,c=null;return{undo:b=>{c=b.symbol;b.symbol=a},redo:b=>{a=b.symbol;b.symbol=c}}};l._updateSymbol=function({scale:a,angle:c,originalSymbol:b,initialSizes:n}){var k=this._graphicSymbol;
if(!d.isNone(k)&&"point-3d"===k.type){k=k.clone();var u=-x.rad2deg(c-this.initialAngle),v=!1;this._forEachObjectSymbolLayerPair(b,k,(m,r,h)=>{m=d.unwrapOr(m.heading,0)+u;r.heading!==m&&(r.heading=m,v=!0);h=n[h];d.isSome(h)&&"width"in h&&(h.width=this.sizeFilter(h.width),h.height=this.sizeFilter(h.height),h.depth=this.sizeFilter(h.depth),m=h.width*a,r.width!==m&&(r.width=m,v=!0),m=h.depth*a,r.depth!==m&&(r.depth=m,v=!0),h=h.height*a,r.height!==h&&(r.height=h,v=!0))});v&&(this._graphicSymbol=k)}};l._forEachObjectSymbolLayerPair=
function(a,c,b){a.symbolLayers.forEach((n,k)=>{const u=c.symbolLayers.getItemAt(k);"object"===n.type&&"object"===u.type&&b(n,u,k)})};w._createClass(q,[{key:"angle",get:function(){return d.isSome(this._interactionState)?this._interactionState.angle:d.isSome(this._orientationReferenceSymbolLayer)?A(this._orientationReferenceSymbolLayer.heading):0}},{key:"scale",get:function(){return d.isSome(this._interactionState)?this._interactionState.scale:1}},{key:"relativeAngle",get:function(){return this.angle-
this.initialAngle}},{key:"initialAngle",get:function(){return d.isSome(this._interactionState)?this._interactionState.initialAngle:0}},{key:"size",get:function(){const a=this._sizeReferenceSymbolLayer;if(d.isNone(a))return null;var c=this.findLayerView(),b=this._graphicSymbol;if(d.isNone(c)||d.isNone(b)||"point-3d"!==b.type)return null;c=c.getSymbolLayerSize(b,a);if("size"in c&&d.isSome(c.size))return c.size;b=this.sizeAxis;return"width"in c&&d.isSome(c.width)&&(d.isNone(b)||"width"===b||"all"===
b||"width-and-depth"===b)?c.width:"depth"in c&&d.isSome(a.depth)&&(d.isNone(b)||"depth"===b||"all"===b||"width-and-depth"===b)?c.depth:"height"in c&&d.isSome(a.height)&&(d.isNone(b)||"height"===b||"all"===b)?c.height:null}},{key:"_sizeReferenceSymbolLayer",get:function(){const a=this._graphicSymbol;return d.isNone(a)||0===a.symbolLayers.length?null:a.symbolLayers.find(c=>"object"===c.type)}},{key:"_orientationReferenceSymbolLayer",get:function(){const a=this._graphicSymbol;return d.isNone(a)||0===
a.symbolLayers.length?null:a.symbolLayers.find(c=>"object"===c.type&&d.isSome(c.heading))}},{key:"_graphicSymbol",get:function(){return d.isSome(this.graphic)&&d.isSome(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null},set:function(a){this.graphic.symbol=a}}]);return q}(C.HandleOwner);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"angle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"scale",null);e.__decorate([f.property()],
g.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,
"_interactionState",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",null);e.__decorate([f.property()],
g.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);g.ScaleRotateObjectSymbol3DAdapter=e.__decorate([z.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],g.ScaleRotateObjectSymbol3DAdapter);const D={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let p=function(t){function q(l){var a=t.call(this,l)||this;a.angle=0;a.initialAngle=0;a.scale=1;a.initialAngle=l.angle;return a}w._inheritsLoose(q,t);w._createClass(q,[{key:"state",get:function(){const {originalSymbol:l,
angle:a,initialAngle:c,scale:b,initialSizes:n}=this;return{originalSymbol:l,angle:a,initialAngle:c,scale:b,initialSizes:n}}}]);return q}(B);e.__decorate([f.property()],p.prototype,"originalSymbol",void 0);e.__decorate([f.property()],p.prototype,"angle",void 0);e.__decorate([f.property()],p.prototype,"initialAngle",void 0);e.__decorate([f.property()],p.prototype,"initialSizes",void 0);e.__decorate([f.property()],p.prototype,"scale",void 0);e.__decorate([f.property()],p.prototype,"state",null);p=e.__decorate([z.subclass("InteractionState")],
p);g.headingToAngle=A;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});