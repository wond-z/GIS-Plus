// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/HandleOwner ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/arrayUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/axisAngleDegrees ../../../../ViewingMode ./undoRecords".split(" "),
function(e,n,b,x,y,t,k,p,c,A,B,u,v,w,z){e.ScaleRotateMeshAdapter=function(l){function f(a){a=l.call(this,a)||this;a._interactionState=null;return a}n._inheritsLoose(f,l);var d=f.prototype;d.initialize=function(){this.addHandles([p.when(()=>k.isSome(this._interactionState)&&this._interactionState.angle!==this._interactionState.previousAngle?{interactionState:this._interactionState,angle:this._interactionState.state.angle}:null,({interactionState:a})=>{this._updateMeshRotation(a)},p.sync),p.when(()=>
k.isSome(this._interactionState)&&this._interactionState.scale!==this._interactionState.previousScale?{interactionState:this._interactionState,scale:this._interactionState.state.scale}:null,({interactionState:a})=>{this._updateMeshSize(a)},p.sync)])};d.startInteraction=function(){const a=new g({angle:this.angle});this._interactionState=a;const h=()=>this._interactionState=null;return{state:a,done:h,cancel:()=>{a.cancel();h()}}};d.createUndoRecord=function(){return z.createGraphicGeometryUndoRecord(this.graphic)};
d._updateMeshRotation=function(a){const h=this.geometry.anchor,q=this.viewingMode===w.ViewingMode.Global,{angle:m,previousAngle:r}=a;this.geometry.rotate(0,0,t.rad2deg(m-r),{origin:h,geographic:q});a.previousAngle=m;k.isSome(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged();this.graphic.notifyGeometryChanged()};d._updateMeshSize=function(a){const h=this.geometry.anchor,q=this.viewingMode===w.ViewingMode.Global,{scale:m,previousScale:r}=a;this.geometry.scale(m/r,{origin:h,geographic:q});
a.previousScale=m;k.isSome(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged();this.graphic.notifyGeometryChanged()};n._createClass(f,[{key:"angle",get:function(){const a=this.geometry.transform;if(k.isNone(a))return 0;const h=v.axis(a.rotation)[2];return.999999<Math.abs(h)?t.deg2rad(v.angle(a.rotation))*Math.sign(h):0}},{key:"scale",get:function(){return k.isSome(this._interactionState)?this._interactionState.scale:1}}]);return f}(y.HandleOwner);b.__decorate([c.property({constructOnly:!0})],
e.ScaleRotateMeshAdapter.prototype,"graphic",void 0);b.__decorate([c.property({constructOnly:!0})],e.ScaleRotateMeshAdapter.prototype,"geometry",void 0);b.__decorate([c.property({constructOnly:!0})],e.ScaleRotateMeshAdapter.prototype,"viewingMode",void 0);b.__decorate([c.property()],e.ScaleRotateMeshAdapter.prototype,"angle",null);b.__decorate([c.property()],e.ScaleRotateMeshAdapter.prototype,"scale",null);b.__decorate([c.property()],e.ScaleRotateMeshAdapter.prototype,"_interactionState",void 0);
e.ScaleRotateMeshAdapter=b.__decorate([u.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],e.ScaleRotateMeshAdapter);let g=function(l){function f(d){var a=l.call(this,d)||this;a.angle=0;a.initialAngle=0;a.previousAngle=0;a.previousScale=1;a.scale=1;a.initialAngle=d.angle;a.previousAngle=d.angle;return a}n._inheritsLoose(f,l);f.prototype.cancel=function(){this.angle=this.initialAngle;this.scale=1};n._createClass(f,[{key:"state",get:function(){const {angle:d,
scale:a}=this;return{angle:d,scale:a}}}]);return f}(x);b.__decorate([c.property()],g.prototype,"angle",void 0);b.__decorate([c.property()],g.prototype,"initialAngle",void 0);b.__decorate([c.property()],g.prototype,"previousAngle",void 0);b.__decorate([c.property()],g.prototype,"previousScale",void 0);b.__decorate([c.property()],g.prototype,"scale",void 0);b.__decorate([c.property()],g.prototype,"state",null);g=b.__decorate([u.subclass("InteractionState")],g);Object.defineProperties(e,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})});