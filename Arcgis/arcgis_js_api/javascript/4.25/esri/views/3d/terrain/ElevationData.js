// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../core/mathUtils ../../../core/maybe ../../../layers/support/ElevationSamplerData ../support/mathUtils ./TerrainConst".split(" "),function(u,x,z,A,r,y){let B=function(){function p(a,d,e){this.type="elevation";this.level=a[0];this.i=a[1];this.j=a[2];this.extent=d;a=e.noDataValue;const f=e.values;let b=Infinity,c=-Infinity,l=!0,k=!1;for(let g=0;g<f.length;g++){const h=f[g];h!==a?(b=h<b?h:b,c=h>c?h:c,l=!1):k=!0}l&&(c=b=0);c=-3E38<c?c:0;this.samplerData=new A.ElevationSamplerData(e,
d);this.bounds=[b,c];this.hasNoDataValues=k}var t=p.prototype;t.release=function(){this.bounds=this.samplerData=null};t.computeMinMaxValue=function(a,d,e,f){f.min=Infinity;f.max=-Infinity;f.hasNoDataValues=!1;a-=this.level;if(0>=a)return f;var b=2**a;if(Math.floor(d/b)!==this.i||Math.floor(e/b)!==this.j)return f;var c=Infinity,l=-Infinity,k=this.samplerData.width,g=this.samplerData.pixelData,h=.5*y.ELEVATION_NODATA_VALUE;a=(k-1)/b;e=(e-this.j*b)*a;let q=(d-this.i*b)*a;if(1>a){const v=Math.floor(e),
w=Math.floor(q);var m=v+w*k;d=g[m];b=g[m+1];var n=g[m+k];m=g[m+k+1];if(d+b+n+m<h)return c=e-v,h=q-w,l=r.bilerp(d,b,n,m,c,h),k=r.bilerp(d,b,n,m,c+a,h),g=r.bilerp(d,b,n,m,c,h+a),a=r.bilerp(d,b,n,m,c+a,h+a),f.min=Math.min(l,k,g,a),f.max=Math.max(l,k,g,a),f;e=v;q=w;a=1}else e=Math.floor(e),q=Math.floor(q),a=Math.ceil(a);for(d=e;d<=e+a;d++)for(b=q;b<=q+a;b++)n=g[d+b*k],n<h?(c=Math.min(c,n),l=Math.max(l,n)):f.hasNoDataValues=!0;f.min=c;f.max=l;return f};return p}();const C=.5*y.ELEVATION_NODATA_VALUE;u.ElevationData=
B;u.sampleElevation=function(p,t,a){if(z.isNone(a))return null;for(const c of a){if(!c)continue;var d=c.safeWidth;a=x.clamp(c.dy*(c.y1-t),0,d);d=x.clamp(c.dx*(p-c.x0),0,d);const l=Math.floor(a),k=Math.floor(d);var e=c.width,f=l*e+k,b=c.pixelData;const g=b[f],h=b[f+1];f+=e;e=b[f];b=b[f+1];if(g+e+h+b<C)return a-=l,d-=k,p=g+(h-g)*d,p+(e+(b-e)*d-p)*a}return null};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});