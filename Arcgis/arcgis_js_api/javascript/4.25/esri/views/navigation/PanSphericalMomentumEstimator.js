// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../3d/state/utils/navigationUtils ./FilteredFiniteDifference ./FilteredValue ./Momentum".split(" "),function(m,v,w,h,l,r,n,t,p){let u=function(k){function e(a,d,c,f,g,q=0,x){a=k.call(this,a,d,c)||this;a._angularVelocity1=f;a.axis1=g;a.angularVelocity2=q;a.axis2=x;return a}v._inheritsLoose(e,k);var b=e.prototype;b.value1=function(a){return k.prototype.valueFromInitialVelocity.call(this,
this._angularVelocity1,a)};b.value2=function(a){return k.prototype.valueFromInitialVelocity.call(this,this.angularVelocity2,a)};return e}(p.Momentum);p=function(){function k(b=300,a=12,d=.84){this._minimumInitialVelocity=b;this._stopVelocity=a;this._friction=d;this.enabled=!0;this._tmpAxis1=l.create();this._tmpAxis2=l.create();this._tmpAngles=w.create();this._time=new n.FilteredFiniteDifference(.3);this._screen=[new n.FilteredFiniteDifference(.4),new n.FilteredFiniteDifference(.4)];this._angle1=new t.FilteredValue(.6);
this._angle2=new t.FilteredValue(.6);this._axis1=l.create();this._axis2=l.create();this._lastScene=l.create()}var e=k.prototype;e.addMomentumDirectRotation=function(b,a,d,c,f,g){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(d))return;c=r.rotationAngleAndAxisDirectRotation(this._lastScene,a,this._tmpAxis2,c,f,g);this._angle2.update(0);1E-5>h.squaredLength(this._tmpAxis2)?c=0:h.normalize(this._axis1,this._tmpAxis2);this._angle1.update(c);h.copy(this._lastScene,a)}this._screen[0].update(b[0]);
this._screen[1].update(b[1]);this._time.update(d)}};e.addMomentumPreserveHeading=function(b,a,d,c,f,g,q){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(d))return;r.rotationAnglesAndAxesHeadingPreserving(this._lastScene,a,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,c,f,g,q,!1);1E-5>h.squaredLength(this._tmpAxis2)?(this._angle1.update(0),this._angle2.update(0)):(this._angle1.update(this._tmpAngles[1]),this._angle2.update(this._tmpAngles[0]),h.normalize(this._axis1,this._tmpAxis1),
h.normalize(this._axis2,this._tmpAxis2));h.copy(this._lastScene,a)}this._screen[0].update(b[0]);this._screen[1].update(b[1]);this._time.update(d)}};e.reset=function(){this._screen[0].reset();this._screen[1].reset();this._angle1.reset();this._angle2.reset();this._time.reset()};e.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;var b=this._screen[0].filteredDelta,a=this._screen[1].filteredDelta;b=null==b||null==a?null:Math.sqrt(b*b+a*a);a=this._time.filteredDelta;
b=null==b||null==a?0:b/a;return Math.abs(b)<this._minimumInitialVelocity?null:this.createMomentum(b,this._stopVelocity,this._friction)};e.createMomentum=function(b,a,d){const c=this._time.filteredDelta,f=this._angle1.filteredValue,g=this._angle2.filteredValue;return new u(b,a,d,null==c||null==f?0:f/c,this._axis1,null==c||null==g?0:g/c,this._axis2)};return k}();m.PanSphericalMomentum=u;m.PanSphericalMomentumEstimator=p;Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});