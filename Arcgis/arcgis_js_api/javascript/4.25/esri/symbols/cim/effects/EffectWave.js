// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(r,t,p,q,h){let u=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(k,b,a,c){return new x(k,b,a)};return g}();u.instance=null;let x=function(){function g(b,a,c){this._inputGeometries=b;this._height=(void 0!==a.amplitude?a.amplitude:2)*c;this._period=(void 0!==a.period?a.period:3)*c;this._style=a.waveform;0>=
this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new h.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new h.GeometryWalker;this._walker.updateTolerance(c)}var k=g.prototype;k.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(t.isPolyline(b)){const a=this._processGeom(b.paths);if(a.length)return{paths:a}}if(t.isPolygon(b)&&
(b=this._processGeom(b.rings),b.length))return{rings:b};b=this._inputGeometries.next()}return null};k._processGeom=function(b){const a=[];for(const c of b)if(this._walker.init(c,this._pattern))switch(this._style){default:a.push(this._constructCurve(c,!1));break;case q.GeometricEffectWaveform.Square:a.push(this._constructSquare(c));break;case q.GeometricEffectWaveform.Triangle:a.push(this._constructTriangle(c));break;case q.GeometricEffectWaveform.Random:a.push(this._constructCurve(c,!0))}else a.push(c);
return a};k._constructCurve=function(b,a){const c=new p.PathHelper;var e=this._walker.calculatePathLength(b),d=Math.round(e/this._period);0===d&&(d=1);const f=this._period/16,y=1/(16*d+1);e=2*Math.PI*e/(e/d);d=2*Math.PI*Math.random();const z=2*Math.PI*Math.random(),A=2*Math.PI*Math.random(),B=.75-Math.random()/2,C=.75-Math.random()/2,l=new h.Pos;this._walker.curPointAndAngle(l);c.startPath(l.pt);let v=0;for(;;)if(this._walker.nextPointAndAngle(f,l)){const n=v;v+=y;let m;if(a){const w=this._height/
2*(1+.3*Math.sin(B*e*n+d));m=w*Math.sin(e*n+z);m+=w*Math.sin(C*e*n+A);m/=2}else m=.5*this._height*Math.sin(.5*e*n);c.lineTo([l.pt[0]-m*l.sa,l.pt[1]+m*l.ca])}else{c.lineTo(b[b.length-1]);break}return c.path()};k._constructSquare=function(b){const a=new p.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let c=!1;if(this._walker.curPositionIsValid()){const e=new h.Pos;this._walker.curPointAndAngle(e);const d=new h.Pos;if(this._walker.nextPointAndAngle(this._period,
d)){const f=new h.Pos;this._walker.nextPointAndAngle(this._period,f)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),a.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),a.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),a.lineTo([d.pt[0]+this._height/2*d.sa,d.pt[1]-this._height/2*d.ca]),a.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca]),c=!0)}}if(!c){a.lineTo(this._walker.getPathEnd());break}}return a.path()};k._constructTriangle=function(b){const a=new p.PathHelper;
b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let c=!1;if(this._walker.curPositionIsValid()){const e=new h.Pos;this._walker.curPointAndAngle(e);const d=new h.Pos;if(this._walker.nextPointAndAngle(this._period/2,d)){const f=new h.Pos;this._walker.nextPointAndAngle(this._period,f)&&(this._walker.nextPosition(this._period/2)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),a.lineTo([d.pt[0]-this._height/2*d.sa,d.pt[1]+this._height/2*d.ca]),a.lineTo([f.pt[0]+this._height/2*f.sa,
f.pt[1]-this._height/2*f.ca])),c=!0)}}if(!c){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return g}();r.EffectWave=u;Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});