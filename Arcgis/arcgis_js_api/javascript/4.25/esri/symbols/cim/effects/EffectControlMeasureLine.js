// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(Vb,Ja,jb,h){let Wb=function(){function z(){}z.local=function(){null===z.instance&&(z.instance=new z);return z.instance};z.prototype.execute=function(k,c,b,d){return new Hc(k,c,b)};return z}();Wb.instance=null;let Hc=function(){function z(c,b,d){this._defaultPointSize=20;this._inputGeometries=c;this._geomUnitsPerPoint=d;this._rule=b.rule??h.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=
this._defaultPointSize*d}var k=z.prototype;k.next=function(){let c;for(;c=this._inputGeometries.next();){let b;Ja.isPoint(c)?b=this._processGeom([[[c.x,c.y]]]):Ja.isMultipoint(c)?b=this._processGeom([c.points]):Ja.isPolyline(c)?b=this._processGeom(c.paths):Ja.isPolygon(c)&&(b=this._processGeom(c.rings));if(b&&b.length)return{paths:b}}return null};k._clone=function(c){return[c[0],c[1]]};k._mid=function(c,b){return[(c[0]+b[0])/2,(c[1]+b[1])/2]};k._mix=function(c,b,d,e){return[c[0]*b+d[0]*e,c[1]*b+d[1]*
e]};k._add=function(c,b){return[c[0]+b[0],c[1]+b[1]]};k._add2=function(c,b,d){return[c[0]+b,c[1]+d]};k._sub=function(c,b){return[c[0]-b[0],c[1]-b[1]]};k._dist=function(c,b){return Math.sqrt((c[0]-b[0])*(c[0]-b[0])+(c[1]-b[1])*(c[1]-b[1]))};k._norm=function(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])};k._normalize=function(c,b=1){b/=this._norm(c);c[0]*=b;c[1]*=b};k._leftPerpendicular=function(c){const b=c[0];c[0]=-c[1];c[1]=b};k._leftPerp=function(c){return[-c[1],c[0]]};k._rightPerpendicular=function(c){const b=
-c[0];c[0]=c[1];c[1]=b};k._rightPerp=function(c){return[c[1],-c[0]]};k._dotProduct=function(c,b){return c[0]*b[0]+c[1]*b[1]};k._crossProduct=function(c,b){return c[0]*b[1]-c[1]*b[0]};k._rotateDirect=function(c,b,d){const e=c[0]*d+c[1]*b;c[0]=c[0]*b-c[1]*d;c[1]=e};k._makeCtrlPt=function(c){c=[c[0],c[1]];jb.setId(c,1);return c};k._addAngledTicks=function(c,b,d,e){const a=this._sub(d,b);this._normalize(a);var f=this._crossProduct(a,this._sub(e,b));e=0<f?this._rightPerp(a):this._leftPerp(a);f=Math.abs(f)/
2;const l=[];l.push([b[0]+(e[0]-a[0])*f,b[1]+(e[1]-a[1])*f]);l.push(b);l.push(d);l.push([d[0]+(e[0]+a[0])*f,d[1]+(e[1]+a[1])*f]);c.push(l)};k._addBezier2=function(c,b,d,e,a){if(0===a--)c.push(e);else{var f=this._mid(b,d);d=this._mid(d,e);var l=this._mid(f,d);this._addBezier2(c,b,f,l,a);this._addBezier2(c,l,d,e,a)}};k._addBezier3=function(c,b,d,e,a,f){if(0===f--)c.push(a);else{var l=this._mid(b,d),q=this._mid(d,e);e=this._mid(e,a);d=this._mid(l,q);q=this._mid(q,e);var u=this._mid(d,q);this._addBezier3(c,
b,l,d,u,f);this._addBezier3(c,u,q,e,a,f)}};k._add90DegArc=function(c,b,d,e,a){e=a??0<this._crossProduct(this._sub(d,b),this._sub(e,b));a=this._mid(b,d);const f=this._sub(a,b);e?this._leftPerpendicular(f):this._rightPerpendicular(f);a[0]+=f[0];a[1]+=f[1];this._addBezier3(c,b,this._mix(b,.33333,a,.66667),this._mix(d,.33333,a,.66667),d,4)};k._addArrow=function(c,b,d){var e=b[0],a=b[1],f=b[b.length-1],l=this._sub(e,a);this._normalize(l);const q=this._crossProduct(l,this._sub(f,a));a=.5*q;var u=this._leftPerp(l);
const v=[f[0]-u[0]*q,f[1]-u[1]*q];var A=b.length-1;f=[];f.push(d?[-u[0],-u[1]]:u);var p=[-l[0],-l[1]];for(d=1;d<A-1;d++){l=this._sub(b[d+1],b[d]);this._normalize(l);var w=this._dotProduct(l,p);u=this._crossProduct(l,p);w=Math.sqrt((1+w)/2);p=this._sub(l,p);this._normalize(p);p[0]/=w;p[1]/=w;f.push(0>u?[-p[0],-p[1]]:p);p=l}f.push(this._rightPerp(p));for(A=f.length-1;0<A;A--)c.push([b[A][0]+f[A][0]*a,b[A][1]+f[A][1]*a]);c.push([v[0]+f[0][0]*a,v[1]+f[0][1]*a]);c.push([v[0]+f[0][0]*q,v[1]+f[0][1]*q]);
c.push(e);c.push([v[0]-f[0][0]*q,v[1]-f[0][1]*q]);c.push([v[0]-f[0][0]*a,v[1]-f[0][1]*a]);for(e=1;e<f.length;e++)c.push([b[e][0]-f[e][0]*a,b[e][1]-f[e][1]*a])};k._cp2=function(c,b,d){return 2<=c.length?c[1]:this._add2(c[0],b*this._defaultSize,d*this._defaultSize)};k._cp3=function(c,b,d,e){if(3<=c.length)return c[2];d=this._mix(c[0],1-d,b,d);c=this._sub(b,c[0]);this._normalize(c);this._rightPerpendicular(c);return[d[0]+c[0]*e*this._defaultSize,d[1]+c[1]*e*this._defaultSize]};k._arrowPath=function(c){if(2<
c.length)return c;const b=c[0];c=this._cp2(c,-4,0);const d=this._sub(b,c);this._normalize(d);const e=this._rightPerp(d);return[b,c,[b[0]+(e[0]-d[0])*this._defaultSize,b[1]+(e[1]-d[1])*this._defaultSize]]};k._arrowLastSeg=function(c){var b=c[0];const d=this._cp2(c,-4,0);if(3<=c.length)b=c[c.length-1];else{c=this._sub(b,d);this._normalize(c);const e=this._rightPerp(c);b=[b[0]+(e[0]-c[0])*this._defaultSize,b[1]+(e[1]-c[1])*this._defaultSize]}return[d,b]};k._processGeom=function(c){if(!c)return null;
const b=[];for(const d of c){if(!d||0===d.length)continue;const e=d.length;let a=d[0];switch(this._rule){case h.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const f=this._cp2(d,0,-1),l=this._cp3(d,f,.5,4),q=[];q.push(l);q.push(this._mid(a,f));b.push(q);break;case h.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const u=this._cp2(d,0,-1);b.push([u,a]);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const v=this._cp2(d,-4,1),A=this._cp3(d,
v,.882353,-1.94),p=[];p.push(this._mid(v,A));p.push(a);b.push(p);break;case h.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const w=this._cp2(d,-4,1),Ka=this._cp3(d,w,.882353,-1.94),ia=this._sub(Ka,w);let ja;ja=0<this._crossProduct(ia,this._sub(a,w))?this._rightPerp(ja):this._leftPerp(ia);const xa=[];xa.push([w[0]+(ja[0]-ia[0])/3,w[1]+(ja[1]-ia[1])/3]);xa.push(w);xa.push(Ka);xa.push([Ka[0]+(ja[0]+ia[0])/3,Ka[1]+(ja[1]+ia[1])/3]);b.push(xa);break;case h.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const kb=
this._cp2(d,0,-1),ka=this._cp3(d,kb,.5,3),Ic=this._mid(a,kb),R=this._sub(Ic,ka);this._normalize(R);const La=this._crossProduct(R,this._sub(a,ka));this._leftPerpendicular(R);const lb=[];lb.push(a);lb.push([ka[0]+R[0]*La,ka[1]+R[1]*La]);b.push(lb);const mb=[];mb.push([ka[0]-R[0]*La,ka[1]-R[1]*La]);mb.push(kb);b.push(mb);break;case h.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const Xb=this._cp2(d,0,-1),la=this._cp3(d,Xb,.5,3),Jc=this._mid(a,Xb),S=this._sub(Jc,la);this._normalize(S);
const Ma=this._crossProduct(S,this._sub(a,la));this._leftPerpendicular(S);const nb=[];nb.push([la[0]+S[0]*Ma,la[1]+S[1]*Ma]);nb.push([la[0]-S[0]*Ma,la[1]-S[1]*Ma]);b.push(nb);break;case h.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const Na=this._cp2(d,0,-1),T=this._cp3(d,Na,.5,4),B=this._mid(a,Na),U=this._sub(B,T);this._normalize(U);const Oa=this._crossProduct(U,this._sub(a,T));this._leftPerpendicular(U);const ob=[];ob.push([T[0]+U[0]*Oa*.8,T[1]+U[1]*Oa*.8]);ob.push([B[0]+.8*(a[0]-
B[0]),B[1]+.8*(a[1]-B[1])]);b.push(ob);b.push([T,B]);const pb=[];pb.push([T[0]-U[0]*Oa*.8,T[1]-U[1]*Oa*.8]);pb.push([B[0]+.8*(Na[0]-B[0]),B[1]+.8*(Na[1]-B[1])]);b.push(pb);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const ma=this._cp2(d,0,-1),Kc=this._cp3(d,ma,.5,4),qb=this._mid(a,ma);let C=this._sub(ma,a);const rb=Math.cos(Math.PI/18),Lc=Math.sin(Math.PI/18),sb=Math.sqrt((1+rb)/2),Mc=Math.sqrt((1-rb)/2),ya=[];let tb;0<this._crossProduct(C,this._sub(Kc,a))?(ya.push(a),
C=this._sub(a,qb),tb=ma):(ya.push(ma),C=this._sub(ma,qb),tb=a);this._rotateDirect(C,sb,Mc);C[0]/=sb;C[1]/=sb;for(let g=1;18>=g;g++)ya.push(this._add(qb,C)),this._rotateDirect(C,rb,Lc);ya.push(tb);b.push(ya);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const V=this._cp2(d,0,-1),Nc=this._cp3(d,V,1,-1);let I=this._sub(a,V);this._normalize(I);const ub=this._crossProduct(I,this._sub(Nc,V))/2;this._leftPerpendicular(I);const Yb=[V[0]+I[0]*ub,V[1]+I[1]*ub];I=this._sub(V,Yb);
const Oc=Math.cos(Math.PI/18);let vb=Math.sin(Math.PI/18);0<ub&&(vb=-vb);const Zb=[V];for(let g=1;18>=g;g++)this._rotateDirect(I,Oc,vb),Zb.push(this._add(Yb,I));b.push(Zb);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const na=this._cp2(d,0,-2),W=this._cp3(d,na,1,-1);let Pa;if(4<=e)Pa=d[3];else{const g=this._sub(a,na);Pa=this._add(W,g)}const $b=this._dist(na,W)/2/.75,ac=this._sub(na,a);this._normalize(ac,$b);const bc=this._sub(W,Pa);this._normalize(bc,$b);b.push([Pa,W]);const wb=
[this._clone(W)];this._addBezier3(wb,W,this._add(W,bc),this._add(na,ac),na,4);wb.push(a);b.push(wb);break;case h.GeometricEffectControlMeasureLineRule.OpenCircle:const cc=this._cp2(d,-2,0),dc=this._sub(cc,a),Pc=Math.cos(Math.PI/18),Qc=-Math.sin(Math.PI/18),ec=[cc];for(let g=1;33>=g;g++)this._rotateDirect(dc,Pc,Qc),ec.push(this._add(a,dc));b.push(ec);break;case h.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const J=this._cp2(d,0,-1);let X;if(3<=e)X=d[2];else{const g=this._sub(J,a),
m=this._leftPerp(g);X=[a[0]+m[0]-.25*g[0],a[1]+m[1]-.25*g[1]]}let Qa;if(4<=e)Qa=d[3];else{const g=this._mid(a,J),m=this._sub(a,J);this._normalize(m);this._leftPerpendicular(m);const r=this._crossProduct(m,this._sub(X,g));this._rightPerpendicular(m);Qa=[X[0]+m[0]*r*2,X[1]+m[1]*r*2]}const F=this._sub(J,a);let Y,D;Y=0<this._crossProduct(F,this._sub(X,a))?this._rightPerp(F):this._leftPerp(F);D=[];D.push(X);D.push(a);D.push([a[0]+(Y[0]-F[0])/3,a[1]+(Y[1]-F[1])/3]);b.push(D);Y=0<this._crossProduct(F,this._sub(Qa,
J))?this._rightPerp(Y):this._leftPerp(F);D=[];D.push([J[0]+(Y[0]+F[0])/3,J[1]+(Y[1]+F[1])/3]);D.push(J);D.push(Qa);b.push(D);break;case h.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const Ra=this._cp2(d,0,2),xb=this._cp3(d,Ra,0,1);let Sa;if(4<=e)Sa=d[3];else{const g=this._sub(Ra,a);Sa=this._add(xb,g)}this._addAngledTicks(b,a,Ra,this._mid(xb,Sa));this._addAngledTicks(b,xb,Sa,this._mid(a,Ra));break;case h.GeometricEffectControlMeasureLineRule.GapExtentMidline:const yb=this._cp2(d,
2,0),fc=this._cp3(d,yb,0,1);let zb;if(4<=e)zb=d[3];else{const g=this._sub(yb,a);zb=this._add(fc,g)}const Ab=[];Ab.push(this._mid(a,fc));Ab.push(this._mid(yb,zb));b.push(Ab);break;case h.GeometricEffectControlMeasureLineRule.Chevron:const gc=this._cp2(d,-1,-1);let Bb;if(3<=e)Bb=d[2];else{const g=this._sub(gc,a);this._leftPerpendicular(g);Bb=this._add(a,g)}b.push([gc,this._makeCtrlPt(a),Bb]);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const oa=this._cp2(d,0,-2),hc=this._cp3(d,
oa,.5,-1);let n=this._sub(oa,a);const pa=this._norm(n);n[0]/=pa;n[1]/=pa;const Z=this._crossProduct(n,this._sub(hc,a));let qa=this._dotProduct(n,this._sub(hc,a));qa<.05*pa?qa=.05*pa:qa>.95*pa&&(qa=.95*pa);const Ta=[a[0]+n[0]*qa,a[1]+n[1]*qa];this._leftPerpendicular(n);let ra=[];ra.push([Ta[0]-n[0]*Z,Ta[1]-n[1]*Z]);ra.push([Ta[0]+n[0]*Z,Ta[1]+n[1]*Z]);b.push(ra);const ic=[oa[0]+n[0]*Z,oa[1]+n[1]*Z];n=this._sub(oa,ic);const Rc=Math.cos(Math.PI/18);let Cb=Math.sin(Math.PI/18);0>Z&&(Cb=-Cb);ra=[a,oa];
for(let g=1;9>=g;g++)this._rotateDirect(n,Rc,Cb),ra.push(this._add(ic,n));b.push(ra);break;case h.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Db=this._cp2(d,2,0),jc=this._mid(a,Db),kc=this._sub(Db,jc),Sc=Math.cos(Math.PI/18),Tc=Math.sin(Math.PI/18),lc=[a,Db];for(let g=1;18>=g;g++)this._rotateDirect(kc,Sc,Tc),lc.push(this._add(jc,kc));b.push(lc);break;case h.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const aa=this._cp2(d,0,-2),Eb=this._cp3(d,aa,1,-2),ba=this._mid(a,
aa),E=this._sub(Eb,aa);this._normalize(E);const mc=Math.abs(this._crossProduct(E,this._sub(ba,aa)))/2,sa=this._dist(aa,Eb),nc=[aa,a];nc.push([a[0]+E[0]*sa*.5,a[1]+E[1]*sa*.5]);b.push(nc);const ta=[];ta.push([ba[0]-E[0]*mc,ba[1]-E[1]*mc]);ta.push([ba[0]+E[0]*sa*.375,ba[1]+E[1]*sa*.375]);jb.setId(ta[ta.length-1],1);ta.push([ba[0]+E[0]*sa*.75,ba[1]+E[1]*sa*.75]);b.push(ta);b.push([aa,Eb]);break;case h.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const za=this._cp2(d,3,0),Fb=this._cp3(d,za,
.5,-1),Aa=this._sub(Fb,za);this._normalize(Aa);const oc=this._crossProduct(Aa,this._sub(Fb,a));this._leftPerpendicular(Aa);this._addAngledTicks(b,a,za,Fb);this._addAngledTicks(b,this._mix(a,1,Aa,oc),this._mix(za,1,Aa,oc),this._mid(a,za));break;case h.GeometricEffectControlMeasureLineRule.Parallel:const Ba=this._cp2(d,3,0),Uc=this._cp3(d,Ba,.5,-1),Gb=this._sub(Ba,a);this._normalize(Gb);const Ua=this._leftPerp(Gb),Va=this._crossProduct(Gb,this._sub(Uc,a));let Ca=[a,Ba];b.push(Ca);Ca=[];Ca.push([a[0]+
Ua[0]*Va,a[1]+Ua[1]*Va]);Ca.push([Ba[0]+Ua[0]*Va,Ba[1]+Ua[1]*Va]);b.push(Ca);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const Hb=this._cp2(d,3,0),Vc=this._cp3(d,Hb,.5,-1),Wa=this._mid(a,Hb),ca=this._sub(Hb,a);this._normalize(ca);const Xa=this._crossProduct(ca,this._sub(Vc,a));this._leftPerpendicular(ca);const Ib=[];Ib.push([Wa[0]-ca[0]*Xa*.25,Wa[1]-ca[1]*Xa*.25]);Ib.push([Wa[0]+ca[0]*Xa*1.25,Wa[1]+ca[1]*Xa*1.25]);b.push(Ib);break;case h.GeometricEffectControlMeasureLineRule.ParallelOffset:const ua=
this._cp2(d,3,0),Wc=this._cp3(d,ua,.5,-1),x=this._sub(ua,a);this._normalize(x);const K=this._crossProduct(x,this._sub(Wc,a));this._leftPerpendicular(x);const Jb=[];Jb.push([a[0]-x[0]*K,a[1]-x[1]*K]);Jb.push([ua[0]-x[0]*K,ua[1]-x[1]*K]);b.push(Jb);const Kb=[];Kb.push([a[0]+x[0]*K,a[1]+x[1]*K]);Kb.push([ua[0]+x[0]*K,ua[1]+x[1]*K]);b.push(Kb);break;case h.GeometricEffectControlMeasureLineRule.OffsetOpposite:const Ya=this._cp2(d,3,0),Xc=this._cp3(d,Ya,.5,-1),da=this._sub(Ya,a);this._normalize(da);const Za=
this._crossProduct(da,this._sub(Xc,a));this._leftPerpendicular(da);const Lb=[];Lb.push([a[0]-da[0]*Za,a[1]-da[1]*Za]);Lb.push([Ya[0]-da[0]*Za,Ya[1]-da[1]*Za]);b.push(Lb);break;case h.GeometricEffectControlMeasureLineRule.OffsetSame:const $a=this._cp2(d,3,0),Yc=this._cp3(d,$a,.5,-1),ea=this._sub($a,a);this._normalize(ea);const ab=this._crossProduct(ea,this._sub(Yc,a));this._leftPerpendicular(ea);const Mb=[];Mb.push([a[0]+ea[0]*ab,a[1]+ea[1]*ab]);Mb.push([$a[0]+ea[0]*ab,$a[1]+ea[1]*ab]);b.push(Mb);
break;case h.GeometricEffectControlMeasureLineRule.CircleWithArc:let L=this._cp2(d,3,0);const Nb=this._cp3(d,L,.5,-1);let va,bb;if(4<=e)va=d[3],bb=0<this._crossProduct(this._sub(va,L),this._sub(Nb,L));else{va=L;bb=0<this._crossProduct(this._sub(va,a),this._sub(Nb,a));const g=24*this._geomUnitsPerPoint,m=this._sub(va,a);this._normalize(m,g);const r=Math.sqrt(2)/2;this._rotateDirect(m,r,bb?r:-r);L=this._add(a,m)}const pc=this._sub(L,a),Zc=Math.cos(Math.PI/18),$c=Math.sin(Math.PI/18),Da=[L];for(let g=
1;36>=g;g++)this._rotateDirect(pc,Zc,$c),Da.push(this._add(a,pc));this._add90DegArc(Da,L,va,Nb,bb);jb.setId(Da[Da.length-8],1);b.push(Da);break;case h.GeometricEffectControlMeasureLineRule.DoubleJog:let M=this._cp2(d,-3,1),N;N=3<=e?d[2]:this._add(a,this._sub(a,M));let G;if(4<=e)G=d[3];else{const g=a;a=M;G=N;const m=this._dist(a,g),r=this._dist(G,g);let O=30*this._geomUnitsPerPoint;.5*m<O&&(O=.5*m);.5*r<O&&(O=.5*r);M=this._mix(a,O/m,g,(m-O)/m);N=this._mix(G,O/r,g,(r-O)/r)}const qc=this._mid(a,M),rc=
this._mid(G,N),ad=this._dist(a,M),bd=this._dist(N,G);let cb=Math.min(ad,bd)/8;cb=Math.min(cb,24*this._geomUnitsPerPoint);const P=Math.cos(Math.PI/4);let t=this._sub(a,M);this._normalize(t,cb);0<this._crossProduct(t,this._sub(G,M))?this._rotateDirect(t,P,-P):this._rotateDirect(t,P,P);let y=[];y.push(M);y.push(this._add(qc,t));y.push(this._sub(qc,t));y.push(a);b.push(y);t=this._sub(G,N);this._normalize(t,cb);0>this._crossProduct(t,this._sub(a,N))?this._rotateDirect(t,P,P):this._rotateDirect(t,P,-P);
y=[];y.push(N);y.push(this._add(rc,t));y.push(this._sub(rc,t));y.push(G);b.push(y);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const db=this._cp2(d,-4,1),sc=this._cp3(d,db,.882353,-1.94),Ea=this._sub(sc,db);0<this._crossProduct(Ea,this._sub(a,db))?this._rightPerpendicular(Ea):this._leftPerpendicular(Ea);const cd=[Ea[0]/8,Ea[1]/8],dd=this._sub(this._mid(db,sc),cd);b.push([dd,a]);break;case h.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const tc=this._arrowPath(d),
uc=[];let vc=tc.length-2;for(;vc--;)uc.push(tc[vc]);b.push(uc);break;case h.GeometricEffectControlMeasureLineRule.MultivertexArrow:const ed=this._arrowPath(d),wc=[];this._addArrow(wc,ed,!1);b.push(wc);break;case h.GeometricEffectControlMeasureLineRule.CrossedArrow:const fd=this._arrowPath(d),xc=[];this._addArrow(xc,fd,!0);b.push(xc);break;case h.GeometricEffectControlMeasureLineRule.ChevronArrow:const [yc,Fa]=this._arrowLastSeg(d),eb=10*this._geomUnitsPerPoint,fa=this._sub(a,yc);this._normalize(fa);
const zc=this._crossProduct(fa,this._sub(Fa,yc)),Ac=this._leftPerp(fa),Bc=[Fa[0]-Ac[0]*zc*2,Fa[1]-Ac[1]*zc*2],fb=[];fb.push([Fa[0]+fa[0]*eb,Fa[1]+fa[1]*eb]);fb.push(a);fb.push([Bc[0]+fa[0]*eb,Bc[1]+fa[1]*eb]);b.push(fb);break;case h.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Cc,Ob]=this._arrowLastSeg(d),H=this._sub(a,Cc);this._normalize(H);const wa=this._crossProduct(H,this._sub(Ob,Cc));this._leftPerpendicular(H);const Ga=[Ob[0]-H[0]*wa,Ob[1]-H[1]*wa],gb=[];gb.push([Ga[0]+H[0]*
wa*.5,Ga[1]+H[1]*wa*.5]);gb.push(this._mid(Ga,a));gb.push([Ga[0]-H[0]*wa*.5,Ga[1]-H[1]*wa*.5]);b.push(gb);break;case h.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [Pb,Qb]=this._arrowLastSeg(d),Ha=this._sub(a,Pb);this._normalize(Ha);const Dc=this._crossProduct(Ha,this._sub(Qb,Pb));this._leftPerpendicular(Ha);b.push([Pb,[Qb[0]-Ha[0]*Dc,Qb[1]-Ha[1]*Dc]]);break;case h.GeometricEffectControlMeasureLineRule.Arch:const Rb=this._cp2(d,0,-1),hb=this._cp3(d,Rb,.5,1),Ec=this._sub(a,Rb),gd=
this._mix(hb,1,Ec,.55),hd=this._mix(hb,1,Ec,-.55),Sb=[a];this._addBezier2(Sb,a,gd,hb,4);this._addBezier2(Sb,hb,hd,Rb,4);b.push(Sb);break;case h.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const Q=this._cp2(d,-4,1),Ia=this._cp3(d,Q,.882353,-1.94),ha=this._sub(Ia,Q);0<this._crossProduct(ha,this._sub(a,Q))?this._rightPerpendicular(ha):this._leftPerpendicular(ha);const Tb=[ha[0]/8,ha[1]/8],Fc=this._sub(this._mid(Q,Ia),Tb),id=this._sub(this._mix(Q,.75,Ia,.25),Tb),jd=this._sub(this._mix(Q,
.25,Ia,.75),Tb),ib=[Q];this._addBezier2(ib,Q,id,Fc,3);this._addBezier2(ib,Fc,jd,Ia,3);b.push(ib);for(let g=0;8>g;g++){const m=ib[2*g+1],r=[this._clone(m)];r.push(this._add(m,[ha[0]/4,ha[1]/4]));b.push(r)}break;case h.GeometricEffectControlMeasureLineRule.Arc90Degrees:const Ub=this._cp2(d,0,-1),kd=this._cp3(d,Ub,.5,1),Gc=[Ub];this._add90DegArc(Gc,Ub,a,kd);b.push(Gc);break;default:b.push(d)}}return b};return z}();Vb.EffectControlMeasureLine=Wb;Object.defineProperties(Vb,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});