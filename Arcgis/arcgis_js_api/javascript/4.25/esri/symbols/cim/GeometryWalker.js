// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(h,p,m,n){let q=function(){function f(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var e=f.prototype;e.isEmpty=function(){return 0===this._values.length};e.size=function(){return this._values.length};e.init=function(c,a,b=!0){this._setEmpty();if(!c||0===c.length)return!1;for(let d=0;d<c.length;d++){let k=Math.abs(c[d]);b&&1E-7>k&&(k=1E-7);this._values.push(k);this._length+=
k}a&&c.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};e.scale=function(c){const a=this._values?this._values.length:0;for(let b=0;b<a;++b)this._values[b]*=c;this._length*=c;this.extPtGap*=c;this.ctrlPtGap*=c};e.addValue=function(c){this._length+=c;this._values.push(c)};e.firstValue=function(){return this._values[0]};e.lastValue=function(){return this._values[this._values.length-1]};e.nextValue=function(){this._currentValue++;
this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};e.reset=function(){this._currentValue=-1};e.length=function(){return this._length};e._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return f}();h.EndType=void 0;(function(f){f[f.FAIL=0]="FAIL";f[f.END=1]="END";f[f.CONTINUE=2]="CONTINUE"})(h.EndType||(h.EndType={}));let l=function(){function f(){this.reset()}var e=f.prototype;e.reset=
function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};e.isValid=function(){return-1!==this.segment};e.copyTo=function(c){c.segment=this.segment;c.segmentLength=this.segmentLength;c.abscissa=this.abscissa;c.isPathEnd=this.isPathEnd;c.isPartEnd=this.isPartEnd};return f}(),t=function(f){function e(a=0,b=!1){a=f.call(this,a,b)||this;a._tolerance=n.PIXEL_TOLERANCE;a._currentPosition=new l;return a}p._inheritsLoose(e,f);var c=e.prototype;c.updateTolerance=function(a){this._tolerance=
n.PIXEL_TOLERANCE*a};c.init=function(a,b,d=!0){d?(this._patternLength=b.length(),this._partExtPtGap=b.extPtGap,this._partCtrlPtGap=b.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this._setPosAtNextPart()};c.curPositionIsValid=function(){return this._currentPosition.isValid()};c.nextPosition=function(a,b=h.EndType.FAIL){const d=new l;if(!this._nextPosition(a,d,null,b))return!1;d.copyTo(this._currentPosition);
return!0};c.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);const [b,d]=this._getAngle(this._currentPosition);a.ca=b;a.sa=d};c.nextPointAndAngle=function(a,b,d=h.EndType.FAIL){const k=new l;if(!this._nextPosition(a,k,null,d))return!1;k.copyTo(this._currentPosition);b.pt=this._getPoint(k);const [g,r]=this._getAngle(k);b.ca=g;b.sa=r;return!0};c.nextCurve=function(a){if(0===a)return null;const b=[],d=new l;if(!this._nextPosition(a,d,b,h.EndType.END))return null;d.copyTo(this._currentPosition);
return b};c.isPathEnd=function(){return this._currentPosition.isPathEnd};c.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};c._nextPosition=function(a,b,d,k){if(this._currentPosition.isPathEnd)return!1;var g=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(g/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(b);b.abscissa+a*this._partLengthRatio>b.segmentLength+this._tolerance;)if(d&&
(0===d.length&&(0===g?(g=this._path[b.segment],d.push([g[0],g[1]])):d.push(this.getSegCoord2D(this._path,b.segment,g))),g=this._path[b.segment+1],d.push([g[0],g[1]])),g=0,a-=(b.segmentLength-b.abscissa)/this._partLengthRatio,this._partSegCount)b.segment=this._nextSegment(),b.segmentLength=this.calculateSegLength(this._path,b.segment),b.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(k===h.EndType.FAIL)return!1;b.segmentLength=this.calculateSegLength(this._path,b.segment);b.isPartEnd=
!0;k===h.EndType.END?(b.abscissa=b.segmentLength,b.isPathEnd=!0):b.abscissa=b.segmentLength+a;return!0}this._currentPosition.copyTo(b)}b.abscissa+=a*this._partLengthRatio;d&&(0===d.length&&(0===g?(a=this._path[b.segment],d.push([a[0],a[1]])):d.push(this.getSegCoord2D(this._path,b.segment,g))),a=b.abscissa/b.segmentLength,1===a?(a=this._path[b.segment+1],d.push([a[0],a[1]])):d.push(this.getSegCoord2D(this._path,b.segment,a)));!this._partSegCount&&Math.abs(b.abscissa-b.segmentLength)<this._tolerance&&
(b.isPathEnd=this._partIsLast,b.isPartEnd=!0);return!0};c._getPoint=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};c._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};c._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;
if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===m.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var a=this._partSegCount;a;)this._previousSegment(),--a;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,
this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this._getStartPointIndex();this._ctrlPtBegin=1===m.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===m.getId(this._path[a]);if(0<this._patternLength){a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const b=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let d=Math.round((this._partLength-
(a+b))/this._patternLength);0>=d&&(d=0<a+b?0:1);this._partLengthRatio=this._partLength/(a+b+d*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};c._hasNextSegment=function(){return this._seg<this._path.length-2};c._previousSegment=function(){return--this._seg};c._nextSegment=function(){return++this._seg};c._getStartPointIndex=function(){return this._seg};c._getEndPointIndex=function(){return this._seg+1};return e}(n.CurveHelper);h.DashPattern=
q;h.GeometryWalker=t;h.Pos=function(){this.pt=null;this.sa=this.ca=0};Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});