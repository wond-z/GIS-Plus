// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(n,C,p,r,q,h,t,u,v,w,g,x){function y(a,c,e,f,k){var d=a.data;const z=e&&q.isSome(e.portal)?e.portal:t.getDefault(),A={portal:z,url:h.urlToObject(a.baseUrl),origin:"portal-item"};d=d.items.find(b=>b.name===c);if(!d)return Promise.reject(new r("symbolstyleutils:symbol-name-not-found",
`The symbol name '${c}' could not be found`,{symbolName:c}));let l=u.fromJSON(g.symbolUrlFromStyleItem(d,f),A),m=d.thumbnail?.href??null;const B=d.thumbnail&&d.thumbnail.imageData;p.isDevEnvironment()&&(l=p.adjustStaticAGOUrl(l)??"",m=p.adjustStaticAGOUrl(m));const D={portal:z,url:h.urlToObject(h.removeFile(l)),origin:"portal-item"};return g.requestJSON(l,k).then(b=>{b="cimRef"===f?g.makeCIMSymbolRef(b.data):b.data;if((b=v.fromJSON(b,D))&&C.isSymbol3D(b)){if(m){const E=u.fromJSON(m,A);b.thumbnail=
new x.Thumbnail({url:E})}else B&&(b.thumbnail=new x.Thumbnail({url:`data:image/png;base64,${B}`}));a.styleUrl?b.styleOrigin=new w({portal:e.portal,styleUrl:a.styleUrl,name:c}):a.styleName&&(b.styleOrigin=new w({portal:e.portal,styleName:a.styleName,name:c}))}return b})}function F(a,c,e){const f=g.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,a.name),k=q.isSome(c.portal)?c.portal:t.getDefault();return g.requestJSON(f,e).then(d=>{d=g.makeCIMSymbolRef(d.data);return v.fromJSON(d,{portal:k,url:h.urlToObject(h.removeFile(f)),
origin:"portal-item"})})}n.fetchSymbolFromStyle=y;n.resolveWebStyleSymbol=function(a,c,e,f){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?F(a,c,f):g.fetchStyle(a,c,f).then(k=>y(q.unwrapOrThrow(k),a.name,c,e,f)):Promise.reject(new r("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});