// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["exports","./key","./observers","./componentsUtils"],function(g,u,y,p){function l(a){return!(!a||isNaN(Number(a)))}function m(a,b){if(!a)return a;const c=a.toLowerCase().indexOf("e")+1;return c?a.replace(/[eE]*$/g,"").substring(0,c).concat(a.slice(c).replace(/[eE]/g,"")).split(/[eE]/).map((e,f)=>1===f?b(e.replace(/\./g,"")):b(e)).join("e").replace(/^e/,"1e"):b(a)}function z(a){return u.numberKeys.some(b=>a.includes(b))}function A(a){if(-1<q.indexOf(a))return a;if(!a)return"en";a=a.toLowerCase();
if("nb"===a)return"no";a.includes("-")&&(a=a.replace(/(\w+)-(\w+)/,(b,c,e)=>`${c}-${e.toUpperCase()}`),q.includes(a)||(a=a.split("-")[0]));return q.includes(a)?a:"en"}function v(a){var b;var c=a.el.lang||a.locale||(null===(b=p.closestElementCrossShadowBoundary(a.el,"[lang]"))||void 0===b?void 0:b.lang)||document.documentElement.lang||"en";a.effectiveLocale=c}class d{constructor(a){if(a instanceof d)return a;const [b,c]=String(a).split(".").concat("");this.value=BigInt(b+c.padEnd(d.DECIMALS,"0").slice(0,
d.DECIMALS))+BigInt(d.ROUNDED&&"5"<=c[d.DECIMALS]);this.isNegative="-"===a.charAt(0)}static _divRound(a,b){return d.fromBigInt(a/b+(d.ROUNDED?a*BigInt(2)/b%BigInt(2):BigInt(0)))}static fromBigInt(a){return Object.assign(Object.create(d.prototype),{value:a})}toString(){var a=this.value.toString().replace(RegExp("-","g"),"").padStart(d.DECIMALS+1,"0"),b=a.slice(0,-d.DECIMALS);a=a.slice(-d.DECIMALS).replace(/\.?0+$/,"");b=b.concat(a.length?"."+a:"");return`${this.isNegative?"-":""}${b}`}formatToParts(a){var b=
this.value.toString().replace(RegExp("-","g"),"").padStart(d.DECIMALS+1,"0");const c=b.slice(0,-d.DECIMALS);b=b.slice(-d.DECIMALS).replace(/\.?0+$/,"");const e=a.formatToParts(BigInt(c));this.isNegative&&e.unshift({type:"minusSign",value:h.minusSign});b.length&&(e.push({type:"decimal",value:h.decimal}),b.split("").forEach(f=>e.push({type:"fraction",value:f})));return e}format(a){var b=this.value.toString().replace(RegExp("-","g"),"").padStart(d.DECIMALS+1,"0"),c=b.slice(0,-d.DECIMALS);b=b.slice(-d.DECIMALS).replace(/\.?0+$/,
"");c=`${this.isNegative?h.minusSign:""}${a.format(BigInt(c))}`;a=b.length?`${h.decimal}${a.format(BigInt(b))}`:"";return`${c}${a}`}add(a){return d.fromBigInt(this.value+(new d(a)).value)}subtract(a){return d.fromBigInt(this.value-(new d(a)).value)}multiply(a){return d._divRound(this.value*(new d(a)).value,d.SHIFT)}divide(a){return d._divRound(this.value*d.SHIFT,(new d(a)).value)}}d.DECIMALS=100;d.ROUNDED=!0;d.SHIFT=BigInt("1"+"0".repeat(d.DECIMALS));const B=/^([-0])0+(?=\d)/,C=/(?!^\.)\.$/,D=/(?!^-)-/g,
E=/^-\b0\b\.?0*$/,q="ar bg bs ca cs da de de-CH el en en-AU en-CA en-GB es es-MX et fi fr fr-CH he hi hr hu id it it-CH ja ko lt lv mk nb nl pl pt pt-PT ro ru sk sl sr sv th tr uk vi zh-CN zh-HK zh-TW".split(" "),w="arab arabext bali beng deva fullwide gujr guru hanidec khmr knda laoo latn limb mlym mong mymr orya tamldec telu thai tibt".split(" "),r=(new Intl.NumberFormat).resolvedOptions().numberingSystem,t="arab"!==r&&w.includes(r)?r:"latn",F=a=>w.includes(a)?a:t,k=new Set,x=y.createObserver("mutation",
a=>{a.forEach(b=>{const c=b.target;k.forEach(e=>{var f=!(!e.locale||e.el.lang),n=!p.containsCrossShadowBoundary(c,e.el);f||n||((f=p.closestElementCrossShadowBoundary(e.el,"[lang]"))?(n=f.lang,e.effectiveLocale=f.hasAttribute("lang")&&""===n?"en":n):e.effectiveLocale="en")})})});class G{constructor(){this.delocalize=a=>this._numberFormatOptions?m(a,b=>b.trim().replace(new RegExp(`[${this._minusSign}]`,"g"),"-").replace(new RegExp(`[${this._group}]`,"g"),"").replace(new RegExp(`[${this._decimal}]`,
"g"),".").replace(new RegExp(`[${this._digits.join("")}]`,"g"),this._getDigitIndex)):a;this.localize=a=>this._numberFormatOptions?m(a,b=>l(b.trim())?(new d(b.trim())).format(this._numberFormatter).replace(new RegExp(`[${this._actualGroup}]`,"g"),this._group):b):a}get group(){return this._group}get decimal(){return this._decimal}get minusSign(){return this._minusSign}get digits(){return this._digits}get numberFormatter(){return this._numberFormatter}get numberFormatOptions(){return this._numberFormatOptions}set numberFormatOptions(a){a.locale=
A(null===a||void 0===a?void 0:a.locale);a.numberingSystem=F(null===a||void 0===a?void 0:a.numberingSystem);if((this._numberFormatOptions||"en"!==a.locale||a.numberingSystem!==t||2!==Object.keys(a).length)&&JSON.stringify(this._numberFormatOptions)!==JSON.stringify(a)){this._numberFormatOptions=a;this._numberFormatter=new Intl.NumberFormat(this._numberFormatOptions.locale,this._numberFormatOptions);this._digits=[...(new Intl.NumberFormat(this._numberFormatOptions.locale,{useGrouping:!1,numberingSystem:this._numberFormatOptions.numberingSystem})).format(9876543210)].reverse();
var b=new Map(this._digits.map((c,e)=>[c,e]));a=(new Intl.NumberFormat(this._numberFormatOptions.locale)).formatToParts(-1.23456789E7);this._actualGroup=a.find(c=>"group"===c.type).value;this._group=0===this._actualGroup.trim().length?" ":this._actualGroup;this._decimal=a.find(c=>"decimal"===c.type).value;this._minusSign=a.find(c=>"minusSign"===c.type).value;this._getDigitIndex=c=>b.get(c)}}}const h=new G;g.clamp=(a,b,c)=>Math.max(b,Math.min(a,c));g.connectLocalized=function(a){v(a);0===k.size&&x.observe(document.documentElement,
{attributes:!0,attributeFilter:["lang"],subtree:!0});k.add(a)};g.decimalPlaces=a=>(a=(""+a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(a[1]?a[1].length:0)-(a[2]?+a[2]:0)):0;g.defaultNumberingSystem=t;g.disconnectLocalized=function(a){k.delete(a);0===k.size&&x.disconnect()};g.isValidNumber=l;g.numberStringFormatter=h;g.parseNumberString=function(a){return a&&z(a)?m(a,b=>{let c=!1;b=b.split("").filter((e,f)=>e.match(/\./g)&&!c?c=!0:e.match(/\-/g)&&0===f?!0:u.numberKeys.includes(e)).reduce((e,
f)=>e+f);return l(b)?(new d(b)).toString():""}):""};g.sanitizeNumberString=a=>m(a,b=>{const c=b.replace(D,"").replace(C,"").replace(B,"$1");return l(c)?E.test(c)?c:(new d(c)).toString():b});g.updateEffectiveLocale=v});