// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ./componentsUtils ./key ./action ./icon ./loader ./popover".split(" "),function(h,e,p,q,r,t,u){function m(){"undefined"!==typeof customElements&&["calcite-action-menu","calcite-action","calcite-icon","calcite-loader","calcite-popover"].forEach(a=>{switch(a){case "calcite-action-menu":customElements.get(a)||customElements.define(a,n);break;case "calcite-action":customElements.get(a)||q.defineCustomElement();break;case "calcite-icon":customElements.get(a)||r.defineCustomElement();break;
case "calcite-loader":customElements.get(a)||t.defineCustomElement();break;case "calcite-popover":customElements.get(a)||u.defineCustomElement()}})}const k={tooltip:"tooltip",trigger:"trigger"},v=["ArrowUp","ArrowDown","End","Home"],n=e.proxyCustomElement(class extends e.H{constructor(){super();this.__registerHost();this.__attachShadow();this.calciteActionMenuOpenChange=e.createEvent(this,"calciteActionMenuOpenChange",6);this.open=this.expanded=!1;this.overlayPositioning="absolute";this.placement=
"auto";this.actionElements=[];this.guid=`calcite-action-menu-${e.guid()}`;this.menuId=`${this.guid}-menu`;this.menuButtonId=`${this.guid}-menu-button`;this.activeMenuItemIndex=-1;this.connectMenuButtonEl=()=>{const {menuButtonId:a,menuId:b,open:d,label:f}=this,c=this.slottedMenuButtonEl||this.defaultMenuButtonEl;this.menuButtonEl!==c&&(this.disconnectMenuButtonEl(),this.menuButtonEl=c,this.setTooltipReferenceElement(),c&&(c.active=d,c.setAttribute("aria-controls",b),c.setAttribute("aria-expanded",
e.toAriaBoolean(d)),c.setAttribute("aria-haspopup","true"),c.id||(c.id=a),c.label||(c.label=f),c.text||(c.text=f),c.addEventListener("pointerdown",this.menuButtonClick),c.addEventListener("keydown",this.menuButtonKeyDown)))};this.disconnectMenuButtonEl=()=>{const {menuButtonEl:a}=this;a&&(a.removeEventListener("pointerdown",this.menuButtonClick),a.removeEventListener("keydown",this.menuButtonKeyDown))};this.setMenuButtonEl=a=>{this.slottedMenuButtonEl=a.target.assignedElements({flatten:!0}).filter(b=>
null===b||void 0===b?void 0:b.matches("calcite-action"))[0];this.connectMenuButtonEl()};this.setDefaultMenuButtonEl=a=>{this.defaultMenuButtonEl=a;this.connectMenuButtonEl()};this.handleCalciteActionClick=()=>{this.open=!1;this.setFocus()};this.menuButtonClick=a=>{e.isPrimaryPointerButton(a)&&this.toggleOpen()};this.updateTooltip=a=>{this.tooltipEl=a.target.assignedElements({flatten:!0}).filter(b=>null===b||void 0===b?void 0:b.matches("calcite-tooltip"))[0];this.setTooltipReferenceElement()};this.setTooltipReferenceElement=
()=>{const {tooltipEl:a,expanded:b,menuButtonEl:d,open:f}=this;a&&(a.referenceElement=b||f?null:d)};this.updateAction=(a,b)=>{const {guid:d,activeMenuItemIndex:f}=this,c=`${d}-action-${b}`;a.tabIndex=-1;a.setAttribute("role","menuitem");a.id||(a.id=c);a.active=b===f};this.updateActions=a=>{null===a||void 0===a?void 0:a.forEach(this.updateAction)};this.handleDefaultSlotChange=a=>{this.actionElements=a.target.assignedElements({flatten:!0}).filter(b=>null===b||void 0===b?void 0:b.matches("calcite-action"))};
this.menuButtonKeyDown=a=>{const {key:b}=a,{actionElements:d,activeMenuItemIndex:f,open:c}=this;if(d.length){if(p.isActivationKey(b)){a.preventDefault();if(!c){this.toggleOpen();return}const g=d[f];g?g.click():this.toggleOpen(!1)}"Tab"===b?this.open=!1:"Escape"===b?(this.toggleOpen(!1),a.preventDefault()):this.handleActionNavigation(a,b,d)}};this.handleActionNavigation=(a,b,d)=>{if(this.isValidKey(b,v))if(a.preventDefault(),this.open){"Home"===b&&(this.activeMenuItemIndex=0);"End"===b&&(this.activeMenuItemIndex=
d.length-1);a=this.activeMenuItemIndex;if("ArrowUp"===b){var f=d.length;this.activeMenuItemIndex=(Math.max(a-1,-1)+f)%f}"ArrowDown"===b&&(b=d.length,this.activeMenuItemIndex=(a+1+b)%b)}else{this.toggleOpen();if("Home"===b||"ArrowDown"===b)this.activeMenuItemIndex=0;if("End"===b||"ArrowUp"===b)this.activeMenuItemIndex=d.length-1}};this.toggleOpenEnd=()=>{this.setFocus();this.el.removeEventListener("calcitePopoverOpen",this.toggleOpenEnd)};this.toggleOpen=(a=!this.open)=>{this.el.addEventListener("calcitePopoverOpen",
this.toggleOpenEnd);this.open=a}}disconnectedCallback(){this.disconnectMenuButtonEl()}expandedHandler(){this.open=!1;this.setTooltipReferenceElement()}openHandler(a){this.activeMenuItemIndex=this.open?0:-1;this.menuButtonEl&&(this.menuButtonEl.active=a);this.calciteActionMenuOpenChange.emit(a);this.setTooltipReferenceElement()}closeCalciteActionMenuOnClick(a){e.isPrimaryPointerButton(a)&&!a.composedPath().includes(this.el)&&(this.open=!1)}activeMenuItemIndexHandler(){this.updateActions(this.actionElements)}async setFocus(){e.focusElement(this.menuButtonEl)}renderMenuButton(){const {label:a,
scale:b,expanded:d}=this;return e.h("slot",{name:k.trigger,onSlotchange:this.setMenuButtonEl},e.h("calcite-action",{class:"default-trigger",icon:"ellipsis",ref:this.setDefaultMenuButtonEl,scale:b,text:a,textEnabled:d}))}renderMenuItems(){const {actionElements:a,activeMenuItemIndex:b,open:d,menuId:f,menuButtonEl:c,label:g,placement:w,overlayPositioning:x,flipPlacements:y}=this,l=a[b];return e.h("calcite-popover",{disablePointer:!0,flipPlacements:y,label:g,offsetDistance:0,open:d,overlayPositioning:x,
placement:w,referenceElement:c},e.h("div",{"aria-activedescendant":(null===l||void 0===l?void 0:l.id)||null,"aria-labelledby":null===c||void 0===c?void 0:c.id,class:"menu",id:f,onClick:this.handleCalciteActionClick,role:"menu",tabIndex:-1},e.h("slot",{onSlotchange:this.handleDefaultSlotChange})))}render(){return e.h(e.Fragment,null,this.renderMenuButton(),this.renderMenuItems(),e.h("slot",{name:k.tooltip,onSlotchange:this.updateTooltip}))}isValidKey(a,b){return!!b.find(d=>d===a)}get el(){return this}static get watchers(){return{expanded:["expandedHandler"],
open:["openHandler"],activeMenuItemIndex:["activeMenuItemIndexHandler"]}}static get style(){return"@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0.01}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{box-sizing:border-box;display:flex;flex-direction:column;background-color:var(--calcite-ui-foreground-1);font-size:var(--calcite-font-size-1);color:var(--calcite-ui-text-2)}.menu ::slotted(calcite-action){margin:0.125rem;display:flex;outline-color:transparent}.menu ::slotted(calcite-action[active]){outline:2px solid var(--calcite-ui-brand);outline-offset:0px}.default-trigger{position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}slot[name\x3dtrigger]::slotted(calcite-action),calcite-action::slotted([slot\x3dtrigger]){position:relative;block-size:100%;flex:0 1 auto;align-self:stretch}.menu{flex-direction:column;flex-wrap:nowrap;outline:2px solid transparent;outline-offset:2px}"}},
[1,"calcite-action-menu",{expanded:[516],flipPlacements:[16],label:[1],open:[1540],overlayPositioning:[513,"overlay-positioning"],placement:[513],scale:[513],menuButtonEl:[32],activeMenuItemIndex:[32],setFocus:[64]},[[9,"pointerdown","closeCalciteActionMenuOnClick"]]]);m();h.ActionMenu=n;h.SLOTS=k;h.defineCustomElement=m});