// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define(["require","exports","./componentsUtils","./debounce"],function(Ea,B,X,Y){function I(a){return a.split("-")[0]}function J(a){return a.split("-")[1]}function L(a){return["top","bottom"].includes(I(a))?"x":"y"}function Z(a){return"y"===a?"height":"width"}function ja(a,b,c){let {reference:d,floating:e}=a;var f=d.x+d.width/2-e.width/2;const g=d.y+d.height/2-e.height/2;a=L(b);var h=Z(a);h=d[h]/2-e[h]/2;const l=I(b),k="x"===a;switch(l){case "top":f={x:f,y:d.y-e.height};break;case "bottom":f={x:f,
y:d.y+d.height};break;case "right":f={x:d.x+d.width,y:g};break;case "left":f={x:d.x-e.width,y:g};break;default:f={x:d.x,y:d.y}}switch(J(b)){case "start":f[a]-=h*(c&&k?-1:1);break;case "end":f[a]+=h*(c&&k?-1:1)}return f}function ka(a){return"number"!==typeof a?{top:0,right:0,bottom:0,left:0,...a}:{top:a,right:a,bottom:a,left:a}}function M(a){return{...a,top:a.y,left:a.x,right:a.x+a.width,bottom:a.y+a.height}}async function N(a,b){var c;void 0===b&&(b={});const {x:d,y:e,platform:f,rects:g,elements:h,
strategy:l}=a,{boundary:k="clippingAncestors",rootBoundary:m="viewport",elementContext:n="floating",altBoundary:t=!1,padding:p=0}=b;a=ka(p);const q=h[t?"floating"===n?"reference":"floating":n];b=M(await f.getClippingRect({element:(null!=(c=await (null==f.isElement?void 0:f.isElement(q)))?c:1)?q:q.contextElement||await (null==f.getDocumentElement?void 0:f.getDocumentElement(h.floating)),boundary:k,rootBoundary:m,strategy:l}));c=M(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===
n?{...g.floating,x:d,y:e}:g.reference,offsetParent:await (null==f.getOffsetParent?void 0:f.getOffsetParent(h.floating)),strategy:l}):g[n]);return{top:b.top-c.top+a.top,bottom:c.bottom-b.bottom+a.bottom,left:b.left-c.left+a.left,right:c.right-b.right+a.right}}function R(a){return a.replace(/left|right|bottom|top/g,b=>Fa[b])}function la(a,b,c){void 0===c&&(c=!1);const d=J(a),e=L(a);a=Z(e);c="x"===e?d===(c?"end":"start")?"right":"left":"start"===d?"bottom":"top";b.reference[a]>b.floating[a]&&(c=R(c));
return{main:c,cross:R(c)}}function aa(a){return a.replace(/start|end/g,b=>Ga[b])}function Ha(a,b,c){return(a?[...c.filter(d=>J(d)===a),...c.filter(d=>J(d)!==a)]:c.filter(d=>I(d)===d)).filter(d=>a?J(d)===a||(b?aa(d)!==d:!1):!0)}function Ia(a){const b=R(a);return[aa(a),b,aa(b)]}function ma(a,b){return{top:a.top-b.height,right:a.right-b.width,bottom:a.bottom-b.height,left:a.left-b.width}}function na(a){return oa.some(b=>0<=a[b])}async function Ja(a,b){const {placement:c,platform:d,elements:e}=a;var f=
await (null==d.isRTL?void 0:d.isRTL(e.floating)),g=I(c);const h=J(c),l="x"===L(c);g=["left","top"].includes(g)?-1:1;f=f&&l?-1:1;a="function"===typeof b?b(a):b;let {mainAxis:k,crossAxis:m,alignmentAxis:n}="number"===typeof a?{mainAxis:a,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...a};h&&"number"===typeof n&&(m="end"===h?-1*n:n);return l?{x:m*f,y:k*g}:{x:k*g,y:m*f}}function C(a){return null==a?window:a&&a.document&&a.location&&a.alert&&a.setInterval?a:(a=a.ownerDocument)?
a.defaultView||window:window}function F(a){return C(a).getComputedStyle(a)}function G(a){return a&&a.document&&a.location&&a.alert&&a.setInterval?"":a?(a.nodeName||"").toLowerCase():""}function pa(){const a=navigator.userAgentData;return null!=a&&a.brands?a.brands.map(b=>b.brand+"/"+b.version).join(" "):navigator.userAgent}function z(a){return a instanceof C(a).HTMLElement}function D(a){return a instanceof C(a).Element}function O(a){if("undefined"===typeof ShadowRoot)return!1;const b=C(a).ShadowRoot;
return a instanceof b||a instanceof ShadowRoot}function P(a){const {overflow:b,overflowX:c,overflowY:d,display:e}=F(a);return/auto|scroll|overlay|hidden/.test(b+d+c)&&!["inline","contents"].includes(e)}function qa(a){const b=/firefox/i.test(pa()),c=F(a);return"none"!==c.transform||"none"!==c.perspective||b&&"filter"===c.willChange||b&&(c.filter?"none"!==c.filter:!1)||["transform","perspective"].some(d=>c.willChange.includes(d))||["paint","layout","strict","content"].some(d=>{const e=c.contain;return null!=
e?e.includes(d):!1})}function ra(){return!/^((?!chrome|android).)*safari/i.test(pa())}function ba(a){return["html","body","#document"].includes(G(a))}function E(a,b,c){var d,e,f,g;void 0===b&&(b=!1);void 0===c&&(c=!1);var h=a.getBoundingClientRect();let l=1,k=1;b&&z(a)&&(l=0<a.offsetWidth?S(h.width)/a.offsetWidth||1:1,k=0<a.offsetHeight?S(h.height)/a.offsetHeight||1:1);a=D(a)?C(a):window;b=!ra()&&c;c=(h.left+(b?null!=(d=null==(e=a.visualViewport)?void 0:e.offsetLeft)?d:0:0))/l;d=(h.top+(b?null!=(f=
null==(g=a.visualViewport)?void 0:g.offsetTop)?f:0:0))/k;f=h.width/l;h=h.height/k;return{width:f,height:h,top:d,right:c+f,bottom:d+h,left:c,x:c,y:d}}function H(a){return((a instanceof C(a).Node?a.ownerDocument:a.document)||window.document).documentElement}function T(a){return D(a)?{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}:{scrollLeft:a.pageXOffset,scrollTop:a.pageYOffset}}function sa(a){return E(H(a)).left+T(a).scrollLeft}function ca(a){return"html"===G(a)?a:a.assignedSlot||a.parentNode||(O(a)?
a.host:null)||H(a)}function ta(a){return z(a)&&"fixed"!==F(a).position?a.offsetParent:null}function da(a){const b=C(a);for(var c=ta(a);c&&["table","td","th"].includes(G(c))&&"static"===F(c).position;)c=ta(c);if(c&&("html"===G(c)||"body"===G(c)&&"static"===F(c).position&&!qa(c)))return b;if(!c)a:{a=ca(a);O(a)&&(a=a.host);for(;z(a)&&!ba(a);)if(qa(a)){c=a;break a}else a=a.parentNode,a=O(a)?a.host:a;c=null}return c||b}function ua(a){if(z(a))return{width:a.offsetWidth,height:a.offsetHeight};a=E(a);return{width:a.width,
height:a.height}}function va(a){const b=ca(a);return ba(b)?a.ownerDocument.body:z(b)&&P(b)?b:va(b)}function U(a,b){var c;void 0===b&&(b=[]);var d=va(a);a=d===(null==(c=a.ownerDocument)?void 0:c.body);c=C(d);d=a?[c].concat(c.visualViewport||[],P(d)?d:[]):d;b=b.concat(d);return a?b:b.concat(U(d))}function Ka(a,b){for(;!(!a||ba(a)||b.includes(a)||D(a)&&["absolute","fixed"].includes(F(a).position));)a=ca(a),a=O(a)?a.host:a;return a}function wa(a,b,c){if("viewport"===b){b=C(a);a=H(a);b=b.visualViewport;
var d=a.clientWidth;a=a.clientHeight;var e=0,f=0;if(b){d=b.width;a=b.height;const g=ra();if(g||!g&&"fixed"===c)e=b.offsetLeft,f=b.offsetTop}return M({width:d,height:a,x:e,y:f})}if(D(b))return d=E(b,!1,"fixed"===c),c=d.top+b.clientTop,d=d.left+b.clientLeft,{top:c,left:d,x:d,y:c,right:d+b.clientWidth,bottom:c+b.clientHeight,width:b.clientWidth,height:b.clientHeight};f=H(a);c=H(f);a=T(f);b=null==(d=f.ownerDocument)?void 0:d.body;d=Q(c.scrollWidth,c.clientWidth,b?b.scrollWidth:0,b?b.clientWidth:0);e=
Q(c.scrollHeight,c.clientHeight,b?b.scrollHeight:0,b?b.clientHeight:0);f=-a.scrollLeft+sa(f);a=-a.scrollTop;"rtl"===F(b||c).direction&&(f+=Q(c.clientWidth,b?b.clientWidth:0)-d);return M({width:d,height:e,x:f,y:a})}function La(a){const b=U(a);a=Ka(a,b);let c=null;if(a&&z(a)){const d=da(a);P(a)?c=a:z(d)&&(c=d)}return D(c)?b.filter(d=>{var e;if(e=c&&D(d))a:{e=c;const f=null==e.getRootNode?void 0:e.getRootNode();if(d.contains(e))e=!0;else{if(f&&O(f)){do{if(e&&d===e){e=!0;break a}e=e.parentNode||e.host}while(e)
}e=!1}}return e&&"body"!==G(d)}):[]}function Ma(a,b,c,d){function e(){const q=E(a);!p||q.x===p.x&&q.y===p.y&&q.width===p.width&&q.height===p.height||c();p=q;t=requestAnimationFrame(e)}void 0===d&&(d={});const {ancestorScroll:f=!0,ancestorResize:g=!0,elementResize:h=!0,animationFrame:l=!1}=d,k=f&&!l,m=k||g?[...(D(a)?U(a):[]),...U(b)]:[];m.forEach(q=>{k&&q.addEventListener("scroll",c,{passive:!0});g&&q.addEventListener("resize",c)});let n=null;if(h){let q=!0;n=new ResizeObserver(()=>{q||c();q=!1});
D(a)&&!l&&n.observe(a);n.observe(b)}let t,p=l?E(a):null;l&&e();c();return()=>{var q;m.forEach(u=>{k&&u.removeEventListener("scroll",c);g&&u.removeEventListener("resize",c)});null==(q=n)?void 0:q.disconnect();n=null;l&&cancelAnimationFrame(t)}}function Na({placement:a,disableFlip:b,flipPlacements:c,offsetDistance:d,offsetSkidding:e,arrowEl:f,type:g}){const h=[Oa(),Pa()];return"menu"===g?[...h,xa({fallbackPlacements:c||"top-start top top-end bottom-start bottom bottom-end".split(" ")})]:"popover"===
g||"tooltip"===g?(d=[...h,Qa({mainAxis:"number"===typeof d?d:0,crossAxis:"number"===typeof e?e:0})],"auto"===a||"auto-start"===a||"auto-end"===a?d.push(Ra({alignment:"auto-start"===a?"start":"auto-end"===a?"end":null})):b||d.push(xa(c?{fallbackPlacements:c}:{})),f&&d.push(Sa({element:f})),d):[]}async function ya({referenceEl:a,floatingEl:b,overlayPositioning:c="absolute",placement:d,disableFlip:e,flipPlacements:f,offsetDistance:g,offsetSkidding:h,includeArrow:l=!1,arrowEl:k,type:m}){if(!a||!b||l&&
!k)return null;await Ta;"auto"===d||"auto-start"===d||"auto-end"===d?l=void 0:(l=["left","right"],"rtl"===X.getElementDir(b)&&l.reverse(),l=d.replace(/-leading/gi,"-start").replace(/-trailing/gi,"-end").replace(/leading/gi,l[0]).replace(/trailing/gi,l[1]));c={strategy:c,placement:l,middleware:Na({placement:d,disableFlip:e,flipPlacements:f,offsetDistance:g,offsetSkidding:h,arrowEl:k,type:m})};a=Ua(a,b,{platform:V,...c});const {x:n,y:t,placement:p,strategy:q,middlewareData:u}=await a;if(null===u||void 0===
u?0:u.arrow){const {x:y,y:v}=u.arrow;Object.assign(k.style,{left:null!=y?`${y}px`:"",top:null!=v?`${v}px`:""})}var w=(k=(null===(w=null===u||void 0===u?void 0:u.hide)||void 0===w?0:w.referenceHidden)?"hidden":null)?"none":null;b.setAttribute("data-placement",p);Object.assign(b.style,{visibility:k,pointerEvents:w,position:q,top:"0",left:"0",transform:`translate(${Math.round(n)}px,${Math.round(t)}px)`})}function za(a,b,c){c&&b&&((c.shadowRoot||c).removeEventListener("transitionend",ea),(b=fa.get(a))&&
b(),fa.delete(a))}function ea(a){const b=a.target;"opacity"===a.propertyName&&b.classList.contains(Aa.animation)&&(a=X.closestElementCrossShadowBoundary(b,"[data-placement]"),Ba(a),(a.shadowRoot||a).removeEventListener("transitionend",ea))}function Ba(a){a.style.transform="";a.style.top="-99999px";a.style.left="-99999px"}const Ua=async(a,b,c)=>{const {placement:d="bottom",strategy:e="absolute",middleware:f=[],platform:g}=c;c=await (null==g.isRTL?void 0:g.isRTL(b));let h=await g.getElementRects({reference:a,
floating:b,strategy:e}),{x:l,y:k}=ja(h,d,c),m=d,n={},t=0;for(let p=0;p<f.length;p++){const {name:q,fn:u}=f[p],{x:w,y,data:v,reset:r}=await u({x:l,y:k,initialPlacement:d,placement:m,strategy:e,middlewareData:n,rects:h,platform:g,elements:{reference:a,floating:b}});l=null!=w?w:l;k=null!=y?y:k;n={...n,[q]:{...n[q],...v}};r&&50>=t&&(t++,"object"===typeof r&&(r.placement&&(m=r.placement),r.rects&&(h=!0===r.rects?await g.getElementRects({reference:a,floating:b,strategy:e}):r.rects),{x:l,y:k}=ja(h,m,c)),
p=-1)}return{x:l,y:k,placement:m,strategy:e,middlewareData:n}},ha=Math.min,ia=Math.max,Sa=a=>({name:"arrow",options:a,async fn(b){const {element:c,padding:d=0}=null!=a?a:{},{x:e,y:f,placement:g,rects:h,platform:l}=b;if(null==c)return{};b=ka(d);const k={x:e,y:f},m=L(g),n=J(g),t=Z(m);var p=await l.getDimensions(c);const q="y"===m?"top":"left",u="y"===m?"bottom":"right";var w=h.reference[t]+h.reference[m]-k[m]-h.floating[t];const y=k[m]-h.reference[m];var v=await (null==l.getOffsetParent?void 0:l.getOffsetParent(c));
let r=v?"y"===m?v.clientHeight||0:v.clientWidth||0:0;0===r&&(r=h.floating[t]);v=b[q];const K=r-p[t]-b[u];p=r/2-p[t]/2+(w/2-y/2);w=ia(v,ha(p,K));return{[m]:k[m]-(0<("start"===n?b[q]:b[u])&&p!==w&&h.reference[t]<=h.floating[t]?p<v?v-p:K-p:0),data:{[m]:w,centerOffset:p-w}}}}),Fa={left:"right",right:"left",bottom:"top",top:"bottom"},Ga={start:"end",end:"start"},oa=["top","right","bottom","left"],Va=oa.reduce((a,b)=>a.concat(b,b+"-start",b+"-end"),[]),Ra=function(a){void 0===a&&(a={});return{name:"autoPlacement",
options:a,async fn(b){var c,d,e,f,g;const {x:h,y:l,rects:k,middlewareData:m,placement:n,platform:t,elements:p}=b,{alignment:q=null,allowedPlacements:u=Va,autoAlignment:w=!0,...y}=a,v=Ha(q,w,u);var r=await N(b,y);b=null!=(c=null==(d=m.autoPlacement)?void 0:d.index)?c:0;d=v[b];if(null==d)return{};const {main:K,cross:W}=la(d,k,await (null==t.isRTL?void 0:t.isRTL(p.floating)));if(n!==d)return{x:h,y:l,reset:{placement:v[0]}};r=[r[I(d)],r[K],r[W]];c=[...(null!=(e=null==(f=m.autoPlacement)?void 0:f.overflows)?
e:[]),{placement:d,overflows:r}];if(e=v[b+1])return{data:{index:b+1,overflows:c},reset:{placement:e}};e=c.slice().sort((x,A)=>x.overflows[0]-A.overflows[0]);f=null==(g=e.find(x=>{({overflows:x}=x);return x.every(A=>0>=A)}))?void 0:g.placement;g=null!=f?f:e[0].placement;return g!==n?{data:{index:b+1,overflows:c},reset:{placement:g}}:{}}}},xa=function(a){void 0===a&&(a={});return{name:"flip",options:a,async fn(b){var c;const {placement:d,middlewareData:e,rects:f,initialPlacement:g,platform:h,elements:l}=
b,{mainAxis:k=!0,crossAxis:m=!0,fallbackPlacements:n,fallbackStrategy:t="bestFit",flipAlignment:p=!0,...q}=a,u=I(d);var w=n||(u!==g&&p?Ia(g):[R(g)]);w=[g,...w];const y=await N(b,q),v=[];b=(null==(c=e.flip)?void 0:c.overflows)||[];k&&v.push(y[u]);if(m){const {main:x,cross:A}=la(d,f,await (null==h.isRTL?void 0:h.isRTL(l.floating)));v.push(y[x],y[A])}b=[...b,{placement:d,overflows:v}];if(!v.every(x=>0>=x)){var r,K;c=(null!=(r=null==(K=e.flip)?void 0:K.index)?r:0)+1;if(r=w[c])return{data:{index:c,overflows:b},
reset:{placement:r}};r="bottom";switch(t){case "bestFit":var W;(b=null==(W=b.map(x=>[x,x.overflows.filter(A=>0<A).reduce((A,Wa)=>A+Wa,0)]).sort((x,A)=>x[1]-A[1])[0])?void 0:W[0].placement)&&(r=b);break;case "initialPlacement":r=g}if(d!==r)return{reset:{placement:r}}}return{}}}},Pa=function(a){let {strategy:b="referenceHidden",...c}=void 0===a?{}:a;return{name:"hide",async fn(d){var {rects:e}=d;switch(b){case "referenceHidden":return d=await N(d,{...c,elementContext:"reference"}),e=ma(d,e.reference),
{data:{referenceHiddenOffsets:e,referenceHidden:na(e)}};case "escaped":return d=await N(d,{...c,altBoundary:!0}),e=ma(d,e.floating),{data:{escapedOffsets:e,escaped:na(e)}};default:return{}}}}},Qa=function(a){void 0===a&&(a=0);return{name:"offset",options:a,async fn(b){const {x:c,y:d}=b;b=await Ja(b,a);return{x:c+b.x,y:d+b.y,data:b}}}},Oa=function(a){void 0===a&&(a={});return{name:"shift",options:a,async fn(b){const {x:c,y:d,placement:e}=b,{mainAxis:f=!0,crossAxis:g=!1,limiter:h={fn:q=>{let {x:u,y:w}=
q;return{x:u,y:w}}},...l}=a;var k={x:c,y:d};const m=await N(b,l),n=L(I(e)),t="x"===n?"y":"x";let p=k[n];k=k[t];f&&(p=ia(p+m["y"===n?"top":"left"],ha(p,p-m["y"===n?"bottom":"right"])));g&&(k=ia(k+m["y"===t?"top":"left"],ha(k,k-m["y"===t?"bottom":"right"])));b=h.fn({...b,[n]:p,[t]:k});return{...b,data:{x:b.x-c,y:b.y-d}}}}},Ca=Math.min,Q=Math.max,S=Math.round,V={getClippingRect:function(a){let {element:b,boundary:c,rootBoundary:d,strategy:e}=a;a=[...("clippingAncestors"===c?La(b):[].concat(c)),d];a=
a.reduce((f,g)=>{g=wa(b,g,e);f.top=Q(g.top,f.top);f.right=Ca(g.right,f.right);f.bottom=Ca(g.bottom,f.bottom);f.left=Q(g.left,f.left);return f},wa(b,a[0],e));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(a){let {rect:b,offsetParent:c,strategy:d}=a;var e=z(c);const f=H(c);if(c===f)return b;a={scrollLeft:0,scrollTop:0};var g=0,h=0;if(e||!e&&"fixed"!==d){if("body"!==G(c)||P(f))a=T(c);z(c)&&(e=E(c,!0),g=e.x+c.clientLeft,
h=e.y+c.clientTop)}return{...b,x:b.x-a.scrollLeft+g,y:b.y-a.scrollTop+h}},isElement:D,getDimensions:ua,getOffsetParent:da,getDocumentElement:H,getElementRects:a=>{let {reference:b,floating:c,strategy:d}=a;a=da(c);var e=z(a);const f=H(a);var g;if(g=e)g=E(a),g=S(g.width)!==a.offsetWidth||S(g.height)!==a.offsetHeight;g=E(b,g,"fixed"===d);let h={scrollLeft:0,scrollTop:0};var l=0,k=0;if(e||!e&&"fixed"!==d){if("body"!==G(a)||P(f))h=T(a);z(a)?(e=E(a,!0),l=e.x+a.clientLeft,k=e.y+a.clientTop):f&&(l=sa(f))}return{reference:{x:g.left+
h.scrollLeft-l,y:g.top+h.scrollTop-k,width:g.width,height:g.height},floating:{...ua(c),x:0,y:0}}},getClientRects:a=>Array.from(a.getClientRects()),isRTL:a=>"rtl"===F(a).direction},Xa={floatingUINonChromiumPositioningFix:!0,...globalThis.calciteComponentsConfig},Ta=async function(){function a(){const b=navigator.userAgentData;return(null===b||void 0===b?0:b.brands)?b.brands.map(c=>`${c.brand}/${c.version}`).join(" "):navigator.userAgent}if(X.Build.isBrowser&&Xa.floatingUINonChromiumPositioningFix&&
/firefox|safari/i.test(a())){const {getClippingRect:b,getElementRects:c,getOffsetParent:d}=await new Promise((e,f)=>Ea(["./nonChromiumPlatformUtils"],e,f));V.getClippingRect=b;V.getOffsetParent=d;V.getElementRects=c}}(),Da="top bottom right left top-start top-end bottom-start bottom-end right-start right-end left-start left-end".split(" "),Aa={animation:"calcite-floating-ui-anim",animationActive:"calcite-floating-ui-anim--active"},Ya=Y.debounce(ya,100,{leading:!0,maxWait:100}),fa=new WeakMap;Y=Math.ceil(Math.hypot(4,
4));B.FloatingCSS=Aa;B.connectFloatingUI=function(a,b,c){if(c&&b){za(a,b,c);var d=a.overlayPositioning;c.style.position=d;"absolute"===d&&Ba(c);fa.set(a,Ma(b,c,()=>a.reposition()))}};B.defaultMenuPlacement="bottom-start";B.defaultOffsetDistance=Y;B.disconnectFloatingUI=za;B.filterComputedPlacements=function(a,b){const c=a.filter(d=>Da.includes(d));c.length!==a.length&&console.warn(`${b.tagName}: Invalid value found in: flipPlacements. Try any of these: ${Da.map(d=>`"${d}"`).join(", ").trim()}`,{el:b});
return c};B.rectToClientRect=M;B.reposition=async function(a,b,c=!1){if(a.open)return c?Ya(b):ya(b)};B.updateAfterClose=function(a){a&&"absolute"===a.style.position&&(a.shadowRoot||a).addEventListener("transitionend",ea)}});