// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(v,I,J,K,L,n,k,C){function D(c,d){if(I.isNone(c))return null;var a=c.spatialReference,b=C.getInfo(a);c="toJSON"in c?c.toJSON():c;if(!b)return c;a=C.isWebMercator(a)?102100:4326;const e=k.cutParams[a].maxX,f=k.cutParams[a].minX;if(n.isPoint(c))return E(c,e,f);if(n.isMultipoint(c))c.points=c.points.map(g=>E(g,e,f));else{if(n.isExtent(c))return M(c,
b);if(n.isPolygon(c)||n.isPolyline(c)){a=K.getBoundsXY(N,c);b=a[0];a=a[2];const g=2*k.offsetMagnitude(b,f)*e;c=0===g?c:k.updatePolyGeometry(c,g);b+=g;a+=g;return a>e?F(c,e,d):b<f?F(c,f,d):c}}return c}function M(c,d){if(!d)return c;const a=O(c,d).map(b=>b.extent);return 2>a.length?a[0]||c:2<a.length?(c.xmin=d.valid[0],c.xmax=d.valid[1],c):{rings:a.map(b=>[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]])}}function E(c,d,a){if(Array.isArray(c)){var b=c[0];b>d?(a=k.offsetMagnitude(b,
d),c[0]=b+-2*a*d):b<a&&(d=k.offsetMagnitude(b,a),c[0]=b+-2*d*a)}else b=c.x,b>d?(a=k.offsetMagnitude(b,d),c.x+=-2*a*d):b<a&&(d=k.offsetMagnitude(b,a),c.x+=-2*d*a);return c}function O(c,d){const a=[],{ymin:b,ymax:e,xmin:f,xmax:g}=c;var h=c.xmax-c.xmin;const [p,l]=d.valid,{x:q,frameId:r}=G(c.xmin,d),{x:t,frameId:u}=G(c.xmax,d);c=q===t&&0<h;if(h>2*l){h={xmin:f<g?q:t,ymin:b,xmax:l,ymax:e};c={xmin:p,ymin:b,xmax:f<g?t:q,ymax:e};d={xmin:0,ymin:b,xmax:l,ymax:e};const B={xmin:p,ymin:b,xmax:0,ymax:e},w=[],x=
[];y(h,d)&&w.push(r);y(h,B)&&x.push(r);y(c,d)&&w.push(u);y(c,B)&&x.push(u);for(let z=r+1;z<u;z++)w.push(z),x.push(z);a.push(new m(h,[r]),new m(c,[u]),new m(d,w),new m(B,x))}else q>t||c?a.push(new m({xmin:q,ymin:b,xmax:l,ymax:e},[r]),new m({xmin:p,ymin:b,xmax:t,ymax:e},[u])):a.push(new m({xmin:q,ymin:b,xmax:t,ymax:e},[r]));return a}function G(c,d){const [a,b]=d.valid;d=2*b;var e=0;c>b?(e=Math.ceil(Math.abs(c-b)/d),c-=e*d):c<a&&(e=Math.ceil(Math.abs(c-a)/d),c+=e*d,e=-e);return{x:c,frameId:e}}function y(c,
d){const {xmin:a,ymin:b,xmax:e,ymax:f}=d;return A(c,a,b)&&A(c,a,f)&&A(c,e,f)&&A(c,e,b)}function A(c,d,a){return d>=c.xmin&&d<=c.xmax&&a>=c.ymin&&a<=c.ymax?!0:!1}function F(c,d,a=!0){const b=!n.isPolyline(c);b&&L.closeRings(c);if(a)return(new H).cut(c,d);a=b?c.rings:c.paths;const e=b?4:2,f=a.length;d*=-2;for(let g=0;g<f;g++){const h=a[g];if(h&&h.length>=e){const p=[];for(const l of h)p.push([l[0]+d,l[1]]);a.push(p)}}b?c.rings=a:c.paths=a;return c}let m=function(c,d){this.extent=c;this.frameIds=d};
const N=J.create();let H=function(){function c(){this._linesIn=[];this._linesOut=[]}var d=c.prototype;d.cut=function(a,b){this._xCut=b;if(a.rings)this._closed=!0,b=a.rings,this._minPts=4;else if(a.paths)this._closed=!1,b=a.paths,this._minPts=2;else return null;for(var e of b)if(e&&!(e.length<this._minPts)){b=!0;for(const f of e)b?(this.moveTo(f),b=!1):this.lineTo(f);this._closed&&this.close()}this._pushLineIn();this._pushLineOut();b=[];for(const f of this._linesIn)f&&f.length>=this._minPts&&b.push(f);
e=-2*this._xCut;for(const f of this._linesOut)if(f&&f.length>=this._minPts){for(const g of f)g[0]+=e;b.push(f)}this._closed?a.rings=b:a.paths=b;return a};d.moveTo=function(a){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(a[0]);this._moveTo(a[0],a[1],this._prevSide);this._firstPt=this._prevPt=a};d.lineTo=function(a){const b=this._side(a[0]);if(-1===b*this._prevSide){const e=this._intersect(this._prevPt,a);this._lineTo(this._xCut,e,0);this._prevSide=0}this._lineTo(a[0],a[1],b);this._prevSide=
b;this._prevPt=a};d.close=function(){const a=this._firstPt,b=this._prevPt;a[0]===b[0]&&a[1]===b[1]||this.lineTo(a);this._checkClosingPt(this._lineIn);this._checkClosingPt(this._lineOut)};d._moveTo=function(a,b,e){this._closed?(this._lineIn.push([0>=e?a:this._xCut,b]),this._lineOut.push([0<=e?a:this._xCut,b])):(0>=e&&this._lineIn.push([a,b]),0<=e&&this._lineOut.push([a,b]))};d._lineTo=function(a,b,e){this._closed?(this._addPolyVertex(this._lineIn,0>=e?a:this._xCut,b),this._addPolyVertex(this._lineOut,
0<=e?a:this._xCut,b)):0>e?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([a,b])):0<e?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([a,b])):0>this._prevSide?(this._lineIn.push([a,b]),this._lineOut.push([a,b])):0<this._prevSide&&(this._lineOut.push([a,b]),this._lineIn.push([a,b]))};d._addPolyVertex=function(a,b,e){const f=a.length;1<f&&a[f-1][0]===b&&a[f-2][0]===b?a[f-1][1]=e:a.push([b,e])};d._checkClosingPt=function(a){const b=a.length;3<b&&a[0][0]===this._xCut&&a[b-2][0]===
this._xCut&&a[1][0]===this._xCut&&(a[0][1]=a[b-2][1],a.pop())};d._side=function(a){return a<this._xCut?-1:a>this._xCut?1:0};d._intersect=function(a,b){return a[1]+(this._xCut-a[0])/(b[0]-a[0])*(b[1]-a[1])};d._pushLineIn=function(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn);this._lineIn=[]};d._pushLineOut=function(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut);this._lineOut=[]};return c}();v.CutVertical=H;v.normalizeCentralMeridianForDisplay=
function(c){return D(c,!1)};v.normalizeCentralMeridianSync=function(c){return D(c,!0)};Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});