// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Logger ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f64 ../../../chunks/mat4 ../../../chunks/mat4f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../projection ../../projectionEllipsoid ../axisAngleDegrees ./geographicUtils ./projection".split(" "),function(z,D,f,E,F,G,H,l,t,x,I,h,J,m){function n(a,e,b,d=t.ZEROS){if(!f.isNone(a))for(G.fromRotation(y,h.angleRad(e),h.axis(e)),e=0;e<a.length;e+=b){for(var c=0;3>c;c++)p[c]=a[e+c]-d[c];l.transformMat4(p,
p,y);for(c=0;3>c;c++)a[e+c]=p[c]+d[c]}}const A=D.getLogger("esri.geometry.support.meshUtils.rotate"),p=t.create(),B=t.create(),u=h.create(),y=H.create(),C=F.create(),g=t.create();z.rotate=function(a,e,b){if(a.vertexAttributes&&a.vertexAttributes.position&&0!==e[3]){var d=a.spatialReference;if(f.isSome(a.transform))null!=b?.geographic&&b.geographic!==a.transform.geographic&&A.warn(`Specifying the 'geographic' parameter (${b.geographic}) different from the Mesh transform setting (${a.transform.geographic}) is not supported`),
b=b?.origin??a.transform.getOriginPoint(d),a=a.transform,b=l.set(p,b.x,b.y,b.z),b=l.subtract(p,b,a.origin),a.applyLocalInverse(b,B),a.rotation=h.compose(a.rotation,e,h.create()),a.applyLocalInverse(b,b),l.subtract(b,b,B),a.translation=l.add(t.create(),a.translation,b);else{d=b?.origin??a.origin;if(J.isGeographicMesh(a.spatialReference,b)){var c=d;b=a.spatialReference;d=I.getSphericalPCPF(b);x.projectPointToVector(c,g,d)||x.projectPointToVector(a.origin,g,d);c=a.vertexAttributes.position;const q=a.vertexAttributes.normal,
r=a.vertexAttributes.tangent,k=new Float64Array(c.length),v=f.isSome(q)?new Float32Array(q.length):null,w=f.isSome(r)?new Float32Array(r.length):null;x.computeTranslationToOriginAndRotation(d,g,y,d);E.fromMat4(C,y);l.transformMat3(h.axis(u),h.axis(e),C);u[3]=e[3];m.projectToPCPF(c,b,k);f.isSome(q)&&f.isSome(v)&&m.projectNormalToPCPF(q,c,k,b,v);f.isSome(r)&&f.isSome(w)&&m.projectTangentToPCPF(r,c,k,b,w);n(k,u,3,g);m.projectFromPCPF(k,c,b);f.isSome(q)&&f.isSome(v)&&(n(v,u,3),m.projectNormalFromPCPF(v,
c,k,b,q));f.isSome(r)&&f.isSome(w)&&(n(w,u,4),m.projectTangentFromPCPF(w,c,k,b,r))}else b=d,x.projectPointToVector(b,g,a.spatialReference)||(d=a.origin,g[0]=d.x,g[1]=d.y,g[2]=d.z,A.error(`Failed to project specified origin (wkid:${b.spatialReference.wkid}) to mesh spatial reference (wkid:${a.spatialReference.wkid}).`)),n(a.vertexAttributes.position,e,3,g),n(a.vertexAttributes.normal,e,3),n(a.vertexAttributes.tangent,e,4);a.vertexAttributesChanged()}}};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})});