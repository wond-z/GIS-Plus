// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/Error ../../core/has ../../core/maybe ../../core/promiseUtils ../../layers/support/source/DataLayerSource ./executeQueryJSON ./executeQueryPBF ../support/FeatureSet ../support/Query".split(" "),function(v,h,m,w,x,g,y,z,A,B,C,D){function n(){n=m._asyncToGenerator(function*(d,a,c,e){return r(d,a,c,e).then(b=>E(a,b,c,e))});return n.apply(this,arguments)}function r(d,a,c,e){return p.apply(this,arguments)}function p(){p=m._asyncToGenerator(function*(d,
a,c,e){e={...e};var b=D.from(a);b.sourceSpatialReference=b.sourceSpatialReference||c?.sourceSpatialReference;if(c.gdbVersion||c.dynamicDataSource)b=b===a?b.clone():b,b.gdbVersion=a.gdbVersion||c.gdbVersion,b.dynamicDataSource=a.dynamicDataSource?z.DataLayerSource.from(a.dynamicDataSource):c.dynamicDataSource;if(g.isSome(c.infoFor3D)&&t(a,c?.infoFor3D)){b=b===a?b.clone():b;b.formatOf3DObjects=null;for(f of c.infoFor3D.queryFormats){if("3D_glb"===f){b.formatOf3DObjects=f;break}"3D_gltf"!==f||b.formatOf3DObjects||
(b.formatOf3DObjects=f)}if(!b.formatOf3DObjects)throw new w("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(g.isNone(b.outFields)||!b.outFields.includes("*")){b=b===a?b.clone():b;g.isNone(b.outFields)&&(b.outFields=[]);const {originX:k,originY:F,originZ:G,translationX:H,translationY:I,translationZ:J,scaleX:K,scaleY:L,scaleZ:M,rotationX:N,rotationY:O,rotationZ:P,rotationDeg:Q}=c.infoFor3D.transformFieldRoles;
b.outFields.push(k,F,G,H,I,J,K,L,M,N,O,P,Q)}}var f=b;a=null!=a.outStatistics?.[0];b=x("featurelayer-pbf-statistics");a=!a||b;let l;if("pbf"===c.format&&a)try{l=yield B.executeRawQueryPBF(d,f,e)}catch(k){if("query:parsing-pbf"===k.name)c.format="json";else throw k;}"json"!==c.format&&a||(l=yield A.executeRawQueryJSON(d,f,e));u(c.fieldsIndex,l.fields);return l});return p.apply(this,arguments)}function u(d,a){if(g.isSome(d)&&g.isSome(a))for(const c of a)(a=d.get(c.name))&&Object.assign(c,a.toJSON())}
function E(d,a,c,e){return q.apply(this,arguments)}function q(){q=m._asyncToGenerator(function*(d,a,c,e){if(!t(d,c?.infoFor3D)||g.isNone(c.infoFor3D)||!a.assetMaps||!a.features||!a.features.length)return C.fromJSON(a);({meshFeatureSetFromJSON:e}=yield y.whenOrAbort(new Promise((b,f)=>v(["../support/meshFeatureSet"],b,f)),e));return e(d,c.infoFor3D,a)});return q.apply(this,arguments)}function t(d,a){return g.isSome(a)&&d.returnGeometry&&"xyFootprint"!==d.multipatchOption&&!d.outStatistics}h.executeQuery=
function(d,a,c,e){return n.apply(this,arguments)};h.executeRawQuery=r;h.normalizeFields=u;Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});