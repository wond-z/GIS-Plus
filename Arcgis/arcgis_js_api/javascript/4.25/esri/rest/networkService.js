// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../chunks/_rollupPluginBabelHelpers ../request ../core/Error ../core/Logger ../core/maybe ../core/object ../core/urlUtils ./utils ./support/NetworkServiceDescription".split(" "),function(h,m,k,t,u,v,w,n,l,x){function p(){p=m._asyncToGenerator(function*(a,d,b){if(!a)throw new t("network-service:missing-url","Url to Network service is missing");var c=l.asValidOptions({f:"json",token:d},b);({data:c}=yield k(a,c));c.supportedTravelModes||(c.supportedTravelModes=[]);for(let f=0;f<c.supportedTravelModes.length;f++)c.supportedTravelModes[f].id||
(c.supportedTravelModes[f].id=c.supportedTravelModes[f].itemId);a=10.4<=c.currentVersion?y(a,d,b):z(a,b);const {defaultTravelMode:e,supportedTravelModes:g}=yield a;c.defaultTravelMode=e;c.supportedTravelModes=g;return x.fromJSON(c)});return p.apply(this,arguments)}function z(a,d){return q.apply(this,arguments)}function q(){q=m._asyncToGenerator(function*(a,d){var b=l.asValidOptions({f:"json"},d);({data:a}=yield k(a.replace(/\/rest\/.*$/i,"/info"),b));if(!a||!a.owningSystemUrl)return{supportedTravelModes:[],
defaultTravelMode:null};({owningSystemUrl:a}=a);const c=n.removeTrailingSlash(a)+"/sharing/rest/portals/self";({data:b}=yield k(c,b));b=w.getDeepValue("helperServices.routingUtilities.url",b);if(!b)return{supportedTravelModes:[],defaultTravelMode:null};a=l.parseUrl(a);a={f:"json",serviceName:/\/solve$/i.test(a.path)?"Route":/\/solveclosestfacility$/i.test(a.path)?"ClosestFacility":"ServiceAreas"};d=l.asValidOptions(a,d);b=n.removeTrailingSlash(b)+"/GetTravelModes/execute";a=yield k(b,d);d=[];b=null;
if(a?.data?.results?.length){a=a.data.results;for(const e of a)if("supportedTravelModes"===e.paramName){if(e.value?.features)for(const {attributes:g}of e.value.features)g&&(a=JSON.parse(g.TravelMode),d.push(a))}else"defaultTravelMode"===e.paramName&&(b=e.value)}return{supportedTravelModes:d,defaultTravelMode:b}});return q.apply(this,arguments)}function y(a,d,b){return r.apply(this,arguments)}function r(){r=m._asyncToGenerator(function*(a,d,b){try{const c=l.asValidOptions({f:"json",token:d},b),e=n.removeTrailingSlash(a)+
"/retrieveTravelModes",{data:{supportedTravelModes:g,defaultTravelMode:f}}=yield k(e,c);return{supportedTravelModes:g,defaultTravelMode:f}}catch(c){throw new t("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:c});}});return r.apply(this,arguments)}const A=u.getLogger("esri.rest.networkService");h.collectGeometries=function(a,d,b,c){c[b]=[d.length,d.length+a.length];a.forEach(e=>{d.push(e.geometry)})};h.dropZValuesOffInputGeometry=function(a,d){for(let b=
0;b<d.length;b++){const c=a[d[b]];if(c&&c.length)for(const e of c)e.z=void 0}A.warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")};h.fetchServiceDescription=function(a,d,b){return p.apply(this,arguments)};h.isInputGeometryZAware=function(a,d){for(let b=0;b<d.length;b++){const c=a[d[b]];if(c&&c.length)for(const e of c)if(v.isSome(e)&&e.hasZ)return!0}return!1};Object.defineProperties(h,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})});