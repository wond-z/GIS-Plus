// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/support/ElevationQuery ../../support/elevationInfoUtils ./ElevationProfileLine".split(" "),function(m,d,t,x,e,y,u,g,c,E,z,A,B,C){c=function(n){function h(a){a=n.call(this,
a)||this;a.type="input";a.color=new t("#00c8c8");a.viewVisualizationEnabled=!1;a.numSamplesForPreview=50;a.numSamplesPerChunk=500;a.chartFillEnabled=!1;a.chartStrokeOffsetY=-1;a._getQueryElevationDependencies=y.memoize((b,f,p,k,l)=>e.applySome(b,q=>({elevationInfo:q,visibleLayers:f,view:p,stationary:k,spatialReference:l})));return a}m._inheritsLoose(h,n);var v=h.prototype;v.queryElevation=function(){var a=m._asyncToGenerator(function*(b,{noDataValue:f,signal:p}){const k=this.queryElevationDependencies;
if(e.isNone(k))throw Error("ElevationProfileLineInput: no dependencies");const {view:l,elevationInfo:q,spatialReference:w}=k;if("on-the-ground"===q.mode&&"3d"===l.type){b=yield A.GeometryDescriptor.fromGeometry(b).project(w,p);const D=l.elevationProvider;b.coordinates.forEach(r=>{r.z=e.unwrapOr(D.getElevation(r.x,r.y,0,w,"ground"),0)});return{geometry:b.export(),noDataValue:f}}return{geometry:b,noDataValue:f}});return function(b,f){return a.apply(this,arguments)}}();v.attach=function(a){const b=()=>
this._onChange();return x.handlesGroup([n.prototype.attach.call(this,a),u.watch(()=>this.queryElevationDependencies,b),u.on(()=>a.elevationProvider,"elevation-change",b,{onListenerAdd:b,onListenerRemove:b})])};m._createClass(h,[{key:"queryElevationDependencies",get:function(){const a=this._viewModel.view;return e.isNone(a)?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,a,a.stationary,a.spatialReference)}},{key:"available",get:function(){return!this._viewModel.inputIsSketched}},
{key:"_elevationInfo",get:function(){return e.applySome(this._viewModel.input,B.getGraphicEffectiveElevationInfo)}},{key:"_visibleLayers",get:function(){const a=e.applySome(this._viewModel?.view,b=>b.map?.allLayers?.filter(f=>f.visible).toArray());return e.unwrapOr(a,[])}}]);return h}(C);d.__decorate([g.property({type:t,nonNullable:!0})],c.prototype,"color",void 0);d.__decorate([g.property()],c.prototype,"viewVisualizationEnabled",void 0);d.__decorate([g.property()],c.prototype,"queryElevationDependencies",
null);d.__decorate([g.property()],c.prototype,"available",null);d.__decorate([g.property()],c.prototype,"_elevationInfo",null);d.__decorate([g.property()],c.prototype,"_visibleLayers",null);return c=d.__decorate([z.subclass("esri.widgets.ElevationProfile.ElevationProfileLineInput")],c)});