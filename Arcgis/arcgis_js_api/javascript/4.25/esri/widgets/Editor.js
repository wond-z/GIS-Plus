// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Attachments":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/maybe ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D){const E={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},J=window.CSS;M=function(A){function P(c,b){c=A.call(this,c,b)||this;c.displayType="auto";c.messages=null;c.messagesUnits=null;c.selectedFile=null;c.submitting=!1;c.viewModel=new y;c.visibleElements={...E};c._supportsImageOrientation=J&&J.supports&&J.supports("image-orientation","from-image");c._addAttachmentForm=
null;c._updateAttachmentForm=null;return c}u._inheritsLoose(P,A);var e=P.prototype;e.initialize=function(){this.addHandles([C.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),C.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),C.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),C.initial)])};e.loadDependencies=function(){return Promise.all([new Promise((c,b)=>g(["../chunks/calcite-icon"],c,b))])};e.castVisibleElements=function(c){return{...E,...c}};
e.addAttachment=function(){const {_addAttachmentForm:c,viewModel:b}=this;this._set("submitting",!0);this._set("error",null);return b.addAttachment(c).then(r=>{this._set("submitting",!1);this._set("error",null);b.mode="view";return r}).catch(r=>{this._set("submitting",!1);this._set("error",new O("attachments:add-attachment",this.messages.addErrorMessage,r));throw r;})};e.deleteAttachment=function(c){const {viewModel:b}=this;this._set("submitting",!0);this._set("error",null);return b.deleteAttachment(c).then(r=>
{this._set("submitting",!1);this._set("error",null);b.mode="view";return r}).catch(r=>{this._set("submitting",!1);this._set("error",new O("attachments:delete-attachment",this.messages.deleteErrorMessage,r));throw r;})};e.updateAttachment=function(){const {viewModel:c}=this,{_updateAttachmentForm:b}=this;this._set("submitting",!0);this._set("error",null);return c.updateAttachment(b).then(r=>{this._set("submitting",!1);this._set("error",null);c.mode="view";return r}).catch(r=>{this._set("submitting",
!1);this._set("error",new O("attachments:update-attachment",this.messages.updateErrorMessage,r));throw r;})};e.addFile=function(){const c=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return c};e.updateFile=function(){const {viewModel:c}=this,b=c.updateFile(this.selectedFile,this._updateAttachmentForm,c.activeFileInfo);c.mode="view";return b};e.deleteFile=function(c){c=this.viewModel.deleteFile(c||this.viewModel.activeFileInfo.file);this.viewModel.mode=
"view";return c};e.render=function(){const {submitting:c,viewModel:b}=this,{state:r}=b;return D.tsx("div",{class:this.classes("esri-attachments","esri-widget")},c?this.renderProgressBar():null,"loading"===r?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};e.renderErrorMessage=function(){const {error:c,visibleElements:b}=this;return c&&b.errorMessage?D.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},c.message):null};e.renderAttachments=function(){const {activeFileInfo:c,
mode:b,activeAttachmentInfo:r}=this.viewModel;return"add"===b?this.renderAddForm():"edit"===b?this.renderDetailsForm(r||c):this.renderAttachmentContainer()};e.renderLoading=function(){return D.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},D.tsx("div",{class:"esri-attachments__loader"}))};e.renderProgressBar=function(){return this.visibleElements.progressBar?D.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null};e.renderAddForm=function(){const {submitting:c,
selectedFile:b}=this;var r=c||!b,H=this.visibleElements.cancelAddButton?D.tsx("button",{type:"button",bind:this,disabled:c,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",c&&"esri-button--disabled")},this.messages.cancel):null;r=this.visibleElements.addSubmitButton?D.tsx("button",{type:"submit",disabled:r,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",{["esri-button--disabled"]:r})},
this.messages.add):null;const d=b?D.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},b.name):null;H=D.tsx("form",{bind:this,afterCreate:S.storeNode,afterRemoved:S.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},D.tsx("fieldset",{class:"esri-attachments__file-fieldset"},d,D.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},b?this.messages.changeFile:this.messages.selectFile,D.tsx("input",{class:"esri-attachments__file-input",
type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),r,H);return D.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},H)};e.renderDetailsForm=function(c){const {visibleElements:b,viewModel:r,selectedFile:H,submitting:d}=this;var {abilities:p}=r,z=d||!H;let m;if(H){var k=H.type;m=H.name;var B=H.size}else if("file"in c)k=c.file.type,m=c.file.name,B=c.file.size;else{k=c.contentType;m=c.name;B=c.size;var q=c.url}var T=p.editing&&p.operations.delete&&b.deleteButton?
D.tsx("button",{key:"delete-button",type:"button",disabled:d,bind:this,onclick:x=>this._submitDeleteAttachment(x,c),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{["esri-button--disabled"]:d})},this.messages.delete):void 0;z=p.editing&&p.operations.update&&b.updateButton?D.tsx("button",{disabled:z,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:z})},
this.messages.update):void 0;const n=this.visibleElements.cancelUpdateButton?D.tsx("button",{disabled:d,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:d})},this.messages.cancel):void 0;p=p.editing&&p.operations.update?D.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},D.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},
m),D.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,D.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0;B=D.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},D.tsx("label",null,F.formatFileSize(this.messagesUnits,B)));k=D.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},D.tsx("label",
null,k));q=l.isSome(q)?D.tsx("a",{class:"esri-attachments__item-link",href:q,rel:"noreferrer",target:"_blank"},this.renderImageMask(c,400),D.tsx("div",{class:"esri-attachments__item-link-overlay"},D.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},D.tsx("calcite-icon",{icon:"launch"})))):this.renderImageMask(c,400);T=D.tsx("form",{bind:this,afterCreate:S.storeNode,afterRemoved:S.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:x=>this._submitUpdateAttachment(x,c)},D.tsx("div",
{class:"esri-attachments__metadata"},B,k),p,D.tsx("div",{class:"esri-attachments__actions"},T,n,z));return D.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},q,T)};e.renderImageMask=function(c,b){return"file"in c?this.renderGenericImageMask(c.file.name,c.file.type):this.renderImageMaskForAttachment(c,b)};e.renderGenericImageMask=function(c,b){var {supportsResizeAttachments:r}=this.viewModel;b=I.getIconPath(b);r={["esri-attachments__image--resizable"]:r};return D.tsx("div",
{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask")},D.tsx("img",{title:c,alt:c,src:b,class:this.classes(r,"esri-attachments__image")}))};e.renderImageMaskForAttachment=function(c,b){var {supportsResizeAttachments:r}=this.viewModel;const {contentType:H,name:d,url:p}=c;if(!r||!I.isSupportedImage(H))return this.renderGenericImageMask(d,H);c=(c=this._getCSSTransform(c))?{transform:c,"image-orientation":"none"}:{};b=`${p}${p.includes("?")?"\x26":"?"}w=${b}`;r={["esri-attachments__image--resizable"]:r};
return D.tsx("div",{class:this.classes("esri-attachments__item-mask")},D.tsx("img",{styles:c,alt:d,title:d,src:b,class:this.classes(r,"esri-attachments__image")}))};e.renderFile=function(c){const {file:b}=c;return D.tsx("li",{class:"esri-attachments__item",key:b},D.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(c),type:"button"},this.renderImageMask(c),
D.tsx("label",{class:"esri-attachments__label"},D.tsx("span",{class:"esri-attachments__filename"},b.name||this.messages.noTitle),D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",S.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}))))};e.renderAttachmentInfo=function({attachmentInfo:c,displayType:b}){const {viewModel:r,effectiveDisplayType:H}=this,{abilities:d,supportsResizeAttachments:p}=r,{contentType:z,name:m,url:k}=c;b=this.renderImageMask(c,
"list"===b?48:400);var B=d.editing?D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",S.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;B="preview"===H&&p&&I.isSupportedImage(z)?null:D.tsx("label",{class:"esri-attachments__label"},D.tsx("span",{class:"esri-attachments__filename"},m||this.messages.noTitle),B);b=[b,B];b=d.editing?D.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,
"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":c.id,onclick:()=>this._startEditAttachment(c),type:"button"},b):D.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:k,target:"_blank"},b);return D.tsx("li",{class:"esri-attachments__item",key:c},b)};e.renderAttachmentContainer=function(){const {effectiveDisplayType:c,viewModel:b,visibleElements:r}=this,{attachmentInfos:H,abilities:d,fileInfos:p}=b;var z=!!H?.length;const m=!!p?.length,k={["esri-attachments__container--list"]:"preview"!==
c,["esri-attachments__container--preview"]:"preview"===c},B=d.editing&&d.operations.add&&r.addButton?D.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):void 0,q=z?D.tsx("ul",{key:"attachments-list",class:"esri-attachments__items"},H.toArray().map(n=>
this.renderAttachmentInfo({attachmentInfo:n,displayType:c}))):void 0,T=m?D.tsx("ul",{key:"file-list",class:"esri-attachments__items"},p.toArray().map(n=>this.renderFile(n))):void 0;z=m||z?void 0:D.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return D.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",k)},q,T,z,B)};e._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};e._handleFileInputChange=function(c){c=
(c=c.target)&&c.files&&c.files.item(0);this._set("selectedFile",c)};e._submitDeleteAttachment=function(c,b){c.preventDefault();"file"in b?this.deleteFile(b.file):this.deleteAttachment(b)};e._submitAddAttachment=function(c){c.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()};e._submitUpdateAttachment=function(c,b){c.preventDefault();"file"in b?this.updateFile():this.updateAttachment()};e._startEditAttachment=function(c){const {viewModel:b}=this;b.activeFileInfo=null;
b.activeAttachmentInfo=c;b.mode="edit"};e._startEditFile=function(c){const {viewModel:b}=this;b.activeAttachmentInfo=null;b.activeFileInfo=c;b.mode="edit"};e._startAddAttachment=function(){this.viewModel.mode="add"};e._cancelForm=function(c){c.preventDefault();this.viewModel.mode="view"};e._getCSSTransform=function(c){({orientationInfo:c}=c);return!this._supportsImageOrientation&&c?[c.rotation?`rotate(${c.rotation}deg)`:"",c.mirrored?"scaleX(-1)":""].join(" "):""};u._createClass(P,[{key:"abilities",
get:function(){return this.viewModel.abilities},set:function(c){this.viewModel.abilities=c}},{key:"effectiveDisplayType",get:function(){const {displayType:c}=this;return c&&"auto"!==c?c:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(c){this.viewModel.graphic=c}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(c){this._overrideIfSome("label",c)}}]);return P}(Q);f.__decorate([w.property()],
M.prototype,"abilities",null);f.__decorate([w.property()],M.prototype,"displayType",void 0);f.__decorate([w.property({readOnly:!0})],M.prototype,"effectiveDisplayType",null);f.__decorate([w.property()],M.prototype,"graphic",null);f.__decorate([w.property()],M.prototype,"label",null);f.__decorate([w.property(),R.messageBundle("esri/widgets/Attachments/t9n/Attachments")],M.prototype,"messages",void 0);f.__decorate([w.property(),R.messageBundle("esri/core/t9n/Units")],M.prototype,"messagesUnits",void 0);
f.__decorate([w.property({readOnly:!0})],M.prototype,"selectedFile",void 0);f.__decorate([w.property({readOnly:!0})],M.prototype,"submitting",void 0);f.__decorate([w.property({readOnly:!0})],M.prototype,"error",void 0);f.__decorate([w.property({type:y})],M.prototype,"viewModel",void 0);f.__decorate([w.property()],M.prototype,"visibleElements",void 0);f.__decorate([h.cast("visibleElements")],M.prototype,"castVisibleElements",null);return M=f.__decorate([L.subclass("esri.widgets.Attachments")],M)})},
"esri/core/unitFormatUtils":function(){define("exports ./byteSizeEstimations ./Cyclical ./mathUtils ./maybe ./string ./unitUtils ../intl/number".split(" "),function(g,u,f,O,l,C,F,w){function M(S,R,D){return S.units[R][D]}function h(S,R,D,E=2,J="abbr"){return`${w.formatNumber(R,{minimumFractionDigits:E,maximumFractionDigits:E,signDisplay:0<R?"never":"exceptZero"})} ${M(S,D,J)}`}function L(S,R,D,E=2,J="abbr"){return`${w.formatNumber(R,{minimumFractionDigits:E,maximumFractionDigits:E,signDisplay:"exceptZero"})} ${M(S,
D,J)}`}function Q(S,R){const D=JSON.stringify(R);let E=y.get(D);E||(E=new Intl.NumberFormat("en-US",R),y.set(D,E));return/\-?\+?360/.test(E.format(S))?0:S}const y=new Map,I=["B","kB","MB","GB","TB"];g.formatAngleDegrees=function(S,R,D,E,J){J=l.unwrapOr(J,2);var A=f.cyclicalDegrees,P=A.normalize;a:if(S=F.convertUnit(S,R,"degrees"),D===E)D=S;else{switch(E){case "arithmetic":D=-S+90;break a;case "geographic":D=-S-90;break a}D=void 0}A=P.call(A,D,0,!0);J={style:"unit",unitDisplay:"narrow",unit:"degree",
maximumFractionDigits:J,minimumFractionDigits:J,signDisplay:0<A?"never":"exceptZero"};A=Q(A,J);return w.formatNumber(A,J)};g.formatDMS=function(S,R,D=2){S=F.convertUnit(S,R,"degrees");R=S-Math.floor(S);S-=R;R*=60;let E=R-Math.floor(R);R-=E;E*=60;return`${S.toFixed()}\u00b0 ${R.toFixed()}' ${E.toFixed(D)}"`};g.formatDecimal=h;g.formatFileSize=function(S,R){let D=0===R?0:Math.floor(Math.log(R)/Math.log(u.ByteSizeUnit.KILOBYTES));D=O.clamp(D,0,I.length-1);R=w.formatNumber(R/u.ByteSizeUnit.KILOBYTES**
D,{maximumFractionDigits:2});return C.replace(S.units.bytes[I[D]],{fileSize:R})};g.formatImperialArea=function(S,R,D,E=2,J="abbr"){const A=F.preferredImperialAreaUnit(R,D);return h(S,F.convertUnit(R,D,A),A,E,J)};g.formatImperialLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredImperialLengthUnit(R,D);return h(S,F.convertUnit(R,D,A),A,E,J)};g.formatImperialRelativeLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredImperialLengthUnit(R,D);return L(S,F.convertUnit(R,D,A),A,E,J)};g.formatImperialRelativeVerticalLength=
function(S,R,D,E=2,J="abbr"){const A=F.preferredImperialVerticalLengthUnit(R,D);return L(S,F.convertUnit(R,D,A),A,E,J)};g.formatImperialVerticalLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredImperialVerticalLengthUnit(R,D);return h(S,F.convertUnit(R,D,A),A,E,J)};g.formatMetricArea=function(S,R,D,E=2,J="abbr"){const A=F.preferredMetricAreaUnit(R,D);return h(S,F.convertUnit(R,D,A),A,E,J)};g.formatMetricLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredMetricLengthUnit(R,D);return h(S,F.convertUnit(R,
D,A),A,E,J)};g.formatMetricRelativeLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredMetricLengthUnit(R,D);return L(S,F.convertUnit(R,D,A),A,E,J)};g.formatMetricRelativeVerticalLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredMetricVerticalLengthUnit(R,D);return L(S,F.convertUnit(R,D,A),A,E,J)};g.formatMetricVerticalLength=function(S,R,D,E=2,J="abbr"){const A=F.preferredMetricVerticalLengthUnit(R,D);return h(S,F.convertUnit(R,D,A),A,E,J)};g.formatRelativeAngleDegrees=function(S,R,D,E,J){D!==
E&&(S=-S);J=l.unwrapOr(J,2);D={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:J,minimumFractionDigits:J,signDisplay:"exceptZero"};S=F.convertUnit(S,R,"degrees")%360;S=Q(S,D);return w.formatNumber(S,D)};g.formatRelativeDecimal=L;g.unitName=M;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/byteSizeEstimations":function(){define(["exports"],function(g){function u(l){return 32+l.length}function f(l){if(!l)return 0;if(Array.isArray(l)){var C=
l.length;if(0===C||"number"===typeof l[0])l=32+8*C;else{var F=32;for(let w=0;w<C;w++)F+=O(l[w]);l=F}return l}F=32;for(C in l)l.hasOwnProperty(C)&&(F+=O(l[C]));return F}function O(l){switch(typeof l){case "object":return f(l);case "string":return u(l);case "number":return 16;case "boolean":return 4;default:return 8}}g.ByteSizeUnit=void 0;(function(l){l[l.KILOBYTES=1024]="KILOBYTES";l[l.MEGABYTES=1048576]="MEGABYTES";l[l.GIGABYTES=1073741824]="GIGABYTES"})(g.ByteSizeUnit||(g.ByteSizeUnit={}));g.estimateAttributesObjectSize=
function(l){if(!l)return 0;let C=32;for(const F in l)if(l.hasOwnProperty(F)){const w=l[F];switch(typeof w){case "string":C+=u(w);break;case "number":C+=16;break;case "boolean":C+=4}}return C};g.estimateFixedArraySize=function(l,C){return 32+l.length*C};g.estimateNestedObjectSize=f;g.estimateNumberByteSize=function(l){return 16};g.estimateStringByteSize=u;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S){const R={editing:!1,operations:{add:!0,update:!0,delete:!0}},D=l.ofType(y);O=function(E){function J(P){var e=E.call(this,P)||this;e._getAttachmentsPromise=null;e._attachmentLayer=null;e.abilities={...R};e.activeAttachmentInfo=null;e.activeFileInfo=null;e.attachmentInfos=new D;e.fileInfos=new l;e.graphic=null;e.mode="view";e.filesEnabled=!1;e.addHandles(w.watch(()=>e.graphic,()=>e._graphicChanged(),w.initial));return e}g._inheritsLoose(J,E);var A=J.prototype;
A.destroy=function(){this.graphic=this._attachmentLayer=null};A.castAbilities=function(P){return{...R,...P}};A.getAttachments=function(){var P=g._asyncToGenerator(function*(){const {_attachmentLayer:e,attachmentInfos:c}=this;if(!e||"function"!==typeof e.queryAttachments)throw new C("invalid-layer","getAttachments(): A valid layer is required.");const b=this._getObjectId();var r=new I({objectIds:[b],returnMetadata:!0});const H=[];this._getAttachmentsPromise=r=e.queryAttachments(r).then(d=>d[b]||H).catch(()=>
H);this.notifyChange("state");r=yield r;c.removeAll();r.length&&c.addMany(r);this._getAttachmentsPromise=null;this.notifyChange("state");return r});return function(){return P.apply(this,arguments)}}();A.addAttachment=function(){var P=g._asyncToGenerator(function*(e,c=this.graphic){const {_attachmentLayer:b,attachmentInfos:r,abilities:H}=this;if(!c)throw new C("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:c});if(!e)throw new C("invalid-attachment","addAttachment(): An attachment is required.",
{attachment:e});if(!H.operations.add)throw new C("invalid-abilities","addAttachment(): add abilities are required.");if(!b||"function"!==typeof b.addAttachment)throw new C("invalid-layer","addAttachment(): A valid layer is required.");e=yield b.addAttachment(c,e).then(d=>this._queryAttachment(d.objectId,c));r.add(e);return e});return function(e){return P.apply(this,arguments)}}();A.deleteAttachment=function(){var P=g._asyncToGenerator(function*(e){const {_attachmentLayer:c,attachmentInfos:b,graphic:r,
abilities:H}=this;if(!e)throw new C("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!H.operations.delete)throw new C("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!c||"function"!==typeof c.deleteAttachments)throw new C("invalid-layer","deleteAttachment(): A valid layer is required.");const d=yield c.deleteAttachments(r,[e.id]).then(()=>e);b.remove(d);return d});return function(e){return P.apply(this,arguments)}}();
A.updateAttachment=function(){var P=g._asyncToGenerator(function*(e,c=this.activeAttachmentInfo){const {_attachmentLayer:b,attachmentInfos:r,graphic:H,abilities:d}=this;if(!e)throw new C("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!c)throw new C("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:c});if(!d.operations.update)throw new C("invalid-abilities","updateAttachment(): Update abilities are required.");const p=
r.findIndex(z=>z===c);if(!b||"function"!==typeof b.updateAttachment)throw new C("invalid-layer","updateAttachment(): A valid layer is required.");e=yield b.updateAttachment(H,c.id,e).then(z=>this._queryAttachment(z.objectId));r.splice(p,1,e);return e});return function(e){return P.apply(this,arguments)}}();A.commitFiles=function(){var P=g._asyncToGenerator(function*(){yield Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form)));this.fileInfos.removeAll();return this.getAttachments()});
return function(){return P.apply(this,arguments)}}();A.addFile=function(P,e){if(!P||!e)return null;P={file:P,form:e};this.fileInfos.add(P);return P};A.updateFile=function(P,e,c=this.activeFileInfo){if(!P||!e||!c)return null;const b=this.fileInfos.findIndex(r=>c===r);-1<b&&this.fileInfos.splice(b,1,{file:P,form:e});return this.fileInfos.items[b]};A.deleteFile=function(P){const e=this.fileInfos.find(c=>c.file===P);return this.fileInfos.remove(e)??null};A._queryAttachment=function(){var P=g._asyncToGenerator(function*(e,
c){if(!e)throw new C("invalid-attachment-id","Could not query attachment.");const {_attachmentLayer:b}=this,r=this._getObjectId(c);e=new I({objectIds:[r],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return b.queryAttachments(e).then(H=>H[r][0])});return function(e,c){return P.apply(this,arguments)}}();A._getObjectId=function(P=this.graphic){return P?.getObjectId()??null};A._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};A._setAttachmentLayer=
function(){var {graphic:P}=this;this._attachmentLayer=(P=S.getSourceLayer(P))?"scene"===P.type&&F.isSome(P.associatedLayer)?P.associatedLayer:P:null};g._createClass(J,[{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var {graphic:P}=this;if(!P)return!1;P=P.layer||P.sourceLayer;return P?.loaded&&"capabilities"in P&&"operations"in P.capabilities&&"supportsResizeAttachments"in P.capabilities.operations&&
P.capabilities.operations.supportsResizeAttachments||!1}}]);return J}(O);u.__decorate([M.property()],O.prototype,"abilities",void 0);u.__decorate([L.cast("abilities")],O.prototype,"castAbilities",null);u.__decorate([M.property()],O.prototype,"activeAttachmentInfo",void 0);u.__decorate([M.property()],O.prototype,"activeFileInfo",void 0);u.__decorate([M.property({readOnly:!0,type:D})],O.prototype,"attachmentInfos",void 0);u.__decorate([M.property()],O.prototype,"fileInfos",void 0);u.__decorate([M.property({type:f})],
O.prototype,"graphic",void 0);u.__decorate([M.property()],O.prototype,"mode",void 0);u.__decorate([M.property({readOnly:!0})],O.prototype,"state",null);u.__decorate([M.property()],O.prototype,"filesEnabled",void 0);u.__decorate([M.property({readOnly:!0})],O.prototype,"supportsResizeAttachments",null);return O=u.__decorate([Q.subclass("esri.widgets.Attachments.AttachmentsViewModel")],O)})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L){function Q(){Q=u._asyncToGenerator(function*(da,ja){return"function"===typeof da?da.call(null,ja):da});return Q.apply(this,arguments)}function y(da){return da?ba.test(da):!1}function I(da,ja){if(!y(ja)||!da)return null;const ha=ja.replace(ba,"").toLowerCase();let Z;da.some(ca=>ca.name.toLowerCase()===ha?(Z=ca,!0):!1);return Z}function S(da,ja){return(ja=R(ja,da))?ja.name:da}function R(da,ja){return da&&"function"===typeof da.getField?da.getField(ja):null}function D({formattedAttributes:da,
template:ja,fieldInfoMap:ha}){return`${C.replace(C.replace(ja,Z=>{const ca=ha.get(Z.toLowerCase());return`{${ca&&ca.fieldName||Z}}`}),da).replace(K,"")}`.trim()}function E(da,ja,ha=!1){const Z=ja[da];"string"===typeof Z&&(ha=(ha?encodeURIComponent(Z):Z).replace(Y,"%27"),ja[da]=ha)}function J(da,ja=!1){const ha={...da};Object.keys(ha).forEach(Z=>E(Z,ha,ja));return ha}function A(da,ja){return da.replace(U,(ha,Z,ca)=>(ha=R(ja,ca))?`{${ha.name}}`:Z)}function P(da,ja,ha){return(da=A(da,ha))?da.replace(va,
(Z,ca,fa)=>{ca=`${ca||fa}`.trim();return C.replace(Z,J(ja,ca&&"{"!==ca[0]))}):da}function e(da,ja){var ha=ja.fieldName,Z=c(ja.fieldInfos,ha)?.clone();const ca=ja.preventPlacesFormatting;ja=ja.layer;var fa=R(ja,ha);Z&&"date"===fa?.type&&(fa=Z.format||new h,fa.dateFormat=fa.dateFormat||"short-date-short-time",fa.dateTimeFormatOptions=!ja?.layer&&"feature"===ja?.type&&ja.datesInUnknownTimezone||ja?.layer&&"map-image"===ja.layer?.type&&ja.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,Z.format=fa);
Z=Z&&Z.format;if("string"===typeof da&&M.isRasterPixelValueField(ha)&&Z)return Z.formatRasterPixelValue(da);"string"!==typeof da||!Z||null!=Z.dateFormat||null==Z.places&&null==Z.digitSeparator||(ha=Number(da),isNaN(ha)||(da=ha));return"string"===typeof da||null==da||null==Z?H(da):ca?w.formatNumber(da,{...w.convertNumberFormatToIntlOptions(Z),minimumFractionDigits:0,maximumFractionDigits:20}):Z.format(da)}function c(da,ja){if(da&&da.length&&ja){var ha=ja.toLowerCase(),Z=void 0;da.some(ca=>ca.fieldName&&
ca.fieldName.toLowerCase()===ha?(Z=ca,!0):!1);return Z}}function b({fieldName:da,graphic:ja,layer:ha}){if(q(da)||!ha||"function"!==typeof ha.getFeatureType)return null;const {typeIdField:Z}=ha;return Z&&da===Z?(da=ha.getFeatureType(ja))?da.name:null:null}function r({fieldName:da,value:ja,graphic:ha,layer:Z}){return q(da)||!Z||"function"!==typeof Z.getFieldDomain?null:(da=Z.getFieldDomain(da,{feature:ha}))&&"coded-value"===da.type?da.getName(ja):null}function H(da){return"string"===typeof da?da.replace(la,
'\x3cbr class\x3d"esri-text-new-line" /\x3e'):da}function d(da){const {value:ja,fieldName:ha,fieldInfos:Z,fieldInfoMap:ca,layer:fa,graphic:ea}=da;return null==ja?"":(da=r({fieldName:ha,value:ja,graphic:ea,layer:fa}))||(da=b({fieldName:ha,graphic:ea,layer:fa}))?da:ca.get(ha.toLowerCase())?e(ja,{fieldInfos:Z||Array.from(ca.values()),fieldName:ha,layer:fa}):(da=fa&&fa.fieldsIndex)&&da.isDateField(ha)?F.formatDate(ja,Aa):H(ja)}function p(da,ja){return z.apply(this,arguments)}function z(){z=u._asyncToGenerator(function*(da,
ja){const {layer:ha,graphic:Z,outFields:ca,objectIds:fa,returnGeometry:ea,spatialReference:na}=da;da=fa[0];if("number"!==typeof da&&"string"!==typeof da)return G.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:ha,graphic:Z,objectId:da,requiredFields:ca}),null;if(!ha.capabilities?.operations?.supportsQuery)return G.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:ha,graphic:Z,requiredFields:ca,returnGeometry:ea}),
null;da=ha.createQuery();da.objectIds=fa;da.outFields=ca?.length?ca:[ha.objectIdField];da.returnGeometry=!!ea;da.returnZ=!!ea;da.returnM=!!ea;da.outSpatialReference=na;return(yield ha.queryFeatures(da,ja)).features[0]});return z.apply(this,arguments)}function m(da){return k.apply(this,arguments)}function k(){k=u._asyncToGenerator(function*(da){if(!da.expressionInfos?.length)return!1;var ja=yield L.loadArcade();({arcadeUtils:{hasGeometryFunctions:ja}}=ja);return ja(da)});return k.apply(this,arguments)}
function B(){B=u._asyncToGenerator(function*({graphic:da,popupTemplate:ja,layer:ha,spatialReference:Z},ca){if(ha&&ja&&("function"===typeof ha.load&&(yield ha.load(ca)),da.attributes)){var fa=da.attributes[ha.objectIdField];if(null!=fa){fa=[fa];var ea=yield ja.getRequiredFields(ha.fieldsIndex),na=M.featureHasFields(ea,da);ea=na?[]:ea;ja=ja.returnGeometry||(yield m(ja));if(!na||ja)if(ha=yield p({layer:ha,graphic:da,outFields:ea,objectIds:fa,returnGeometry:ja,spatialReference:Z},ca))ha.geometry&&(da.geometry=
ha.geometry),ha.attributes&&(da.attributes={...da.attributes,...ha.attributes})}}});return B.apply(this,arguments)}function q(da=""){return da?da.includes("relationships/"):!1}function T({attributes:da,graphic:ja,relatedInfo:ha,fieldInfos:Z,fieldInfoMap:ca,layer:fa}){da&&ja&&ha&&Object.keys(ja.attributes).forEach(ea=>{var na=(na={layerId:ha.relation.id.toString(),fieldName:ea},`${"relationships/"}${na.layerId}/${na.fieldName}`);da[na]=d({fieldName:na,fieldInfos:Z,fieldInfoMap:ca,layer:fa,value:ja.attributes[ea],
graphic:ja})})}function n({attributes:da,relatedInfo:ja,fieldInfoMap:ha,fieldInfos:Z,layer:ca}){da&&ja&&(ja.relatedFeatures&&ja.relatedFeatures&&ja.relatedFeatures.forEach(fa=>T({attributes:da,graphic:fa,relatedInfo:ja,fieldInfoMap:ha,fieldInfos:Z,layer:ca})),ja.relatedStatsFeatures&&ja.relatedStatsFeatures&&ja.relatedStatsFeatures.forEach(fa=>T({attributes:da,graphic:fa,relatedInfo:ja,fieldInfoMap:ha,fieldInfos:Z,layer:ca})))}function x(da,ja,ha){return da.find(Z=>Z!==ja&&"feature"===Z.type&&Z.url===
ja.url&&Z.layerId===ha.relatedTableId)}const G=O.getLogger("esri.widgets.Feature.support.featureUtils"),K=/href=(""|'')/gi,U=/(\{([^\{\r\n]+)\})/g,Y=/'/g,ba=/^\s*expression\//i,la=/(\n)/gi,pa=/[\u00A0-\u9999<>&]/gim,va=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,xa=/^(?:mailto:|tel:)/,Aa=F.convertDateFormatToIntlOptions("short-date-short-time"),Ga=da=>{if(!da)return!1;da=da.toUpperCase();return da.includes("CURRENT_TIMESTAMP")||da.includes("CURRENT_DATE")||da.includes("CURRENT_TIME")},Da=({layer:da,method:ja,
query:ha,definitionExpression:Z})=>{da.capabilities?.query?.supportsCacheHint&&"attachments"!==ja&&(da=l.isSome(ha.where)&&ha.where,ja=l.isSome(ha.geometry)&&ha.geometry,Ga(Z)||Ga(da)||"extent"===ja?.type||"tile"===ha.resultType||(ha.cacheHint=!0))};g.applyTextFormattingHTML=H;g.createfieldInfoMap=function(da,ja){const ha=new Map;da&&da.forEach(Z=>{const ca=S(Z.fieldName,ja);Z.fieldName=ca;ha.set(ca.toLowerCase(),Z)});return ha};g.findRelatedLayer=function(da,ja,ha){return da&&ja&&ha?x(da.allLayers,
ja,ha)||x(da.allTables,ja,ha):null};g.fixTokens=A;g.formatAttributes=function({fieldInfos:da,attributes:ja,layer:ha,graphic:Z,fieldInfoMap:ca,relatedInfos:fa}){const ea={};fa?.forEach(na=>n({attributes:ea,relatedInfo:na,fieldInfoMap:ca,fieldInfos:da,layer:ha}));Object.keys(ja).forEach(na=>{ea[na]=d({fieldName:na,fieldInfos:da,fieldInfoMap:ca,layer:ha,value:ja[na],graphic:Z})});return ea};g.formatEditInfo=function(da,ja){const {creatorField:ha,creationDateField:Z,editorField:ca,editDateField:fa}=da;
if(ja){da=ja[fa];if("number"===typeof da)return ja=ja[ca],{type:"edit",date:F.formatDate(da,Aa),user:ja};da=ja[Z];return"number"===typeof da?(ja=ja[ha],{type:"create",date:F.formatDate(da,Aa),user:ja}):null}};g.formatValueToFieldInfo=e;g.getAllFieldInfos=function(da){const ja=[];if(!da)return ja;const {fieldInfos:ha,content:Z}=da;ha&&ja.push(...ha);if(!Z||!Array.isArray(Z))return ja;Z.forEach(ca=>{"fields"===ca.type&&(ca=ca&&ca.fieldInfos)&&ja.push(...ca)});return ja};g.getFieldInfo=c;g.getFieldInfoLabel=
function(da,ja){return(ja=I(ja,da?.fieldName))?ja.title||null:da?da.label||da.fieldName:null};g.getFixedFieldName=S;g.getFixedFieldNames=function(da,ja){return da&&da.map(ha=>S(ha,ja))};g.getSourceLayer=function(da){if(!l.isNone(da))return da.get("sourceLayer")||da.get("layer")};g.graphicCallback=function(da,ja){return Q.apply(this,arguments)};g.htmlEntities=function(da){return da.replace(pa,ja=>`&#${ja.charCodeAt(0)};`)};g.isExpressionField=y;g.isRelatedField=q;g.preLayerQueryCallback=({query:da,
layer:ja,method:ha})=>{Da({layer:ja,method:ha,query:da,definitionExpression:`${ja.definitionExpression} ${ja.serviceDefinitionExpression}`})};g.preRequestCallback=({queryPayload:da,layer:ja,method:ha})=>{Da({layer:ja,method:ha,query:da,definitionExpression:`${ja.definitionExpression} ${ja.serviceDefinitionExpression}`})};g.queryUpdatedFeature=function(da,ja){return B.apply(this,arguments)};g.shouldOpenInNewTab=function(da=""){if(da)return!xa.test(da.trim().toLowerCase())};g.substituteAttributes=D;
g.substituteFieldsInLinksAndAttributes=function({attributes:da,globalAttributes:ja,layer:ha,text:Z,expressionAttributes:ca,fieldInfoMap:fa}){return Z?D({formattedAttributes:ja,template:P(Z,{...ja,...ca,...da},ha),fieldInfoMap:fa}):""};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(g,u){g.getIconPath=function(f){const O=u.getAssetUrl("esri/themes/base/images/files/");
return f?"text/plain"===f?`${O}text-32.svg`:"application/pdf"===f?`${O}pdf-32.svg`:"text/csv"===f?`${O}csv-32.svg`:"application/gpx+xml"===f?`${O}gpx-32.svg`:"application/x-dwf"===f?`${O}cad-32.svg`:"application/postscript"===f||"application/json"===f||"text/xml"===f||"model/vrml"===f?`${O}code-32.svg`:"application/x-zip-compressed"===f||"application/x-7z-compressed"===f||"application/x-gzip"===f||"application/x-tar"===f||"application/x-gtar"===f||"application/x-bzip2"===f||"application/gzip"===f||
"application/x-compress"===f||"application/x-apple-diskimage"===f||"application/x-rar-compressed"===f||"application/zip"===f?`${O}zip-32.svg`:f.includes("image/")?`${O}image-32.svg`:f.includes("audio/")?`${O}sound-32.svg`:f.includes("video/")?`${O}video-32.svg`:f.includes("msexcel")||f.includes("ms-excel")||f.includes("spreadsheetml")?`${O}excel-32.svg`:f.includes("msword")||f.includes("ms-word")||f.includes("wordprocessingml")?`${O}word-32.svg`:f.includes("powerpoint")||f.includes("presentationml")?
`${O}report-32.svg`:`${O}generic-32.svg`:`${O}generic-32.svg`};g.isSupportedImage=function(f){f=f.toLowerCase();return"image/bmp"===f||"image/emf"===f||"image/exif"===f||"image/gif"===f||"image/x-icon"===f||"image/jpeg"===f||"image/png"===f||"image/tiff"===f||"image/x-wmf"===f};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/compilerUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../layers/support/domainUtils ../layers/support/fieldUtils ./Widget ./FeatureForm/FeatureFormViewModel ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../chunks/datetime ../intl/locale".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e){const c={datePattern:"D",timePattern:"tt"};O=function(b){function r(d,p){var z=b.call(this,d,p)||this;z._activeDateFieldEdit=null;z._activeInputName=null;z._activeNumberFieldEdit=null;z._fieldFocusNeeded=!1;z._fieldToInitialIncompatibleDomainValue=new Map;z._switchFieldsWithInitialIncompatibleValue=new Set;z._userUpdatedInputFieldNames=new Set;z.disabled=!1;z.groupDisplay="all";z.headingLevel=2;z.messages=null;z.messagesTemplates=null;z.viewModel=
new S;z._handleRadioInputChange=m=>{z._commitInputValue(m.target)};z._handleInputInput=m=>{z._commitInputValue(m.currentTarget,!0)};z._handleFormKeyDown=z._handleFormKeyDown.bind(u._assertThisInitialized(z));z._handleInputBlur=z._handleInputBlur.bind(u._assertThisInitialized(z));z._handleInputFocus=z._handleInputFocus.bind(u._assertThisInitialized(z));z._handleNumberInputMouseDown=z._handleNumberInputMouseDown.bind(u._assertThisInitialized(z));z._handleInputKeyDown=z._handleInputKeyDown.bind(u._assertThisInitialized(z));
z._handleOptionChange=z._handleOptionChange.bind(u._assertThisInitialized(z));z._handleGroupClick=z._handleGroupClick.bind(u._assertThisInitialized(z));z._handleSubmit=z._handleSubmit.bind(u._assertThisInitialized(z));z._afterInputCreateOrUpdate=z._afterInputCreateOrUpdate.bind(u._assertThisInitialized(z));return z}u._inheritsLoose(r,b);var H=r.prototype;H.initialize=function(){this.addHandles([F.watch(()=>this.feature,()=>{const d=this._getFocusableInput("forward");this._activeInputName=d&&d.name;
this._userUpdatedInputFieldNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();this._switchFieldsWithInitialIncompatibleValue.clear();this._fieldFocusNeeded=!0}),this.on("submit",d=>{if(0<d.invalid.length){const [p]=d.invalid;d.invalid.forEach(z=>this._userUpdatedInputFieldNames.add(z));this._activeInputName=p;this._fieldFocusNeeded=!0;this.scheduleRender()}})])};H.loadDependencies=function(){return Promise.all([new Promise((d,p)=>g(["../chunks/calcite-combobox"],d,p)),new Promise((d,
p)=>g(["../chunks/calcite-combobox-item"],d,p)),new Promise((d,p)=>g(["../chunks/calcite-combobox-item-group"],d,p)),new Promise((d,p)=>g(["../chunks/calcite-input-message"],d,p)),new Promise((d,p)=>g(["../chunks/calcite-progress"],d,p)),new Promise((d,p)=>g(["../chunks/calcite-switch"],d,p))])};H.destroy=function(){this._userUpdatedInputFieldNames.clear();this._userUpdatedInputFieldNames=null};H.getValues=function(){return this.viewModel.getValues()};H.submit=function(){return this.viewModel.submit()};
H.render=function(){const {state:d}=this.viewModel;return A.tsx("div",{class:this.classes("esri-feature-form","esri-widget","esri-widget--panel")},"ready"===d?this.renderForm():null)};H.renderForm=function(){var {formTemplate:d}=this,p=C.isSome(d)&&d.title&&A.tsx(R.Heading,{key:"title",level:this.headingLevel},d.title);d=C.isSome(d)&&d.description&&A.tsx("p",{class:"esri-feature-form__description-text",key:"description"},d.description);p=p||d?A.tsx("div",{class:"esri-feature-form__form-header"},p,
d):null;return A.tsx("form",{class:"esri-feature-form__form",novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},p,this.renderFields())};H.renderFields=function(){const {viewModel:{inputFields:d}}=this;return d.filter(p=>p.visible).map((p,z)=>p&&p.inputFields?this.renderGroup(p,z):this.renderLabeledField(p))};H.renderGroup=function(d,p){const {formTemplate:z,disabled:m}=this,{description:k,inputFields:B,label:q,state:T}=d,n=B.filter(va=>va.visible);var x=this.viewModel.findField(this._activeInputName);
x=!(!x||x.group!==d);const G=`${this.id}_group_${p}`,K=`${this.id}_group-label_${p}`,U=`${this.id}_group-description_${p}`,Y=k?A.tsx("p",{class:this.classes("esri-feature-form__group-description","esri-feature-form__description-text"),id:U},k):null,ba="sequential"===this.groupDisplay,la=ba?x:"expanded"===T,pa=la?"esri-icon-up":"esri-icon-down";return A.tsx("fieldset",{"aria-expanded":la.toString(),"aria-labelledby":K,"aria-describedby":k?U:"",class:this.classes("esri-feature-form__group",ba?"esri-feature-form__group--sequential":
null,la?null:"esri-feature-form__group--collapsed",x?"esri-feature-form__group--active":null,m?"esri-feature-form__input--disabled":null),disabled:m,"data-group":d,id:G,key:p,onclick:this._handleGroupClick},A.tsx("button",{role:ba?"presentation":void 0,class:"esri-feature-form__group-header",type:"button",tabIndex:ba?-1:0},A.tsx("div",{class:"esri-feature-form__group-title"},A.tsx(R.Heading,{class:"esri-feature-form__group-label",id:K,level:C.isSome(z)&&z.title?R.incrementHeadingLevel(this.headingLevel):
this.headingLevel},q),Y),ba?null:A.tsx("span",{class:this.classes(pa,"esri-feature-form__group-toggle-icon")})),n.map(va=>this.renderLabeledField(va)))};H._getFocusableInput=function(d,p){var z=this.viewModel.allInputFields;z="forward"===d?z:z.slice().reverse();p?p&&p.inputFields?d=z.indexOf(p.inputFields[0]):(this._isInputFieldInGroup(p)&&"collapsed"===p.group.state?({inputFields:p}=p.group,d="forward"===d?p[p.length-1]:p[0]):d=p,d=z.indexOf(d)+1):d=0;for(;d<z.length;d++)if(p=z[d],p.visible)return p;
return null};H.renderLabeledField=function(d){const {feature:p,label:z,layer:m,type:k}=d;return A.tsx("label",{key:`${m.id}-${p.uid}-${d.name}`,class:"esri-feature-form__label"},[z,"unsupported"!==k?this.renderInputField(d):this.renderUnsupportedField(d),this.renderAuxiliaryText(d)])};H.renderInputField=function(d){const {domain:p,name:z,type:m,updating:k,value:B}=d,q=this.getCommonInputProps(d);if("coded-value"===p?.type){if(this._inputFieldHasInputType(d,"switch")){const {fieldElement:T}=d;if(this._switchFieldsWithInitialIncompatibleValue.has(z)||
null==B||T.input.onValue!==B&&T.input.offValue!==B)this._switchFieldsWithInitialIncompatibleValue.add(z);else return this.renderSwitchInputField(d,q)}return"radio-buttons"===d.inputType?this.renderRadioButtonsInputField(d,p.codedValues.map(({code:T,name:n})=>({value:T,name:n})),q):this.renderSelectInputField(d,this._getFieldValueOptions(z,p),q)}if("datetime-picker"===d.inputType||"date"===m)return this.renderDateInputField(d,q);d="number"===m?A.tsx("input",{type:"number",...q,value:C.isSome(this._activeNumberFieldEdit)&&
this._activeNumberFieldEdit.fieldName===d.name?this._activeNumberFieldEdit.value:`${q.value}`}):"text-area"===d.inputType?A.tsx("textarea",{...q}):A.tsx("input",{type:"text",...q});return k?A.tsx("div",{class:"esri-feature-form__input-wrapper"},d,A.tsx("div",{class:"esri-feature-form__input-loader"},A.tsx("calcite-progress",{type:"indeterminate"}))):d};H._parseDateTime=function(d,p,z){if(z)return d=P.DateTime.fromJSDate(this._parseDate(d,z)),p=P.DateTime.fromMillis(p.value??Date.now()),d="date"===
z?d.set({hour:p.hour,minute:p.minute,second:p.second}):d.set({day:p.day,month:p.month,year:p.year}),d.isValid?d.toMillis():null;z=P.DateTime.fromJSDate(this._parseDate(d));return z.isValid?z.toMillis():null};H.renderDateInputField=function(d,p){const {value:z,includeTime:m}=d,{date:k,time:B}=this._formatDate(0);var q=`${this.id}-${p.key}`;const T=`${q}-date`;q=`${q}-time`;const {_activeDateFieldEdit:n}=this;let {date:x,time:G}=this._formatDate(z);n?.fieldName===d.name&&(x=n.date.input?.value??x,G=
n.time.input?.value??G);return A.tsx("div",{key:`${p.key}-date`,class:"esri-feature-form__date-input-container"},A.tsx("div",{class:this.classes("esri-feature-form__date-input-part",m?null:"esri-feature-form__date-input-part--lone")},A.tsx("input",{"aria-label":d.label,"aria-describedby":T,type:"text",...p,"data-date-part":"date",class:this.classes(p.class,"esri-feature-form__input--date"),value:x}),A.tsx("div",{class:"esri-feature-form__date-format-hint",id:T},k)),m?A.tsx("div",{class:"esri-feature-form__date-input-part",
key:"time-input"},A.tsx("input",{"aria-describedby":q,"aria-label":d.label,type:"text",...p,"data-date-part":"time",class:this.classes(p.class,"esri-feature-form__input--time"),value:G}),A.tsx("div",{class:"esri-feature-form__date-format-hint",id:q},B)):null)};H.renderUnsupportedField=function(d){d=this.getCommonInputProps(d);return A.tsx("input",{afterCreate:d.afterCreate,afterUpdate:d.afterUpdate,disabled:d.disabled,class:this.classes("esri-input","esri-feature-form__input","esri-feature-form__input--disabled"),
onfocus:d.onfocus,readOnly:!0,tabIndex:d.tabIndex,type:"text",value:d.value,["data-field-name"]:d["data-field-name"]})};H.renderSelectInputField=function(d,p,z){const {value:m}=d,{messages:k,messagesTemplates:B}=this;var q=p.map(x=>x.map(G=>A.tsx("calcite-combobox-item",{value:`${G.value}`,"text-label":G.name,key:`#${G.value}`,selected:m===G.value})));const [T,n]=q;this._registerIncompatibleValue(m,p.flat(),d,x=>{n.unshift(A.tsx("calcite-combobox-item",{value:`${x}`,"text-label":`${x}`,key:"incompatible-option",
readOnly:!0}))});p=0<n.length?[A.tsx("calcite-combobox-item-group",{key:"recommended",label:k.recommended},T),A.tsx("calcite-combobox-item-group",{key:"other",label:B.other},n)]:T;q=C.isNone(d.fieldElement)||this._inputFieldHasInputType(d,"combo-box")&&d.fieldElement.input.showNoValueOption;!d.required&&q&&(d=this._inputFieldHasInputType(d,"combo-box")&&d.fieldElement.input.noValueOptionLabel||this.messages.empty,p.unshift(A.tsx("calcite-combobox-item",{value:"","text-label":this.messages.empty,key:"empty-option"},
d)));return A.tsx("calcite-combobox",{...z,"selection-mode":"single","overlay-positioning":"fixed",disabled:z.disabled||z.readOnly,allowCustomValues:!1,onCalciteComboboxChange:x=>this._handleOptionChange(x.target)},p)};H._registerIncompatibleValue=function(d,p,z,m){const k=this._fieldToInitialIncompatibleDomainValue,B=k.has(z.name);if(B||null!=d&&""!==d&&!p.some(q=>q.value===d)||B)B||k.set(z.name,d),m?.(k.get(z.name))};H.renderRadioButtonsInputField=function(d,p,z){const {value:m}=d,k=p.map(B=>this.renderRadioButton({key:B.name,
label:B.name,name:d.name,value:B.value,selected:B.value===m,props:z}));this._registerIncompatibleValue(m,p,d);p=C.isNone(d.fieldElement)||this._inputFieldHasInputType(d,"radio-buttons")&&d.fieldElement.input.showNoValueOption;!d.required&&p&&(p=this._inputFieldHasInputType(d,"radio-buttons")&&d.fieldElement.input.noValueOptionLabel||this.messages.empty,k.unshift(this.renderRadioButton({key:"empty-option",label:p,name:d.name,value:"",selected:""===m||null===m,props:z})));return A.tsx("div",{key:`${z.key}-radio`,
class:"esri-feature-form__input--radio-group"},k)};H.renderSwitchInputField=function(d,p){const {value:z}=d;d=this._inputFieldHasInputType(d,"switch")?z===d.fieldElement.input.onValue:!1;return A.tsx("calcite-switch",{...p,class:"esri-feature-form__input--switch",onCalciteSwitchChange:m=>{this._parseValue(m.currentTarget)},checked:d,disabled:p.disabled||p.readOnly})};H.renderRadioButton=function({key:d,name:p,value:z,selected:m,label:k,props:B}){return A.tsx("label",{key:d,class:"esri-feature-form__input--radio-label"},
A.tsx("input",{...B,class:"esri-feature-form__input--radio",name:p,type:"radio",value:z,checked:m,onchange:this._handleRadioInputChange}),k)};H.renderAuxiliaryText=function(d){const p=this._userUpdatedInputFieldNames.has(d.name)&&!d.valid?d.errorMessage:C.isSome(this.viewModel.contingencyConstraintViolations.get(d.name))?this.messages.validationErrors.valuesIncompatible:C.isSome(d.valueExpressionExecutor)&&d.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;if(C.isSome(p))return A.tsx("calcite-input-message",
{status:"invalid",icon:!0,active:!0},p);if(d.description)return A.tsx("div",{key:"description",class:"esri-feature-form__description-text"},d.description)};H.getCommonInputProps=function(d){const {disabled:p,groupDisplay:z}=this,{editable:m,group:k,hint:B,maxLength:q,minLength:T,name:n,required:x,type:G,valid:K,value:U}=d,Y=this._userUpdatedInputFieldNames.has(n),ba=!m,la="all"===z&&C.isSome(k)&&"collapsed"===k.state;return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,
"aria-invalid":K?"false":"true",class:this.classes("esri-input","esri-feature-form__input",p||ba?"esri-feature-form__input--disabled":null,Y&&!K?"esri-feature-form__input--invalid":null),key:n,label:n,minlength:-1<T?`${T}`:"",maxlength:-1<q?`${q}`:"",...this._getNumberFieldConstraints(d),disabled:p,readOnly:ba,value:null==U?"":`${U}`,["data-field-name"]:n,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===
G?this._handleNumberInputMouseDown:null,placeholder:"number"===G||"text"===G?B:"",required:x,tabIndex:la?-1:0}};H._isInputFieldInGroup=function(d){return!(d&&d.inputFields)&&C.isSome(d.group)};H._handleNumberInputMouseDown=function({target:d}){d.focus();this.scheduleRender()};H._getFieldValueOptions=function(d,p){p=p.codedValues.map(({code:z,name:m})=>({value:z,name:m}));d=this.viewModel.fieldsWithContingentValues.has(d)?this._getContingentValueOptions(d):[];if(0<d.length){const z=new Set(d.map(m=>
m.value));p=p.filter(m=>!z.has(m.value));return[d,p]}return[p,[]]};H._getContingentValueOptions=function(d){const p={};for(var z of this.viewModel.allInputFields){const {name:k,value:B}=z;!C.isNone(B)&&k!==d&&this.viewModel.fieldsWithContingentValues.has(k)&&(p[k]=B)}var m=this.viewModel.joinedContingentValues.slice();z=new Map;for(const k of m){m=k.values[d];if(C.isNone(m)||"code"!==m.objectType&&"null"!==m.objectType)continue;const {code:B,name:q}="null"===m.objectType?{code:"",name:this.messages.empty}:
m.codedValue;z.has(B)||Object.entries(p).every(([T,n])=>!k.values.hasOwnProperty(T)||this._valueIsValidContingentValue(n,k.values[T]))&&z.set(B,{name:q,value:B})}return[...z.values()]};H._getInputFieldFromInput=function(d){return this.viewModel.findField(d.getAttribute("data-field-name"))};H._getNumberFieldConstraints=function(d){return(d=Q.getDomainRange(d.domain)||y.getFieldRange(d.field))&&d.max!==Number.MAX_VALUE&&d.min!==Number.MIN_VALUE?d:{min:null,max:null}};H._afterInputCreateOrUpdate=function(d){var {viewModel:p}=
this;const z=this._getInputFieldFromInput(d);p=p.findField(this._activeInputName);const m=this._fieldToInitialIncompatibleDomainValue.get(z.name)===z.value;this._fieldFocusNeeded&&p===z&&("radio-buttons"!==z.inputType||m||d.checked)&&(this._fieldFocusNeeded=!1,this._isInputFieldInGroup(z)&&(z.group.state="expanded"),d.focus())};H._handleInputFocus=function(d){d=d.target;const p=this._getInputFieldFromInput(d);this._activeInputName=p.name;"date"===p.type?this._syncDateFieldEdits(d):this._isNumberInputField(p)&&
this._setUpNumberFieldEdit(d)};H._isNumberInputField=function({domain:d,inputType:p="text-box",type:z}){return"number"===z&&"text-box"===p&&(!d||"coded-value"!==d.type)};H._handleInputBlur=function(d){const p=d.target,z=this._getInputFieldFromInput(p);if("date"===z.type){const k=d.relatedTarget;var m=k&&this._getInputFieldFromInput(k);if(m&&"date"===z.type&&"date"===m.type&&z.field===m.field){""!==p.value&&""===k.value&&(m=k.getAttribute("data-date-part"),k.value=this._formatDate(z.value??Date.now())[m],
this._parseDate(p.value,p.getAttribute("data-date-part"))&&this._commitInputValue(d.target,!0,!1));return}}"number"===z.type&&C.isSome(this._activeNumberFieldEdit)&&(this._activeNumberFieldEdit.input.value=`${z.value}`,this._activeNumberFieldEdit=null);this._commitInputValue(p);this.scheduleRender()};H._commitInputValue=function(d,p=!1,z=!0){const m=this._getInputFieldFromInput(d);if(this._activeDateFieldEdit){const {date:k,time:B}=this._activeDateFieldEdit,q=this._parseDateTime(d.value,m,k.active?
"date":"time");d=null!==this.viewModel.getValue(m.name);const T=k.input&&(B.input||!m.includeTime),n=null===q;p?n||(T||!z||d)&&this._updateDateFieldValue(m,q):(""===k.input?.value||""===B.input?.value?this._updateDateFieldValue(m,null):T&&(p=this._parseDateTime(`${k.input.value} ${B.input?.value??""}`,m),null===p&&d||this._updateDateFieldValue(m,p)),this._activeDateFieldEdit=null)}else C.isSome(this._activeNumberFieldEdit)&&this._isNumberInputField(m)&&(this._activeNumberFieldEdit.value=d.value),
this._updateFieldValue(d)};H._handleInputKeyDown=function(d){const {key:p,altKey:z,ctrlKey:m,metaKey:k}=d;var B=this._getInputFieldFromInput(d.target);if("Enter"!==p){var {type:q}=B.field;B="single"===q||"double"===q;if(!("integer"!==q&&"small-integer"!==q&&!B||z||m||k)&&1===p.length){q=Number(p);const T=["-","+"],n=["e","."];B=B?[...T,...n]:T;isNaN(q)&&!B.includes(p)&&d.preventDefault()}}else this._isInputFieldInGroup(B)&&"collapsed"===B.group.state&&(B.group.state="expanded")};H._setUpNumberFieldEdit=
function(d){this._activeNumberFieldEdit={fieldName:this._getInputFieldFromInput(d).name,input:d,value:d.value}};H._syncDateFieldEdits=function(d){const p=this._getInputFieldFromInput(d);if("date"===p.type){var z=d.getAttribute("data-date-part");this._activeDateFieldEdit={fieldName:p.name,date:"date"===z?{value:d.value,input:d,active:!0}:{...this._activeDateFieldEdit?.date,active:!1},time:"time"===z?{value:d.value,input:d,active:!0}:{...this._activeDateFieldEdit?.time,active:!1}}}};H._updateFieldValue=
function(d){const p=d.getAttribute("data-field-name");this.viewModel.setValue(p,this._parseValue(d));this._userUpdatedInputFieldNames.add(p);this.viewModel.fieldsWithContingentValues.has(p)&&(d=Object.fromEntries(Object.entries(this.getValues()).filter(([,z])=>C.isSome(z))),this.viewModel.validateContingencyConstraints(d))};H._updateDateFieldValue=function(d,p){this.viewModel.setValue(d.name,p);this._userUpdatedInputFieldNames.add(d.name)};H._parseValue=function(d){var p=this._getInputFieldFromInput(d),
z=d.value;if(this._inputFieldHasInputType(p,"switch")&&"CALCITE-COMBOBOX"!==d.tagName)return d.checked?p.fieldElement.input.onValue:p.fieldElement.input.offValue;if("radio-buttons"===p.inputType&&"radio"===d.type&&!d.checked)return p.value;var {type:m}=p;if("number"===m)return z?parseFloat(z):null;if("date"===m){if(!z)return null;m=Number(z);if(!isNaN(m))return m;d=d.getAttribute("data-date-part");z=this._parseDate(z,d);if(!z)return null;z=P.DateTime.fromJSDate(z);var k=p.domain;const B=P.DateTime.now();
m=B;k&&"range"===k.type&&(k=P.DateTime.fromMillis(k.maxValue),B<k&&(m=k));p=this.viewModel.getValue(p.name);p=null!=p?P.DateTime.fromMillis(p):m;z="date"===d?z.set({hour:p.hour,minute:p.minute,second:p.second}):z.set({day:p.day,month:p.month,year:p.year});return z.toMillis()}return z};H._handleOptionChange=function(d){this._commitInputValue(d);this.scheduleRender()};H._handleGroupClick=function(d){const p=d.currentTarget["data-group"],z="expanded"===p.state,m="sequential"===this.groupDisplay;if(!z||
d.target.closest(".esri-feature-form__group-header")){this._activeInputName=this._getFocusableInput("forward",p)?.name;if(m){d=d.target.closest(".esri-feature-form__group-header");if(z&&!d)return;this.viewModel.inputFields.forEach(k=>{k&&k.inputFields&&k!==p&&(k.state="collapsed")})}p.state=z?"collapsed":"expanded";this._fieldFocusNeeded=m;this.scheduleRender()}};H._handleSubmit=function(d){d.preventDefault()};H._handleFormKeyDown=function(d){"Enter"===d.key&&this.viewModel.submit()};H._formatDate=
function(d){if(null==d)return{date:"",time:""};d=P.DateTime.fromMillis(d,{locale:e.getLocale(),numberingSystem:"latn"});return{date:d.toLocaleString({year:"numeric",month:"2-digit",day:"2-digit"}),time:d.toFormat(c.timePattern)}};H._parseDate=function(d,p){if(null==d||""===d)return null;const {timePattern:z,datePattern:m}=c;d=P.DateTime.fromFormat(d,p?"date"===p?m:z:`${m} ${z}`,{locale:e.getLocale(),numberingSystem:"latn"});return d.isValid?d.toJSDate():null};H._inputFieldHasInputType=function(d,
p){return C.isSome(d.fieldElement)&&d.fieldElement.input?.type===p};H._valueIsValidContingentValue=function(d,p){switch(p.objectType){case "any":return!0;case "null":return null==d;case "code":return d===p.codedValue?.code;case "range":return d>=p.minValue&&d<=p.maxValue;default:return l.neverReached(p.objectType),!1}};u._createClass(r,[{key:"feature",get:function(){return this.viewModel.feature},set:function(d){this.viewModel.feature=d}},{key:"formTemplate",get:function(){return this.viewModel.formTemplate},
set:function(d){this.viewModel.formTemplate=d}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(d){this._overrideIfSome("label",d)}},{key:"layer",get:function(){return this.viewModel.layer},set:function(d){this.viewModel.layer=d}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(d){this.viewModel.spatialReference=d}},{key:"strict",get:function(){return this.viewModel.strict},set:function(d){this.viewModel.strict=d}},{key:"view",
get:function(){return this.viewModel.view},set:function(d){this.viewModel.view=d}}]);return r}(I);f.__decorate([w.property()],O.prototype,"disabled",void 0);f.__decorate([w.property()],O.prototype,"feature",null);f.__decorate([w.property()],O.prototype,"formTemplate",null);f.__decorate([w.property()],O.prototype,"groupDisplay",void 0);f.__decorate([w.property()],O.prototype,"headingLevel",void 0);f.__decorate([w.property()],O.prototype,"label",null);f.__decorate([w.property()],O.prototype,"layer",
null);f.__decorate([w.property(),E.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],O.prototype,"messages",void 0);f.__decorate([w.property(),E.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],O.prototype,"messagesTemplates",void 0);f.__decorate([w.property()],O.prototype,"spatialReference",null);f.__decorate([w.property()],O.prototype,"strict",null);f.__decorate([w.property()],O.prototype,"view",null);f.__decorate([w.property(),J.vmEvent(["value-change","submit"])],
O.prototype,"viewModel",void 0);return O=f.__decorate([L.subclass("esri.widgets.FeatureForm")],O)})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../intl ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../form/FormTemplate ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ./FormExpressionArcadeExecutor ./FormExpressionsManager ./InputField ./InputFieldGroup ../../intl/locale ../../intl/messages".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e,c,b){const r=new f({attributes:{}}),H=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],d=["visibilityExpression"];f=function(m){function k(q){q=m.call(this,q)||this;q._expressionExecutorLookup=new Map;q._expressionLookup=new Map;q._expressionsManager=null;q._contingentValuesCache=null;q._featureClone=r.clone();q._initialFeature=r.clone();q.arcadeEditType="NA";q.contingencyConstraintViolations=new Map;q.inputFields=
[];q.messages=null;q.strict=!1;return q}g._inheritsLoose(k,m);var B=k.prototype;B.initialize=function(){var q=this;const T=function(){var G=g._asyncToGenerator(function*(){const K=yield b.fetchMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm");q.messages=K;for(const U of q.allInputFields)U.messages=K});return function(){return G.apply(this,arguments)}}();T();const n=h.watch(()=>[this.layer,this.layer?.loaded,this.formTemplate],()=>{w.isSome(this.layer)&&this.layer.loaded&&this._updateInputFields()},
{equals:([G,K,U],[Y,ba,la])=>G===Y&&K===ba&&U===la,initial:!0}),x=h.watch(()=>this.layer,G=>{"feature"===G?.type&&this.addResolvingPromise(E.createLoadedLayerContingentValuesCache(G).then(K=>{this._contingentValuesCache=K;this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.handles.add([c.onLocaleChange(T),n,x])};B.destroy=function(){this.layer=this.feature=null;this._contingentValuesCache=w.destroyMaybe(this._contingentValuesCache)};B.findField=function(q){return this.allInputFields.find(T=>
T.name===q)};B.getValue=function(q){const {_featureClone:T,layer:n}=this,x=!!n?.getField(q);return T.getAttribute(q)??(x?null:void 0)};B.setValue=function(q,T){const {_featureClone:n,strict:x}=this,G=this.findField(q);T=""===T?null:T;G&&n.getAttribute(q)!==T&&(G.value=T,!x||G.valid)&&(this._afterValueChange(G),w.isSome(this._expressionsManager)&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([G.name]).finally(()=>this._afterExpressionsEvaluated())))};B.getValues=function(){return{...this._featureClone.attributes}};
B.submit=function(){var q=this.allInputFields;const T=new Set(q.filter(x=>x.valid).map(({name:x})=>x));q=q.filter(x=>!x.valid).map(({name:x})=>x);const n=this.getValues();if(0<this.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length)for(const [x,G]of this.contingencyConstraintViolations.entries())"error"===G.type&&(T.delete(x),q.push(x));this.emit("submit",{valid:[...T],invalid:q,values:n})};B.validateContingencyConstraints=function(q,T){const {_contingentValuesCache:n}=this,
x=new Map;this.contingencyConstraintViolations=x;if(w.isNone(n))return[];const {invalid:G,incomplete:K}=n.validateContingencyConstraints(q);q=[...G,...(T?.includeIncompleteViolations?K:[])];for(const U of q)for(const Y of U.fieldGroup.fields)x.set(Y,U);return q};B.notifyFeatureGeometryChanged=function(){const {_expressionsManager:q,feature:T,_featureClone:n}=this;n.geometry=T.geometry;w.isSome(q)&&this.updatingHandles.addPromise(q.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))};
B._emitChangeEvent=function({name:q,valid:T,value:n}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:q,value:n,valid:T})};B._updateInputFields=function(){const {_featureClone:q,_initialFeature:T,formTemplate:n,inputFields:x,messages:G,layer:K}=this,U={feature:q,initialFeature:T,layer:K,messages:G},Y=x.slice();this.inputFields=w.isSome(n)&&0<n.elements.length?this._updateInputFieldsFromElements(Y,n.elements,U):this._updateInputFieldsFromLayerFields(Y,K?.fields,U)};B._updateInputFieldsFromElements=
function(q,T,n){const x=new Map;for(const K of q)if(K.inputFields){z(x,K.groupElement,K);for(const U of K.inputFields)z(x,U.fieldElement,U)}else z(x,K.fieldElement,K);q=new Map;const G=this._updateInputFieldsRecursive({existingInputFieldsByElement:x,updatedElements:T.filter(this._isSupportedElement),sharedInitializationProperties:n,group:null,newExpressionExecutorPromises:q});this.updatingHandles.addPromise(Promise.all(Array.from(q.values())).then(()=>{const K=Array.from(this._expressionExecutorLookup.values()),
U=p(G);this._createExpressionsManager(K,U);return w.unwrap(this._expressionsManager).evaluateAll().finally(()=>this._afterExpressionsEvaluated())}));for(const [K,U]of x.entries())x.delete(K),U.destroy();return G};B._updateInputFieldsRecursive=function(q){const {existingInputFieldsByElement:T,updatedElements:n,sharedInitializationProperties:x,group:G,newExpressionExecutorPromises:K}=q;q=[];for(const Y of n){var U=T.has(Y);const ba=U?T.get(Y):"group"===Y.type?this._makeInputFieldGroupFromGroupElement(Y,
x):this._makeInputFieldFromFieldElement(Y,x,G);q.push(ba);U?(T.delete(Y),ba.inputFields?({feature:U}=x,ba.set({feature:U})):ba.set(x)):this._assignExpressionExecutors(ba,Y,K);"group"===Y.type&&(U=Y.elements.filter(la=>this._isSupportedElement(la)),ba.inputFields=this._updateInputFieldsRecursive({existingInputFieldsByElement:T,updatedElements:U,sharedInitializationProperties:x,group:ba,newExpressionExecutorPromises:K}))}return q};B._updateInputFieldsFromLayerFields=function(q,T,n){if(!Array.isArray(T))return F.getLogger(this.declaredClass).warn(this.declaredClass,
"No attribute fields found."),[];const x=new Map;for(const ba of q)if(ba.inputFields){for(const la of ba.inputFields)la.destroy();ba.inputFields.length=0;ba.destroy()}else w.isSome(ba.fieldElement)?ba.destroy():x.set(ba.field,ba);q=[];const {feature:G,initialFeature:K,layer:U,messages:Y}=n;for(const ba of T)T=x.get(ba)??new P({field:ba,feature:G,initialFeature:K,layer:U,messages:Y,value:G.getAttribute(ba.name)??null}),q.push(T),x.delete(ba);for(const [ba,la]of x.entries())x.delete(ba),la.destroy();
return q};B._resetInputFieldValues=function(q){for(const T of this.allInputFields)T.value=q.getAttribute(T.name)};B._makeInputFieldFromFieldElement=function(q,T,n=null){const {feature:x,initialFeature:G,layer:K,messages:U}=T;return new P({fieldElement:q,field:this._layerFieldsByName.get(q.fieldName),value:x.getAttribute(q.fieldName)??null,feature:x,initialFeature:G,layer:K,group:n,messages:U})};B._makeInputFieldGroupFromGroupElement=function(q,T){const {feature:n,initialFeature:x}=T;return new e({groupElement:q,
inputFields:[],feature:n,initialFeature:x})};B._assignExpressionExecutors=function(q,T,n){var x="group"===T.type?d:H;for(const G of x){x=T[G];const {_expressionExecutorLookup:K}=this;if(w.isSome(x)&&""!==x){const U=`${G}Executor`,Y=this._expressionLookup.get(x)??this._addToExpressionLookup(x);K.has(Y)?q[U]=K.get(Y):n.has(Y)?(x=n.get(Y).then(ba=>q[U]=ba),n.set(Y,x)):(x=J.createFormExpressionArcadeExecutor(Y,this.layer).then(ba=>{q[U]=ba;K.set(Y,ba);return ba}),n.set(Y,x))}}return[]};B._createExpressionsManager=
function(q,T){const {_arcadeContextInfo:n,_featureClone:x}=this;this._expressionsManager=new A.FormExpressionsManager({executors:q,feature:x,arcadeContextInfo:n,inputFields:T})};B._afterValueChange=function(q){const {name:T,value:n}=q;if(this.get("layer.typeIdField")===T&&"types"in this.layer){const x=new Set;this.layer.types.forEach(G=>Object.keys(G.domains).forEach(K=>x.add(K)));x.forEach(G=>{(G=this.findField(G))&&G.notifyChange("domain")})}this._featureClone.setAttribute(T,n);this._emitChangeEvent(q)};
B._afterExpressionsEvaluated=function(){const {_featureClone:q}=this;for(const T of this.allInputFields)T.value!==q.getAttribute(T.name)&&this._afterValueChange(T)};B._addToExpressionLookup=function(q){const {_expressionLookup:T,formTemplate:n}=this,x=(w.isSome(n)&&w.isSome(n.expressionInfos)?Object.values(n.expressionInfos).find(G=>G.name===q):null)?.expression??q;T.set(q,x);q!==x&&T.set(x,x);return x};B._isSupportedElement=function(q){if("field"===q.type||"group"===q.type)return!0;F.getLogger(this.declaredClass).warn("form-info::unsupported-element-type",
"Only element types 'field' and 'group' are supported",`Element ${q.label} has unsupported type '${q.type}'`);return!1};B._joinContingentValues=function(){var q=this._contingentValuesCache;if(w.isNone(q))return[];var T="typeIdField"in this.layer?this.layer.typeIdField:null;T=T?this.getValue(T):null;const n=[];for(var x of q.fieldGroups){const {contingencies:Y,fields:ba,name:la}=x;q=[];for(var G of Y)G.isRetired||w.isSome(G.subtype)&&G.subtype.code!==T||q.push({values:G.values});0<q.length&&n.push({name:la,
fields:ba,contingencies:q})}const [K,U]=this._generateJoinPlan(n);x=K.flatMap(Y=>this._joinFieldGroupContingencies(Y));G=U.flatMap(Y=>Y.contingencies);return[...x,...G]};B._generateJoinPlan=function(q){var T=new Map,n=[],x=new Set;for(var G of q)for(const ba of G.fields)if(T.has(ba)){const la=T.get(ba),pa=G,va=[la.name,pa.name].sort().join("|");x.has(va)||(n.push([la,pa]),x.add(va),T.set(ba,pa))}else T.set(ba,G);T=new Set(n.flat());q=new Set(q);for(var K of T)q.delete(K);K=new Map;T=new Map;for(var U of new Set(n.flat()))x=
Symbol(U.name),K.set(x,new Set([U])),T.set(U,x);for(const [ba,la]of n)if(n=T.get(ba),U=T.get(la),n!==U){x=K.get(n);G=K.get(U);for(var Y of G)x.add(Y),T.set(Y,n);K.delete(U)}Y=[...K.values()].map(ba=>[...ba]);n=[...q];return[Y,n]};B._joinFieldGroupContingencies=function(q){const T=q.slice();var n=T.shift(),x=T.shift();q=this._generateJoinKey(n.fields,x.fields);let G=new Set([...n.fields,...x.fields]),K=new Map;for(var U of n.contingencies)[n]=this._hashContingency(U,q.codedValueFields,!0),K.has(n)?
K.get(n).push(U):K.set(n,[U]);for(;0<T.length;){U=new Map;n=T.shift();const la=this._generateJoinKey(G,n.fields);for(var Y of x.contingencies){const [pa,va]=this._hashContingency(Y,q.codedValueFields);x=va?this._findMatchingContingenciesWithAnyHashMask(K,pa):K.get(pa);K.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&x.push(...this._findMatchingContingenciesContainingAny(Y,K.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),q.codedValueFields));if(!w.isNone(x))for(var ba of x){x=0<q.rangeFields.length?this._joinContingenciesWithRangeDomains(ba,
Y,q.rangeFields):this._joinContingencies(ba,Y);if(w.isNone(x))break;const [xa]=this._hashContingency(x,la.codedValueFields,!0);U.has(xa)?U.get(xa).push(x):U.set(xa,[x])}}K=U;x=n;q=la;G=new Set([...G,...x.fields])}Y=[];for(const la of x.contingencies){const [pa,va]=this._hashContingency(la,q.codedValueFields);ba=va?this._findMatchingContingenciesWithAnyHashMask(K,pa):K.get(pa);K.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&ba.push(...this._findMatchingContingenciesContainingAny(la,K.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),
q.codedValueFields));if(!w.isNone(ba))for(const xa of ba)ba=0<q.rangeFields.length?this._joinContingenciesWithRangeDomains(xa,la,q.rangeFields):this._joinContingencies(xa,la),w.isSome(ba)&&Y.push(ba)}return Y};B._joinContingencies=function(q,T){T={values:{...q.values,...T.values}};for(const [n,x]of Object.entries(T.values))"any"===x.objectType&&w.isSome(q.values[n])&&(T.values[n]=q.values[n]);return T};B._joinContingenciesWithRangeDomains=function(q,T,n){const x=this._joinContingencies(q,T);for(const K of n){var G=
q.values[K];const U=T.values[K],{leftIsNull:Y,rightIsNull:ba,bothAreNull:la,leftIsAny:pa,rightIsAny:va,bothAreAny:xa,leftIsRange:Aa,rightIsRange:Ga}=this._compareObjectTypes(G.objectType,U.objectType);if(!la&&!xa)if(Y&&va||ba&&pa)x.values[K]=new R({objectType:"null"});else{if(Y&&Ga||ba&&Aa)return null;pa?(G.minValue=-Infinity,G.maxValue=Infinity):va&&(U.minValue=-Infinity,U.maxValue=Infinity);n=Math.max(G.minValue,U.minValue);G=Math.min(G.maxValue,U.maxValue);if(n>G)return null;x.values[K]=new R({objectType:"range",
minValue:n,maxValue:G})}}return x};B._findMatchingContingenciesContainingAny=function(q,T,n){return T.filter(x=>n.every(G=>{const K=x.values[G];G=q.values[G];return"any"===K.objectType||"any"===G.objectType||K.codedValue?.code===G.codedValue?.code}))};B._findMatchingContingenciesWithAnyHashMask=function(q,T){T=RegExp(`${T}$`);const n=[];for(const [x,G]of q){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===x)break;T.test(x)&&n.push(...G)}return n};B._generateJoinKey=function(q,T){q=Array.isArray(q)?new Set(q):
q;var n=Array.isArray(T)?new Set(T):T;T=q.size<n.size?q:n;q=T===q?n:q;n=new Set;const x=new Set;for(const G of T)if(q.has(G)&&(T=this.layer.getFieldDomain(G,{feature:this.feature}),!w.isNone(T)))switch(T.type){case "coded-value":n.add(G);break;case "range":x.add(G)}return{codedValueFields:[...n],rangeFields:[...x]}};B._hashContingency=function(q,T,n=!1){if(1>T.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const x=[];let G=!1;for(const K of T)if(T=q.values[K],"any"===T.objectType){if(n)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",
!0];G=!0;x.push(`${K}:.*`)}else"null"===T.objectType?x.push(`${K}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):x.push(`${K}:${T.codedValue?.code}`);return[x.sort().join("\x26"),G]};B._compareObjectTypes=function(q,T){return{leftIsNull:"null"===q,rightIsNull:"null"===T,bothAreNull:"null"===q&&"null"===T,leftIsAny:"any"===q,rightIsAny:"any"===T,bothAreAny:"any"===q&&"any"===T,leftIsRange:"range"===q,rightIsRange:"range"===T}};g._createClass(k,[{key:"_arcadeContextInfo",get:function(){const {_initialFeature:q,
arcadeEditType:T,layer:n,spatialReference:x,view:G}=this;return{layer:D.isEditableLayer(n)?n:null,originalFeature:q,editType:T,spatialReference:x,map:G?.map}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"allInputFields",get:function(){return p(this.inputFields)}},{key:"_layerFieldsByName",get:function(){return new Map(this.layer.fields.map(q=>[q.name,q]))}},{key:"feature",get:function(){return this._get("feature")},set:function(q){this._featureClone=q?q.clone():r.clone();
this._initialFeature=this._featureClone.clone();this._resetInputFieldValues(this._featureClone);this.contingencyConstraintViolations.clear();w.isSome(this._expressionsManager)&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())));this._set("feature",q)}},{key:"fieldsWithContingentValues",get:function(){if(w.isNone(this._contingentValuesCache))return new Set;
const q=this._contingentValuesCache.fieldGroups.flatMap(T=>T.fields);return new Set(q)}},{key:"formTemplate",get:function(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null},set:function(q){this._override("formTemplate",q)}},{key:"joinedContingentValues",get:function(){return this._joinContingentValues()}},{key:"layer",get:function(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null},set:function(q){this._override("layer",
q)}},{key:"spatialReference",get:function(){return this.layer?.spatialReference??null},set:function(q){this._override("spatialReference",q)}},{key:"state",get:function(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}},{key:"submittable",get:function(){return this.valid?!0:this.allInputFields.filter(q=>!q.valid).every(({submittable:q})=>q)}},{key:"valid",get:function(){const q=this.allInputFields;return 0<q.length&&q.every(({valid:T})=>T)}}]);return k}(C.HandleOwnerMixin(M.EsriPromiseMixin(l.EventedAccessor)));
u.__decorate([L.property()],f.prototype,"_arcadeContextInfo",null);u.__decorate([L.property()],f.prototype,"updating",null);u.__decorate([L.property({readOnly:!0})],f.prototype,"allInputFields",null);u.__decorate([L.property()],f.prototype,"_layerFieldsByName",null);u.__decorate([L.property()],f.prototype,"arcadeEditType",void 0);u.__decorate([L.property()],f.prototype,"contingencyConstraintViolations",void 0);u.__decorate([L.property()],f.prototype,"feature",null);u.__decorate([L.property()],f.prototype,
"fieldsWithContingentValues",null);u.__decorate([L.property({type:S})],f.prototype,"formTemplate",null);u.__decorate([L.property()],f.prototype,"inputFields",void 0);u.__decorate([L.property()],f.prototype,"joinedContingentValues",null);u.__decorate([L.property()],f.prototype,"layer",null);u.__decorate([L.property()],f.prototype,"messages",void 0);u.__decorate([L.property()],f.prototype,"spatialReference",null);u.__decorate([L.property()],f.prototype,"state",null);u.__decorate([L.property()],f.prototype,
"strict",void 0);u.__decorate([L.property()],f.prototype,"submittable",null);u.__decorate([L.property()],f.prototype,"valid",null);u.__decorate([L.property()],f.prototype,"view",void 0);u.__decorate([L.property()],f.prototype,"getValues",null);u.__decorate([L.property()],f.prototype,"submit",null);f=u.__decorate([I.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],f);const p=m=>m.reduce((k,B)=>B.inputFields?[...k,...B.inputFields]:[...k,B],[]),z=(m,k,B)=>{w.isSome(k)&&m.set(k,B)};return f})},
"esri/layers/support/ContingentValue":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.maxValue=null;h.minValue=null;h.codedValue=null;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],
f.prototype,"objectType",void 0);u.__decorate([O.property()],f.prototype,"maxValue",void 0);u.__decorate([O.property()],f.prototype,"minValue",void 0);u.__decorate([O.property()],f.prototype,"codedValue",void 0);return f=u.__decorate([F.subclass("esri.layers.support.ContingentValue")],f)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/JSONSupport ../../core/Loadable ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./Subtype".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D){var E;O=E=function(J){function A(e){e=J.call(this,e)||this;e.request=f;e.fieldGroups=null;e.fieldGroupDefinitions=null;return e}g._inheritsLoose(A,J);var P=A.prototype;P.initialize=function(){};A.createLoadedLayerContingentValuesCache=function(){var e=g._asyncToGenerator(function*(c){yield c.load();if(void 0===c.layerId)return null;var b=c.sourceJSON.hasContingentValuesDefinition;if(b)return(new E({layer:c})).load();if(void 0===b){b=L.parse(c.url);if(C.isNone(b))return null;
b=b.url.path;if((yield E._staticFetchEnterpriseFeatureRoot(b)).supportsQueryDataElements&&(b=yield E._staticFetchEnterpriseFieldGroup(b,c.layerId.toString())))return b=b.map(r=>({name:r.name,isEditingRestrictive:r.isEditingRestrictive,fields:r.fieldNames.names})),(new E({layer:c,fieldGroupDefinitions:b})).load()}return null});return function(c){return e.apply(this,arguments)}}();P.load=function(){var e=g._asyncToGenerator(function*(c){const b=this.layer.load(c).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,
c));this.addResolvingPromise(b);return this});return function(c){return e.apply(this,arguments)}}();P.validateContingencyConstraints=function(e,c){const b=this.layer.typeIdField,r=Object.keys(e),H=[],d=[];for(const z of this.fieldGroups){const m=z.isEditingRestrictive?"error":"warning";if(c&&!z.fields.some(q=>c.includes(q)))continue;if(!z.fields.every(q=>r.includes(q))){d.push(new y({fieldGroup:z,type:m}));continue}let k=!1;const B=e[b];var p=z.contingencies.filter(q=>!q.isRetired&&q.subtype?q.subtype.code===
B:!0);for(const q of p){p=!0;for(const T in q.values){const n=q.values[T];if("any"!==n.objectType)if("null"===n.objectType){if(null!=e[T]){p=!1;break}}else if("code"===n.objectType){if(e[T]!==n.codedValue.code){p=!1;break}}else if("range"===n.objectType){const x=e[T];if(x<n.minValue||x>n.maxValue){p=!1;break}}}if(p){k=!0;break}}k||H.push(new y({fieldGroup:z,type:m}))}return{invalid:H,incomplete:d}};P.getContingentValues=function(e,c,b=!1){const r=e[this.layer.typeIdField],H=void 0!==r&&null!==r,d=
{};let p=[];const z=this.fieldGroups.filter(k=>k.fields.includes(c));p.push(new I({objectType:"any"}));for(const k of z){let B=[];var m=k.contingencies.filter(n=>!n.isRetired&&(n.subtype&&H?n.subtype.code===r:!0));let q=!1;const T={};for(const n of m){let x;m=!0;for(const G in n.values){const K=n.values[G];if(c===G)x=K,q=q||"range"===K.objectType;else if(void 0!==e[G]&&"any"!==K.objectType)if("null"===K.objectType)null!==e[G]&&(m=!1);else if("code"===K.objectType)e[G]!==K.codedValue.code&&(m=!1);
else if("range"===K.objectType){const U=e[G];if(U<K.minValue||U>K.maxValue)m=!1}}if(x&&m){if("any"===x.objectType){B.length=0;B.push(x);break}m=this._generateKey(x);T[m]||B.push(x);T[m]=!0}}q&&(B=this._joinRange(B));d[k.name]=B;p=b?this._filterIntersection(p,B):null}1===z.length&&b&&(p=[]);return new S({contingentValuesAllGroups:p,contingentValuesByFieldGroup:d})};P._generateKey=function(e){switch(e.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return e.codedValue.name+
e.codedValue.code.toString();case "range":return e.minValue.toString()+"-"+e.maxValue.toString()}};P._joinRange=function(e){e.sort((H,d)=>"null"===H.objectType?-1:"null"===d.objectType?1:H.minValue-d.minValue);let c,b;const r=[];for(const H of e)"null"===H.objectType?r.push(H):void 0===c?(c=H.minValue,b=H.maxValue):b<H.minValue?(r.push(new I({objectType:"range",minValue:c,maxValue:b})),c=H.minValue,b=H.maxValue):b<H.maxValue&&(b=H.maxValue);r.push(new I({objectType:"range",minValue:c,maxValue:b}));
return r};P._filterIntersection=function(e,c){if(0===e.length||0===c.length)return[];if("any"===e[0].objectType)return c;if("any"===c[0].objectType)return e;const b="range"===c[0].objectType||"range"===c[1]?.objectType;return"range"===e[0].objectType||"range"===e[1]?.objectType||b?this._intersectRanges(e,c):this._intersectValues(e,c)};P._intersectRanges=function(e,c){const b=[];let r=0;for(const H of e)for(;r<c.length;r++){const d=c[r];if("null"===H.objectType&&"null"===d.objectType)b.push(new I({objectType:"null"}));
else if("null"===H.objectType)break;else if("null"===d.objectType)continue;if(H.maxValue<d.minValue)break;if(H.maxValue===d.minValue){b.push(new I({objectType:"range",minValue:H.maxValue,maxValue:d.minValue}));break}if(!(H.minValue>d.maxValue))if(H.minValue===d.maxValue)b.push(new I({objectType:"range",minValue:H.minValue,maxValue:d.maxValue}));else{e=H.minValue>d.minValue?H.minValue:d.minValue;if(H.maxValue<d.maxValue){b.push(new I({objectType:"range",minValue:e,maxValue:H.maxValue}));break}b.push(new I({objectType:"range",
minValue:e,maxValue:d.maxValue}))}}return b};P._intersectValues=function(e,c){const b=[];for(const r of e)c.some(H=>{if(r.objectType===H.objectType)switch(r.objectType){case "any":case "null":return!0;case "code":return r.codedValue.code===H.codedValue.code&&r.codedValue.name===H.codedValue.name}return!1})&&b.push(r);return b};A._staticFetchEnterpriseFeatureRoot=function(){var e=g._asyncToGenerator(function*(c,b){return f(c,{responseType:"json",query:{f:"json"},...b}).then(r=>r.data)});return function(c,
b){return e.apply(this,arguments)}}();A._staticFetchEnterpriseFieldGroup=function(){var e=g._asyncToGenerator(function*(c,b,r){return f(`${c}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([b]),f:"json"},...r}).then(H=>H.data.layerDataElements?.[0].dataElement.fieldGroups)});return function(c,b,r){return e.apply(this,arguments)}}();P._initializeContingentValues=function(){var e=g._asyncToGenerator(function*(c,b){c=c?c:yield this._fetchFieldGroupDefs(b);this.fieldGroups=0===c.length?
[]:yield this._fetchContingentValues(c,b)});return function(c,b){return e.apply(this,arguments)}}();P._fetchFieldGroupDefs=function(){var e=g._asyncToGenerator(function*(c){var b=this;if(void 0===this.layer.layerId)return[];const r=this.layer.sourceJSON,H=this.layer.layerId.toString(),d=C.unwrap(L.parse(this.layer.url)).url.path;return r.hasContingentValuesDefinition?(yield this._fetchAGOLFieldGroup(d,H,c)).map(p=>({name:p.name,isEditingRestrictive:p.restrictive,fields:p.fields.map(z=>this.layer.fieldsIndex.normalizeFieldName(z))})):
void 0!==r.hasContingentValuesDefinition?[]:this._fetchEnterpriseFeatureRoot(d,c).then(function(){var p=g._asyncToGenerator(function*(z){return z.supportsQueryDataElements?(yield b._fetchEnterpriseFieldGroup(d,H,c)).map(m=>({name:m.name,isEditingRestrictive:m.isEditingRestrictive,fields:m.fieldNames.names.map(k=>b.layer.fieldsIndex.normalizeFieldName(k))})):[]});return function(z){return p.apply(this,arguments)}}())});return function(c){return e.apply(this,arguments)}}();P._fetchAGOLFieldGroup=function(){var e=
g._asyncToGenerator(function*(c,b,r){return f(`${c}/${b}/fieldgroups`,{responseType:"json",query:{f:"json"},...r}).then(H=>H.data.fieldGroups)});return function(c,b,r){return e.apply(this,arguments)}}();P._fetchEnterpriseFieldGroup=function(){var e=g._asyncToGenerator(function*(c,b,r){return E._staticFetchEnterpriseFieldGroup(c,b,r)});return function(c,b,r){return e.apply(this,arguments)}}();P._fetchEnterpriseFeatureRoot=function(){var e=g._asyncToGenerator(function*(c,b){return E._staticFetchEnterpriseFeatureRoot(c,
b)});return function(c,b){return e.apply(this,arguments)}}();P._fetchContingentValues=function(){var e=g._asyncToGenerator(function*(c,b){if(void 0===this.layer.layerId)return[];const r=this.layer.sourceJSON,H=this.layer.layerId.toString(),d=C.unwrap(L.parse(this.layer.url)).url.path;if(r.hasContingentValuesDefinition)return b=yield this._fetchAGOLContingentValues(d,H,b),this._constructFieldGroupsAGOL(c,b);b=yield this._fetchEnterpriseContingentValues(d,H,b);return this._constructFieldGroupsEnterprise(c,
b)});return function(c,b){return e.apply(this,arguments)}}();P._constructFieldGroupsAGOL=function(e,c){return e.map(b=>{const r=c.contingentValuesDefinition.fieldGroups.find(H=>H.name===b.name);if(r){let H=[];H=c.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(b,c,r.subTypes):this._parseAGOLFieldGroup(b,c,r.contingentValues);return new R({name:b.name,isEditingRestrictive:b.isEditingRestrictive,fields:b.fields,contingencies:H})}return null}).filter(b=>null!==b)};P._parseAGOLFieldGroupSubtype=
function(e,c,b){let r=[];b.forEach(H=>{const d=this._getSubtypeAGOL(H.name);r=r.concat(this._parseAGOLFieldGroup(e,c,H.contingentValues,d))});return r};P._parseAGOLFieldGroup=function(e,c,b,r=null){const H=[];for(const d of b)b=this._parseAGOLContingency(d,e,c,r),H.push(b);return H};P._parseAGOLContingency=function(e,c,b,r){const H=e.id,d=e.retired?1===e.retired:!1,p={};for(let m=0,k=0;m<c.fields.length;m++){const B=c.fields[m];var z=b.typeCodes[e.types[m]];if("Code"===z){let q=e.values[k];k++;const T=
this._getDomain(r,B);"string"===this.layer.getField(B).type&&(z=b.stringDicts.find(n=>n.domain===T.name))&&(q=z.entries[q]);z=T.codedValues.find(n=>n.code===q);z=new I({codedValue:z,objectType:"code"});p[B]=z}else"Range"===z?(z=e.values[k],k++,z=new I({minValue:z.range[0],maxValue:z.range[1],objectType:"range"}),p[B]=z):"Any"===z?(z=new I({objectType:"any"}),p[B]=z):(z=new I({objectType:"null"}),p[B]=z)}return new Q({id:H,isRetired:d,subtype:r,values:p})};P._constructFieldGroupsEnterprise=function(e,
c){const b=c.fieldGroups;return e.map(r=>{var H=b.find(d=>d.name===r.name);return H?(H=H.contingencies.map(d=>{const p=d.id,z=d.isRetired||!1,m=this._getSubtypeEnterprise(d.subtypeCode),k={};for(let q=0;q<r.fields.length;q++){const T=r.fields[q];let n=d.values[q];if("number"===typeof n||"string"===typeof n){var B=this._getDomain(m,T);const x=this.layer.getField(T);"string"===x.type?n=c.stringDictionary[n]:"date"===x.type&&(n=(new Date(`${n}+00:00`)).getTime());B=B.codedValues.find(G=>G.code===n);
B=new I({codedValue:B,objectType:"code"});k[T]=B}else"object"===typeof n?(B=new I({minValue:n.minValue,maxValue:n.maxValue,objectType:"range"}),k[T]=B):n?(B=new I({objectType:"any"}),k[T]=B):(B=new I({objectType:"null"}),k[T]=B)}return new Q({id:p,isRetired:z,subtype:m,values:k})}),new R({name:r.name,isEditingRestrictive:r.isEditingRestrictive,fields:r.fields,contingencies:H})):null}).filter(r=>null!==r)};P._fetchEnterpriseContingentValues=function(){var e=g._asyncToGenerator(function*(c,b,r){return f(`${c}/queryContingentValues`,
{responseType:"json",query:{layers:JSON.stringify([b]),f:"json"},...r}).then(H=>H.data.contingentValueSets?.[0])});return function(c,b,r){return e.apply(this,arguments)}}();P._fetchAGOLContingentValues=function(){var e=g._asyncToGenerator(function*(c,b,r){return f(`${c}/${b}/contingentValues`,{responseType:"json",query:{f:"json"},...r}).then(H=>H.data)});return function(c,b,r){return e.apply(this,arguments)}}();P._getSubtypeEnterprise=function(e){var c=this.layer.sourceJSON;let b;c.subtypes&&(c=c.subtypes.find(r=>
r.code===e),b=D.fromJSON(c));return b?b:null};P._getSubtypeAGOL=function(e){var c=this.layer.sourceJSON;let b;c.subtypes&&(c=c.subtypes.find(r=>r.name===e),b=D.fromJSON(c));return b?b:null};P._getDomain=function(e,c){e=e?e.domains[c]:this.layer.getFieldDomain(c);return"inherited"===e.type?this.layer.getFieldDomain(c):e};return A}(O.JSONSupportMixin(l));u.__decorate([F.property({constructOnly:!0})],O.prototype,"layer",void 0);u.__decorate([F.property({constructOnly:!0})],O.prototype,"request",void 0);
u.__decorate([F.property({type:[R]})],O.prototype,"fieldGroups",void 0);u.__decorate([F.property({constructOnly:!0})],O.prototype,"fieldGroupDefinitions",void 0);return O=E=u.__decorate([h.subclass("esri.layers.support.LayerContingentValuesCache")],O)})},"esri/layers/support/Contingency":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.isRetired=!1;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],f.prototype,"id",void 0);u.__decorate([O.property()],f.prototype,"isRetired",void 0);u.__decorate([O.property()],f.prototype,"subtype",void 0);u.__decorate([O.property()],f.prototype,"values",void 0);return f=u.__decorate([F.subclass("esri.layers.support.Contingency")],f)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h){return w.call(this,h)||this}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],f.prototype,"fieldGroup",void 0);u.__decorate([O.property()],f.prototype,"type",void 0);return f=u.__decorate([F.subclass("esri.layers.support.ContingencyConstraintViolation")],f)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h){return w.call(this,h)||this}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],f.prototype,"contingentValuesAllGroups",void 0);u.__decorate([O.property()],f.prototype,"contingentValuesByFieldGroup",void 0);return f=u.__decorate([F.subclass("esri.layers.support.ContingentValuesResult")],f)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.fields=null;h.isEditingRestrictive=!1;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],f.prototype,"name",void 0);u.__decorate([O.property()],f.prototype,"fields",void 0);u.__decorate([O.property()],f.prototype,"isEditingRestrictive",void 0);u.__decorate([O.property()],f.prototype,"contingencies",void 0);return f=u.__decorate([F.subclass("esri.layers.support.FieldGroup")],f)})},"esri/layers/support/Subtype":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./domains".split(" "),
function(g,u,f,O,l,C,F,w,M,h){f=function(L){function Q(){var I=L.apply(this,arguments)||this;I.code=null;I.defaultValues={};I.domains=null;I.name=null;return I}g._inheritsLoose(Q,L);var y=Q.prototype;y.readDomains=function(I){if(!I)return null;const S={};for(const R of Object.keys(I))S[R]=h.fromJSON(I[R]);return S};y.writeDomains=function(I,S){if(I){var R={};for(const D of Object.keys(I))I[D]&&(R[D]=I[D]?.toJSON());S.domains=R}};return Q}(f.JSONSupport);u.__decorate([O.property({type:Number,json:{write:!0}})],
f.prototype,"code",void 0);u.__decorate([O.property({type:Object,json:{write:!0}})],f.prototype,"defaultValues",void 0);u.__decorate([O.property({json:{write:!0}})],f.prototype,"domains",void 0);u.__decorate([F.reader("domains")],f.prototype,"readDomains",null);u.__decorate([M.writer("domains")],f.prototype,"writeDomains",null);u.__decorate([O.property({type:String,json:{write:!0}})],f.prototype,"name",void 0);return f=u.__decorate([w.subclass("esri.layers.support.Subtype")],f)})},"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/support/WatchUpdatingTracking ../../layers/support/fieldUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q){const y=Symbol("FormExpressionArcadeExecutor");g.FormExpressionArcadeExecutor=function(S){function R(E){var J=S.call(this,E)||this;J[I]=!0;J._lastEvaluatedValue=null;J._abortController=new AbortController;J._stale=!1;J._updatingTracking=new L.WatchUpdatingTracking;J._executeAsyncDebounced=C.debounce(function(){var A=u._asyncToGenerator(function*(P,e,c){P=yield J.executor.executeAsync(P,{...e,abortSignal:c});if(c.aborted)return J._lastEvaluatedValue;J._lastEvaluatedValue=
P;J._stale=!1;return P});return function(P,e,c){return A.apply(this,arguments)}}());return J}u._inheritsLoose(R,S);var D=R.prototype;D.abort=function(){this._abortController.abort()};D.execute=function(E,J){this._abortController=new AbortController;return this._lastEvaluatedValue=E=this.executor.execute(E,{...J,abortSignal:this._abortController.signal})};D.executeAsync=function(){var E=u._asyncToGenerator(function*(J,A){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(J,
A??{},this._abortController.signal))});return function(J,A){return E.apply(this,arguments)}}();D.markStale=function(){this._stale=!0};D.reset=function(){this.abort();this._lastEvaluatedValue=null;this._stale=!1};u._createClass(R,[{key:"isAsync",get:function(){return this.executor.isAsync}},{key:"fieldsUsed",get:function(){return this.executor.fieldsUsed}},{key:"syntaxTree",get:function(){return this.executor.syntaxTree}},{key:"updating",get:function(){return this._updatingTracking.updating}},{key:"stale",
get:function(){return this._stale}},{key:"geometryUsed",get:function(){return this.executor.geometryUsed}},{key:"variablesUsed",get:function(){return this.executor.variablesUsed}},{key:"lastEvaluatedValue",get:function(){return this._lastEvaluatedValue}}]);return R}(l);var I=y;f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",void 0);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"_stale",void 0);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,
"_updatingTracking",void 0);f.__decorate([F.property({constructOnly:!0})],g.FormExpressionArcadeExecutor.prototype,"executor",void 0);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"isAsync",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"syntaxTree",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"updating",null);f.__decorate([F.property()],
g.FormExpressionArcadeExecutor.prototype,"stale",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);f.__decorate([F.property()],g.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);g.FormExpressionArcadeExecutor=f.__decorate([h.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],g.FormExpressionArcadeExecutor);f=function(){var S=u._asyncToGenerator(function*(R,
D){const E=O.createArcadeProfile("form-calculation");R=yield O.createArcadeExecutor(R,E,{});D?.fieldsIndex&&(R.fieldsUsed=Q.fixFields(D.fieldsIndex,R.fieldsUsed));return new g.FormExpressionArcadeExecutor({executor:R})});return function(R,D){return S.apply(this,arguments)}}();g.createFormExpressionArcadeExecutor=f;g.isFormExpressionArcadeExecutor=S=>S&&"object"===typeof S&&S[y];Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/arcade":function(){define("exports ./chunks/_rollupPluginBabelHelpers ./Graphic ./arcade/ImmutableArray ./core/Error ./core/lang ./layers/FeatureLayer ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),
function(g,u,f,O,l,C,F,w,M){function h(c,b,r,H={}){b=b.elementType;const d="array"===b.type?[{name:"value",type:b.type,elementType:b.elementType}]:"dictionary"===b.type?[{name:"value",type:b.type,properties:b.properties}]:[{name:"value",type:b.type}];return new O(c.map(p=>{const z={};I(z,d,{value:p},r,H);return z.value}))}function L(c,b,r={}){c=c instanceof w?new F({source:c.features,geometryType:c.geometryType,fields:c.fields,spatialReference:c.spatialReference}):c;return b.constructFeatureSet(c,
r.spatialReference,null,!0,r.lruCache,r.interceptor)}function Q(c,b,r={}){const {spatialReference:H,interceptor:d,lruCache:p}=r;return"string"===typeof c?b.createFeatureSetCollectionFromService(c,H,p,d):b.createFeatureSetCollectionFromMap(c,H,p,d)}function y(c,b,r,H={}){const d={};I(d,b.properties,c,r,H);return new J.Dictionary(d)}function I(c,b,r,H,d={}){const p={};for(const z of Object.keys(r))p[z.toLowerCase()]=r[z];for(const z of b)if(b=z.name.toLowerCase(),d.variablesPreProcessed)c[b]=p[b];else switch(z.type){case "array":c[b]=
h(p[b],z,H,d);break;case "feature":r=p[b];c[b]=null==r?null:J.Feature.createFromGraphic(r);break;case "featureSet":r=p[b];c[b]=H?L(r,H,d):null;break;case "featureSetCollection":r=p[b];c[b]=H?Q(r,H,d):null;break;case "dictionary":c[b]=y(p[b],z,H,d);break;case "geometry":case "boolean":case "date":case "text":case "number":c[b]=p[b]}}function S(c,b){for(const r of c)b.push(r),"dictionary"===r.type&&S(r.properties,b);return b}function R(c,b,r,H,d){const {spatialReference:p,interceptor:z,lruCache:m,services:k,
console:B,abortSignal:q}=r;d={vars:{},spatialReference:p,interceptor:z,lrucache:m,useAsync:d,services:k,console:B,abortSignal:q};if(!b)return d;I(d.vars,c.variables,b,H,r);return d}function D(c,b){switch(b.getArcadeType(c)){case "date":return new Date(c.getTime());case "feature":var r="geometry"in c?c.geometry():null;c="readAttributes"in c?c.readAttributes():c.attributes;return new f({geometry:r,attributes:c});case "dictionary":r=c.attributes;const H={};for(const d of Object.keys(r))H[d]=D(c.field(d),
b);return H;case "array":return("toArray"in c?c.toArray():c).map(d=>D(d,b))}return c}function E(){E=u._asyncToGenerator(function*(c,b,r={}){J||(J=yield M.loadArcade());const {arcade:H,arcadeUtils:d}=J,{loadScriptDependencies:p,referencesMember:z,scriptIsAsync:m}=H;var k=S(b.variables,[]),B=k.filter(U=>"featureSet"===U.type||"featureSetCollection"===U.type).map(U=>U.name.toLowerCase());const q=H.parseScript(c,B);if(!q)throw new l("arcade:invalid-script","Unable to create SyntaxTree");c=d.extractFieldNames(q);
const T=H.scriptTouchesGeometry(q);k=k.map(U=>U.name.toLowerCase()).filter(U=>z(q,U));const n=m(q,B);yield p(q,n,B);B={vars:{},spatialReference:null,useAsync:n};for(const U of k)B.vars[U]="any";const {lruCache:x}=r,G=H.compileScript(q,B),K=H.featureSetUtils();return{execute:(U,Y={})=>{if(n)throw new l("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");U=G(R(b,U,{lruCache:x,...Y},K,n));return Y.rawOutput?U:D(U,d)},executeAsync:function(){var U=u._asyncToGenerator(function*(Y,
ba={}){Y=yield G(R(b,Y,{lruCache:x,...ba},K,n));return ba.rawOutput?Y:D(Y,d)});return function(Y){return U.apply(this,arguments)}}(),isAsync:n,variablesUsed:k,fieldsUsed:c,geometryUsed:T,syntaxTree:q}});return E.apply(this,arguments)}let J=null;const A={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},P={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},
e=new Map([["constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},
{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",A],["popup-element",A],["feature-reduction-popup",P],["feature-reduction-popup-element",P],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);g.createArcadeExecutor=function(c,b){return E.apply(this,arguments)};g.createArcadeProfile=function(c){var b=e.get(c);
if(!b)throw b=Array.from(e.keys()).map(r=>`'${r}'`).join(", "),new l("createArcadeProfile:invalid-profile-name",`Invalid profile name '${c}'. You must specify one of the following values: ${b}`);return C.clone(b)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/arcade/ImmutableArray":function(){define(function(){return function(){function g(f=[]){this._elements=f}var u=g.prototype;u.length=function(){return this._elements.length};u.get=function(f){return this._elements[f]};
u.toArray=function(){const f=[];for(let O=0;O<this.length();O++)f.push(this.get(O));return f};return g}()})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/MapUtils ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(g,
u,f,O,l,C,F,w,M,h,L){g.FormExpressionsManager=function(I){function S(D){var E=I.call(this,D)||this;E._fieldReferencesLookup=new Map;E._fieldsAffectedLookup=new Map;E._latestFieldValues={...D.feature.attributes};return E}u._inheritsLoose(S,I);var R=S.prototype;R.initialize=function(){this._dependencyGraph=this._buildDependencyGraph()};R.evaluateAll=function(){return this._evaluate(this.executors)};R.evaluateExpressions=function(D){return this._evaluate(D)};R.evaluateInvalidated=function(D){const {_fieldReferencesLookup:E,
_latestFieldValues:J,feature:A}=this,P=new Set;for(const e of D)if(J[e]=A.getAttribute(e),E.has(e))for(const c of E.get(e))P.add(c);return this._evaluate([...P])};R.evaluateInvalidatedByGeometry=function(){var D=u._asyncToGenerator(function*(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])});return function(){return D.apply(this,arguments)}}();R.resetExecutors=function(){for(const D of this.executors)D.reset()};
R._buildDependencyGraph=function(){const {_fieldReferencesLookup:D,_fieldsAffectedLookup:E,executors:J}=this,A=new Map(this.inputFields.map(e=>[e.name,e])),P=new Map(J.map(e=>[e,[]]));for(const e of J){for(const c of e.fieldsUsed){l.getOrCreateMapValue(D,c,()=>new Set).add(e);const b=A.get(c),{valueExpressionExecutor:r,editableExpressionExecutor:H}=b;C.isSome(r)&&(P.get(r).push(e),l.getOrCreateMapValue(E,r,()=>new Set).add(b));C.isSome(H)&&(P.get(H).push(e),l.getOrCreateMapValue(E,H,()=>new Set).add(b))}e.geometryUsed&&
l.getOrCreateMapValue(D,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",()=>new Set).add(e)}return P};R._evaluate=function(){var D=u._asyncToGenerator(function*(E){var J=this;const A=new Map,{_dependencyGraph:P,_fieldsAffectedLookup:e,_latestFieldValues:c}=this;for(const b of E)Q(b,A,P);for(const [b,{resolver:r,dependencyPromises:H}]of A)Promise.all(H).then(u._asyncToGenerator(function*(){const [d,p]=J._makeContext(c);return b.executeAsync(d,p)})).then(()=>{if(e.has(b))for(const d of e.get(b))this._latestFieldValues[d.name]=
d.value;r.resolve()},d=>{!d||F.isAbortError(d)||y(d)||b.markStale();r.reject(d)});E=(yield Promise.allSettled(Array.from(A.values(),({resolver:b})=>b.promise))).filter(b=>"rejected"===b.status&&!(F.isAbortError(b.reason)||y(b.reason)));if(0<E.length)throw new AggregateError(E,"One or more expression executions failed");});return function(E){return D.apply(this,arguments)}}();R._makeContext=function(D){const [E,J]=this._baseContext,A=this.feature.clone();A.attributes=D;return[{...E,$feature:A},J]};
u._createClass(S,[{key:"_baseContext",get:function(){const {editType:D,layer:E,map:J,originalFeature:A,spatialReference:P}=this.arcadeContextInfo,e="feature"===E?.type?E:"scene"===E?.type&&C.isSome(E.associatedLayer)?E.associatedLayer:void 0;return[{$originalfeature:A,$editcontext:{editType:D},$layer:e,$featureset:e,$datastore:E?.url,$map:J},{spatialReference:P}]}},{key:"feature",set:function(D){this._latestFieldValues={...D?.attributes};this._set("feature",D)}}]);return S}(O);f.__decorate([w.property()],
g.FormExpressionsManager.prototype,"_baseContext",null);f.__decorate([w.property()],g.FormExpressionsManager.prototype,"feature",null);f.__decorate([w.property()],g.FormExpressionsManager.prototype,"executors",void 0);f.__decorate([w.property()],g.FormExpressionsManager.prototype,"inputFields",void 0);f.__decorate([w.property()],g.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);g.FormExpressionsManager=f.__decorate([L.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],g.FormExpressionsManager);
const Q=(I,S,R)=>{if(!S.has(I)){var D=F.createResolver();S.set(I,{resolver:D,dependencyPromises:[]});I.abort();I=R.get(I);for(const E of I)Q(E,S,R),S.get(E).dependencyPromises.push(D.promise)}},y=I=>I&&"object"===typeof I&&"message"in I&&"Cancelled"===I.message;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/FeatureForm/InputField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/has ../../layers/support/CodedValueDomain ../../layers/support/Domain ../../layers/support/InheritedDomain ../../layers/support/RangeDomain ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../intl/substitute".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J){function A(d){return 1E7<=d||-1E7>=d}function P(d){return!!d&&"maxLength"in d}var e;(function(d){d.Text="text";d.Number="number";d.Date="date";d.Unsupported="unsupported"})(e||(e={}));var c;(c||(c={})).TOO_SHORT="length-validation-error::too-short";const b={type:"number"},r={type:"number",intlOptions:{notation:"scientific"}},H={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};f=
function(d){function p(m){m=d.call(this,m)||this;m._storedValue=null;m.editableExpressionExecutor=null;m.id=F.generateUID().toString();m.requiredExpressionExecutor=null;m.valueExpressionExecutor=null;m.visibilityExpressionExecutor=null;m.feature=null;m.field=null;m.fieldElement=null;m.layer=null;m.error=null;m.group=null;m.messages=null;return m}g._inheritsLoose(p,d);var z=p.prototype;z._isDomainCompatible=function(m){const {field:k}=this;if("coded-value"===m?.type){const B=typeof m.codedValues[0].code;
if("string"===B&&E.isStringField(k)||"number"===B&&E.isNumericField(k))return!0}return"range"===m?.type&&E.isNumericField(k)||E.isDateField(k)?!0:!1};z._validate=function(){const {domain:m,field:k,initialFeature:B,minLength:q,required:T,type:n,valid:x,value:G}=this,K=T&&null===G,U=void 0!==x;return!K&&B.getAttribute(k.name)===G&&U?null:K?E.TypeValidationError.INVALID_TYPE:"text"===n&&-1<q&&"string"===typeof G&&G.length<q?c.TOO_SHORT:m?null!==G||T?D.validateDomainValue(m,G):null:E.validateFieldValue(k,
G)};z._isVisibleByDefault=function(){const m=this.field?.type;return"oid"!==m&&"global-id"!==m&&!this._isGeometryField()};z._isEditorField=function(){return E.getFeatureEditFields(this.layer).includes(this.name)};z._isGeometryField=function(){return E.getFeatureGeometryFields(this.layer).includes(this.name)};z._shouldUseValueExpression=function(){return this._layerFieldAllowsEdits&&!this._configAllowsEdits&&C.isSome(this.valueExpressionExecutor)};z._toErrorMessage=function(){const {domain:m,field:k,
messages:B,minLength:q,value:T,required:n,type:x}=this;var G=this.error;return n&&null===T?B.validationErrors.cannotBeNull:G===D.DomainValidationError.VALUE_OUT_OF_RANGE||G===E.NumericRangeValidationError.OUT_OF_RANGE?(G=D.getDomainRange(m)||E.getFieldRange(k),J.substitute(B.validationErrors.outsideRange,G,{format:{max:"date"===x?H:A(G.max)?r:b,min:"date"===x?H:A(G.min)?r:b}})):G===D.DomainValidationError.INVALID_CODED_VALUE?B.validationErrors.invalidCodedValue:G===E.TypeValidationError.INVALID_TYPE?
B.validationErrors.invalidType:G===c.TOO_SHORT?J.substitute(B.validationErrors.tooShort,{min:q}):null};g._createClass(p,[{key:"_configAllowsEdits",get:function(){const {fieldElement:m,layer:k,name:B}=this;return C.isSome(m)?m.editableExpression?this.evaluatedEditableExpression:!1!==m.editable:("subtype-group"!==k?.type?k?.popupTemplate?.fieldInfos?.find(({fieldName:q})=>q===B):null)?.isEditable??!0}},{key:"_layerFieldAllowsEdits",get:function(){const {field:m,layer:k}=this;return k?.capabilities.operations.supportsEditing&&
m?.editable}},{key:"isUsingValueExpression",get:function(){return this._shouldUseValueExpression()}},{key:"evaluatedEditableExpression",get:function(){const {editableExpressionExecutor:m}=this;return C.isSome(m)?!!m.lastEvaluatedValue:null}},{key:"evaluatedRequiredExpression",get:function(){const {requiredExpressionExecutor:m}=this;return C.isSome(m)?!!m.lastEvaluatedValue:null}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:m}=this;return C.isSome(m)?!!m.lastEvaluatedValue:
null}},{key:"evaluatedValueExpression",get:function(){const {valueExpressionExecutor:m}=this;return C.isSome(m)?m.lastEvaluatedValue:null}},{key:"initialFeature",set:function(m){this._set("initialFeature",m);this.notifyChange("valid")}},{key:"description",get:function(){return C.unwrap(this.fieldElement)?.description}},{key:"domain",get:function(){var {layer:m}=this,k="typeIdField"in m?m.typeIdField:null,B=this.field?.domain;if(k===this.name&&!B)return k="subtype-group"===m.type?m.sublayers.map(({subtypeCode:q,
title:T})=>({id:q,name:T})):m.types.map(({id:q,name:T})=>({code:q,name:T})),new y({name:"__internal-type-based-coded-value-domain__",codedValues:k});({feature:m}=this);k=k&&this.layer.getFieldDomain(this.name,{feature:m})||B;B=C.get(this.fieldElement,"domain");return C.isSome(B)&&this._isDomainCompatible(B)?B:k}},{key:"editable",get:function(){return this._layerFieldAllowsEdits?this.evaluatedEditableExpression??this._configAllowsEdits:!1}},{key:"inputType",get:function(){return C.unwrap(this.fieldElement)?.input?.type}},
{key:"errorMessage",get:function(){return this._toErrorMessage()}},{key:"hint",get:function(){return C.unwrap(this.fieldElement)?.hint}},{key:"includeTime",get:function(){var {fieldElement:m}=this;m=C.isSome(m)&&"datetime-picker"===m.input?.type?m.input.includeTime:void 0;return void 0===m?!0:m}},{key:"label",get:function(){return C.isSome(this.fieldElement)&&this.fieldElement.label||this.field.alias||this.field.name}},{key:"maxLength",get:function(){if(this.type===e.Date)return-1;const {field:m,
fieldElement:k}=this,B=m?.length,q=C.isSome(k)&&P(k.input)?k.input.maxLength:NaN;return!isNaN(q)&&-1<=q&&(-1===B||q<=B)?q:B}},{key:"minLength",get:function(){if(this.type===e.Date)return-1;const {field:m,fieldElement:k}=this,B=m?.length,q=C.isSome(k)&&P(k.input)?k.input.minLength:NaN;return!isNaN(q)&&-1<=q&&(-1===B||q<=B)?q:-1}},{key:"name",get:function(){return this.field?.name}},{key:"required",get:function(){const {editable:m,evaluatedRequiredExpression:k,field:B,visible:q}=this;return m?!1===
B?.nullable?!0:q&&C.isSome(k)?k:!1:!1},set:function(m){this._overrideIfSome("required",m)}},{key:"submittable",get:function(){const {field:m,required:k,valid:B,value:q}=this;return k&&C.isNone(q)?!1:B?!0:this.initialFeature.getAttribute(m.name)===q}},{key:"type",get:function(){const {field:m}=this;return E.isNumericField(m)?e.Number:E.isStringField(m)?e.Text:E.isDateField(m)?e.Date:e.Unsupported}},{key:"updating",get:function(){const {editableExpressionExecutor:m,valueExpressionExecutor:k}=this;return C.isSome(k)&&
k.updating||C.isSome(m)&&m.updating}},{key:"valid",get:function(){const m=this.editable?this._validate():null;this._set("error",m);return null===m}},{key:"value",get:function(){if(this._shouldUseValueExpression()){const m=this.evaluatedValueExpression;if(this.type===e.Date){if(m instanceof Date)return m.getTime();if("number"!==typeof m)return parseInt(m,10)}return C.isSome(m)&&"object"===typeof m?m.toString():m}return this.get("_storedValue")},set:function(m){this.notifyChange("evaluatedVisibilityExpression");
this.set("_storedValue",m)}},{key:"visible",get:function(){return this._isEditorField()?!1:C.isSome(this.evaluatedVisibilityExpression)?this.evaluatedVisibilityExpression:C.isSome(this.fieldElement)?!0:this._isVisibleByDefault()}}]);return p}(l.HandleOwnerMixin(O));u.__decorate([w.property()],f.prototype,"_storedValue",void 0);u.__decorate([w.property()],f.prototype,"_configAllowsEdits",null);u.__decorate([w.property()],f.prototype,"_layerFieldAllowsEdits",null);u.__decorate([w.property()],f.prototype,
"editableExpressionExecutor",void 0);u.__decorate([w.property()],f.prototype,"requiredExpressionExecutor",void 0);u.__decorate([w.property()],f.prototype,"valueExpressionExecutor",void 0);u.__decorate([w.property()],f.prototype,"isUsingValueExpression",null);u.__decorate([w.property()],f.prototype,"visibilityExpressionExecutor",void 0);u.__decorate([w.property()],f.prototype,"evaluatedEditableExpression",null);u.__decorate([w.property()],f.prototype,"evaluatedRequiredExpression",null);u.__decorate([w.property()],
f.prototype,"evaluatedVisibilityExpression",null);u.__decorate([w.property()],f.prototype,"evaluatedValueExpression",null);u.__decorate([w.property()],f.prototype,"feature",void 0);u.__decorate([w.property()],f.prototype,"field",void 0);u.__decorate([w.property({constructOnly:!0})],f.prototype,"fieldElement",void 0);u.__decorate([w.property()],f.prototype,"initialFeature",null);u.__decorate([w.property()],f.prototype,"layer",void 0);u.__decorate([w.property({readOnly:!0})],f.prototype,"description",
null);u.__decorate([w.property()],f.prototype,"domain",null);u.__decorate([w.property()],f.prototype,"editable",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"inputType",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"error",void 0);u.__decorate([w.property({dependsOn:["error","messages","value"]})],f.prototype,"errorMessage",null);u.__decorate([w.property()],f.prototype,"group",void 0);u.__decorate([w.property({readOnly:!0})],f.prototype,"hint",null);u.__decorate([w.property()],
f.prototype,"includeTime",null);u.__decorate([w.property()],f.prototype,"label",null);u.__decorate([w.property()],f.prototype,"maxLength",null);u.__decorate([w.property()],f.prototype,"minLength",null);u.__decorate([w.property()],f.prototype,"messages",void 0);u.__decorate([w.property({readOnly:!0})],f.prototype,"name",null);u.__decorate([w.property()],f.prototype,"required",null);u.__decorate([w.property()],f.prototype,"submittable",null);u.__decorate([w.property()],f.prototype,"type",null);u.__decorate([w.property()],
f.prototype,"updating",null);u.__decorate([w.property()],f.prototype,"valid",null);u.__decorate([w.property({value:null})],f.prototype,"value",null);u.__decorate([w.property()],f.prototype,"visible",null);return f=u.__decorate([L.subclass("esri.widgets.FeatureForm.InputField")],f)})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w,M,h){f=function(L){function Q(I){I=L.call(this,I)||this;I._expressionTrackingHandles=new Map;I.visibilityExpressionExecutor=null;I.feature=null;I.groupElement=null;return I}g._inheritsLoose(Q,L);var y=Q.prototype;y.initialize=function(){this.addHandles([C.watch(()=>[this.visible,this.inputFields],([I])=>{const {inputFields:S}=this;I=I?void 0:!1;for(const R of S)R.required=I},{initial:!0,equals:(I,S)=>S[0]===I[0]&&S[1]===I[1]})])};y.destroy=function(){for(const I of this._expressionTrackingHandles.values())I.remove()};
y._dirtyEvaluatedVisibilityExpression=function(){const {groupElement:I}=this;l.isSome(I)&&I.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")};g._createClass(Q,[{key:"visibilityExpression",get:function(){return l.unwrap(this.groupElement)?.visibilityExpression},set:function(I){l.applySome(this.groupElement,S=>{S.visibilityExpression=I})}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:I}=this;return l.isSome(I)?!!I.lastEvaluatedValue:
null}},{key:"description",get:function(){return l.unwrap(this.groupElement)?.description},set:function(I){l.applySome(this.groupElement,S=>{S.description=I})}},{key:"inputFields",get:function(){return this._get("inputFields")},set:function(I){this.handles.removeAll();I&&this.handles.add(I.map(S=>C.watch(()=>S.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputFields",I)}},{key:"label",get:function(){return l.unwrap(this.groupElement)?.label},set:function(I){l.applySome(this.groupElement,
S=>{S.label=I})}},{key:"state",get:function(){return l.isSome(this.groupElement)&&this.groupElement.initialState||"expanded"},set:function(I){this._overrideIfSome("state",I)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibilityExpression&&this.inputFields&&this.inputFields.some(I=>I.visible)}}]);return Q}(O.HandleOwnerMixin(f));u.__decorate([F.property()],f.prototype,"visibilityExpression",null);u.__decorate([F.property()],f.prototype,"visibilityExpressionExecutor",void 0);u.__decorate([F.property()],
f.prototype,"evaluatedVisibilityExpression",null);u.__decorate([F.property()],f.prototype,"description",null);u.__decorate([F.property()],f.prototype,"feature",void 0);u.__decorate([F.property()],f.prototype,"groupElement",void 0);u.__decorate([F.property()],f.prototype,"initialFeature",void 0);u.__decorate([F.property()],f.prototype,"inputFields",null);u.__decorate([F.property()],f.prototype,"label",null);u.__decorate([F.property()],f.prototype,"state",null);u.__decorate([F.property()],f.prototype,
"visible",null);return f=u.__decorate([h.subclass("esri.widgets.FeatureForm.InputFieldGroup")],f)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],function(g,u,f,O){const l={heading:"esri-widget__heading"};g.CSS=l;g.Heading=function(C,F){const w=u.clamp(Math.ceil(C.level),1,6),M=`h${w}`;delete C.level;return O.tsx(M,{...C,class:f.classes(l.heading,C.class),role:"heading","aria-level":String(w)},F)};g.incrementHeadingLevel=function(C,
F=1){return u.clamp(Math.ceil(C+F),1,6)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/datetime":function(){define(["exports"],function(g){function u(a){return"undefined"===typeof a}function f(a){return"number"===typeof a}function O(a){return"number"===typeof a&&0===a%1}function l(){try{return"undefined"!==typeof Intl&&!!Intl.RelativeTimeFormat}catch(a){return!1}}function C(a,t,X){if(0!==a.length)return a.reduce((aa,ia)=>{ia=[t(ia),ia];return aa?
X(aa[0],ia[0])===aa[0]?aa:ia:ia},null)[1]}function F(a,t){return t.reduce((X,aa)=>{X[aa]=a[aa];return X},{})}function w(a,t){return Object.prototype.hasOwnProperty.call(a,t)}function M(a,t,X){return O(a)&&a>=t&&a<=X}function h(a,t=2){return 0>a?"-"+(""+-a).padStart(t,"0"):(""+a).padStart(t,"0")}function L(a){if(!u(a)&&null!==a&&""!==a)return parseInt(a,10)}function Q(a){if(!u(a)&&null!==a&&""!==a)return parseFloat(a)}function y(a){if(!u(a)&&null!==a&&""!==a)return a=1E3*parseFloat("0."+a),Math.floor(a)}
function I(a,t,X=!1){t=10**t;return(X?Math.trunc:Math.round)(a*t)/t}function S(a){return 0===a%4&&(0!==a%100||0===a%400)}function R(a,t){var X=t-1;X=X-12*Math.floor(X/12)+1;return 2===X?S(a+(t-X)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][X-1]}function D(a){let t=Date.UTC(a.year,a.month-1,a.day,a.hour,a.minute,a.second,a.millisecond);100>a.year&&0<=a.year&&(t=new Date(t),t.setUTCFullYear(t.getUTCFullYear()-1900));return+t}function E(a){var t=a-1;t=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/
400))%7;return 4===(a+Math.floor(a/4)-Math.floor(a/100)+Math.floor(a/400))%7||3===t?53:52}function J(a){return 99<a?a:60<a?1900+a:2E3+a}function A(a,t,X,aa=null){a=new Date(a);const ia={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};aa&&(ia.timeZone=aa);return(t=(new Intl.DateTimeFormat(X,{timeZoneName:t,...ia})).formatToParts(a).find(ma=>"timezonename"===ma.type.toLowerCase()))?t.value:null}function P(a,t){a=parseInt(a,10);Number.isNaN(a)&&(a=0);t=parseInt(t,
10)||0;t=0>a||Object.is(a,-0)?-t:t;return 60*a+t}function e(a){const t=Number(a);if("boolean"===typeof a||""===a||Number.isNaN(t))throw new bb(`Invalid unit value ${a}`);return t}function c(a,t){const X={};for(const aa in a)if(w(a,aa)){const ia=a[aa];void 0!==ia&&null!==ia&&(X[t(aa)]=e(ia))}return X}function b(a,t){const X=Math.trunc(Math.abs(a/60)),aa=Math.trunc(Math.abs(a%60));a=0<=a?"+":"-";switch(t){case "short":return`${a}${h(X,2)}:${h(aa,2)}`;case "narrow":return`${a}${X}${0<aa?`:${aa}`:""}`;
case "techie":return`${a}${h(X,2)}${h(aa,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`);}}function r(a){return F(a,["hour","minute","second","millisecond"])}function H(a){switch(a){case "narrow":return[...Jd];case "short":return[...Ec];case "long":return[...Kd];case "numeric":return"1 2 3 4 5 6 7 8 9 10 11 12".split(" ");case "2-digit":return"01 02 03 04 05 06 07 08 09 10 11 12".split(" ");default:return null}}function d(a){switch(a){case "narrow":return[...Ld];
case "short":return[...Fc];case "long":return[...Gc];case "numeric":return"1234567".split("");default:return null}}function p(a){switch(a){case "narrow":return[...Md];case "short":return[...Nd];case "long":return[...Hc];default:return null}}function z(a,t,X="always",aa=!1){const ia={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]};var ma=-1===["hours","minutes",
"seconds"].indexOf(a);if("auto"===X&&ma)switch(X="days"===a,t){case 1:return X?"tomorrow":`next ${ia[a][0]}`;case -1:return X?"yesterday":`last ${ia[a][0]}`;case 0:return X?"today":`this ${ia[a][0]}`}X=Object.is(t,-0)||0>t;t=Math.abs(t);ma=1===t;const ta=ia[a];a=aa?ma?ta[1]:ta[2]||ta[1]:ma?ia[a][0]:a;return X?`${t} ${a} ago`:`in ${t} ${a}`}function m(a,t){let X="";for(const aa of a)X=aa.literal?X+aa.val:X+t(aa.val);return X}function k(a,t){if(u(a)||null===a)return t;if(a instanceof Ab)return a;if("string"===
typeof a){const X=a.toLowerCase();return"default"===X?t:"local"===X||"system"===X?ac.instance:"utc"===X||"gmt"===X?$a.utcInstance:$a.parseSpecifier(X)||lb.create(a)}return f(a)?$a.instance(a):"object"===typeof a&&a.offset&&"number"===typeof a.offset?a:new Od(a)}function B(a,t={}){const X=JSON.stringify([a,t]);let aa=Ic[X];aa||(aa=new Intl.ListFormat(a,t),Ic[X]=aa);return aa}function q(a,t={}){const X=JSON.stringify([a,t]);let aa=bc[X];aa||(aa=new Intl.DateTimeFormat(a,t),bc[X]=aa);return aa}function T(a,
t={}){const X=JSON.stringify([a,t]);let aa=cc[X];aa||(aa=new Intl.NumberFormat(a,t),cc[X]=aa);return aa}function n(a,t={}){const {base:X,...aa}=t,ia=JSON.stringify([a,aa]);let ma=Kb[ia];ma||(ma=new Intl.RelativeTimeFormat(a,t),Kb[ia]=ma);return ma}function x(a){const t=[];for(let X=1;12>=X;X++){const aa=W.utc(2016,X,1);t.push(a(aa))}return t}function G(a){const t=[];for(let X=1;7>=X;X++){const aa=W.utc(2016,11,13+X);t.push(a(aa))}return t}function K(a,t,X,aa,ia){a=a.listingMode(X);return"error"===
a?null:"en"===a?aa(t):ia(t)}function U(...a){a=a.reduce((t,X)=>t+X.source,"");return RegExp(`^${a}$`)}function Y(...a){return t=>a.reduce(([X,aa,ia],ma)=>{const [ta,wa,Ba]=ma(t,ia);return[{...X,...ta},wa||aa,Ba]},[{},null,1]).slice(0,2)}function ba(a,...t){if(null==a)return[null,null];for(const [X,aa]of t)if(t=X.exec(a))return aa(t);return[null,null]}function la(...a){return(t,X)=>{const aa={};let ia;for(ia=0;ia<a.length;ia++)aa[a[ia]]=L(t[X+ia]);return[aa,null,X+ia]}}function pa(a,t,X){a=a[t];return u(a)?
X:L(a)}function va(a,t){return[{hours:pa(a,t,0),minutes:pa(a,t+1,0),seconds:pa(a,t+2,0),milliseconds:y(a[t+3])},null,t+4]}function xa(a,t){const X=!a[t]&&!a[t+1];a=P(a[t+1],a[t+2]);return[{},X?null:$a.instance(a),t+3]}function Aa(a,t){return[{},a[t]?lb.create(a[t]):null,t+1]}function Ga(a){const [t,X,aa,ia,ma,ta,wa,Ba,Ma]=a,Fa="-"===t[0];a=Ba&&"-"===Ba[0];const Ka=(Ha,Ua=!1)=>void 0!==Ha&&(Ua||Ha&&Fa)?-Ha:Ha;return[{years:Ka(Q(X)),months:Ka(Q(aa)),weeks:Ka(Q(ia)),days:Ka(Q(ma)),hours:Ka(Q(ta)),minutes:Ka(Q(wa)),
seconds:Ka(Q(Ba),"-0"===Ba),milliseconds:Ka(y(Ma),a)}]}function Da(a,t,X,aa,ia,ma,ta){t={year:2===t.length?J(L(t)):L(t),month:Ec.indexOf(X)+1,day:L(aa),hour:L(ia),minute:L(ma)};ta&&(t.second=L(ta));a&&(t.weekday=3<a.length?Gc.indexOf(a)+1:Fc.indexOf(a)+1);return t}function da(a){const [,t,X,aa,ia,ma,ta,wa,Ba,Ma,Fa,Ka]=a;a=Da(t,ia,aa,X,ma,ta,wa);let Ha;Ha=Ba?Pd[Ba]:Ma?0:P(Fa,Ka);return[a,new $a(Ha)]}function ja(a){const [,t,X,aa,ia,ma,ta,wa]=a;return[Da(t,ia,aa,X,ma,ta,wa),$a.utcInstance]}function ha(a){const [,
t,X,aa,ia,ma,ta,wa]=a;return[Da(t,wa,X,aa,ia,ma,ta),$a.utcInstance]}function Z(a,t,X=!1){a={values:X?t.values:{...a.values,...(t.values||{})},loc:a.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||a.conversionAccuracy,matrix:t.matrix||a.matrix};return new La(a)}function ca(a,t,X,aa,ia){a=a[ia][X];var ma=t[X]/a;ma=Math.sign(ma)!==Math.sign(aa[ia])&&0!==aa[ia]&&1>=Math.abs(ma)?0>ma?Math.floor(ma):Math.ceil(ma):Math.trunc(ma);aa[ia]+=ma;t[X]-=ma*a}function fa(a,t){Qd.reduce((X,aa)=>{if(u(t[aa]))return X;
X&&ca(a,t,X,t,aa);return aa},null)}function ea(a,t){a=t.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()-a.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf();return Math.floor(La.fromMillis(a).as("days"))}function na(a,t,X){var aa=[["years",(wa,Ba)=>Ba.year-wa.year],["quarters",(wa,Ba)=>Ba.quarter-wa.quarter+4*(Ba.year-wa.year)],["months",(wa,Ba)=>Ba.month-wa.month+12*(Ba.year-wa.year)],["weeks",(wa,Ba)=>{wa=ea(wa,Ba);return(wa-wa%7)/7}],["days",ea]];const ia={};let ma,ta;for(const [wa,Ba]of aa)0<=
X.indexOf(wa)&&(ma=wa,aa=Ba(a,t),ta=a.plus({[wa]:aa}),ta>t?(a=a.plus({[wa]:aa-1}),--aa):a=ta,ia[wa]=aa);return[a,ia,ta,ma]}function oa(a,t,X,aa){let [ia,ma,ta,wa]=na(a,t,X);a=t-ia;X=X.filter(Ba=>0<=["hours","minutes","seconds","milliseconds"].indexOf(Ba));0===X.length&&(ta<t&&(ta=ia.plus({[wa]:1})),ta!==ia&&(ma[wa]=(ma[wa]||0)+a/(ta-ia)));t=La.fromObject(ma,aa);return 0<X.length?La.fromMillis(a,aa).shiftTo(...X).plus(t):t}function ka({numberingSystem:a},t=""){return new RegExp(`${dc[a||"latn"]}${t}`)}
function sa(a,t=X=>X){return{regex:a,deser:([X])=>{{let aa=parseInt(X,10);if(isNaN(aa)){aa="";for(let ia=0;ia<X.length;ia++){const ma=X.charCodeAt(ia);if(-1!==X[ia].search(dc.hanidec))aa+=Rd.indexOf(X[ia]);else for(const ta in Jc){const [wa,Ba]=Jc[ta];ma>=wa&&ma<=Ba&&(aa+=ma-wa)}}X=parseInt(aa,10)}else X=aa}return t(X)}}}function Ca(a){return a.replace(/\./g,"\\.?").replace(ec,Kc)}function ya(a,t){return null===a?null:{regex:RegExp(a.map(Ca).join("|")),deser:([X])=>a.findIndex(aa=>X.replace(/\./g,
"").replace(ec," ").toLowerCase()===aa.replace(/\./g,"").replace(ec," ").toLowerCase())+t}}function za(a,t){return{regex:a,deser:([,X,aa])=>P(X,aa),groups:t}}function ua(a){return{regex:a,deser:([t])=>t}}function Ea(a,t){const X=ka(t),aa=ka(t,"{2}"),ia=ka(t,"{3}"),ma=ka(t,"{4}"),ta=ka(t,"{6}"),wa=ka(t,"{1,2}"),Ba=ka(t,"{1,3}"),Ma=ka(t,"{1,6}"),Fa=ka(t,"{1,9}"),Ka=ka(t,"{2,4}"),Ha=ka(t,"{4,6}"),Ua=fb=>({regex:RegExp(fb.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$\x26")),deser:([fc])=>fc,literal:!0}),
ib=(fb=>{if(a.literal)return Ua(fb);switch(fb.val){case "G":return ya(t.eras("short",!1),0);case "GG":return ya(t.eras("long",!1),0);case "y":return sa(Ma);case "yy":return sa(Ka,J);case "yyyy":return sa(ma);case "yyyyy":return sa(Ha);case "yyyyyy":return sa(ta);case "M":return sa(wa);case "MM":return sa(aa);case "MMM":return ya(t.months("short",!0,!1),1);case "MMMM":return ya(t.months("long",!0,!1),1);case "L":return sa(wa);case "LL":return sa(aa);case "LLL":return ya(t.months("short",!1,!1),1);
case "LLLL":return ya(t.months("long",!1,!1),1);case "d":return sa(wa);case "dd":return sa(aa);case "o":return sa(Ba);case "ooo":return sa(ia);case "HH":return sa(aa);case "H":return sa(wa);case "hh":return sa(aa);case "h":return sa(wa);case "mm":return sa(aa);case "m":return sa(wa);case "q":return sa(wa);case "qq":return sa(aa);case "s":return sa(wa);case "ss":return sa(aa);case "S":return sa(Ba);case "SSS":return sa(ia);case "u":return ua(Fa);case "uu":return ua(wa);case "uuu":return sa(X);case "a":return ya(t.meridiems(),
0);case "kkkk":return sa(ma);case "kk":return sa(Ka,J);case "W":return sa(wa);case "WW":return sa(aa);case "E":case "c":return sa(X);case "EEE":return ya(t.weekdays("short",!1,!1),1);case "EEEE":return ya(t.weekdays("long",!1,!1),1);case "ccc":return ya(t.weekdays("short",!0,!1),1);case "cccc":return ya(t.weekdays("long",!0,!1),1);case "Z":case "ZZ":return za(new RegExp(`([+-]${wa.source})(?::(${aa.source}))?`),2);case "ZZZ":return za(new RegExp(`([+-]${wa.source})(${aa.source})?`),2);case "z":return ua(/[a-z_+-/]{1,256}?/i);
default:return Ua(fb)}})(a)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};ib.token=a;return ib}function Ia(a){return[`^${a.map(t=>t.regex).reduce((t,X)=>`${t}(${X.source})`,"")}$`,a]}function Na(a,t,X){if(a=a.match(t)){t={};let aa=1;for(const ia in X)if(w(X,ia)){const ma=X[ia],ta=ma.groups?ma.groups+1:1;!ma.literal&&ma.token&&(t[ma.token.val[0]]=ma.deser(a.slice(aa,aa+ta)));aa+=ta}return[a,t]}return[a,{}]}function Va(a){const t=ia=>{switch(ia){case "S":return"millisecond";case "s":return"second";
case "m":return"minute";case "h":case "H":return"hour";case "d":return"day";case "o":return"ordinal";case "L":case "M":return"month";case "y":return"year";case "E":case "c":return"weekday";case "W":return"weekNumber";case "k":return"weekYear";case "q":return"quarter";default:return null}};let X=null,aa;u(a.z)||(X=lb.create(a.z));u(a.Z)||(X||(X=new $a(a.Z)),aa=a.Z);u(a.q)||(a.M=3*(a.q-1)+1);u(a.h)||(12>a.h&&1===a.a?a.h+=12:12===a.h&&0===a.a&&(a.h=0));0===a.G&&a.y&&(a.y=-a.y);u(a.u)||(a.S=y(a.u));return[Object.keys(a).reduce((ia,
ma)=>{const ta=t(ma);ta&&(ia[ta]=a[ma]);return ia},{}),X,aa]}function Ta(a,t){return Array.prototype.concat(...a.map(X=>{if(!X.literal){var aa=Za.macroTokenToFormatOpts(X.val);aa=Qa(aa,t);X=null==aa||aa.includes(void 0)?X:aa}return X}))}function Ja(a,t,X){X=Ta(Za.parseFormat(X),a);var aa=X.map(Ha=>Ea(Ha,a));const ia=aa.find(Ha=>Ha.invalidReason);if(ia)return{input:t,tokens:X,invalidReason:ia.invalidReason};const [ma,ta]=Ia(aa);aa=RegExp(ma,"i");const [wa,Ba]=Na(t,aa,ta),[Ma,Fa,Ka]=Ba?Va(Ba):[null,
null,void 0];if(w(Ba,"a")&&w(Ba,"H"))throw new Bb("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:X,regex:aa,rawMatches:wa,matches:Ba,result:Ma,zone:Fa,specificOffset:Ka}}function Qa(a,t){if(!a)return null;t=Za.create(t,a);var X=t.formatDateTimeParts;Lb||(Lb=W.fromMillis(1555555555555));return X.call(t,Lb).map(aa=>{{const {type:ma,value:ta}=aa;if("literal"===ma)aa={literal:!0,val:ta};else{aa=a[ma];var ia=Sd[ma];"object"===typeof ia&&(ia=ia[aa]);aa=ia?{literal:!1,val:ia}:
void 0}}return aa})}function qa(a,t){return new gb("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${a}, which is invalid`)}function mb(a,t,X){t=new Date(Date.UTC(a,t-1,X));100>a&&0<=a&&t.setUTCFullYear(t.getUTCFullYear()-1900);a=t.getUTCDay();return 0===a?7:a}function gc(a,t){a=S(a)?N:Mb;const X=a.findIndex(aa=>aa<t);return{month:X+1,day:t-a[X]}}function qb(a){const {year:t,month:X,day:aa}=a;var ia=aa+(S(t)?N:Mb)[X-1];const ma=mb(t,X,aa);ia=Math.floor((ia-ma+10)/7);let ta;1>ia?
(ta=t-1,ia=E(ta)):ia>E(t)?(ta=t+1,ia=1):ta=t;return{weekYear:ta,weekNumber:ia,weekday:ma,...r(a)}}function v(a){const {weekYear:t,weekNumber:X,weekday:aa}=a;var ia=mb(t,1,4),ma=S(t)?366:365;ia=7*X+aa-ia-3;1>ia?(ma=t-1,ia+=S(ma)?366:365):ia>ma?(ma=t+1,ia-=S(t)?366:365):ma=t;const {month:ta,day:wa}=gc(ma,ia);return{year:ma,month:ta,day:wa,...r(a)}}function hc(a){const {year:t,month:X,day:aa}=a;var ia=aa+(S(t)?N:Mb)[X-1];return{year:t,ordinal:ia,...r(a)}}function ic(a){const {year:t,ordinal:X}=a,{month:aa,
day:ia}=gc(t,X);return{year:t,month:aa,day:ia,...r(a)}}function jc(a){const t=O(a.year),X=M(a.month,1,12),aa=M(a.day,1,R(a.year,a.month));return t?X?aa?!1:qa("day",a.day):qa("month",a.month):qa("year",a.year)}function Lc(a){const {hour:t,minute:X,second:aa,millisecond:ia}=a;a=M(t,0,23)||24===t&&0===X&&0===aa&&0===ia;const ma=M(X,0,59),ta=M(aa,0,59),wa=M(ia,0,999);return a?ma?ta?wa?!1:qa("millisecond",ia):qa("second",aa):qa("minute",X):qa("hour",t)}function Cb(a){return new gb("unsupported zone",`the zone "${a.name}" is not supported`)}
function Nb(a){null===a.weekData&&(a.weekData=qb(a.c));return a.weekData}function Db(a,t){a={ts:a.ts,zone:a.zone,c:a.c,o:a.o,loc:a.loc,invalid:a.invalid};return new W({...a,...t,old:a})}function kc(a,t,X){let aa=a-6E4*t;const ia=X.offset(aa);if(t===ia)return[aa,t];aa-=6E4*(ia-t);t=X.offset(aa);return ia===t?[aa,ia]:[a-6E4*Math.min(ia,t),Math.max(ia,t)]}function lc(a,t){a=new Date(a+6E4*t);return{year:a.getUTCFullYear(),month:a.getUTCMonth()+1,day:a.getUTCDate(),hour:a.getUTCHours(),minute:a.getUTCMinutes(),
second:a.getUTCSeconds(),millisecond:a.getUTCMilliseconds()}}function Ob(a,t,X){return kc(D(a),t,X)}function mc(a,t){const X=a.o;var aa=a.c.year+Math.trunc(t.years);const ia=a.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters);aa={...a.c,year:aa,month:ia,day:Math.min(a.c.day,R(aa,ia))+Math.trunc(t.days)+7*Math.trunc(t.weeks)};t=La.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-
Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds");aa=D(aa);let [ma,ta]=kc(aa,X,a.zone);0!==t&&(ma+=t,ta=a.zone.offset(ma));return{ts:ma,o:ta}}function rb(a,t,X,aa,ia,ma){const {setZone:ta,zone:wa}=X;return a&&0!==Object.keys(a).length?(a=W.fromObject(a,{...X,zone:t||wa,specificOffset:ma}),ta?a:a.setZone(wa)):W.invalid(new gb("unparsable",`the input "${ia}" can't be parsed as ${aa}`))}function yb(a,t,X=!0){return a.isValid?Za.create(Oa.create("en-US"),
{allowZ:X,forceSimple:!0}).formatDateTimeFromString(a,t):null}function nc(a,t){const X=9999<a.c.year||0>a.c.year;let aa="";X&&0<=a.c.year&&(aa+="+");aa+=h(a.c.year,X?6:4);t?(aa=aa+"-"+h(a.c.month),aa=aa+"-"+h(a.c.day)):(aa+=h(a.c.month),aa+=h(a.c.day));return aa}function Mc(a,t,X,aa,ia,ma){let ta=h(a.c.hour);t?(ta=ta+":"+h(a.c.minute),0===a.c.second&&X||(ta+=":")):ta+=h(a.c.minute);0===a.c.second&&X||(ta+=h(a.c.second),0===a.c.millisecond&&aa||(ta=ta+"."+h(a.c.millisecond,3)));ia&&(a.isOffsetFixed&&
0===a.offset&&!ma?ta+="Z":0>a.o?(ta=ta+"-"+h(Math.trunc(-a.o/60)),ta=ta+":"+h(Math.trunc(-a.o%60))):(ta=ta+"+"+h(Math.trunc(a.o/60)),ta=ta+":"+h(Math.trunc(a.o%60))));ma&&(ta+="["+a.zone.ianaName+"]");return ta}function Nc(a){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",
weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[a.toLowerCase()];if(!t)throw new Oc(a);return t}function oc(a,t){const X=k(t.zone,Wa.defaultZone);t=Oa.fromObject(t);const aa=Wa.now();var ia;if(u(a.year))a=aa;else{for(const ma of ra)u(a[ma])&&(a[ma]=Eb[ma]);if(ia=jc(a)||Lc(a))return W.invalid(ia);ia=X.offset(aa);[a,ia]=Ob(a,ia,X)}return new W({ts:a,zone:X,loc:t,o:ia})}function pc(a,t,X){const aa=
u(X.round)?!0:X.round,ia=(ta,wa)=>{ta=I(ta,aa||X.calendary?0:2,!0);return t.loc.clone(X).relFormatter(X).format(ta,wa)},ma=ta=>X.calendary?t.hasSame(a,ta)?0:t.startOf(ta).diff(a.startOf(ta),ta).get(ta):t.diff(a,ta).get(ta);if(X.unit)return ia(ma(X.unit),X.unit);for(const ta of X.units){const wa=ma(ta);if(1<=Math.abs(wa))return ia(wa,ta)}return ia(a>t?-0:0,X.units[X.units.length-1])}function Fb(a){let t={};0<a.length&&"object"===typeof a[a.length-1]?(t=a[a.length-1],a=Array.from(a).slice(0,a.length-
1)):a=Array.from(a);return[t,a]}function Gb(a){if(W.isDateTime(a))return a;if(a&&a.valueOf&&f(a.valueOf()))return W.fromJSDate(a);if(a&&"object"===typeof a)return W.fromObject(a);throw new bb(`Unknown datetime argument: ${a}, of type ${typeof a}`);}class sb extends Error{}class Td extends sb{constructor(a){super(`Invalid DateTime: ${a.toMessage()}`)}}class Ud extends sb{constructor(a){super(`Invalid Interval: ${a.toMessage()}`)}}class Vd extends sb{constructor(a){super(`Invalid Duration: ${a.toMessage()}`)}}
class Bb extends sb{}class Oc extends sb{constructor(a){super(`Invalid unit ${a}`)}}class bb extends sb{}class nb extends sb{constructor(){super("Zone is an abstract class")}}const qc={year:"numeric",month:"numeric",day:"numeric"},Pc={year:"numeric",month:"short",day:"numeric"},Wd={year:"numeric",month:"short",day:"numeric",weekday:"short"},Qc={year:"numeric",month:"long",day:"numeric"},Rc={year:"numeric",month:"long",day:"numeric",weekday:"long"},Sc={hour:"numeric",minute:"numeric"},Tc={hour:"numeric",
minute:"numeric",second:"numeric"},Uc={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},Vc={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},Wc={hour:"numeric",minute:"numeric",hourCycle:"h23"},Xc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23"},Yc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"short"},Zc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"long"},$c={year:"numeric",
month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"},ad={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},bd={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"},cd={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},Xd={year:"numeric",month:"short",day:"numeric",weekday:"short",hour:"numeric",minute:"numeric"},dd={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",
timeZoneName:"short"},ed={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},fd={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",timeZoneName:"long"},gd={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},hd=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,Kd="January February March April May June July August September October November December".split(" "),
Ec="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Jd="JFMAMJJASOND".split(""),Gc="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),Fc="Mon Tue Wed Thu Fri Sat Sun".split(" "),Ld="MTWTFSS".split(""),id=["AM","PM"],Hc=["Before Christ","Anno Domini"],Nd=["BC","AD"],Md=["B","A"],Yd={D:qc,DD:Pc,DDD:Qc,DDDD:Rc,t:Sc,tt:Tc,ttt:Uc,tttt:Vc,T:Wc,TT:Xc,TTT:Yc,TTTT:Zc,f:$c,ff:bd,fff:dd,ffff:fd,F:ad,FF:cd,FFF:ed,FFFF:gd};class Za{static create(a,t={}){return new Za(a,t)}static parseFormat(a){let t=
null,X="",aa=!1;const ia=[];for(let ma=0;ma<a.length;ma++){const ta=a.charAt(ma);"'"===ta?(0<X.length&&ia.push({literal:aa,val:X}),t=null,X="",aa=!aa):aa?X+=ta:ta===t?X+=ta:(0<X.length&&ia.push({literal:!1,val:X}),t=X=ta)}0<X.length&&ia.push({literal:aa,val:X});return ia}static macroTokenToFormatOpts(a){return Yd[a]}constructor(a,t){this.opts=t;this.loc=a;this.systemLoc=null}formatWithSystemDefault(a,t){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(a,
{...this.opts,...t}).format()}formatDateTime(a,t={}){return this.loc.dtFormatter(a,{...this.opts,...t}).format()}formatDateTimeParts(a,t={}){return this.loc.dtFormatter(a,{...this.opts,...t}).formatToParts()}resolvedOptions(a,t={}){return this.loc.dtFormatter(a,{...this.opts,...t}).resolvedOptions()}num(a,t=0){if(this.opts.forceSimple)return h(a,t);const X={...this.opts};0<t&&(X.padTo=t);return this.loc.numberFormatter(X).format(a)}formatDateTimeFromString(a,t){const X="en"===this.loc.listingMode(),
aa=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,ia=(Fa,Ka)=>this.loc.extract(a,Fa,Ka),ma=Fa=>a.isOffsetFixed&&0===a.offset&&Fa.allowZ?"Z":a.isValid?a.zone.formatOffset(a.ts,Fa.format):"",ta=(Fa,Ka)=>X?H(Fa)[a.month-1]:ia(Ka?{month:Fa}:{month:Fa,day:"numeric"},"month"),wa=(Fa,Ka)=>X?d(Fa)[a.weekday-1]:ia(Ka?{weekday:Fa}:{weekday:Fa,month:"long",day:"numeric"},"weekday"),Ba=Fa=>{const Ka=Za.macroTokenToFormatOpts(Fa);return Ka?this.formatWithSystemDefault(a,Ka):Fa},Ma=Fa=>X?p(Fa)[0>
a.year?0:1]:ia({era:Fa},"era");return m(Za.parseFormat(t),Fa=>{switch(Fa){case "S":return this.num(a.millisecond);case "u":case "SSS":return this.num(a.millisecond,3);case "s":return this.num(a.second);case "ss":return this.num(a.second,2);case "uu":return this.num(Math.floor(a.millisecond/10),2);case "uuu":return this.num(Math.floor(a.millisecond/100));case "m":return this.num(a.minute);case "mm":return this.num(a.minute,2);case "h":return this.num(0===a.hour%12?12:a.hour%12);case "hh":return this.num(0===
a.hour%12?12:a.hour%12,2);case "H":return this.num(a.hour);case "HH":return this.num(a.hour,2);case "Z":return ma({format:"narrow",allowZ:this.opts.allowZ});case "ZZ":return ma({format:"short",allowZ:this.opts.allowZ});case "ZZZ":return ma({format:"techie",allowZ:this.opts.allowZ});case "ZZZZ":return a.zone.offsetName(a.ts,{format:"short",locale:this.loc.locale});case "ZZZZZ":return a.zone.offsetName(a.ts,{format:"long",locale:this.loc.locale});case "z":return a.zoneName;case "a":return X?id[12>a.hour?
0:1]:ia({hour:"numeric",hourCycle:"h12"},"dayperiod");case "d":return aa?ia({day:"numeric"},"day"):this.num(a.day);case "dd":return aa?ia({day:"2-digit"},"day"):this.num(a.day,2);case "c":return this.num(a.weekday);case "ccc":return wa("short",!0);case "cccc":return wa("long",!0);case "ccccc":return wa("narrow",!0);case "E":return this.num(a.weekday);case "EEE":return wa("short",!1);case "EEEE":return wa("long",!1);case "EEEEE":return wa("narrow",!1);case "L":return aa?ia({month:"numeric",day:"numeric"},
"month"):this.num(a.month);case "LL":return aa?ia({month:"2-digit",day:"numeric"},"month"):this.num(a.month,2);case "LLL":return ta("short",!0);case "LLLL":return ta("long",!0);case "LLLLL":return ta("narrow",!0);case "M":return aa?ia({month:"numeric"},"month"):this.num(a.month);case "MM":return aa?ia({month:"2-digit"},"month"):this.num(a.month,2);case "MMM":return ta("short",!1);case "MMMM":return ta("long",!1);case "MMMMM":return ta("narrow",!1);case "y":return aa?ia({year:"numeric"},"year"):this.num(a.year);
case "yy":return aa?ia({year:"2-digit"},"year"):this.num(a.year.toString().slice(-2),2);case "yyyy":return aa?ia({year:"numeric"},"year"):this.num(a.year,4);case "yyyyyy":return aa?ia({year:"numeric"},"year"):this.num(a.year,6);case "G":return Ma("short");case "GG":return Ma("long");case "GGGGG":return Ma("narrow");case "kk":return this.num(a.weekYear.toString().slice(-2),2);case "kkkk":return this.num(a.weekYear,4);case "W":return this.num(a.weekNumber);case "WW":return this.num(a.weekNumber,2);
case "o":return this.num(a.ordinal);case "ooo":return this.num(a.ordinal,3);case "q":return this.num(a.quarter);case "qq":return this.num(a.quarter,2);case "X":return this.num(Math.floor(a.ts/1E3));case "x":return this.num(a.ts);default:return Ba(Fa)}})}formatDurationFromString(a,t){const X=ia=>{switch(ia[0]){case "S":return"millisecond";case "s":return"second";case "m":return"minute";case "h":return"hour";case "d":return"day";case "w":return"week";case "M":return"month";case "y":return"year";default:return null}};
t=Za.parseFormat(t);const aa=t.reduce((ia,{literal:ma,val:ta})=>ma?ia:ia.concat(ta),[]);a=a.shiftTo(...aa.map(X).filter(ia=>ia));return m(t,(ia=>ma=>{const ta=X(ma);return ta?this.num(ia.get(ta),ma.length):ma})(a))}}class gb{constructor(a,t){this.reason=a;this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}class Ab{get type(){throw new nb;}get name(){throw new nb;}get ianaName(){return this.name}get isUniversal(){throw new nb;}offsetName(a,t){throw new nb;
}formatOffset(a,t){throw new nb;}offset(a){throw new nb;}equals(a){throw new nb;}get isValid(){throw new nb;}}let rc=null;class ac extends Ab{static get instance(){null===rc&&(rc=new ac);return rc}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(a,{format:t,locale:X}){return A(a,t,X)}formatOffset(a,t){return b(this.offset(a),t)}offset(a){return-(new Date(a)).getTimezoneOffset()}equals(a){return"system"===a.type}get isValid(){return!0}}
let Hb={};const Zd={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let Ib={};class lb extends Ab{static create(a){Ib[a]||(Ib[a]=new lb(a));return Ib[a]}static resetCache(){Ib={};Hb={}}static isValidSpecifier(a){return this.isValidZone(a)}static isValidZone(a){if(!a)return!1;try{return(new Intl.DateTimeFormat("en-US",{timeZone:a})).format(),!0}catch(t){return!1}}constructor(a){super();this.zoneName=a;this.valid=lb.isValidZone(a)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(a,
{format:t,locale:X}){return A(a,t,X,this.name)}formatOffset(a,t){return b(this.offset(a),t)}offset(a){a=new Date(a);if(isNaN(a))return NaN;var t=this.name;Hb[t]||(Hb[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}));t=Hb[t];if(t.formatToParts){t=t.formatToParts(a);var X=[];for(let Fa=0;Fa<t.length;Fa++){const {type:Ka,value:Ha}=t[Fa],Ua=Zd[Ka];"era"===Ka?X[Ua]=Ha:u(Ua)||(X[Ua]=parseInt(Ha,
10))}t=X}else{t=t.format(a).replace(/\u200E/g,"");t=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t);const [,Fa,Ka,Ha,Ua,ib,fb,fc]=t;t=[Ha,Fa,Ka,Ua,ib,fb,fc]}let [aa,ia,ma,ta,wa,Ba,Ma]=t;"BC"===ta&&(aa=-Math.abs(aa)+1);t=D({year:aa,month:ia,day:ma,hour:24===wa?0:wa,minute:Ba,second:Ma,millisecond:0});a=+a;X=a%1E3;return(t-(a-(0<=X?X:1E3+X)))/6E4}equals(a){return"iana"===a.type&&a.name===this.name}get isValid(){return this.valid}}let sc=null;class $a extends Ab{static get utcInstance(){null===
sc&&(sc=new $a(0));return sc}static instance(a){return 0===a?$a.utcInstance:new $a(a)}static parseSpecifier(a){return a&&(a=a.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i))?new $a(P(a[1],a[2])):null}constructor(a){super();this.fixed=a}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${b(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${b(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(a,t){return b(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(a){return"fixed"===
a.type&&a.fixed===this.fixed}get isValid(){return!0}}class Od extends Ab{constructor(a){super();this.zoneName=a}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}let jd=()=>Date.now(),kd="system",Pb=null,Qb=null,ld=null,md;class Wa{static get now(){return jd}static set now(a){jd=a}static set defaultZone(a){kd=a}static get defaultZone(){return k(kd,ac.instance)}static get defaultLocale(){return Pb}static set defaultLocale(a){Pb=
a}static get defaultNumberingSystem(){return Qb}static set defaultNumberingSystem(a){Qb=a}static get defaultOutputCalendar(){return ld}static set defaultOutputCalendar(a){ld=a}static get throwOnInvalid(){return md}static set throwOnInvalid(a){md=a}static resetCaches(){Oa.resetCache();lb.resetCache()}}let Ic={},bc={},cc={},Kb={},Rb=null;class nd{constructor(a,t,X){this.padTo=X.padTo||0;this.floor=X.floor||!1;const {padTo:aa,floor:ia,...ma}=X;if(!t||0<Object.keys(ma).length)t={useGrouping:!1,...X},
0<X.padTo&&(t.minimumIntegerDigits=X.padTo),this.inf=T(a,t)}format(a){if(this.inf)return this.inf.format(this.floor?Math.floor(a):a);a=this.floor?Math.floor(a):I(a,3);return h(a,this.padTo)}}class od{constructor(a,t,X){this.opts=X;if(a.zone.isUniversal){var aa=a.offset/60*-1;aa=0<=aa?`Etc/GMT+${aa}`:`Etc/GMT${aa}`;0!==a.offset&&lb.create(aa).valid?this.dt=a:(aa="UTC",this.dt=X.timeZoneName?a:0===a.offset?a:W.fromMillis(a.ts+6E4*a.offset))}else"system"===a.zone.type?this.dt=a:(this.dt=a,aa=a.zone.name);
a={...this.opts};aa&&(a.timeZone=aa);this.dtf=q(t,a)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class $d{constructor(a,t,X){this.opts={style:"long",...X};!t&&l()&&(this.rtf=n(a,X))}format(a,t){return this.rtf?this.rtf.format(a,t):z(t,a,this.opts.numeric,"long"!==this.opts.style)}formatToParts(a,t){return this.rtf?this.rtf.formatToParts(a,t):[]}}class Oa{static fromOpts(a){return Oa.create(a.locale,
a.numberingSystem,a.outputCalendar,a.defaultToEN)}static create(a,t,X,aa=!1){a=a||Wa.defaultLocale;var ia;(ia=a)||(aa?aa="en-US":(Rb||(Rb=(new Intl.DateTimeFormat).resolvedOptions().locale),aa=Rb),ia=aa);return new Oa(ia,t||Wa.defaultNumberingSystem,X||Wa.defaultOutputCalendar,a)}static resetCache(){Rb=null;bc={};cc={};Kb={}}static fromObject({locale:a,numberingSystem:t,outputCalendar:X}={}){return Oa.create(a,t,X)}constructor(a,t,X,aa){var ia=a.indexOf("-u-");if(-1===ia)a=[a];else{let Ba;ia=a.substring(0,
ia);try{Ba=q(a).resolvedOptions()}catch(Ka){Ba=q(ia).resolvedOptions()}const {numberingSystem:Ma,calendar:Fa}=Ba;a=[ia,Ma,Fa]}const [ma,ta,wa]=a;this.locale=ma;this.numberingSystem=t||ta||null;this.outputCalendar=X||wa||null;t=this.locale;X=this.numberingSystem;if((a=this.outputCalendar)||X)t+="-u",a&&(t+=`-ca-${a}`),X&&(t+=`-nu-${X}`);this.intl=t;this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache={};this.specifiedLocale=aa;
this.fastNumbersCached=null}get fastNumbers(){if(null==this.fastNumbersCached){var a=this.numberingSystem&&"latn"!==this.numberingSystem?!1:"latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===(new Intl.DateTimeFormat(this.intl)).resolvedOptions().numberingSystem;this.fastNumbersCached=a}return this.fastNumbersCached}listingMode(){const a=this.isEnglish(),t=(null===this.numberingSystem||"latn"===this.numberingSystem)&&(null===this.outputCalendar||"gregory"===this.outputCalendar);
return a&&t?"en":"intl"}clone(a){return a&&0!==Object.getOwnPropertyNames(a).length?Oa.create(a.locale||this.specifiedLocale,a.numberingSystem||this.numberingSystem,a.outputCalendar||this.outputCalendar,a.defaultToEN||!1):this}redefaultToEN(a={}){return this.clone({...a,defaultToEN:!0})}redefaultToSystem(a={}){return this.clone({...a,defaultToEN:!1})}months(a,t=!1,X=!0){return K(this,a,X,H,()=>{const aa=t?{month:a,day:"numeric"}:{month:a},ia=t?"format":"standalone";this.monthsCache[ia][a]||(this.monthsCache[ia][a]=
x(ma=>this.extract(ma,aa,"month")));return this.monthsCache[ia][a]})}weekdays(a,t=!1,X=!0){return K(this,a,X,d,()=>{const aa=t?{weekday:a,year:"numeric",month:"long",day:"numeric"}:{weekday:a},ia=t?"format":"standalone";this.weekdaysCache[ia][a]||(this.weekdaysCache[ia][a]=G(ma=>this.extract(ma,aa,"weekday")));return this.weekdaysCache[ia][a]})}meridiems(a=!0){return K(this,void 0,a,()=>id,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[W.utc(2016,11,13,9),
W.utc(2016,11,13,19)].map(X=>this.extract(X,t,"dayperiod"))}return this.meridiemCache})}eras(a,t=!0){return K(this,a,t,p,()=>{const X={era:a};this.eraCache[a]||(this.eraCache[a]=[W.utc(-40,1,1),W.utc(2017,1,1)].map(aa=>this.extract(aa,X,"era")));return this.eraCache[a]})}extract(a,t,X){return(a=this.dtFormatter(a,t).formatToParts().find(aa=>aa.type.toLowerCase()===X))?a.value:null}numberFormatter(a={}){return new nd(this.intl,a.forceSimple||this.fastNumbers,a)}dtFormatter(a,t={}){return new od(a,
this.intl,t)}relFormatter(a={}){return new $d(this.intl,this.isEnglish(),a)}listFormatter(a={}){return B(this.intl,a)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||(new Intl.DateTimeFormat(this.intl)).resolvedOptions().locale.startsWith("en-us")}equals(a){return this.locale===a.locale&&this.numberingSystem===a.numberingSystem&&this.outputCalendar===a.outputCalendar}}const pd=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,tc=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,qd=
RegExp(`${tc.source}${`(?:${pd.source}?(?:\\[(${hd.source})\\])?)?`}`),uc=RegExp(`(?:T${qd.source})?`),ae=la("weekYear","weekNumber","weekDay"),be=la("year","ordinal"),rd=RegExp(`${tc.source} ?(?:${pd.source}|(${hd.source}))?`),ce=RegExp(`(?: ${rd.source})?`),de=RegExp(`^T?${tc.source}$`),ee=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/,
Pd={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},fe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/,ge=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,he=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,
ie=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/,je=U(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,uc),ke=U(/(\d{4})-?W(\d\d)(?:-?(\d))?/,uc),le=U(/(\d{4})-?(\d{3})/,uc),me=U(qd),sd=Y(function(a,t){return[{year:pa(a,t),month:pa(a,t+1,1),day:pa(a,t+2,1)},null,t+3]},va,xa,Aa),ne=Y(ae,va,xa,Aa),oe=Y(be,va,xa,Aa),pe=Y(va,xa,Aa),qe=Y(va),re=U(/(\d{4})-(\d\d)-(\d\d)/,ce),se=U(rd),te=Y(va,xa,Aa),td={weeks:{days:7,hours:168,minutes:10080,
seconds:604800,milliseconds:6048E5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864E5},hours:{minutes:60,seconds:3600,milliseconds:36E5},minutes:{seconds:60,milliseconds:6E4},seconds:{milliseconds:1E3}},ue={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536E3,milliseconds:31536E6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624E5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592E3,milliseconds:2592E6},
...td},ve={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:31556952,milliseconds:31556952E3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:7889238,milliseconds:7889238E3},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746E3},...td},tb="years quarters months weeks days hours minutes seconds milliseconds".split(" "),Qd=tb.slice(0).reverse();class La{constructor(a){const t=
"longterm"===a.conversionAccuracy||!1;let X=t?ve:ue;a.matrix&&(X=a.matrix);this.values=a.values;this.loc=a.loc||Oa.create();this.conversionAccuracy=t?"longterm":"casual";this.invalid=a.invalid||null;this.matrix=X;this.isLuxonDuration=!0}static fromMillis(a,t){return La.fromObject({milliseconds:a},t)}static fromObject(a,t={}){if(null==a||"object"!==typeof a)throw new bb(`Duration.fromObject: argument expected to be an object, got ${null===a?"null":typeof a}`);return new La({values:c(a,La.normalizeUnit),
loc:Oa.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(a){if(f(a))return La.fromMillis(a);if(La.isDuration(a))return a;if("object"===typeof a)return La.fromObject(a);throw new bb(`Unknown duration argument ${a} of type ${typeof a}`);}static fromISO(a,t){const [X]=ba(a,[ee,Ga]);return X?La.fromObject(X,t):La.invalid("unparsable",`the input "${a}" can't be parsed as ISO 8601`)}static fromISOTime(a,t){const [X]=ba(a,[de,qe]);return X?La.fromObject(X,t):
La.invalid("unparsable",`the input "${a}" can't be parsed as ISO 8601`)}static invalid(a,t=null){if(!a)throw new bb("need to specify a reason the Duration is invalid");a=a instanceof gb?a:new gb(a,t);if(Wa.throwOnInvalid)throw new Vd(a);return new La({invalid:a})}static normalizeUnit(a){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",
second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[a?a.toLowerCase():a];if(!t)throw new Oc(a);return t}static isDuration(a){return a&&a.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(a,t={}){t={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?Za.create(this.loc,t).formatDurationFromString(this,a):"Invalid Duration"}toHuman(a={}){const t=tb.map(X=>
{const aa=this.values[X];return u(aa)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...a,unit:X.slice(0,-1)}).format(aa)}).filter(X=>X);return this.loc.listFormatter({type:"conjunction",style:a.listStyle||"narrow",...a}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let a="P";0!==this.years&&(a+=this.years+"Y");if(0!==this.months||0!==this.quarters)a+=this.months+3*this.quarters+"M";0!==this.weeks&&(a+=this.weeks+"W");0!==this.days&&
(a+=this.days+"D");if(0!==this.hours||0!==this.minutes||0!==this.seconds||0!==this.milliseconds)a+="T";0!==this.hours&&(a+=this.hours+"H");0!==this.minutes&&(a+=this.minutes+"M");if(0!==this.seconds||0!==this.milliseconds)a+=I(this.seconds+this.milliseconds/1E3,3)+"S";"P"===a&&(a+="T0S");return a}toISOTime(a={}){if(!this.isValid)return null;var t=this.toMillis();if(0>t||864E5<=t)return null;a={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...a};t=this.shiftTo("hours",
"minutes","seconds","milliseconds");let X="basic"===a.format?"hhmm":"hh:mm";a.suppressSeconds&&0===t.seconds&&0===t.milliseconds||(X+="basic"===a.format?"ss":":ss",a.suppressMilliseconds&&0===t.milliseconds||(X+=".SSS"));t=t.toFormat(X);a.includePrefix&&(t="T"+t);return t}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(a){if(!this.isValid)return this;a=La.fromDurationLike(a);const t={};for(const X of tb)if(w(a.values,
X)||w(this.values,X))t[X]=a.get(X)+this.get(X);return Z(this,{values:t},!0)}minus(a){if(!this.isValid)return this;a=La.fromDurationLike(a);return this.plus(a.negate())}mapUnits(a){if(!this.isValid)return this;const t={};for(const X of Object.keys(this.values))t[X]=e(a(this.values[X],X));return Z(this,{values:t},!0)}get(a){return this[La.normalizeUnit(a)]}set(a){if(!this.isValid)return this;a={...this.values,...c(a,La.normalizeUnit)};return Z(this,{values:a})}reconfigure({locale:a,numberingSystem:t,
conversionAccuracy:X,matrix:aa}={}){a={loc:this.loc.clone({locale:a,numberingSystem:t}),matrix:aa,conversionAccuracy:X};return Z(this,a)}as(a){return this.isValid?this.shiftTo(a).get(a):NaN}normalize(){if(!this.isValid)return this;const a=this.toObject();fa(this.matrix,a);return Z(this,{values:a},!0)}shiftTo(...a){if(!this.isValid||0===a.length)return this;a=a.map(ma=>La.normalizeUnit(ma));const t={},X={},aa=this.toObject();let ia;for(const ma of tb)if(0<=a.indexOf(ma)){ia=ma;let ta=0;for(const Ba in X)ta+=
this.matrix[Ba][ma]*X[Ba],X[Ba]=0;f(aa[ma])&&(ta+=aa[ma]);const wa=Math.trunc(ta);t[ma]=wa;X[ma]=(1E3*ta-1E3*wa)/1E3;for(const Ba in aa)tb.indexOf(Ba)>tb.indexOf(ma)&&ca(this.matrix,aa,Ba,t,ma)}else f(aa[ma])&&(X[ma]=aa[ma]);for(const ma in X)0!==X[ma]&&(t[ia]+=ma===ia?X[ma]:X[ma]/this.matrix[ia][ma]);return Z(this,{values:t},!0).normalize()}negate(){if(!this.isValid)return this;const a={};for(const t of Object.keys(this.values))a[t]=0===this.values[t]?0:-this.values[t];return Z(this,{values:a},!0)}get years(){return this.isValid?
this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||
0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(a){if(!this.isValid||!a.isValid||!this.loc.equals(a.loc))return!1;for(const aa of tb){var t=this.values[aa];var X=a.values[aa];t=void 0===t||0===t?void 0===X||0===X:t===X;if(!t)return!1}return!0}}class Sa{constructor(a){this.s=a.start;this.e=a.end;this.invalid=a.invalid||null;this.isLuxonInterval=!0}static invalid(a,
t=null){if(!a)throw new bb("need to specify a reason the Interval is invalid");a=a instanceof gb?a:new gb(a,t);if(Wa.throwOnInvalid)throw new Ud(a);return new Sa({invalid:a})}static fromDateTimes(a,t){a=Gb(a);t=Gb(t);var X=a&&a.isValid?t&&t.isValid?t<a?Sa.invalid("end before start",`The end of an interval must be after its start, but you had start=${a.toISO()} and end=${t.toISO()}`):null:Sa.invalid("missing or invalid end"):Sa.invalid("missing or invalid start");return null==X?new Sa({start:a,end:t}):
X}static after(a,t){t=La.fromDurationLike(t);a=Gb(a);return Sa.fromDateTimes(a,a.plus(t))}static before(a,t){t=La.fromDurationLike(t);a=Gb(a);return Sa.fromDateTimes(a.minus(t),a)}static fromISO(a,t){const [X,aa]=(a||"").split("/",2);if(X&&aa){let ta;try{var ia=W.fromISO(X,t);ta=ia.isValid}catch(Ba){ta=!1}let wa;try{var ma=W.fromISO(aa,t);wa=ma.isValid}catch(Ba){wa=!1}if(ta&&wa)return Sa.fromDateTimes(ia,ma);if(ta){if(ma=La.fromISO(aa,t),ma.isValid)return Sa.after(ia,ma)}else if(wa&&(ia=La.fromISO(X,
t),ia.isValid))return Sa.before(ma,ia)}return Sa.invalid("unparsable",`the input "${a}" can't be parsed as ISO 8601`)}static isInterval(a){return a&&a.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(a="milliseconds"){return this.isValid?this.toDuration(...[a]).get(a):
NaN}count(a="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(a),X=this.end.startOf(a);return Math.floor(X.diff(t,a).get(a))+1}hasSame(a){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,a):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(a){return this.isValid?this.s>a:!1}isBefore(a){return this.isValid?this.e<=a:!1}contains(a){return this.isValid?this.s<=a&&this.e>a:!1}set({start:a,end:t}={}){return this.isValid?Sa.fromDateTimes(a||this.s,t||
this.e):this}splitAt(...a){if(!this.isValid)return[];a=a.map(Gb).filter(ma=>this.contains(ma)).sort();const t=[];let {s:X}=this,aa=0;for(;X<this.e;){var ia=a[aa]||this.e;ia=+ia>+this.e?this.e:ia;t.push(Sa.fromDateTimes(X,ia));X=ia;aa+=1}return t}splitBy(a){a=La.fromDurationLike(a);if(!this.isValid||!a.isValid||0===a.as("milliseconds"))return[];let {s:t}=this,X=1;const aa=[];for(;t<this.e;){var ia=this.start.plus(a.mapUnits(ma=>ma*X));ia=+ia>+this.e?this.e:ia;aa.push(Sa.fromDateTimes(t,ia));t=ia;X+=
1}return aa}divideEqually(a){return this.isValid?this.splitBy(this.length()/a).slice(0,a):[]}overlaps(a){return this.e>a.s&&this.s<a.e}abutsStart(a){return this.isValid?+this.e===+a.s:!1}abutsEnd(a){return this.isValid?+a.e===+this.s:!1}engulfs(a){return this.isValid?this.s<=a.s&&this.e>=a.e:!1}equals(a){return this.isValid&&a.isValid?this.s.equals(a.s)&&this.e.equals(a.e):!1}intersection(a){if(!this.isValid)return this;const t=this.s>a.s?this.s:a.s;a=this.e<a.e?this.e:a.e;return t>=a?null:Sa.fromDateTimes(t,
a)}union(a){return this.isValid?Sa.fromDateTimes(this.s<a.s?this.s:a.s,this.e>a.e?this.e:a.e):this}static merge(a){const [t,X]=a.sort((aa,ia)=>aa.s-ia.s).reduce(([aa,ia],ma)=>ia?ia.overlaps(ma)||ia.abutsStart(ma)?[aa,ia.union(ma)]:[aa.concat([ia]),ma]:[aa,ma],[[],null]);X&&t.push(X);return t}static xor(a){let t=null,X=0;const aa=[];a=a.map(ia=>[{time:ia.s,type:"s"},{time:ia.e,type:"e"}]);a=Array.prototype.concat(...a).sort((ia,ma)=>ia.time-ma.time);for(const ia of a)X+="s"===ia.type?1:-1,1===X?t=
ia.time:(t&&+t!==+ia.time&&aa.push(Sa.fromDateTimes(t,ia.time)),t=null);return Sa.merge(aa)}difference(...a){return Sa.xor([this].concat(a)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:"Invalid Interval"}toISO(a){return this.isValid?`${this.s.toISO(a)}/${this.e.toISO(a)}`:"Invalid Interval"}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:"Invalid Interval"}toISOTime(a){return this.isValid?
`${this.s.toISOTime(a)}/${this.e.toISOTime(a)}`:"Invalid Interval"}toFormat(a,{separator:t=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(a)}${t}${this.e.toFormat(a)}`:"Invalid Interval"}toDuration(a,t){return this.isValid?this.e.diff(this.s,a,t):La.invalid(this.invalidReason)}mapEndpoints(a){return Sa.fromDateTimes(a(this.s),a(this.e))}}class Jb{static hasDST(a=Wa.defaultZone){const t=W.now().setZone(a).set({month:12});return!a.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(a){return lb.isValidZone(a)}static normalizeZone(a){return k(a,
Wa.defaultZone)}static months(a="long",{locale:t=null,numberingSystem:X=null,locObj:aa=null,outputCalendar:ia="gregory"}={}){return(aa||Oa.create(t,X,ia)).months(a)}static monthsFormat(a="long",{locale:t=null,numberingSystem:X=null,locObj:aa=null,outputCalendar:ia="gregory"}={}){return(aa||Oa.create(t,X,ia)).months(a,!0)}static weekdays(a="long",{locale:t=null,numberingSystem:X=null,locObj:aa=null}={}){return(aa||Oa.create(t,X,null)).weekdays(a)}static weekdaysFormat(a="long",{locale:t=null,numberingSystem:X=
null,locObj:aa=null}={}){return(aa||Oa.create(t,X,null)).weekdays(a,!0)}static meridiems({locale:a=null}={}){return Oa.create(a).meridiems()}static eras(a="short",{locale:t=null}={}){return Oa.create(t,null,"gregory").eras(a)}static features(){return{relative:l()}}}const dc={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",
khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},Jc={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,
3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Rd=dc.hanidec.replace(/[\[|\]]/g,"").split(""),Kc=`[ ${String.fromCharCode(160)}]`,ec=new RegExp(Kc,"g"),Sd={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s",
"2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let Lb=null;const Mb=[0,31,59,90,120,151,181,212,243,273,304,334],N=[0,31,60,91,121,152,182,213,244,274,305,335],Eb={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},hb={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},vc={ordinal:1,hour:0,minute:0,second:0,millisecond:0},ra="year month day hour minute second millisecond".split(" "),wc="weekYear weekNumber weekday hour minute second millisecond".split(" "),V="year ordinal hour minute second millisecond".split(" ");
class W{constructor(a){const t=a.zone||Wa.defaultZone;let X=a.invalid||(Number.isNaN(a.ts)?new gb("invalid input"):null)||(t.isValid?null:Cb(t));this.ts=u(a.ts)?Wa.now():a.ts;let aa=null;var ia=null;X||(a.old&&a.old.ts===this.ts&&a.old.zone.equals(t)?[aa,ia]=[a.old.c,a.old.o]:(ia=t.offset(this.ts),aa=lc(this.ts,ia),aa=(X=Number.isNaN(aa.year)?new gb("invalid input"):null)?null:aa,ia=X?null:ia));this._zone=t;this.loc=a.loc||Oa.create();this.invalid=X;this.weekData=null;this.c=aa;this.o=ia;this.isLuxonDateTime=
!0}static now(){return new W({})}static local(){const [a,t]=Fb(arguments),[X,aa,ia,ma,ta,wa,Ba]=t;return oc({year:X,month:aa,day:ia,hour:ma,minute:ta,second:wa,millisecond:Ba},a)}static utc(){const [a,t]=Fb(arguments),[X,aa,ia,ma,ta,wa,Ba]=t;a.zone=$a.utcInstance;return oc({year:X,month:aa,day:ia,hour:ma,minute:ta,second:wa,millisecond:Ba},a)}static fromJSDate(a,t={}){a="[object Date]"===Object.prototype.toString.call(a)?a.valueOf():NaN;if(Number.isNaN(a))return W.invalid("invalid input");const X=
k(t.zone,Wa.defaultZone);return X.isValid?new W({ts:a,zone:X,loc:Oa.fromObject(t)}):W.invalid(Cb(X))}static fromMillis(a,t={}){if(f(a))return-864E13>a||864E13<a?W.invalid("Timestamp out of range"):new W({ts:a,zone:k(t.zone,Wa.defaultZone),loc:Oa.fromObject(t)});throw new bb(`fromMillis requires a numerical input, but received a ${typeof a} with value ${a}`);}static fromSeconds(a,t={}){if(f(a))return new W({ts:1E3*a,zone:k(t.zone,Wa.defaultZone),loc:Oa.fromObject(t)});throw new bb("fromSeconds requires a numerical input");
}static fromObject(a,t={}){a=a||{};var X=k(t.zone,Wa.defaultZone);if(!X.isValid)return W.invalid(Cb(X));var aa=Wa.now();const ia=u(t.specificOffset)?X.offset(aa):t.specificOffset,ma=c(a,Nc);var ta=!u(ma.ordinal),wa=!u(ma.year),Ba=!u(ma.month)||!u(ma.day);wa=wa||Ba;var Ma=ma.weekYear||ma.weekNumber;t=Oa.fromObject(t);if((wa||ta)&&Ma)throw new Bb("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Ba&&ta)throw new Bb("Can't mix ordinal dates with month/day");Ba=Ma||ma.weekday&&
!wa;let Fa=lc(aa,ia);Ba?(aa=wc,Ma=hb,Fa=qb(Fa)):ta?(aa=V,Ma=vc,Fa=hc(Fa)):(aa=ra,Ma=Eb);let Ka=!1;for(var Ha of aa)u(ma[Ha])?ma[Ha]=Ka?Ma[Ha]:Fa[Ha]:Ka=!0;Ba?(Ha=O(ma.weekYear),aa=M(ma.weekNumber,1,E(ma.weekYear)),Ma=M(ma.weekday,1,7),Ha=Ha?aa?Ma?!1:qa("weekday",ma.weekday):qa("week",ma.week):qa("weekYear",ma.weekYear)):ta?(Ha=O(ma.year),aa=M(ma.ordinal,1,S(ma.year)?366:365),Ha=Ha?aa?!1:qa("ordinal",ma.ordinal):qa("year",ma.year)):Ha=jc(ma);if(Ha=Ha||Lc(ma))return W.invalid(Ha);ta=Ba?v(ma):ta?ic(ma):
ma;const [Ua,ib]=Ob(ta,ia,X);X=new W({ts:Ua,zone:X,o:ib,loc:t});return ma.weekday&&wa&&a.weekday!==X.weekday?W.invalid("mismatched weekday",`you can't specify both a weekday of ${ma.weekday} and a date of ${X.toISO()}`):X}static fromISO(a,t={}){const [X,aa]=ba(a,[je,sd],[ke,ne],[le,oe],[me,pe]);return rb(X,aa,t,"ISO 8601",a)}static fromRFC2822(a,t={}){const [X,aa]=ba(a.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[fe,da]);return rb(X,aa,t,"RFC 2822",a)}static fromHTTP(a,t={}){const [X,
aa]=ba(a,[ge,ja],[he,ja],[ie,ha]);return rb(X,aa,t,"HTTP",t)}static fromFormat(a,t,X={}){if(u(a)||u(t))throw new bb("fromFormat requires an input string and a format");const {locale:aa=null,numberingSystem:ia=null}=X,ma=Oa.fromOpts({locale:aa,numberingSystem:ia,defaultToEN:!0}),{result:ta,zone:wa,specificOffset:Ba,invalidReason:Ma}=Ja(ma,a,t),[Fa,Ka,Ha,Ua]=[ta,wa,Ba,Ma];return Ua?W.invalid(Ua):rb(Fa,Ka,X,`format ${t}`,a,Ha)}static fromString(a,t,X={}){return W.fromFormat(a,t,X)}static fromSQL(a,t=
{}){const [X,aa]=ba(a,[re,sd],[se,te]);return rb(X,aa,t,"SQL",a)}static invalid(a,t=null){if(!a)throw new bb("need to specify a reason the DateTime is invalid");a=a instanceof gb?a:new gb(a,t);if(Wa.throwOnInvalid)throw new Td(a);return new W({invalid:a})}static isDateTime(a){return a&&a.isLuxonDateTime||!1}static parseFormatForOpts(a,t={}){return(a=Qa(a,Oa.fromObject(t)))?a.map(X=>X?X.val:null).join(""):null}static expandFormat(a,t={}){return Ta(Za.parseFormat(a),Oa.fromObject(t)).map(X=>X.val).join("")}get(a){return this[a]}get isValid(){return null===
this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?
Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Nb(this).weekYear:NaN}get weekNumber(){return this.isValid?Nb(this).weekNumber:NaN}get weekday(){return this.isValid?Nb(this).weekday:
NaN}get ordinal(){return this.isValid?hc(this.c).ordinal:NaN}get monthShort(){return this.isValid?Jb.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Jb.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Jb.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Jb.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?
this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return S(this.year)}get daysInMonth(){return R(this.year,this.month)}get daysInYear(){return this.isValid?
S(this.year)?366:365:NaN}get weeksInWeekYear(){return this.isValid?E(this.weekYear):NaN}resolvedLocaleOptions(a={}){const {locale:t,numberingSystem:X,calendar:aa}=Za.create(this.loc.clone(a),a).resolvedOptions(this);return{locale:t,numberingSystem:X,outputCalendar:aa}}toUTC(a=0,t={}){return this.setZone($a.instance(a),t)}toLocal(){return this.setZone(Wa.defaultZone)}setZone(a,{keepLocalTime:t=!1,keepCalendarTime:X=!1}={}){a=k(a,Wa.defaultZone);if(a.equals(this.zone))return this;if(a.isValid){let aa=
this.ts;if(t||X)t=a.offset(this.ts),X=this.toObject(),[aa]=Ob(X,t,a);return Db(this,{ts:aa,zone:a})}return W.invalid(Cb(a))}reconfigure({locale:a,numberingSystem:t,outputCalendar:X}={}){a=this.loc.clone({locale:a,numberingSystem:t,outputCalendar:X});return Db(this,{loc:a})}setLocale(a){return this.reconfigure({locale:a})}set(a){if(!this.isValid)return this;a=c(a,Nc);var t=!u(a.weekYear)||!u(a.weekNumber)||!u(a.weekday);const X=!u(a.ordinal),aa=!u(a.year),ia=!u(a.month)||!u(a.day),ma=a.weekYear||a.weekNumber;
if((aa||ia||X)&&ma)throw new Bb("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(ia&&X)throw new Bb("Can't mix ordinal dates with month/day");t?t=v({...qb(this.c),...a}):u(a.ordinal)?(t={...this.toObject(),...a},u(a.day)&&(t.day=Math.min(R(t.year,t.month),t.day))):t=ic({...hc(this.c),...a});const [ta,wa]=Ob(t,this.o,this.zone);return Db(this,{ts:ta,o:wa})}plus(a){if(!this.isValid)return this;a=La.fromDurationLike(a);return Db(this,mc(this,a))}minus(a){if(!this.isValid)return this;
a=La.fromDurationLike(a).negate();return Db(this,mc(this,a))}startOf(a){if(!this.isValid)return this;const t={};a=La.normalizeUnit(a);switch(a){case "years":t.month=1;case "quarters":case "months":t.day=1;case "weeks":case "days":t.hour=0;case "hours":t.minute=0;case "minutes":t.second=0;case "seconds":t.millisecond=0}"weeks"===a&&(t.weekday=1);"quarters"===a&&(t.month=3*(Math.ceil(this.month/3)-1)+1);return this.set(t)}endOf(a){return this.isValid?this.plus({[a]:1}).startOf(a).minus(1):this}toFormat(a,
t={}){return this.isValid?Za.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,a):"Invalid DateTime"}toLocaleString(a=qc,t={}){return this.isValid?Za.create(this.loc.clone(t),a).formatDateTime(this):"Invalid DateTime"}toLocaleParts(a={}){return this.isValid?Za.create(this.loc.clone(a),a).formatDateTimeParts(this):[]}toISO({format:a="extended",suppressSeconds:t=!1,suppressMilliseconds:X=!1,includeOffset:aa=!0,extendedZone:ia=!1}={}){if(!this.isValid)return null;a="extended"===a;let ma=
nc(this,a);return ma=ma+"T"+Mc(this,a,t,X,aa,ia)}toISODate({format:a="extended"}={}){return this.isValid?nc(this,"extended"===a):null}toISOWeekDate(){return yb(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:a=!1,suppressSeconds:t=!1,includeOffset:X=!0,includePrefix:aa=!1,extendedZone:ia=!1,format:ma="extended"}={}){return this.isValid?(aa?"T":"")+Mc(this,"extended"===ma,t,a,X,ia):null}toRFC2822(){return yb(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return yb(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?
nc(this,!0):null}toSQLTime({includeOffset:a=!0,includeZone:t=!1,includeOffsetSpace:X=!0}={}){let aa="HH:mm:ss.SSS";if(t||a)X&&(aa+=" "),t?aa+="z":a&&(aa+="ZZ");return yb(this,aa,!0)}toSQL(a={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(a)}`:null}toString(){return this.isValid?this.toISO():"Invalid DateTime"}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1E3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/
1E3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(a={}){if(!this.isValid)return{};const t={...this.c};a.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale);return t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(a,t="milliseconds",X={}){if(!this.isValid||!a.isValid)return La.invalid("created by diffing an invalid DateTime");X={locale:this.locale,numberingSystem:this.numberingSystem,...X};
const aa=(Array.isArray(t)?t:[t]).map(La.normalizeUnit);t=a.valueOf()>this.valueOf();a=oa(t?this:a,t?a:this,aa,X);return t?a.negate():a}diffNow(a="milliseconds",t={}){return this.diff(W.now(),a,t)}until(a){return this.isValid?Sa.fromDateTimes(this,a):this}hasSame(a,t){if(!this.isValid)return!1;const X=a.valueOf();a=this.setZone(a.zone,{keepLocalTime:!0});return a.startOf(t)<=X&&X<=a.endOf(t)}equals(a){return this.isValid&&a.isValid&&this.valueOf()===a.valueOf()&&this.zone.equals(a.zone)&&this.loc.equals(a.loc)}toRelative(a=
{}){if(!this.isValid)return null;const t=a.base||W.fromObject({},{zone:this.zone}),X=a.padding?this<t?-a.padding:a.padding:0;let aa="years months days hours minutes seconds".split(" "),ia=a.unit;Array.isArray(a.unit)&&(aa=a.unit,ia=void 0);return pc(t,this.plus(X),{...a,numeric:"always",units:aa,unit:ia})}toRelativeCalendar(a={}){return this.isValid?pc(a.base||W.fromObject({},{zone:this.zone}),this,{...a,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...a){if(!a.every(W.isDateTime))throw new bb("min requires all arguments be DateTimes");
return C(a,t=>t.valueOf(),Math.min)}static max(...a){if(!a.every(W.isDateTime))throw new bb("max requires all arguments be DateTimes");return C(a,t=>t.valueOf(),Math.max)}static fromFormatExplain(a,t,X={}){const {locale:aa=null,numberingSystem:ia=null}=X;X=Oa.fromOpts({locale:aa,numberingSystem:ia,defaultToEN:!0});return Ja(X,a,t)}static fromStringExplain(a,t,X={}){return W.fromFormatExplain(a,t,X)}static get DATE_SHORT(){return qc}static get DATE_MED(){return Pc}static get DATE_MED_WITH_WEEKDAY(){return Wd}static get DATE_FULL(){return Qc}static get DATE_HUGE(){return Rc}static get TIME_SIMPLE(){return Sc}static get TIME_WITH_SECONDS(){return Tc}static get TIME_WITH_SHORT_OFFSET(){return Uc}static get TIME_WITH_LONG_OFFSET(){return Vc}static get TIME_24_SIMPLE(){return Wc}static get TIME_24_WITH_SECONDS(){return Xc}static get TIME_24_WITH_SHORT_OFFSET(){return Yc}static get TIME_24_WITH_LONG_OFFSET(){return Zc}static get DATETIME_SHORT(){return $c}static get DATETIME_SHORT_WITH_SECONDS(){return ad}static get DATETIME_MED(){return bd}static get DATETIME_MED_WITH_SECONDS(){return cd}static get DATETIME_MED_WITH_WEEKDAY(){return Xd}static get DATETIME_FULL(){return dd}static get DATETIME_FULL_WITH_SECONDS(){return ed}static get DATETIME_HUGE(){return fd}static get DATETIME_HUGE_WITH_SECONDS(){return gd}}
g.DateTime=W;g.Info=Jb;g.Interval=Sa})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E){function J(P){const {label:e}=P;return"items"in P?e:`${e}\u2013${P.layer.id}`}const A={filter:!0};O=function(P){function e(b,r){b=P.call(this,b,r)||this;b._iconIntersectionObserver=new IntersectionObserver((H,d)=>{H.forEach(function(){var p=u._asyncToGenerator(function*(z){if(z.isIntersecting){const B=z.target;if(B["data-has-icon"])d.unobserve(B);else{var {layer:m,template:k}=B["data-item"];B["data-has-icon"]=!0;z=yield I.fetchThumbnail(m,k).catch(()=>
{B["data-has-icon"]=!1;return null});l.isNone(z)||B.appendChild(z)}}});return function(z){return p.apply(this,arguments)}}())});b.enableListScroll=!0;b.filterText="";b.headingLevel=4;b.messages=null;b.viewModel=new Q;b.visibleElements={...A};b.renderItemIcon=b.renderItemIcon.bind(u._assertThisInitialized(b));b._afterItemCreateOrUpdate=b._afterItemCreateOrUpdate.bind(u._assertThisInitialized(b));b._afterItemRemoved=b._afterItemRemoved.bind(u._assertThisInitialized(b));return b}u._inheritsLoose(e,P);
var c=e.prototype;c.initialize=function(){const b=({label:r})=>!this.filterText||r.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(C.watch(()=>this.viewModel,(r,H)=>{r&&!r.filterFunction&&(this.filterFunction=b);H&&H!==r&&H.filterFunction===b&&(H.filterFunction=null)},C.initial))};c.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};c.loadDependencies=function(){return Promise.all([new Promise((b,
r)=>g(["../chunks/calcite-input"],b,r)),new Promise((b,r)=>g(["../chunks/calcite-list-item"],b,r))])};c.castVisibleElements=function(b){return{...A,...b}};c.select=function(b){return this.viewModel.select(b)};c.render=function(){const {enableListScroll:b,filterText:r,headingLevel:H,messages:d,viewModel:{items:p,numberOfFeatureTemplates:z,selectedItem:m,state:k}}=this,B=this.visibleElements.filter&&1<z;if(0<p.length&&"items"in p[0]){const q=p.find(T=>T.label===Q.nullGroupBy.label);q&&(q.label=d.other)}return E.tsx("div",
{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":d.widgetLabel},"loading"===k?this.renderLoader():"ready"===k?E.tsx(y.ItemList,{id:this.id,identify:J,filterText:r,items:p,headingLevel:H,messages:{filterPlaceholder:d.filterPlaceholder,noItems:d.noItems,noMatches:d.noMatches},filterEnabled:B,onItemSelect:q=>{this.viewModel.select(q)},onFilterChange:q=>{this.filterText=q;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:m,enableListScroll:b}):null)};c.renderItemIcon=
function({item:b}){return E.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":b,"data-has-icon":!1})};c.renderLoader=function(){return E.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};c._afterItemCreateOrUpdate=function(b){this._iconIntersectionObserver?.observe(b)};c._afterItemRemoved=function(b){this._iconIntersectionObserver?.unobserve(b)};u._createClass(e,[{key:"filterFunction",
get:function(){return this.viewModel.filterFunction},set:function(b){this.viewModel.filterFunction=b}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(b){this.viewModel.groupBy=b}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(b){this._overrideIfSome("label",b)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(b){this.viewModel.layers=b}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return e}(O.HandleOwnerMixin(L));
f.__decorate([F.property()],O.prototype,"enableListScroll",void 0);f.__decorate([F.property()],O.prototype,"filterFunction",null);f.__decorate([F.property()],O.prototype,"filterText",void 0);f.__decorate([F.property()],O.prototype,"groupBy",null);f.__decorate([F.property()],O.prototype,"headingLevel",void 0);f.__decorate([F.property()],O.prototype,"label",null);f.__decorate([F.property()],O.prototype,"layers",null);f.__decorate([F.property(),R.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],
O.prototype,"messages",void 0);f.__decorate([F.property({readOnly:!0})],O.prototype,"selectedItem",null);f.__decorate([F.property(),D.vmEvent("select")],O.prototype,"viewModel",void 0);f.__decorate([F.property()],O.prototype,"visibleElements",void 0);f.__decorate([M.cast("visibleElements")],O.prototype,"castVisibleElements",null);return O=f.__decorate([h.subclass("esri.widgets.FeatureTemplates")],O)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Evented ../../core/HandleOwner ../../core/maybe ../../core/ObjectPool ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./TemplateItem ./TemplateItemGroup".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){function S(J){return J.reduce((A,P)=>[...A,...P.templates],[])}var R;const D=({layer:J})=>({key:J,label:J.title}),E=({layer:J})=>({key:J.geometryType,label:J.geometryType});f=R=function(J){function A(e){e=J.call(this,e)||this;e._itemPool=new F(y);e._groupPool=new F(I);e.filterFunction=null;e.selectedItem=null;return e}g._inheritsLoose(A,J);var P=A.prototype;P.initialize=function(){this._get("groupBy")||(this.groupBy="layer")};P.destroy=function(){this._templateToLayer.clear()};
P.refresh=function(){this.notifyChange("items")};P.select=function(e){e=e?.clone()||null;this._set("selectedItem",e);this.emit("select",{item:e,template:e?.template||null})};P._createItem=function(e,c){const b=this._itemPool.acquire();b.set({template:e,layer:c});return b};P._createGroup=function(e,c){const b=this._groupPool.acquire();b.set("label",e);b.items=c;return b};P._releasePreviousItems=function(){this._destroyItems(this._get("items"))};P._destroyItems=function(e){e&&(e[0]instanceof y?e.forEach(c=>
this._destroyItem(c)):e.forEach(c=>this._destroyGroup(c)))};P._destroyGroup=function(e){e.items.forEach(c=>this._destroyItem(c));e.items.length=0;this._groupPool.release(e)};P._destroyItem=function(e){e.layer=null;e.template=null;this._itemPool.release(e)};P._ensureGroupByObject=function(e){return"string"===typeof e?{key:e,label:e}:e};g._createClass(A,[{key:"_templateToLayer",get:function(){const e=new Map;for(const [c,b]of this._featureTemplatesByLayer)for(const r of b)e.set(r,c);return e}},{key:"groupBy",
set:function(e){this._set("groupBy",e);if("function"===typeof e)this._groupByFunction=c=>this._ensureGroupByObject(e(c));else switch(e){case "none":this._groupByFunction=null;break;case "layer":this._groupByFunction=D;break;case "geometry":this._groupByFunction=E}}},{key:"layers",get:function(){return this._get("layers")},set:function(e){this.handles.remove("layers");if(e){const c=()=>this.notifyChange("state");this.handles.add(e.map(b=>w.when(()=>b.loadStatus,c)),"layers")}this._set("layers",e)}},
{key:"state",get:function(){const {layers:e}=this;return e&&0!==e.length?e.some(c=>"loading"===c.loadStatus||"not-loaded"===c.loadStatus)?"loading":"ready":"disabled"}},{key:"_featureTemplatesByLayer",get:function(){if(!this.layers)return new Map;const e=[];for(const c of this.layers){const b="templates"in c&&c.templates?c.templates:[],r="types"in c&&c.types?S(c.types):[];e.push([c,[...b,...r]])}return new Map(e)}},{key:"numberOfFeatureTemplates",get:function(){return Array.from(this._featureTemplatesByLayer.values()).reduce((e,
c)=>e+c.length,0)}},{key:"items",get:function(){if(0===this.numberOfFeatureTemplates)return this._releasePreviousItems(),[];var e=this._featureTemplatesByLayer,c=[],b=C.isSome(this.filterFunction)?this.filterFunction:R._nullFilterFunction;for(const [H,d]of e)if(H.loaded){const {capabilities:{operations:{supportsEditing:p,supportsAdd:z}}}=H;if(p&&z)for(const m of d)c.push({layer:H,template:m,matchesFilter:b({label:m.name})})}if(C.isNone(this._groupByFunction))return b=c.filter(({matchesFilter:H})=>
H).map(({template:H,layer:d})=>this._createItem(H,d)),this._releasePreviousItems(),b;e=new Map;for(var r of c){const {template:H,layer:d}=r;c=this._groupByFunction({template:H,layer:d});const {key:p,label:z}=C.isSome(c.key)?c:R.nullGroupBy;e.has(p)||e.set(p,{label:z,templateItemInfos:[]});e.get(p).templateItemInfos.push(r)}r=[];for(const H of e.values()){const {label:d,templateItemInfos:p}=H;c=p.filter(({matchesFilter:z})=>z);c=b({label:d})?p:0<p.length?c:[];0<c.length&&(c=c.map(({template:z,layer:m})=>
this._createItem(z,m)),r.push(this._createGroup(d,c)))}if(1===r.length&&r[0].label===R.nullGroupBy.label)return this._releasePreviousItems(),r[0].items;this._releasePreviousItems();return r}}]);return A}(l.HandleOwnerMixin(O.EventedAccessor));f.nullGroupBy={key:Symbol(),label:"Other\u200b"};f._nullFilterFunction=J=>!0;u.__decorate([M.property()],f.prototype,"_groupByFunction",void 0);u.__decorate([M.property({readOnly:!0})],f.prototype,"_templateToLayer",null);u.__decorate([M.property()],f.prototype,
"filterFunction",void 0);u.__decorate([M.property()],f.prototype,"groupBy",null);u.__decorate([M.property()],f.prototype,"layers",null);u.__decorate([M.property()],f.prototype,"state",null);u.__decorate([M.property({readOnly:!0})],f.prototype,"_featureTemplatesByLayer",null);u.__decorate([M.property({readOnly:!0})],f.prototype,"numberOfFeatureTemplates",null);u.__decorate([M.property({readOnly:!0})],f.prototype,"items",null);u.__decorate([M.property({readOnly:!0})],f.prototype,"selectedItem",void 0);
u.__decorate([M.property()],f.prototype,"select",null);return f=R=u.__decorate([Q.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],f)})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){function S(P,e){return R.apply(this,arguments)}function R(){R=u._asyncToGenerator(function*(P,e){var {renderer:c}=P;return c&&(e=new O({attributes:e.prototype.attributes}),c=yield c.getSymbolAsync(e))?c:D(P)});return R.apply(this,arguments)}function D(P){return E.apply(this,arguments)}function E(){E=u._asyncToGenerator(function*(P){({geometryType:P}=P);return(P="point"===P||"multipoint"===P?yield new Promise((e,c)=>g(["../../symbols/SimpleMarkerSymbol"],b=>e(J(b)),
c)):"polyline"===P?yield new Promise((e,c)=>g(["../../symbols/SimpleLineSymbol"],b=>e(J(b)),c)):"polygon"===P||"mesh"===P||"multipatch"===P?yield new Promise((e,c)=>g(["../../symbols/SimpleFillSymbol"],b=>e(J(b)),c)):null)?new P.default:null});return E.apply(this,arguments)}const J=P=>Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));var A;l=A=function(P){function e(b){b=P.call(this,b)||this;b._activeFetchInfo={id:null,request:null};b.layer=null;
b.template=null;b.thumbnail=null;return b}u._inheritsLoose(e,P);var c=e.prototype;c.initialize=function(){this.handles.add(M.watch(()=>{const {layer:b}=this;return[b&&"renderer"in b?b.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;this._set("thumbnail",null)},M.initial))};c.clone=function(){const b=w.isSome(this.thumbnail)?this.thumbnail.cloneNode(!0):null,r=new A({layer:this.layer,template:this.template});r._set("thumbnail",b);return r};e.fetchThumbnail=
function(){var b=u._asyncToGenerator(function*(r,H){if("subtype-group"===r.type)return F.getLogger("esri.widgets.FeatureTemplates.TemplateItem").warn("Thumbnails for sublayers of a SubtypeGroupLayer are not yet supported."),null;const d=yield S(r,H);if(w.isNone(d))return null;const p={maxSize:36};"dictionary"===r.renderer?.type&&(p.fieldMap=r.renderer.fieldMap,p.feature={attributes:H.prototype.attributes});return yield I.renderPreviewHTML(d,p)});return function(r,H){return b.apply(this,arguments)}}();
u._createClass(e,[{key:"description",get:function(){return this.template?.description},set:function(b){this.template&&(this.template.description=b)}},{key:"label",get:function(){return this.template?.name},set:function(b){this.template&&(this.template.name=b)}}]);return e}(C.HandleOwnerMixin(l));f.__decorate([h.property()],l.prototype,"description",null);f.__decorate([h.property()],l.prototype,"label",null);f.__decorate([h.property()],l.prototype,"layer",void 0);f.__decorate([h.property()],l.prototype,
"template",void 0);f.__decorate([h.property({readOnly:!0})],l.prototype,"thumbnail",void 0);return l=A=f.__decorate([y.subclass("esri.widgets.FeatureTemplates.TemplateItem")],l)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils".split(" "),function(g,u,f,O,l,C,F,w,M,h){function L(J,A){if(A&&(J.style.filter=h.getCSSFilterFromEffectList(A),
A=A.effects))for(const P of A)if("drop-shadow"===P?.type){0>P.offsetX?J.style.marginLeft=`${Math.abs(P.offsetX)}px`:J.style.marginRight=`${P.offsetX}px`;break}}function Q(J,A){return y.apply(this,arguments)}function y(){y=f._asyncToGenerator(function*(J,A){switch(J.type){case "web-style":var {previewWebStyleSymbol:P}=yield new Promise((e,c)=>g(["./previewWebStyleSymbol"],e,c));return P(J,Q,A);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:P}=
yield new Promise((e,c)=>g(["./previewSymbol3D"],e,c)),P(J,A);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:P}=yield new Promise((e,c)=>g(["./previewSymbol2D"],e,c)),P(J,A);case "cim":return{previewCIMSymbol:P}=yield new Promise((e,c)=>g(["./previewCIMSymbol"],e,c)),P(J,A)}});return y.apply(this,arguments)}function I(J){return J&&"opacity"in J?J.opacity*I(J.parent):1}function S(){S=f._asyncToGenerator(function*(J,
A){if(J){var P=J.sourceLayer,e=(l.isSome(A)&&(A.useSourceLayer??!1)?P:J.layer)??P;P=I(e);if(l.isSome(J.symbol)&&(!l.isSome(A)||!0!==A.ignoreGraphicSymbol))return J="web-style"===J.symbol.type?yield J.symbol.fetchSymbol({...A,cache:l.isSome(A)?A.webStyleCache:null}):J.symbol.clone(),h.applyColorToSymbol(J,null,P),J;var c=(l.isSome(A)?A.renderer:null)??(e&&"renderer"in e?e.renderer:null);if(e=c&&"getSymbolAsync"in c?yield c.getSymbolAsync(J,A):null){e="web-style"===e.type?yield e.fetchSymbol({...A,
cache:l.isSome(A)?A.webStyleCache:null}):e.clone();if(!(c&&"visualVariables"in c&&c.visualVariables&&c.visualVariables.length))return h.applyColorToSymbol(e,null,P),e;"arcadeRequiredForVisualVariables"in c&&c.arcadeRequiredForVisualVariables&&(l.isNone(A)||l.isNone(A.arcade))&&(A={...l.unwrap(A)},A.arcade=yield C.loadArcade());var b=yield new Promise((m,k)=>g(["../../renderers/visualVariables/support/visualVariableUtils"],m,k)),r=[],H=[],d=[],p=[];for(var z of c.visualVariables)switch(z.type){case "color":r.push(z);
break;case "opacity":H.push(z);break;case "rotation":p.push(z);break;case "size":z.target||d.push(z)}z=(z=!!r.length&&r[r.length-1])?b.getColor(z,J,A):null;H=(H=!!H.length&&H[H.length-1])?b.getOpacity(H,J,A):null;null!=P&&(H=null!=H?H*P:P);h.applyColorToSymbol(e,z,H);d.length&&(P=b.getAllSizes(d,J,A),yield h.applySizesToSymbol(e,P));for(const m of p)h.applyRotationToSymbol(e,b.getRotationAngle(m,J,A),m.axis);return e}}});return S.apply(this,arguments)}function R(){R=f._asyncToGenerator(function*(J,
A){if(J){var P=I(J.layer||J.sourceLayer);if(l.isSome(J.symbol)&&(!l.isSome(A)||!0!==A.ignoreGraphicSymbol))return J="web-style"===J.symbol.type?yield J.symbol.fetchSymbol(A):J.symbol.clone(),h.getColorFromSymbol(J,P);var e=l.isSome(A)&&A.renderer||J.get("layer.renderer")||J.get("sourceLayer.renderer"),c=yield e.getSymbolAsync(J,A);if(c){c="web-style"===c.type?yield c.fetchSymbol(A):c.clone();var b=h.getColorFromSymbol(c,P);if(!("visualVariables"in e)||"visualVariables"in e&&!e.visualVariables||"visualVariables"in
e&&!e.visualVariables?.length)return b;e.arcadeRequiredForVisualVariables&&(l.isNone(A)||l.isNone(A.arcade))&&(A={...l.unwrap(A)},A.arcade=yield C.loadArcade());c=yield new Promise((d,p)=>g(["../../renderers/visualVariables/support/visualVariableUtils"],d,p));var r=[],H=[];for(const d of e.visualVariables)switch(d.type){case "color":r.push(d);break;case "opacity":H.push(d)}e=(e=0<r.length?r[r.length-1]:null)?c.getColor(e,J,A):b;J=(b=0<H.length?H[H.length-1]:null)?c.getOpacity(b,J,A):null;null!=P&&
(J=null!=J?J*P:P);return e?h.applyOpacityToColor(e,J):null}}});return R.apply(this,arguments)}let D=null;const E=[255,255,255];u.getDisplayedColor=function(J,A){return R.apply(this,arguments)};u.getDisplayedSymbol=function(J,A){return S.apply(this,arguments)};u.renderColorRampPreviewHTML=function(J,A={}){var P="horizontal"===A.align;const {width:e=P?75:24,height:c=P?24:75,gradient:b=!0}=A;var r=window.devicePixelRatio,H=e*r,d=c*r;r=document.createElement("canvas");r.width=H;r.height=d;r.style.width=
`${e}px`;r.style.height=`${c}px`;const p=r.getContext("2d");var z=P?H:0,m=P?0:d;if(b){const k=p.createLinearGradient(0,0,z,m);P=J.length;const B=1===P?0:1/(P-1);J.forEach((q,T)=>k.addColorStop(T*B,q.toString()));p.fillStyle=k;p.fillRect(0,0,H,d)}else{H=P?H/J.length:H;d=P?d:d/J.length;m=z=0;for(const k of J)p.fillStyle=k.toString(),p.fillRect(z,m,H,d),z=P?z+H:0,m=P?0:m+d}J=document.createElement("div");J.style.width=`${e}px`;J.style.height=`${c}px`;L(J,A?.effectList);J.appendChild(r);return J};u.renderDotDensityPreviewHTML=
function(J,A,P){const {backgroundColor:e,outline:c,dotSize:b}=J;P=P&&P.swatchSize||w.SymbolSizeDefaults.size;const r=Math.round(P*P/b**2*.8),H=window.devicePixelRatio;J=document.createElement("canvas");const d=P*H;J.width=d;J.height=d;J.style.width=`${J.width/H}px`;J.style.height=`${J.height/H}px`;const p=J.getContext("2d");e&&(p.fillStyle=e.toCss(!0),p.fillRect(0,0,d,d),p.fill());p.fillStyle=A.toCss(!0);if(D&&D.length/2===r)for(A=0;A<2*r;A+=2)p.fillRect(D[A],D[A+1],b*H,b*H),p.fill();else for(D=[],
A=0;A<2*r;A+=2){const z=Math.floor(Math.random()*(d-0+1)),m=Math.floor(Math.random()*(d-0+1));D.push(z,m);p.fillRect(z,m,b*H,b*H);p.fill()}c&&(c.color&&(p.strokeStyle=c.color.toCss(!0)),p.lineWidth=c.width,p.strokeRect(0,0,d,d));P=new Image(P,P);P.src=J.toDataURL();return P};u.renderPieChartPreviewHTML=function(J,A={}){const P=A.radius||40;var e=2*Math.PI*P,c=J.length;const b=e/c,r=[],H=F.getStroke(A.outline);null!=H?.width&&(H.width*=2);(H||A.backgroundColor)&&r.push({shape:{type:"circle",cx:P,cy:P,
r:P},fill:A.backgroundColor,stroke:H,offset:[0,0]});const d=A.values,p=d&&d.length===c&&100===d.reduce((m,k)=>m+k,0),z=[0];for(let m=0;m<c;m++){let k=null;p&&(k=d[m]*e/100,z.push(k+z[m]));r.push({shape:{type:"circle",cx:P,cy:P,r:P/2},fill:[0,0,0,0],stroke:{width:P,dashArray:`${(k??b)/2} ${e}`,dashoffset:`-${p?z[m]/2:b/2*m}`,color:J[m]},offset:[0,0]})}c=null;J=2*P+(H?.width||0);if(e=A.holePercentage)H&&r.push({shape:{type:"circle",cx:P,cy:P,r:P*e},fill:null,stroke:H,offset:[0,0]}),c=J/2,c=[[{shape:{type:"circle",
cx:c,cy:c,r:c},fill:E,stroke:H?{...H,color:E}:null,offset:[0,0]},{shape:{type:"circle",cx:c,cy:c,r:P*e},fill:[0,0,0],stroke:null,offset:[0,0]}]];return M.renderSymbol([r],[J,J],{effectView:A.effectList,ignoreStrokeWidth:!0,masking:c,rotation:-90})};u.renderPreviewHTML=Q;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(g,u,f,O,l,C,F){function w(L){if(!L)return null;let Q=null;switch(L.type){case "simple-fill":case "picture-fill":case "simple-marker":Q=w(L.outline);break;case "simple-line":const y=C.pt2px(L.width);null!=L.style&&"none"!==L.style&&0!==y&&(Q={color:L.color,style:h(L.style),width:y,cap:L.cap,join:"miter"===L.join?C.pt2px(L.miterLimit):L.join});break;default:Q=null}return Q}const M=new l(1E3),h=(()=>{const L={};return Q=>{if(L[Q])return L[Q];const y=Q.replace(/-/g,"");return L[Q]=y}})();f=new f([128,
128,128]);g.defaultThematicColor=f;g.dekebabifyLineStyle=h;g.getFill=function(L){const Q=L.style;let y=null;if(L)switch(L.type){case "simple-marker":"cross"!==Q&&"x"!==Q&&(y=L.color);break;case "simple-fill":"solid"===Q?y=L.color:"none"!==Q&&(y={type:"pattern",x:0,y:0,src:u.getAssetUrl(`esri/symbols/patterns/${Q}.png`),width:5,height:5});break;case "picture-fill":y={type:"pattern",src:L.url,width:C.pt2px(L.width)*L.xscale,height:C.pt2px(L.height)*L.yscale,x:C.pt2px(L.xoffset),y:C.pt2px(L.yoffset)};
break;case "text":y=L.color;break;case "cim":y=F.getCIMSymbolColor(L)}return y};g.getPatternUrlWithColor=function(L,Q){const y=L+"-"+Q;return void 0!==M.get(y)?Promise.resolve(M.get(y)):O(L,{responseType:"image"}).then(I=>{I=I.data;const S=I.naturalWidth,R=I.naturalHeight,D=document.createElement("canvas");D.width=S;D.height=R;const E=D.getContext("2d");E.fillStyle=Q;E.fillRect(0,0,S,R);E.globalCompositeOperation="destination-in";E.drawImage(I,0,0);I=D.toDataURL();M.put(y,I);return I})};g.getStroke=
w;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(g){return function(){function u(O,l){this._storage=new g.MemCacheStorage;this._storage.maxSize=O;l&&this._storage.registerRemoveFunc("",l)}var f=u.prototype;f.put=function(O,l){this._storage.put(O,l,1,1)};f.pop=function(O){return this._storage.pop(O)};f.get=function(O){return this._storage.get(O)};f.clear=function(){this._storage.clearAll()};
f.destroy=function(){this._storage.destroy()};return u}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(g,u,f){function O(Q){Q=f.toCIMSymbolJSON(Q);if("CIMTextSymbol"===Q?.type)return Q.height??0;let y=0;if(Q?.symbolLayers)for(const I of Q.symbolLayers)f.isCIMMarker(I)&&null!=I.size&&I.size>y?y=I.size:f.isCIMStroke(I)&&null!=I.width&&I.width>y?y=I.width:f.isCIMFill(I);return y}function l(Q,y,I,S){if(Q)if("CIMTextSymbol"===Q.type)null!=
Q.height&&(Q.height*=y);else{if(I&&Q.effects)for(const R of Q.effects)w(R,y);if(Q.symbolLayers)for(const R of Q.symbolLayers)switch(R.type){case "CIMPictureMarker":case "CIMVectorMarker":C(R,y,S);break;case "CIMPictureStroke":case "CIMSolidStroke":!S?.preserveOutlineWidth&&R.width&&(R.width*=y);break;case "CIMPictureFill":R.height&&(R.height*=y);R.offsetX&&(R.offsetX*=y);R.offsetY&&(R.offsetY*=y);break;case "CIMHatchFill":l(R.lineSymbol,y,!0,{...S,preserveOutlineWidth:!1}),R.offsetX&&(R.offsetX*=
y),R.offsetY&&(R.offsetY*=y),R.separation&&(R.separation*=y)}}}function C(Q,y,I){if(Q&&(Q.markerPlacement&&F(Q.markerPlacement,y),Q.offsetX&&(Q.offsetX*=y),Q.offsetY&&(Q.offsetY*=y),Q.anchorPoint&&"Absolute"===Q.anchorPointUnits&&(Q.anchorPoint={x:Q.anchorPoint.x*y,y:Q.anchorPoint.y*y}),Q.size=null!=Q.size?Q.size*y:0,"CIMVectorMarker"===Q.type&&Q.markerGraphics))for(const S of Q.markerGraphics)Q.scaleSymbolsProportionally||l(S.symbol,y,!0,I)}function F(Q,y){f.isCIMMarkerStrokePlacement(Q)&&Q.offset&&
(Q.offset*=y);switch(Q.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":Q.customEndingOffset&&(Q.customEndingOffset*=y);Q.offsetAlongLine&&(Q.offsetAlongLine*=y);if(Q.placementTemplate&&Q.placementTemplate.length){var I=Q.placementTemplate.map(S=>S*y);Q.placementTemplate=I}break;case "CIMMarkerPlacementAlongLineVariableSize":Q.maxRandomOffset&&(Q.maxRandomOffset*=y);Q.placementTemplate&&Q.placementTemplate.length&&(I=Q.placementTemplate.map(S=>S*y),Q.placementTemplate=
I);break;case "CIMMarkerPlacementOnLine":Q.startPointOffset&&(Q.startPointOffset*=y);break;case "CIMMarkerPlacementAtExtremities":Q.offsetAlongLine&&(Q.offsetAlongLine*=y);break;case "CIMMarkerPlacementAtRatioPositions":Q.beginPosition&&(Q.beginPosition*=y);Q.endPosition&&(Q.endPosition*=y);break;case "CIMMarkerPlacementPolygonCenter":Q.offsetX&&(Q.offsetX*=y);Q.offsetY&&(Q.offsetY*=y);break;case "CIMMarkerPlacementInsidePolygon":Q.offsetX&&(Q.offsetX*=y),Q.offsetY&&(Q.offsetY*=y),Q.stepX&&(Q.stepX*=
y),Q.stepY&&(Q.stepY*=y)}}function w(Q,y){switch(Q.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":Q.width&&(Q.width*=y);break;case "CIMGeometricEffectBuffer":Q.size&&(Q.size*=y);break;case "CIMGeometricEffectCut":Q.beginCut&&(Q.beginCut*=y);Q.endCut&&(Q.endCut*=y);Q.middleCut&&(Q.middleCut*=y);break;case "CIMGeometricEffectDashes":Q.customEndingOffset&&(Q.customEndingOffset*=y);Q.offsetAlongLine&&(Q.offsetAlongLine*=y);if(Q.dashTemplate&&Q.dashTemplate.length){const I=Q.dashTemplate.map(S=>
S*y);Q.dashTemplate=I}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":Q.length&&(Q.length*=y);break;case "CIMGeometricEffectMove":Q.offsetX&&(Q.offsetX*=y);Q.offsetY&&(Q.offsetY*=y);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":Q.offset&&(Q.offset*=y);break;case "CIMGeometricEffectRegularPolygon":Q.radius&&(Q.radius*=y);break;case "CIMGeometricEffectTaperedPolygon":Q.fromWidth&&(Q.fromWidth*=y);Q.length&&(Q.length*=
y);Q.toWidth&&(Q.toWidth*=y);break;case "CIMGeometricEffectWave":Q.amplitude&&(Q.amplitude*=y),Q.period&&(Q.period*=y)}}function M(Q,y){if(Q){var I="CIMTextSymbol"===Q.type?Q.symbol:Q;Q="CIMPolygonSymbol"===Q.type;if(I?.symbolLayers)for(const S of I.symbolLayers)if(!(S.colorLocked||Q&&(f.isCIMStroke(S)||f.isCIMMarker(S)&&S.markerPlacement&&f.isCIMMarkerStrokePlacement(S.markerPlacement))))switch(S.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":S.tintColor&&h(y,S.tintColor);
break;case "CIMVectorMarker":S.markerGraphics?.forEach(R=>{M(R.symbol,y)});break;case "CIMSolidStroke":case "CIMSolidFill":h(y,S.color);break;case "CIMHatchFill":M(S.lineSymbol,y)}}}function h(Q,y){for(const I of Q)if(I.join(".")===y.join("."))return;Q.push(y)}function L(Q,y,I){if(Q){var S="CIMTextSymbol"===Q.type?Q.symbol:Q;Q="CIMPolygonSymbol"===S?.type;if(S?.symbolLayers)for(const R of S.symbolLayers)if(!R.colorLocked){if(Q)if(I){if({layersToColor:S}=I,(f.isCIMStroke(R)||f.isCIMMarker(R)&&R.markerPlacement&&
f.isCIMMarkerStrokePlacement(R.markerPlacement))&&"fill"===S||f.isCIMFill(R)&&"outline"===S)continue}else if(f.isCIMStroke(R)||f.isCIMMarker(R)&&R.markerPlacement&&f.isCIMMarkerStrokePlacement(R.markerPlacement))continue;S=y.toArray();switch(R.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":R.tintColor=S;break;case "CIMVectorMarker":R.markerGraphics?.forEach(D=>{L(D.symbol,y,I)});break;case "CIMSolidStroke":case "CIMSolidFill":R.color=S;break;case "CIMHatchFill":L(R.lineSymbol,
y,I)}}}}g.applyCIMSymbolColor=function(Q,y,I){y instanceof u||(y=new u(y));(Q=f.toCIMSymbolJSON(Q))&&L(Q,y,I)};g.applyCIMSymbolRotation=function(Q,y,I=!1){Q=f.toCIMSymbolJSON(Q);I&&0!==y&&(y=360-y);if("CIMTextSymbol"===Q?.type)Q.angle=y;else if("CIMPointSymbol"===Q?.type&&Q.symbolLayers){I=y-(Q.angle||0);for(const S of Q.symbolLayers)if(f.isCIMMarker(S)){let R=S.rotation||0;R=S.rotateClockwise?R-I:R+I;S.rotation=R}Q.angle=y}};g.getCIMSymbolColor=function(Q){Q=f.toCIMSymbolJSON(Q);const y=[];M(Q,y);
return y.length?new u(f.fromCIMColor(y[0])):null};g.getCIMSymbolRotation=function(Q,y=!1){Q=f.toCIMSymbolJSON(Q);return"CIMTextSymbol"===Q?.type||"CIMPointSymbol"===Q?.type?(Q=Q.angle,null!=Q&&0!==Q&&y?360-Q:Q??0):0};g.getCIMSymbolSize=O;g.getCIMSymbolType=function(Q){Q=f.toCIMSymbolJSON(Q);if(!Q)return null;switch(Q.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};g.scaleCIMMarker=C;g.scaleCIMSymbol=l;g.scaleCIMSymbolTo=function(Q,y,I){if(Q){var S=f.toCIMSymbolJSON(Q);Q=O(Q);if(0===Q){if(S)if("CIMTextSymbol"===S.type)S.height=y;else if(S.symbolLayers)for(const R of S.symbolLayers)switch(R.type){case "CIMPictureMarker":case "CIMVectorMarker":R.size=y;break;case "CIMPictureStroke":case "CIMSolidStroke":R.width=y}}else l(S,y/Q,!1,I)}};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(g,u){function f(h){let L=h.length;for(;L--;)if(!" /-,\n".includes(h.charAt(L)))return!1;return!0}function O(h,L){const Q=[];var y=0;let I=-1;do I=h.indexOf("[",y),I>=y&&(I>y&&(y=h.substr(y,I-y),Q.push([y,null,f(y)])),y=I+1,I=h.indexOf("]",y),I>=y&&(I>y&&(y=h.substr(y,I-y),(y=L[y])&&Q.push([null,y,!1])),y=I+1));while(-1!==I);y<h.length-1&&(h=h.substr(y),Q.push([h,null,f(h)]));return Q}function l(h,L,Q){let y="",I=null;for(const S of L){const [R,
D,E]=S;if(R)E?I=R:(I&&(y+=I,I=null),y+=R);else if(L=h.attributes[D])I&&(y+=I,I=null),y+=L}return C(y,Q)}function C(h,L){"string"!==typeof h&&(h=String(h));switch(L){case "LowerCase":return h.toLowerCase();case "Allcaps":return h.toUpperCase();default:return h}}function F(h){if(!h)return null;switch(h.type){case "CIMPolygonSymbol":if(h.symbolLayers)for(const L of h.symbolLayers)if(h=F(L),null!=h)return h;break;case "CIMTextSymbol":return F(h.symbol);case "CIMSolidFill":return h.color}}function w(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const L of h.symbolLayers)if(h=
w(L),void 0!==h)return h;break;case "CIMTextSymbol":return w(h.symbol);case "CIMSolidStroke":case "CIMSolidFill":return h.color}}function M(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const L of h.symbolLayers)if(h=M(L),void 0!==h)return h;break;case "CIMTextSymbol":return M(h.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return h.width}}u.adjustTextCase=C;u.analyzeTextParts=O;u.assignTextValuesFromFeature=l;u.attributesToFields=
function(h){return(h?Object.keys(h):[]).map(L=>({name:L,alias:L,type:"string"===typeof h[L]?"esriFieldTypeString":"esriFieldTypeDouble"}))};u.colorToArray=function(h){return[h.r,h.g,h.b,h.a]};u.createLabelOverrideFunction=function(h,L,Q){const y=O(L,h);return I=>l(I,y,Q)};u.evaluateValueOrFunction=function(h,L,Q,y){return"function"===typeof h?h(L,Q,y):h};u.fromCIMColor=function(h){return h?{r:h[0],g:h[1],b:h[2],a:h[3]/255}:{r:0,g:0,b:0,a:0}};u.fromCIMFontDecoration=function(h){return h.underline?
"underline":h.strikethrough?"line-through":"none"};u.fromCIMFontStyle=function(h){let L="",Q="";h&&(h=h.toLowerCase(),h.includes("italic")?L="italic":h.includes("oblique")&&(L="oblique"),h.includes("bold")?Q="bold":h.includes("light")&&(Q="lighter"));return{style:L,weight:Q}};u.fromCIMHorizontalAlignment=function(h){switch(h){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};u.fromCIMVerticalAlignment=function(h){switch(h){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};u.getFillColor=F;u.getFontStyle=function(h){if(!h)return"normal";switch(h.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};u.getFontWeight=function(h){if(!h)return"normal";switch(h.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};u.getStrokeColor=w;u.getStrokeWidth=M;u.getValue=(h,
L=0)=>isNaN(h)||null==h?L:h;u.importGeometryEngine=function(){return new Promise((h,L)=>g(["../../geometry/geometryEngineJSON"],h,L))};u.isCIMFill=function(h){return"CIMGradientFill"===h.type||"CIMHatchFill"===h.type||"CIMPictureFill"===h.type||"CIMSolidFill"===h.type||"CIMWaterFill"===h.type};u.isCIMMarker=function(h){return"CIMVectorMarker"===h.type||"CIMPictureMarker"===h.type||"CIMBarChartMarker"===h.type||"CIMCharacterMarker"===h.type||"CIMPieChartMarker"===h.type||"CIMStackedBarChartMarker"===
h.type};u.isCIMMarkerStrokePlacement=function(h){return"CIMMarkerPlacementAlongLineRandomSize"===h.type||"CIMMarkerPlacementAlongLineSameSize"===h.type||"CIMMarkerPlacementAlongLineVariableSize"===h.type||"CIMMarkerPlacementAtExtremities"===h.type||"CIMMarkerPlacementAtMeasuredUnits"===h.type||"CIMMarkerPlacementAtRatioPositions"===h.type||"CIMMarkerPlacementOnLine"===h.type||"CIMMarkerPlacementOnVertices"===h.type};u.isCIMStroke=function(h){return"CIMGradientStroke"===h.type||"CIMPictureStroke"===
h.type||"CIMSolidStroke"===h.type};u.isGeometryEngineRequired=h=>{if(!h)return!1;for(const L of h)switch(L.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};u.isSVGImage=h=>h.includes("data:image/svg+xml");u.mapCIMSymbolToGeometryType=function(h){if(!h)return null;switch(h.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};
u.resampleHermite=function(h,L,Q,y,I,S,R=!0){const D=L/I;Q/=S;const E=Math.ceil(D/2),J=Math.ceil(Q/2);for(let e=0;e<S;e++)for(let c=0;c<I;c++){const b=4*(c+(R?S-e-1:e)*I);var A=0;let r=0,H=0,d=0,p=0,z=0,m=0;const k=(e+.5)*Q;for(let B=Math.floor(e*Q);B<(e+1)*Q;B++){var P=Math.abs(k-(B+.5))/J;const q=(c+.5)*D;P*=P;for(let T=Math.floor(c*D);T<(c+1)*D;T++){let n=Math.abs(q-(T+.5))/E;A=Math.sqrt(P+n*n);-1<=A&&1>=A&&(A=2*A*A*A-3*A*A+1,0<A&&(n=4*(T+B*L),m+=A*h[n+3],H+=A,255>h[n+3]&&(A=A*h[n+3]/250),d+=A*
h[n],p+=A*h[n+1],z+=A*h[n+2],r+=A))}}y[b]=d/r;y[b+1]=p/r;y[b+2]=z/r;y[b+3]=m/H}};u.toCIMSymbolJSON=function(h){return h.data?.symbol??null};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(g,u){function f(O,l){return Math.round(Math.min(Math.max(O+191.25*l,0),255))}g.SymbolSizeDefaults=void 0;(function(O){O[O.size=22]="size";O[O.lineWidth=50]="lineWidth";O[O.maxSize=
120]="maxSize";O[O.maxOutlineSize=80]="maxOutlineSize";O[O.tallSymbolWidth=20]="tallSymbolWidth"})(g.SymbolSizeDefaults||(g.SymbolSizeDefaults={}));g.adjustColorBrightness=function(O,l){if(null==O)return new u;if("type"in O&&("linear"===O.type||"pattern"===O.type))return O;O=new u(O);return new u([f(O.r,l),f(O.g,l),f(O.b,l),O.a])};g.adjustColorComponentBrightness=f;g.getConeShapes=function(O,l){let C=l?g.SymbolSizeDefaults.tallSymbolWidth:O;l=l?4:6;C=C<=g.SymbolSizeDefaults.size?C-.5*l:C-l;l=.15*
C;const F=C;O-=l;return[{type:"ellipse",cx:.5*C,cy:O,rx:.5*C,ry:l},{type:"path",path:[{command:"M",values:[.5*F,0]},{command:"L",values:[F,O]},{command:"L",values:[0,O]},{command:"Z",values:[]}]}]};g.getCubeShapes=function(O,l){let C=l?g.SymbolSizeDefaults.tallSymbolWidth:O;var F=l?4:6;F=C=C<=g.SymbolSizeDefaults.size?C-.5*F:C-F;l=l?.35*C:.5*C;return[{type:"path",path:[{command:"M",values:[.5*F,0]},{command:"L",values:[F,.5*l]},{command:"L",values:[.5*F,l]},{command:"L",values:[0,.5*l]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*F,l]},{command:"L",values:[.5*F,O]},{command:"L",values:[0,O-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*F,l]},{command:"L",values:[.5*F,O]},{command:"L",values:[F,O-.5*l]},{command:"L",values:[F,.5*l]},{command:"Z",values:[]}]}]};g.getCylinderShapes=function(O,l){var C=l?g.SymbolSizeDefaults.tallSymbolWidth:O;l=l?4:6;C=C<=g.SymbolSizeDefaults.size?C-.5*l:C-l;l=.5*C;const F=.15*C;
O-=F;return[{type:"ellipse",cx:.5*C,cy:O,rx:l,ry:F},{type:"path",path:[{command:"M",values:[0,F]},{command:"L",values:[0,O]},{command:"L",values:[C,O]},{command:"L",values:[C,F]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*C,cy:F,rx:l,ry:F}]};g.getDiamondShapes=function(O){var l=O;l=l<g.SymbolSizeDefaults.size?l-2:l-4;const C=Math.floor(O/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[l,.5*O-C]},{command:"L",values:[.45*l-C,.5*O+C]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[.45*l-C,.5*O+C]},{command:"L",values:[0,.5*O-C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*O-C]},{command:"L",values:[.45*l-C,.5*O+C]},{command:"L",values:[.45*l,O]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,O]},{command:"L",values:[l,.5*O-C]},{command:"L",values:[.45*l-C,.5*O+C]},{command:"Z",values:[]}]}]};g.getExtrudeSymbolShapes=function(O){const l=g.SymbolSizeDefaults.size;
O*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*l]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[.3*l,.7*l+O]},{command:"L",values:[0,.7*l+O-.35*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,.7*l]},{command:"L",values:[.3*l,.7*l+O]},{command:"L",values:[l,O]},{command:"L",values:[l,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,0]},{command:"L",values:[l,0]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[0,.35*l]},
{command:"Z",values:[]}]}]};g.getInvertedConeShapes=function(O){let l=O;l=l<g.SymbolSizeDefaults.size?l-3:l-6;const C=.15*l,F=l;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[F,0]},{command:"L",values:[.5*F,O-C]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*l,cy:0,rx:.5*l,ry:C}]};g.getPathSymbolShapes=function(O,l,C){var F=g.SymbolSizeDefaults.size;let w=F,M=F;1>O?w*=.75:1<O&&(M*=1.25);O=F;l&&C&&(w=M=O=F=0);return[{type:"path",path:[{command:"M",values:[O,0]},{command:"L",
values:[C?O:.875*O,0]},{command:"L",values:[C?w-.5*O:0,M-.5*F]},{command:"L",values:[w-.5*O,M-.5*F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[O,0]},{command:"L",values:[O,l?0:.125*F]},{command:"L",values:[w-.5*O,l?M-.5*F:F]},{command:"L",values:[w-.5*O,M-.5*F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w-.5*O,M-.5*F]},{command:"L",values:[C?w-.5*O:0,M-.5*F]},{command:"L",values:[C?w-.5*O:0,l?M-.5*F:F]},{command:"L",values:[w-.5*O,l?M-.5*F:F]},{command:"Z",
values:[]}]}]};g.getTetrahedronShapes=function(O){var l=O;l=l<g.SymbolSizeDefaults.size?l-1:l-2;return[{type:"path",path:[{command:"M",values:[.45*O,0]},{command:"L",values:[O,l]},{command:"L",values:[.45*O,.6*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*O,0]},{command:"L",values:[.45*O,.6*l]},{command:"L",values:[0,l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.45*O,.6*l]},{command:"L",values:[O,l]},{command:"Z",values:[]}]}]};
g.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
g.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(g,u,f,O,l,C,F,w,M,h){function L(y,I,S){return y?f(y,{responseType:"image"}).then(R=>{R=R.data;const D=R.width,E=R.height,J=D/E;let A=I;S&&(A=Math.min(A,Math.max(D,E)));return{image:R,width:1>=J?Math.ceil(A*J):A,height:1>=J?A:Math.ceil(A/J)}}):Promise.reject(new l("renderUtils: imageDataSize","href not provided."))}const Q=w.createProjector();g.renderSymbol=function(y,I,S){const R=Math.ceil(I[0]);I=Math.ceil(I[1]);if(!y.some(E=>!!E.length))return null;const D=S&&S.node||document.createElement("div");
null!=S.opacity&&(D.style.opacity=S.opacity.toString());null!=S.effectView&&(D.style.filter=h.getCSSFilterFromEffectList(S.effectView));Q.append(D,M.renderSVG.bind(null,y,R,I,S));return D};g.tintImageWithColor=function(y,I,S,R,D){return L(y,I,D).then(E=>{const J=E.width?E.width:I,A=E.height?E.height:I;var P;if(P=E.image)P=S&&"ignore"!==R?"multiply"===R&&255===S.r&&255===S.g&&255===S.b&&1===S.a?!1:!0:!1;if(P){var e=E.image.width,c=E.image.height;C("edge")&&/\.svg$/i.test(y)&&(--e,--c);P=Math.ceil(J);
var b=Math.ceil(A);var r=document.createElement("canvas");r.width=P;r.height=b;r.style.width=P+"px";r.style.height=b+"px";r=r.getContext("2d");r.clearRect(0,0,P,b);P=r;P.drawImage(E.image,0,0,e,c,0,0,J,A);b=P.getImageData(0,0,J,A);r=[S.r/255,S.g/255,S.b/255,S.a];const d=O.toHSV(S);for(let p=0;p<b.data.length;p+=4){E=b.data;e=p;c=r;var H=d;switch(R){case "multiply":E[e+0]*=c[0];E[e+1]*=c[1];E[e+2]*=c[2];E[e+3]*=c[3];break;default:const z=O.toHSV({r:E[e+0],g:E[e+1],b:E[e+2]});z.h=H.h;z.s=H.s;z.v=z.v/
100*H.v;H=O.toRGB(z);E[e+0]=H.r;E[e+1]=H.g;E[e+2]=H.b;E[e+3]*=c[3]}}P.putImageData(b,0,0);y=P.canvas.toDataURL("image/png")}else(P=u.id&&u.id.findCredential(y))&&P.token&&(E=y.includes("?")?"\x26":"?",y=`${y}${E}token=${P.token}`);return{url:y,width:J,height:A}}).catch(()=>({url:y,width:I,height:I}))};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/colorUtils":function(){define(["exports"],function(g){function u(h,L){const Q=[];let y,I;if(h[0].length!==
L.length)throw"dimensions do not match";const S=h.length,R=h[0].length;let D=0;for(y=0;y<S;y++){for(I=D=0;I<R;I++)D+=h[y][I]*L[I];Q.push(D)}return Q}function f(h){h=[h.r/255,h.g/255,h.b/255].map(L=>.04045>=L?L/12.92:((L+.055)/1.055)**2.4);h=u(w,h);return{x:100*h[0],y:100*h[1],z:100*h[2]}}function O(h){h=u(M,[h.x/100,h.y/100,h.z/100]).map(L=>Math.min(1,Math.max(.0031308>=L?12.92*L:1.055*L**(1/2.4)-.055,0)));return{r:Math.round(255*h[0]),g:Math.round(255*h[1]),b:Math.round(255*h[2])}}function l(h){h=
[h.x/95.047,h.y/100,h.z/108.883].map(L=>L>(6/29)**3?L**(1/3):1/3*(29/6)**2*L+4/29);return{l:116*h[1]-16,a:500*(h[0]-h[1]),b:200*(h[1]-h[2])}}function C(h){const L=h.l;h=[(L+16)/116+h.a/500,(L+16)/116,(L+16)/116-h.b/200].map(Q=>Q>6/29?Q**3:3*(6/29)**2*(Q-4/29));return{x:95.047*h[0],y:100*h[1],z:108.883*h[2]}}function F(h){if("r"in h&&"g"in h&&"b"in h)return h;if("l"in h&&"c"in h&&"h"in h){var L=h.c,Q=h.h;return O(C({l:h.l,a:L*Math.cos(Q),b:L*Math.sin(Q)}))}if("l"in h&&"a"in h&&"b"in h)return O(C(h));
if("x"in h&&"y"in h&&"z"in h)return O(h);if("h"in h&&"s"in h&&"v"in h){Q=(h.h+360)%360/60;L=h.v/100*255;h=h.s/100*L;const y=h*(1-Math.abs(Q%2-1));switch(Math.floor(Q)){case 0:Q={r:h,g:y,b:0};break;case 1:Q={r:y,g:h,b:0};break;case 2:Q={r:0,g:h,b:y};break;case 3:Q={r:0,g:y,b:h};break;case 4:Q={r:y,g:0,b:h};break;case 5:case 6:Q={r:h,g:0,b:y};break;default:Q={r:0,g:0,b:0}}Q.r=Math.round(Q.r+L-h);Q.g=Math.round(Q.g+L-h);Q.b=Math.round(Q.b+L-h);return Q}return h}const w=[[.4124,.3576,.1805],[.2126,.7152,
.0722],[.0193,.1192,.9505]],M=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];g.darken=function(h,L){h=l(f(h));h.l*=1-L;return O(C(h))};g.toHSV=function(h){if("h"in h&&"s"in h&&"v"in h)return h;var L=F(h);h=L.r;const Q=L.g,y=L.b;L=Math.max(h,Q,y);const I=L-Math.min(h,Q,y);h=0===I?0:L===h?(Q-y)/I%6:L===Q?(y-h)/I+2:(h-Q)/I+4;0>h&&(h+=6);return{h:60*h,s:100*(0===I?0:I/L),v:100/255*L}};g.toLAB=function(h){return"l"in h&&"a"in h&&"b"in h?h:l(f(F(h)))};g.toLCH=function(h){if(!("l"in
h&&"c"in h&&"h"in h)){var L=l(f(F(h)));h=L.l;var Q=L.a;const y=L.b;L=Math.sqrt(Q*Q+y*y);Q=Math.atan2(y,Q);Q=0<Q?Q:Q+2*Math.PI;h={l:h,c:L,h:Q}}return h};g.toRGB=F;g.toXYZ=function(h){return"x"in h&&"y"in h&&"z"in h?h:f(F(h))};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(g,u,f,O,l,C,F,w){function M(n,x){n*=q/180;return Math.abs(x*Math.sin(n))+Math.abs(x*Math.cos(n))}function h(n){return n.map(x=>`${x.command} ${x.values.join(" ")}`).join(" ").trim()}function L(n,x,G,K){if(n){if("circle"===n.type)return w.tsx("circle",{fill:x,"fill-rule":"evenodd",stroke:G.color,"stroke-width":G.width,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-dasharray":G.dashArray,"stroke-dashoffset":G.dashOffset,"stroke-miterlimit":"4",cx:n.cx,cy:n.cy,r:n.r});if("ellipse"===
n.type)return w.tsx("ellipse",{fill:x,"fill-rule":"evenodd",stroke:G.color,"stroke-width":G.width,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-dasharray":G.dashArray,"stroke-miterlimit":"4",cx:n.cx,cy:n.cy,rx:n.rx,ry:n.ry});if("rect"===n.type)return w.tsx("rect",{fill:x,"fill-rule":"evenodd",stroke:G.color,"stroke-width":G.width,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-dasharray":G.dashArray,"stroke-miterlimit":"4",x:n.x,y:n.y,width:n.width,height:n.height});if("image"===
n.type)return w.tsx("image",{href:n.src,x:n.x,y:n.y,width:n.width,height:n.height,preserveAspectRatio:"none"});if("path"===n.type)return n="string"!==typeof n.path?h(n.path):n.path,w.tsx("path",{fill:x,"fill-rule":"evenodd",stroke:G.color,"stroke-width":G.width,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-dasharray":G.dashArray,"stroke-miterlimit":"4",d:n});if("text"===n.type)return O.assertIsSome(K),w.tsx("text",{"dominant-baseline":K.dominantBaseline,fill:x,"fill-rule":"evenodd",stroke:G.color,
"stroke-width":G.width,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-dasharray":G.dashArray,"stroke-miterlimit":"4","text-anchor":K.align,"text-decoration":K.decoration,kerning:K.kerning,rotate:K.rotate,"text-rendering":d,"font-style":K.font.style,"font-variant":K.font.variant,"font-weight":K.font.weight,"font-size":K.font.size,"font-family":K.font.family,x:n.x,y:n.y},n.text)}return null}function Q(n){const x={fill:"none",pattern:null,linearGradient:null};if(n)if("type"in n&&"pattern"===
n.type){var G=`patternId-${++r}`;x.fill=`url(#${G})`;x.pattern={id:G,x:n.x,y:n.y,width:n.width,height:n.height,image:{x:0,y:0,width:n.width,height:n.height,href:n.src}}}else"type"in n&&"linear"===n.type?(G=`linearGradientId-${++H}`,x.fill=`url(#${G})`,x.linearGradient={id:G,x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,stops:n.colors.map(K=>({offset:K.offset,color:K.color&&(new u(K.color)).toString()}))}):n&&(n=new u(n),x.fill=n.toString());return x}function y(n){const x={color:"none",width:1,cap:"butt",join:"4",
dashArray:"none",dashOffset:"0"};if(n&&(null!=n.width&&(x.width=n.width),n.cap&&(x.cap=n.cap),n.join&&(x.join=n.join.toString()),n.color&&(x.color=(new u(n.color)).toString()),n.dashArray&&(x.dashArray=n.dashArray),n.dashArray&&(x.dashOffset=n.dashoffset),n.style)){let G=null;n.style in B&&(G=B[n.style]);if(Array.isArray(G)){G=G.slice(0);const K=n.width??0;for(let U=0;U<G.length;++U)G[U]*=K;if("butt"!==n.cap){for(n=0;n<G.length;n+=2)G[n]-=K,1>G[n]&&(G[n]=1);for(n=1;n<G.length;n+=2)G[n]+=K}G=G.join(",")}x.dashArray=
G}return x}function I(n,x){const G={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(n){const K=n.alignBaseline;G.align=n.align;G.dominantBaseline="baseline"===K?"auto":"top"===K?"text-top":"bottom"===K?"hanging":K;G.decoration=n.decoration;G.kerning=n.kerning?"auto":"0";G.rotate=n.rotated?"90":"0";O.assertIsSome(x);G.font.style=x.style||"normal";G.font.variant=x.variant||"normal";G.font.weight=x.weight||"normal";G.font.size=
x.size&&x.size.toString()||"10pt";G.font.family=x.family||"serif"}return G}function S(n){const {pattern:x,linearGradient:G}=n;return x?w.tsx("pattern",{id:x.id,patternUnits:"userSpaceOnUse",x:x.x,y:x.y,width:x.width,height:x.height},w.tsx("image",{x:x.image.x,y:x.image.y,width:x.image.width,height:x.image.height,href:x.image.href})):G?(n=G.stops.map((K,U)=>w.tsx("stop",{key:`${U}-stop`,offset:K.offset,"stop-color":K.color})),w.tsx("linearGradient",{id:G.id,gradientUnits:"userSpaceOnUse",x1:G.x1,y1:G.y1,
x2:G.x2,y2:G.y2},n)):null}function R(n,x){if(!n)return null;const G=[];for(const K of n){const {shape:U,fill:Y,stroke:ba,font:la}=K;n=Q(Y);const pa=y(ba),va="text"===U.type?I(U,la):null;(n=L(U,n.fill,pa,va))&&G.push(n)}return w.tsx("mask",{id:x,maskUnits:"userSpaceOnUse"},w.tsx("g",null,G))}function D(n,x,G,K,U){C.scale(n,C.identity(n),[x,G]);n[4]=n[4]*x-K*x+K;n[5]=n[5]*G-U*G+U;return n}function E(n,x){if(m&&"left"in m){null!=m.left&&m.left>n&&(m.left=n);if(null==m.right||m.right<n)m.right=n;if(null==
m.top||m.top>x)m.top=x;if(null==m.bottom||m.bottom<x)m.bottom=x}else m={left:n,bottom:x,right:n,top:x}}function J(n){const x=n.args,G=x.length;switch(n.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(n=0;n<G;n+=2)E(x[n],x[n+1]);k.x=x[G-2];k.y=x[G-1];break;case "H":for(n=0;n<G;++n)E(x[n],k.y);k.x=x[G-1];break;case "V":for(n=0;n<G;++n)E(k.x,x[n]);k.y=x[G-1];break;case "m":n=0;"x"in k||(E(k.x=x[0],k.y=x[1]),n=2);for(;n<G;n+=2)E(k.x+=x[n],k.y+=x[n+1]);break;case "l":case "t":for(n=0;n<
G;n+=2)E(k.x+=x[n],k.y+=x[n+1]);break;case "h":for(n=0;n<G;++n)E(k.x+=x[n],k.y);break;case "v":for(n=0;n<G;++n)E(k.x,k.y+=x[n]);break;case "c":for(n=0;n<G;n+=6)E(k.x+x[n],k.y+x[n+1]),E(k.x+x[n+2],k.y+x[n+3]),E(k.x+=x[n+4],k.y+=x[n+5]);break;case "s":case "q":for(n=0;n<G;n+=4)E(k.x+x[n],k.y+x[n+1]),E(k.x+=x[n+2],k.y+=x[n+3]);break;case "A":for(n=0;n<G;n+=7)E(x[n+5],x[n+6]);k.x=x[G-2];k.y=x[G-1];break;case "a":for(n=0;n<G;n+=7)E(k.x+=x[n+5],k.y+=x[n+6])}}function A(n,x,G){const K=p[n.toLowerCase()];
"number"===typeof K&&(K?x.length>=K&&(n={action:n,args:x.slice(0,x.length-x.length%K)},G.push(n),J(n)):(n={action:n,args:[]},G.push(n),J(n)))}function P(n){const x={x:0,y:0,width:0,height:0};if("circle"===n.type)x.x=n.cx-n.r,x.y=n.cy-n.r,x.width=2*n.r,x.height=2*n.r;else if("ellipse"===n.type)x.x=n.cx-n.rx,x.y=n.cy-n.ry,x.width=2*n.rx,x.height=2*n.ry;else if("image"===n.type||"rect"===n.type)x.x=n.x,x.y=n.y,x.width=n.width,x.height=n.height;else if("path"===n.type){var G=O.unwrapOrThrow;{const Y=
("string"!==typeof n.path?h(n.path):n.path).match(z),ba=[];m={};k={};if(Y){n="";var K=[],U=Y.length;for(let la=0;la<U;++la){const pa=Y[la],va=parseFloat(pa);isNaN(va)?(n&&A(n,K,ba),K=[],n=pa):K.push(va)}A(n,K,ba);n={x:0,y:0,width:0,height:0};m&&"left"in m&&(n.x=m.left,n.y=m.top,n.width=m.right-m.left,n.height=m.bottom-m.top)}else n=null}G=G.call(O,n);x.x=G.x;x.y=G.y;x.width=G.width;x.height=G.height}return x}function e(n){const x={x:0,y:0,width:0,height:0};let G=null,K=Number.NEGATIVE_INFINITY,U=
Number.NEGATIVE_INFINITY;for(const Y of n)G?(G.x=Math.min(G.x,Y.x),G.y=Math.min(G.y,Y.y),K=Math.max(K,Y.x+Y.width),U=Math.max(U,Y.y+Y.height)):(G=x,G.x=Y.x,G.y=Y.y,K=Y.x+Y.width,U=Y.y+Y.height);G&&(G.width=K-G.x,G.height=U-G.y);return G}function c(n,x,G,K,U,Y,ba,la,pa){var va=(ba&&Y?M(Y,x):x)/2,xa=(ba&&Y?M(Y,G):G)/2;if(pa){var Aa=pa[0];pa=pa[1];va=(ba&&Y?M(Y,Aa):Aa)/2;xa=(ba&&Y?M(Y,pa):pa)/2}Aa=n.width+K;var Ga=n.height+K;pa=l.create();ba=l.create();var Da=!1;if(U&&0!==Aa&&0!==Ga){U=x!==G?x/G:Aa/
Ga;Da=x>G?x:G;let da=1,ja=1;isNaN(Da)||(1<U?(da=Da/Aa,ja=Da/U/Ga):(ja=Da/Ga,da=Da*U/Aa));C.multiply(ba,ba,D(pa,da,ja,va,xa));Da=!0}U=n.x+(Aa-K)/2;n=n.y+(Ga-K)/2;K=C.multiply;va-=U;xa-=n;va=C.translate(pa,C.identity(pa),[va,xa]);K.call(C,ba,ba,va);!Da&&(Aa>x||Ga>G)&&(va=Aa/x>Ga/G,x=(va?x:G)/(va?Aa:Ga),C.multiply(ba,ba,D(pa,x,x,U,n)));Y&&(x=C.multiply,G=Y%360*Math.PI/180,C.rotate(pa,C.identity(pa),G),Y=Math.cos(G),G=Math.sin(G),Aa=pa[4],Ga=pa[5],pa[4]=Aa*Y-Ga*G+n*G-U*Y+U,pa[5]=Ga*Y+Aa*G-U*G-n*Y+n,x.call(C,
ba,ba,pa));la&&(Y=C.multiply,x=la[0],la=la[1],la=C.translate(pa,C.identity(pa),[x,la]),Y.call(C,ba,ba,la));return`matrix(${ba[0]},${ba[1]},${ba[2]},${ba[3]},${ba[4]},${ba[5]})`}function b(n,x,G){n=n?.effects.find(la=>"bloom"===la.type);if(!n)return null;const {strength:K,radius:U}=n;n=0<K?U:0;const Y=(K+n)*x,ba=4*K+1;return w.tsx("filter",{id:`bloom${G}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},w.tsx("feMorphology",{operator:"dilate",radius:(K+.5*n)*5**(x/100)*
(.4+x/100),in:"SourceGraphic",result:"dilate"}),w.tsx("feGaussianBlur",{in:"dilate",stdDeviation:Y/25,result:"blur"}),w.tsx("feGaussianBlur",{in:"blur",stdDeviation:Y/50,result:"intensityBlur"}),w.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},w.tsx("feFuncR",{type:"linear",slope:ba}),w.tsx("feFuncG",{type:"linear",slope:ba}),w.tsx("feFuncB",{type:"linear",slope:ba})),w.tsx("feMerge",null,w.tsx("feMergeNode",{in:"intensityBlur"}),w.tsx("feMergeNode",{in:"intensityBrightness"}),
w.tsx("feGaussianBlur",{stdDeviation:K/10})))}let r=0,H=0;F=f("android");const d=f("chrome")||F&&4<=F?"auto":"optimizeLegibility",p={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},z=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let m={},k={};const B={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},q=Math.PI;let T=1;g.computeBBox=e;g.generateFillAttributes=
Q;g.generateStrokeAttributes=y;g.generateTextAttributes=I;g.getBoundingBox=P;g.getTransformMatrix=c;g.renderDef=S;g.renderSVG=function(n,x,G,K={}){const U=[],Y=[],ba=++T,la=b(K.effectView,x,ba);var pa=null;la&&(pa=K.effectView?.effects.find(Da=>"bloom"===Da.type),pa=(pa.strength?pa.strength+pa.radius/2:0)/3,pa=[Math.max(x+x*pa,10),Math.max(G+G*pa,10)]);for(let Da=0;Da<n.length;Da++){var va=n[Da];const da=[];var xa=[],Aa=0,Ga=0;let ja=0;for(const ha of va){const {shape:Z,fill:ca,stroke:fa,font:ea,
offset:na}=ha;K.ignoreStrokeWidth||(Aa+=fa&&fa.width||0);va=Q(ca);const oa=y(fa),ka="text"===Z.type?I(Z,ea):null;U.push(S(va));da.push(L(Z,va.fill,oa,ka));xa.push(P(Z));na&&(Ga+=na[0],ja+=na[1])}xa=O.unwrapOrThrow(e(xa));Aa=c(xa,x,G,Aa,K.scale??!1,K.rotation,K.useRotationSize??!1,[Ga,ja],pa);Ga=null;K.masking&&(Ga=`mask-${Da}`,U.push(R(K.masking[Da],Ga)),Ga=`url(#${Ga})`);Y.push(Ga?w.tsx("g",{mask:Ga},w.tsx("g",{transform:Aa},da)):w.tsx("g",{transform:Aa},da))}K.useRotationSize&&K.rotation&&(x=M(K.rotation,
x),G=M(K.rotation,G));la&&(O.assertIsSome(pa),x=pa[0],G=pa[1]);return w.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:x,height:G,style:"display: block;"},la,w.tsx("defs",null,U),la?w.tsx("g",{filter:`url(#bloom${ba})`},Y):Y)};g.renderShape=L;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat2df32":function(){define(["exports"],function(g){function u(){const M=new Float32Array(6);M[0]=1;M[3]=1;return M}function f(M){const h=new Float32Array(6);
h[0]=M[0];h[1]=M[1];h[2]=M[2];h[3]=M[3];h[4]=M[4];h[5]=M[5];return h}function O(M,h,L,Q,y,I){const S=new Float32Array(6);S[0]=M;S[1]=h;S[2]=L;S[3]=Q;S[4]=y;S[5]=I;return S}function l(M,h){return new Float32Array(M,h,6)}function C(M,h,L,Q){const y=h[Q];h=h[Q+1];M[Q]=L[0]*y+L[2]*h+L[4];M[Q+1]=L[1]*y+L[3]*h+L[5]}function F(M,h,L,Q=0,y=0,I=2){for(y=y||h.length/I;Q<y;Q++)C(M,h,L,Q*I)}const w=Object.freeze(Object.defineProperty({__proto__:null,create:u,clone:f,fromValues:O,createView:l,transform:C,transformMany:F},
Symbol.toStringTag,{value:"Module"}));g.clone=f;g.create=u;g.createView=l;g.fromValues=O;g.mat2df32=w;g.transform=C;g.transformMany=F})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(g,u){function f(b,r){b[0]=r[0];b[1]=r[1];b[2]=r[2];b[3]=r[3];b[4]=r[4];b[5]=r[5];return b}function O(b){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=0;b[5]=0;return b}function l(b,r,H,d,p,z,m){b[0]=r;b[1]=H;b[2]=d;b[3]=p;b[4]=z;b[5]=m;return b}function C(b,r){const H=r[0],d=r[1],p=r[2],z=r[3],m=r[4];r=r[5];
let k=H*z-d*p;if(!k)return null;k=1/k;b[0]=z*k;b[1]=-d*k;b[2]=-p*k;b[3]=H*k;b[4]=(p*r-z*m)*k;b[5]=(d*m-H*r)*k;return b}function F(b){return b[0]*b[3]-b[1]*b[2]}function w(b,r,H){const d=r[0],p=r[1],z=r[2],m=r[3],k=r[4];r=r[5];const B=H[0],q=H[1],T=H[2],n=H[3],x=H[4];H=H[5];b[0]=d*B+z*q;b[1]=p*B+m*q;b[2]=d*T+z*n;b[3]=p*T+m*n;b[4]=d*x+z*H+k;b[5]=p*x+m*H+r;return b}function M(b,r,H){const d=r[0],p=r[1],z=r[2],m=r[3],k=r[4];r=r[5];const B=Math.sin(H);H=Math.cos(H);b[0]=d*H+z*B;b[1]=p*H+m*B;b[2]=d*-B+
z*H;b[3]=p*-B+m*H;b[4]=k;b[5]=r;return b}function h(b,r,H){const d=r[1],p=r[2],z=r[3],m=r[4],k=r[5],B=H[0];H=H[1];b[0]=r[0]*B;b[1]=d*B;b[2]=p*H;b[3]=z*H;b[4]=m;b[5]=k;return b}function L(b,r,H){const d=r[0],p=r[1],z=r[2],m=r[3],k=r[4];r=r[5];const B=H[0];H=H[1];b[0]=d;b[1]=p;b[2]=z;b[3]=m;b[4]=d*B+z*H+k;b[5]=p*B+m*H+r;return b}function Q(b,r){const H=Math.sin(r);r=Math.cos(r);b[0]=r;b[1]=H;b[2]=-H;b[3]=r;b[4]=0;b[5]=0;return b}function y(b,r){b[0]=r[0];b[1]=0;b[2]=0;b[3]=r[1];b[4]=0;b[5]=0;return b}
function I(b,r){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=r[0];b[5]=r[1];return b}function S(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"}function R(b){return Math.sqrt(b[0]**2+b[1]**2+b[2]**2+b[3]**2+b[4]**2+b[5]**2+1)}function D(b,r,H){b[0]=r[0]+H[0];b[1]=r[1]+H[1];b[2]=r[2]+H[2];b[3]=r[3]+H[3];b[4]=r[4]+H[4];b[5]=r[5]+H[5];return b}function E(b,r,H){b[0]=r[0]-H[0];b[1]=r[1]-H[1];b[2]=r[2]-H[2];b[3]=r[3]-H[3];b[4]=r[4]-H[4];b[5]=r[5]-H[5];return b}function J(b,r,H){b[0]=r[0]*
H;b[1]=r[1]*H;b[2]=r[2]*H;b[3]=r[3]*H;b[4]=r[4]*H;b[5]=r[5]*H;return b}function A(b,r,H,d){b[0]=r[0]+H[0]*d;b[1]=r[1]+H[1]*d;b[2]=r[2]+H[2]*d;b[3]=r[3]+H[3]*d;b[4]=r[4]+H[4]*d;b[5]=r[5]+H[5]*d;return b}function P(b,r){return b[0]===r[0]&&b[1]===r[1]&&b[2]===r[2]&&b[3]===r[3]&&b[4]===r[4]&&b[5]===r[5]}function e(b,r){const H=b[0],d=b[1],p=b[2],z=b[3],m=b[4];b=b[5];const k=r[0],B=r[1],q=r[2],T=r[3],n=r[4];r=r[5];const x=u.getEpsilon();return Math.abs(H-k)<=x*Math.max(1,Math.abs(H),Math.abs(k))&&Math.abs(d-
B)<=x*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(p-q)<=x*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(z-T)<=x*Math.max(1,Math.abs(z),Math.abs(T))&&Math.abs(m-n)<=x*Math.max(1,Math.abs(m),Math.abs(n))&&Math.abs(b-r)<=x*Math.max(1,Math.abs(b),Math.abs(r))}const c=Object.freeze(Object.defineProperty({__proto__:null,copy:f,identity:O,set:l,invert:C,determinant:F,multiply:w,rotate:M,scale:h,translate:L,fromRotation:Q,fromScaling:y,fromTranslation:I,str:S,frob:R,add:D,subtract:E,multiplyScalar:J,multiplyScalarAndAdd:A,
exactEquals:P,equals:e,mul:w,sub:E},Symbol.toStringTag,{value:"Module"}));g.add=D;g.copy=f;g.determinant=F;g.equals=e;g.exactEquals=P;g.frob=R;g.fromRotation=Q;g.fromScaling=y;g.fromTranslation=I;g.identity=O;g.invert=C;g.mat2d=c;g.mul=w;g.multiply=w;g.multiplyScalar=J;g.multiplyScalarAndAdd=A;g.rotate=M;g.scale=h;g.set=l;g.str=S;g.sub=E;g.subtract=E;g.translate=L})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y){function I(k){k=k.symbolLayers;if(!k)return null;let B=null;k.forEach(q=>{if("object"!==q.type||null==q.resource?.href)B="water"===q.type?w.unwrap(q.color):w.isSome(q.material)?w.unwrap(q.material.color):null});return B?new O(B):null}function S(k,B){if(null==B||null==k)return k;k=k.toRgba();k[3]*=B;return new O(k)}function R(k,B,q){if(k=k.symbolLayers){var T=n=>{n=w.isSome(n)?n:null;B=B??n??(null!=q?m:null);return S(B,q)};k.forEach(n=>{if("object"!==n.type||null==
n.resource?.href||B)if("water"===n.type)n.color=T(n.color);else{var x=w.isSome(n.material)?n.material.color:null;x=T(x);w.isNone(n.material)?n.material=new y.Symbol3DMaterial({color:x}):n.material.color=x;null!=q&&"outline"in n&&w.isSome(n.outline)&&w.isSome(n.outline.color)&&(n.outline.color=S(n.outline.color,q))}})}}function D(k,B){return E.apply(this,arguments)}function E(){E=f._asyncToGenerator(function*(k,B){(k=k.symbolLayers)&&(yield C.forEach(k,function(){var q=f._asyncToGenerator(function*(T){return J(T,
B)});return function(T){return q.apply(this,arguments)}}()))});return E.apply(this,arguments)}function J(k,B){return A.apply(this,arguments)}function A(){A=f._asyncToGenerator(function*(k,B){switch(k.type){case "extrude":k.size="number"===typeof B[2]?B[2]:0;break;case "icon":case "line":case "text":B=P(B);w.isSome(B)&&(k.size=B);break;case "path":const q=b(B,h.ONES,[k.width,void 0,k.height]);k.width=d(B[0],k.width,1,q);k.height=d(B[2],k.height,1,q);break;case "object":yield e(k,B)}});return A.apply(this,
arguments)}function P(k){for(const B of k)if("number"===typeof B)return B;return null}function e(k,B){return c.apply(this,arguments)}function c(){c=f._asyncToGenerator(function*(k,B){const {resourceSize:q,symbolSize:T}=yield r(k),n=b(B,q,T);k.width=d(B[0],T[0],q[0],n);k.depth=d(B[1],T[1],q[1],n);k.height=d(B[2],T[2],q[2],n)});return c.apply(this,arguments)}function b(k,B,q){for(let T=0;3>T;T++){const n=k[T];switch(n){case "symbol-value":return k=q[T],null!=k?k/B[T]:1;case "proportional":break;default:if(n&&
B[T])return n/B[T]}}return 1}function r(k){return H.apply(this,arguments)}function H(){H=f._asyncToGenerator(function*(k){const B=yield(yield new Promise((K,U)=>g(["./symbolLayerUtils"],K,U))).computeObjectLayerResourceSize(k,10),{width:q,height:T,depth:n}=k;k=[q,n,T];let x=1;for(var G=0;3>G;G++){const K=k[G];if(null!=K){x=K/B[G];break}}for(G=0;3>G;G++)null==k[G]&&(k[G]=B[G]*x);return{resourceSize:B,symbolSize:k}});return H.apply(this,arguments)}function d(k,B,q,T){switch(k){case "proportional":return q*
T;case "symbol-value":return null!=B?B:q;default:return k}}function p(){p=f._asyncToGenerator(function*(k,B){if(k&&B){if(l.isSymbol3D(k))return D(k,B);if(l.isSymbol2D(k)&&(B=P(B),!w.isNone(B)))switch(k.type){case "simple-marker":k.size=B;break;case "picture-marker":const q=k.width/k.height;1<q?(k.width=B,k.height=B*q):(k.width=B*q,k.height=B);break;case "simple-line":k.width=B;break;case "text":k.font.size=B}}});return p.apply(this,arguments)}const z=/\/resource\/(.*?)\.svg$/,m=new O("white");u.applyColorToSymbol=
function(k,B,q){if(k&&(B||null!=q))if(B&&(B=new O(B)),l.isSymbol3D(k))R(k,B,q);else if(l.isSymbol2D(k)){if(B=B??k.color)k.color=S(B,q);null!=q&&"outline"in k&&k.outline&&k.outline.color&&(k.outline.color=S(k.outline.color,q))}};u.applyOpacityToColor=S;u.applyRotationToSymbol=function(k,B,q){k&&null!=B&&(l.isSymbol3D(k)?(k=k.symbolLayers)&&k.forEach(T=>{if(T&&"object"===T.type)switch(q){case "tilt":T.tilt=B;break;case "roll":T.roll=B;break;default:T.heading=B}}):!l.isSymbol2D(k)||"simple-marker"!==
k.type&&"picture-marker"!==k.type&&"text"!==k.type||(k.angle=B))};u.applySizesToSymbol=function(k,B){return p.apply(this,arguments)};u.getCSSFilterFromEffectList=function(k){if(!k)return null;k=k.effects.filter(B=>"bloom"!==B.type).map(B=>B.toJSON());return L.effectFunctionsFromJSON(k)};u.getColorFromSymbol=function(k,B){if(!k)return null;let q=null;l.isSymbol3D(k)?q=I(k):l.isSymbol2D(k)&&(q=k.color?new O(k.color):null);return q?S(q,B):null};u.getIconHref=function(k,B){B=w.unwrapOrThrow(B.resource).href;
return!F("esri-canvas-svg-support")&&k.styleOrigin&&z.test(B)?B.replace(z,"/resource/png/$1.png"):B};u.getSymbolOutlineSize=function(k){if(!k)return 0;if(l.isSymbol3D(k)){{const B=k.symbolLayers&&k.symbolLayers.length;B?(k=k.symbolLayers.getItemAt(B-1),k="outline"in k?w.get(k,"outline","size"):void 0):k=void 0}return w.isSome(k)?k:0}return M.px2pt(Q.getStroke(k)?.width)};u.isVolumetricSymbol=function(k){if(w.isNone(k)||!("symbolLayers"in k)||w.isNone(k.symbolLayers))return!1;switch(k.type){case "point-3d":return k.symbolLayers.some(B=>
"object"===B.type);case "line-3d":return k.symbolLayers.some(B=>"path"===B.type);case "polygon-3d":return k.symbolLayers.some(B=>"object"===B.type||"extrude"===B.type);default:return!1}};u.symbolHasExtrudeSymbolLayer=function(k){return w.isSome(k)&&"polygon-3d"===k.type&&k.symbolLayers.some(B=>"extrude"===B.type)};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w){f=function(M){function h(L){L=M.call(this,L)||this;L.items=null;L.label=null;return L}g._inheritsLoose(h,M);return h}(O.IdentifiableMixin(f));u.__decorate([l.property()],f.prototype,"items",void 0);u.__decorate([l.property()],f.prototype,"label",void 0);return f=u.__decorate([w.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],f)})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/Heading","../support/widgetUtils","../support/jsxFactory"],
function(g,u,f,O){function l(h){const {headingLevel:L,identify:Q,items:y,renderIcon:I,filterText:S,onItemMouseLeave:R,onItemMouseEnter:D,onItemSelect:E,selectedItem:J}=h,A=h.enableListScroll?M.scroller:null;return 0===y.length?O.tsx("div",{class:M.noMatchesMessage,key:"no-matches"},h.messages.noMatches):O.tsx("div",{class:A,key:"item-container"},y.map(P=>P.items?w({group:P,filterText:S,headingLevel:L,identify:Q,onItemMouseLeave:R,onItemMouseEnter:D,onItemSelect:E,renderIcon:I,selectedItem:J}):F({item:P,
identify:Q,grouped:!0,onItemMouseLeave:R,onItemMouseEnter:D,onItemSelect:E,renderIcon:I,filterText:S,selectedItem:J})))}function C(h){const {messages:L,filterText:Q,enableListScroll:y}=h;return O.tsx("div",{key:"filter",class:y?null:M.filterContainerSticky},O.tsx("calcite-input",{onCalciteInputInput:I=>{I=I.currentTarget;h.onFilterChange&&h.onFilterChange(I.value)},placeholder:L.filterPlaceholder,value:Q,type:"search"}))}function F(h){const {identify:L,item:Q,selectedItem:y,grouped:I,onItemSelect:S,
onItemMouseEnter:R,onItemMouseLeave:D,renderIcon:E}=h;h=`${L?.(Q)||Q.id}__${Q.label}`;const J=y?`${L?.(y)||y.id}__${y.label}`:"";return O.tsx("calcite-list-item",{"aria-level":I?"2":"","data-item":Q,key:h,class:f.classes(M.item,h===J?M.itemSelected:""),label:Q.label,onclick:A=>{A=A.currentTarget["data-item"];S&&S(A)},onmouseenter:A=>{A=A.currentTarget["data-item"];R&&R(A)},onkeydown:A=>{f.isActivationKey(A.key)&&(A=A.currentTarget["data-item"],S&&S(A))},onmouseleave:A=>{A=A.currentTarget["data-item"];
D&&D(A)},tabIndex:0},O.tsx("div",{class:M.itemIcon,slot:"content-start"},E&&E({item:Q})))}function w(h){const {group:L,identify:Q,onItemMouseLeave:y,onItemMouseEnter:I,onItemSelect:S,filterText:R,renderIcon:D,selectedItem:E,headingLevel:J}=h;return O.tsx("div",{class:M.group,key:L.label},O.tsx(u.Heading,{level:J,class:M.groupHeader},L.label),L.items.map(A=>F({item:A,identify:Q,grouped:!0,onItemMouseLeave:y,onItemMouseEnter:I,onItemSelect:S,renderIcon:D,filterText:R,selectedItem:E})))}const M={base:"esri-item-list",
list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group__header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",itemIcon:"esri-item-list__list-item-icon",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",
filterContainerSticky:"esri-item-list__filter-container--sticky",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",input:"esri-input"};g.ItemList=function(h){const {id:L,identify:Q,filterEnabled:y=!0,headingLevel:I=4,items:S,selectedItem:R,messages:D,filterText:E="",onFilterChange:J,renderIcon:A,onItemMouseLeave:P,onItemMouseEnter:e,onItemSelect:c}=
h;h=h.enableListScroll??!0;return O.tsx("div",{key:L},y?C({filterText:E,messages:D,onFilterChange:J,id:L}):null,l({enableListScroll:h,identify:Q,items:S,selectedItem:R,messages:D,filterText:E,headingLevel:I,renderIcon:A,onItemMouseLeave:P,onItemMouseEnter:e,onItemSelect:c}))};g.renderGroup=w;g.renderItem=F;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Spinner":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y){F=function(I){function S(D,E){D=I.call(this,D,E)||this;D._animationDelay=500;D._animationPromise=null;D.viewModel=new L;return D}g._inheritsLoose(S,I);var R=S.prototype;R.initialize=function(){this.addHandles(l.watch(()=>this.visible,D=>this._visibleChange(D)))};R.destroy=function(){this._animationPromise=null};R.show=function(D){const {location:E,promise:J}=D;E&&(this.viewModel.location=E);this.visible=!0;D=()=>this.hide();J&&J.catch(()=>{}).then(D)};R.hide=function(){this.visible=
!1};R.render=function(){var {visible:D}=this,{screenLocation:E}=this.viewModel;E=!!E;D={["esri-spinner--start"]:D&&E,["esri-spinner--finish"]:!D&&E};E=this._getPositionStyles();return y.tsx("div",{class:this.classes("esri-spinner",D),styles:E})};R._visibleChange=function(D){if(D)this.viewModel.screenLocationEnabled=!0;else{var E=O.after(this._animationDelay);this._animationPromise=E;E.catch(()=>{}).then(()=>{this._animationPromise===E&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=
null)})}};R._getPositionStyles=function(){const {screenLocation:D,view:E}=this.viewModel;if(f.isNone(E)||f.isNone(D))return{};const {padding:J}=E;return{left:`${D.x-J.left}px`,top:`${D.y-J.top}px`}};g._createClass(S,[{key:"location",get:function(){return this.viewModel.location},set:function(D){this.viewModel.location=D}},{key:"view",get:function(){return this.viewModel.view},set:function(D){this.viewModel.view=D}},{key:"visible",get:function(){return this.viewModel.visible},set:function(D){this.viewModel.visible=
D}}]);return S}(h);u.__decorate([C.property()],F.prototype,"location",null);u.__decorate([C.property()],F.prototype,"view",null);u.__decorate([C.property({type:L})],F.prototype,"viewModel",void 0);u.__decorate([C.property()],F.prototype,"visible",null);return F=u.__decorate([M.subclass("esri.widgets.Spinner")],F)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),
function(g,u,f,O,l,C,F){O=function(w){function M(h){h=w.call(this,h)||this;h.visible=!1;return h}g._inheritsLoose(M,w);return M}(F);u.__decorate([f.property()],O.prototype,"visible",void 0);return O=u.__decorate([C.subclass("esri.widgets.CompassViewModel")],O)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w,M,h){const L=Symbol("anchorHandles");f=function(y){function I(S){var R=y.call(this,S)||this;R[Q]=new O;R.location=null;R.screenLocationEnabled=!1;R.view=null;R[L].add([C.when(()=>l.applySome(R.screenLocationEnabled?R.view:null,D=>[D.size,"3d"===D.type?D.camera:D.viewpoint]),()=>R.notifyChange("screenLocation")),C.watch(()=>R.screenLocation,(D,E)=>{l.isSome(D)&&l.isSome(E)&&R.emit("view-change")})]);return R}g._inheritsLoose(I,y);I.prototype.destroy=function(){this.view=null;
this[L]=l.destroyMaybe(this[L])};g._createClass(I,[{key:"screenLocation",get:function(){const {location:S,view:R,screenLocationEnabled:D}=this;return D&&l.isSome(S)&&l.isSome(R)&&R.ready?R.toScreen(S):null}}]);return I}(f.EventedAccessor);var Q=L;u.__decorate([F.property()],f.prototype,"location",void 0);u.__decorate([F.property()],f.prototype,"screenLocation",null);u.__decorate([F.property()],f.prototype,"screenLocationEnabled",void 0);u.__decorate([F.property()],f.prototype,"view",void 0);return f=
u.__decorate([h.subclass("esri.widgets.support.AnchorElementViewModel")],f)})},"esri/widgets/Editor/deprecationUtils":function(){define(["exports","../../core/deprecate"],function(g,u){g.workflowDeprecation=function(f,O,l){u.deprecated(f,"`"+O+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:l,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})};Object.defineProperties(g,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./CreateWorkflow ./deprecationUtils ./UpdateWorkflow ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e){function c(d,p,z){r.error(new O(d,p,z))}function b(d,p){return d&&d.find(z=>z.layer===p)}const r=F.getLogger("esri.widgets.Editor.EditorViewModel"),H=["create","create-features","update"];l=function(d){function p(m){m=d.call(this,m)||this;m._sketchGraphicsLayer=new y({listMode:"hide",internal:!0});m.activeWorkflow=null;m._activityQueue=[];m.failures=[];m.attachmentsViewModel=new I({abilities:{editing:!0}});m.featureFormViewModel=new J;m.featureTemplatesViewModel=
new A;m.layerInfos=null;m.sketchViewModel=new P({layer:m._sketchGraphicsLayer});m.spinnerViewModel=new e;return m}g._inheritsLoose(p,d);var z=p.prototype;z.initialize=function(){this.handles.add([w.on(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),w.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),w.when(()=>this.view?.map,m=>{m.add(this._sketchGraphicsLayer)},w.initial),w.watch(()=>this.editableItems.toArray(),()=>{const {activeWorkflow:m}=this;this.refreshCreationTemplates();
if(m){var {stepId:k}=m;"create"===m.type?"awaiting-feature-creation-info"!==k||this.canCreate||this._cancelWorkflow():"update"===m.type&&("awaiting-feature-to-update"===k&&!this.canUpdate||"awaiting-update-feature-candidate"===k&&!m.data.candidates.some(B=>{const q=this.editableItems.find(T=>T.layer===B.layer);return q&&q.supports.includes("update")}))&&this._cancelWorkflow()}})])};z.destroy=function(){this._cancelWorkflow().then(()=>{this.view?.map&&this.view.map.remove(this._sketchGraphicsLayer);
this.view=null})};z.startCreateWorkflowAtFeatureTypeSelection=function(){var m=g._asyncToGenerator(function*(){D.workflowDeprecation(r,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");if(this.canCreate){yield this._cancelWorkflow();var k=this._createCreateWorkflow();yield k.start();this._set("activeWorkflow",k)}else c("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(){return m.apply(this,arguments)}}();
z.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){var m=g._asyncToGenerator(function*(){return this.startCreateFeaturesWorkflow()});return function(){return m.apply(this,arguments)}}();z.startCreateWorkflowAtFeatureCreation=function(){var m=g._asyncToGenerator(function*(k){D.workflowDeprecation(r,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");if(this.canCreate){yield this._cancelWorkflow();var B=this._createCreateWorkflow("awaiting-feature-to-create");
B.data.creationInfo=k;yield B.start();this._set("activeWorkflow",B)}else c("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(k){return m.apply(this,arguments)}}();z.startCreateFeaturesWorkflowAtFeatureCreation=function(){var m=g._asyncToGenerator(function*(k){return this.startCreateFeaturesWorkflow(k,"creating-features")});return function(k){return m.apply(this,arguments)}}();z.startCreateFeaturesWorkflow=function(){var m=g._asyncToGenerator(function*(k,
B="awaiting-feature-creation-info"){if(!this.canCreate)throw new O("editing:unsupported-workflow","Creating features is unsupported or disabled.");yield this._cancelWorkflow();k=this._createCreateFeaturesWorkflow(k,B);yield k.start();this._set("activeWorkflow",k)});return function(k){return m.apply(this,arguments)}}();z.startCreateWorkflowAtFeatureEdit=function(){var m=g._asyncToGenerator(function*(k){D.workflowDeprecation(r,"startCreateWorkflowAtFeatureEdit");if(this.canCreate){yield this._cancelWorkflow();
var B=this._createCreateWorkflow("editing-new-feature");B.data.edits.feature=k;yield B.start();this._set("activeWorkflow",B)}else c("editing:unsupported-workflow","Create workflow is unsupported or disabled.")});return function(k){return m.apply(this,arguments)}}();z.startUpdateWorkflowAtFeatureSelection=function(){var m=g._asyncToGenerator(function*(){if(this.canUpdate){yield this._cancelWorkflow();var k=this._createUpdateWorkflow();yield k.start();this._set("activeWorkflow",k)}else c("editing:unsupported-workflow",
"Update workflow is unsupported or disabled.")});return function(){return m.apply(this,arguments)}}();z.startUpdateWorkflowAtMultipleFeatureSelection=function(){var m=g._asyncToGenerator(function*(k){if(this.canUpdate){yield this._cancelWorkflow();var B=this._createUpdateWorkflow("awaiting-update-feature-candidate");B.data.candidates=k;yield B.start();this._set("activeWorkflow",B)}else c("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(k){return m.apply(this,
arguments)}}();z.startUpdateWorkflowAtFeatureEdit=function(){var m=g._asyncToGenerator(function*(k){if(this.canUpdate){yield this._cancelWorkflow();var B=this._createUpdateWorkflow("editing-existing-feature");B.data.edits.feature=k;yield B.start();this._set("activeWorkflow",B)}else c("editing:unsupported-workflow","Update workflow is unsupported or disabled.")});return function(k){return m.apply(this,arguments)}}();z.deleteFeatureFromWorkflow=function(){var m=g._asyncToGenerator(function*(){const {activeWorkflow:k}=
this;k&&"update"===k.type?(yield this._delete(k.data.edits.feature),yield k.reset()):c("editing:unsupported-workflow","Deleting requires an active update workflow.")});return function(){return m.apply(this,arguments)}}();z.cancelWorkflow=function(){var m=g._asyncToGenerator(function*(k){return this._cancelWorkflow({warn:!0,...k})});return function(k){return m.apply(this,arguments)}}();z.refreshCreationTemplates=function(){const m=[];for(const {layer:k,supports:B}of this.editableItems)k.loaded&&B.includes("create")&&
m.push(k);this.featureTemplatesViewModel.layers=m};z._cancelWorkflow=function(){var m=g._asyncToGenerator(function*(k){const B=this.activeWorkflow;B?k&&!1===k.force?(yield B.cancel(k),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",null),yield B.cancel(k)):k&&k.warn&&c("editing:no-active-workflow","There is no active workflow to cancel.")});return function(k){return m.apply(this,arguments)}}();z._createCreateFeaturesWorkflow=function(m,k){return S.create(this,
m,k,(B,q,T)=>this._applyEdits(B,q,T),(B,q)=>this._addAttachments(B,q))};z._createCreateWorkflow=function(m){return R.create(this,m,(k,B,q)=>this._applyEdits(k,B,q))};z._createUpdateWorkflow=function(m){return E.create(this,m,(k,B)=>this._applyEdits(k,B))};z._delete=function(){var m=g._asyncToGenerator(function*(k){const B=k.sourceLayer;"applyEdits"in B&&(yield this._applyEdits(B,{deleteFeatures:[k]}))});return function(k){return m.apply(this,arguments)}}();z._addAttachments=function(m,k){const B=
[];k?.forEach(q=>B.push(this._addAttachment(m,q.feature,q.attachment)));return Promise.all(B)};z._addAttachment=function(){var m=g._asyncToGenerator(function*(k,B,q){let T=null;yield this._queueOperation(g._asyncToGenerator(function*(){return T=yield k.addAttachment(B,q).catch(n=>{throw n?.error||n;})}));return T});return function(k,B,q){return m.apply(this,arguments)}}();z._applyEdits=function(){var m=g._asyncToGenerator(function*(k,B,q){var T=this;let n=null;yield this._queueOperation(g._asyncToGenerator(function*(){if(k.capabilities.operations.supportsQuery){const x=
yield T.view.whenLayerView(k);n=yield k.applyEdits(B,q);yield w.whenOnce(()=>!x.updating);return n}return n=yield k.applyEdits(B,q)}));return n});return function(k,B,q){return m.apply(this,arguments)}}();z._queueOperation=function(m){this._activityQueue.push(m);this.notifyChange("syncing");const k=(B,q)=>{B=q.indexOf(B);-1<B&&q.splice(B,1)};return m().then(B=>{if("error"in B&&B.error)throw B.error;if("addFeatureResults"in B){const {addFeatureResults:q,deleteFeatureResults:T,updateFeatureResults:n}=
B,x=q.find(G=>!!G.error)||n.find(G=>!!G.error)||T.find(G=>!!G.error);if(x)throw x.error;}return B}).catch(B=>{c("editing:operation-error","An error occurred.",{error:B});const q={error:B,retry:()=>{k(q,this.failures);return this._queueOperation(m)},cancel:()=>{k(q,this.failures)}};this._set("failures",[...this.failures,q])}).then(()=>{k(m,this._activityQueue);this.notifyChange("syncing")})};z._getEditableItemFromLayer=function(m,k=!0){const {data:B,editing:q,operations:T}=m.capabilities,n=b(this.layerInfos,
m),x=!!B.supportsAttachment&&(!n||!1!==n.allowAttachments),G=q.supportsGeometryUpdate&&(!n||!1!==n.geometryUpdatesEnabled),K=!n||!1!==n.attributeUpdatesEnabled;if(k)return{hasAttachments:x,layer:m,supports:[],geometryUpdatesEnabled:G,attributeUpdatesEnabled:K};k=[];T.supportsAdd&&(this.allowedWorkflows.includes("create")||this.allowedWorkflows.includes("create-features"))&&(!n||!1!==n.enabled&&!1!==n.addEnabled)&&k.push("create");T.supportsUpdate&&this.allowedWorkflows.includes("update")&&(!n||!1!==
n.enabled&&!1!==n.updateEnabled)&&k.push("update");!1!==(n&&n.deleteEnabled)&&T.supportsDelete&&k.push("delete");return{hasAttachments:x,layer:m,supports:k,geometryUpdatesEnabled:G,attributeUpdatesEnabled:K}};g._createClass(p,[{key:"allowedWorkflows",get:function(){return this._get("allowedWorkflows")},set:function(m){m&&0!==m.length||(m=[...H]);this._set("allowedWorkflows",m)}},{key:"canCreate",get:function(){return this.editableItems.some(m=>m.supports.includes("create"))}},{key:"canUpdate",get:function(){return this.editableItems.some(m=>
m.supports.includes("update"))}},{key:"editableItems",get:function(){const m=this.view?.allLayerViews;if(!m)return new f;var k=this.view?.map?.editableLayers;const B=new Set(k);k=k?.filter(T=>T.visible&&T.capabilities.operations.supportsAdd&&!T.capabilities.operations.supportsQuery);const q=m.filter(T=>B.has(T.layer)).map(({layer:T,suspended:n})=>this._getEditableItemFromLayer(T,n)).reverse();k?.forEach(T=>q.push(this._getEditableItemFromLayer(T,!1)));return q}},{key:"labelOptions",get:function(){return this.sketchViewModel.labelOptions},
set:function(m){this.sketchViewModel.labelOptions=m}},{key:"snappingOptions",get:function(){return this.sketchViewModel.snappingOptions},set:function(m){this.sketchViewModel.snappingOptions=m}},{key:"state",get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";var m=this.attachmentsViewModel.mode;if("add"===m)return"adding-attachment";if("edit"===m)return"editing-attachment";({activeWorkflow:m}=this);return m?m.stepId:"ready"}},{key:"syncing",get:function(){return 0<
this._activityQueue.length}},{key:"tooltipOptions",get:function(){return this.sketchViewModel.tooltipOptions},set:function(m){this.sketchViewModel.tooltipOptions=m}},{key:"view",set:function(m){this.sketchViewModel.view=m;this.spinnerViewModel.view=m;this._set("view",m)}}]);return p}(C.HandleOwnerMixin(l.EventedAccessor));u.__decorate([M.property({readOnly:!0})],l.prototype,"activeWorkflow",void 0);u.__decorate([M.property({readOnly:!0})],l.prototype,"_activityQueue",void 0);u.__decorate([M.property({value:[...H]})],
l.prototype,"allowedWorkflows",null);u.__decorate([M.property({readOnly:!0})],l.prototype,"canCreate",null);u.__decorate([M.property({readOnly:!0})],l.prototype,"canUpdate",null);u.__decorate([M.property({readOnly:!0})],l.prototype,"editableItems",null);u.__decorate([M.property({readOnly:!0})],l.prototype,"failures",void 0);u.__decorate([M.property()],l.prototype,"attachmentsViewModel",void 0);u.__decorate([M.property()],l.prototype,"featureFormViewModel",void 0);u.__decorate([M.property()],l.prototype,
"featureTemplatesViewModel",void 0);u.__decorate([M.property()],l.prototype,"labelOptions",null);u.__decorate([M.property()],l.prototype,"layerInfos",void 0);u.__decorate([M.property()],l.prototype,"sketchViewModel",void 0);u.__decorate([M.property()],l.prototype,"snappingOptions",null);u.__decorate([M.property()],l.prototype,"spinnerViewModel",void 0);u.__decorate([M.property()],l.prototype,"state",null);u.__decorate([M.property({readOnly:!0})],l.prototype,"syncing",null);u.__decorate([M.property()],
l.prototype,"tooltipOptions",null);u.__decorate([M.property()],l.prototype,"view",null);return l=u.__decorate([Q.subclass("esri.widgets.Editor.EditorViewModel")],l)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q){O=function(y){function I(R){R=y.call(this,R)||this;R.elevationInfo=null;R.graphics=new L.GraphicsCollection;R.screenSizePerspectiveEnabled=!0;R.type="graphics";R.internal=!1;return R}g._inheritsLoose(I,y);var S=I.prototype;S.destroy=function(){this.removeAll();this.graphics.destroy()};S.add=function(R){this.graphics.add(R);return this};S.addMany=function(R){this.graphics.addMany(R);return this};S.removeAll=function(){this.graphics.removeAll();return this};S.remove=
function(R){this.graphics.remove(R)};S.removeMany=function(R){this.graphics.removeMany(R)};S.on=function(R,D){return y.prototype.on.call(this,R,D)};S.graphicChanged=function(R){this.emit("graphic-update",R)};return I}(M.BlendLayer(h.ScaleRangeLayer(w)));u.__decorate([f.property({type:Q})],O.prototype,"elevationInfo",void 0);u.__decorate([f.property(F.owningCollectionProperty(L.GraphicsCollection,"graphics"))],O.prototype,"graphics",void 0);u.__decorate([f.property({type:["show","hide"]})],O.prototype,
"listMode",void 0);u.__decorate([f.property()],O.prototype,"screenSizePerspectiveEnabled",void 0);u.__decorate([f.property({readOnly:!0})],O.prototype,"type",void 0);u.__decorate([f.property({constructOnly:!0})],O.prototype,"internal",void 0);return O=u.__decorate([C.subclass("esri.layers.GraphicsLayer")],O)})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/uuid ../../core/Logger ../../core/accessorSupport/ensureType ../../core/Error ../../core/has ../../core/accessorSupport/decorators/subclass ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./Workflow ./workflowUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R){var D;const E=Symbol();w=D=function(J){function A(e){e=J.call(this,e)||this;e.type="create-features";e.createFeatureState="create-new";e._featureFormHandle=null;e._visualVariableAttributes={rotation:null,size:null};e._attachmentFileInfos=new Map;e._highlightHandles=new Map;e._preventDefaultActionOnCancel=!1;return e}g._inheritsLoose(A,J);var P=A.prototype;P.updatePendingFeature=function(){var e=g._asyncToGenerator(function*(c,b){this._preventDefaultActionOnCancel=
!0;this.data.viewModel.sketchViewModel.cancel();f.remove(this._lastActiveGraphics,c);return this._startUpdating(c,b)});return function(c,b){return e.apply(this,arguments)}}();A.create=function(e,c,b,r,H){const d=new D({data:new I.CreateFeaturesWorkflowData({creationInfo:l.unwrap(c),viewModel:e}),onCommit:function(){var p=g._asyncToGenerator(function*(z){var m=z.viewModel.sketchViewModel.layer.graphics.toArray();z=z.creationInfo.layer;var k=z.capabilities.editing.supportsGlobalId&&"globalIdField"in
z;const B=d._attachmentFileInfos;0===B.size?yield r(z,{addFeatures:m}):k?(m=d._getAttachmentEditsWithGlobalIds(m,z,B),yield r(z,m,"addAttachments"in m?{globalIdUsed:!0}:void 0)):({addFeatureResults:k}=yield r(z,{addFeatures:m}),m=d._getAddAttachmentsData(m,k,z,B),yield H(z,m))});return function(z){return p.apply(this,arguments)}}()});d._set("steps",this._createWorkflowSteps(d,b));return d};P._fadeExistingFeatures=function(e){if("effect"in e){const b=e.effect;e.effect="saturate(0.6) opacity(0.8)";
return O.makeHandle(()=>e.effect=b)}const c=e.opacity;e.opacity=.7;return O.makeHandle(()=>e.opacity=c)};P._highlight=function(e){const c=this.data.viewModel.view;"3d"===c.type&&this._highlightHandles.set(e,c.highlight(e))};P._removeHighlight=function(e){l.removeMaybe(this._highlightHandles.get(e));this._highlightHandles.delete(e)};P._startCreating=function(){var e=g._asyncToGenerator(function*(c){this.createFeatureState="create-new";return R.startCreatingNewFeature(this.data.viewModel.sketchViewModel,
this.data.creationInfo,c)});return function(c){return e.apply(this,arguments)}}();P._startUpdating=function(){var e=g._asyncToGenerator(function*(c,b){const {featureFormViewModel:r,layerInfos:H,sketchViewModel:d,view:p}=this.data.viewModel,z=this.data.creationInfo.layer,m=R.findLayerInfo(H,z);r.set({arcadeEditType:"INSERT",feature:c,formTemplate:m?.formTemplate,spatialReference:p.spatialReference,view:p});l.removeMaybe(this._featureFormHandle);this._featureFormHandle=O.handlesGroup([r.on("value-change",
g._asyncToGenerator(function*(){c.attributes=r.getValues();yield R.updateGraphicSymbolWhenRequired(c,b)})),d.on(["update","undo","redo"],k=>{("undo"===k.type||"redo"===k.type||"update"===k.type&&l.isSome(k.toolEventInfo)&&R.isTerminalUpdateEventType(k.toolEventInfo.type))&&r.notifyFeatureGeometryChanged()})]);this._removeHighlight(c);this.createFeatureState="update-pending";this._visualVariableAttributes=R.getVisualVariableAttributes(c);return R.startUpdatingFeature(d,c,z,this._visualVariableAttributes,
b)});return function(c,b){return e.apply(this,arguments)}}();A._createWorkflowSteps=function(e,c="awaiting-feature-creation-info"){const {data:b,handles:r}=e;let H=null,d=!0;const p=new Map;c=R.createWorkflowSteps(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],c,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var z=this;return g._asyncToGenerator(function*(){b.creationInfo=null;r.add(b.viewModel.featureTemplatesViewModel.on("select",
({item:m})=>{b.creationInfo={layer:m.layer,template:m.template};b.viewModel.activeWorkflow.next()}),z.id)})()},tearDown(){var z=this;return g._asyncToGenerator(function*(){r.remove(z.id)})()}}),"creating-features":()=>({id:"creating-features",setUp(){var z=this;return g._asyncToGenerator(function*(){if(!r.has(z.id)){var m=b.viewModel.view,k=b.viewModel.sketchViewModel;d=k.updateOnGraphicClick;k.updateOnGraphicClick=!1;e._lastActiveGraphics=[];e._featureFormHandle=l.removeMaybe(e._featureFormHandle);
e._visualVariableAttributes={rotation:null,size:null};var B="2d"===m.type?e._fadeExistingFeatures(b.creationInfo.layer):null,q=k.on("create",function(){var Y=g._asyncToGenerator(function*(ba){if("cancel"===ba.state){if(e._preventDefaultActionOnCancel){e._preventDefaultActionOnCancel=!1;return}if(1>e._lastActiveGraphics.length)return e._startCreating(p);ba=e._lastActiveGraphics.pop();return e._startUpdating(ba,p)}if("complete"===ba.state)return e._startUpdating(ba.graphic,p)});return function(ba){return Y.apply(this,
arguments)}}()),T=k.on("update",function(){var Y=g._asyncToGenerator(function*(ba){var la=ba.graphics[0];if("complete"===ba.state){la!==H&&(e._lastActiveGraphics.push(la),e._highlight(la));H=null;"add"!==b.viewModel.attachmentsViewModel.mode&&"edit"!==b.viewModel.attachmentsViewModel.mode||b.viewModel.activeWorkflow.previous();if(ba.aborted&&e._preventDefaultActionOnCancel){e._preventDefaultActionOnCancel=!1;return}const pa=m.cursor;m.cursor="progress";r.add([O.makeHandle(()=>m.cursor=pa),m.on("click",
va=>va.preventDefault())],E);return C.whenOnce(()=>!b.viewModel.featureFormViewModel.updating).then(()=>{r.remove(E);e._startCreating(p)})}if("start"===ba.state){e._removeHighlight(la);const pa=b.viewModel.attachmentsViewModel;"add"!==pa.mode&&"edit"!==pa.mode||b.viewModel.activeWorkflow.previous();pa.fileInfos.removeAll();pa.graphic=la;pa.mode="view";(e._attachmentFileInfos.get(la)||[]).forEach(({file:va,form:xa})=>pa.addFile(va,xa))}yield R.visualVariableInteractiveUpdate(m,la,ba,e._visualVariableAttributes,
p);ba=la.attributes;l.isSome(e._visualVariableAttributes.rotation)&&({field:la}=e._visualVariableAttributes.rotation,b.viewModel.featureFormViewModel.setValue(la,ba[la]));l.isSome(e._visualVariableAttributes.size)&&({field:la}=e._visualVariableAttributes.size,b.viewModel.featureFormViewModel.setValue(la,ba[la]))});return function(ba){return Y.apply(this,arguments)}}()),n=k.on("delete",function(){var Y=g._asyncToGenerator(function*(ba){ba=ba.graphics[0];f.remove(e._lastActiveGraphics,ba);H=ba});return function(ba){return Y.apply(this,
arguments)}}()),x=null,G=C.watch(()=>{const Y=k.snappingOptions.featureSources.find(ba=>ba.layer===b.creationInfo.layer);return{hasFeatureLayerSource:!!Y,enabled:Y?.enabled??!1}},({hasFeatureLayerSource:Y,enabled:ba})=>{const la=k.snappingOptions.featureSources;Y?(l.isNone(x)&&(x=new y({layer:k.layer,enabled:ba}),la.add(x)),x.enabled=ba):(l.isSome(x)&&la.remove(x),x=l.destroyMaybe(x))},C.syncAndInitial),K=m.on("immediate-click",function(){var Y=g._asyncToGenerator(function*(ba){({results:ba}=yield m.hitTest(ba,
{include:k.layer}));if(ba=ba.find(la=>"graphic"===la.type))ba=ba.graphic,"transform"!==k.activeTool&&"reshape"!==k.activeTool||k.updateGraphics.getItemAt(0)===ba||(yield e.updatePendingFeature(ba,p))});return function(ba){return Y.apply(this,arguments)}}()),U=C.watch(()=>b.viewModel.attachmentsViewModel.mode,Y=>{"add"===Y&&b.viewModel.activeWorkflow.go("adding-attachment");"edit"===Y&&b.viewModel.activeWorkflow.go("editing-attachment")});yield e._startCreating(p);r.add({remove:()=>{l.removeMaybe(e._featureFormHandle);
q.remove();T.remove();n.remove();G.remove();l.isSome(x)&&k.snappingOptions.featureSources.remove(x);x=l.destroyMaybe(x);k.cancel();K.remove();U.remove();l.removeMaybe(B)}},z.id)}})()},tearDown(z){var m=this;return g._asyncToGenerator(function*(){z.cancelled&&(b.viewModel.sketchViewModel.layer.removeAll(),r.remove([m.id,E]),b.viewModel.attachmentsViewModel.fileInfos.removeAll(),e._attachmentFileInfos.clear(),b.viewModel.sketchViewModel.updateOnGraphicClick=d)})()}}),"adding-attachment":()=>({id:"adding-attachment",
parent:"creating-features",setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){const {graphic:z,fileInfos:m}=b.viewModel.attachmentsViewModel;e._attachmentFileInfos.set(z,m.toArray());b.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){const {graphic:z,fileInfos:m}=b.viewModel.attachmentsViewModel;
e._attachmentFileInfos.set(z,m.toArray());b.viewModel.attachmentsViewModel.mode="view"})()}})});return R.avoidFeatureTemplateSelectionWithOnlyOneItem(b,c)};P._getAddAttachmentsData=function(e,c,b,r){const H=[];c.forEach((d,p)=>{if(!d.error){const z=e[p];p=r.get(z)||[];z.attributes[b.objectIdField]=d.objectId;p.forEach(({form:m})=>H.push({feature:z,attachment:m}))}});return H};P._getAttachmentEditsWithGlobalIds=function(e,c,b){const r=[];e.forEach((H,d)=>{const p=b.get(H)||[];let z=H.attributes[c.globalIdField];
l.isNone(z)&&(z=F.generateUUID(),e[d].attributes[c.globalIdField]=z);p.forEach(({file:m})=>r.push({feature:H,attachment:{globalId:F.generateUUID(),data:m}}))});return r.length?{addFeatures:e,addAttachments:r}:{addFeatures:e}};g._createClass(A,[{key:"numPendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics.length}},{key:"pendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics}}]);return A}(S);return w=D=u.__decorate([Q.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],
w)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.layer=null;h.enabled=!0;h.updating=!1;h.availability=1;return h}g._inheritsLoose(M,
w);return M}(f);u.__decorate([O.property({constructOnly:!0})],f.prototype,"layer",void 0);u.__decorate([O.property()],f.prototype,"enabled",void 0);u.__decorate([O.property()],f.prototype,"updating",void 0);u.__decorate([O.property()],f.prototype,"availability",void 0);return f=u.__decorate([F.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],f)})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w){g.CreateFeaturesWorkflowData=function(M){function h(L){L=M.call(this,L)||this;L.creationInfo=null;L.viewModel=null;return L}u._inheritsLoose(h,M);return h}(O);f.__decorate([l.property()],g.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);f.__decorate([l.property()],g.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);g.CreateFeaturesWorkflowData=f.__decorate([w.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],g.CreateFeaturesWorkflowData);Object.defineProperties(g,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F,w,M){O=function(h){function L(y){y=h.call(this,y)||this;y._indexHistory=[];
y._lastStepIndex=-1;y._stepIndex=-1;y._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};y.data=void 0;y.started=!1;y.steps=[];y.type=null;return y}g._inheritsLoose(L,h);var Q=L.prototype;Q.cancel=function(){var y=g._asyncToGenerator(function*(I={force:!0}){return!1!==I.force?this._cancel():new Promise((S,R)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(S)},deny:()=>R(new f("workflow:cancel-denied","Request to cancel workflow was denied."))}})})});return function(){return y.apply(this,
arguments)}}();Q.commit=function(){var y=g._asyncToGenerator(function*(){this.handles.remove(this._handleKeys.beforeCommit);yield this.onCommit(this.data);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit");this.started&&(yield this.reset())});return function(){return y.apply(this,arguments)}}();Q.go=function(){var y=g._asyncToGenerator(function*(I){var {steps:S}=this;S=S.findIndex(R=>R.id===I);this._indexHistory.push(this._stepIndex);yield this._go(S)});return function(I){return y.apply(this,
arguments)}}();Q.next=function(){var y=g._asyncToGenerator(function*(){this._indexHistory.push(this._stepIndex);yield this._go(this._stepIndex+1)});return function(){return y.apply(this,arguments)}}();Q.previous=function(){var y=g._asyncToGenerator(function*(I={cancelCurrentStep:!1}){yield this._go(this._indexHistory.pop(),I.cancelCurrentStep)});return function(){return y.apply(this,arguments)}}();Q.reset=function(){var y=g._asyncToGenerator(function*(){yield this._cancel(!1);yield this.start()});
return function(){return y.apply(this,arguments)}}();Q.start=function(){var y=g._asyncToGenerator(function*(){this._set("started",!0);yield this._go(-1===this._stepIndex?0:this._stepIndex)});return function(){return y.apply(this,arguments)}}();Q._cancel=function(){var y=g._asyncToGenerator(function*(I=!0){this.started&&(this._set("started",!1),yield this.steps[this._stepIndex].tearDown({cancelled:!0}),this.data&&this.data.viewModel.sketchViewModel.layer.removeAll());this.handles.remove([this._handleKeys.afterCommit,
this._handleKeys.beforeCommit]);this._resetIndexing(I);I&&this.emit("cancel")});return function(){return y.apply(this,arguments)}}();Q._go=function(){var y=g._asyncToGenerator(function*(I=-1,S=!1){-1>=I||I>=this.steps.length||(this.started&&(-1<this._lastStepIndex&&(yield this.steps[this._lastStepIndex].tearDown({cancelled:S})),yield this.steps[I].setUp(),this._lastStepIndex=I),this._stepIndex=I,this._notifyStepProps())});return function(){return y.apply(this,arguments)}}();Q._resetIndexing=function(y=
!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;y&&this._notifyStepProps()};Q._notifyStepProps=function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};g._createClass(L,[{key:"hasNextStep",get:function(){const {steps:y}=this;return!!(y&&this._stepIndex<y.filter(I=>!I.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"stepId",get:function(){var {steps:y}=this;return(y=y&&y[this._stepIndex])&&
y.id}}]);return L}(l.HandleOwnerMixin(O.EventedAccessor));u.__decorate([C.property()],O.prototype,"data",void 0);u.__decorate([C.property()],O.prototype,"hasNextStep",null);u.__decorate([C.property()],O.prototype,"hasPreviousStep",null);u.__decorate([C.property()],O.prototype,"onCommit",void 0);u.__decorate([C.property()],O.prototype,"started",void 0);u.__decorate([C.property({readOnly:!0})],O.prototype,"stepId",null);u.__decorate([C.property()],O.prototype,"steps",void 0);u.__decorate([C.property({readOnly:!0})],
O.prototype,"type",void 0);u.__decorate([C.property()],O.prototype,"commit",null);return O=u.__decorate([M.subclass("esri.widgets.Editor.Workflow")],O)})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Graphic ../../core/has ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A){function P(da){const ja=da.sourceLayer;var ha;if(!(ha="feature"!==ja.type)){a:switch(ja.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":ha=!0;break a;default:ha=!1}ha=!ha}if(ha)return{rotation:null,size:null};let Z=ha=null;var ca=ja.renderer.getVisualVariablesForType("rotation").filter(fa=>(!fa.axis||"heading"===fa.axis)&&fa.field&&!fa.valueExpression&&F.isSome(S.getRotationAngle(fa,
da)));1===ca.length&&(ha=e(ca[0],ja));ca=ja.renderer.getVisualVariablesForType("size").filter(fa=>fa.field&&!fa.useSymbolValue&&!fa.valueExpression&&I.getTransformationType(fa)===I.TransformationType.RealWorldSize&&F.isSome(S.getSize(fa,da)));1===ca.length&&(Z=H(ca[0],ja));return{rotation:ha,size:Z}}function e(da,ja){const ha="heading"===(da.axis||"heading")&&"arithmetic"===da.rotationType?-1:1,Z=da.field,ca=(ja=ja.fields&&ja.fields.filter(na=>na.name===Z))&&1===ja.length?ja[0].type:"double";var fa=
0,ea=0;return{field:Z,fieldType:ca,getDefault:()=>Promise.resolve(0),getValue:na=>{ea=fa-ha*na;return d((ea+360)%360,ca)},initValue:na=>{fa=null!=na?na:ea;ea=0},isUpdatingInteractively:!1,rotationType:da.rotationType??"geographic"}}function c(da,ja){switch(ja){case "width":return da[0];case "depth":return da[1];case "height":return da[2];default:return da[2]||da[1]||da[0]}}function b(da,ja,ha){return r.apply(this,arguments)}function r(){r=f._asyncToGenerator(function*(da,ja,ha){if(F.isNone(ja))return 0;
({symbol:ja}=R.to3D(ja));if(F.isNone(ja)||"web-style"===ja.type||"cim"===ja.type)return 0;ja=ja.symbolLayers.getItemAt(0);if(!ja)return 0;switch(ja.type){case "icon":return{computeIconLayerResourceSize:ha}=yield new Promise((ca,fa)=>g(["../../symbols/support/symbolLayerUtils"],ca,fa)),ja.size||Math.min(Da.icon,(yield ha(ja,Da.icon))[0])||Da.icon;case "text":return ja.size||Da.text;case "line":return ja.size||Da.line;case "object":const {computeObjectLayerResourceSize:Z}=yield new Promise((ca,fa)=>
g(["../../symbols/support/symbolLayerUtils"],ca,fa));da=yield Z(ja,da.scale/Da.viewScaleSizeFactor);return c(da,ha);case "path":return(null!=ja.width?ja.width:ja.height)||da.scale/Da.viewScaleSizeFactor;case "extrude":return ja.size||da.scale/Da.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}});return r.apply(this,arguments)}function H(da,ja){const ha=da.field,Z=da.axis,ca=(ja=ja.fields&&ja.fields.filter(ka=>ka.name===ha))&&1===ja.length?ja[0].type:"double";var fa=0,ea=0;const na=
y.meterIn[da.valueUnit]??1;let oa;oa="area"===da.valueRepresentation?ka=>(ka*na/2)**2*Math.PI:"radius"===da.valueRepresentation||"distance"===da.valueRepresentation?ka=>ka*na/2:ka=>ka*na;return{field:ha,fieldType:ca,getDefault:function(){var ka=f._asyncToGenerator(function*(sa,Ca){return d(oa(yield b(Ca,sa,Z)),ca)});return function(sa,Ca){return ka.apply(this,arguments)}}(),getValue:(ka,sa)=>{fa||(fa=sa.pixelSizeAt(sa.center));ea=fa*ka;return d(ea,ca)},initValue:ka=>{fa=null!=ka?ka:ea;ea=0},isUpdatingInteractively:!1,
displayUnit:Ga(da.valueUnit),axis:da.axis}}function d(da,ja){switch(ja){case "small-integer":case "integer":case "long":return Math.round(da);case "double":case "single":return da;default:return 0}}function p(da,ja){return z.apply(this,arguments)}function z(){z=f._asyncToGenerator(function*(da,ja){ja=yield D.getDisplayedSymbol(da,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:ja});const ha=L.diff(da.symbol,ja);F.isSome(ha)&&(da.symbol=ja)});return z.apply(this,arguments)}function m(){m=f._asyncToGenerator(function*(da,
ja,ha,Z){yield k(da,ja,Z);const ca=da.on("create",function(){var fa=f._asyncToGenerator(function*(ea){if("cancel"===ea.state)return k(da,ja,Z);"complete"===ea.state&&(ea=ea.graphic,ea.sourceLayer||(ea.sourceLayer=ja.layer),ea.attributes||(ea.attributes={...ja.template.prototype.attributes}),yield p(ea,Z),ha(ea))});return function(ea){return fa.apply(this,arguments)}}());return{remove:()=>{ca.remove();da.cancel()}}});return m.apply(this,arguments)}function k(da,ja,ha){return B.apply(this,arguments)}
function B(){B=f._asyncToGenerator(function*(da,ja,ha){var Z=ja.layer;ja={...ja.template.prototype.attributes};yield q(da,Z,ja,ha);ha={graphicProperties:{attributes:ja,sourceLayer:Z},hasZ:Z.capabilities.data.supportsZ};da.layer.elevationInfo=Z.elevationInfo;ja=da.create;Z=Z.geometryType;if("mesh"===Z||"multipatch"===Z)throw Error("Mesh and Multipatch not supported");return ja.call(da,Z,ha)});return B.apply(this,arguments)}function q(da,ja,ha,Z){return T.apply(this,arguments)}function T(){T=f._asyncToGenerator(function*(da,
ja,ha,Z){ja=new O({sourceLayer:ja,attributes:ha});const {rotation:ca,size:fa}=P(ja);let ea=yield D.getDisplayedSymbol(ja,{useSourceLayer:!0,webStyleCache:Z}),na=!1;for(const oa of[fa,ca])F.isNone(oa)||null!=ha[oa.field]||(ha[oa.field]=yield oa.getDefault(ea,da.view),na=!0);na&&(ea=yield D.getDisplayedSymbol(ja,{useSourceLayer:!0,webStyleCache:Z}));switch(ea?.type){case "simple-fill":case "polygon-3d":da.polygonSymbol=ea;break;case "simple-line":case "line-3d":da.polylineSymbol=ea;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":da.pointSymbol=
ea}n(da.tooltipOptions,fa,ca)});return T.apply(this,arguments)}function n(da,ja,ha){F.isSome(ja)||F.isSome(ha)?da.visualVariables={size:F.isSome(ja)?{unit:ja.displayUnit,axis:ja.axis,valueType:ja.fieldType}:null,rotation:F.isSome(ha)?{valueType:ha.fieldType,rotationType:ha.rotationType??"geographic"}:null}:da.visualVariables=null}function x(da,ja,ha,Z){return G.apply(this,arguments)}function G(){G=f._asyncToGenerator(function*(da,ja,ha,Z){if(0===da.length)return[];const {updatable:ca,graphicsByLayer:fa}=
yield ha.async(f._asyncToGenerator(function*(){var {results:ea}=yield w.whenOrAbort(A.hitTestSelectSimilarDistance(ja,ha),Z);const na=new Map,oa=({layer:ka})=>{var sa=na.get(ka);return sa?sa:(sa=[],na.set(ka,sa),sa)};A.filterGraphicHits(ea).forEach(({graphic:ka})=>oa(ka).push(ka));ea=da.filter(({supports:ka,layer:sa})=>ka.includes("update")&&na.has(sa));0!==ea.length&&ha.stopPropagation();return{updatable:ea,graphicsByLayer:na}}));return w.whenOrAbort(w.eachAlways(ca.map(function(){var ea=f._asyncToGenerator(function*({layer:na}){var {objectIdField:oa}=
na,ka="displayField"in na?na.displayField:null;const sa=[oa];na.fieldsIndex.has(ka)&&sa.push(ka);oa=fa.get(na);return oa.some(Ca=>sa.some(ya=>!(ya in Ca.attributes)))?(ka=na.createQuery(),ka.outFields=sa,ka.returnGeometry=!1,ka.objectIds=oa.map(Ca=>Ca.getObjectId()),na.queryFeatures(ka,{signal:Z}).then(({features:Ca})=>Ca)):oa});return function(na){return ea.apply(this,arguments)}}())),Z)});return G.apply(this,arguments)}function K(da,ja,ha,Z){return U.apply(this,arguments)}function U(){U=f._asyncToGenerator(function*(da,
ja,ha,Z){if(0===da.length)return[];let ca=null;const fa=yield ha.async(f._asyncToGenerator(function*(){var {results:ea}=yield w.whenOrAbort(ja.hitTest(ha),Z);if(0===ea.length)return[];const na=new Set;ca=A.filterGraphicHits(ea);ca.forEach(({graphic:oa})=>oa&&na.add(oa.layer));ea=da.items.filter(({layer:oa,supports:ka})=>ka.includes("update")&&na.has(oa));0<ea.length&&ha.stopPropagation();return ea}));return w.whenOrAbort(w.eachAlways(fa.map(({layer:ea})=>{const {objectIdField:na}=ea;var oa="displayField"in
ea?ea.displayField:null,ka=[na];ea.fieldsIndex.has(oa)&&ka.push(oa);oa=ea.createQuery();oa.outFields=ka;oa.returnGeometry=!1;ka="renderer"in ea?Q.calculateTolerance({renderer:ea.renderer,event:ha}):0;oa.geometry=J.createQueryGeometry(ha.mapPoint,ka,ja);oa.outSpatialReference=ja.spatialReference;return ea.queryFeatures(oa,{signal:Z}).then(({features:sa})=>{ca.forEach(({graphic:Ca})=>{Ca.layer===ea&&(sa.find(ya=>ya.attributes[na]===Ca.attributes[ea.objectIdField])||sa.push(Ca))});return sa})})),Z)});
return U.apply(this,arguments)}function Y(){Y=f._asyncToGenerator(function*(da,ja,ha,Z){switch(ja.type){case "3d":return x(da,ja,ha,Z);case "2d":return K(da,ja,ha,Z)}});return Y.apply(this,arguments)}function ba(){ba=f._asyncToGenerator(function*(da,ja,ha){const Z=da.layer,ca=Z.createQuery();ca.objectIds=[da.getAttribute(Z.objectIdField)];ca.outFields=["*"];ca.outSpatialReference=ja.spatialReference;ca.returnM=Z.capabilities.data.supportsM;ca.returnZ=Z.capabilities.data.supportsZ;return(yield Z.queryFeatures(ca,
{signal:ha})).features[0]});return ba.apply(this,arguments)}function la(da,ja,ha,Z,ca){return pa.apply(this,arguments)}function pa(){pa=f._asyncToGenerator(function*(da,ja,ha,Z,ca){let fa=!1;const {rotation:ea,size:na}=Z;[ea,na].forEach(function(){var oa=f._asyncToGenerator(function*(ka){if(!F.isNone(ka)){var sa=ja.attributes[ka.field];F.isSome(sa)?ka.initValue(sa):(sa=yield ka.getDefault(ja.symbol,da.view),ka.initValue(sa),ja.setAttribute(ka.field,sa),fa=!0)}});return function(ka){return oa.apply(this,
arguments)}}());fa&&(yield p(ja,ca));Z={multipleSelectionEnabled:!1};"point"===ha.geometryType&&(Z.enableRotation=F.isSome(ea),Z.enableScaling=F.isSome(na));n(da.tooltipOptions,na,ea);da.layer.elevationInfo=ha.elevationInfo;return da.update(ja,Z)});return pa.apply(this,arguments)}function va(da,ja,ha,Z,ca){return xa.apply(this,arguments)}function xa(){xa=f._asyncToGenerator(function*(da,ja,ha,Z,ca){if(F.isSome(ja.geometry)&&"point"===ja.geometry?.type){var fa=Z.rotation;var ea=ha.toolEventInfo;ea=
!F.isSome(ea)||"rotate-start"!==ea.type&&"rotate"!==ea.type&&"rotate-stop"!==ea.type?null:ea;if(F.isSome(fa)&&F.isSome(ea))if("rotate-stop"===ea.type)fa.isUpdatingInteractively=!1,fa.initValue();else{fa.isUpdatingInteractively=!0;const {field:na,getValue:oa}=fa;ja.attributes[na]=oa(ea.angle,da)}Z=Z.size;ha=ha.toolEventInfo;ha=!F.isSome(ha)||"scale-start"!==ha.type&&"scale"!==ha.type&&"scale-stop"!==ha.type?null:ha;if(F.isSome(Z)&&F.isSome(ha))if("scale-stop"===ha.type)Z.isUpdatingInteractively=!1,
Z.initValue();else{Z.isUpdatingInteractively=!0;const {field:na,getValue:oa}=Z;ja.attributes[na]=oa(ha.xScale,da)}yield p(ja,ca)}});return xa.apply(this,arguments)}function Aa(){Aa=f._asyncToGenerator(function*(da,ja,ha,Z,ca,fa){const ea=da.clone();yield p(ea,fa);Z.map.add(ha.layer);ha.layer.add(ea);const na=da.sourceLayer,oa=Z.whenLayerView(na),ka=()=>{const Ta=da.attributes[da.layer.objectIdField];oa.then(Ja=>Ja.setVisibility(Ta,!1),()=>{});return{remove(){oa.then(Ja=>Ja.setVisibility(Ta,!0),()=>
{})}}};let sa=null,Ca=null;if("3d"===Z.type){const Ta=new E.GraphicState({graphic:ea});sa=C.handlesGroup([Z.trackGraphicState(Ta),M.watch(()=>Ta.displaying,Ja=>{Ca=Ja?ka():F.removeMaybe(Ca)},M.initial)])}else Ca=ka();yield la(ha,ea,na,ja,fa);let ya=null;oa.then(Ta=>ya=Ta,()=>{});const za=ja.size,ua=ja.rotation,Ea=M.watch(()=>da.attributes,function(){var Ta=f._asyncToGenerator(function*(Ja){let Qa=!1;for(const qa in Ja){const mb=Ja[qa];mb!==ea.attributes[qa]&&(ea.setAttribute(qa,mb),F.isSome(za)&&
!za.isUpdatingInteractively&&za.field===qa&&za.initValue(mb),F.isSome(ua)&&!ua.isUpdatingInteractively&&ua.field===qa&&ua.initValue(mb),F.isNone(ya)||ya.requiredFields.includes(qa))&&(Qa=!0)}Qa&&(yield p(ea,fa))});return function(Ja){return Ta.apply(this,arguments)}}()),Ia=ha.on("update",function(){var Ta=f._asyncToGenerator(function*(Ja){const Qa=Ja.graphics[0];if("complete"===Ja.state)return la(ha,Qa,na,ja,fa);yield va(Z,Qa,Ja,ja,fa);ca(Qa.clone(),Ja)});return function(Ja){return Ta.apply(this,
arguments)}}()),Na=ha.on(["undo","redo"],function(){var Ta=f._asyncToGenerator(function*(Ja){ca(Ja.graphics[0].clone(),Ja)});return function(Ja){return Ta.apply(this,arguments)}}()),Va=()=>{};return{interactive:{remove(){Na.remove();Ia.remove();ha.cancel();Ea&&Ea.remove();this.remove=Va}},visual:{remove(){F.removeMaybe(Ca);Z.whenLayerView(na).then(Ta=>M.whenOnce(()=>!Ta.updating)).then(()=>{F.removeMaybe(sa);ha.layer.remove(ea);this.remove=Va})}}}});return Aa.apply(this,arguments)}function Ga(da){switch(da){case "unknown":case "decimal-degrees":return null;
default:return da}}const Da={icon:h.px2pt(24),text:h.px2pt(12),line:h.px2pt(1),viewScaleSizeFactor:100};u.avoidFeatureTemplateSelectionWithOnlyOneItem=function(da,ja){da.viewModel.refreshCreationTemplates();if("awaiting-feature-creation-info"===ja[0].id){var ha=da.viewModel.featureTemplatesViewModel.items;1!==ha.length?ha=null:(ha=ha[0],ha="items"in ha?1===ha.items.length?ha.items[0]:null:ha);F.isSome(ha)&&(da.creationInfo={layer:ha.layer,template:ha.template},ja.shift())}return ja};u.createWorkflowSteps=
function(da,ja,ha){let Z=!1;return da.filter(ca=>Z?!0:Z=ca===ja).map(ca=>ha[ca]())};u.fetchCandidates=function(da,ja,ha,Z){return Y.apply(this,arguments)};u.fetchFullFeature=function(da,ja,ha){return ba.apply(this,arguments)};u.findLayerInfo=function(da,ja){return da&&da.find(ha=>ha.layer===ja)};u.getVisualVariableAttributes=P;u.isTerminalUpdateEventType=da=>/-stop/.test(da)||/vertex-/.test(da);u.setUpFeatureAdd=function(da,ja,ha,Z){return m.apply(this,arguments)};u.setUpGeometryUpdate=function(da,
ja,ha,Z,ca,fa){return Aa.apply(this,arguments)};u.sizeDefaults=Da;u.sizeVariableUnitToLengthUnit=Ga;u.startCreatingNewFeature=k;u.startUpdatingFeature=la;u.updateGraphicSymbolWhenRequired=p;u.visualVariableInteractiveUpdate=va;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(g){function u(l,C){return C?"xoffset"in C&&C.xoffset?Math.max(l,Math.abs(C.xoffset)):"yoffset"in C&&
C.yoffset?Math.max(l,Math.abs(C.yoffset||0)):l:l}function f(l,C){if("number"===typeof l)return l;if(l&&l.stops&&l.stops.length){l=l.stops;let F=C=0;for(let w=0;w<l.length;w++){const M=l[w].size;"number"===typeof M&&(C+=M,F++)}return C/F}return C}function O(l,C){if(!C)return l;C=C.filter(M=>"size"===M.type).map(M=>{const {maxSize:h,minSize:L}=M;return(f(h,l)+f(L,l))/2});let F=0;const w=C.length;if(0===w)return l;for(let M=0;M<w;M++)F+=C[M];return Math.max(Math.floor(F/w),l)}g.calculateTolerance=function(l){const C=
l&&l.renderer;l="touch"===(l&&l.event&&l.event.pointerType)?9:6;if(!C)return l;l="visualVariables"in C?O(l,C.visualVariables):l;if("simple"===C.type)return u(l,C.symbol);if("unique-value"===C.type){let F=l;C.uniqueValueInfos?.forEach(w=>{F=u(F,w.symbol)});return F}if("class-breaks"===C.type){let F=l;C.classBreakInfos.forEach(w=>{F=u(F,w.symbol)});return F}return l};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w){g.GraphicState=function(M){function h(L){L=M.call(this,L)||this;L.tracking=!1;L.displaying=!1;L.isDraped=!1;return L}u._inheritsLoose(h,M);return h}(O.EventedAccessor);f.__decorate([l.property({constructOnly:!0})],g.GraphicState.prototype,"graphic",void 0);f.__decorate([l.property()],g.GraphicState.prototype,"tracking",void 0);f.__decorate([l.property()],g.GraphicState.prototype,"displaying",void 0);f.__decorate([l.property()],g.GraphicState.prototype,"isDraped",void 0);
g.GraphicState=f.__decorate([w.subclass("esri.views.3d.layers.graphics.GraphicState")],g.GraphicState);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/drapedUtils":function(){define("exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils ../../geometry/Extent".split(" "),function(g,u,f,O,l,C){function F(M,h,L,Q=new C){let y;if("2d"===L.type)y=h*L.resolution;else if("3d"===L.type){var I=
L.overlayPixelSizeInMapUnits(M),S=L.basemapSpatialReference;y=f.isSome(S)&&!S.equals(L.spatialReference)?O.getMetersPerUnitForSR(S)/O.getMetersPerUnitForSR(L.spatialReference):h*I}h=M.x-y;I=M.y-y;S=M.x+y;M=M.y+y;({spatialReference:L}=L);Q.xmin=Math.min(h,S);Q.ymin=Math.min(I,M);Q.xmax=Math.max(h,S);Q.ymax=Math.max(I,M);Q.spatialReference=L;return Q}const w=new C;g.createQueryGeometry=F;g.intersectsDrapedGeometry=function(M,h,L){M=L.toMap(M);if(f.isNone(M))return!1;const Q=l.calculateTolerance();return F(M,
Q,L,w).intersects(h)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(g,u,f){function O(){O=u._asyncToGenerator(function*(C,F){if("2d"===C.type)return C.hitTest(F);C=yield C.hitTest(F);if(0===C.results.length)return C;F=C.results[0];const w=f.isSome(F.distance)?1.05*F.distance:F.distance;F=C.results.findIndex(M=>M.distance>
w);-1!==F&&(C.results=C.results.slice(0,F));return C});return O.apply(this,arguments)}function l(C){return f.isSome(C)&&"graphic"===C.type}g.filterGraphicHits=function(C){return C.filter(l)};g.findFirstGraphicHit=function(C){return C.find(l)??null};g.hitTestSelectSimilarDistance=function(C,F){return O.apply(this,arguments)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/reactiveUtils ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/Error ../../core/has ../../core/accessorSupport/decorators/subclass ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){var S;l=S=function(R){function D(E){E=R.call(this,E)||this;E.type="create";return E}g._inheritsLoose(D,R);D.create=function(E,J,A){E=new S({data:new L({edits:new Q.Edits,viewModel:E}),onCommit:function(){var P=g._asyncToGenerator(function*(e){yield A(e.creationInfo.layer,{addFeatures:[e.edits.feature]})});return function(e){return P.apply(this,arguments)}}()});E._set("steps",this._createWorkflowSteps(E,J));return E};D._createWorkflowSteps=function(E,J="awaiting-feature-creation-info"){const {data:A,
handles:P}=E,e=new Map;E=I.createWorkflowSteps(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],J,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",setUp(){var c=this;return g._asyncToGenerator(function*(){A.creationInfo=null;A.edits.feature=null;A.viewModel.featureTemplatesViewModel.select(null);P.add(A.viewModel.featureTemplatesViewModel.on("select",({item:b})=>{A.creationInfo={layer:b.layer,
template:b.template};A.viewModel.activeWorkflow.next()}),c.id)})()},tearDown(){var c=this;return g._asyncToGenerator(function*(){P.remove(c.id)})()}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",setUp(){var c=this;return g._asyncToGenerator(function*(){P.add(yield I.setUpFeatureAdd(A.viewModel.sketchViewModel,A.creationInfo,b=>{A.edits.feature=b;A.viewModel.activeWorkflow.next()},e),c.id)})()},tearDown(){var c=this;return g._asyncToGenerator(function*(){P.remove(c.id)})()}}),
"editing-new-feature":()=>({id:"editing-new-feature",setUp(){var c=this;return g._asyncToGenerator(function*(){const b=A.edits.feature,r=b.sourceLayer,H=A.viewModel,d=H.sketchViewModel;var p=I.findLayerInfo(H.layerInfos,r);const {spatialReference:z}=H.view;H.featureFormViewModel.set({arcadeEditType:"INSERT",feature:b,formTemplate:p?.formTemplate,spatialReference:z});d.allowDeleteKey=!1;const m=I.getVisualVariableAttributes(b);yield I.startUpdatingFeature(d,b,r,m,e);p=d.on("update",function(){var k=
g._asyncToGenerator(function*(B){var q=B.graphics[0];if("complete"===B.state)return I.startUpdatingFeature(d,q,r,m,e);yield I.visualVariableInteractiveUpdate(d.view,q,B,m,e);B=q.attributes;f.isSome(m.rotation)&&({field:q}=m.rotation,H.featureFormViewModel.setValue(q,B[q]));f.isSome(m.size)&&({field:q}=m.size,H.featureFormViewModel.setValue(q,B[q]))});return function(B){return k.apply(this,arguments)}}());P.add([A.viewModel.featureFormViewModel.on("value-change",g._asyncToGenerator(function*(){A.edits.updateAttributes(A.viewModel.featureFormViewModel.getValues());
b.attributes=A.edits.feature.attributes;"3d"===d.view.type&&(yield I.updateGraphicSymbolWhenRequired(b,e))})),p,O.watch(()=>A.viewModel.attachmentsViewModel.mode,k=>{"add"===k&&A.viewModel.activeWorkflow.go("adding-attachment");"edit"===k&&A.viewModel.activeWorkflow.go("editing-attachment")})],c.id)})()},tearDown(c){var b=this;return g._asyncToGenerator(function*(){c.cancelled&&A.viewModel.sketchViewModel.layer.removeAll();P.remove(b.id)})()}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",
setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){A.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){A.viewModel.attachmentsViewModel.mode="view"})()}})});return I.avoidFeatureTemplateSelectionWithOnlyOneItem(A,E)};return D}(y);return l=S=u.__decorate([h.subclass("esri.widgets.Editor.CreateWorkflow")],
l)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.creationInfo=null;h.edits=null;h.viewModel=null;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],
f.prototype,"creationInfo",void 0);u.__decorate([O.property()],f.prototype,"edits",void 0);u.__decorate([O.property()],f.prototype,"viewModel",void 0);return f=u.__decorate([F.subclass("esri.widgets.Editor.CreateWorkflowData")],f)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w,M,h){function L(Q){return C.isNone(Q)?null:JSON.stringify(Q)}g.Edits=function(Q){function y(S){S=Q.call(this,S)||this;S._baselineAttributesJSON=null;S._baselineGeometryJSON=null;S.feature=null;return S}u._inheritsLoose(y,Q);var I=y.prototype;I.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=L(this.feature.attributes),this._baselineGeometryJSON=L(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};I.updateAttributes=
function(S){this.feature.attributes=S;this.notifyChange("attributesModified")};I.updateGeometry=function(S){this.feature.geometry=S;this.notifyChange("geometryModified")};u._createClass(y,[{key:"attributesModified",get:function(){const {_baselineAttributesJSON:S,feature:R}=this;return!(!R||S===L(R.attributes))}},{key:"geometryModified",get:function(){const {_baselineGeometryJSON:S,feature:R}=this;return!(!R||S===L(R.geometry))}},{key:"modified",get:function(){return this.attributesModified||this.geometryModified}}]);
return y}(l.HandleOwnerMixin(O));f.__decorate([F.property()],g.Edits.prototype,"attributesModified",null);f.__decorate([F.property()],g.Edits.prototype,"feature",void 0);f.__decorate([F.property()],g.Edits.prototype,"geometryModified",null);f.__decorate([F.property()],g.Edits.prototype,"modified",null);g.Edits=f.__decorate([h.subclass("esri.widgets.Editor.Edits")],g.Edits);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/Error ../../core/has ../../core/accessorSupport/decorators/subclass ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D){var E;F=E=function(J){function A(e){e=J.call(this,e)||this;e.type="update";return e}g._inheritsLoose(A,J);A.create=function(e,c,b){e=new E({data:new S({edits:new I.Edits,viewModel:e}),onCommit:function(){var r=g._asyncToGenerator(function*(H){const d=H.edits.feature,p=d.sourceLayer,z=d.clone();if(!H.edits.attributesModified){const {objectIdField:m}=p;z.attributes={[m]:d.getAttribute(m)}}H.edits.geometryModified||(z.geometry=null);yield b(p,{updateFeatures:[z]})});
return function(H){return r.apply(this,arguments)}}()});e._set("steps",this._createWorkflowSteps(e,c));return e};var P=A.prototype;P.highlight=function(e){var {data:{viewModel:{view:c}}}=this;c=e&&c.allLayerViews.items.find(({layer:b})=>b===e.layer);y.highlightsSupported(c)&&this.handles.add(c.highlight(e),"candidate-highlight")};P.unhighlight=function(){this.handles.remove("candidate-highlight")};A._createWorkflowSteps=function(e,c="awaiting-feature-to-update"){const {data:b,handles:r}=e,H=new Map;
return D.createWorkflowSteps(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],c,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",setUp(){var d=this;return g._asyncToGenerator(function*(){const {spinnerViewModel:p,view:z}=b.viewModel;let m=null;r.add({remove(){m&&(m.abort(),m=null)}},d.id);b.edits.feature=null;const k=z.on("immediate-click",B=>{p.location=B.mapPoint;p.visible=!0;m&&m.abort();const {editableItems:q}=
b.viewModel;m=new AbortController;(new Promise((T,n)=>{l.onAbort(m.signal,()=>n(l.createAbortError()));T(D.fetchCandidates(q,z,B,m.signal))})).then(T=>{l.throwIfAborted(m);b.candidates=T.reduce((n,x)=>x.error?n:[...n,...x.value],[]);b.viewModel.spinnerViewModel.visible=1===b.candidates.length;0!==b.candidates.length&&(1===b.candidates.length?(b.edits.feature=b.candidates[0],b.viewModel.activeWorkflow.go("editing-existing-feature").catch(()=>{}).then(()=>b.viewModel.spinnerViewModel.visible=!1)):b.viewModel.activeWorkflow.next())})});
z.focus();r.add(k,d.id)})()},tearDown(){var d=this;return g._asyncToGenerator(function*(){r.remove(d.id)})()}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",setUp(){var d=this;return g._asyncToGenerator(function*(){const {edits:p}=b;p.feature=null;r.add(C.watch(()=>p.feature,z=>{e.unhighlight();e.highlight(z)}),d.id)})()},tearDown(){var d=this;return g._asyncToGenerator(function*(){e.unhighlight();r.remove(d.id)})()}}),"editing-existing-feature":()=>({id:"editing-existing-feature",
setUp(){var d=this;return g._asyncToGenerator(function*(){if(!r.has("editing-existing-feature")){var p=b.edits.feature,{attachmentsViewModel:z,editableItems:m,featureFormViewModel:k,layerInfos:B,sketchViewModel:q,view:T}=b.viewModel;b.editableItem=m.find(Y=>Y.layer===p.layer);var n=new AbortController;r.add({remove:()=>n.abort()},d.id);var x=T.whenLayerView(p.layer),G=D.fetchFullFeature(p,T,n.signal);x=yield x;var K=yield G;if(!l.isAborted(n)){b.edits.updateGeometry(K.geometry);b.edits.updateAttributes(K.attributes);
b.edits.trackChanges();z.set({graphic:K,mode:"view"});G=D.findLayerInfo(B,K.sourceLayer);k.set({arcadeEditType:"UPDATE",feature:K,formTemplate:G?.formTemplate,spatialReference:T.spatialReference,view:T});var U="createInteractiveEditSession"in x?x.createInteractiveEditSession(p):null;G=[k.on("value-change",Y=>{b.edits.updateAttributes(k.getValues());K.attributes=b.edits.feature.attributes;U&&U.setAttribute(Y.fieldName,Y.value)}),C.watch(()=>z.mode,Y=>{"add"===Y&&b.viewModel.activeWorkflow.go("adding-attachment");
"edit"===Y&&b.viewModel.activeWorkflow.go("editing-attachment")})];U&&(G.push(f.makeHandle(()=>U.rollback())),r.add(f.makeHandle(()=>U.commit()),e._handleKeys.afterCommit));if(b.editableItem.geometryUpdatesEnabled){q.allowDeleteKey=!1;const Y=D.getVisualVariableAttributes(K),{interactive:ba,visual:la}=yield D.setUpGeometryUpdate(K,Y,q,T,({geometry:pa,attributes:va},xa)=>{if(O.isSome(Y.rotation)){var {field:Aa}=Y.rotation;k.setValue(Aa,va[Aa])}O.isSome(Y.size)&&({field:Aa}=Y.size,k.setValue(Aa,va[Aa]));
b.edits.updateAttributes(va);b.edits.updateGeometry(pa);k.feature.geometry=pa;("undo"===xa.type||"redo"===xa.type||"update"===xa.type&&O.isSome(xa.toolEventInfo)&&D.isTerminalUpdateEventType(xa.toolEventInfo.type))&&k.notifyFeatureGeometryChanged()},H);G.push(ba,la);r.add(ba,e._handleKeys.beforeCommit);r.add(la,e._handleKeys.afterCommit)}else e.highlight(K);r.add(G,d.id)}}})()},tearDown({cancelled:d}){var p=this;return g._asyncToGenerator(function*(){d&&(e.unhighlight(),r.remove(p.id))})()}}),"adding-attachment":()=>
({id:"adding-attachment",parent:"editing-existing-feature",setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){b.viewModel.attachmentsViewModel.mode="view"})()}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",setUp(){return g._asyncToGenerator(function*(){})()},tearDown(){return g._asyncToGenerator(function*(){b.viewModel.attachmentsViewModel.mode="view"})()}})})};return A}(R);return F=E=u.__decorate([Q.subclass("esri.widgets.Editor.UpdateWorkflow")],
F)})},"esri/views/support/layerViewUtils":function(){define(["exports","../../core/maybe"],function(g,u){g.extractSafeScaleBounds=function(f){f=f.effectiveScaleRange;return{minScale:f?.minScale??0,maxScale:f?.maxScale??0}};g.highlightsSupported=function(f){return f&&"function"===typeof f.highlight};g.isScaleRangeActive=function(f,O){return 0<f||0<O};g.occludeesSupported=function(f){return f&&"function"===typeof f.maskOccludee};g.scaleBoundsPredicate=function(f,O,l){return u.isNone(f)||f>l&&(0===O||
f<O)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.candidates=null;h.editableItem=
null;h.edits=null;h.viewModel=null;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property()],f.prototype,"candidates",void 0);u.__decorate([O.property()],f.prototype,"editableItem",void 0);u.__decorate([O.property()],f.prototype,"edits",void 0);u.__decorate([O.property()],f.prototype,"viewModel",void 0);return f=u.__decorate([F.subclass("esri.widgets.Editor.UpdateWorkflowData")],f)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/has ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/projection ../../geometry/projectionEllipsoid ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e,c,b,r,H,d,p,z,m,k,B,q,T,n,x,G,K,U){function Y(da){return"polygon"===da||"rectangle"===da||"circle"===da?!0:!1}function ba(da,ja){pa("undo",da.history.undo,da.history.redo,ja)}function la(da,ja){pa("redo",da.history.redo,da.history.undo,ja)}function pa(da,ja,ha,Z){const ca=ja.pop().updates,fa=[];Z.forEach((ea,na)=>{na=ca[na];null!=na&&("geometry"in na&&L.isSome(na.geometry)&&(fa.push({geometry:ea.geometry}),ea.geometry=na.geometry),"symbol"in na&&
L.isSome(na.symbol)&&(fa.push({symbol:ea.symbol}),ea.symbol=na.symbol),"undo"in na&&(fa.push(na),na[da](ea)))});ha.push({updates:fa})}function va(da){return{updates:da.map(ja=>({geometry:ja.geometry}))}}function xa(da){return"requireError"in da&&"aborted"===da.requireError}const Aa=da=>Object.freeze(Object.defineProperty({__proto__:null,default:da},Symbol.toStringTag,{value:"Module"})),Ga={defaultZ:0},Da={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,
enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};C=function(da){function ja(Z){Z=da.call(this,Z)||this;Z._numUpdating=0;Z._handles=new M;Z._internalGraphicsLayer=new e({listMode:"hide",internal:!0,title:"SVM Internal"});Z._operationHandle=null;Z._viewHandles=new M;Z.activeFillSymbol=null;Z.activeLineSymbol=null;Z.activeVertexSymbol=null;Z.allowDeleteKey=!0;Z.labelOptions=new m;Z.layer=null;Z.pointSymbol=new G({style:"circle",
size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});Z.polygonSymbol=new K({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});Z.polylineSymbol=new U({color:[130,130,130,1],width:2});Z._snappingManager=null;Z.tooltipOptions=new k;Z.updateGraphics=new l;Z.updateOnGraphicClick=!0;Z.updatePointSymbol=new G({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});Z.updatePolygonSymbol=new K({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});Z.updatePolylineSymbol=
new U({color:[12,207,255],width:2});Z.vertexSymbol=new G({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});Z._moduleLoaderAbortController=null;Z._viewReadyAbortController=null;Z._originalAutoOpenEnabled=null;Z.defaultCreateOptions=Ga;Z.defaultUpdateOptions=Da;Z.snappingOptions=new q;return Z}u._inheritsLoose(ja,da);var ha=ja.prototype;ha.initialize=function(){this._handles.add([y.on(()=>this.view?.map?.layers,"change",Z=>{Z.removed.includes(this.layer)&&this.cancel()}),
y.on(()=>this.layer?.graphics,"change",Z=>{if(L.isSome(this._operationHandle))for(const ca of Z.removed)this.updateGraphics.includes(ca)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(ca):this._operationHandle.cancel())}),y.watch(()=>this.layer?.elevationInfo??null,Z=>{Z!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=Z)},y.syncAndInitial),y.watch(()=>this.view,Z=>{L.destroyMaybe(this._snappingManager);Z&&(this._snappingManager=
new B.SnappingManager({view:Z,options:this.snappingOptions}),"2d"===Z.type?new Promise((ca,fa)=>g(["../../views/2d/interactive/editingTools"],ca,fa)):"3d"===Z.type&&(new Promise((ca,fa)=>g(["../../views/3d/interactive/editingTools"],ca,fa)),new Promise((ca,fa)=>g(["../../views/3d/layers/GraphicsLayerView3D"],ea=>ca(Aa(ea)),fa))))},y.syncAndInitial),y.watch(()=>this.view?.spatialReference,(Z,ca)=>{Z&&ca&&!Z.equals(ca)&&this.cancel()})])};ha.destroy=function(){this.cancel();this._handles=L.destroyMaybe(this._handles);
this._viewHandles=L.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=L.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};ha.cancel=function(){this._moduleLoaderAbortController=L.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=L.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};ha.complete=function(){this._operationHandle&&this._operationHandle.complete()};ha.delete=
function(){const {state:Z,updateGraphics:ca}=this;if("active"===Z&&ca.length){const {activeTool:fa,layer:ea}=this,na=ca.toArray();ea.removeMany(na);this.cancel();this._emitDeleteEvent({graphics:na,tool:fa})}};ha.create=function(){var Z=u._asyncToGenerator(function*(ca,fa){this.cancel();yield this._waitViewReady();if("disabled"===this.state)throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property",
"Property 'view' is missing on SketchViewModel."),Q.createAbortError();L.isSome(this.view.activeTool)&&(this.view.activeTool=null);if(ca){d.addUniqueLayer(this.view,this._internalGraphicsLayer);var ea=yield this._setupCreateOperation(ca,fa);L.isNone(ea)||this.destroyed?this.view.map.remove(this._internalGraphicsLayer):(ea.on("complete",()=>{if(ea===this._operationHandle){const na=this.createGraphic,oa=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",
null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);ea.cancelled||null==na||this.layer.add(na);this.emit("create",{graphic:na,state:oa?"cancel":"complete",tool:ca,toolEventInfo:null,type:"create"})}}),this._operationHandle=ea,this.view.ready&&this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")});return function(ca,fa){return Z.apply(this,arguments)}}();ha.update=function(){var Z=u._asyncToGenerator(function*(ca,fa){this.cancel();
yield this._waitViewReady();const {layer:ea,view:na,state:oa}=this;if("disabled"===oa)throw na||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),ea||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),Q.createAbortError();L.isSome(this.view.activeTool)&&(this.view.activeTool=null);const ka=Array.isArray(ca)?ca:[ca];null!=ca&&ka&&ka.length?ka.some(sa=>sa.layer!==ea?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):L.isNone(sa.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(ca=yield this._setupUpdateOperation(ka,fa),this.destroyed||L.isNone(ca)||xa(ca)||(d.addUniqueLayer(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(ca,fa),this.emit("update",{graphics:ka,state:"start",aborted:!1,tool:ca.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")});
return function(ca,fa){return Z.apply(this,arguments)}}();ha._updateSpatialReference=function(){var Z=u._asyncToGenerator(function*(ca){this._beginAsyncOperation();ca=Array.isArray(ca)?ca:[ca];for(const fa of ca)L.isSome(fa.geometry)&&"mesh"!==fa.geometry.type&&!P.equals(fa.geometry.spatialReference,this.view.spatialReference)&&(E.canProjectWithoutEngine(fa.geometry.spatialReference,this.view.spatialReference)||E.isLoaded()||(yield E.load()),fa.geometry=E.project(fa.geometry,this.view.spatialReference));
this._endAsyncOperation()});return function(ca){return Z.apply(this,arguments)}}();ha.undo=function(){this.canUndo()&&this._operationHandle.undo()};ha.redo=function(){this.canRedo()&&this._operationHandle.redo()};ha.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};ha.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};ha.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};
ha._getFirstHit=function(){var Z=u._asyncToGenerator(function*(ca){var fa=this.view;if("2d"===fa.type){const na=[];this.view.map.allLayers.forEach(oa=>{"vector-tile"!==oa.type&&"imagery"!==oa.type||na.push(oa)});fa=yield this.view.hitTest(ca,{exclude:na});return T.findFirstGraphicHit(fa.results)}const ea=[this.view.map.ground];fa.map.allLayers.forEach(na=>{"integrated-mesh"===na.type&&ea.push(na)});ca=yield fa.hitTest(ca,{exclude:ea});if(0<ca.results.length){const na=ca.results[0];if(L.isSome(na)&&
"graphic"===na.type&&na.graphic&&(!ca.ground.mapPoint||1>fa.map.ground.opacity||ca.ground.distance-L.unwrapOr(na.distance,0)>-Math.min(3*ca.ground.distance,"global"===fa.viewingMode?J.getReferenceEllipsoid(fa.renderCoordsHelper.spatialReference).radius/fa.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return na}return null});return function(ca){return Z.apply(this,arguments)}}();ha._generateViewHandles=function(Z){var ca=this;return[Z.on("immediate-click",function(){var fa=u._asyncToGenerator(function*(ea){var na=
"active"===ca.state&&"create"===ca._operationHandle.type;if("disabled"!==ca.state&&!na&&ca.updateOnGraphicClick){ca._beginAsyncOperation();var oa=yield ea.async(()=>ca._getFirstHit(n.createScreenPointFromEvent(ea)));na=null;L.isSome(oa)?(oa=oa.graphic,ca.updateGraphics.includes(oa)||oa.layer===ca.layer?(ea.stopPropagation(),na=oa):"2d"!==Z.type||ca._isComponentGraphic(oa)||"active"!==ca.state||ca.cancel()):"active"===ca.state&&ca.cancel();L.isSome(na)&&!ca.updateGraphics.includes(na)&&(yield ca.update([na],
{...ca.defaultUpdateOptions,reshapeOptions:{...ca.defaultUpdateOptions.reshapeOptions}}));ca._endAsyncOperation()}});return function(ea){return fa.apply(this,arguments)}}(),p.ViewEventPriorities.WIDGET)]};ha._setupCreateOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa){ca=yield this._setupDrawGraphicTool(ca,this.view,{hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...fa});if(L.isNone(ca))return null;this.view.tools.add(ca);this.view.activeTool=ca;return this._setupCreateOperationHandle(ca)});
return function(ca,fa){return Z.apply(this,arguments)}}();ha._setupDrawGraphicTool=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){if("multipoint"===ca&&"3d"===fa.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;const na="rectangle"!==ca,oa="rectangle"!==ca;this.snappingOptions.enabledToggled=!1;ca={view:fa,mode:"rectangle"===ca||"circle"===ca?"hybrid":"click",...ea,snapToScene:!1,geometryType:ca,graphicSymbol:this._getGraphicSymbolFromTool(ca),
snappingManager:this._snappingManager,forceUniformSize:oa,centered:na};return"2d"===this.view.type?this._makeDrawGraphicTool2D(ca):this._makeDrawGraphicTool3D(ca)});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._makeDrawGraphicTool2D=function(){var Z=u._asyncToGenerator(function*(ca){const fa=yield this._requireModule(new Promise((ea,na)=>g(["../../views/2d/interactive/editingTools"],ea,na)));return xa(fa)||this.destroyed?null:new fa.module.DrawGraphicTool2D({...ca,activeVertexSymbol:this.activeVertexSymbol,
regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Y(ca.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})});return function(ca){return Z.apply(this,arguments)}}();ha._makeDrawGraphicTool3D=function(){var Z=u._asyncToGenerator(function*(ca){const fa=yield this._requireModule(new Promise((na,oa)=>g(["../../views/3d/interactive/editingTools"],na,oa)));if(xa(fa)||this.destroyed)return null;const {elevationInfo:ea}=this.layer;return new fa.module.DrawGraphicTool3D({...ca,
elevationInfo:ea,snapToScene:L.isSome(ea)?"absolute-height"===ea.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})});return function(ca){return Z.apply(this,arguments)}}();ha._setupCreateOperationHandle=function(Z){let ca=null;const fa=Z.forceUniformSize,ea=Z.centered,na=[this.view.on("key-down",ka=>{if(ka.key===z.SKETCH_KEYS.pan)ka.stopPropagation(),ka.repeat||(Z.enabled=!1);else if(ka.key===z.SKETCH_KEYS.complete)ka.stopPropagation(),Z.completeCreateOperation();else if(ka.key!==
z.SKETCH_KEYS.vertexAdd||ka.repeat)ka.key===z.SKETCH_KEYS.undo?(ka.stopPropagation(),oa.undo()):ka.key===z.SKETCH_KEYS.redo?(ka.stopPropagation(),oa.redo()):ka.key!==z.SKETCH_KEYS.snappingToggle||"rectangle"===Z.geometryType||"circle"===Z.geometryType||ka.repeat?ka.key!==z.SKETCH_KEYS.constraint||"rectangle"!==Z.geometryType&&"circle"!==Z.geometryType||ka.repeat?ka.key!==z.SKETCH_KEYS.center||ka.repeat||(Z.centered=!ea,ka.stopPropagation()):(Z.forceUniformSize=!fa,ka.stopPropagation()):(this.snappingOptions.enabledToggled=
!0,ka.stopPropagation());else{const sa=Z.drawOperation.geometryType;if("polyline"===sa||"polygon"===sa||"multipoint"===sa)ka.stopPropagation(),Z.drawOperation.commitStagedVertex()}},p.ViewEventPriorities.WIDGET),this.view.on("key-up",ka=>{ka.key===z.SKETCH_KEYS.pan?Z.enabled=!0:ka.key===z.SKETCH_KEYS.snappingToggle&&"rectangle"!==Z.geometryType&&"circle"!==Z.geometryType?(this.snappingOptions.enabledToggled=!1,ka.stopPropagation()):ka.key!==z.SKETCH_KEYS.constraint||"rectangle"!==Z.geometryType&&
"circle"!==Z.geometryType?ka.key===z.SKETCH_KEYS.center&&(Z.centered=ea,ka.stopPropagation()):(Z.forceUniformSize=fa,ka.stopPropagation())},p.ViewEventPriorities.WIDGET),Z.on("vertex-add",ka=>{ca=L.isNone(ca)?"start":"active";switch(ka.operation){case "apply":this.emit("create",{graphic:L.unwrap(Z.graphic),state:ca,tool:this.activeTool,toolEventInfo:ka,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[L.unwrap(Z.graphic)],tool:Z.geometryType});break;case "redo":this._emitRedoEvent({graphics:[L.unwrap(Z.graphic)],
tool:Z.geometryType})}}),Z.on("cursor-update",ka=>{0<Z.drawOperation.numCommittedVertices&&this.emit("create",{graphic:L.unwrap(Z.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ka.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),Z.on("vertex-remove",ka=>{switch(ka.operation){case "apply":this.emit("create",{graphic:L.unwrap(Z.graphic),state:"active",tool:this.activeTool,toolEventInfo:ka,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[L.unwrap(Z.graphic)],
tool:Z.geometryType});break;case "redo":this._emitRedoEvent({graphics:[L.unwrap(Z.graphic)],tool:Z.geometryType})}}),Z.on("complete",ka=>{this._set("createGraphic",L.unwrap(ka.graphic));ca="complete";ka.aborted?oa&&oa.cancel():oa&&oa.complete()}),y.watch(()=>this._getGraphicSymbolFromTool(Z.geometryType),ka=>{Z.graphicSymbol=ka})],oa=new x.CreateOperationHandle({activeComponent:Z,tool:Z.geometryType,type:"create",onEnd:()=>{na.forEach(ka=>ka.remove());na.length=0;this.view.tools?.remove(Z)},undo:()=>
{Z.canUndo&&Z.undo()},redo:()=>{Z.canRedo&&Z.redo()},canUndo:()=>Z.canUndo,canRedo:()=>Z.canRedo});return oa};ha._getGraphicSymbolFromTool=function(Z){switch(Z){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;default:return null}};ha._setupUpdateOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa){const {layer:ea,view:na}=this;fa={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,
...fa,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...fa?.reshapeOptions}};var oa=fa.tool;for(var ka of ca)ea.remove(ka),ea.add(ka);if("3d"===na.type){if(0===ca.length)return null;switch(oa){case "move":return this._setupMove3DOperation(ca,fa,na,oa);case "reshape":if(1<ca.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;oa=r.isSupportedGraphic(ca[0]);if(oa===c.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(ca[0],
fa,na);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(oa)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(ca,fa,na)}}switch(oa){case "move":return this._setupMove2DOperation(ca,fa,na);case "reshape":if(1<ca.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ka=r.isSupportedGraphic(ca[0]);if(ka===c.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(ca,
oa,fa,na);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ka)}).`);return null;case "transform":return 1===ca.length&&(ka=L.get(ca[0].geometry,"type"),"point"===ka||"multipoint"===ka)&&(oa="reshape"),this._setupTransformOrReshape2DOperation(ca,oa,fa,na)}});return function(ca,fa){return Z.apply(this,arguments)}}();ha._setupMove3DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea,na,oa=!1){var ka=this;for(var sa of ca){const ua=
b.isSupportedGraphic(sa);if(ua!==c.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ua)}).`),null}sa=yield this._requireModule(new Promise((ua,Ea)=>g(["../../views/3d/interactive/editingTools"],ua,Ea)));if(xa(sa))return sa;const Ca=new sa.module.GraphicMoveTool({view:ea,enableZ:fa.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(Ca);Ca.graphics.addMany(ca);
oa||this.updateGraphics.addMany(ca);const ya=[],za=new x.UpdateOperationHandle({activeComponent:Ca,tool:na,type:"update",onEnd:()=>{ya.forEach(ua=>ua.remove());ya.length=0;this.view.tools?.remove(Ca);Ca.destroyed||Ca.destroy()},undo:()=>{ba(za,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:na})},redo:()=>{la(za,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:na})},addToSelection:ua=>{this.updateGraphics.push(ua);
Ca.graphics.push(ua);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ua],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ua=>{const Ea=this.updateGraphics.indexOf(ua);za.history.undo.forEach(Ia=>Ia.updates.splice(Ea,1));za.history.redo.forEach(Ia=>Ia.updates.splice(Ea,1));this.updateGraphics.remove(ua);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[ua],type:"selection-change"},type:"update"});0===this.updateGraphics.length?za.complete():Ca.graphics.remove(ua)},toggleTool:function(){var ua=u._asyncToGenerator(function*(){if(1===ka.updateGraphics.length&&!1!==fa.toggleToolOnClick&&"transform"===na){var Ea=ka.updateGraphics.getItemAt(0);r.isSupportedGraphic(Ea)===c.SupportedGraphicResult.SUPPORTED&&(Ea=yield ka._setupReshape3DOperation(Ea,fa,ea,!0),xa(Ea)||(za.onEnd(),za.destroy(),ka._setUpdateOperationHandle(Ea,
fa)))}});return function(){return ua.apply(this,arguments)}}()});ya.push(...this._getHandlesForComponent(za,fa),this.view.on("immediate-click",ua=>this._getCommonUpdateOperationClickHandlers(za,ua,fa),p.ViewEventPriorities.WIDGET),ea.on("key-down",ua=>{this._getCommonUpdateOperationKeyDownHandlers(za,ua);ua.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,ua.stopPropagation())},p.ViewEventPriorities.WIDGET),ea.on("key-up",ua=>{ua.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=
!1,ua.stopPropagation())},p.ViewEventPriorities.WIDGET));return za});return function(ca,fa,ea,na){return Z.apply(this,arguments)}}();ha._setupGraphicTransform3DOperation=function(Z,ca,fa,ea=!1){if(1===Z.length&&H.isSupportedGraphic(Z[0])===c.SupportedGraphicResult.SUPPORTED){const na=Z[0],oa=na.geometry;if(L.isSome(oa)&&("point"===oa.type||"mesh"===oa.type))return this._setupPointTransform3DOperation(na,ca,fa);if(L.isSome(oa)&&("polygon"===oa.type||"polyline"===oa.type))return this._setupPolyTransform3DOperation(na,
ca,fa,ea)}return this._setupMove3DOperation(Z,ca,fa,"transform",ea)};ha._setupPointTransform3DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){var na=this;const {enableRotation:oa,enableScaling:ka,enableZ:sa}=fa,Ca=yield this._requireModule(new Promise((Ea,Ia)=>g(["../../views/3d/interactive/editingTools"],Ea,Ia)));if(xa(Ca))return Ca;const ya=new Ca.module.GraphicTransformTool({graphic:ca,view:ea,enableRotation:oa,enableScaling:ka,enableZ:sa,snappingManager:this._snappingManager,
tooltipOptions:this.tooltipOptions});this.view.tools.add(ya);this.updateGraphics.add(ca);const za=[],ua=new x.UpdateOperationHandle({activeComponent:ya,tool:"transform",type:"update",onEnd:()=>{za.forEach(Ea=>Ea.remove());za.length=0;this.view.tools?.remove(ya);ya.destroyed||ya.destroy()},undo:()=>{ba(ua,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{la(ua,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},addToSelection:function(){var Ea=u._asyncToGenerator(function*(Ia){na.updateGraphics.add(Ia);na.emit("update",{graphics:na.updateGraphics.toArray(),state:"active",aborted:!1,tool:na.activeTool,toolEventInfo:{added:[Ia],removed:[],type:"selection-change"},type:"update"});Ia=yield na._setupMove3DOperation(na.updateGraphics.toArray(),fa,ea,"transform",!0);xa(Ia)||(ua.onEnd(),ua.destroy(),na._setUpdateOperationHandle(Ia,fa))});return function(Ia){return Ea.apply(this,arguments)}}(),
removeFromSelection:Ea=>{this.updateGraphics.remove(Ea);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Ea],type:"selection-change"},type:"update"});ua.complete()},toggleTool:()=>{}});za.push(...this._getHandlesForComponent(ua,fa),this.view.on("immediate-click",Ea=>this._getCommonUpdateOperationClickHandlers(ua,Ea,fa),p.ViewEventPriorities.WIDGET),ea.on("key-down",Ea=>{this._getCommonUpdateOperationKeyDownHandlers(ua,
Ea);Ea.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,Ea.stopPropagation())},p.ViewEventPriorities.WIDGET),ea.on("key-up",Ea=>{Ea.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,Ea.stopPropagation())},p.ViewEventPriorities.WIDGET));return ua});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._setupPolyTransform3DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea,na=!1){var oa=this;const {enableRotation:ka,enableScaling:sa,
enableZ:Ca,preserveAspectRatio:ya}=fa,za=yield this._requireModule(new Promise((Na,Va)=>g(["../../views/3d/interactive/editingTools"],Na,Va)));if(xa(za))return za;const ua=new za.module.ExtentTransformTool({graphic:ca,view:ea,enableRotation:ka,enableScaling:sa,enableZ:Ca,preserveAspectRatio:ya,tooltipOptions:this.tooltipOptions});this.view.tools.add(ua);na||this.updateGraphics.add(ca);const Ea=[],Ia=new x.UpdateOperationHandle({activeComponent:ua,tool:"transform",type:"update",onEnd:()=>{Ea.forEach(Na=>
Na.remove());Ea.length=0;this.view.tools?.remove(ua);ua.destroyed||ua.destroy()},canUndo:()=>ua.canUndo,undo:()=>{ua.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>ua.canRedo,redo:()=>{ua.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var Na=u._asyncToGenerator(function*(Va){oa.updateGraphics.add(Va);oa.emit("update",{graphics:oa.updateGraphics.toArray(),state:"active",aborted:!1,
tool:oa.activeTool,toolEventInfo:{added:[Va],removed:[],type:"selection-change"},type:"update"});Va=yield oa._setupMove3DOperation(oa.updateGraphics.toArray(),fa,ea,"transform",!0);xa(Va)||(Ia.onEnd(),Ia.destroy(),oa._setUpdateOperationHandle(Va,fa))});return function(Va){return Na.apply(this,arguments)}}(),removeFromSelection:Na=>{this.updateGraphics.remove(Na);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Na],
type:"selection-change"},type:"update"});Ia.complete()},toggleTool:function(){var Na=u._asyncToGenerator(function*(){if(1===oa.updateGraphics.length&&!1!==fa.toggleToolOnClick){var Va=oa.updateGraphics.getItemAt(0);r.isSupportedGraphic(Va)===c.SupportedGraphicResult.SUPPORTED&&(Va=yield oa._setupReshape3DOperation(Va,fa,ea,!0),xa(Va)||(Ia.onEnd(),Ia.destroy(),oa._setUpdateOperationHandle(Va,fa)))}});return function(){return Na.apply(this,arguments)}}()});Ea.push(...this._getHandlesForComponent(Ia,
fa),this.view.on("immediate-click",Na=>this._getCommonUpdateOperationClickHandlers(Ia,Na,fa),p.ViewEventPriorities.WIDGET),this.view.on("key-down",Na=>this._getCommonUpdateOperationKeyDownHandlers(Ia,Na),p.ViewEventPriorities.WIDGET),this.view.on("key-down",Na=>{Na.key!==z.SKETCH_KEYS.constraint||Na.repeat||(ua.preserveAspectRatio=!ua.preserveAspectRatio,Na.stopPropagation())},p.ViewEventPriorities.WIDGET),this.view.on("key-up",Na=>{Na.key===z.SKETCH_KEYS.constraint&&(ua.preserveAspectRatio=!ua.preserveAspectRatio,
Na.stopPropagation())},p.ViewEventPriorities.WIDGET));return Ia});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._setupMove2DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){var na=this;this.updateGraphics.addMany(ca);yield this._updateSpatialReference(ca);const oa=yield this._getGraphicMover(ca,fa,ea);if(xa(oa))return oa;const ka=new x.UpdateOperationHandle({activeComponent:oa,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();ya.forEach(za=>za.remove());
Ca.forEach(za=>za.remove());ya=[];Ca=[];oa.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const za=this.updateGraphics.toArray();ba(ka,za);ka.refreshComponent();this._emitUndoEvent({graphics:za,tool:"move"})},redo:()=>{const za=this.updateGraphics.toArray();la(ka,za);ka.refreshComponent();this._emitRedoEvent({graphics:za,tool:"move"})},addToSelection:function(){var za=u._asyncToGenerator(function*(ua){yield na._updateSpatialReference(ua);na.updateGraphics.push(ua);
oa.graphics=na.updateGraphics.toArray();na.emit("update",{graphics:na.updateGraphics.toArray(),state:"active",aborted:!1,tool:na.activeTool,toolEventInfo:{added:[ua],removed:[],type:"selection-change"},type:"update"})});return function(ua){return za.apply(this,arguments)}}(),removeFromSelection:za=>{const ua=this.updateGraphics.indexOf(za);ka.history.undo.forEach(Ia=>Ia.updates.splice(ua,1));ka.history.redo.forEach(Ia=>Ia.updates.splice(ua,1));this.updateGraphics.remove(za);const Ea=this.updateGraphics.toArray();
this.emit("update",{graphics:Ea,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[za],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ka.complete():oa.graphics=Ea}});let sa=!1,Ca=[ea.on("immediate-click",za=>this._getCommonUpdateOperationClickHandlers(ka,za,fa),p.ViewEventPriorities.WIDGET),ea.on("key-down",za=>{this._getCommonUpdateOperationKeyDownHandlers(ka,za);za.key!==z.SKETCH_KEYS.constraint||za.repeat||(sa=!0,oa.enableMoveAllGraphics=!oa.enableMoveAllGraphics)},
p.ViewEventPriorities.WIDGET),ea.on("key-up",za=>{za.key===z.SKETCH_KEYS.constraint&&sa&&(sa=!1,oa.enableMoveAllGraphics=!oa.enableMoveAllGraphics)},p.ViewEventPriorities.WIDGET)],ya=this._getHandlesForComponent(ka,fa);return ka});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._setupReshape3DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea,na=!1){var oa=this;const ka=yield this._requireModule(new Promise((za,ua)=>g(["../../views/3d/interactive/editingTools"],za,ua)));
if(xa(ka))return ka;this.snappingOptions.enabledToggled=!1;const sa=new ka.module.GraphicReshapeTool({view:ea,graphic:ca,enableZVertex:fa.enableZ&&"move"===fa.reshapeOptions.vertexOperation,enableZShape:fa.enableZ&&"move"===fa.reshapeOptions.shapeOperation,enableMoveGraphic:"move"===fa.reshapeOptions.shapeOperation||"move-xy"===fa.reshapeOptions.shapeOperation,enableMidpoints:"split"===fa.reshapeOptions.edgeOperation,enableEdgeOffset:"offset"===fa.reshapeOptions.edgeOperation,snappingManager:this._snappingManager,
labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});ea.tools.add(sa);na||this.updateGraphics.add(ca);const Ca=[],ya=new x.UpdateOperationHandle({activeComponent:sa,tool:"reshape",type:"update",onEnd:()=>{Ca.forEach(za=>za.remove());Ca.length=0;this.view.tools?.remove(sa);sa.destroyed||sa.destroy()},canUndo:()=>sa.canUndo,undo:()=>{sa.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>sa.canRedo,redo:()=>{sa.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"reshape"})},addToSelection:function(){var za=u._asyncToGenerator(function*(ua){oa.updateGraphics.add(ua);oa.emit("update",{graphics:oa.updateGraphics.toArray(),state:"active",aborted:!1,tool:oa.activeTool,toolEventInfo:{added:[ua],removed:[],type:"selection-change"},type:"update"});ua=yield oa._setupMove3DOperation(oa.updateGraphics.toArray(),fa,ea,"transform",!0);xa(ua)||(ya.onEnd(),ya.destroy(),oa._setUpdateOperationHandle(ua,fa))});return function(ua){return za.apply(this,arguments)}}(),
removeFromSelection:za=>{this.updateGraphics.remove(za);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[za],type:"selection-change"},type:"update"});ya.complete()},toggleTool:function(){var za=u._asyncToGenerator(function*(){if(!1!==fa.toggleToolOnClick){var ua=yield oa._setupGraphicTransform3DOperation(oa.updateGraphics.toArray(),fa,ea,!0);xa(ua)||(ya.onEnd(),ya.destroy(),oa._setUpdateOperationHandle(ua,fa))}});
return function(){return za.apply(this,arguments)}}()});Ca.push(...this._getHandlesForComponent(ya,fa),ea.on("immediate-click",za=>this._getCommonUpdateOperationClickHandlers(ya,za,fa),p.ViewEventPriorities.WIDGET),ea.on("key-down",za=>{this._getCommonUpdateOperationKeyDownHandlers(ya,za);za.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,za.stopPropagation())},p.ViewEventPriorities.WIDGET),ea.on("key-up",za=>{za.key===z.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=
!1,za.stopPropagation())},p.ViewEventPriorities.WIDGET));return ya});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._setupTransformOrReshape2DOperation=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea,na){var oa=this;this.updateGraphics.addMany(ca);yield this._updateSpatialReference(ca);ca="transform"===fa?yield this._getBox(ca,ea,na):yield this._getReshape(ca,ea,na);if(xa(ca))return ca;const ka=new x.UpdateOperationHandle({activeComponent:ca,type:"update",onEnd:()=>{Ca.forEach(ya=>
ya.remove());sa.forEach(ya=>ya.remove());Ca=[];sa=[];ka.activeComponent&&!ka.activeComponent.destroyed&&ka.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ba(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},redo:()=>{la(ka,this.updateGraphics.toArray());ka.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ka.tool})},addToSelection:function(){var ya=
u._asyncToGenerator(function*(za){var ua=ka.activeComponent;if("reshape"===ua.type){ua=[...oa.updateGraphics,za];oa.updateGraphics.removeAll();ua=yield oa._setupMove2DOperation(ua,ea,na);if(xa(ua))return;ka.onEnd();ka.destroy();oa._setUpdateOperationHandle(ua,ea)}else oa.updateGraphics.add(za),ua.graphics=oa.updateGraphics.toArray(),ua.refresh(),ka.resetHistory();oa.emit("update",{graphics:oa.updateGraphics.toArray(),state:"active",aborted:!1,tool:oa.activeTool,toolEventInfo:{added:[za],removed:[],
type:"selection-change"},type:"update"})});return function(za){return ya.apply(this,arguments)}}(),removeFromSelection:function(){var ya=u._asyncToGenerator(function*(za){const ua=oa.updateGraphics.indexOf(za);ka.history.undo.forEach(Ia=>Ia.updates.splice(ua,1));ka.history.redo.forEach(Ia=>Ia.updates.splice(ua,1));oa.updateGraphics.remove(za);const Ea=oa.updateGraphics.toArray();if(0===Ea.length)ka.complete();else{const Ia=Ea[0].geometry;1!==Ea.length||!L.isSome(Ia)||"point"!==Ia.type&&"multipoint"!==
Ia.type?ka.activeComponent.graphics=Ea:ka.toggleTool()}oa.emit("update",{graphics:Ea,state:"active",aborted:!1,tool:oa.activeTool,toolEventInfo:{added:[],removed:[za],type:"selection-change"},type:"update"})});return function(za){return ya.apply(this,arguments)}}(),toggleTool:function(){var ya=u._asyncToGenerator(function*(){if(!(1<oa.updateGraphics.length)){var za=oa.updateGraphics.getItemAt(0),ua=za.geometry;L.isSome(ua)&&("reshape"===ka.tool&&("point"===ua.type||"multipoint"===ua.type)||"transform"===
ka.tool&&"extent"===ua.type)||(ua=null,"transform"===ka.tool?ua=yield oa._getReshape([za],ea,na):"reshape"===ka.tool&&(ua=yield oa._getBox([za],ea,na)),xa(ua)||(ka.activeComponent.destroy(),ka.activeComponent=ua,ka.activeComponent&&(Ca.forEach(Ea=>Ea.remove()),Ca=oa._getHandlesForComponent(ka,ea))))}});return function(){return ya.apply(this,arguments)}}()});let sa=[na.on("immediate-click",ya=>this._getCommonUpdateOperationClickHandlers(ka,ya,ea),p.ViewEventPriorities.WIDGET),na.on("key-down",ya=>
{this._getCommonUpdateOperationKeyDownHandlers(ka,ya);ya.key!==z.SKETCH_KEYS.snappingToggle||ya.repeat||(this.snappingOptions.enabledToggled=!0,ya.stopPropagation());ya.key===z.SKETCH_KEYS.constraint&&!ya.repeat&&ka&&(ya=ka.activeComponent)&&"box"===ya.type&&(ya.preserveAspectRatio=!ya.preserveAspectRatio)},p.ViewEventPriorities.WIDGET),na.on("key-up",ya=>{ya.key===z.SKETCH_KEYS.snappingToggle&&"reshape"===ka?.activeComponent?.type&&(this.snappingOptions.enabledToggled=!1,ya.stopPropagation());ya.key===
z.SKETCH_KEYS.constraint&&ka&&(ya=ka.activeComponent)&&"box"===ya.type&&(ya.preserveAspectRatio=!ya.preserveAspectRatio)},p.ViewEventPriorities.WIDGET)],Ca=this._getHandlesForComponent(ka,ea);return ka});return function(ca,fa,ea,na){return Z.apply(this,arguments)}}();ha._getGraphicMover=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){({enableMoveAllGraphics:fa}=fa);const na=yield this._requireModule(new Promise((oa,ka)=>g(["../../views/draw/support/GraphicMover"],sa=>oa(Aa(sa)),ka)));return xa(na)?
na:new na.module.default({enableMoveAllGraphics:fa,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:ca,view:ea,callbacks:{onGraphicMoveStart:({dx:oa,dy:ka,graphic:sa})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:oa,dy:ka,mover:sa,type:"move-start"},type:"update"})},onGraphicMove:({dx:oa,dy:ka,graphic:sa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{dx:oa,dy:ka,mover:sa,type:"move"},type:"update"}),onGraphicMoveStop:({dx:oa,dy:ka,graphic:sa})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:oa,dy:ka,mover:sa,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})});return function(ca,fa,ea){return Z.apply(this,arguments)}}();
ha._getBox=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){const {enableRotation:na,enableScaling:oa,preserveAspectRatio:ka}=fa;fa=yield this._requireModule(new Promise((sa,Ca)=>g(["../../views/draw/support/Box"],ya=>sa(Aa(ya)),Ca)));return xa(fa)?fa:new fa.module.default({graphics:ca,enableRotation:na,enableScaling:oa,preserveAspectRatio:ka,layer:this._internalGraphicsLayer,view:ea,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onMove:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onMoveStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScaleStart:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScale:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onScaleStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onRotateStart:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},
type:"update"}),onRotate:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"}),onRotateStop:sa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...sa},type:"update"})}})});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._getReshape=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){const na="split"===fa.reshapeOptions?.edgeOperation;
fa="move"===fa.reshapeOptions?.shapeOperation;const oa=yield this._requireModule(new Promise((ka,sa)=>g(["../../views/draw/support/Reshape"],Ca=>ka(Aa(Ca)),sa)));return xa(oa)?oa:new oa.module.default({enableMidpoints:na,enableMovement:fa,graphic:ca[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:ea,callbacks:{onReshapeStart:ka=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...ka},type:"update"}),onReshape:ka=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ka},type:"update"}),onReshapeStop:({mover:ka,type:sa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ka,type:sa},type:"update"}),onMoveStart:({dx:ka,dy:sa,mover:Ca,type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:sa,mover:Ca,type:ya},type:"update"}),onMove:({dx:ka,dy:sa,mover:Ca,type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:sa,mover:Ca,type:ya},type:"update"}),onMoveStop:({dx:ka,dy:sa,mover:Ca,type:ya})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ka,dy:sa,mover:Ca,type:ya},type:"update"}),
onVertexAdd:({added:ka,type:sa,vertices:Ca})=>{ka=ka.map(ya=>A.geometryToCoordinates(ya.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ka,vertices:Ca,type:sa},type:"update"})},onVertexRemove:({removed:ka,type:sa,vertices:Ca})=>{ka=ka.map(ya=>A.geometryToCoordinates(ya.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ka,
vertices:Ca,type:sa},type:"update"})}}})});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._getHandlesForComponent=function(Z,ca){const fa=Z.activeComponent;switch(fa.type){case "graphic-mover":return[fa.on("graphic-click",({graphic:ea,viewEvent:na})=>{na.native?.shiftKey&&(na.stopPropagation(),Z.removeFromSelection(ea))}),fa.on("graphic-move-start",ea=>Z.addToHistory(va(ea.allGraphics)))];case "box":return[fa.on("graphic-click",ea=>this._onTransformOrReshape2DGraphicClick(Z,ca,ea)),
fa.on("move-start",ea=>Z.addToHistory(va(ea.graphics))),fa.on("rotate-start",ea=>Z.addToHistory(va(ea.graphics))),fa.on("scale-start",ea=>Z.addToHistory(va(ea.graphics)))];case "reshape":return[fa.on("graphic-click",ea=>this._onTransformOrReshape2DGraphicClick(Z,ca,ea)),fa.on("move-start",ea=>Z.addToHistory(va([ea.mover]))),fa.on("reshape-start",ea=>Z.addToHistory(va([ea.graphic]))),fa.on("vertex-add",ea=>Z.addToHistory(va([ea.oldGraphic]))),fa.on("vertex-remove",ea=>Z.addToHistory(va([ea.oldGraphic])))];
case "move-3d":return[fa.on("graphic-move-start",ea=>{Z.addToHistory(va(ea.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ea.allGraphics.length?ea.allGraphics[0]:null,type:"move-start"},type:"update"})}),fa.on("graphic-move",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ea.dx,dy:ea.dy,mover:0<ea.allGraphics.length?
ea.allGraphics[0]:null,type:"move"},type:"update"})}),fa.on("graphic-move-stop",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ea.allGraphics.length?ea.allGraphics[0]:null,type:"move-stop"},type:"update"})}),fa.on("immediate-click",ea=>{ea.shiftKey?this._toggleSelection([ea.graphic],Z,ca):Z.toggleTool()})];case "transform-3d":return[fa.on("record-undo",({record:ea})=>{Z.addToHistory({updates:[ea]})}),
fa.on("graphic-translate-start",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,dx:ea.dxScreen,dy:ea.dyScreen,type:"move-start"},type:"update"})}),fa.on("graphic-translate-stop",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,dx:ea.dxScreen,dy:ea.dyScreen,type:"move-stop"},type:"update"})}),fa.on("graphic-rotate-start",
ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,angle:ea.angle,type:"rotate-start"},type:"update"})}),fa.on("graphic-rotate-stop",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,angle:ea.angle,type:"rotate-stop"},type:"update"})}),fa.on("graphic-scale-start",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,xScale:ea.xScale,yScale:ea.yScale,type:"scale-start"},type:"update"})}),fa.on("graphic-scale-stop",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,xScale:ea.xScale,yScale:ea.yScale,type:"scale-stop"},type:"update"})}),fa.on("graphic-translate",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{mover:ea.graphic,dx:ea.dxScreen,dy:ea.dyScreen,type:"move"},type:"update"})}),fa.on("graphic-rotate",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,angle:ea.angle,type:"rotate"},type:"update"})}),fa.on("graphic-scale",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ea.graphic,xScale:ea.xScale,
yScale:ea.yScale,type:"scale"},type:"update"})}),fa.on("immediate-click",ea=>{ea.shiftKey?this._toggleSelection([ea.graphic],Z,ca):Z.toggleTool()})];case "reshape-3d":return[fa.on("reshape",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ea,type:"update"})}),fa.on("move",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ea,type:"update"})}),fa.on("vertex-add",
ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ea,type:"update"})}),fa.on("vertex-remove",ea=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ea,type:"update"})}),fa.on("immediate-click",ea=>{ea.shiftKey?this._toggleSelection([ea.graphic],Z,ca):Z.toggleTool()})]}};ha._onTransformOrReshape2DGraphicClick=function(Z,ca,fa){const {graphic:ea,viewEvent:na}=
fa;if(na.native?.shiftKey&&ea.layer===this.layer)return na.stopPropagation(),Z.removeFromSelection(ea);if(ca.toggleToolOnClick)return na.stopPropagation(),Z.toggleTool()};ha._setUpdateOperationHandle=function(Z,ca){this._operationHandle=Z;const fa=this.view.map;this._disablePopup(ca);Z.on("complete",()=>{if(Z===this._operationHandle){const ea=this.updateGraphics.toArray(),na=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());
this.updateGraphics.removeAll();fa&&fa.remove(this._internalGraphicsLayer);this._restorePopup(ca);this.emit("update",{graphics:ea,state:"complete",aborted:Z.cancelled,tool:na,toolEventInfo:null,type:"update"})}})};ha._getCommonUpdateOperationClickHandlers=function(){var Z=u._asyncToGenerator(function*(ca,fa,ea){const na=n.createScreenPointFromEvent(fa),oa=yield fa.async(()=>this._getFirstHit(na));L.isNone(oa)?ca.complete():fa.native.shiftKey&&this._toggleSelection([oa.graphic],ca,ea)?fa.stopPropagation():
this.updateGraphics.includes(oa.graphic)?fa.stopPropagation():ca.complete()});return function(ca,fa,ea){return Z.apply(this,arguments)}}();ha._toggleSelection=function(Z,ca,fa){const ea=!!fa.multipleSelectionEnabled;return Z.some(na=>null==na?!1:ea&&na.layer===this.layer?(this.updateGraphics.includes(na)?ca.removeFromSelection(na):ca.addToSelection(na),!0):!1)};ha._getCommonUpdateOperationKeyDownHandlers=function(Z,ca){if(Z){var fa=ca.key;fa===z.SKETCH_KEYS.undo&&Z.canUndo()?(ca.stopPropagation(),
Z.undo()):fa===z.SKETCH_KEYS.redo&&Z.canRedo()?(ca.stopPropagation(),Z.redo()):fa===z.SKETCH_KEYS.cancel?(ca.stopPropagation(),Z.cancel()):this.allowDeleteKey&&z.SKETCH_KEYS.delete.includes(fa)&&this._onDeleteKey(ca)}};ha._onDeleteKey=function(Z){if(this._operationHandle&&"update"===this._operationHandle.type){var ca=this.activeComponent,fa=this.updateGraphics.toArray();L.isNone(ca)||"reshape-3d"===ca.type||"reshape"===ca.type&&(1!==fa.length||"point"!==L.get(fa[0].geometry,"type"))||(Z.stopPropagation(),
this.delete())}};ha._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=L.destroyMaybe(this._internalGraphicsLayer))};ha._isComponentGraphic=function(Z){const {activeComponent:ca}=this;return!Z||L.isNone(ca)?!1:Z.attributes&&Z.attributes.esriSketchTool||"draw-2d"===ca.type&&ca.graphic===Z||("box"===ca.type||"reshape"===ca.type)&&ca.isUIGraphic(Z)};ha._displayPointerCursor=function(){this.view&&
this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};ha._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};ha._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};ha._logError=function(Z,ca,fa){h.getLogger(this.declaredClass).error(new F(Z,ca,fa))};ha._requireModule=function(){var Z=u._asyncToGenerator(function*(ca){const fa=new AbortController;
this._moduleLoaderAbortController=fa;ca=yield ca;return this._moduleLoaderAbortController!==fa||fa.signal.aborted?{requireError:"aborted"}:{module:ca}});return function(ca){return Z.apply(this,arguments)}}();ha._emitUndoEvent=function(Z){this.emit("undo",{...Z,type:"undo"})};ha._emitRedoEvent=function(Z){this.emit("redo",{...Z,type:"redo"})};ha._emitDeleteEvent=function(Z){this.emit("delete",{...Z,type:"delete"})};ha.wait=function(){return y.whenOnce(()=>!this.updating)};ha._beginAsyncOperation=function(){this._numUpdating+=
1;this.notifyChange("updating")};ha._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};ha._disablePopupEnabled=function(Z){return"3d"!==this.view?.type||this.updateOnGraphicClick||L.isSome(Z)&&Z.toggleToolOnClick};ha._disablePopup=function(Z){this._disablePopupEnabled(Z)&&(Z=this.view.popup)&&L.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=Z.autoOpenEnabled,Z.autoOpenEnabled=!1)};ha._restorePopup=function(Z){this._disablePopupEnabled(Z)&&(Z=this.view.popup)&&
L.isSome(this._originalAutoOpenEnabled)&&(Z.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};ha._waitViewReady=function(){var Z=u._asyncToGenerator(function*(){const ca=this.view;ca&&(L.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,yield Q.whenOrAbort(y.whenOnce(()=>ca?.ready),this._viewReadyAbortController.signal))});return function(){return Z.apply(this,arguments)}}();u._createClass(ja,[{key:"_defaultUpdateTool",get:function(){return"3d"===
this.view.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return!L.isSome(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):
L.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",get:function(){return this._get("defaultCreateOptions")},set:function(Z){this._set("defaultCreateOptions",{...Ga,...Z})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(Z){this._set("defaultUpdateOptions",{...Da,...Z,reshapeOptions:{...Da.reshapeOptions,...Z?.reshapeOptions}})}},{key:"snappingOptions",set:function(Z){L.isSome(this._snappingManager)&&(this._snappingManager.options=
Z);this._set("snappingOptions",Z)}},{key:"state",get:function(){const Z=!(!this.view?.ready||!this.layer),ca=this._operationHandle;return Z&&ca?"active":Z?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(Z){const ca=this._get("view");if(ca){const {container:fa,map:ea}=ca;fa&&(ca.cursor=null);ea&&ea.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");Z&&this._handles.add(y.when(()=>Z.ready,fa=>{this._viewHandles.removeAll();
fa&&this._viewHandles.add(this._generateViewHandles(Z))},y.syncAndInitial),"view-ready");this._set("view",Z)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:Da}}}]);return ja}(w.EventedAccessor);f.__decorate([I.property()],C.prototype,"updating",null);f.__decorate([I.property()],C.prototype,"_operationHandle",void 0);f.__decorate([I.property({readOnly:!0})],C.prototype,"activeTool",null);f.__decorate([I.property()],C.prototype,"activeFillSymbol",void 0);
f.__decorate([I.property()],C.prototype,"activeLineSymbol",void 0);f.__decorate([I.property()],C.prototype,"activeVertexSymbol",void 0);f.__decorate([I.property()],C.prototype,"allowDeleteKey",void 0);f.__decorate([I.property({readOnly:!0})],C.prototype,"createGraphic",null);f.__decorate([I.property()],C.prototype,"defaultCreateOptions",null);f.__decorate([I.property()],C.prototype,"defaultUpdateOptions",null);f.__decorate([I.property({type:m,nonNullable:!0})],C.prototype,"labelOptions",void 0);f.__decorate([I.property()],
C.prototype,"layer",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"pointSymbol",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"polygonSymbol",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"polylineSymbol",void 0);f.__decorate([I.property({type:q,nonNullable:!0})],C.prototype,"snappingOptions",null);f.__decorate([I.property()],C.prototype,"_snappingManager",void 0);f.__decorate([I.property({readOnly:!0})],C.prototype,"state",null);
f.__decorate([I.property({type:k,nonNullable:!0})],C.prototype,"tooltipOptions",void 0);f.__decorate([I.property({readOnly:!0})],C.prototype,"updateGraphics",void 0);f.__decorate([I.property()],C.prototype,"updateOnGraphicClick",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"updatePointSymbol",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"updatePolygonSymbol",void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"updatePolylineSymbol",
void 0);f.__decorate([I.property({types:O.symbolTypes})],C.prototype,"vertexSymbol",void 0);f.__decorate([I.property({value:null})],C.prototype,"view",null);return C=f.__decorate([D.subclass("esri.widgets.Sketch.SketchViewModel")],C)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(g,u){g.SupportedGraphicResult=void 0;(function(f){f[f.SUPPORTED=0]="SUPPORTED";f[f.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";f[f.GEOMETRY_MISSING=
2]="GEOMETRY_MISSING";f[f.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";f[f.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";f[f.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(g.SupportedGraphicResult||(g.SupportedGraphicResult={}));g.isSupportedGraphicResultMessage=function(f){switch(f){case g.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case g.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case g.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";
case g.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case g.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],
function(g,u,f,O,l){g.isSupportedGraphic=function(C){if("graphics"!==C.layer?.type)return l.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(f.isNone(C.geometry))return l.SupportedGraphicResult.GEOMETRY_MISSING;switch(C.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return l.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return l.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==O.getGraphicEffectiveElevationMode(C)&&
O.hasGraphicFeatureExpressionInfo(C)?l.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:l.SupportedGraphicResult.SUPPORTED};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(g,u,f){function O(y,I){return u.isNone(I)||!I.mode?(y?L:Q).mode:I.mode}function l(y,I){return u.isSome(I)?I:y?L:Q}function C(y,I){return O(u.isSome(y)?y.hasZ:
!1,I)}function F(y){const I=w(y);return C(y.geometry,I)}function w(y){return y.layer&&"elevationInfo"in y.layer?y.layer.elevationInfo:null}function M(y,I,S,R,D,E,J=null){if(!u.isNone(E)){var A=u.isSome(J)?J.mode:"absolute-height";if("on-the-ground"===A)return 0;({absoluteZ:E}=h(I,S,R,D,y,E));a:{J=u.isSome(J)&&u.isSome(J.offset)?J.offset:0;switch(A){case "absolute-height":y=E-J;break a;case "relative-to-ground":y=E-(u.unwrapOr(y.elevationProvider.getElevation(I,S,R,D,"ground"),0)+J);break a;case "relative-to-scene":y=
E-(u.unwrapOr(y.elevationProvider.getElevation(I,S,R,D,"scene"),0)+J);break a}y=void 0}return y}}function h(y,I,S,R,D,E){const J=u.isSome(E.offset)?E.offset:0;switch(E.mode){case "absolute-height":return{absoluteZ:S+J,elevation:0};case "on-the-ground":return S=u.unwrapOr(D.elevationProvider.getElevation(y,I,0,R,"ground"),0),{absoluteZ:S,elevation:S};case "relative-to-ground":return y=u.unwrapOr(D.elevationProvider.getElevation(y,I,S,R,"ground"),0),{absoluteZ:S+y+J,elevation:y};case "relative-to-scene":return y=
u.unwrapOr(D.elevationProvider.getElevation(y,I,S,R,"scene"),0),{absoluteZ:S+y+J,elevation:y}}}const L={mode:"absolute-height",offset:0},Q={mode:"on-the-ground",offset:null};g.absoluteHeightElevationInfo=L;g.elevationContextAffectsAlignment=function(y,I){if(u.isNone(I))return!1;({mode:I}=I);return u.isSome(I)&&("scene"===y&&"relative-to-scene"===I||"ground"===y&&"absolute-height"!==I)};g.elevationInfoLikeEquals=function(y,I){return y===I||u.isSome(y)&&u.isSome(I)&&y.mode===I.mode&&y.offset===I.offset};
g.getConvertedElevation=function(y,I,S,R=null){return M(y,I.x,I.y,I.hasZ?I.z:0,I.spatialReference,S,R)};g.getConvertedElevationFromVector=function(y,I,S,R,D=null){return M(y,I[0],I[1],2<I.length?I[2]:0,S,R,D)};g.getEffectiveElevationInfo=l;g.getEffectiveElevationMode=O;g.getGeometryEffectiveElevationInfo=function(y,I){return l(u.isSome(y)?y.hasZ:!1,I)};g.getGeometryEffectiveElevationMode=C;g.getGraphicEffectiveElevationInfo=function(y){var I=w(y);y=C(y.geometry,I);I=u.isSome(I)&&"on-the-ground"!==
y?u.unwrapOr(I.offset,0)*f.getMetersPerUnit(u.unwrapOr(I.unit,"meters")):0;return{mode:y,offset:I}};g.getGraphicEffectiveElevationMode=F;g.getZForElevationMode=function(y,I,S){if(!u.isNone(S)&&S.mode){var R=y.hasZ?y.z:0,D=u.isSome(S.offset)?S.offset:0;switch(S.mode){case "absolute-height":return R-D;case "on-the-ground":return 0;case "relative-to-ground":return y=u.unwrapOr(I.elevationProvider.getElevation(y.x,y.y,y.z,y.spatialReference,"ground"),0)+D,R-y;case "relative-to-scene":return y=u.unwrapOr(I.elevationProvider.getElevation(y.x,
y.y,y.z,y.spatialReference,"scene"),0)+D,R-y}}};g.hasGraphicFeatureExpressionInfo=function(y){if("on-the-ground"===F(y))return!1;y=w(y);y=u.isSome(y)&&y.featureExpressionInfo?y.featureExpressionInfo.expression:null;return!(!y||"0"===y)};g.onTheGroundElevationInfo=Q;g.zValueInAbsoluteHeightMode=h;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/maybe",
"../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(g,u,f,O,l){function C(F){return"graphics"!==F.layer?.type?{result:l.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null}:u.isNone(F.geometry)?{result:l.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==O.getGraphicEffectiveElevationMode(F)&&O.hasGraphicFeatureExpressionInfo(F)?{result:l.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null}:"point"!==
F.geometry.type&&"polyline"!==F.geometry.type&&("polygon"!==F.geometry.type||F.geometry instanceof f)?{result:l.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:l.SupportedGraphicResult.SUPPORTED,geometry:F.geometry}}g.geometryOfSupportedGraphic=function(F){return C(F).geometry};g.isSupportedGraphic=function(F){return C(F).result};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Point ./Polygon ./projectionEllipsoid ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y){var I;l=I=function(S){function R(...E){E=S.call(this,...E)||this;E.center=null;E.geodesic=!1;E.numberOfPoints=60;E.radius=1E3;E.radiusUnit="meters";return E}g._inheritsLoose(R,S);var D=R.prototype;D.normalizeCtorArgs=function(E,J){if(!E||!E.center){if(E&&E.rings)return S.prototype.normalizeCtorArgs.call(this,E,J);E={center:E}}return{...S.prototype.normalizeCtorArgs.call(this),...E,...J}};D.initialize=function(){var E=this.center;const J=this.numberOfPoints;this.hasZ=
E?.hasZ??!1;if(0===this.rings.length&&E){var A=f.convertUnit(this.radius,this.radiusUnit,"meters"),P=E.spatialReference,e="geographic";if(P.isWebMercator)e="webMercator";else if(null!=(P.wkid&&y[P.wkid])||P.wkt&&0===P.wkt.indexOf("PROJCS"))e="projected";if(this.geodesic){let c;switch(e){case "webMercator":c=Q.webMercatorToGeographic(E);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":c=
E}E=this._createGeodesicCircle(c,A,J);"webMercator"===e&&(E=Q.geographicToWebMercator(E))}else{let c;"webMercator"===e||"projected"===e?c=A/this._convert2Meters(1,E.spatialReference):"geographic"===e&&(c=f.lengthToDegrees(A,"meters",h.getReferenceEllipsoid(E.spatialReference).radius));E=this._createPlanarCircle(E,c,J)}this.spatialReference=E.spatialReference;this.addRing(E.rings[0])}};D.clone=function(){const {center:E,numberOfPoints:J,radius:A,radiusUnit:P,geodesic:e}=this;return new I({center:E?.clone(),
numberOfPoints:J,radius:A,radiusUnit:P,geodesic:e})};D._createGeodesicCircle=function(E,J,A){let P=0;const e=[];for(;360>P;){const c=[0,0];L.directGeodeticSolver(c,[E.x,E.y],P,J);this.hasZ&&c.push(E.z);e.push(c);P+=360/A}e.push(e[0]);return new M(e)};D._createPlanarCircle=function(E,J,A){const P=[],e=2*Math.PI/A;for(let b=0;b<A;++b){var c=e*b;c=[E.x+Math.cos(-c)*J,E.y+Math.sin(-c)*J];this.hasZ&&c.push(E.z);P.push(c)}P.push(P[0]);return new M({spatialReference:E.spatialReference,rings:[P]})};D._convert2Meters=
function(E,J){if(J.wkid&&null!=y[J.wkid])J=y.values[y[J.wkid]];else{J=J.wkt;const A=J.lastIndexOf(",")+1,P=J.lastIndexOf("]]");J=parseFloat(J.substring(A,P))}return E*J};return R}(M);u.__decorate([O.property({type:w})],l.prototype,"center",void 0);u.__decorate([O.property()],l.prototype,"geodesic",void 0);u.__decorate([O.property()],l.prototype,"numberOfPoints",void 0);u.__decorate([O.property()],l.prototype,"radius",void 0);u.__decorate([O.property()],l.prototype,"radiusUnit",void 0);return l=I=
u.__decorate([F.subclass("esri.geometry.Circle")],l)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(g,u,f,O,l,C,F,w,M,h){function L(A){if(!A)return null;if(C.isGeographic(A)&&A.wkid){var P=l.spheroids[A.wkid];if(P)return P}return A.wkt&&((A=l.WKT_SPHEROID_REGEX.exec(A.wkt))&&2===A.length?(P=A[1].split(","),!P||
3>P.length?A=null:(A=parseFloat(P[1]),P=parseFloat(P[2]),A=isNaN(A)||isNaN(P)?null:{a:A,f:0===P?0:1/P})):A=null,A)?A:null}function Q(A){A=L(A??h.WGS84);if(null!=A&&"b"in A&&"eSq"in A&&"radius"in A)return A;const P=A.a*(1-A.f);return Object.assign(A,{b:P,eSq:1-(P/A.a)**2,radius:(2*A.a+P)/3,densificationRatio:1E4/((2*A.a+P)/3)})}function y(A){return null!=A&&0>A?A+360:A}function I(A,P,e){const {a:c,eSq:b}=Q(e);e=Math.sqrt(b);const r=Math.sin(P[1]*l.toRadians);P=c*P[0]*l.toRadians;e=0<b?c*(1-b)*(r/(1-
b*r*r)-1/(2*e)*Math.log((1-e*r)/(1+e*r)))*.5:c*r;A[0]=P;A[1]=e;return A}function S(A){return null!==L(A)}function R(A,P){if("polyline"!==A.type&&"polygon"!==A.type)throw new f("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:e}=A;if(!S(e))throw new f("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var c="polyline"===A.type?A.paths:A.rings;const b=[],r=[0,0],H=new J;for(const z of c){c=
[];b.push(c);c.push([z[0][0],z[0][1]]);var d=z[0][0],p=z[0][1];let m,k;for(let B=0;B<z.length-1;B++){m=z[B+1][0];k=z[B+1][1];if(d===m&&p===k)continue;const q=[d,p];E(H,[d,p],[m,k],e);const {azimuth:T,distance:n}=H;d=n/P;if(1<d){for(p=1;p<=d-1;p++)D(r,q,T,p*P,e),c.push(r.slice(0));D(r,q,T,(n+Math.floor(d-1)*P)/2,e);c.push(r.slice(0))}D(r,q,T,n,e);c.push(r.slice(0));d=r[0];p=r[1]}}return"polyline"===A.type?new F({paths:b,spatialReference:e}):new w({rings:b,spatialReference:e})}function D(A,P,e,c,b){const r=
P[0]*l.toRadians;P=P[1]*l.toRadians;e=(e??0)*l.toRadians;const {a:H,b:d,f:p}=Q(b);b=Math.sin(e);e=Math.cos(e);var z=(1-p)*Math.tan(P);P=1/Math.sqrt(1+z*z);const m=z*P,k=Math.atan2(z,e);z=P*b;const B=z*z;var q=1-B,T=q*(H*H-d*d)/(d*d);const n=1+T/16384*(4096+T*(-768+T*(320-175*T))),x=T/1024*(256+T*(-128+T*(74-47*T)));T=c/(d*n);let G=2*Math.PI,K,U,Y,ba;for(;1E-12<Math.abs(T-G);)Y=Math.cos(2*k+T),K=Math.sin(T),U=Math.cos(T),ba=x*K*(Y+x/4*(U*(-1+2*Y*Y)-x/6*Y*(-3+4*K*K)*(-3+4*Y*Y))),G=T,T=c/(d*n)+ba;c=
m*K-P*U*e;q=p/16*q*(4+p*(4-3*q));c=Math.atan2(m*U+P*K*e,(1-p)*Math.sqrt(B+c*c))/l.toRadians;A[0]=(r+(Math.atan2(K*b,P*U-m*K*e)-(1-q)*p*z*(T+q*K*(Y+q*U*(-1+2*Y*Y)))))/l.toRadians;A[1]=c;return A}function E(A,P,e,c){var b=P[0]*l.toRadians;P=P[1]*l.toRadians;var r=e[0]*l.toRadians;e=e[1]*l.toRadians;const {a:H,b:d,f:p,radius:z}=Q(c),m=r-b;var k=Math.atan((1-p)*Math.tan(P)),B=Math.atan((1-p)*Math.tan(e));c=Math.sin(k);k=Math.cos(k);const q=Math.sin(B);B=Math.cos(B);let T=1E3,n=m,x,G,K;let U,Y,ba;do{var la=
Math.sin(n);var pa=Math.cos(n);K=Math.sqrt(B*la*B*la+(k*q-c*B*pa)*(k*q-c*B*pa));if(0===K)return A.distance=0,A.azimuth=void 0,A.reverseAzimuth=void 0,A;pa=c*q+k*B*pa;U=Math.atan2(K,pa);Y=k*B*la/K;G=1-Y*Y;la=pa-2*c*q/G;isNaN(la)&&(la=0);ba=p/16*G*(4+p*(4-3*G));x=n;n=m+(1-ba)*p*Y*(U+ba*K*(la+ba*pa*(-1+2*la*la)))}while(1E-12<Math.abs(n-x)&&0<--T);if(0===T)return c=Math.acos(Math.sin(P)*Math.sin(e)+Math.cos(P)*Math.cos(e)*Math.cos(r-b))*z,b=r-b,A.azimuth=Math.atan2(Math.sin(b)*Math.cos(e),Math.cos(P)*
Math.sin(e)-Math.sin(P)*Math.cos(e)*Math.cos(b))/l.toRadians,A.distance=c,A.reverseAzimuth=void 0,A;b=G*(H*H-d*d)/(d*d);P=b/1024*(256+b*(-128+b*(74-47*b)));r=Math.atan2(k*Math.sin(n),k*q*Math.cos(n)-c*B);A.azimuth=Math.atan2(B*Math.sin(n),k*q-c*B*Math.cos(n))/l.toRadians;A.distance=d*(1+b/16384*(4096+b*(-768+b*(320-175*b))))*(U-P*K*(la+P/4*(pa*(-1+2*la*la)-P/6*la*(-3+4*K*K)*(-3+4*la*la))));A.reverseAzimuth=r/l.toRadians;return A}let J=function(A=0,P,e){this.distance=A;this.azimuth=P;this.reverseAzimuth=
e};g.InverseGeodeticSolverResult=J;g.directGeodeticSolver=D;g.geodesicAreas=function(A,P="square-meters"){if(A.some(r=>!S(r.spatialReference)))throw new f("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const e=[];for(var c=0;c<A.length;c++){var b=A[c];const {radius:r,densificationRatio:H}=Q(b.spatialReference);e.push(R(b,r*H))}A=[];c=[0,0];b=[0,0];for(let r=0;r<e.length;r++){const {rings:H,spatialReference:d}=e[r];let p=0;for(let z=0;z<H.length;z++){const m=
H[z];I(c,m[0],d);I(b,m[m.length-1],d);let k=b[0]*c[1]-c[0]*b[1];for(let B=0;B<m.length-1;B++)I(c,m[B+1],d),I(b,m[B],d),k+=b[0]*c[1]-c[0]*b[1];p+=k}p=O.convertUnit(p,"square-meters",P);A.push(p/-2)}return A};g.geodesicDensify=R;g.geodesicDistance=function(A,P,e="meters"){if(!A||!P)throw new f("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!A.spatialReference||!P.spatialReference)throw new f("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");
if(!C.equals(A.spatialReference,P.spatialReference))throw new f("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:c}=A;if(!S(c))throw new f("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(A.x===P.x&&A.y===P.y)return new J(0,0,0);const b=new J;E(b,[A.x,A.y],[P.x,P.y],c);b.distance=O.convertUnit(b.distance,"meters",e);b.azimuth=y(b.azimuth);b.reverseAzimuth=y(b.reverseAzimuth);return b};g.geodesicLengths=
function(A,P="meters"){if(!A)throw new f("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(A.some(b=>!S(b.spatialReference)))throw new f("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const e=[];for(let b=0;b<A.length;b++){var c=A[b];const {spatialReference:r}=c;c="polyline"===c.type?c.paths:c.rings;let H=0;for(let d=0;d<c.length;d++){const p=c[d];let z=0;for(let m=1;m<p.length;m++){const k=p[m-1][0],B=p[m][0],
q=p[m-1][1],T=p[m][1];if(q!==T||k!==B){const n=new J;E(n,[k,q],[B,T],r);z+=n.distance}}H+=z}H=O.convertUnit(H,"meters",P);e.push(H)}return e};g.inverseGeodeticSolver=E;g.isSupported=S;g.pointFromDistance=function(A,P,e){if(!A||null==P||null==e)throw new f("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>e||360<e)throw new f("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");
if(!A.spatialReference)throw new f("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:c}=A;if(!S(c))throw new f("geodesic-distance:not-supported","input geometry spatial reference is not supported");const b=[0,0];D(b,[A.x,A.y],e,P,c);return new M({x:b[0],y:b[1],spatialReference:c})};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(g,u,f,O,l){g.isSupportedGraphic=function(C){if("graphics"!==C.layer?.type)return l.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(f.isNone(C.geometry))return l.SupportedGraphicResult.GEOMETRY_MISSING;switch(C.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return l.SupportedGraphicResult.SUPPORTED;default:return l.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const F=
f.isSome(C.symbol)&&"point-3d"===C.symbol.type&&C.symbol.symbolLayers;return F&&0<F.length&&F.some(w=>"object"===w.type)?"on-the-ground"!==O.getGraphicEffectiveElevationMode(C)&&O.hasGraphicFeatureExpressionInfo(C)?l.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:l.SupportedGraphicResult.SUPPORTED:l.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/draw/support/layerUtils":function(){define(["exports",
"../../../core/maybe"],function(g,u){g.addUniqueLayer=function(f,O,l){if(O&&f&&f.map){({map:f}=f);var C=f.layers.find(F=>F===O);C||f.add(O,l);void 0!==l&&null!==l&&f.layers.reorder(C,l)}};g.findLayerView=function(f,O){return f.allLayerViews.find(l=>{l=l.layer;return l===O||"sublayers"in l&&u.isSome(l.sublayers)&&l.sublayers.includes(O)})};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(g){g.SKETCH_KEYS=
{redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h){h=w.call(this,h)||this;h.enabled=!1;return h}g._inheritsLoose(M,w);return M}(f);u.__decorate([O.property({type:Boolean,nonNullable:!0})],f.prototype,"enabled",void 0);return f=u.__decorate([F.subclass("esri.views.interactive.sketch.SketchLabelOptions")],f)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(g,u,f,O,l,C,F,w,M){f=function(h){function L(Q){Q=h.call(this,Q)||this;Q.enabled=!1;Q.elevation=new w.SketchTooltipElevationOptions;Q.visibleElements=new M.SketchTooltipVisibleElements;Q.visualVariables=null;return Q}g._inheritsLoose(L,h);L.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return L}(f);u.__decorate([O.property({type:Boolean,nonNullable:!0})],f.prototype,"enabled",void 0);u.__decorate([O.property({type:w.SketchTooltipElevationOptions,
nonNullable:!0})],f.prototype,"elevation",void 0);u.__decorate([O.property({type:M.SketchTooltipVisibleElements,nonNullable:!0})],f.prototype,"visibleElements",void 0);u.__decorate([O.property()],f.prototype,"visualVariables",void 0);return f=u.__decorate([F.subclass("esri.widgets.Sketch.SketchTooltipOptions")],f)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w){g.SketchTooltipElevationOptions=function(M){function h(L){L=M.call(this,L)||this;L.mode="absolute-height";return L}u._inheritsLoose(h,M);h.prototype.toJSON=function(){return{mode:this.mode}};return h}(O);f.__decorate([l.property({type:String,nonNullable:!0})],g.SketchTooltipElevationOptions.prototype,"mode",void 0);g.SketchTooltipElevationOptions=f.__decorate([w.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],g.SketchTooltipElevationOptions);Object.defineProperties(g,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,f,O,l,C,F,w){g.SketchTooltipVisibleElements=function(M){function h(){var L=
M.apply(this,arguments)||this;L.distance=!0;L.elevation=!0;L.size=!0;L.scale=!0;L.rotation=!0;L.orientation=!0;L.totalLength=!0;L.area=!0;L.radius=!0;return L}u._inheritsLoose(h,M);h.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return h}(O);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,
"distance",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"elevation",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"size",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"scale",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"rotation",void 0);f.__decorate([l.property({type:Boolean,
nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"orientation",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"totalLength",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"area",void 0);f.__decorate([l.property({type:Boolean,nonNullable:!0})],g.SketchTooltipVisibleElements.prototype,"radius",void 0);g.SketchTooltipVisibleElements=f.__decorate([w.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],
g.SketchTooltipVisibleElements);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./SnappingDomain ./snappingFactory ./SnappingOptions ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A){function P({coordinateHelper:c,elevationInfo:b}){return c.hasZ()?I.absoluteHeightElevationInfo:b}g.SnappingManager=function(c){function b(H){H=c.call(this,H)||this;H.options=new D;H.snappingEnginesFactory=R.defaultSnappingEnginesFactory;H._engines=[];H._currentMainCandidate=null;H._currentOtherActiveCandidates=[];H._currentSnappedType=e.MAIN;return H}u._inheritsLoose(b,c);var r=b.prototype;r.initialize=function(){this.handles.add([M.watch(()=>{const {effectiveFeatureEnabled:H,
effectiveSelfEnabled:d,touchSensitivityMultiplier:p,distance:z}=this.options;return{effectiveFeatureEnabled:H,effectiveSelfEnabled:d,touchSensitivityMultiplier:p,distance:z}},()=>{this.doneSnapping();this.emit("changed")},M.sync),M.watch(()=>this.options,H=>{for(const d of this._engines)d.options=H},M.sync),M.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:H,snappingEnginesFactory:d})=>this._recreateEngines(H,
d),M.syncAndInitial)])};r.destroy=function(){this._destroyEngines()};r._recreateEngines=function(H,d){this._destroyEngines();if(H){var {view:p,options:z}=this;this._engines=d(p,z)}};r._destroyEngines=function(){for(const H of this._engines)H.destroy();this._engines=[]};r.snap=function(){var H=u._asyncToGenerator(function*(d){return F.isSome(d.scenePoint)?this._snapMultiPoint(d):this._snapSinglePoint(d)});return function(d){return H.apply(this,arguments)}}();r.update=function(H){const {point:d,context:p}=
H;this._removeVisualization();var z=this._currentMainCandidate;if(F.isNone(z))return d;H=this._selectUpdateInput(H);if(F.isNone(H))return d;var {coordinateHelper:{spatialReference:m}}=p,k=y.project(this._convertPointElevation(H,p),m);if(F.isNone(k))return d;({view:H}=this);const {coordinateHelper:B,elevationInfo:q,visualizer:T}=p;m=[];k=B.pointToVector(k);const n=z.constraint.closestTo(k);if(!this._arePointsWithinScreenThreshold(k,n,p))return this._resetSnappingState(),d;z.targetPoint=n;m.push(...z.hints);
for(const x of this._currentOtherActiveCandidates)x.targetPoint=n,m.push(...x.hints);F.isSome(T)&&this.handles.add(T.draw(m,{coordinateHelper:B,elevationInfo:P(p),view:H,selfSnappingZ:p.selfSnappingZ}),"visualization-handle");z=B.vectorToDehydratedPoint(n);return this._convertPointElevation(z,p,I.absoluteHeightElevationInfo,q)};r.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};r._selectUpdateInput=function({point:H,scenePoint:d}){switch(this._currentSnappedType){case e.MAIN:return H;
case e.SCENE:return d}};r._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=e.MAIN};r._removeVisualization=function(){this.handles.remove("visualization-handle")};r._snapSinglePoint=function(){var H=u._asyncToGenerator(function*({point:d,context:p,signal:z}){var {coordinateHelper:m}=p;const {view:k}=this;d=this._convertPointElevation(d,p);m=m.pointToVector(d);d=yield this._fetchCandidates(m,S.SnappingDomain.ALL,p,z);return this._createSnapResult(m,
e.MAIN,d,k,p,z)});return function(d){return H.apply(this,arguments)}}();r._snapMultiPoint=function(){var H=u._asyncToGenerator(function*({point:d,scenePoint:p,context:z,signal:m}){const {view:k}=this;var {coordinateHelper:B}=z,{spatialReference:q}=B;yield y.initializeProjection(p.spatialReference,q);p=y.project(this._convertPointElevation(p,z),q);p=B.pointToVector(p);q=yield this._fetchCandidates(p,S.SnappingDomain.FEATURE,z,m);if(0<q.length)return B=yield this._fetchCandidates(p,S.SnappingDomain.SELF,
z,m),this._createSnapResult(p,e.SCENE,[...q,...B],k,z,m);d=this._convertPointElevation(d,z);B=B.pointToVector(d);d=yield this._fetchCandidates(B,S.SnappingDomain.SELF,z,m);return this._createSnapResult(B,e.MAIN,d,k,z,m)});return function(d){return H.apply(this,arguments)}}();r._fetchCandidates=function(){var H=u._asyncToGenerator(function*(d,p,z,m){return(yield Promise.all(this._engines.map(k=>k.fetchCandidates(d,p,z,m)))).flat()});return function(d,p,z,m){return H.apply(this,arguments)}}();r._createSnapResult=
function(H,d,p,z,m,k){return{get valid(){return!w.isAborted(k)},apply:()=>{const {elevationInfo:B,coordinateHelper:q}=m,{snappedPoint:T,hints:n}=this._processCandidates(H,d,p,m);this._removeVisualization();F.isSome(m.visualizer)&&this.handles.add(m.visualizer.draw(n,{coordinateHelper:q,elevationInfo:P(m),view:z,selfSnappingZ:m.selfSnappingZ}),"visualization-handle");return this._convertPointElevation(T,m,I.absoluteHeightElevationInfo,B)}}};r._processCandidates=function(H,d,p,z){var {coordinateHelper:m}=
z;if(1>p.length)return this.doneSnapping(),{snappedPoint:m.vectorToDehydratedPoint(H),hints:[]};this._currentSnappedType!==d&&this._resetSnappingState();E.sortCandidatesInPlace(H,p,m);m=this._currentMainCandidate;if(F.isSome(m)){const k=this._findOldConstraintInNewCandidates(m,p);if(0<=k)if(p[k]instanceof J.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(H,m.targetPoint,z))return this._updateSnappingCandidate(m,d,p,z)}else return this._intersectWithOtherCandidates(k,p,H,d,z)}return this._intersectWithOtherCandidates(0,
p,H,d,z)};r._findOldConstraintInNewCandidates=function(H,d){return H instanceof J.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(d,H.first)&&0<=this._findOldCandidateIndex(d,H.second)?0:-1:this._findOldCandidateIndex(d,H)};r._intersectWithOtherCandidates=function(H,d,p,z,m){const {coordinateHelper:k}=m,B=d[H],q=[];for(let T=0;T<d.length;++T){if(T===H)continue;const n=d[T];for(const x of B.constraint.intersect(n.constraint)){const G=k.fromXYZ(x.closestTo(B.targetPoint),B.targetPoint[2]);
q.push([new J.IntersectionSnappingCandidate(k,G,B,n,n.elevationInfo),this._squaredScreenDistance(p,G,k)])}}return 0<q.length&&(q.sort((T,n)=>T[1]-n[1]),q[0][1]<this._squaredPointProximityThreshold(m.pointer))?this._updateSnappingCandidate(q[0][0],z,d,m):this._updateSnappingCandidate(B,z,d,m)};r._updateSnappingCandidate=function(H,d,p,z){this.doneSnapping();this._currentMainCandidate=H;this._currentSnappedType=d;d=this._currentMainCandidate.targetPoint;const m=[];m.push(...H.hints);for(const k of p){if(H instanceof
J.IntersectionSnappingCandidate){if(k.constraint.equals(H.first.constraint)||k.constraint.equals(H.second.constraint))continue}else if(k.constraint.equals(H.constraint))continue;k.constraint.check(d)&&(k.targetPoint=d,this._currentOtherActiveCandidates.push(k),m.push(...k.hints))}return{snappedPoint:z.coordinateHelper.vectorToDehydratedPoint(d),hints:m}};r._squaredPointProximityThreshold=function(H){return"touch"===H?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};r._arePointsWithinScreenThreshold=
function(H,d,p){return this._squaredScreenDistance(H,d,p.coordinateHelper)<this._squaredPointProximityThreshold(p.pointer)};r._squaredScreenDistance=function(H,d,p){return E.squaredScreenDistance(this._toScreen(H,p),this._toScreen(d,p))};r._toScreen=function(H,d){return A.anyMapPointToScreenPoint(H,d,I.absoluteHeightElevationInfo,this.view)};r._findOldCandidateIndex=function(H,d){let p=-1;for(let z=0;z<H.length;++z)if(d.constraint.equals(H[z].constraint)){p=z;break}return p};r._convertPointElevation=
function(H,d,p=d.elevationInfo,z=I.absoluteHeightElevationInfo){const {view:m}=this;if(!(F.isSome(H)&&d.coordinateHelper.hasZ()&&F.isSome(m)&&"3d"===m.type))return H;H=C.clone(H);H.z=I.getConvertedElevation(m,H,p,z);return H};u._createClass(b,[{key:"updating",get:function(){return this._engines.some(H=>H.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:H,touchSensitivityMultiplier:d}=
this.options,p=H*d;return p*p}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return b}(O.EventedMixin(l.HandleOwner));f.__decorate([h.property({constructOnly:!0})],g.SnappingManager.prototype,"view",void 0);f.__decorate([h.property()],g.SnappingManager.prototype,"options",void 0);f.__decorate([h.property({readOnly:!0})],g.SnappingManager.prototype,"updating",null);f.__decorate([h.property()],g.SnappingManager.prototype,
"snappingEnginesFactory",void 0);f.__decorate([h.property()],g.SnappingManager.prototype,"_engines",void 0);f.__decorate([h.property()],g.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);f.__decorate([h.property()],g.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);g.SnappingManager=f.__decorate([Q.subclass("esri.views.interactive.snapping.SnappingManager")],g.SnappingManager);var e;(function(c){c[c.MAIN=0]="MAIN";c[c.SCENE=1]="SCENE"})(e||(e={}));Object.defineProperties(g,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(g){g.SnappingDomain=void 0;var u=g.SnappingDomain||(g.SnappingDomain={});u[u.FEATURE=1]="FEATURE";u[u.SELF=2]="SELF";u[u.ALL=3]="ALL";Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],
function(g,u,f){g.defaultSnappingEnginesFactory=function(O,l){return[new f.SelfSnappingEngine({view:O,options:l}),new u.FeatureSnappingEngine({view:O,options:l,spatialReference:O.spatialReference})]};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/data/QueryEngineResult ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./snappingUtils ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e,c,b,r,H){function d(B,q,T,n,x,G,{coordinateHelper:K}){q=R.copy(k,q);q[0]+=T;q[1]+=n;q[2]+=x;T=H.vectorToScreenPoint(q,K.spatialReference,J.absoluteHeightElevationInfo,G);return e.screenDistance(T,B)}u.FeatureSnappingEngine=function(B){function q(n){n=B.call(this,n)||this;n.options=null;n._domain=P.SnappingDomain.FEATURE;n._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},
notes:{module:null,loader:null},scene:{module:null,loader:null}};return n}f._inheritsLoose(q,B);var T=q.prototype;T.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),h.sync);w.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",n=>this._updateLayerView(n.layer,n.layerView)),this.view.on("layerview-destroy",n=>this._updateLayerView(n.layer,null))])};T._updateLayerView=function(n,x){for(const [,G]of this.snappingSources)G.snappingSource.layerSource.layer===
n&&(G.layerView=x)};T.destroy=function(){this._set("options",null);for(const [,n]of this.snappingSources)n.destroy()};T.fetchCandidates=function(){var n=f._asyncToGenerator(function*(x,G,K,U){if(!(G&this._domain)||w.isNone(this.options)||!this.options.effectiveFeatureEnabled)return[];var Y=[];G=this._computeScreeenSizeDistanceParameters(x,K);const ba={distance:G,point:x,coordinateHelper:K.coordinateHelper,types:this._types};for(const [,{snappingSource:la,layerView:pa}]of this.snappingSources)!la.layerSource.enabled||
w.isSome(pa)&&pa.suspended||Y.push(la.fetchCandidates(ba,U).then(va=>va.filter(xa=>!this._candidateIsExcluded(la,xa,K.excludeFeature))));Y=(yield M.eachAlwaysValues(Y)).flat();this._addRightAngleCandidates(Y,x,G,K);M.throwIfAborted(U);e.sortCandidatesInPlace(x,Y,K.coordinateHelper);return Y});return function(x,G,K,U){return n.apply(this,arguments)}}();T._addRightAngleCandidates=function(n,x,G,K){var U=w.isSome(K.vertexHandle)?K.vertexHandle.rightEdge?.rightVertex?.pos:w.isSome(K.editGeometryOperations)&&
"polygon"===K.editGeometryOperations.data.type?w.unwrap(K.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,Y=w.isSome(K.vertexHandle)?K.vertexHandle.leftEdge?.leftVertex?.pos:w.isSome(K.editGeometryOperations)?w.unwrap(K.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,{view:ba}=this;U=e.convertPointElevation(U,ba,K);Y=e.convertPointElevation(Y,ba,K);ba=n.length;for(let la=0;la<ba;la++)this._addRightAngleCandidate(n[la],Y,x,G,K,n),this._addRightAngleCandidate(n[la],
U,x,G,K,n)};T._addRightAngleCandidate=function(n,x,G,K,U,Y){var ba=n instanceof c.EdgeSnappingCandidate,la=ba&&S.equals(n.constraint.start,n.constraint.end);w.isNone(x)||!ba||la||(ba=n.constraint.closestTo(x),la=(ba[0]-G[0])/K.x,G=(ba[1]-G[1])/K.y,1>=la*la+G*G&&(U=U.coordinateHelper,n=new r.RightAngleSnappingCandidate({coordinateHelper:U,targetPoint:ba,otherVertex:x,otherVertexType:r.OtherVertexType.NEXT,previousVertex:n.constraint.start,constraint:new A.VerticalHalfPlaneConstraint(U,x,ba),objectId:n.objectId,
elevationInfo:n.elevationInfo}),Y.push(n)))};T._computeScreeenSizeDistanceParameters=function(n,x){let G=w.isSome(this.options)?this.options.distance*("touch"===x.pointer?this.options.touchSensitivityMultiplier:1):0;return w.isNone(this.view)?{x:G,y:G,z:G,distance:G}:"2d"===this.view.type?(G*=this.view.resolution,{x:G,y:G,z:G,distance:G}):this._computeScreenSizeDistanceParameters3D(n,G,this.view,x)};T._computeScreenSizeDistanceParameters3D=function(n,x,G,K){const {coordinateHelper:U,elevationInfo:Y}=
K;var {spatialReference:ba}=U,la=U.hasZ()?J.absoluteHeightElevationInfo:Y;n=U.toXYZ(n,z);n[2]=J.getConvertedElevationFromVector(G,n,ba,la,J.absoluteHeightElevationInfo);G.renderCoordsHelper.toRenderCoords(n,ba,m);la=G.state.camera.computeScreenPixelSizeAt(m);const pa=la*G.renderCoordsHelper.unitInMeters/G.mapCoordsHelper.unitInMeters,va=x*pa,xa=H.vectorToScreenPoint(n,ba,J.absoluteHeightElevationInfo,G);ba=d(xa,n,pa,0,0,G,K);const Aa=d(xa,n,0,pa,0,G,K);G=d(xa,n,0,0,pa,G,K);return{x:0===ba?0:va/ba,
y:0===Aa?0:va/Aa,z:0===G?0:va/G,distance:la*x}};T._candidateIsExcluded=function(n,x,G){if(w.isNone(G))return!1;x=this._getCandidateObjectId(x);if(w.isNone(x))return!1;n=n.layerSource.layer;return"graphics"===n.type?G.uid===x:G.sourceLayer===n&&G.attributes&&"objectIdField"in n?G.attributes[n.objectIdField]===x:!1};T._getCandidateObjectId=function(n){return n instanceof b.FeatureSnappingCandidate?n.objectId:null};T._createSourceInfo=function(n){const x=this._createFeatureSnappingSourceType(n);if(w.isNone(x))return null;
if("loading"in x)return this.updatingHandles.addPromise(x.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const G=w.isSome(this.view)?this.view.allLayerViews.find(K=>K.layer===n.layer):null;return new p(x.source,G)};T._createFeatureSnappingSourceType=function(n){switch(n.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(n);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(n);
case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(n);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(n)}return null};T._createFeatureSnappingSourceSceneLayer=function(n){const {view:x}=this;if(w.isNone(x)||"3d"!==x.type)return null;const G=this._getSourceModule("scene");return w.isSome(G.module)?{source:new G.module.SceneLayerSnappingSource({layerSource:n,view:x})}:{loading:G.loader}};T._createFeatureSnappingSourceFeatureLayer=function(n){switch(n.layer.source.type){case "feature-layer":case "oriented-imagery":var x=
this._getSourceModule("featureService");return w.isSome(x.module)?{source:new x.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:n})}:{loading:x.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==n.layer.geometryType)return x=this._getSourceModule("featureCollection"),w.isSome(x.module)?{source:new x.module.FeatureCollectionSnappingSource({layerSource:n,view:this.view})}:{loading:x.loader}}return null};T._createFeatureSnappingSourceGraphicsLayer=
function(n){const x=this._getSourceModule("graphics");return w.isSome(x.module)?{source:new x.module.GraphicsSnappingSource({getGraphicsLayers:()=>[n.layer],spatialReference:this.spatialReference,view:this.view,layerSource:n})}:{loading:x.loader}};T._createFeatureSnappingSourceMapNotesLayer=function(n){const x=this._getSourceModule("notes");return w.isSome(x.module)?{source:new x.module.GraphicsSnappingSource({getGraphicsLayers:()=>w.isSome(n.layer.sublayers)?n.layer.sublayers.toArray():[],spatialReference:this.spatialReference,
view:this.view,layerSource:n})}:{loading:x.loader}};T._getSourceModule=function(n){const x=this._sourceModules[n];return w.isNone(x.loader)?(n=this._loadSourceModule(n).then(G=>{x.module=G}),x.loader=n,{module:x.module,loader:n}):{module:x.module,loader:x.loader}};T._loadSourceModule=function(n){const x=this.updatingHandles;switch(n){case "featureService":return x.addPromise(new Promise((G,K)=>g(["./featureSources/FeatureServiceSnappingSource"],G,K)));case "featureCollection":return x.addPromise(new Promise((G,
K)=>g(["./featureSources/FeatureCollectionSnappingSource"],G,K)));case "graphics":return x.addPromise(new Promise((G,K)=>g(["./featureSources/GraphicsSnappingSource"],G,K)));case "notes":return x.addPromise(new Promise((G,K)=>g(["./featureSources/GraphicsSnappingSource"],G,K)));case "scene":return x.addPromise(new Promise((G,K)=>g(["./featureSources/SceneLayerSnappingSource"],G,K)))}return null};f._createClass(q,[{key:"updating",get:function(){return F.someMap(this.snappingSources,({snappingSource:n})=>
n.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const n=this._get("snappingSources")||new Map,x=new Map;if(w.isSome(this.options)&&w.isSome(this.options.featureSources))for(const K of this.options.featureSources.items){const U=K.layer.uid;var G=n.get(U);G?(n.delete(U),x.set(U,G)):K.layer.loaded?(G=this._createSourceInfo(K),w.isSome(G)&&x.set(U,G)):this.updatingHandles.addPromise(K.layer.load())}for(const [,K]of n)K.destroy();return x}},{key:"_types",get:function(){return E.SnappingTypes.EDGE|
E.SnappingTypes.VERTEX}}]);return q}(l.HandleOwner);O.__decorate([L.property({constructOnly:!0})],u.FeatureSnappingEngine.prototype,"spatialReference",void 0);O.__decorate([L.property({constructOnly:!0})],u.FeatureSnappingEngine.prototype,"view",void 0);O.__decorate([L.property()],u.FeatureSnappingEngine.prototype,"options",void 0);O.__decorate([L.property({readOnly:!0})],u.FeatureSnappingEngine.prototype,"updating",null);O.__decorate([L.property({readOnly:!0})],u.FeatureSnappingEngine.prototype,
"snappingSources",null);u.FeatureSnappingEngine=O.__decorate([I.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],u.FeatureSnappingEngine);let p=function(){function B(q,T){this.snappingSource=q;this.layerView=T;this.handles=new C;T=this.snappingSource.layerSource.layer;"refresh"in T&&this.handles.add(T.on("refresh",()=>q.refresh()));this.handles.add([h.watch(()=>q.updating,n=>q.layerSource.updating=n,h.syncAndInitial),h.watch(()=>q.availability,n=>q.layerSource.availability=n,h.syncAndInitial)])}
B.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return B}();const z=D.create(),m=D.create(),k=D.create();Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(g,u){function f(K,U){K[0]=U[0];K[1]=U[1];return K}function O(K,U,Y){K[0]=U;K[1]=Y;return K}function l(K,U,Y){K[0]=U[0]+Y[0];K[1]=U[1]+Y[1];return K}function C(K,U,Y){K[0]=U[0]-Y[0];K[1]=U[1]-Y[1];return K}
function F(K,U,Y){K[0]=U[0]*Y[0];K[1]=U[1]*Y[1];return K}function w(K,U,Y){K[0]=U[0]/Y[0];K[1]=U[1]/Y[1];return K}function M(K,U){K[0]=Math.ceil(U[0]);K[1]=Math.ceil(U[1]);return K}function h(K,U){K[0]=Math.floor(U[0]);K[1]=Math.floor(U[1]);return K}function L(K,U,Y){K[0]=Math.min(U[0],Y[0]);K[1]=Math.min(U[1],Y[1]);return K}function Q(K,U,Y){K[0]=Math.max(U[0],Y[0]);K[1]=Math.max(U[1],Y[1]);return K}function y(K,U){K[0]=Math.round(U[0]);K[1]=Math.round(U[1]);return K}function I(K,U,Y){K[0]=U[0]*
Y;K[1]=U[1]*Y;return K}function S(K,U,Y,ba){K[0]=U[0]+Y[0]*ba;K[1]=U[1]+Y[1]*ba;return K}function R(K,U){const Y=U[0]-K[0];K=U[1]-K[1];return Math.sqrt(Y*Y+K*K)}function D(K,U){const Y=U[0]-K[0];K=U[1]-K[1];return Y*Y+K*K}function E(K){const U=K[0];K=K[1];return Math.sqrt(U*U+K*K)}function J(K){const U=K[0];K=K[1];return U*U+K*K}function A(K,U){K[0]=-U[0];K[1]=-U[1];return K}function P(K,U){K[0]=1/U[0];K[1]=1/U[1];return K}function e(K,U){var Y=U[0];const ba=U[1];Y=Y*Y+ba*ba;0<Y&&(Y=1/Math.sqrt(Y),
K[0]=U[0]*Y,K[1]=U[1]*Y);return K}function c(K,U){return K[0]*U[0]+K[1]*U[1]}function b(K,U,Y){U=U[0]*Y[1]-U[1]*Y[0];K[0]=K[1]=0;K[2]=U;return K}function r(K,U,Y,ba){const la=U[0];U=U[1];K[0]=la+ba*(Y[0]-la);K[1]=U+ba*(Y[1]-U);return K}function H(K,U){U=U||1;const Y=2*u.RANDOM()*Math.PI;K[0]=Math.cos(Y)*U;K[1]=Math.sin(Y)*U;return K}function d(K,U,Y){const ba=U[0];U=U[1];K[0]=Y[0]*ba+Y[2]*U;K[1]=Y[1]*ba+Y[3]*U;return K}function p(K,U,Y){const ba=U[0];U=U[1];K[0]=Y[0]*ba+Y[2]*U+Y[4];K[1]=Y[1]*ba+Y[3]*
U+Y[5];return K}function z(K,U,Y){const ba=U[0];U=U[1];K[0]=Y[0]*ba+Y[3]*U+Y[6];K[1]=Y[1]*ba+Y[4]*U+Y[7];return K}function m(K,U,Y){const ba=U[0];U=U[1];K[0]=Y[0]*ba+Y[4]*U+Y[12];K[1]=Y[1]*ba+Y[5]*U+Y[13];return K}function k(K,U,Y,ba){const la=U[0]-Y[0];U=U[1]-Y[1];const pa=Math.sin(ba);ba=Math.cos(ba);K[0]=la*ba-U*pa+Y[0];K[1]=la*pa+U*ba+Y[1];return K}function B(K,U){var Y=K[0];K=K[1];const ba=U[0];U=U[1];let la=Y*Y+K*K;0<la&&(la=1/Math.sqrt(la));let pa=ba*ba+U*U;0<pa&&(pa=1/Math.sqrt(pa));Y=(Y*
ba+K*U)*la*pa;return 1<Y?0:-1>Y?Math.PI:Math.acos(Y)}function q(K){return"vec2("+K[0]+", "+K[1]+")"}function T(K,U){return K[0]===U[0]&&K[1]===U[1]}function n(K,U){const Y=K[0];K=K[1];const ba=U[0];U=U[1];const la=u.getEpsilon();return Math.abs(Y-ba)<=la*Math.max(1,Math.abs(Y),Math.abs(ba))&&Math.abs(K-U)<=la*Math.max(1,Math.abs(K),Math.abs(U))}function x(K,U,Y,ba,la){let pa=U[0]-Y[0];Y=U[1]-Y[1];la=(ba[0]*pa+ba[1]*Y)*(la-1);pa=ba[0]*la;Y=ba[1]*la;K[0]=U[0]+pa;K[1]=U[1]+Y;return K}const G=Object.freeze(Object.defineProperty({__proto__:null,
copy:f,set:O,add:l,subtract:C,multiply:F,divide:w,ceil:M,floor:h,min:L,max:Q,round:y,scale:I,scaleAndAdd:S,distance:R,squaredDistance:D,length:E,squaredLength:J,negate:A,inverse:P,normalize:e,dot:c,cross:b,lerp:r,random:H,transformMat2:d,transformMat2d:p,transformMat3:z,transformMat4:m,rotate:k,angle:B,str:q,exactEquals:T,equals:n,projectAndScale:x,len:E,sub:C,mul:F,div:w,dist:R,sqrDist:D,sqrLen:J},Symbol.toStringTag,{value:"Module"}));g.add=l;g.angle=B;g.ceil=M;g.copy=f;g.cross=b;g.dist=R;g.distance=
R;g.div=w;g.divide=w;g.dot=c;g.equals=n;g.exactEquals=T;g.floor=h;g.inverse=P;g.len=E;g.length=E;g.lerp=r;g.max=Q;g.min=L;g.mul=F;g.multiply=F;g.negate=A;g.normalize=e;g.projectAndScale=x;g.random=H;g.rotate=k;g.round=y;g.scale=I;g.scaleAndAdd=S;g.set=O;g.sqrDist=D;g.sqrLen=J;g.squaredDistance=D;g.squaredLength=J;g.str=q;g.sub=C;g.subtract=C;g.transformMat2=d;g.transformMat2d=p;g.transformMat3=z;g.transformMat4=m;g.vec2=G})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S){function R(A,P,e,c){const b=c.x-e.x;c=c.y-e.y;P=Math.min(1,Math.max(0,((P.x-e.x)*b+(P.y-e.y)*c)/(b*b+c*c)));A.x=e.x+b*P;A.y=e.y+c*P}function D(A,P){return A?P?4:3:P?3:2}let E=function(){function A(e,c,b){this.items=e;this.query=c;this.geometryType=b.geometryType;this.hasM=b.hasM;this.hasZ=b.hasZ;this.fieldsIndex=b.fieldsIndex;this.objectIdField=b.objectIdField;this.spatialReference=b.spatialReference;this.featureAdapter=b.featureAdapter}var P=A.prototype;P.createQueryResponseForCount=
function(){const e=new M(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const {groupByFieldsForStatistics:c,having:b,outStatistics:r}=this.query;if(!c?.length)return 1;const H=new Map,d=new Map,p=new Set;for(const k of r){var {statisticType:z}=k;z="exceedslimit"!==z?k.onStatisticField:void 0;if(!d.has(z)){var m=[];for(const B of c){const q=this._getAttributeValues(e,B,H);m.push(q)}d.set(z,this._calculateUniqueValues(m,e.returnDistinctValues))}z=
d.get(z);for(const B in z){const {data:q,items:T}=z[B];m=q.join(",");b&&!e.validateItems(T,b)||p.add(m)}}return p.size};P.createQueryResponse=function(){var e=f._asyncToGenerator(function*(){let c;c=this.query.outStatistics?this.query.outStatistics.some(b=>"exceedslimit"===b.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);this.query.returnQueryGeometry&&(w.isValid(this.query.outSR)&&
!w.equals(this.query.geometry.spatialReference,this.query.outSR)?c.queryGeometry=Q.cleanFromGeometryEngine({spatialReference:this.query.outSR,...h.project(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):c.queryGeometry=Q.cleanFromGeometryEngine({spatialReference:this.query.outSR,...this.query.geometry}));return c});return function(){return e.apply(this,arguments)}}();P.createSnappingResponse=function(e,c){const b=this.featureAdapter,r=D(this.hasZ,this.hasM),{point:H}=
e,d="number"===typeof e.distance?e.distance:e.distance.x,p="number"===typeof e.distance?e.distance:e.distance.y,z={candidates:[]},m="esriGeometryPolygon"===this.geometryType;c=this._getPointCreator(H,null!=H.z,null!=H.m,this.spatialReference,c);const k=new J(null,0),B=new J(null,0),q={x:0,y:0,z:0};for(const Y of this.items){var T=b.getGeometry(Y);if(O.isNone(T))continue;const {coords:ba,lengths:la}=T;k.coords=ba;B.coords=ba;if(e.types&u.SnappingTypes.EDGE){T=0;for(var n=0;n<la.length;n++){var x=la[n];
for(var G=0;G<x;G++,T+=r){var K=k;K.coordsIndex=T;if(G!==x-1){const pa=B;pa.coordsIndex=T+r;const va=q;R(q,H,K,pa);var U=(H.x-va.x)/d;const xa=(H.y-va.y)/p;U=U*U+xa*xa;1>=U&&z.candidates.push(L.makeEdgeCandidate(b.getObjectId(Y),c(va),Math.sqrt(U),c(K),c(pa)))}}}}if(e.types&u.SnappingTypes.VERTEX)for(T=m?ba.length-r:ba.length,n=0;n<T;n+=r)x=k,x.coordsIndex=n,G=(H.x-x.x)/d,K=(H.y-x.y)/p,G=G*G+K*K,1>=G&&z.candidates.push(L.makeVertexCandidate(b.getObjectId(Y),c(x),Math.sqrt(G)))}z.candidates.sort((Y,
ba)=>Y.distance-ba.distance);return z};P._getPointCreator=function(e,c,b,r,H){const d=O.isSome(H)&&!w.equals(r,H)?m=>h.project(m,r,H):m=>m,{hasZ:p}=this,z=e.m;return c&&b?p?({x:m,y:k,z:B})=>d({x:m,y:k,z:B,m:z}):({x:m,y:k})=>d({x:m,y:k,z:0,m:z}):c?p?({x:m,y:k,z:B})=>d({x:m,y:k,z:B}):({x:m,y:k})=>d({x:m,y:k,z:0}):b?({x:m,y:k})=>d({x:m,y:k,m:z}):({x:m,y:k})=>d({x:m,y:k})};P.createSummaryStatisticsResponse=function(){var e=f._asyncToGenerator(function*(c){const {field:b,valueExpression:r,normalizationField:H,
normalizationType:d,normalizationTotal:p,minValue:z,maxValue:m,scale:k}=c;c=this.fieldsIndex.isDateField(b);var B=yield this._getDataValues({field:b,valueExpression:r,normalizationField:H,normalizationType:d,normalizationTotal:p,scale:k});const q=I.isNullCountSupported({normalizationType:d,normalizationField:H,minValue:z,maxValue:m}),T=this.fieldsIndex.get(b),n={value:.5,fieldType:T?.type};B=y.isStringField(T)?I.calculateStringStatistics({values:B,supportsNullCount:q,percentileParams:n}):I.calculateStatistics({values:B,
minValue:z,maxValue:m,useSampleStdDev:!d,supportsNullCount:q,percentileParams:n});return I.processSummaryStatisticsResult(B,c)});return function(c){return e.apply(this,arguments)}}();P.createUniqueValuesResponse=function(){var e=f._asyncToGenerator(function*(c){const {field:b,valueExpression:r,domains:H,returnAllCodedValues:d,scale:p}=c;var z=yield this._getDataValues({field:b,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,valueExpression:r,scale:p});z=I.calculateUniqueValuesCount(z);
return I.createUVResult(z,H,d,c.fieldDelimiter)});return function(c){return e.apply(this,arguments)}}();P.createClassBreaksResponse=function(){var e=f._asyncToGenerator(function*(c){const {field:b,valueExpression:r,normalizationField:H,normalizationType:d,normalizationTotal:p,classificationMethod:z,standardDeviationInterval:m,minValue:k,maxValue:B,numClasses:q,scale:T}=c;c=yield this._getDataValues({field:b,valueExpression:r,normalizationField:H,normalizationType:d,normalizationTotal:p,scale:T});
c=I.calculateClassBreaks(c,{field:b,normalizationField:H,normalizationType:d,normalizationTotal:p,classificationMethod:z,standardDeviationInterval:m,minValue:k,maxValue:B,numClasses:q});return I.resolveCBResult(c,z)});return function(c){return e.apply(this,arguments)}}();P.createHistogramResponse=function(){var e=f._asyncToGenerator(function*(c){const {field:b,valueExpression:r,normalizationField:H,normalizationType:d,normalizationTotal:p,classificationMethod:z,standardDeviationInterval:m,minValue:k,
maxValue:B,numBins:q,scale:T}=c;c=yield this._getDataValues({field:b,valueExpression:r,normalizationField:H,normalizationType:d,normalizationTotal:p,scale:T});return I.calculateHistogram(c,{field:b,normalizationField:H,normalizationType:d,normalizationTotal:p,classificationMethod:z,standardDeviationInterval:m,minValue:k,maxValue:B,numBins:q})});return function(c){return e.apply(this,arguments)}}();P._sortFeatures=function(e,c,b){if(1<e.length&&c&&c.length)for(const r of c.reverse()){c=r.split(" ");
const H=c[0],d=this.fieldsIndex.get(H);c=c[1]&&"desc"===c[1].toLowerCase();const p=I.getAttributeComparator(d?.type,c);e.sort((z,m)=>{z=b(z,H,d);m=b(m,H,d);return p(z,m)})}};P._createFeatureQueryResponse=function(e){const c=this.items,{geometryType:b,hasM:r,hasZ:H,objectIdField:d,spatialReference:p}=this,{outFields:z,outSR:m,quantizationParameters:k,resultRecordCount:B,resultOffset:q,returnZ:T,returnM:n}=e,x=null!=B?c.length>(q||0)+B:!1,G=z&&(z.includes("*")?[...this.fieldsIndex.fields]:z.map(K=>
this.fieldsIndex.get(K)));return{exceededTransferLimit:x,features:this._createFeatures(e,c),fields:G,geometryType:b,hasM:r&&n,hasZ:H&&T,objectIdFieldName:d,spatialReference:Q.cleanFromGeometryEngine(m?m:p),transform:k&&F.toQuantizationTransform(k)||null}};P._createFeatures=function(e,c){const b=new M(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:H}=this,{orderByFields:d,quantizationParameters:p,returnGeometry:z,returnCentroid:m,maxAllowableOffset:k,resultOffset:B,resultRecordCount:q,returnZ:T=
!1,returnM:n=!1}=e,x=H&&T,G=r&&n;e=[];var K=0;c=[...c];this._sortFeatures(c,d,(ba,la,pa)=>b.getFieldValue(ba,la,pa));if(z||m){var U=F.toQuantizationTransform(p);if(z&&!m)for(var Y of c)e[K++]={attributes:b.getAttributes(Y),geometry:Q.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(Y),k,U,x,G)};else if(!z&&m)for(const ba of c)e[K++]={attributes:b.getAttributes(ba),centroid:Q.transformCentroid(this,this.featureAdapter.getCentroid(ba,this),U)};else for(const ba of c)e[K++]=
{attributes:b.getAttributes(ba),centroid:Q.transformCentroid(this,this.featureAdapter.getCentroid(ba,this),U),geometry:Q.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ba),k,U,x,G)}}else for(U of c)(Y=b.getAttributes(U))&&(e[K++]={attributes:Y});K=B||0;null!=q&&(e=e.slice(K,Math.min(e.length,K+q)));return e};P._createExceedsLimitQueryResponse=function(e){var c=!1;let b=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;c=Number.POSITIVE_INFINITY;for(const H of e.outStatistics)if("exceedslimit"===
H.statisticType){b=null!=H.maxPointCount?H.maxPointCount:Number.POSITIVE_INFINITY;r=null!=H.maxRecordCount?H.maxRecordCount:Number.POSITIVE_INFINITY;c=null!=H.maxVertexCount?H.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)c=this.items.length>b;else if(this.items.length>r)c=!0;else{e=D(this.hasZ,this.hasM);const H=this.featureAdapter;c=this.items.reduce((d,p)=>{p=H.getGeometry(p);return d+(O.isSome(p)&&p.coords.length||0)},0)/e>c}return{fields:[{name:"exceedslimit",
type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(c)}}]}};P._createStatisticsQueryResponse=function(){var e=f._asyncToGenerator(function*(c){var b={attributes:{}};const r=[],H=new Map,d=new Map,p=new Map,z=new Map,m=new M(c,this.featureAdapter,this.fieldsIndex);var k=c.outStatistics;const {groupByFieldsForStatistics:B,having:q,orderByFields:T}=c;c=B&&B.length;const n=!!c,x=n&&B[0],G=n&&!this.fieldsIndex.get(x);
for(const la of k){const {outStatisticFieldName:pa,statisticType:va}=la;k=la;var K="exceedslimit"!==va?la.onStatisticField:void 0;const xa="percentile_disc"===va||"percentile_cont"===va,Aa="EnvelopeAggregate"===va||"CentroidAggregate"===va||"ConvexHullAggregate"===va,Ga=n&&1===c&&(K===x||G)&&"count"===va;if(n){if(!p.has(K)){var U=[];for(const Da of B){var Y=this._getAttributeValues(m,Da,H);U.push(Y)}p.set(K,this._calculateUniqueValues(U,Aa?!1:m.returnDistinctValues))}U=p.get(K);for(const Da in U){const {count:da,
data:ja,items:ha,itemPositions:Z}=U[Da];Y=ja.join(",");if(!q||m.validateItems(ha,q)){const ca=z.get(Y)||{attributes:{}};if(Aa){ca.aggregateGeometries||(ca.aggregateGeometries={});const {aggregateGeometries:ea,outStatisticFieldName:na}=yield this._getAggregateGeometry(k,ha);ca.aggregateGeometries[na]=ea}else{var ba=null;if(Ga)ba=da;else{const ea=this._getAttributeValues(m,K,H);ba=Z.map(na=>ea[na]);ba=xa&&"statisticParameters"in k?this._getPercentileValue(k,ba):this._getStatisticValue(k,ba,null,m.returnDistinctValues)}ca.attributes[pa]=
ba}let fa=0;B.forEach((ea,na)=>ca.attributes[this.fieldsIndex.get(ea)?ea:`EXPR_${++fa}`]=ja[na]);z.set(Y,ca)}}}else if(Aa){b.aggregateGeometries||(b.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:da}=yield this._getAggregateGeometry(k,this.items);b.aggregateGeometries[da]=Da}else K=this._getAttributeValues(m,K,H),b.attributes[pa]=xa&&"statisticParameters"in k?this._getPercentileValue(k,K):this._getStatisticValue(k,K,d,m.returnDistinctValues);r.push({name:pa,alias:pa,type:"esriFieldTypeDouble"})}b=
n?Array.from(z.values()):[b];this._sortFeatures(b,T,(la,pa)=>la.attributes[pa]);return{fields:r,features:b}});return function(c){return e.apply(this,arguments)}}();P._getAggregateGeometry=function(){var e=f._asyncToGenerator(function*(c,b){var r=yield new Promise((T,n)=>g(["../../../geometry/geometryEngineJSON"],T,n));const {statisticType:H,outStatisticFieldName:d}=c,{featureAdapter:p,spatialReference:z,geometryType:m,hasZ:k,hasM:B}=this;b=b.map(T=>Q.getGeometry(m,k,B,p.getGeometry(T)));const q=r.convexHull(z,
b,!0)[0];c={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===H?(r=q?C.getPolygonExtent(q):C.getGeometryExtent(r.union(z,b)),c.aggregateGeometries={...r,spatialReference:z},c.outStatisticFieldName=d||"extent"):"CentroidAggregate"===H?(r=q?l.polygonCentroid(q):l.extentCentroid(C.getGeometryExtent(r.union(z,b))),c.aggregateGeometries={x:r[0],y:r[1],spatialReference:z},c.outStatisticFieldName=d||"centroid"):"ConvexHullAggregate"===H&&(c.aggregateGeometries=q,c.outStatisticFieldName=
d||"convexHull");return c});return function(c,b){return e.apply(this,arguments)}}();P._getStatisticValue=function(e,c,b,r){const {onStatisticField:H,statisticType:d}=e;e=null;e=b?.has(H)?b.get(H):y.isStringField(this.fieldsIndex.get(H))?I.calculateStringStatistics({values:c,returnDistinct:r}):I.calculateStatistics({values:c,minValue:null,maxValue:null,useSampleStdDev:!0});b&&b.set(H,e);return e["var"===d?"variance":d]};P._getPercentileValue=function(e,c){const {onStatisticField:b,statisticParameters:r,
statisticType:H}=e,{value:d,orderBy:p}=r;e=this.fieldsIndex.get(b);return I.calculatePercentile(c,{value:d,orderBy:p,fieldType:e?.type,isDiscrete:"percentile_disc"===H})};P._getAttributeValues=function(e,c,b){if(b.has(c))return b.get(c);const r=this.fieldsIndex.get(c),H=this.items.map(d=>e.getFieldValue(d,c,r));b.set(c,H);return H};P._getAttributeDataValues=function(e,c){return this.items.map(b=>e.getDataValue(b,{field:c.field,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:c.normalizationField,
normalizationType:c.normalizationType,normalizationTotal:c.normalizationTotal}))};P._getAttributeExpressionValues=function(){var e=f._asyncToGenerator(function*(c,b,r){const {arcadeUtils:H}=yield S.loadArcade();b=H.createFunction(b);r=r&&H.getViewInfo(r);return c.getExpressionValues(this.items,b,r,H)});return function(c,b,r){return e.apply(this,arguments)}}();P._calculateUniqueValues=function(e,c){const b={},r=this.items,H=r.length;for(let d=0;d<H;d++){const p=r[d],z=[];for(const k of e)z.push(k[d]);
const m=z.join(",");c?null==b[m]&&(b[m]={count:1,data:z,items:[p],itemPositions:[d]}):null==b[m]?b[m]={count:1,data:z,items:[p],itemPositions:[d]}:(b[m].count++,b[m].items.push(p),b[m].itemPositions.push(d))}return b};P._getDataValues=function(){var e=f._asyncToGenerator(function*(c){const b=new M(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:r,field:H,normalizationField:d,normalizationType:p,normalizationTotal:z,scale:m}=c,k=r?{viewingMode:"map",scale:m,spatialReference:this.query.outSR||
this.spatialReference}:null;return r?this._getAttributeExpressionValues(b,r,k):this._getAttributeDataValues(b,{field:H,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:d,normalizationType:p,normalizationTotal:z})});return function(c){return e.apply(this,arguments)}}();f._createClass(A,[{key:"size",get:function(){return this.items.length}}]);return A}();u.SnappingTypes=void 0;(function(A){A[A.NONE=0]="NONE";A[A.EDGE=1]="EDGE";A[A.VERTEX=2]="VERTEX"})(u.SnappingTypes||
(u.SnappingTypes={}));let J=function(){function A(P,e){this.coords=P;this.coordsIndex=e}f._createClass(A,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return A}();u.QueryEngineResult=E;Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe",
"./jsonUtils"],function(g,u,f){function O({scale:d,translate:p},z){return Math.round((z-p[0])/d[0])}function l({scale:d,translate:p},z){return Math.round((p[1]-z)/d[1])}function C(d,p,z){const m=[];let k,B,q,T;for(let n=0;n<z.length;n++){const x=z[n];if(0<n){if(q=O(d,x[0]),T=l(d,x[1]),q!==k||T!==B)m.push(p(x,q-k,T-B)),k=q,B=T}else k=O(d,x[0]),B=l(d,x[1]),m.push(p(x,k,B))}return 0<m.length?m:null}function F(d,p,z,m){return C(d,z?m?H:r:m?r:b,p)}function w(d,p,z,m){const k=[];z=z?m?H:r:m?r:b;for(m=0;m<
p.length;m++){const B=C(d,z,p[m]);B&&3<=B.length&&k.push(B)}return k.length?k:null}function M(d,p,z,m){const k=[];z=z?m?H:r:m?r:b;for(m=0;m<p.length;m++){const B=C(d,z,p[m]);B&&2<=B.length&&k.push(B)}return k.length?k:null}function h({scale:d,translate:p},z){return z*d[0]+p[0]}function L({scale:d,translate:p},z){return p[1]-z*d[1]}function Q(d,p,z){const m=Array(z.length);if(!z.length)return m;const [k,B]=d.scale;let q=h(d,z[0][0]);d=L(d,z[0][1]);m[0]=p(z[0],q,d);for(let T=1;T<z.length;T++){const n=
z[T];q+=n[0]*k;d-=n[1]*B;m[T]=p(n,q,d)}return m}function y(d,p,z){const m=Array(z.length);for(let k=0;k<z.length;k++)m[k]=Q(d,p,z[k]);return m}function I(d,p,z,m){return Q(d,z?m?H:r:m?r:b,p)}function S(d,p,z,m){return y(d,z?m?H:r:m?r:b,p)}function R(d,p,z,m){return y(d,z?m?H:r:m?r:b,p)}function D(d,p,z){let [m,k]=z[0],B=Math.min(m,p[0]),q=Math.min(k,p[1]),T=Math.max(m,p[2]);p=Math.max(k,p[3]);for(let n=1;n<z.length;n++){const [x,G]=z[n];m+=x;k+=G;0>x&&(B=Math.min(B,m));0<x&&(T=Math.max(T,m));0>G?
q=Math.min(q,k):0<G&&(p=Math.max(p,k))}d[0]=B;d[1]=q;d[2]=T;d[3]=p;return d}function E(d,p){if(!p.length)return null;d[0]=d[1]=Number.POSITIVE_INFINITY;d[2]=d[3]=Number.NEGATIVE_INFINITY;for(let z=0;z<p.length;z++)D(d,d,p[z]);return d}function J(d,p,z,m,k){p.xmin=O(d,z.xmin);p.ymin=l(d,z.ymin);p.xmax=O(d,z.xmax);p.ymax=l(d,z.ymax);p!==z&&(m&&(p.zmin=z.zmin,p.zmax=z.zmax),k&&(p.mmin=z.mmin,p.mmax=z.mmax));return p}function A(d,p,z,m,k){p.points=F(d,z.points,m,k)??[];return p}function P(d,p,z,m,k){p.x=
O(d,z.x);p.y=l(d,z.y);p!==z&&(m&&(p.z=z.z),k&&(p.m=z.m));return p}function e(d,p,z,m,k){d=w(d,z.rings,m,k);if(!d)return null;p.rings=d;return p}function c(d,p,z,m,k){d=M(d,z.paths,m,k);if(!d)return null;p.paths=d;return p}const b=(d,p,z)=>[p,z],r=(d,p,z)=>[p,z,d[2]],H=(d,p,z)=>[p,z,d[2],d[3]];g.equals=function(d,p){if(d===p||null==d&&null==p)return!0;if(null==d||null==p)return!1;let z,m,k,B;d&&"upperLeft"===d.originPosition?(z=d.translate[0],m=d.translate[1],d=d.scale[0]):(z=u.isSome(d.extent)?d.extent.xmin:
0,m=u.isSome(d.extent)?d.extent.ymax:0,d=d.tolerance);p&&"upperLeft"===p.originPosition?(k=p.translate[0],B=p.translate[1],p=p.scale[0]):(k=u.isSome(p.extent)?p.extent.xmin:0,B=u.isSome(p.extent)?p.extent.ymax:0,p=p.tolerance);return z===k&&m===B&&d===p};g.getQuantizedBoundsCoordsArray=D;g.getQuantizedBoundsCoordsArrayArray=E;g.getQuantizedBoundsPaths=function(d){return E([0,0,0,0],d)};g.getQuantizedBoundsPoints=function(d){const p=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,
Number.NEGATIVE_INFINITY];return D(p,p,d)};g.getQuantizedBoundsRings=function(d){return E([0,0,0,0],d)};g.quantizeBounds=function(d,p,z){p[0]=O(d,z[0]);p[3]=l(d,z[1]);p[2]=O(d,z[2]);p[1]=l(d,z[3]);return p};g.quantizeExtent=J;g.quantizeGeometry=function(d,p){return d&&p?f.isPoint(p)?P(d,{},p,!1,!1):f.isPolyline(p)?c(d,{},p,!1,!1):f.isPolygon(p)?e(d,{},p,!1,!1):f.isMultipoint(p)?A(d,{},p,!1,!1):f.isExtent(p)?J(d,{},p,!1,!1):null:null};g.quantizeMultipoint=A;g.quantizePaths=M;g.quantizePoint=P;g.quantizePoints=
F;g.quantizePolygon=e;g.quantizePolyline=c;g.quantizeRings=w;g.quantizeX=O;g.quantizeY=l;g.toQuantizationTransform=function(d){return d?{originPosition:"upper-left"===d.originPosition?"upperLeft":"lower-left"===d.originPosition?"lowerLeft":d.originPosition,scale:d.tolerance?[d.tolerance,d.tolerance]:[1,1],translate:u.isSome(d.extent)?[d.extent.xmin,d.extent.ymax]:[0,0]}:null};g.unquantizeBounds=function(d,p,z){return z?(p[0]=h(d,z[0]),p[1]=L(d,z[3]),p[2]=h(d,z[2]),p[3]=L(d,z[1]),p):[h(d,p[0]),L(d,
p[3]),h(d,p[2]),L(d,p[1])]};g.unquantizeCoordsArray=Q;g.unquantizeCoordsArrayArray=y;g.unquantizeExtent=function(d,p,z,m,k){p.xmin=h(d,z.xmin);p.ymin=L(d,z.ymin);p.xmax=h(d,z.xmax);p.ymax=L(d,z.ymax);p!==z&&(m&&(p.zmin=z.zmin,p.zmax=z.zmax),k&&(p.mmin=z.mmin,p.mmax=z.mmax));return p};g.unquantizeMultipoint=function(d,p,z,m,k){u.isSome(z)&&(p.points=I(d,z.points,m,k));return p};g.unquantizePaths=S;g.unquantizePoint=function(d,p,z,m,k){if(u.isNone(z))return p;p.x=h(d,z.x);p.y=L(d,z.y);p!==z&&(m&&(p.z=
z.z),k&&(p.m=z.m));return p};g.unquantizePoints=I;g.unquantizePolygon=function(d,p,z,m,k){u.isSome(z)&&(p.rings=R(d,z.rings,m,k));return p};g.unquantizePolyline=function(d,p,z,m,k){u.isSome(z)&&(p.paths=S(d,z.paths,m,k));return p};g.unquantizeRings=R;g.unquantizeX=h;g.unquantizeY=L;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],
function(g,u,f){return function(){function O(C,F,w){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=C.returnDistinctValues??!1;this.fieldsIndex=w;this.featureAdapter=F;if((F=C.outFields)&&!F.includes("*")){this.outFields=F;C=0;for(const h of F){var M=u.getExpressionFromFieldName(h);M=(F=this.fieldsIndex.get(M))?null:u.getWhereClause(M,w);F=F?F.name:u.getAliasFromFieldName(h)||`FIELD_EXP_${C++}`;this._fieldDataCache.set(h,{alias:F,clause:M})}}}var l=O.prototype;
l.countDistinctValues=function(C){if(!this.returnDistinctValues)return C.length;C.forEach(F=>this.getAttributes(F));return this._returnDistinctMap.size};l.getAttributes=function(C){C=this._processAttributesForOutFields(C);return this._processAttributesForDistinctValues(C)};l.getFieldValue=function(C,F,w){const M=w?w.name:F;let h=null;this._fieldDataCache.has(M)?h=this._fieldDataCache.get(M).clause:w||(h=u.getWhereClause(F,this.fieldsIndex),this._fieldDataCache.set(M,{alias:M,clause:h}));return w?
this.featureAdapter.getAttribute(C,M):h.calculateValue(C,this.featureAdapter)};l.getDataValue=function(C,F){const w=F.normalizationType,M=F.normalizationTotal;let h=this.getFieldValue(C,F.field,this.fieldsIndex.get(F.field));F.field2&&(h=`${f.processNullValue(h)}${F.fieldDelimiter}${f.processNullValue(this.getFieldValue(C,F.field2,this.fieldsIndex.get(F.field2)))}`,F.field3&&(h=`${h}${F.fieldDelimiter}${f.processNullValue(this.getFieldValue(C,F.field3,this.fieldsIndex.get(F.field3)))}`));w&&Number.isFinite(h)&&
(C="field"===w&&F.normalizationField?this.getFieldValue(C,F.normalizationField,this.fieldsIndex.get(F.normalizationField)):null,h=f.getNormalizedValue(h,w,C,M));return h};l.getExpressionValue=function(C,F,w,M){C={attributes:this.featureAdapter.getAttributes(C),layer:{fields:this.fieldsIndex.fields}};w=M.createExecContext(C,w);return M.executeFunction(F,w)};l.getExpressionValues=function(C,F,w,M){const h={fields:this.fieldsIndex.fields};return C.map(L=>{L={attributes:this.featureAdapter.getAttributes(L),
layer:h};L=M.createExecContext(L,w);return M.executeFunction(F,L)})};l.validateItem=function(C,F){this._fieldDataCache.has(F)||this._fieldDataCache.set(F,{alias:F,clause:u.getWhereClause(F,this.fieldsIndex)});return this._fieldDataCache.get(F).clause.testFeature(C,this.featureAdapter)};l.validateItems=function(C,F){this._fieldDataCache.has(F)||this._fieldDataCache.set(F,{alias:F,clause:u.getWhereClause(F,this.fieldsIndex)});return this._fieldDataCache.get(F).clause.testSet(C,this.featureAdapter)};
l._processAttributesForOutFields=function(C){const F=this.outFields;if(!F||!F.length)return this.featureAdapter.getAttributes(C);const w={};for(const M of F){const {alias:h,clause:L}=this._fieldDataCache.get(M);w[h]=L?L.calculateValue(C,this.featureAdapter):this.featureAdapter.getAttribute(C,h)}return w};l._processAttributesForDistinctValues=function(C){if(g.isNone(C)||!this.returnDistinctValues)return C;var F=this.outFields,w=[];if(F)for(const h of F){var {alias:M}=this._fieldDataCache.get(h);w.push(C[M])}else for(M in C)w.push(C[M]);
F=`${(F||["*"]).join(",")}=${w.join(",")}`;w=this._returnDistinctMap.get(F)||0;this._returnDistinctMap.set(F,++w);return 1<w?null:C};return O}()})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(g,u,f){function O(M,h){return M?F.get(M,h):null}function l(M,h,L,Q=!0){const y=[];for(const I of h)if("*"!==I&&!M.has(I))if(Q){h=C(I);try{const S=O(h,M);if(!S)throw new u("feature-store:unsupported-query","invalid SQL expression",
{where:h});if(!S.isStandardized)throw new u("feature-store:unsupported-query","expression is not standard",{clause:S});l(M,S.fieldNames,"expression contains missing fields")}catch(S){if((h=S&&S.details)&&(h.clause||h.where))throw S;h&&h.missingFields?y.push(...h.missingFields):y.push(I)}}else y.push(I);if(y.length)throw new u("feature-store:unsupported-query",L,{missingFields:y});}function C(M){return M.split(" as ")[0]}const F=new f.WhereClauseCache(50,500),w=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));
g.getAliasFromFieldName=function(M){return M.split(" as ")[1]};g.getExpressionFromFieldName=C;g.getWhereClause=O;g.hasInvalidFieldType=function(M,h){return(M=h.get(M))?!w.has(M.type):!1};g.validateFields=l;g.validateHaving=function(M,h,L){if(!h)return!0;const Q=F.get(h,M);if(!Q)throw new u("feature-store:unsupported-query","invalid SQL expression",{having:h});if(!Q.isAggregate)throw new u("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:h});l(M,Q.fieldNames,
"having contains missing fields");if(!Q.getExpressions().every(y=>{const {aggregateType:I,field:S}=y,R=M.has(S)&&M.get(S).name;return L.some(D=>{const {onStatisticField:E,statisticType:J}=D;return(M.has(E)&&M.get(E).name)===R&&J.toLowerCase().trim()===I})}))throw new u("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:h});return!0};g.validateWhere=function(M,h){if(!h)return!0;const L=F.get(h,M);if(!L)throw new u("feature-store:unsupported-query",
"invalid SQL expression",{where:h});if(!L.isStandardized)throw new u("feature-store:unsupported-query","where clause is not standard",{where:h});l(M,L.fieldNames,"where clause contains missing fields");return!0};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(g,u,f){let O=function(){function l(C,F){this._cache=new u(C);this._invalidCache=new u(F)}l.prototype.get=
function(C,F){const w=`${F.uid}:${C}`,M=this._cache.get(w);if(M)return M;if(void 0!==this._invalidCache.get(w))return null;try{const h=f.WhereClause.create(C,F);this._cache.put(w,h);return h}catch{return this._invalidCache.put(w,null),null}};return l}();g.WhereClauseCache=O;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(g,u,f,O,l,C){function F(k,B){k+="";return k.length>=B?k:Array(B-k.length+1).join("0")+k}function w(k,B,q="0",T="0",n="0",x="0",G="",K="0",U="0"){return"+"===G||"-"===G?(k=`${F(parseInt(k,10),4)}-${F(parseInt(B,10),2)}-${F(parseInt(q,10),2)}`,B="",10>parseFloat(x)&&(B="0"),T=`${F(parseInt(T,10),2)}:${F(parseInt(n,10),2)}:${B+parseFloat(x).toString()}`,G=`${G}${F(parseInt(K,10),2)}:${F(parseInt(U,10),2)}`,new Date(k+"T"+T+G)):new Date(parseInt(k,10),parseInt(B,10)-1,parseInt(q,10),parseInt(T,
10),parseInt(n,10),parseFloat(x))}function M(k){let B=e.exec(k);if(null!==B){const [,q,T,n,x,G,K]=B;return w(q,T,n,x,G,K)}B=c.exec(k);if(null!==B){const [,q,T,n,x,G,K,U,Y,ba]=B;return w(q,T,n,x,G,K,U,Y,ba)}B=b.exec(k);if(null!==B){const [,q,T,n,x,G,K,U,Y]=B;return w(q,T,n,x,G,"0",K,U,Y)}B=r.exec(k);if(null!==B){const [,q,T,n,x,G]=B;return w(q,T,n,x,G)}B=P.exec(k);if(null!==B){const [,q,T,n]=B;return w(q,T,n)}throw Error("SQL Invalid Timestamp");}function h(k){const B=P.exec(k);if(null===B)try{return M(k)}catch{throw Error("SQL Invalid Date");
}const [,q,T,n]=B;return new Date(parseInt(q,10),parseInt(T,10)-1,parseInt(n,10))}function L(k){return Array.isArray(k)?k:[k]}function Q(k){return null!==k?!0!==k:null}function y(k,B){return null!=k&&null!=B?!0===k&&!0===B:!1===k||!1===B?!1:null}function I(k,B){return null!=k&&null!=B?!0===k||!0===B:!0===k||!0===B?!0:null}function S(k,B){if(null==k)return null;let q=!1;for(const T of B)if(null==T)q=null;else if(k===T){q=!0;break}return q}function R(k,B,q){if(null==k)return null;let T="",n=z.Normal;
for(let x=0;x<B.length;x++){const G=B.charAt(x);switch(n){case z.Normal:G===q?n=z.Escaped:T="-[]/{}()*+?.\\^$|".includes(G)?T+("\\"+G):"%"===G?T+".*":"_"===G?T+".":T+G;break;case z.Escaped:T="-[]/{}()*+?.\\^$|".includes(G)?T+("\\"+G):T+G,n=z.Normal}}return(new RegExp("^"+T+"$","m")).test(k)}function D(k){return k instanceof Date?k.valueOf():k}function E(k,B,q){if(null==B||null==q)return null;B=D(B);q=D(q);switch(k){case "\x3c\x3e":return B!==q;case "\x3d":return B===q;case "\x3e":return B>q;case "\x3c":return B<
q;case "\x3e\x3d":return B>=q;case "\x3c\x3d":return B<=q}}function J(k,B,q){if(B instanceof l.SqlInterval)if(q instanceof Date)switch(k){case "+":return new Date(B.valueInMilliseconds()+q.getTime());case "-":return B.valueInMilliseconds()-q.getTime();case "*":return B.valueInMilliseconds()*q.getTime();case "/":return B.valueInMilliseconds()/q.getTime()}else if(q instanceof l.SqlInterval)switch(k){case "+":return l.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()+q.valueInMilliseconds());
case "-":return l.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()-q.valueInMilliseconds());case "*":return B.valueInMilliseconds()*q.valueInMilliseconds();case "/":return B.valueInMilliseconds()/q.valueInMilliseconds()}else B=B.valueInMilliseconds();else if(q instanceof l.SqlInterval)if(B instanceof Date)switch(k){case "+":return new Date(q.valueInMilliseconds()+B.getTime());case "-":return new Date(B.getTime()-q.valueInMilliseconds());case "*":return B.getTime()*q.valueInMilliseconds();
case "/":return B.getTime()/q.valueInMilliseconds()}else q=q.valueInMilliseconds();else if(B instanceof Date&&"number"===typeof q)switch(q*=864E5,B=B.getTime(),k){case "+":return new Date(B+q);case "-":return new Date(B-q);case "*":return new Date(B*q);case "/":return new Date(B/q)}else if(q instanceof Date&&"number"===typeof B)switch(B*=864E5,q=q.getTime(),k){case "+":return new Date(B+q);case "-":return new Date(B-q);case "*":return new Date(B*q);case "/":return new Date(B/q)}switch(k){case "+":return B+
q;case "-":return B-q;case "*":return B*q;case "/":return B/q}}function A(k,B,q,T){k=T.getAttribute(k,B);return null!=k&&1===q[B]?new Date(k):k}const P=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,e=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,H=new Set(["current_timestamp",
"current_date","current_time"]);let d=function(){function k(){}k.makeBool=function(B){return!0===B};k.featureValue=function(B,q,T,n){return A(B,q,T,n)};k.equalsNull=function(B){return null===B};k.applyLike=function(B,q,T){return R(B,q,T)};k.ensureArray=function(B){return L(B)};k.applyIn=function(B,q){return S(B,q)};k.currentDate=function(){const B=new Date;B.setHours(0,0,0,0);return B};k.makeSqlInterval=function(B,q,T){return l.SqlInterval.createFromValueAndQualifer(B,q,T)};k.convertInterval=function(B){return B instanceof
l.SqlInterval?B.valueInMilliseconds():B};k.currentTimestamp=function(){return new Date};k.compare=function(B,q,T){return E(B,q,T)};k.calculate=function(B,q,T){return J(B,q,T)};k.makeComparable=function(B){return D(B)};k.evaluateFunction=function(B,q){return l.evaluateFunction(B,q)};k.lookup=function(B,q){B=q[B];return void 0===B?null:B};k.between=function(B,q){return null==B||null==q[0]||null==q[1]?null:B>=q[0]&&B<=q[1]};k.notbetween=function(B,q){return null==B||null==q[0]||null==q[1]?null:B<q[0]||
B>q[1]};k.ternaryNot=function(B){return Q(B)};k.ternaryAnd=function(B,q){return y(B,q)};k.ternaryOr=function(B,q){return I(B,q)};return k}(),p=function(){function k(q,T){this.fieldsIndex=T;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=C.WhereGrammar.parse(q);const {isStandardized:n,isAggregate:x,referencedFieldNames:G}=this._extractExpressionInfo(T);this._referencedFieldNames=G;this.isStandardized=n;this.isAggregate=x}k.create=function(q,T){return new k(q,T)};
var B=k.prototype;B.testSet=function(q,T=m){const n={};for(const x of this.fieldNames)n[x]=q.map(G=>T.getAttribute(G,x));return!!this._evaluateNode(this.parseTree,{attributes:n},m)};B.calculateValue=function(q,T=m){q=this._evaluateNode(this.parseTree,q,T);return q instanceof l.SqlInterval?q.valueInMilliseconds()/864E5:q};B.calculateValueCompiled=function(q,T=m){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(q,this.parameters,T,this._datefields);if(f("esri-csp-restrictions"))return this.calculateValue(q,
T);this._compileMe();return this.parseTree._compiledVersion(q,this.parameters,T,this._datefields)};B.testFeature=function(q,T=m){return!!this._evaluateNode(this.parseTree,q,T)};B.testFeatureCompiled=function(q,T=m){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(q,this.parameters,T,this._datefields);if(f("esri-csp-restrictions"))return this.testFeature(q,T);this._compileMe();return!!this.parseTree._compiledVersion(q,this.parameters,T,this._datefields)};B.getFunctions=
function(){const q=new Set;this._visitAll(this.parseTree,T=>{"function"===T.type&&q.add(T.name.toLowerCase())});return Array.from(q)};B.getExpressions=function(){const q=new Map;this._visitAll(this.parseTree,T=>{if("function"===T.type){const n=T.name.toLowerCase();T=T.args.value[0];if("column-reference"===T.type){T=T.column;const x=`${n}-${T}`;q.has(x)||q.set(x,{aggregateType:n,field:T})}}});return[...q.values()]};B.getVariables=function(){const q=new Set;this._visitAll(this.parseTree,T=>{"parameter"===
T.type&&q.add(T.value.toLowerCase())});return Array.from(q)};B._compileMe=function(){const q="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",q)).bind(d)};B._extractExpressionInfo=function(q){const T=[],n=new Set;let x=!0,G=!0;this._visitAll(this.parseTree,K=>{switch(K.type){case "column-reference":const U=q?.get(K.column);let Y,ba;U?Y=ba=U.name??"":(ba=K.column,Y=ba.toLowerCase());
U&&U.name&&("date"===U.type||"esriFieldTypeDate"===U.type)&&(this._datefields[U.name]=1);n.has(Y)||(n.add(Y),T.push(ba));K.column=ba;break;case "function":const {name:la,args:pa}=K;K=pa.value.length;x&&(x=l.isStandardized(la,K));G&&(G=O.isAggregate(la,K))}});return{referencedFieldNames:Array.from(T),isStandardized:x,isAggregate:G}};B._visitAll=function(q,T){if(null!=q)switch(T(q),q.type){case "when-clause":this._visitAll(q.operand,T);this._visitAll(q.value,T);break;case "case-expression":for(const n of q.clauses)this._visitAll(n,
T);"simple"===q.format&&this._visitAll(q.operand,T);null!==q.else&&this._visitAll(q.else,T);break;case "expression-list":for(const n of q.value)this._visitAll(n,T);break;case "unary-expression":this._visitAll(q.expr,T);break;case "binary-expression":this._visitAll(q.left,T);this._visitAll(q.right,T);break;case "function":this._visitAll(q.args,T)}};B.evaluateNodeToJavaScript=function(q){switch(q.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(q.value)+", "+JSON.stringify(q.qualifier)+
","+JSON.stringify(q.op)+")";case "case-expression":var T="";if("simple"===q.format){var n="this.makeComparable("+this.evaluateNodeToJavaScript(q.operand)+")";T="( ";for(let x=0;x<q.clauses.length;x++)T+=" ("+n+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(q.clauses[x].operand)+")) ? ("+this.evaluateNodeToJavaScript(q.clauses[x].value)+") : "}else for(T="( ",n=0;n<q.clauses.length;n++)T+=" this.makeBool("+this.evaluateNodeToJavaScript(q.clauses[n].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(q.clauses[n].value)+") : ";T=null!==q.else?T+this.evaluateNodeToJavaScript(q.else):T+"null";return T+" )";case "parameter":return"this.lookup("+JSON.stringify(q.value.toLowerCase())+",lookups)";case "expression-list":T="[";for(n of q.value)"["!==T&&(T+=","),T+=this.evaluateNodeToJavaScript(n);return T+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(q.expr)+")";case "binary-expression":switch(q.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+" )";case "IS":if("null"!==q.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(q.left)+")";case "ISNOT":if("null"!==q.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(q.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(q.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(q.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(q.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(q.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+","+JSON.stringify(q.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+","+JSON.stringify(q.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(q.operator)+","+this.evaluateNodeToJavaScript(q.left)+","+
this.evaluateNodeToJavaScript(q.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(q.operator)+","+this.evaluateNodeToJavaScript(q.left)+","+this.evaluateNodeToJavaScript(q.right)+")"}throw Error("Not Supported Operator "+q.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(q.value);case "date":return"(new Date("+h(q.value).getTime().toString()+"))";case "timestamp":return"(new Date("+M(q.value).getTime().toString()+"))";case "current-time":return"date"===
q.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(q.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(q.name)+","+this.evaluateNodeToJavaScript(q.args)+")"}throw Error("Unsupported sql syntax "+q.type);};B._evaluateNode=function(q,T,n){switch(q.type){case "interval":return T=this._evaluateNode(q.value,T,n),l.SqlInterval.createFromValueAndQualifer(T,q.qualifier,q.op);case "case-expression":if("simple"===
q.format){var x=D(this._evaluateNode(q.operand,T,n));for(var G=0;G<q.clauses.length;G++)if(x===D(this._evaluateNode(q.clauses[G].operand,T,n)))return this._evaluateNode(q.clauses[G].value,T,n)}else for(x=0;x<q.clauses.length;x++)if(!0===this._evaluateNode(q.clauses[x].operand,T,n))return this._evaluateNode(q.clauses[x].value,T,n);return null!==q.else?this._evaluateNode(q.else,T,n):null;case "parameter":return this.parameters[q.value.toLowerCase()];case "expression-list":x=[];for(G of q.value)x.push(this._evaluateNode(G,
T,n));return x;case "unary-expression":return Q(this._evaluateNode(q.expr,T,n));case "binary-expression":switch(q.operator){case "AND":return y(this._evaluateNode(q.left,T,n),this._evaluateNode(q.right,T,n));case "OR":return I(this._evaluateNode(q.left,T,n),this._evaluateNode(q.right,T,n));case "IS":if("null"!==q.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(q.left,T,n);case "ISNOT":if("null"!==q.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(q.left,
T,n);case "IN":return x=L(this._evaluateNode(q.right,T,n)),S(this._evaluateNode(q.left,T,n),x);case "NOT IN":return x=L(this._evaluateNode(q.right,T,n)),Q(S(this._evaluateNode(q.left,T,n),x));case "BETWEEN":return x=this._evaluateNode(q.left,T,n),q=this._evaluateNode(q.right,T,n),null==x||null==q[0]||null==q[1]?null:x>=D(q[0])&&x<=D(q[1]);case "NOTBETWEEN":return x=this._evaluateNode(q.left,T,n),q=this._evaluateNode(q.right,T,n),null==x||null==q[0]||null==q[1]?null:x<D(q[0])||x>D(q[1]);case "LIKE":return R(this._evaluateNode(q.left,
T,n),this._evaluateNode(q.right,T,n),q.escape);case "NOT LIKE":return Q(R(this._evaluateNode(q.left,T,n),this._evaluateNode(q.right,T,n),q.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return E(q.operator,this._evaluateNode(q.left,T,n),this._evaluateNode(q.right,T,n));case "-":case "+":case "*":case "/":return J(q.operator,this._evaluateNode(q.left,T,n),this._evaluateNode(q.right,T,n))}case "null":case "boolean":case "string":case "number":return q.value;
case "date":return h(q.value);case "timestamp":return M(q.value);case "current-time":return T=new Date,"date"===q.mode&&T.setHours(0,0,0,0),T;case "column-reference":return A(T,q.column,this._datefields,n);case "function":return T=this._evaluateNode(q.args,T,n),this.isAggregate?O.aggregateFunction(q.name,T):l.evaluateFunction(q.name,T)}throw Error("Unsupported sql syntax "+q.type);};u._createClass(k,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,q=>{"current-time"===q.type?this._hasDateFunctions=!0:"function"===q.type&&(this._hasDateFunctions=this._hasDateFunctions||H.has(q.name.toLowerCase()))});return this._hasDateFunctions}}]);return k}();var z;(function(k){k[k.Normal=0]="Normal";k[k.Escaped=1]="Escaped"})(z||(z={}));const m={getAttribute(k,B){return(k&&"object"===typeof k.attributes?k.attributes:k)[B]}};g.WhereClause=p;g.defaultAttributeAdapter=
m;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(g){function u(l){let C=0;for(let F=0;F<l.length;F++)C+=l[F];return C/l.length}function f(l){const C=u(l),F=l.length;let w=0;for(const M of l)w+=(M-C)**2;return 1<F?w/(F-1):0}const O={min:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.min.apply(Math,l[0])},max:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.max.apply(Math,
l[0])},avg:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:u(l[0])},sum:{minParams:1,maxParams:1,evaluate:l=>{if(null==l[0])l=null;else{l=l[0];let C=0;for(let F=0;F<l.length;F++)C+=l[F];l=C}return l}},stddev:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sqrt(f(l[0]))},count:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].length},var:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:f(l[0])}};g.aggregateFunction=function(l,C){const F=O[l.toLowerCase()];if(null==F)throw Error("Function Not Recognised");
if(C.length<F.minParams||C.length>F.maxParams)throw Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return F.evaluate(C)};g.isAggregate=function(l,C){l=O[l.toLowerCase()];return null!=l&&C>=l.minParams&&C<=l.maxParams};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(g,u){let f=function(){function l(){this.op="+";this.minute=this.year=this.month=this.hour=
this.second=this.day=0}l._fixDefaults=function(C){if(null!==C.precision||null!==C.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};l.createFromMilliseconds=function(C){const F=new l;F.second=C/1E3;return F};l.createFromValueAndQualifer=function(C,F,w){let M=null;const h=new l;h.op="-"===w?"-":"+";if("interval-period"===F.type){l._fixDefaults(F);w=RegExp("^[0-9]{1,}$");if("year"===F.period||"month"===F.period)throw Error("Year-Month Intervals not supported");if(w.test(C))h[F.period]=
parseFloat(C);else throw Error("Illegal Interval");}else{l._fixDefaults(F.start);l._fixDefaults(F.end);if("year"===F.start.period||"month"===F.start.period)throw Error("Year-Month Intervals not supported");if("year"===F.end.period||"month"===F.end.period)throw Error("Year-Month Intervals not supported");switch(F.start.period){case "day":switch(F.end.period){case "hour":M=RegExp("^[0-9]{1,} [0-9]{1,}$");if(M.test(C))h[F.start.period]=parseFloat(C.split(" ")[0]),h[F.end.period]=parseFloat(C.split(" ")[1]);
else throw Error("Illegal Interval");break;case "minute":M=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(M.test(C))h[F.start.period]=parseFloat(C.split(" ")[0]),C=C.split(" ")[1].split(":"),h.hour=parseFloat(C[0]),h.minute=parseFloat(C[1]);else throw Error("Illegal Interval");break;case "second":M=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(M.test(C))h[F.start.period]=parseFloat(C.split(" ")[0]),C=C.split(" ")[1].split(":"),h.hour=parseFloat(C[0]),h.minute=parseFloat(C[1]),
h.second=parseFloat(C[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(F.end.period){case "minute":M=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(M.test(C))h.hour=parseFloat(C.split(":")[0]),h.minute=parseFloat(C.split(":")[1]);else throw Error("Illegal Interval");break;case "second":M=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(M.test(C))C=C.split(":"),h.hour=parseFloat(C[0]),h.minute=parseFloat(C[1]),h.second=parseFloat(C[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "minute":switch(F.end.period){case "second":M=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(M.test(C))C=C.split(":"),h.minute=parseFloat(C[0]),h.second=parseFloat(C[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return h};l.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+
6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return l}();const O={extract:{minParams:2,maxParams:2,evaluate:([l,C])=>{if(null==C)return null;if(C instanceof Date)switch(l.toUpperCase()){case "SECOND":return C.getSeconds();case "MINUTE":return C.getMinutes();case "HOUR":return C.getHours();case "DAY":return C.getDate();case "MONTH":return C.getMonth()+1;case "YEAR":return C.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:l=>{if(2===l.length){const [C,F]=l;return null==C||null==F?null:C.toString().substring(F-1)}if(3===l.length){const [C,F,w]=l;return null==C||null==F||null==w?null:0>=w?"":C.toString().substring(F-1,F+w-1)}}},position:{minParams:2,maxParams:2,evaluate:([l,C])=>null==l||null==C?null:C.indexOf(l)+1},trim:{minParams:2,maxParams:3,evaluate:l=>{var C=3===l.length,F=C?l[1]:" ";C=C?l[2]:l[1];if(null==F||null==C)return null;F=`(${u.escapeRegExpString(F)})`;switch(l[0]){case "BOTH":return C.replace(new RegExp(`^${F}*|${F}*$`,
"g"),"");case "LEADING":return C.replace(new RegExp(`^${F}*`,"g"),"");case "TRAILING":return C.replace(new RegExp(`${F}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.abs(l[0])},ceiling:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.ceil(l[0])},floor:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.floor(l[0])},log:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])},log10:{minParams:1,
maxParams:1,evaluate:l=>null==l[0]?null:Math.log(l[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.sin(l[0])},cos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.cos(l[0])},tan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.tan(l[0])},asin:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.asin(l[0])},acos:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.acos(l[0])},atan:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:Math.atan(l[0])},
sign:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:0<l[0]?1:0>l[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:l[0]**l[1]},mod:{minParams:2,maxParams:2,evaluate:l=>null==l[0]||null==l[1]?null:l[0]%l[1]},round:{minParams:1,maxParams:2,evaluate:l=>{const C=l[0];l=2===l.length?10**l[1]:1;return null==C?null:Math.round(C*l)/l}},truncate:{minParams:1,maxParams:2,evaluate:l=>null==l[0]?null:1===l.length?parseInt(l[0].toFixed(0),10):parseFloat(l[0].toFixed(l[1]))},
char_length:{minParams:1,maxParams:1,evaluate:l=>"string"===typeof l[0]||l[0]instanceof String?l[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:l=>{let C="";for(let F=0;F<l.length;F++){if(null==l[F])return null;C+=l[F].toString()}return C}},lower:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:l=>null==l[0]?null:l[0].toString().toUpperCase()}};g.SqlInterval=f;g.evaluateFunction=function(l,C){const F=O[l.toLowerCase()];
if(null==F)throw Error("Function Not Recognised");if(C.length<F.minParams||C.length>F.maxParams)throw Error(`Invalid Parameter count for call to ${l.toUpperCase()}`);return F.evaluate(C)};g.isStandardized=function(l,C){l=O[l.toLowerCase()];return null!=l&&C>=l.minParams&&C<=l.maxParams};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(g,u){var f={exports:{}};
(function(l){(function(C,F){l.exports&&(l.exports=F())})(u.commonjsGlobal,function(){function C(w,M,h,L){w=Error.call(this,w);Object.setPrototypeOf&&Object.setPrototypeOf(w,C.prototype);w.expected=M;w.found=h;w.location=L;w.name="SyntaxError";return w}function F(w,M,h){h=h||" ";if(w.length>M)return w;M-=w.length;h+=h.repeat(M);return w+h.slice(0,M)}(function(w,M){function h(){this.constructor=w}h.prototype=M.prototype;w.prototype=new h})(C,Error);C.prototype.format=function(w){var M="Error: "+this.message;
if(this.location){var h=null,L;for(L=0;L<w.length;L++)if(w[L].source===this.location.source){h=w[L].text.split(/\r\n|\n|\r/g);break}w=this.location.start;L=this.location.source+":"+w.line+":"+w.column;if(h){var Q=this.location.end,y=F("",w.line.toString().length," ");h=h[w.line-1];Q=(w.line===Q.line?Q.column:h.length+1)-w.column||1;M+="\n --\x3e "+L+"\n"+y+" |\n"+w.line+" | "+h+"\n"+y+" | "+F("",w.column-1," ")+F("",Q,"^")}else M+="\n at "+L}return M};C.buildMessage=function(w,M){function h(S){return S.charCodeAt(0).toString(16).toUpperCase()}
function L(S){return S.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(R){return"\\x0"+h(R)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(R){return"\\x"+h(R)})}function Q(S){return S.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(R){return"\\x0"+
h(R)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(R){return"\\x"+h(R)})}function y(S){return I[S.type](S)}var I={literal:function(S){return'"'+L(S.text)+'"'},class:function(S){var R=S.parts.map(function(D){return Array.isArray(D)?Q(D[0])+"-"+Q(D[1]):Q(D)});return"["+(S.inverted?"^":"")+R.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(S){return S.description}};return"Expected "+function(S){S=S.map(y);var R,D;S.sort();if(0<S.length){for(D=R=1;R<
S.length;R++)S[R-1]!==S[R]&&(S[D]=S[R],D++);S.length=D}switch(S.length){case 1:return S[0];case 2:return S[0]+" or "+S[1];default:return S.slice(0,-1).join(", ")+", or "+S[S.length-1]}}(w)+" but "+(M?'"'+L(M)+'"':"end of input")+" found."};return{SyntaxError:C,parse:function(w,M){function h(V,W){return{type:"literal",text:V,ignoreCase:W}}function L(V,W,a){return{type:"class",parts:V,inverted:W,ignoreCase:a}}function Q(V){var W=Eb[V],a;if(!W){for(a=V-1;!Eb[a];)a--;W=Eb[a];for(W={line:W.line,column:W.column};a<
V;)10===w.charCodeAt(a)?(W.line++,W.column=1):W.column++,a++;Eb[V]=W}return W}function y(V,W){var a=Q(V),t=Q(W);return{source:hc,start:{offset:V,line:a.line,column:a.column},end:{offset:W,line:t.line,column:t.column}}}function I(V){N<hb||(N>hb&&(hb=N,vc=[]),vc.push(V))}function S(){var V=N;qa();var W=D();W!==v?(qa(),V=W):(N=V,V=v);return V}function R(){var V=N;var W=D();if(W!==v){V=[];var a=N;var t=qa();var X=Ta();if(X!==v){var aa=qa();var ia=D();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;for(;a!==
v;)V.push(a),a=N,t=qa(),X=Ta(),X!==v?(aa=qa(),ia=D(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);a={type:"expression-list"};W=[W];for(t=0;t<V.length;t++)W.push(V[t][3]);a.value=W;V=a}else N=V,V=v;return V}function D(){var V=N;var W=E();if(W!==v){V=[];var a=N;var t=qa();var X=ca();if(X!==v){var aa=qa();var ia=E();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;for(;a!==v;)V.push(a),a=N,t=qa(),X=ca(),X!==v?(aa=qa(),ia=E(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);V=qb(W,V)}else N=V,V=v;return V}function E(){var V=
N;var W=J();if(W!==v){V=[];var a=N;var t=qa();var X=Z();if(X!==v){var aa=qa();var ia=J();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;for(;a!==v;)V.push(a),a=N,t=qa(),X=Z(),X!==v?(aa=qa(),ia=J(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);V=qb(W,V)}else N=V,V=v;return V}function J(){var V=N;var W=ha();if(W===v){W=N;if(33===w.charCodeAt(N)){var a=Lc;N++}else a=v,0===ra&&I(Zd);if(a!==v){var t=N;ra++;if(61===w.charCodeAt(N)){var X=Cb;N++}else X=v,0===ra&&I(Ib);ra--;X===v?t=void 0:(N=t,t=v);t!==v?W=
a=[a,t]:(N=W,W=v)}else N=W,W=v}W!==v?(a=qa(),t=J(),t!==v?V={type:"unary-expression",operator:"NOT",expr:t}:(N=V,V=v)):(N=V,V=v);if(V===v){W=N;V=c();if(V!==v){qa();W=[];a=N;t=qa();X=A();if(X!==v){var aa=qa();var ia=c();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;if(a!==v)for(;a!==v;)W.push(a),a=N,t=qa(),X=A(),X!==v?(aa=qa(),ia=c(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);else W=v;W!==v&&(W={type:"arithmetic",tail:W});W===v&&(W=N,a=e(),a!==v?(qa(),t=Ja(),t!==v?(qa(),t=R(),t!==v?(qa(),X=Qa(),X!==
v?W={op:a,right:t}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v)):(N=W,W=v),W===v&&(W=N,a=e(),a!==v?(qa(),t=Ja(),t!==v?(qa(),t=Qa(),t!==v?W={op:a,right:{type:"expression-list",value:[]}}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v),W===v&&(W=N,a=e(),a!==v?(qa(),t=B(),t!==v?W={op:a,right:t}:(N=W,W=v)):(N=W,W=v))),W===v&&(W=N,X=ha(),X!==v?(qa(),a=fa(),a!==v?(qa(),t=c(),t!==v?(qa(),aa=Z(),aa!==v?(qa(),X=c(),X!==v?W={op:"NOT"+a,right:{type:"expression-list",value:[t,X]}}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v)):(N=W,W=v)):(N=W,W=v),W===
v&&(W=N,X=fa(),X!==v?(qa(),a=c(),a!==v?(qa(),t=Z(),t!==v?(qa(),aa=c(),aa!==v?W={op:X,right:{type:"expression-list",value:[a,aa]}}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v)):(N=W,W=v)),W===v&&(W=N,a=da(),a!==v?(qa(),t=ha(),t!==v?(qa(),t=c(),t!==v?W={op:a+"NOT",right:t}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v),W===v&&(W=N,a=da(),a!==v?(qa(),t=c(),t!==v?W={op:a,right:t}:(N=W,W=v)):(N=W,W=v)),W===v&&(W=N,a=P(),a!==v?(qa(),t=K(),t!==v?(qa(),X=N,w.substr(N,6).toLowerCase()===bb?(aa=w.substr(N,6),N+=6):(aa=v,0===ra&&I(de)),
aa!==v?(aa=N,ra++,ia=m(),ra--,ia===v?aa=void 0:(N=aa,aa=v),aa!==v?X="ESCAPE":(N=X,X=v)):(N=X,X=v),X!==v?(qa(),X=U(),X!==v?W={op:a,right:t,escape:X.value}:(N=W,W=v)):(N=W,W=v)):(N=W,W=v)):(N=W,W=v),W===v&&(W=N,a=P(),a!==v?(qa(),t=K(),t!==v?W={op:a,right:t,escape:""}:(N=W,W=v)):(N=W,W=v))))));W===v&&(W=null);""==W||void 0==W||null==W?W=V:(a=null,W=a="arithmetic"==W.type?qb(V,W.tail):gc(W.op,V,W.right,W.escape))}else N=W,W=v;V=W}return V}function A(){if(w.substr(N,2)===Nb){var V=Nb;N+=2}else V=v,0===
ra&&I(lb);V===v&&(62===w.charCodeAt(N)?(V=Db,N++):(V=v,0===ra&&I(sc)),V===v&&(w.substr(N,2)===kc?(V=kc,N+=2):(V=v,0===ra&&I($a)),V===v&&(w.substr(N,2)===lc?(V=lc,N+=2):(V=v,0===ra&&I(Od)),V===v&&(60===w.charCodeAt(N)?(V=Ob,N++):(V=v,0===ra&&I(jd)),V===v&&(61===w.charCodeAt(N)?(V=Cb,N++):(V=v,0===ra&&I(Ib)),V===v&&(w.substr(N,2)===mc?(V=mc,N+=2):(V=v,0===ra&&I(kd))))))));return V}function P(){var V=V=N;var W=ha();if(W!==v){var a=qa();var t=ja();t!==v?V=W=[W,a,t]:(N=V,V=v)}else N=V,V=v;V!==v&&(V=V[0]+
" "+V[2]);V===v&&(V=ja());return V}function e(){var V=V=N;var W=ha();if(W!==v){var a=qa();var t=Da();t!==v?V=W=[W,a,t]:(N=V,V=v)}else N=V,V=v;V!==v&&(V=V[0]+" "+V[2]);V===v&&(V=Da());return V}function c(){var V=N;var W=r();if(W!==v){V=[];var a=N;var t=qa();var X=b();if(X!==v){var aa=qa();var ia=r();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;for(;a!==v;)V.push(a),a=N,t=qa(),X=b(),X!==v?(aa=qa(),ia=r(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);V=qb(W,V)}else N=V,V=v;return V}function b(){if(43===
w.charCodeAt(N)){var V=rb;N++}else V=v,0===ra&&I(Pb);V===v&&(45===w.charCodeAt(N)?(V=yb,N++):(V=v,0===ra&&I(Qb)));return V}function r(){var V=N;var W=d();if(W!==v){V=[];var a=N;var t=qa();var X=H();if(X!==v){var aa=qa();var ia=d();ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)}else N=a,a=v;for(;a!==v;)V.push(a),a=N,t=qa(),X=H(),X!==v?(aa=qa(),ia=d(),ia!==v?a=t=[t,X,aa,ia]:(N=a,a=v)):(N=a,a=v);V=qb(W,V)}else N=V,V=v;return V}function H(){if(42===w.charCodeAt(N)){var V=nc;N++}else V=v,0===ra&&I(ld);V===v&&(47===
w.charCodeAt(N)?(V=Mc,N++):(V=v,0===ra&&I(md)));return V}function d(){var V=U();if(V===v){var W=N;var a=N;var t=pa();if(t!==v){var X=va();if(X!==v){var aa=xa();aa!==v?a=parseFloat(t+X+aa):(N=a,a=v)}else N=a,a=v}else N=a,a=v;a===v&&(a=N,t=pa(),t!==v?(X=va(),X!==v?a=parseFloat(t+X):(N=a,a=v)):(N=a,a=v),a===v&&(a=N,t=pa(),t!==v?(X=xa(),X!==v?a=parseFloat(t+X):(N=a,a=v)):(N=a,a=v),a===v&&(a=N,t=pa(),t!==v&&(t=parseFloat(t)),a=t)));var ia=a;if(ia!==v){var ma=N;ra++;var ta=z();ra--;ta===v?ma=void 0:(N=
ma,ma=v);ma!==v?W={type:"number",value:ia}:(N=W,W=v)}else N=W,W=v;V=W;if(V===v){var wa=N;var Ba=N;if(w.substr(N,4).toLowerCase()===Td){var Ma=w.substr(N,4);N+=4}else Ma=v,0===ra&&I(uc);if(Ma!==v){var Fa=N;ra++;var Ka=m();ra--;Ka===v?Fa=void 0:(N=Fa,Fa=v);Fa!==v?Ba=Ma=[Ma,Fa]:(N=Ba,Ba=v)}else N=Ba,Ba=v;var Ha=Ba;Ha!==v&&(Ha={type:"boolean",value:!0});wa=Ha;if(wa===v){wa=N;var Ua=N;if(w.substr(N,5).toLowerCase()===Ud){var ib=w.substr(N,5);N+=5}else ib=v,0===ra&&I(ae);if(ib!==v){var fb=N;ra++;var fc=
m();ra--;fc===v?fb=void 0:(N=fb,fb=v);fb!==v?Ua=ib=[ib,fb]:(N=Ua,Ua=v)}else N=Ua,Ua=v;Ha=Ua;Ha!==v&&(Ha={type:"boolean",value:!1});wa=Ha}V=wa;if(V===v){var Sb=N;if(w.substr(N,4).toLowerCase()===sb){var ud=w.substr(N,4);N+=4}else ud=v,0===ra&&I(qd);if(ud!==v){var xc=N;ra++;var $e=m();ra--;$e===v?xc=void 0:(N=xc,xc=v);xc!==v?Sb=ud=[ud,xc]:(N=Sb,Sb=v)}else N=Sb,Sb=v;var we=Sb;we!==v&&(we={type:"null",value:null});V=we;if(V===v){var Tb=N;var Ub=N;if(w.substr(N,4).toLowerCase()===Xc){var Ie=w.substr(N,
4);N+=4}else Ie=v,0===ra&&I(ne);if(Ie!==v){var vd=N;ra++;var af=m();ra--;af===v?vd=void 0:(N=vd,vd=v);vd!==v?Ub="DATE":(N=Ub,Ub=v)}else N=Ub,Ub=v;if(Ub!==v){qa();var Je=K();Je!==v?Tb={type:"date",value:Je.value}:(N=Tb,Tb=v)}else N=Tb,Tb=v;V=Tb;if(V===v){var Vb=N;var Wb=N;if(w.substr(N,9).toLowerCase()===Wc){var Ke=w.substr(N,9);N+=9}else Ke=v,0===ra&&I(sd);if(Ke!==v){var wd=N;ra++;var bf=m();ra--;bf===v?wd=void 0:(N=wd,wd=v);wd!==v?Wb="TIMESTAMP":(N=Wb,Wb=v)}else N=Wb,Wb=v;if(Wb!==v){qa();var Le=
K();Le!==v?Vb={type:"timestamp",value:Le.value}:(N=Vb,Vb=v)}else N=Vb,Vb=v;V=Vb;if(V===v){var Xa=N;var xe=oa();if(xe!==v){qa();if(45===w.charCodeAt(N)){var ub=yb;N++}else ub=v,0===ra&&I(Qb);ub===v&&(43===w.charCodeAt(N)?(ub=rb,N++):(ub=v,0===ra&&I(Pb)));if(ub!==v){qa();var yc=K();if(yc!==v){qa();var Me=T();Me!==v?Xa={type:"interval",value:yc,qualifier:Me,op:ub}:(N=Xa,Xa=v)}else N=Xa,Xa=v}else N=Xa,Xa=v}else N=Xa,Xa=v;Xa===v&&(Xa=N,xe=oa(),xe!==v?(qa(),ub=K(),ub!==v?(qa(),yc=T(),yc!==v?Xa={type:"interval",
value:ub,qualifier:yc,op:""}:(N=Xa,Xa=v)):(N=Xa,Xa=v)):(N=Xa,Xa=v));V=Xa}}}}}}var Pa=V;if(Pa===v){var cb=N;var Xb=N;if(w.substr(N,7).toLowerCase()===Tc){var Ne=w.substr(N,7);N+=7}else Ne=v,0===ra&&I(ke);if(Ne!==v){var xd=N;ra++;var cf=m();ra--;cf===v?xd=void 0:(N=xd,xd=v);xd!==v?Xb="EXTRACT":(N=Xb,Xb=v)}else N=Xb,Xb=v;if(Xb!==v){qa();var df=Ja();if(df!==v){qa();var jb=ka();jb===v&&(jb=sa(),jb===v&&(jb=Ca(),jb===v&&(jb=ya(),jb===v&&(jb=za(),jb===v&&(jb=ua())))));var Oe=jb;if(Oe!==v){qa();var ef=ea();
if(ef!==v){qa();var Pe=D();if(Pe!==v){qa();var ff=Qa();ff!==v?cb={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Oe},Pe]}}:(N=cb,cb=v)}else N=cb,cb=v}else N=cb,cb=v}else N=cb,cb=v}else N=cb,cb=v}else N=cb,cb=v;Pa=cb;if(Pa===v){var db=N;var Yb=N;if(w.substr(N,9).toLowerCase()===Sc){var Qe=w.substr(N,9);N+=9}else Qe=v,0===ra&&I(je);if(Qe!==v){var yd=N;ra++;var gf=m();ra--;gf===v?yd=void 0:(N=yd,yd=v);yd!==v?Yb="SUBSTRING":(N=Yb,Yb=v)}else N=Yb,Yb=v;if(Yb!==v){qa();
var hf=Ja();if(hf!==v){qa();var ye=D();if(ye!==v){qa();var jf=ea();if(jf!==v){qa();var ze=D();if(ze!==v){qa();var vb=N;var Zb=N;if(w.substr(N,3).toLowerCase()===Rc){var Re=w.substr(N,3);N+=3}else Re=v,0===ra&&I(ie);if(Re!==v){var zd=N;ra++;var kf=m();ra--;kf===v?zd=void 0:(N=zd,zd=v);zd!==v?Zb="FOR":(N=Zb,Zb=v)}else N=Zb,Zb=v;var zc=Zb;if(zc!==v){var lf=qa();var Se=D();if(Se!==v){var mf=qa();vb=zc=[zc,lf,Se,mf]}else N=vb,vb=v}else N=vb,vb=v;vb===v&&(vb=null);zc=Qa();zc!==v?db={type:"function",name:"substring",
args:{type:"expression-list",value:vb?[ye,ze,vb[2]]:[ye,ze]}}:(N=db,db=v)}else N=db,db=v}else N=db,db=v}else N=db,db=v}else N=db,db=v}else N=db,db=v;Pa=db;if(Pa===v){var Ra=N;var Ae=na();if(Ae!==v){qa();var Be=Ja();if(Be!==v){qa();var wb=q();wb===v&&(wb=null);qa();var Ac=D();if(Ac!==v){qa();var Ce=ea();if(Ce!==v){qa();var Te=D();if(Te!==v){qa();var nf=Qa();nf!==v?Ra={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==wb?"BOTH":wb},Ac,Te]}}:(N=Ra,Ra=v)}else N=
Ra,Ra=v}else N=Ra,Ra=v}else N=Ra,Ra=v}else N=Ra,Ra=v}else N=Ra,Ra=v;Ra===v&&(Ra=N,Ae=na(),Ae!==v?(qa(),Be=Ja(),Be!==v?(qa(),wb=q(),wb===v&&(wb=null),qa(),Ac=D(),Ac!==v?(qa(),Ce=Qa(),Ce!==v?Ra={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==wb?"BOTH":wb},Ac]}}:(N=Ra,Ra=v)):(N=Ra,Ra=v)):(N=Ra,Ra=v)):(N=Ra,Ra=v));Pa=Ra;if(Pa===v){var eb=N;var $b=N;if(w.substr(N,8).toLowerCase()===Vc){var Ue=w.substr(N,8);N+=8}else Ue=v,0===ra&&I(me);if(Ue!==v){var Ad=N;ra++;
var of=m();ra--;of===v?Ad=void 0:(N=Ad,Ad=v);Ad!==v?$b="POSITION":(N=$b,$b=v)}else N=$b,$b=v;if($b!==v){qa();var pf=Ja();if(pf!==v){qa();var Ve=D();if(Ve!==v){qa();var qf=Da();if(qf!==v){qa();var We=D();if(We!==v){qa();var rf=Qa();rf!==v?eb={type:"function",name:"position",args:{type:"expression-list",value:[Ve,We]}}:(N=eb,eb=v)}else N=eb,eb=v}else N=eb,eb=v}else N=eb,eb=v}else N=eb,eb=v}else N=eb,eb=v;Pa=eb;if(Pa===v){var zb=N;var Bd;var kb=N;kb=Bd=p();if(kb===v)if(kb=N,96===w.charCodeAt(N)?(Bd=
Hc,N++):(Bd=v,0===ra&&I(Lb)),Bd!==v){var Cd=[];if(Hb.test(w.charAt(N))){var xb=w.charAt(N);N++}else xb=v,0===ra&&I(Mb);if(xb!==v)for(;xb!==v;)Cd.push(xb),Hb.test(w.charAt(N))?(xb=w.charAt(N),N++):(xb=v,0===ra&&I(Mb));else Cd=v;Cd!==v?(96===w.charCodeAt(N)?(xb=Hc,N++):(xb=v,0===ra&&I(Lb)),xb!==v?kb=Cd.join(""):(N=kb,kb=v)):(N=kb,kb=v)}else N=kb,kb=v;var Xe=kb;if(Xe!==v){qa();var sf=Ja();if(sf!==v){qa();var Dd=R();Dd===v&&(Dd=null);qa();var tf=Qa();tf!==v?zb={type:"function",name:Xe,args:Dd?Dd:{type:"expression-list",
value:[]}}:(N=zb,zb=v)}else N=zb,zb=v}else N=zb,zb=v;Pa=zb;if(Pa===v){var ob;var Ya=N;var De=Ea();if(De!==v){qa();var Bc=D();if(Bc!==v){qa();var Cc=[];for(ob=ba();ob!==v;)Cc.push(ob),ob=ba();ob=qa();var Ed=Ia();Ed!==v?Ya={type:"case-expression",format:"simple",operand:Bc,clauses:Cc,else:null}:(N=Ya,Ya=v)}else N=Ya,Ya=v}else N=Ya,Ya=v;if(Ya===v)if(Ya=N,De=Ea(),De!==v)if(qa(),Bc=D(),Bc!==v){qa();Cc=[];for(ob=ba();ob!==v;)Cc.push(ob),ob=ba();ob=qa();Ed=la();if(Ed!==v){qa();var uf=Ia();uf!==v?Ya={type:"case-expression",
format:"simple",operand:Bc,clauses:Cc,else:Ed.value}:(N=Ya,Ya=v)}else N=Ya,Ya=v}else N=Ya,Ya=v;else N=Ya,Ya=v;var Ee=Ya;if(Ee===v){var pb;var ab=N;var Fe=Ea();if(Fe!==v){qa();var Dc=[];for(pb=Y();pb!==v;)Dc.push(pb),pb=Y();pb=qa();var Fd=Ia();Fd!==v?ab={type:"case-expression",format:"searched",clauses:Dc,else:null}:(N=ab,ab=v)}else N=ab,ab=v;if(ab===v)if(ab=N,Fe=Ea(),Fe!==v){qa();Dc=[];for(pb=Y();pb!==v;)Dc.push(pb),pb=Y();pb=qa();Fd=la();if(Fd!==v){qa();var vf=Ia();vf!==v?ab={type:"case-expression",
format:"searched",clauses:Dc,else:Fd.value}:(N=ab,ab=v)}else N=ab,ab=v}else N=ab,ab=v;Ee=ab}Pa=Ee;if(Pa===v){var Gd;var Hd=N;var Ye=z();if(Ye!==v){var Ze=[];for(Gd=k();Gd!==v;)Ze.push(Gd),Gd=k();Hd=Ye+Ze.join("")}else N=Hd,Hd=v;var Id=Hd;if(Id!==v){var Ge=Id;Id=/^CURRENT_DATE$/i.test(Ge)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(Ge)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:Ge}}Pa=Id;if(Pa===v&&(Pa=B(),Pa===v)){Pa=N;var wf=Ja();if(wf!==v){qa();
var He=D();if(He!==v){qa();var xf=Qa();xf!==v?(He.paren=!0,Pa=He):(N=Pa,Pa=v)}else N=Pa,Pa=v}else N=Pa,Pa=v}}}}}}}}return Pa}function p(){var V;var W=N;var a=z();if(a!==v){W=[];for(V=m();V!==v;)W.push(V),V=m();W=a+W.join("")}else N=W,W=v;return W}function z(){if(Nd.test(w.charAt(N))){var V=w.charAt(N);N++}else V=v,0===ra&&I(Wa);return V}function m(){if(Md.test(w.charAt(N))){var V=w.charAt(N);N++}else V=v,0===ra&&I(Ic);return V}function k(){if(Yd.test(w.charAt(N))){var V=w.charAt(N);N++}else V=v,0===
ra&&I(bc);return V}function B(){var V=N;if(64===w.charCodeAt(N)){var W=Nc;N++}else W=v,0===ra&&I(cc);if(W!==v){var a=p();a!==v?V=W=[W,a]:(N=V,V=v)}else N=V,V=v;V!==v&&(V={type:"parameter",value:V[1]});return V}function q(){var V=N;if(w.substr(N,7).toLowerCase()===Yc){var W=w.substr(N,7);N+=7}else W=v,0===ra&&I(oe);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="LEADING":(N=V,V=v)}else N=V,V=v;V===v&&(V=N,w.substr(N,8).toLowerCase()===Zc?(W=w.substr(N,8),N+=8):(W=v,0===ra&&I(pe)),
W!==v?(W=N,ra++,a=m(),ra--,a===v?W=void 0:(N=W,W=v),W!==v?V="TRAILING":(N=V,V=v)):(N=V,V=v),V===v&&(V=N,w.substr(N,4).toLowerCase()===$c?(W=w.substr(N,4),N+=4):(W=v,0===ra&&I(qe)),W!==v?(W=N,ra++,a=m(),ra--,a===v?W=void 0:(N=W,W=v),W!==v?V="BOTH":(N=V,V=v)):(N=V,V=v)));return V}function T(){var V=N;var W=N;var a=n();if(a!==v){qa();var t=Ja();if(t!==v)if(qa(),t=G(),t!==v){qa();var X=Qa();X!==v?W={type:"interval-period",period:a.value,precision:t,secondary:null}:(N=W,W=v)}else N=W,W=v;else N=W,W=v}else N=
W,W=v;W===v&&(W=N,a=n(),a!==v&&(a={type:"interval-period",period:a.value,precision:null,secondary:null}),W=a);if(W!==v)if(qa(),a=N,w.substr(N,2).toLowerCase()===ad?(t=w.substr(N,2),N+=2):(t=v,0===ra&&I(re)),t!==v?(t=N,ra++,X=m(),ra--,X===v?t=void 0:(N=t,t=v),t!==v?a="TO":(N=a,a=v)):(N=a,a=v),a!==v){qa();a=N;t=n();t!==v&&(t={type:"interval-period",period:t.value,precision:null,secondary:null});a=t;if(a===v){a=N;t=ua();if(t!==v)if(qa(),t=Ja(),t!==v)if(qa(),t=G(),t!==v)if(qa(),X=Ta(),X!==v)if(qa(),X=
x(),X!==v){qa();var aa=Qa();aa!==v?a={type:"interval-period",period:"second",precision:t,secondary:X}:(N=a,a=v)}else N=a,a=v;else N=a,a=v;else N=a,a=v;else N=a,a=v;else N=a,a=v;a===v&&(a=N,t=ua(),t!==v?(qa(),t=Ja(),t!==v?(qa(),t=G(),t!==v?(qa(),X=Qa(),X!==v?a={type:"interval-period",period:"second",precision:t,secondary:null}:(N=a,a=v)):(N=a,a=v)):(N=a,a=v)):(N=a,a=v),a===v&&(a=N,t=ua(),t!==v&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),a=t))}a!==v?V={type:"interval-qualifier",
start:W,end:a}:(N=V,V=v)}else N=V,V=v;else N=V,V=v;V===v&&(V=N,a=n(),a!==v?(qa(),W=Ja(),W!==v?(qa(),W=x(),W!==v?(qa(),t=Qa(),t!==v?V={type:"interval-period",period:a.value,precision:W,secondary:null}:(N=V,V=v)):(N=V,V=v)):(N=V,V=v)):(N=V,V=v),V===v&&(V=N,a=n(),a!==v&&(a={type:"interval-period",period:a.value,precision:null,secondary:null}),V=a,V===v&&(V=N,a=ua(),a!==v?(qa(),W=Ja(),W!==v?(qa(),W=G(),W!==v?(qa(),t=Ta(),t!==v?(qa(),a=x(),a!==v?(qa(),t=Qa(),t!==v?V={type:"interval-period",period:"second",
precision:W,secondary:a}:(N=V,V=v)):(N=V,V=v)):(N=V,V=v)):(N=V,V=v)):(N=V,V=v)):(N=V,V=v),V===v&&(V=N,a=ua(),a!==v?(qa(),W=Ja(),W!==v?(qa(),W=x(),W!==v?(qa(),t=Qa(),t!==v?V={type:"interval-period",period:"second",precision:W,secondary:null}:(N=V,V=v)):(N=V,V=v)):(N=V,V=v)):(N=V,V=v),V===v&&(V=N,a=ua(),a!==v&&(a={type:"interval-period",period:"second",precision:null,secondary:null}),V=a)))));return V}function n(){var V=N;V=Ca();V!==v&&(V={type:"string",value:"day"});V===v&&(V=N,V=ya(),V!==v&&(V={type:"string",
value:"hour"}),V===v&&(V=N,V=za(),V!==v&&(V={type:"string",value:"minute"}),V===v&&(V=N,V=sa(),V!==v&&(V={type:"string",value:"month"}),V===v&&(V=N,V=ka(),V!==v&&(V={type:"string",value:"year"})))));return V}function x(){var V=Aa();V!==v&&(V=parseFloat(V));return V}function G(){var V=Aa();V!==v&&(V=parseFloat(V));return V}function K(){var V=U();V===v&&(V=B());return V}function U(){var V=N;if(39===w.charCodeAt(N)){var W=oc;N++}else W=v,0===ra&&I(Kb);W===v&&(w.substr(N,2)===pc?(W=pc,N+=2):(W=v,0===
ra&&I(Rb)));if(W!==v){W=[];var a=N;w.substr(N,2)===Fb?(a=Fb,N+=2):(a=v,0===ra&&I(nd));a!==v&&(a="'");a===v&&(Za.test(w.charAt(N))?(a=w.charAt(N),N++):(a=v,0===ra&&I(od)));for(;a!==v;)W.push(a),a=N,w.substr(N,2)===Fb?(a=Fb,N+=2):(a=v,0===ra&&I(nd)),a!==v&&(a="'"),a===v&&(Za.test(w.charAt(N))?(a=w.charAt(N),N++):(a=v,0===ra&&I(od)));39===w.charCodeAt(N)?(a=oc,N++):(a=v,0===ra&&I(Kb));a!==v?V={type:"string",value:W.join("")}:(N=V,V=v)}else N=V,V=v;return V}function Y(){var V=N;if(Na()!==v){qa();var W=
D();if(W!==v){qa();var a=Va();a!==v?(qa(),a=D(),a!==v?V={type:"when-clause",operand:W,value:a}:(N=V,V=v)):(N=V,V=v)}else N=V,V=v}else N=V,V=v;return V}function ba(){var V=N;if(Na()!==v){qa();var W=D();if(W!==v){qa();var a=Va();a!==v?(qa(),a=D(),a!==v?V={type:"when-clause",operand:W,value:a}:(N=V,V=v)):(N=V,V=v)}else N=V,V=v}else N=V,V=v;return V}function la(){var V=N;var W=N;if(w.substr(N,4).toLowerCase()===Gc){var a=w.substr(N,4);N+=4}else a=v,0===ra&&I(Jc);if(a!==v){a=N;ra++;var t=m();ra--;t===
v?a=void 0:(N=a,a=v);a!==v?W="ELSE":(N=W,W=v)}else N=W,W=v;W!==v?(qa(),W=D(),W!==v?V={type:"else-clause",value:W}:(N=V,V=v)):(N=V,V=v);return V}function pa(){var V=Aa();if(V===v){V=N;if(45===w.charCodeAt(N)){var W=yb;N++}else W=v,0===ra&&I(Qb);W===v&&(43===w.charCodeAt(N)?(W=rb,N++):(W=v,0===ra&&I(Pb)));if(W!==v){var a=Aa();a!==v?V=W[0]+a:(N=V,V=v)}else N=V,V=v}return V}function va(){var V=N;if(46===w.charCodeAt(N)){var W=Gb;N++}else W=v,0===ra&&I($d);W!==v?(V=Aa(),V===v&&(V=null),V="."+(null!=V?
V:"")):(N=V,V=v);return V}function xa(){var V;var W=V=N;if(Ab.test(w.charAt(N))){var a=w.charAt(N);N++}else a=v,0===ra&&I(pd);a!==v?(rc.test(w.charAt(N))?(W=w.charAt(N),N++):(W=v,0===ra&&I(tc)),W===v&&(W=null),W="e"+(null===W?"":W)):(N=W,W=v);W!==v?(a=Aa(),a!==v?V=W+a:(N=V,V=v)):(N=V,V=v);return V}function Aa(){var V=[];var W=Ga();if(W!==v)for(;W!==v;)V.push(W),W=Ga();else V=v;V!==v&&(V=V.join(""));return V}function Ga(){if(gb.test(w.charAt(N))){var V=w.charAt(N);N++}else V=v,0===ra&&I(Oa);return V}
function Da(){var V=N;if(w.substr(N,2).toLowerCase()===Vd){var W=w.substr(N,2);N+=2}else W=v,0===ra&&I(be);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="IN":(N=V,V=v)}else N=V,V=v;return V}function da(){var V=N;if(w.substr(N,2).toLowerCase()===Bb){var W=w.substr(N,2);N+=2}else W=v,0===ra&&I(rd);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="IS":(N=V,V=v)}else N=V,V=v;return V}function ja(){var V=N;if(w.substr(N,4).toLowerCase()===Oc){var W=w.substr(N,4);
N+=4}else W=v,0===ra&&I(ce);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="LIKE":(N=V,V=v)}else N=V,V=v;return V}function ha(){var V=N;if(w.substr(N,3).toLowerCase()===nb){var W=w.substr(N,3);N+=3}else W=v,0===ra&&I(ee);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="NOT":(N=V,V=v)}else N=V,V=v;return V}function Z(){var V=N;if(w.substr(N,3).toLowerCase()===qc){var W=w.substr(N,3);N+=3}else W=v,0===ra&&I(Pd);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:
(N=W,W=v);W!==v?V="AND":(N=V,V=v)}else N=V,V=v;return V}function ca(){var V=N;if(w.substr(N,2).toLowerCase()===Pc){var W=w.substr(N,2);N+=2}else W=v,0===ra&&I(fe);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="OR":(N=V,V=v)}else N=V,V=v;return V}function fa(){var V=N;if(w.substr(N,7).toLowerCase()===Wd){var W=w.substr(N,7);N+=7}else W=v,0===ra&&I(ge);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="BETWEEN":(N=V,V=v)}else N=V,V=v;return V}function ea(){var V=
N;if(w.substr(N,4).toLowerCase()===Qc){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(he);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="FROM":(N=V,V=v)}else N=V,V=v;return V}function na(){var V=N;if(w.substr(N,4).toLowerCase()===Uc){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(le);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="TRIM":(N=V,V=v)}else N=V,V=v;return V}function oa(){var V=N;if(w.substr(N,8).toLowerCase()===bd){var W=w.substr(N,8);N+=8}else W=v,0===
ra&&I(se);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="INTERVAL":(N=V,V=v)}else N=V,V=v;return V}function ka(){var V=N;if(w.substr(N,4).toLowerCase()===cd){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(te);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="YEAR":(N=V,V=v)}else N=V,V=v;return V}function sa(){var V=N;if(w.substr(N,5).toLowerCase()===Xd){var W=w.substr(N,5);N+=5}else W=v,0===ra&&I(td);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==
v?V="MONTH":(N=V,V=v)}else N=V,V=v;return V}function Ca(){var V=N;if(w.substr(N,3).toLowerCase()===dd){var W=w.substr(N,3);N+=3}else W=v,0===ra&&I(ue);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="DAY":(N=V,V=v)}else N=V,V=v;return V}function ya(){var V=N;if(w.substr(N,4).toLowerCase()===ed){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(ve);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="HOUR":(N=V,V=v)}else N=V,V=v;return V}function za(){var V=N;if(w.substr(N,
6).toLowerCase()===fd){var W=w.substr(N,6);N+=6}else W=v,0===ra&&I(tb);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="MINUTE":(N=V,V=v)}else N=V,V=v;return V}function ua(){var V=N;if(w.substr(N,6).toLowerCase()===gd){var W=w.substr(N,6);N+=6}else W=v,0===ra&&I(Qd);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="SECOND":(N=V,V=v)}else N=V,V=v;return V}function Ea(){var V=N;if(w.substr(N,4).toLowerCase()===hd){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(La);
if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="CASE":(N=V,V=v)}else N=V,V=v;return V}function Ia(){var V=N;if(w.substr(N,3).toLowerCase()===Kd){var W=w.substr(N,3);N+=3}else W=v,0===ra&&I(Sa);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="END":(N=V,V=v)}else N=V,V=v;return V}function Na(){var V=N;if(w.substr(N,4).toLowerCase()===Ec){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(Jb);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="WHEN":(N=
V,V=v)}else N=V,V=v;return V}function Va(){var V=N;if(w.substr(N,4).toLowerCase()===Jd){var W=w.substr(N,4);N+=4}else W=v,0===ra&&I(dc);if(W!==v){W=N;ra++;var a=m();ra--;a===v?W=void 0:(N=W,W=v);W!==v?V="THEN":(N=V,V=v)}else N=V,V=v;return V}function Ta(){if(44===w.charCodeAt(N)){var V=Fc;N++}else V=v,0===ra&&I(Rd);return V}function Ja(){if(40===w.charCodeAt(N)){var V=Ld;N++}else V=v,0===ra&&I(Kc);return V}function Qa(){if(41===w.charCodeAt(N)){var V=id;N++}else V=v,0===ra&&I(ec);return V}function qa(){var V;
var W=[];for(V=mb();V!==v;)W.push(V),V=mb();return W}function mb(){if(ac.test(w.charAt(N))){var V=w.charAt(N);N++}else V=v,0===ra&&I(Sd);return V}function gc(V,W,a,t){V={type:"binary-expression",operator:V,left:W,right:a};void 0!==t&&(V.escape=t);return V}function qb(V,W){for(var a=0;a<W.length;a++)V=gc(W[a][1],V,W[a][3]);return V}M=void 0!==M?M:{};var v={},hc=M.grammarSource,ic={start:S},jc=S,Lc="!",Cb="\x3d",Nb="\x3e\x3d",Db="\x3e",kc="\x3c\x3d",lc="\x3c\x3e",Ob="\x3c",mc="!\x3d",rb="+",yb="-",
nc="*",Mc="/",Nc="@",oc="'",pc="N'",Fb="''",Gb=".",sb="null",Td="true",Ud="false",Vd="in",Bb="is",Oc="like",bb="escape",nb="not",qc="and",Pc="or",Wd="between",Qc="from",Rc="for",Sc="substring",Tc="extract",Uc="trim",Vc="position",Wc="timestamp",Xc="date",Yc="leading",Zc="trailing",$c="both",ad="to",bd="interval",cd="year",Xd="month",dd="day",ed="hour",fd="minute",gd="second",hd="case",Kd="end",Ec="when",Jd="then",Gc="else",Fc=",",Ld="(",id=")",Hc="`",Nd=/^[A-Za-z_\x80-\uFFFF]/,Md=/^[A-Za-z0-9_]/,
Yd=/^[A-Za-z0-9_.\x80-\uFFFF]/,Za=/^[^']/,gb=/^[0-9]/,Ab=/^[eE]/,rc=/^[+\-]/,ac=/^[ \t\n\r]/,Hb=/^[^`]/,Zd=h("!",!1),Ib=h("\x3d",!1),lb=h("\x3e\x3d",!1),sc=h("\x3e",!1),$a=h("\x3c\x3d",!1),Od=h("\x3c\x3e",!1),jd=h("\x3c",!1),kd=h("!\x3d",!1),Pb=h("+",!1),Qb=h("-",!1),ld=h("*",!1),md=h("/",!1),Wa=L([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Ic=L([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),bc=L([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),cc=h("@",!1),Kb=h("'",!1),Rb=
h("N'",!1),nd=h("''",!1),od=L(["'"],!0,!1),$d=h(".",!1),Oa=L([["0","9"]],!1,!1),pd=L(["e","E"],!1,!1),tc=L(["+","-"],!1,!1),qd=h("NULL",!0),uc=h("TRUE",!0),ae=h("FALSE",!0),be=h("IN",!0),rd=h("IS",!0),ce=h("LIKE",!0),de=h("ESCAPE",!0),ee=h("NOT",!0),Pd=h("AND",!0),fe=h("OR",!0),ge=h("BETWEEN",!0),he=h("FROM",!0),ie=h("FOR",!0),je=h("SUBSTRING",!0),ke=h("EXTRACT",!0),le=h("TRIM",!0),me=h("POSITION",!0),sd=h("TIMESTAMP",!0),ne=h("DATE",!0),oe=h("LEADING",!0),pe=h("TRAILING",!0),qe=h("BOTH",!0),re=h("TO",
!0),se=h("INTERVAL",!0),te=h("YEAR",!0),td=h("MONTH",!0),ue=h("DAY",!0),ve=h("HOUR",!0),tb=h("MINUTE",!0),Qd=h("SECOND",!0),La=h("CASE",!0),Sa=h("END",!0),Jb=h("WHEN",!0),dc=h("THEN",!0),Jc=h("ELSE",!0),Rd=h(",",!1),Kc=h("(",!1),ec=h(")",!1),Sd=L([" ","\t","\n","\r"],!1,!1),Lb=h("`",!1),Mb=L(["`"],!0,!1),N=0,Eb=[{line:1,column:1}],hb=0,vc=[],ra=0;if("startRule"in M){if(!(M.startRule in ic))throw Error("Can't start parsing from rule \""+M.startRule+'".');jc=ic[M.startRule]}var wc=jc();if(wc!==v&&N===
w.length)return wc;wc!==v&&N<w.length&&I({type:"end"});throw function(V,W,a){return new C(C.buildMessage(V,W),V,W,a)}(vc,hb<w.length?w.charAt(hb):null,hb<w.length?y(hb,hb+1):y(hb,hb));}}})})(f);let O=function(){function l(){}l.parse=function(C){return f.exports.parse(C)};return l}();g.WhereGrammar=O;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],
function(g,u,f){function O(e){return null==e||"string"===typeof e&&!e?"\x3cNull\x3e":e}function l(e){const c=null!=e.minValue||null!=e.maxValue,b=!!e.sqlExpression&&e.supportsSQLExpression;return!(null!=e.normalizationField||null!=e.normalizationType)&&!c&&!b}function C(e){const {values:c,useSampleStdDev:b,supportsNullCount:r}=e;var H=Number.POSITIVE_INFINITY;let d=Number.NEGATIVE_INFINITY,p=null,z=null;var m=null;let k=null,B=0;const q=null==e.minValue?-Infinity:e.minValue,T=null==e.maxValue?Infinity:
e.maxValue;for(const n of c)Number.isFinite(n)?n>=q&&n<=T&&(p+=n,H=Math.min(H,n),d=Math.max(d,n),B++):"string"===typeof n&&B++;if(B&&null!=p){z=p/B;m=0;for(const n of c)Number.isFinite(n)&&n>=q&&n<=T&&(m+=(n-z)**2);k=b?1<B?m/(B-1):0:0<B?m/B:0;m=Math.sqrt(k)}else d=H=null;H={avg:z,count:B,max:d,min:H,stddev:m,sum:p,variance:k};r&&(H.nullcount=c.length-B);e.percentileParams&&(H.median=F(c,e.percentileParams));return H}function F(e,c){const {fieldType:b,value:r,orderBy:H,isDiscrete:d}=c,p=w(b,"desc"===
H);e=[...e].filter(B=>null!=B).sort((B,q)=>p(B,q));if(0===e.length)return null;if(0>=r)return e[0];if(1<=r)return e[e.length-1];var z=(e.length-1)*r,m=Math.floor(z);c=m+1;z%=1;m=e[m];const k=e[c];return c>=e.length||d||"string"===typeof m||"string"===typeof k?m:m*(1-z)+k*z}function w(e,c){const b=c?1:-1,r=h(c),H=M(c);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...A].includes(e))return(d,p)=>"number"===typeof d&&"number"===typeof p?r(d,p):"string"===
typeof d&&"string"===typeof p?H(d,p):b;if("esriFieldTypeDate"===e)return(d,p)=>{d=(new Date(d)).getTime();p=(new Date(p)).getTime();return isNaN(d)||isNaN(p)?b:r(d,p)};if(A.has(e))return(d,p)=>r(d,p);if("esriFieldTypeString"===e)return(d,p)=>H(d,p);if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e){const d=M(c);return(p,z)=>d(L(p),L(z))}return c?(d,p)=>1:(d,p)=>-1}function M(e){return e?(c,b)=>{c=c?.toUpperCase();b=b?.toUpperCase();return c>b?-1:c<b?1:0}:(c,b)=>{c=c?.toUpperCase();b=b?.toUpperCase();
return c<b?-1:c>b?1:0}}function h(e){return e?(c,b)=>b-c:(c,b)=>c-b}function L(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function Q(e){return"coded-value"!==e?.type?[]:e.codedValues.map(c=>c.code)}function y(e,c){const b=S({field:c.field,normalizationType:c.normalizationType,normalizationField:c.normalizationField,classificationMethod:c.classificationMethod,standardDeviationInterval:c.standardDeviationInterval,
breakCount:c.numClasses||5});e=I(e,c.minValue,c.maxValue);return f.createGenerateRendererClassBreaks({definition:b,values:e,normalizationTotal:c.normalizationTotal})}function I(e,c,b){c=null==c?-Infinity:c;b=null==b?Infinity:b;return e.filter(r=>Number.isFinite(r)&&r>=c&&r<=b)}function S(e){const c=e.field,b=e.classificationMethod||"equal-interval",r=e.normalizationType,H=e.normalizationField,d=new u;d.classificationField=c;d.breakCount=e.breakCount;d.classificationMethod=b;d.standardDeviationInterval=
"standard-deviation"===b?e.standardDeviationInterval||1:void 0;d.normalizationType=r;d.normalizationField="field"===r?H:void 0;return d}function R(e,c){const {field:b,classificationMethod:r,standardDeviationInterval:H,normalizationType:d,normalizationField:p,normalizationTotal:z,minValue:m,maxValue:k}=c,B=c.numBins||10;let q=c=null,T=null;r&&"equal-interval"!==r||d?({classBreaks:e}=y(e,{field:b,normalizationType:d,normalizationField:p,normalizationTotal:z,classificationMethod:r,standardDeviationInterval:H,
minValue:m,maxValue:k,numClasses:B}),c=e[0].minValue,q=e[e.length-1].maxValue,T=e.map(n=>[n.minValue,n.maxValue])):(null!=m&&null!=k?(c=m,q=k):(e=C({values:e,minValue:m,maxValue:k,useSampleStdDev:!d,supportsNullCount:l({normalizationType:d,normalizationField:p,minValue:m,maxValue:k})}),c=e.min,q=e.max),T=E(c,q,B));return{min:c,max:q,intervals:T}}function D(e,c){let b=-1;for(let r=e.length-1;0<=r;r--)if(c>=e[r][0]){b=r;break}return b}function E(e,c,b){const r=(c-e)/b,H=[];let d;for(let p=1;p<=b;p++)d=
e+r,d=Number(d.toFixed(16)),H.push([e,p===b?c:d]),e=d;return H}const J=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,A=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),P="min max avg stddev count sum variance nullcount median".split(" ");g.calculateClassBreaks=y;g.calculateHistogram=function(e,c){const {min:b,max:r,intervals:H}=R(e,c),d=H.map((p,z)=>({minValue:H[z][0],maxValue:H[z][1],count:0}));for(const p of e)null!=p&&p>=b&&p<=r&&(e=D(H,p),-1<
e&&d[e].count++);return{bins:d,minValue:b,maxValue:r,normalizationTotal:c.normalizationTotal}};g.calculatePercentile=F;g.calculateStatistics=C;g.calculateStringStatistics=function(e){const c=e.returnDistinct?[...(new Set(e.values))]:e.values,b=c.filter(H=>null!=H).length,r={count:b};e.supportsNullCount&&(r.nullcount=c.length-b);e.percentileParams&&(r.median=F(c,e.percentileParams));return r};g.calculateUniqueValuesCount=function(e){const c={};for(let b of e){if(null==b||"string"===typeof b&&""===
b.trim())b=null;null==c[b]?c[b]={count:1,data:b}:c[b].count++}return{count:c}};g.createClassBreaksDefinition=S;g.createUVResult=function(e,c,b,r){e=e.count;const H=[];if(b&&c){b=[];var d=Q(c[0]);for(const p of d)if(c[1]){d=Q(c[1]);for(const z of d)if(c[2]){d=Q(c[2]);for(const m of d)b.push(`${O(p)}${r}${O(z)}${r}${O(m)}`)}else b.push(`${O(p)}${r}${O(z)}`)}else b.push(p);for(const p of b)e.hasOwnProperty(p)||(e[p]={data:p,count:0})}for(const p in e)c=e[p],H.push({value:c.data,count:c.count,label:c.label});
return{uniqueValueInfos:H}};g.getAttributeComparator=w;g.getEqualIntervalBins=E;g.getNormalizedValue=function(e,c,b,r){let H=null;switch(c){case "log":0!==e&&(H=Math.log(e)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(r)&&0!==r&&(H=e/r*100);break;case "field":Number.isFinite(b)&&0!==b&&(H=e/b);break;case "natural-log":0<e&&(H=Math.log(e));break;case "square-root":0<e&&(H=e**.5)}return H};g.isNullCountSupported=l;g.processNullValue=O;g.processSummaryStatisticsResult=function(e,c){let b;
for(b in e)P.includes(b)&&(Number.isFinite(e[b])||(e[b]=null));if(!c)return e;["avg","stddev","variance"].forEach(r=>{null!=e[r]&&(e[r]=Math.ceil(e[r]))});return e};g.resolveCBResult=function(e,c){let b=e.classBreaks;const r=b[0].minValue,H=b[b.length-1].maxValue,d="standard-deviation"===c;b=b.map(p=>{const z=p.label;p={minValue:p.minValue,maxValue:p.maxValue,label:z};if(d&&z){const m=z.match(J).map(k=>+k.trim());2===m.length?(p.minStdDev=m[0],p.maxStdDev=m[1],0>m[0]&&0<m[1]&&(p.hasAvg=!0)):1===m.length&&
(z.includes("\x3c")?(p.minStdDev=null,p.maxStdDev=m[0]):z.includes("\x3e")&&(p.minStdDev=m[0],p.maxStdDev=null))}return p});return{minValue:r,maxValue:H,classBreakInfos:b,normalizationTotal:e.normalizationTotal}};g.statisticTypes=P;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),
function(g,u,f,O,l,C,F,w){l=new f.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});f=new f.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});w=function(M){function h(){var L=M.apply(this,arguments)||this;L.breakCount=null;L.classificationField=
null;L.classificationMethod=null;L.normalizationField=null;L.normalizationType=null;L.type="class-breaks-definition";return L}g._inheritsLoose(h,M);g._createClass(h,[{key:"standardDeviationInterval",set:function(L){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",L)}},{key:"definedInterval",set:function(L){"defined-interval"===this.classificationMethod&&this._set("definedInterval",L)}}]);return h}(w);u.__decorate([O.property({json:{write:!0}})],w.prototype,"breakCount",
void 0);u.__decorate([O.property({json:{write:!0}})],w.prototype,"classificationField",void 0);u.__decorate([O.property({type:String,json:{read:l.read,write:l.write}})],w.prototype,"classificationMethod",void 0);u.__decorate([O.property({json:{write:!0}})],w.prototype,"normalizationField",void 0);u.__decorate([O.property({json:{read:f.read,write:f.write}})],w.prototype,"normalizationType",void 0);u.__decorate([O.property({value:null,json:{write:!0}})],w.prototype,"standardDeviationInterval",null);
u.__decorate([O.property({value:null,json:{write:!0}})],w.prototype,"definedInterval",null);u.__decorate([O.property()],w.prototype,"type",void 0);return w=u.__decorate([F.subclass("esri.rest.support.ClassBreaksDefinition")],w)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(g,u,f,O,l,C,F,w,M,h){f=new f.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});O=function(L){function Q(){var y=L.apply(this,arguments)||this;y.baseSymbol=null;y.colorRamp=null;y.type=null;return y}g._inheritsLoose(Q,L);return Q}(O.JSONSupport);u.__decorate([l.property({type:h,json:{write:!0}})],O.prototype,"baseSymbol",void 0);u.__decorate([l.property({types:M.types,json:{read:{reader:M.fromJSON},write:!0}})],O.prototype,"colorRamp",void 0);u.__decorate([l.property({json:{read:f.read,
write:f.write}})],O.prototype,"type",void 0);return O=u.__decorate([w.subclass("esri.rest.support.ClassificationDefinition")],O)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(g,u){function f(y){const {classificationMethod:I,breakCount:S,normalizationType:R,definedInterval:D}=y.definition,E=[];var J=y.values;if(0===J.length)return[];J=J.sort((r,H)=>r-H);var A=J[0],P=J[J.length-1];if("equal-interval"===I)if(J.length>=S){J=(P-A)/S;y=A;for(var e=
1;e<S;e++){var c=Number((A+e*J).toFixed(6));E.push({minValue:y,maxValue:c,label:O(y,c,R)});y=c}E.push({minValue:y,maxValue:P,label:O(y,P,R)})}else J.forEach(r=>{E.push({minValue:r,maxValue:r,label:O(r,r,R)})});else if("natural-breaks"===I){J=l(J);y=C(J.uniqueValues,y.valueFrequency||J.valueFrequency,S);for(e=1;e<S;e++)J.uniqueValues.length>e&&(c=Number(J.uniqueValues[y[e]].toFixed(6)),E.push({minValue:A,maxValue:c,label:O(A,c,R)}),A=c);E.push({minValue:A,maxValue:P,label:O(A,P,R)})}else if("quantile"===
I)if(J.length>=S&&A!==P){y=Math.ceil(J.length/S);e=0;for(c=1;c<S;c++){var b=y+e-1;b>J.length&&(b=J.length-1);0>b&&(b=0);E.push({minValue:A,maxValue:J[b],label:O(A,J[b],R)});A=J[b];e+=y;y=Math.ceil((J.length-e)/(S-c))}E.push({minValue:A,maxValue:P,label:O(A,P,R)})}else for(P=-1,A=0;A<J.length;A++)y=J[A],y!==P&&(P=y,E.push({minValue:P,maxValue:y,label:O(P,y,R)}),P=y);else if("standard-deviation"===I)if(y=M(J),e=h(J,y),0===e)E.push({minValue:J[0],maxValue:J[0],label:O(J[0],J[0],R)});else{J=w(A,P,S,y,
e)*e;e=0;for(c=S;1<=c;c--)b=Number((y-(c-.5)*J).toFixed(6)),E.push({minValue:A,maxValue:b,label:O(A,b,R)}),A=b,e++;c=Number((y+.5*J).toFixed(6));E.push({minValue:A,maxValue:c,label:O(A,c,R)});A=c;e++;for(b=1;b<=S;b++)c=e===2*S?P:Number((y+(b+.5)*J).toFixed(6)),E.push({minValue:A,maxValue:c,label:O(A,c,R)}),A=c,e++}else if("defined-interval"===I){if(!D)return E;P=J[0];J=J[J.length-1];A=Math.ceil((J-P)/D);y=P;for(e=1;e<A;e++)c=Number((P+e*D).toFixed(6)),E.push({minValue:y,maxValue:c,label:O(y,c,R)}),
y=c;E.push({minValue:y,maxValue:J,label:O(y,J,R)})}return E}function O(y,I,S){let R=null;return R=y===I?S&&"percent-of-total"===S?y+"%":y.toString():S&&"percent-of-total"===S?y+"% - "+I+"%":y+" - "+I}function l(y){const I=[],S=[];let R=Number.MIN_VALUE,D=1,E=-1;for(let J=0;J<y.length;J++){const A=y[J];A===R?(D++,S[E]=D):null!==A&&(I.push(A),R=A,D=1,S.push(D),E++)}return{uniqueValues:I,valueFrequency:S}}function C(y,I,S){var R=y.length;const D=[];S>R&&(S=R);for(var E=0;E<S;E++)D.push(Math.round(E*
R/S-1));D.push(R-1);E=F(D,y,I,S);R=E.mean;E=E.sdcm;var J=S,A=0,P=0;let e=0,c=0,b=!0;for(let H=0;2>H&&b;H++){0===H&&(b=!1);for(var r=0;r<J-1;r++)for(;D[r+1]+1!==D[r+2];)if(D[r+1]+=1,A=L(r,D,y,I),e=A.sbMean,A=A.sbSdcm,P=L(r+1,D,y,I),c=P.sbMean,P=P.sbSdcm,A+P<E[r]+E[r+1])E[r]=A,E[r+1]=P,R[r]=e,R[r+1]=c,b=!0;else{--D[r+1];break}for(r=J-1;0<r;r--)for(;D[r]!==D[r-1]+1;)if(--D[r],A=L(r-1,D,y,I),e=A.sbMean,A=A.sbSdcm,P=L(r,D,y,I),c=P.sbMean,P=P.sbSdcm,A+P<E[r-1]+E[r])E[r-1]=A,E[r]=P,R[r-1]=e,R[r]=c,b=!0;
else{D[r]+=1;break}}b&&(E=F(D,y,I,S));return D}function F(y,I,S,R){let D=[];var E=[],J=[];let A=0;const P=[],e=[];for(var c=0;c<R;c++){var b=L(c,y,I,S);P.push(b.sbMean);e.push(b.sbSdcm);A+=e[c]}b=A;for(c=!0;c||A<b;){c=!1;D=[];for(E=0;E<R;E++)D.push(y[E]);for(J=0;J<R;J++)for(b=y[J]+1;b<=y[J+1];b++)if(E=I[b],0<J&&b!==y[J+1]&&Math.abs(E-P[J])>Math.abs(E-P[J-1]))y[J]=b;else if(J<R-1&&y[J]!==b-1&&Math.abs(E-P[J])>Math.abs(E-P[J+1])){y[J+1]=b-1;break}b=A;A=0;E=[];J=[];for(let r=0;r<R;r++){E.push(P[r]);
J.push(e[r]);const H=L(r,y,I,S);P[r]=H.sbMean;e[r]=H.sbSdcm;A+=e[r]}}if(A>b){for(I=0;I<R;I++)y[I]=D[I],P[I]=E[I],e[I]=J[I];A=b}return{mean:P,sdcm:e}}function w(y,I,S,R,D){y=Math.max(R-y,I-R)/D/S;return 1<=y?1:.5<=y?.5:.25}function M(y){let I=0;for(let S=0;S<y.length;S++)I+=y[S];return I/=y.length}function h(y,I){let S=0;for(let R=0;R<y.length;R++){const D=y[R];S+=(D-I)*(D-I)}S/=y.length;return Math.sqrt(S)}function L(y,I,S,R){var D=0,E=0;for(var J=I[y]+1;J<=I[y+1];J++){const A=R[J];D+=S[J]*A;E+=A}0>=
E&&Q.warn("Exception in Natural Breaks calculation");D/=E;E=0;for(J=I[y]+1;J<=I[y+1];J++)E+=R[J]*(S[J]-D)**2;return{sbMean:D,sbSdcm:E}}const Q=u.getLogger("esri.rest.support.generateRendererUtils");g.createGenerateRendererClassBreaks=function(y){const {normalizationTotal:I}=y;return{classBreaks:f(y),normalizationTotal:I}};g.createGenerateRendererUniqueValues=function(y){y=l(y);const I=[],S=y.uniqueValues.length;for(let R=0;R<S;R++){const D=y.uniqueValues[R];I.push({value:D,count:y.valueFrequency[R],
label:D.toString()})}return{uniqueValues:I}};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(g,u,f,O,l,C,F){function w(R,D){if(!D)return null;
if("x"in D){var E={x:0,y:0};[E.x,E.y]=R(D.x,D.y,Q);null!=D.z&&(E.z=D.z);null!=D.m&&(E.m=D.m);return E}return"xmin"in D?(E={xmin:0,ymin:0,xmax:0,ymax:0},[E.xmin,E.ymin]=R(D.xmin,D.ymin,Q),[E.xmax,E.ymax]=R(D.xmax,D.ymax,Q),D.hasZ&&(E.zmin=D.zmin,E.zmax=D.zmax,E.hasZ=!0),D.hasM&&(E.mmin=D.mmin,E.mmax=D.mmax,E.hasM=!0),E):"rings"in D?{rings:M(D.rings,R),hasM:D.hasM,hasZ:D.hasZ}:"paths"in D?{paths:M(D.paths,R),hasM:D.hasM,hasZ:D.hasZ}:"points"in D?{points:h(D.points,R),hasM:D.hasM,hasZ:D.hasZ}:null}function M(R,
D){const E=[];for(const J of R)E.push(h(J,D));return E}function h(R,D){const E=[];for(const J of R)R=D(J[0],J[1],[0,0]),E.push(R),2<J.length&&R.push(J[2]),3<J.length&&R.push(J[3]);return E}function L(){L=u._asyncToGenerator(function*(R,D){R&&D&&(R=Array.isArray(R)?R.map(E=>f.isSome(E.geometry)?E.geometry.spatialReference:null).filter(f.isSome):[R],yield O.initializeProjection(R.map(E=>({source:E,dest:D}))))});return L.apply(this,arguments)}const Q=[0,0],y=w.bind(null,F.lngLatToXY),I=w.bind(null,F.xyToLngLat),
S=new (function(){function R(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var D=R.prototype;D.push=function(){var E=u._asyncToGenerator(function*(J,A,P){if(!(J&&J.length&&A&&P)||C.equals(A,P))return J;const e={geometries:J,inSpatialReference:A,outSpatialReference:P,resolve:null};this._jobs.push(e);return new Promise(c=>{e.resolve=c;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(J,A,P){return E.apply(this,arguments)}}();D._process=function(){this._timer=
null;const E=this._jobs.shift();if(E){var {geometries:J,inSpatialReference:A,outSpatialReference:P,resolve:e}=E;F.canProject(A,P)?C.isWebMercator(P)?e(J.map(y)):e(J.map(I)):e(O.projectMany(l.jsonAdapter,J,A,P,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return R}());g.checkProjectionSupport=function(R,D){return L.apply(this,arguments)};g.project=function(R,D,E,J){if(!R)return R;E||(E=D,D=R.spatialReference);return C.isValid(D)&&C.isValid(E)&&!C.equals(D,E)?F.canProject(D,
E)?(R=C.isWebMercator(E)?y(R):I(R),R.spatialReference=E,R):O.projectMany(l.jsonAdapter,[R],D,E,null,J)[0]:R};g.projectMany=function(R,D,E){return S.push(R,D,E)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(g){let u=function(F,w,M){this.x=F;this.y=w;this.spatialReference=M;this.m=this.z=void 0},f=function(F,w,M,h){this.rings=F;this.spatialReference=w;this.hasM=this.hasZ=void 0;
M&&(this.hasZ=M);h&&(this.hasM=h)},O=function(F,w,M,h){this.paths=F;this.spatialReference=w;this.hasM=this.hasZ=void 0;M&&(this.hasZ=M);h&&(this.hasM=h)},l=function(F,w,M,h){this.points=F;this.spatialReference=w;this.hasM=this.hasZ=void 0;M&&(this.hasZ=M);h&&(this.hasM=h)},C=function(F,w,M,h,L){this.xmin=F;this.ymin=w;this.xmax=M;this.ymax=h;this.spatialReference=L;this.mmax=this.mmin=this.zmax=this.zmin=void 0};g.jsonAdapter={convertToGEGeometry:function(F,w){return null==w?null:F.convertJSONToGeometry(w)},
exportPoint:function(F,w,M){M=new u(F.getPointX(w),F.getPointY(w),M);const h=F.hasZ(w),L=F.hasM(w);h&&(M.z=F.getPointZ(w));L&&(M.m=F.getPointM(w));return M},exportPolygon:function(F,w,M){return new f(F.exportPaths(w),M,F.hasZ(w),F.hasM(w))},exportPolyline:function(F,w,M){return new O(F.exportPaths(w),M,F.hasZ(w),F.hasM(w))},exportMultipoint:function(F,w,M){return new l(F.exportPoints(w),M,F.hasZ(w),F.hasM(w))},exportExtent:function(F,w,M){var h=F.hasZ(w);const L=F.hasM(w);M=new C(F.getXMin(w),F.getYMin(w),
F.getXMax(w),F.getYMax(w),M);h&&(h=F.getZExtent(w),M.zmin=h.vmin,M.zmax=h.vmax);L&&(F=F.getMExtent(w),M.mmin=F.vmin,M.mmax=F.vmax);return M}};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(g){g.makeEdgeCandidate=function(u,f,O,l,C,F=!1){return{objectId:u,target:f,distance:O,type:"edge",start:l,end:C,draped:F}};g.makeVertexCandidate=function(u,f,O){return{objectId:u,target:f,
distance:O,type:"vertex"}};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){function S(){S=f._asyncToGenerator(function*(m,k,B){const {outFields:q,orderByFields:T,groupByFieldsForStatistics:n,outStatistics:x}=m;if(q)for(var G=0;G<q.length;G++)q[G]=q[G].trim();if(T)for(G=0;G<T.length;G++)T[G]=T[G].trim();if(n)for(G=0;G<n.length;G++)n[G]=n[G].trim();if(x)for(G=0;G<x.length;G++)x[G].onStatisticField&&(x[G].onStatisticField=x[G].onStatisticField.trim());m.geometry&&!m.outSR&&(m.outSR=m.geometry.spatialReference);return R(m,k,B)});return S.apply(this,
arguments)}function R(m,k,B){return D.apply(this,arguments)}function D(){D=f._asyncToGenerator(function*(m,k,B){if(!m)return null;var {where:q}=m;m.where=q=q&&q.trim();if(!q||/^1 *= *1$/.test(q)||k&&k===q)m.where=null;if(!m.geometry)return m;k=yield J(m);m.distance=0;m.units=null;"esriSpatialRelEnvelopeIntersects"===m.spatialRel&&({spatialReference:q}=m.geometry,k=w.getGeometryExtent(k),k.spatialReference=q);if(k){yield I.checkProjectionSupport(k.spatialReference,B);q=k.spatialReference;k=E(k,B)&&
M.isExtent(k)?{spatialReference:q,rings:[[[k.xmin,k.ymin],[k.xmin,k.ymax],[k.xmax,k.ymax],[k.xmax,k.ymin],[k.xmin,k.ymin]]]}:k;q=(yield h.normalizeCentralMeridian(M.fromJSON(k)))[0];if(l.isNone(q))throw b;const T="quantizationParameters"in m&&m.quantizationParameters?.tolerance||"maxAllowableOffset"in m&&m.maxAllowableOffset||0;k=T&&E(k,B)?{densificationStep:8*T}:void 0;q=q.toJSON();k=yield I.project(q,q.spatialReference,B,k);if(!k)throw b;k.spatialReference=B;m.geometry=k}return m});return D.apply(this,
arguments)}function E(m,k){if(!m)return!1;const B=m.spatialReference;return(M.isExtent(m)||M.isPolygon(m)||M.isPolyline(m))&&!L.equals(B,k)&&!F.canProjectWithoutEngine(B,k)}function J(m){return A.apply(this,arguments)}function A(){A=f._asyncToGenerator(function*(m){const {distance:k,units:B}=m,q=m.geometry;if(null==k||"vertexAttributes"in q)return q;var T=q.spatialReference;m=B?c.fromJSON(B):C.getUnitString(T);T=T&&(L.isGeographic(T)||L.isWebMercator(T))?q:yield I.checkProjectionSupport(T,L.WGS84).then(()=>
I.project(q,L.WGS84));return(yield P())(T.spatialReference,T,k,m)});return A.apply(this,arguments)}function P(){return e.apply(this,arguments)}function e(){e=f._asyncToGenerator(function*(){return(yield new Promise((m,k)=>g(["../../../geometry/geometryEngineJSON"],m,k))).geodesicBuffer});return e.apply(this,arguments)}const c=new O.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
b=Object.freeze({}),r=new y,H=new y,d=new y,p={esriGeometryPoint:Q.convertToPoint,esriGeometryPolyline:Q.convertToPolyline,esriGeometryPolygon:Q.convertToPolygon,esriGeometryMultipoint:Q.convertToMultipoint},z=(m,k)=>"_geVersion"!==m?k:void 0;u.QUERY_ENGINE_EMPTY_RESULT=b;u.cleanFromGeometryEngine=function(m){return m&&"_geVersion"in m?JSON.parse(JSON.stringify(m,z)):m};u.getGeometry=function(m,k,B,q,T,n,x=k,G=B){const K=k&&x,U=B&&G;q=l.isSome(q)?"coords"in q?q:q.geometry:null;if(l.isNone(q))return null;
if(T)return k=Q.generalizeOptimizedGeometry(H,q,k,B,m,T,x,G),n&&(k=Q.quantizeOptimizedGeometry(d,k,K,U,m,n)),p[m]?.(k,K,U)??null;if(n)return n=Q.quantizeOptimizedGeometry(d,q,k,B,m,n,x,G),p[m]?.(n,K,U)??null;Q.removeZMValues(r,q,k,B,x,G);return p[m]?.(r,K,U)??null};u.normalizeQuery=function(m,k,B){return S.apply(this,arguments)};u.normalizeQueryLike=R;u.transformCentroid=function(m,k,B,q=m.hasZ,T=m.hasM){if(l.isNone(k))return null;const n=m.hasZ&&q,x=m.hasM&&T;return B?(m=Q.quantizeOptimizedGeometry(d,
k,m.hasZ,m.hasM,"esriGeometryPoint",B,q,T),Q.convertToPoint(m,n,x)):Q.convertToPoint(k,n,x)};Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./Settings ./snappingUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L){function Q(x,G){const K=h.projectPointToVerticalPlane(G,x.planeLike);x=x.getZ(G[0],G[1],G[2]);f.isSome(x)&&(K[2]=x);return K}function y(x,G){let K=[];if(R(x)){var {pointXYZ:U}=x;D(G)?K=h.intersectLineAndPoint(G.lineLike,U):E(G)?K=h.intersectCircleAndPoint(G.centerXYZ,G.radius,U):J(G)?K=h.intersectVerticalPlaneAndPoint(G.planeLike,U):A(G)&&(K=I(G,x))}else if(D(x))({lineLike:U}=x),R(G)?K=h.intersectLineAndPoint(U,G.pointXYZ):D(G)?K=h.intersectLineLike(U,G.lineLike):E(G)?
K=h.intersectLineLikeAndCircle(U,G.centerXYZ,G.radius):J(G)?K=h.intersectVerticalPlaneAndLineLike(G.planeLike,U):A(G)&&(K=I(G,x));else if(E(x)){const {centerXYZ:Y,radius:ba}=x;D(G)?K=h.intersectLineLikeAndCircle(G.lineLike,Y,ba):R(G)?K=h.intersectCircleAndPoint(Y,ba,G.pointXYZ):J(G)?K=h.intersectVerticalPlaneAndCircle(G.planeLike,Y,ba):A(G)&&(K=I(G,x))}else if(J(x)){const {planeLike:Y,coordinateHelper:ba}=x;if(J(G))return h.intersectVerticalPlane(Y,G.planeLike).map(la=>new H(ba,ba.fromXYZ(la),x,G));
R(G)?K=h.intersectVerticalPlaneAndPoint(Y,G.pointXYZ):D(G)?K=h.intersectVerticalPlaneAndLineLike(Y,G.lineLike):E(G)?K=h.intersectVerticalPlaneAndCircle(Y,G.centerXYZ,G.radius):A(G)&&(K=I(G,x))}else A(x)&&(K=I(x,G));return S(K,x,G)}function I(x,G){const {planeLike:K,getZ:U}=x,Y=[];if(R(G))x.addIfOnTheGround(Y,h.intersectVerticalPlaneAndPoint(K,G.pointXYZ));else if(D(G))x.addIfOnTheGround(Y,h.intersectVerticalPlaneAndLineLike(K,G.lineLike));else if(E(G))x.addIfOnTheGround(Y,h.intersectVerticalPlaneAndCircle(K,
G.centerXYZ,G.radius));else if(J(G)||A(G))for(const [ba,la]of h.intersectVerticalPlane(K,G.planeLike))x=U(ba,la,0),f.isSome(x)&&Y.push(F.fromValues(ba,la,x));return Y}function S(x,G,K){const U=G.coordinateHelper;return x.map(Y=>new r(U,U.fromXYZ(Y),G,K))}function R(x){return x instanceof e}function D(x){return x instanceof c}function E(x){return x instanceof d}function J(x){return x instanceof p}function A(x){return x instanceof k}let P=function(){function x(G){this.coordinateHelper=G}x.prototype.intersect=
function(G){return y(this,G)};return x}(),e=function(x){function G(U,Y){var ba=x.call(this,U)||this;ba.point=Y;ba.pointXYZ=U.toXYZ(Y);return ba}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return R(U)&&M.objectEqual(this.point,U.point)};K.check=function(U){U=this.coordinateHelper.toXYZ(U,B);return C.squaredDistance(U,this.pointXYZ)<w.defaults.pointThreshold};K.closestTo=function(){return this.coordinateHelper.clone(this.point)};return G}(P),c=function(x){function G(U,Y,ba,la){var pa=
x.call(this,U)||this;pa.start=Y;pa.end=ba;pa.type=la;pa.startXYZ=U.toXYZ(Y);pa.endXYZ=U.toXYZ(ba);pa.lineLike={start:pa.startXYZ,end:pa.endXYZ,type:pa.type};return pa}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return D(U)&&this.type===U.type&&M.objectEqual(this.start,U.start)&&M.objectEqual(this.end,U.end)};K.check=function(U){U=this.coordinateHelper.toXYZ(U,B);return h.pointToLineLikeDistance(this.lineLike,U)<w.defaults.pointOnLineThreshold};K.closestTo=function(U){const Y=this.coordinateHelper;
U=Y.toXYZ(U,B);U=h.projectPointToLineLike(U,this.lineLike);return Y.fromXYZ(U)};return G}(P),b=function(x){function G(K,U,Y){return x.call(this,K,U,Y,L.LineType.LINE)||this}u._inheritsLoose(G,x);return G}(c),r=function(x){function G(U,Y,ba,la){U=x.call(this,U)||this;U.intersection=Y;U.first=ba;U.second=la;return U}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return U instanceof G&&this.first.equals(U.first)&&this.second.equals(U.second)};K.check=function(){return!1};K.closestTo=function(){return this.coordinateHelper.clone(this.intersection)};
return G}(P),H=function(x){function G(U,Y,ba,la){U=x.call(this,U)||this;U.basePoint=Y;U.first=ba;U.second=la;return U}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return U instanceof G&&this.first.equals(U.first)&&this.second.equals(U.second)};K.check=function(){return!1};K.closestTo=function(U){var Y=this.basePoint;const ba=this.coordinateHelper;U=ba.toXYZ(U,B);Y=C.set(q,Y[0],Y[1],U[2]);return ba.fromXYZ(Y)};return G}(P),d=function(x){function G(U,Y,ba){var la=x.call(this,U)||this;
la.center=Y;la.radius=ba;la.centerXYZ=U.toXYZ(Y);return la}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return E(U)&&this.center[0]===U.center[0]&&this.center[1]===U.center[1]&&this.radius===U.radius};K.check=function(){return!1};K.closestTo=function(U){const Y=this.coordinateHelper;var ba=Y.toXYZ(U,B);ba=h.projectPointToCircle(ba,this.centerXYZ,this.radius);ba[2]=Y.getZ(U,this.centerXYZ[2]);return Y.fromXYZ(ba)};return G}(P),p=function(x){function G(U,Y,ba,la){U=x.call(this,U)||this;
U.start=Y;U.end=ba;U.type=la;U.planeLike={start:Y,end:ba,type:la};return U}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return J(U)&&this.type===U.type&&M.objectEqual(this.start,U.start)&&M.objectEqual(this.end,U.end)};K.check=function(U){U=this.coordinateHelper.toXYZ(U,B);return h.pointToVerticalPlaneDistance(U,this.planeLike)<w.defaults.pointOnLineThreshold};K.closestTo=function(U){const Y=this.coordinateHelper;U=Y.toXYZ(U,B);U=h.projectPointToVerticalPlane(U,this.planeLike);return Y.fromXYZ(U)};
K.closestEndTo=function(U){const {start:Y,end:ba}=this;return 0<Math.sign(O.dot(O.subtract(T,ba,Y),O.subtract(n,U,Y)))?ba:Y};return G}(P),z=function(x){function G(K,U,Y){return x.call(this,K,U,Y,h.VerticalPlaneType.HALF_PLANE)||this}u._inheritsLoose(G,x);return G}(p),m=function(x){function G(K,U,Y){return x.call(this,K,U,Y,h.VerticalPlaneType.PLANE)||this}u._inheritsLoose(G,x);return G}(p),k=function(x){function G(U,Y,ba,la){U=x.call(this,U)||this;U.start=Y;U.end=ba;U.getZ=la;U.planeLike={start:Y,
end:ba,type:h.VerticalPlaneType.HALF_PLANE};return U}u._inheritsLoose(G,x);var K=G.prototype;K.equals=function(U){return A(U)&&M.objectEqual(this.start,U.start)&&M.objectEqual(this.end,U.end)&&this.getZ===U.getZ};K.check=function(U){U=this.coordinateHelper.toXYZ(U,B);const Y=Q(this,U);return C.squaredDistance(U,Y)<w.defaults.pointThreshold};K.closestTo=function(U){const Y=this.coordinateHelper;U=Q(this,Y.toXYZ(U,B));return Y.fromXYZ(U)};K.addIfOnTheGround=function(U,Y){for(const ba of Y)Y=this.getZ(ba[0],
ba[1],ba[2]),f.isSome(Y)&&Math.abs(ba[2]-Y)<h.epsilon&&(ba[2]=Y,U.push(ba))};return G}(P);const B=F.create(),q=F.create(),T=l.create(),n=l.create();g.DrapedLineConstraint=k;g.IntersectionConstraint=r;g.LineConstraint=b;g.LineLikeConstraint=c;g.PlanarCircleConstraint=d;g.PointConstraint=e;g.SnappingConstraint=P;g.VerticalHalfPlaneConstraint=z;g.VerticalLineIntersectionConstraint=H;g.VerticalPlaneConstraint=m;g.VerticalPlaneLikeConstraint=p;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/chunks/vec2f64":function(){define(["exports"],function(g){function u(){return[0,0]}function f(R){return[R[0],R[1]]}function O(R,D){return[R,D]}function l(R){const D=[0,0],E=Math.min(2,R.length);for(let J=0;J<E;++J)D[J]=R[J];return D}function C(R,D){return new Float64Array(R,D,2)}function F(){return[0,0]}function w(){return[1,1]}function M(){return[1,0]}function h(){return[0,1]}const L=[0,0],Q=[1,1],y=[1,0],I=[0,1],S=Object.freeze(Object.defineProperty({__proto__:null,create:u,clone:f,fromValues:O,
fromArray:l,createView:C,zeros:F,ones:w,unitX:M,unitY:h,ZEROS:L,ONES:Q,UNIT_X:y,UNIT_Y:I},Symbol.toStringTag,{value:"Module"}));g.ONES=Q;g.UNIT_X=y;g.UNIT_Y=I;g.ZEROS=L;g.clone=f;g.create=u;g.createView=C;g.fromArray=l;g.fromValues=O;g.ones=w;g.unitX=M;g.unitY=h;g.vec2f64=S;g.zeros=F})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F){let w=function(M){function h(){var L=M.apply(this,arguments)||this;L.enabled=!0;return L}u._inheritsLoose(h,M);return h}(l.JSONSupport);f.__decorate([C.property({type:Boolean})],w.prototype,"enabled",void 0);w=f.__decorate([F.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],w);l=function(M){function h(L){L=M.call(this,L)||this;L.lineSnapper=new w;L.parallelLineSnapper=new w;L.rightAngleSnapper=new w;L.rightAngleTriangleSnapper=new w;L.shortLineThreshold=
15;L.distance=5;L.pointThreshold=1E-6;L.intersectionParallelLineThreshold=1E-6;L.parallelLineThreshold=1E-6;L.touchSensitivityMultiplier=1.5;L.pointOnLineThreshold=1E-6;L.orange=new O([255,127,0]);L.lineHintWidthReference=3;L.lineHintWidthTarget=3;L.lineHintFadedExtensions=.3;L.parallelLineHintWidth=2;L.parallelLineHintLength=24;L.parallelLineHintOffset=1.5;L.rightAngleHintSize=24;L.rightAngleHintOutlineSize=1.5;return L}u._inheritsLoose(h,M);return h}(l.JSONSupport);f.__decorate([C.property({type:w,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"lineSnapper",void 0);f.__decorate([C.property({type:w,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"parallelLineSnapper",void 0);f.__decorate([C.property({type:w,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"rightAngleSnapper",void 0);f.__decorate([C.property({type:w,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"rightAngleTriangleSnapper",void 0);f.__decorate([C.property({type:Number,
nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l.prototype,"shortLineThreshold",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l.prototype,"distance",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"pointThreshold",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"intersectionParallelLineThreshold",
void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"parallelLineThreshold",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"touchSensitivityMultiplier",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"pointOnLineThreshold",void 0);f.__decorate([C.property({type:O,nonNullable:!0})],l.prototype,"orange",void 0);
f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"lineHintWidthReference",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"lineHintWidthTarget",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],l.prototype,"lineHintFadedExtensions",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
l.prototype,"parallelLineHintWidth",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],l.prototype,"parallelLineHintLength",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],l.prototype,"parallelLineHintOffset",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],l.prototype,"rightAngleHintSize",void 0);f.__decorate([C.property({type:Number,nonNullable:!0,
range:{min:0,max:6},json:{write:!0}})],l.prototype,"rightAngleHintOutlineSize",void 0);l=f.__decorate([F.subclass("esri.views.interactive.snapping.Settings.Defaults")],l);f=new l;g.defaults=f;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/snappingUtils":function(){define(["exports","../../../core/maybe","../../../chunks/vec3","../../../chunks/vec3f64","../../../support/elevationInfoUtils"],function(g,u,f,O,l){function C(h,
L){const Q=h.x-L.x;h=h.y-L.y;return Q*Q+h*h}function F(h,L,Q,y){const {coordinateHelper:I,elevationInfo:S}=Q;if(!I.hasZ()||u.isNone(L)||"3d"!==L.type||u.isNone(h)||l.elevationInfoLikeEquals(S,y))return h;L=l.getConvertedElevationFromVector(L,h,I.spatialReference,S,y);h=I.clone(h);h[2]=L;return h}const w=O.create(),M=O.create();g.LineSegmentHintType=void 0;(function(h){h[h.TARGET=0]="TARGET";h[h.REFERENCE=1]="REFERENCE";h[h.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(g.LineSegmentHintType||(g.LineSegmentHintType=
{}));g.convertPointElevation=F;g.editEdgeToSnappingEdge=function(h,L,Q,y=l.absoluteHeightElevationInfo){return{left:F(h.leftVertex.pos,L,Q,y),right:F(h.rightVertex.pos,L,Q,y)}};g.makeFilter=function(h){return h.createQuery()};g.makeSnappingQuery=function(h,L){return{point:h.coordinateHelper.vectorToPoint(h.point).toJSON(),distance:h.distance,types:h.types,query:u.isSome(L)?L.toJSON():{where:"1\x3d1"}}};g.objectEqual=function(h,L){const Q=h.length===L.length&&h[0]===L[0]&&h[1]===L[1];switch(h.length){case 2:return Q;
case 3:return Q&&h[2]===L[2];case 4:return Q&&h[2]===L[2]&&h[3]===L[3]}return!1};g.screenDistance=function(h,L){return Math.sqrt(C(h,L))};g.sortCandidatesInPlace=function(h,L,Q){const y=Q.toXYZ(h,w);L.sort((I,S)=>{I=Q.toXYZ(I.targetPoint,M);I=f.squaredDistance(I,y);S=Q.toXYZ(S.targetPoint,M);S=f.squaredDistance(S,y);return I-S})};g.squaredScreenDistance=C;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),
function(g,u,f,O,l,C,F){function w(b,{start:r,end:H,type:d}){b=l.sub(S,b,r);H=l.sub(R,H,r);b=l.dot(b,H)/l.dot(H,H);return l.scaleAndAdd(C.create(),r,H,d===F.LineType.RAY?Math.max(b,0):b)}function M({start:b,end:r,type:H},d){const p=l.sub(S,d,b);r=l.sub(R,r,b);if(H===F.LineType.RAY&&-1E-6>l.dot(r,p))return l.distance(b,d);b=l.cross(D,r,p);return l.len(b)/l.len(r)}function h(b,r){const H=b.start,d=r.start;var p=r.end;const z=l.sub(S,b.end,H);p=l.sub(R,p,d);var m=l.sub(D,d,H),k=l.cross(E,z,p),B=l.dot(m,
k);if(!u.floatEqualAbsolute(B,0,1E-6))return[];B=l.sqrLen(k);if(u.floatEqualAbsolute(B,0,1E-6))return[];m=l.cross(J,m,p);k=l.dot(m,k)/B;k=l.scaleAndAdd(A,H,z,k);return b.type===F.LineType.RAY&&(b=l.sub(P,k,H),-1E-6>l.dot(z,b))||r.type===F.LineType.RAY&&(r=l.sub(P,k,d),-1E-6>l.dot(p,r))?[]:[C.clone(k)]}function L({start:b,end:r,type:H},d){const p=l.sub(S,d,b);b=l.sub(R,r,b);r=l.cross(D,b,p);if(1E-6>l.sqrLen(r)/l.sqrLen(b))switch(H){case F.LineType.LINE:return[C.clone(d)];case F.LineType.RAY:return-1E-6>
l.dot(b,p)?[]:[C.clone(d)]}return[]}function Q(b,r,H){return u.floatEqualAbsolute(b[2],H[2],1E-6)&&u.floatEqualAbsolute(l.squaredDistance(H,b),r*r,1E-6)?[C.clone(H)]:[]}function y(b,r,{start:H,end:d,type:p}){l.set(b.start,H[0],H[1],r);l.set(b.end,d[0],d[1],r);b.type=I[p];return b}g.VerticalPlaneType=void 0;(function(b){b[b.PLANE=0]="PLANE";b[b.HALF_PLANE=1]="HALF_PLANE"})(g.VerticalPlaneType||(g.VerticalPlaneType={}));const I={[g.VerticalPlaneType.PLANE]:F.LineType.LINE,[g.VerticalPlaneType.HALF_PLANE]:F.LineType.RAY},
S=C.create(),R=C.create(),D=C.create(),E=C.create(),J=C.create(),A=C.create(),P=C.create(),e={start:C.create(),end:C.create(),type:F.LineType.LINE},c={start:C.create(),end:C.create(),type:F.LineType.LINE};Object.defineProperty(g,"LineType",{enumerable:!0,get:()=>F.LineType});g.epsilon=1E-6;g.intersectCircleAndPoint=Q;g.intersectLineAndPoint=L;g.intersectLineLike=h;g.intersectLineLikeAndCircle=function({start:b,end:r,type:H},d,p){const z=[];if(u.floatEqualAbsolute(b[2],d[2],1E-6)&&u.floatEqualAbsolute(r[2],
d[2],1E-6)){var m=f.subtract(S,r,b),k=f.subtract(R,b,d);r=f.squaredLength(m);var B=2*f.dot(m,k);p=f.squaredLength(k)-p*p;p=B*B-4*r*p;0===p?(p=-B/(2*r),(H===F.LineType.LINE||0<=p)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,m,p))):0<p&&(p=Math.sqrt(p),k=(-B+p)/(2*r),(H===F.LineType.LINE||0<=k)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,m,k)),p=(-B-p)/(2*r),(H===F.LineType.LINE||0<=p)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,m,p)))}else{r=l.sub(S,r,b);if(u.floatEqualAbsolute(r[2],0,1E-6))return z;
B=l.scaleAndAdd(R,b,r,(d[2]-b[2])/r[2]);if(H===F.LineType.RAY&&(b=l.sub(D,B,b),-1E-6>l.dot(r,b)))return z;for(m of Q(d,p,B))z.push(m)}return z};g.intersectVerticalPlane=function(b,r){b=y(e,0,b);r=y(c,0,r);r=h(b,r);b=[];for(const H of r)b.push(O.clone(H));return b};g.intersectVerticalPlaneAndCircle=function({start:b,end:r,type:H},d,p){const z=[];r=f.subtract(S,r,b);var m=f.subtract(R,b,d),k=f.squaredLength(r);const B=2*f.dot(r,m);p=f.squaredLength(m)-p*p;p=B*B-4*k*p;0===p?(k=-B/(2*k),(H===g.VerticalPlaneType.PLANE||
0<=k)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,r,k))):0<p&&(p=Math.sqrt(p),m=(-B+p)/(2*k),(H===g.VerticalPlaneType.PLANE||0<=m)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,r,m)),k=(-B-p)/(2*k),(H===g.VerticalPlaneType.PLANE||0<=k)&&z.push(f.scaleAndAdd(C.fromValues(0,0,d[2]),b,r,k)));return z};g.intersectVerticalPlaneAndLineLike=function(b,r){const H=b.start,d=f.subtract(S,b.end,H);var p=l.set(R,-d[1],d[0],0);const z=r.start,m=l.sub(D,r.end,z);var k=l.dot(m,p),B=l.set(E,H[0],H[1],0);B=l.sub(J,
B,z);p=l.dot(B,p);if(1E-6>Math.abs(k))return[];k=l.scaleAndAdd(A,z,m,p/k);return r.type===F.LineType.RAY&&(r=l.sub(P,k,z),-1E-6>l.dot(r,m))||b.type===g.VerticalPlaneType.HALF_PLANE&&(b=f.sub(P,k,H),-1E-6>f.dot(b,d))?[]:[C.clone(k)]};g.intersectVerticalPlaneAndPoint=function(b,r){return L(y(e,r[2],b),r)};g.pointToLineLikeDistance=M;g.pointToVerticalPlaneDistance=function(b,r){return M(y(e,b[2],r),b)};g.projectPointToCircle=function(b,r,H){b=l.set(S,b[0],b[1],r[2]);b=l.subtract(R,b,r);H/=l.length(b);
return l.scaleAndAdd(C.create(),r,b,H)};g.projectPointToLineLike=w;g.projectPointToVerticalPlane=function(b,r){return w(b,y(e,b[2],r))};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(g,u,f,O){function l(y,I){return y[0]*I[1]-y[1]*I[0]}function C(y,I,S){I=f.dot(S,I)/f.squaredLength(S);return f.scale(y,S,I)}function F(y,
I,S,R,D=S){f.subtract(M,R,S);f.subtract(L,I,D);C(Q,L,M);return f.add(y,D,Q)}function w(y,I,S,R){f.subtract(M,I,S);I=R/f.length(M);return f.scaleAndAdd(y,S,M,I)}g.LineType=void 0;(function(y){y[y.RAY=0]="RAY";y[y.LINE=1]="LINE"})(g.LineType||(g.LineType={}));const M=O.create(),h=O.create(),L=O.create(),Q=O.create();g.cross=l;g.intersectCircleAndPoint=function(y,I,S){w(L,S,y,I);return u.floatEqualAbsolute(L[0],S[0])&&u.floatEqualAbsolute(L[1],S[1])?[O.clone(S)]:[]};g.intersectLineAndPoint=function(y,
I){F(L,I,y.start,y.end);return u.floatEqualAbsolute(L[0],I[0])&&u.floatEqualAbsolute(L[1],I[1])?[O.clone(I)]:[]};g.intersectLineAndRay=function(y,I){const S=y.start;var R=I.start,D=I.end;const E=f.subtract(M,y.end,S);var J=f.subtract(h,D,R);D=l(E,J);if(1E-6>=Math.abs(D))return[];R=f.subtract(L,S,R);J=l(J,R)/D;D=l(E,R)/D;if(0<=J){if(0<=D||I.type===g.LineType.LINE)return[f.scaleAndAdd(Q,S,E,J)]}else if(y.type===g.LineType.LINE&&(0<=D||I.type===g.LineType.LINE))return[f.scaleAndAdd(Q,S,E,J)];return[]};
g.intersectLineLikeAndCircle=function(y,I,S){const R=[],D=f.subtract(M,y.end,y.start);var E=f.subtract(h,y.start,I);I=f.squaredLength(D);const J=2*f.dot(D,E);S=f.squaredLength(E)-S*S;S=J*J-4*I*S;0===S?(I=-J/(2*I),(y.type===g.LineType.LINE||0<=I)&&R.push(f.scaleAndAdd(Q,y.start,D,I))):0<S&&(S=Math.sqrt(S),E=(-J+S)/(2*I),(y.type===g.LineType.LINE||0<=E)&&R.push(f.scaleAndAdd(Q,y.start,D,E)),I=(-J-S)/(2*I),(y.type===g.LineType.LINE||0<=I)&&R.push(f.scaleAndAdd(L,y.start,D,I)));return R};g.pointToLineDistance=
function(y,I,S){return Math.abs((I[0]-y[0])*(S[1]-y[1])-(I[1]-y[1])*(S[0]-y[0]))/f.distance(I,S)};g.projectPoint=C;g.projectPointToCircle=w;g.projectPointToLine=F;g.projectPointToRay=function(y,I,S,R){f.subtract(M,R,S);f.subtract(L,I,S);I=f.dot(M,L)/f.squaredLength(M);return 0<I?f.scaleAndAdd(y,S,M,I):f.copy(y,S)};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(g,u,f,O,l,C){l=function(F){function w(M){return F.call(this,{...M,constraint:new f.LineConstraint(M.coordinateHelper,M.edgeStart,M.edgeEnd)})||this}u._inheritsLoose(w,F);u._createClass(w,[{key:"hints",get:function(){return[new C.LineSnappingHint(O.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo,this.domain)]}}]);return w}(l.FeatureSnappingCandidate);g.EdgeSnappingCandidate=l;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],function(g,u,f,O){O=function(l){function C({coordinateHelper:F,targetPoint:w,objectId:M,constraint:h,elevationInfo:L}){F=l.call(this,F,w,h,L,f.SnappingDomain.FEATURE)||this;F.objectId=M;return F}u._inheritsLoose(C,l);return C}(O.SnappingCandidate);g.FeatureSnappingCandidate=O;Object.defineProperties(g,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(g){g.SnappingCandidate=function(u,f,O,l,C){this.coordinateHelper=u;this.targetPoint=f;this.constraint=O;this.elevationInfo=l;this.domain=C};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h,L,Q,y,I=l.SnappingDomain.ALL,S=!0,R=!0){y=w.call(this,y,I)||this;y.type=h;y.lineStart=L;y.lineEnd=Q;y.fadeLeft=S;y.fadeRight=R;return y}u._inheritsLoose(M,w);M.prototype.equals=function(h){return h instanceof M?this.type===h.type&&C.objectEqual(this.lineStart,h.lineStart)&&C.objectEqual(this.lineEnd,h.lineEnd)&&this.fadeLeft===h.fadeLeft&&this.fadeRight===h.fadeRight:!1};return M}(F.SnappingHint);g.LineSnappingHint=f;Object.defineProperties(g,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(g){g.SnappingHint=function(u,f){this.elevationInfo=u;this.domain=f};Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(g,u,f,O,l,C,F){l=function(w){function M({coordinateHelper:h,targetPoint:L,constraint:Q,previousVertex:y,otherVertex:I,otherVertexType:S,objectId:R,elevationInfo:D}){h=w.call(this,h,L,Q,D,f.SnappingDomain.SELF)||this;h.previousVertex=y;h.otherVertex=I;h.otherVertexType=S;h.objectId=R;return h}u._inheritsLoose(M,w);u._createClass(M,[{key:"hints",get:function(){const h=this.previousVertex,L=this.otherVertexType===g.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,Q=this.otherVertexType===
g.OtherVertexType.CENTER?this.targetPoint:this.otherVertex,y=this.elevationInfo;return[new C.LineSnappingHint(O.LineSegmentHintType.TARGET,L,Q,y,this.domain),new C.LineSnappingHint(O.LineSegmentHintType.REFERENCE,h,L,y,this.domain),new F.RightAngleSnappingHint(this.previousVertex,L,Q,y,this.domain)]}}]);return M}(l.SnappingCandidate);g.OtherVertexType=void 0;(function(w){w[w.NEXT=0]="NEXT";w[w.CENTER=1]="CENTER"})(g.OtherVertexType||(g.OtherVertexType={}));g.RightAngleSnappingCandidate=l;Object.defineProperties(g,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),function(g,u,f,O,l,C,F){f=function(w){function M(h,L,Q,y,I=l.SnappingDomain.ALL){y=w.call(this,y,I)||this;y.previousVertex=h;y.centerVertex=L;y.nextVertex=Q;return y}u._inheritsLoose(M,w);M.prototype.equals=
function(h){return h instanceof M?C.objectEqual(this.previousVertex,h.previousVertex)&&C.objectEqual(this.centerVertex,h.centerVertex)&&C.objectEqual(this.nextVertex,h.nextVertex):!1};return M}(F.SnappingHint);g.RightAngleSnappingHint=f;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/Point ../../../support/elevationInfoUtils".split(" "),
function(g,u,f,O,l,C,F){function w(R,D,E,J,A=l.create()){R=D.toXYZ(R);R[2]=F.getConvertedElevationFromVector(J,R,D.spatialReference,E)||0;J.renderCoordsHelper.toRenderCoords(R,D.spatialReference,A);return A}function M(R,D,E,J,A=l.create()){R=O.copy(Q,R);R[2]=F.getConvertedElevationFromVector(J,R,D,E)||0;J.renderCoordsHelper.toRenderCoords(R,D,A);return A}function h(R,D,E,J){if("2d"===J.type)return L.x=R[0],L.y=R[1],L.spatialReference=D,J.toScreen(L);M(R,D,E,J,Q);J.state.camera.projectToScreen(Q,S);
return u.createScreenPoint(S[0],S[1])}const L=new C,Q=l.create(),y=u.createRenderScreenPointArray3(),I=u.createRenderScreenPointArray3(),S=u.createScreenPointArray();g.anyMapPointToRender=w;g.anyMapPointToScreenPoint=function(R,D,E,J){return h(D.toXYZ(R),D.spatialReference,E,J)};g.anyMapPointsToRenderWithEqualRelativeZ=function(R,D,E,J,A,P,e){if("absolute-height"===J.mode)w(R,E,J,A,P),w(D,E,J,A,e);else{R=E.toXYZ(R);D=E.toXYZ(D);var c=F.getConvertedElevationFromVector(A,R,E.spatialReference,J);J=F.getConvertedElevationFromVector(A,
D,E.spatialReference,J);J=(null==c?J:null==J?c:Math.min(c,J))||0;R[2]=J;D[2]=J;A.renderCoordsHelper.toRenderCoords(R,E.spatialReference,P);A.renderCoordsHelper.toRenderCoords(D,E.spatialReference,e)}};g.renderScreenSpaceTangent=function(R,D,E,J){E.projectToRenderScreen(R,y);E.projectToRenderScreen(D,I);f.subtract(J,I,y);f.normalize(J,J)};g.vectorToRender=M;g.vectorToScreenPoint=h;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S){g.SelfSnappingEngine=function(R){function D(J){J=R.call(this,J)||this;J.updating=!1;J._snappers=new l;J._domain=I.SnappingDomain.SELF;return J}u._inheritsLoose(D,R);var E=D.prototype;E.initialize=function(){this._snappers.push(new L.ParallelLineSnapper(this.view,this.options),new h.LineSnapper(this.view,this.options),new Q.RightAngleSnapper(this.view,this.options),new y.RightAngleTriangleSnapper(this.view,this.options))};E.fetchCandidates=function(){var J=u._asyncToGenerator(function*(A,
P,e){if(!(P&this._domain&&this.options.effectiveSelfEnabled))return[];P=[];for(const c of this._snappers.items)for(const b of c.snap(A,e))P.push(b);S.sortCandidatesInPlace(A,P,e.coordinateHelper);return P});return function(A,P,e){return J.apply(this,arguments)}}();u._createClass(D,[{key:"options",set:function(J){this._set("options",J);for(const A of this._snappers)A.options=J}}]);return D}(O);f.__decorate([C.property({readOnly:!0})],g.SelfSnappingEngine.prototype,"updating",void 0);f.__decorate([C.property({constructOnly:!0})],
g.SelfSnappingEngine.prototype,"view",void 0);f.__decorate([C.property()],g.SelfSnappingEngine.prototype,"options",null);g.SelfSnappingEngine=f.__decorate([M.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],g.SelfSnappingEngine);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L){C=function(R){function D(){return R.apply(this,arguments)||this}u._inheritsLoose(D,R);var E=D.prototype;E.snapNewVertex=function(J,A){var P=A.editGeometryOperations.data.components[0],e=P.edges.length;const c=[];if(1>e)return c;const b=M.anyMapPointToScreenPoint(J,A.coordinateHelper,l.absoluteHeightElevationInfo,this.view),{view:r}=this;e=P=P.edges[e-1];do{if(this.edgeExceedsShortLineThreshold(e,A)){const H=F.editEdgeToSnappingEdge(e,r,A);this._processCandidateProposal(H.left,
H.right,J,b,A,c)}e=e.leftVertex.leftEdge}while(e&&e!==P);return c};E.snapExistingVertex=function(J,A){const P=[],e=f.unwrap(A.vertexHandle);var c=e.component;if(2>c.edges.length)return P;const {view:b}=this;var {coordinateHelper:r}=A;r=M.anyMapPointToScreenPoint(J,r,l.absoluteHeightElevationInfo,b);var H=e.leftEdge,d=e.rightEdge;H&&d&&this.edgeExceedsShortLineThreshold(H,A)&&this.edgeExceedsShortLineThreshold(d,A)&&this._processCandidateProposal(F.convertPointElevation(H.leftVertex.pos,b,A),F.convertPointElevation(d.rightVertex.pos,
b,A),J,r,A,P);H=c=c.edges[0];do H!==e.leftEdge&&H!==e.rightEdge&&this.edgeExceedsShortLineThreshold(H,A)&&(d=F.editEdgeToSnappingEdge(H,b,A),this._processCandidateProposal(d.left,d.right,J,r,A,P)),H=H.rightVertex.rightEdge;while(H&&H!==c);return P};E._processCandidateProposal=function(J,A,P,e,c,b){const {coordinateHelper:r,pointer:H}=c;r.toXYZ(J,Q);r.toXYZ(A,y);P=r.toXYZ(P,S);P=h.projectPointToLineLike(P,I);P=r.fromXYZ(P);F.squaredScreenDistance(e,M.anyMapPointToScreenPoint(P,r,l.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(H)&&b.push(new w.LineSnappingCandidate({coordinateHelper:r,lineStart:J,lineEnd:A,targetPoint:P,elevationInfo:r.hasZ()?l.absoluteHeightElevationInfo:null}))};return D}(C.SnappingAlgorithm);const Q=O.create(),y=O.create(),I={start:Q,end:y,type:L.LineType.LINE},S=O.create();g.LineSnapper=C;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ./Settings ./snappingUtils ../support/viewUtils".split(" "),
function(g,u,f,O,l,C){let F=function(){function w(h,L){this.view=h;this.options=L;this.squaredShortLineThreshold=O.defaults.shortLineThreshold*O.defaults.shortLineThreshold}var M=w.prototype;M.snap=function(h,L){return f.isSome(L.vertexHandle)?"vertex"!==L.vertexHandle.type?[]:this.snapExistingVertex(h,L):this.snapNewVertex(h,L)};M.edgeExceedsShortLineThreshold=function(h,L){return this.exceedsShortLineThreshold(h.leftVertex.pos,h.rightVertex.pos,L)};M.exceedsShortLineThreshold=function(h,L,{elevationInfo:Q,
editGeometryOperations:y}){y=y.data.coordinateHelper;return 0===this.squaredShortLineThreshold||l.squaredScreenDistance(C.anyMapPointToScreenPoint(L,y,Q,this.view),C.anyMapPointToScreenPoint(h,y,Q,this.view))>this.squaredShortLineThreshold};M.squaredProximityThreshold=function(h){return"touch"===h?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};u._createClass(w,[{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",
get:function(){const {distance:h,touchSensitivityMultiplier:L}=this.options,Q=h*L;return Q*Q}}]);return w}();g.SnappingAlgorithm=F;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),function(g,u,f,O,l,C,F){C=
function(w){function M({coordinateHelper:h,lineStart:L,lineEnd:Q,targetPoint:y,elevationInfo:I}){h=w.call(this,h,y,new f.VerticalPlaneConstraint(h,L,Q),I,O.SnappingDomain.SELF)||this;h._referenceLineHint=new F.LineSnappingHint(l.LineSegmentHintType.REFERENCE_EXTENSION,L,Q,I,h.domain);return h}u._inheritsLoose(M,w);M.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};u._createClass(M,[{key:"hints",get:function(){return[this._referenceLineHint,new F.LineSnappingHint(l.LineSegmentHintType.TARGET,
this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo,this.domain)]}}]);return M}(C.SnappingCandidate);g.LineSnappingCandidate=C;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q){w=function(I){function S(){return I.apply(this,arguments)||this}u._inheritsLoose(S,I);var R=S.prototype;R.snapNewVertex=function(D,E){var J=E.editGeometryOperations.data.components[0],A=J.edges.length,P=J.vertices.length;const e=[];if(2>A)return e;const {view:c}=this,b=L.anyMapPointToScreenPoint(D,E.coordinateHelper,C.absoluteHeightElevationInfo,c);P=M.convertPointElevation(J.vertices[P-1].pos,c,E);const r=M.convertPointElevation(J.vertices[0].pos,c,E);A=J=J.edges[A-
1];do{if(this.edgeExceedsShortLineThreshold(A,E)){const H=M.editEdgeToSnappingEdge(A,c,E);this._checkEdgeForParalleLines(H,P,D,b,E,e);this._checkEdgeForParalleLines(H,r,D,b,E,e)}A=A.leftVertex.leftEdge}while(A&&A!==J);return e};R.snapExistingVertex=function(D,E){const J=[],A=f.unwrap(E.vertexHandle);var P=A.component;if(3>P.edges.length)return J;const {view:e}=this,c=L.anyMapPointToScreenPoint(D,E.coordinateHelper,C.absoluteHeightElevationInfo,e),b=A.leftEdge,r=A.rightEdge,H=P.vertices[0],d=M.convertPointElevation(H.pos,
e,E),p=P.vertices[P.vertices.length-1],z=M.convertPointElevation(p.pos,e,E);let m=P=P.edges[0];do{if(m!==b&&m!==r&&this.edgeExceedsShortLineThreshold(m,E)){const k=M.editEdgeToSnappingEdge(m,e,E);b&&this._checkEdgeForParalleLines(k,M.convertPointElevation(b.leftVertex.pos,e,E),D,c,E,J);r&&this._checkEdgeForParalleLines(k,M.convertPointElevation(r.rightVertex.pos,e,E),D,c,E,J);A===H?this._checkEdgeForParalleLines(k,z,D,c,E,J):A===p&&this._checkEdgeForParalleLines(k,d,D,c,E,J)}m=m.rightVertex.rightEdge}while(m&&
m!==P);return J};R._checkEdgeForParalleLines=function(D,E,J,A,P,e){const c=D.left,b=D.right;Q.projectPointToLine(y,E,c,b);if(!(O.squaredDistance(y,E)<F.defaults.parallelLineThreshold)){Q.projectPointToLine(y,J,c,b,E);var {coordinateHelper:r,pointer:H}=P;J=r.fromXYZ(y,r.getZ(J,0));M.squaredScreenDistance(A,L.anyMapPointToScreenPoint(J,r,C.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(H)&&!this._parallelToPreviousCandidate(D,e)&&e.push(new h.ParallelLineSnappingCandidate({coordinateHelper:r,
referenceLine:D,lineStart:E,targetPoint:J,elevationInfo:r.hasZ()?C.absoluteHeightElevationInfo:null}))}};R._parallelToPreviousCandidate=function(D,E){const J=D.left,A=D.right;for(const P of E)if(Q.projectPointToLine(y,A,P.constraint.start,P.constraint.end,J),O.squaredDistance(y,A)<F.defaults.parallelLineThreshold)return P.addReferenceLine(D),!0;return!1};return S}(w.SnappingAlgorithm);const y=l.create();g.ParallelLineSnapper=w;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(g,u,f,O,l,C,F,w,M,h){w=function(I){function S({coordinateHelper:R,referenceLine:D,lineStart:E,targetPoint:J,elevationInfo:A}){const P=R.toXYZ(E,L),e=
R.toXYZ(D.left,Q),c=R.toXYZ(D.right,y);f.subtract(P,f.add(P,P,c),e);R=I.call(this,R,J,new l.VerticalPlaneConstraint(R,E,R.fromXYZ(P)),A,C.SnappingDomain.SELF)||this;R._referenceLines=[{edge:D,fadeLeft:!0,fadeRight:!0}];return R}u._inheritsLoose(S,I);S.prototype.addReferenceLine=function(R){const D={edge:R,fadeLeft:!0,fadeRight:!0},{coordinateHelper:E}=this;this._referenceLines.forEach(J=>{E.equals(R.right,J.edge.left)&&(J.fadeLeft=!1,D.fadeRight=!1);E.equals(R.right,J.edge.right)&&(J.fadeRight=!1,
D.fadeRight=!1);E.equals(R.left,J.edge.right)&&(J.fadeRight=!1,D.fadeLeft=!1);E.equals(R.left,J.edge.left)&&(J.fadeLeft=!1,D.fadeLeft=!1)});this._referenceLines.push(D)};u._createClass(S,[{key:"hints",get:function(){const R=this.elevationInfo;return[new M.LineSnappingHint(F.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,R,this.domain),new h.ParallelSnappingHint(this.constraint.start,this.targetPoint,R,this.domain),...this._referenceLines.map(D=>new M.LineSnappingHint(F.LineSegmentHintType.REFERENCE,
D.edge.left,D.edge.right,R,this.domain,D.fadeLeft,D.fadeRight))]}}]);return S}(w.SnappingCandidate);const L=O.create(),Q=O.create(),y=O.create();g.ParallelLineSnappingCandidate=w;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),
function(g,u,f,O,l,C,F){f=function(w){function M(h,L,Q,y=l.SnappingDomain.ALL){Q=w.call(this,Q,y)||this;Q.lineStart=h;Q.lineEnd=L;return Q}u._inheritsLoose(M,w);M.prototype.equals=function(h){return h instanceof M?C.objectEqual(this.lineStart,h.lineStart)&&C.objectEqual(this.lineEnd,h.lineEnd):!1};return M}(F.SnappingHint);g.ParallelSnappingHint=f;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y){M=function(E){function J(){return E.apply(this,arguments)||this}u._inheritsLoose(J,E);var A=J.prototype;A.snapNewVertex=function(P,e){var c=e.editGeometryOperations.data.components[0],b=c.vertices.length;const r=[];if(2>b)return r;var {view:H}=this;const d=y.anyMapPointToScreenPoint(P,e.coordinateHelper,w.absoluteHeightElevationInfo,H);var p=c.vertices[b-1];this.edgeExceedsShortLineThreshold(p.leftEdge,e)&&(b=L.convertPointElevation(p.pos,H,e),p=L.editEdgeToSnappingEdge(p.leftEdge,
H,e),this._checkForSnappingCandidate(r,p,b,P,p.left,b,e,P,d));b=c.vertices[0];this.edgeExceedsShortLineThreshold(b.rightEdge,e)&&(c=L.convertPointElevation(b.pos,H,e),H=L.editEdgeToSnappingEdge(b.rightEdge,H,e),this._checkForSnappingCandidate(r,H,c,P,H.right,c,e,P,d));return r};A.snapExistingVertex=function(P,e){const c=[];var b=f.unwrap(e.vertexHandle),r=b.component;const H=r.vertices.length;if(3>H)return c;var {view:d}=this;const p=y.anyMapPointToScreenPoint(P,e.coordinateHelper,w.absoluteHeightElevationInfo,
d);var z=b.leftEdge;b=b.rightEdge;var m=r.vertices[0];r=r.vertices[H-1];if(!z)return b=m.rightEdge.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(b,e)&&(b=L.editEdgeToSnappingEdge(b,d,e),d=L.convertPointElevation(m.rightEdge.rightVertex.pos,d,e),this._checkForSnappingCandidate(c,b,d,P,b.right,d,e,P,p)),c;if(!b)return b=r.leftEdge.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(b,e)&&(b=L.editEdgeToSnappingEdge(b,d,e),d=L.convertPointElevation(r.leftEdge.leftVertex.pos,d,e),this._checkForSnappingCandidate(c,
b,d,P,b.left,d,e,P,p)),c;z&&z.leftVertex.leftEdge&&(m=z.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(m,e)&&(m=L.editEdgeToSnappingEdge(m,d,e),z=L.convertPointElevation(z.leftVertex.pos,d,e),this._checkForSnappingCandidate(c,m,z,P,m.left,z,e,P,p)));b&&b.rightVertex.rightEdge&&(z=b.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(z,e)&&(z=L.editEdgeToSnappingEdge(z,d,e),d=L.convertPointElevation(b.rightVertex.pos,d,e),this._checkForSnappingCandidate(c,z,d,P,z.right,d,e,P,p)));return c};
A._checkForSnappingCandidate=function(P,e,c,b,r,H,d,p,z){const {coordinateHelper:m,pointer:k}=d;O.subtract(I,e.right,e.left);e=C.set(D,I[1],-I[0],0);c=O.dot(e,O.subtract(I,b,c))/O.squaredLength(e);p=m.fromXYZ(O.scaleAndAdd(I,H,e,c),m.getZ(p,0));L.squaredScreenDistance(z,y.anyMapPointToScreenPoint(p,m,w.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(k)&&(z=m.toXYZ(H,S),z=C.scaleAndAdd(R,z,e,Math.sign(c)),z=m.fromXYZ(z),P.push(new Q.RightAngleSnappingCandidate({coordinateHelper:m,
targetPoint:p,constraint:new h.VerticalHalfPlaneConstraint(m,H,z),previousVertex:r,otherVertex:H,otherVertexType:Q.OtherVertexType.CENTER,elevationInfo:m.hasZ()?w.absoluteHeightElevationInfo:null})))};return J}(M.SnappingAlgorithm);const I=l.create(),S=F.create(),R=F.create(),D=F.create();g.RightAngleSnapper=M;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L){F=function(I){function S(){return I.apply(this,arguments)||this}u._inheritsLoose(S,I);var R=S.prototype;R.snapNewVertex=function(D,E){var J=E.editGeometryOperations.data.components[0];const A=[];var P=J.vertices.length;if("polygon"!==E.editGeometryOperations.data.type||2>P)return A;var {view:e}=this;P=J.vertices[P-1];J=w.convertPointElevation(J.vertices[0].pos,e,E);e=w.convertPointElevation(P.pos,e,E);this._processCandidateProposal(J,e,D,E,A);return A};R.snapExistingVertex=
function(D,E){const J=[];var A=f.unwrap(E.vertexHandle),P=A.component;if(2>P.edges.length||"polyline"===E.editGeometryOperations.data.type&&(0===A.index||A.index===P.vertices.length-1))return J;const {view:e}=this;P=w.convertPointElevation(A.leftEdge.leftVertex.pos,e,E);A=w.convertPointElevation(A.rightEdge.rightVertex.pos,e,E);this._processCandidateProposal(P,A,D,E,J);return J};R._processCandidateProposal=function(D,E,J,A,P){if(this.exceedsShortLineThreshold(D,E,A)){var e=O.lerp(Q,D,E,.5),c=.5*O.distance(D,
E);e=L.projectPointToCircle(y,J,e,c);var {coordinateHelper:b,pointer:r}=A;A=b.fromXYZ(e,b.getZ(J,0));J=h.anyMapPointToScreenPoint(J,b,C.absoluteHeightElevationInfo,this.view);w.squaredScreenDistance(J,h.anyMapPointToScreenPoint(A,b,C.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(r)&&P.push(new M.RightAngleTriangleSnappingCandidate({coordinateHelper:b,targetPoint:A,point1:D,point2:E,elevationInfo:b.hasZ()?C.absoluteHeightElevationInfo:null}))}};return S}(F.SnappingAlgorithm);
const Q=l.create(),y=l.create();g.RightAngleTriangleSnapper=F;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(g,u,f,O,l,C,F,w,M,h){w=function(Q){function y({coordinateHelper:I,targetPoint:S,point1:R,point2:D,elevationInfo:E}){I=Q.call(this,I,S,new l.PlanarCircleConstraint(I,I.arrayToVector(f.lerp(L,R,D,.5)),.5*f.distance(R,D)),E,C.SnappingDomain.SELF)||this;I._p1=R;I._p2=D;return I}u._inheritsLoose(y,Q);u._createClass(y,[{key:"hints",get:function(){const I=this.elevationInfo;return[new M.LineSnappingHint(F.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,I,this.domain),new M.LineSnappingHint(F.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,I,this.domain),new h.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,I,this.domain)]}}]);return y}(w.SnappingCandidate);const L=O.create();g.RightAngleTriangleSnappingCandidate=w;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(g,u,f,O,l,C,F,w,M,h){f=function(L){function Q(y){y=L.call(this,y)||this;y.enabled=!1;y.enabledToggled=!1;y.selfEnabled=!0;y.featureEnabled=!0;y.featureSources=new O;y.distance=h.defaults.distance;y.touchSensitivityMultiplier=h.defaults.touchSensitivityMultiplier;return y}g._inheritsLoose(Q,L);g._createClass(Q,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return Q}(f);u.__decorate([l.property()],f.prototype,"enabled",void 0);u.__decorate([l.property()],f.prototype,"enabledToggled",void 0);u.__decorate([l.property()],f.prototype,"selfEnabled",void 0);u.__decorate([l.property()],f.prototype,"featureEnabled",void 0);u.__decorate([l.property({type:O.ofType(M)})],f.prototype,"featureSources",void 0);u.__decorate([l.property()],f.prototype,"distance",void 0);
u.__decorate([l.property()],f.prototype,"touchSensitivityMultiplier",void 0);u.__decorate([l.property({readOnly:!0})],f.prototype,"effectiveEnabled",null);u.__decorate([l.property({readOnly:!0})],f.prototype,"effectiveSelfEnabled",null);u.__decorate([l.property({readOnly:!0})],f.prototype,"effectiveFeatureEnabled",null);return f=u.__decorate([w.subclass("esri.views.interactive.snapping.SnappingOptions")],f)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),
function(g,u,f,O,l,C){l=function(F){function w(M,h,L,Q,y){M=F.call(this,M,h,new f.IntersectionConstraint(M,h,L.constraint,Q.constraint),y,O.SnappingDomain.ALL)||this;M.first=L;M.second=Q;return M}u._inheritsLoose(w,F);u._createClass(w,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new C.IntersectionSnappingHint(this.targetPoint,this.elevationInfo,this.domain)]}}]);return w}(l.SnappingCandidate);
g.IntersectionSnappingCandidate=l;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","../snappingUtils","./SnappingHint"],function(g,u,f,O,l){l=function(C){function F(w,M,h=f.SnappingDomain.ALL){M=C.call(this,M,h)||this;M.intersectionPoint=w;return M}u._inheritsLoose(F,C);F.prototype.equals=function(w){return w instanceof
F?O.objectEqual(this.intersectionPoint,w.intersectionPoint):!1};return F}(l.SnappingHint);g.IntersectionSnappingHint=l;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,u,f,O,l,C,F,w,M){g.OperationHandle=function(h){function L(y){y=h.call(this,y)||this;y.cancelled=!1;y.history={undo:[],redo:[]};y.type=null;return y}u._inheritsLoose(L,h);var Q=L.prototype;Q.addToHistory=function(y){this.history.redo=[];this.history.undo.push(y)};Q.resetHistory=function(){this.history.redo=[];this.history.undo=[]};Q.canUndo=function(){return 0<this.history.undo.length};Q.canRedo=function(){return 0<this.history.redo.length};Q.complete=function(){this._reset();this.onEnd();
this.emit("complete")};Q.cancel=function(){this.cancelled=!0;this.complete()};Q._reset=function(){this.activeComponent.reset()};Q.refreshComponent=function(){const y=this.activeComponent;y&&("box"!==y.type&&"reshape"!==y.type&&"graphic-mover"!==y.type||y.refresh())};u._createClass(L,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:O.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(y){this._set("undo",()=>{this.canUndo()&&y()})}},{key:"redo",set:function(y){this._set("redo",()=>{this.canRedo()&&y()})}}]);return L}(l.EventedAccessor);f.__decorate([C.property()],g.OperationHandle.prototype,"activeComponent",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"cancelled",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,
"history",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"tool",null);f.__decorate([C.property()],g.OperationHandle.prototype,"type",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"canUndo",null);f.__decorate([C.property()],g.OperationHandle.prototype,"canRedo",null);f.__decorate([C.property()],g.OperationHandle.prototype,"onEnd",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"undo",null);f.__decorate([C.property()],g.OperationHandle.prototype,"redo",
null);f.__decorate([C.property()],g.OperationHandle.prototype,"toggleTool",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"addToSelection",void 0);f.__decorate([C.property()],g.OperationHandle.prototype,"removeFromSelection",void 0);g.OperationHandle=f.__decorate([M.subclass("esri.widgets.Sketch.support.OperationHandle")],g.OperationHandle);g.CreateOperationHandle=function(h){function L(){return h.apply(this,arguments)||this}u._inheritsLoose(L,h);return L}(g.OperationHandle);f.__decorate([C.property()],
g.CreateOperationHandle.prototype,"activeComponent",void 0);g.CreateOperationHandle=f.__decorate([M.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],g.CreateOperationHandle);g.UpdateOperationHandle=function(h){function L(){return h.apply(this,arguments)||this}u._inheritsLoose(L,h);return L}(g.OperationHandle);f.__decorate([C.property()],g.UpdateOperationHandle.prototype,"activeComponent",void 0);g.UpdateOperationHandle=f.__decorate([M.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
g.UpdateOperationHandle);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){const S={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};F=function(R){function D(J,A){var P=R.call;const {view:e,viewModel:c,snappingOptions:b,...r}=J;A=P.call(R,this,r,A)||this;A._layerListFilter=null;A.messages=null;A.messagesCommon=null;A.visibleElements={...S};A._defaultViewModel=null;J?.viewModel?A.viewModel=J.viewModel:(A._defaultViewModel=new I({snappingOptions:J.snappingOptions,view:J.view}),A.viewModel=A._defaultViewModel);
return A}u._inheritsLoose(D,R);var E=D.prototype;E.destroy=function(){this._defaultViewModel=O.destroyMaybe(this._defaultViewModel)};E.loadDependencies=function(){return Promise.all([new Promise((J,A)=>g(["../../chunks/calcite-accordion"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-accordion-item"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-block"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-checkbox"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-input"],J,A)),new Promise((J,
A)=>g(["../../chunks/calcite-label"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-list"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-list-item"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-panel"],J,A)),new Promise((J,A)=>g(["../../chunks/calcite-switch"],J,A))])};E.castVisibleElements=function(J){return{...S,...J}};E.render=function(){const {label:J,visibleElements:{header:A}}=this;return y.tsx("div",{"aria-label":J,class:this.classes("esri-snapping-controls","esri-widget")},y.tsx("div",
{class:"esri-snapping-controls__container"},A?this.renderHeaderView():this.renderContent()))};E.renderHeaderView=function(){return y.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};E.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};E.renderToggles=function(){const {visibleElements:{enabledToggle:J,selfEnabledToggle:A,featureEnabledToggle:P}}=this;if(J||A||P)return y.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",
key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),y.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))};E.renderEnabledToggle=function(){if(this.visibleElements.enabledToggle){var {messages:{enableSnapping:J},viewModel:{snappingOptions:{enabled:A,enabledToggled:P}}}=this;return y.tsx("calcite-label",{layout:"inline-space-between"},J,y.tsx("calcite-switch",{checked:A,disabled:P,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}};
E.renderSelfEnabledToggle=function(){if(this.visibleElements.selfEnabledToggle){var {messages:{geometryGuides:J},viewModel:{snappingOptions:{enabled:A,selfEnabled:P,enabledToggled:e}}}=this;return y.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},J,y.tsx("calcite-switch",{checked:P,disabled:e||!A,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}};E.renderFeatureEnabledToggle=function(){if(this.visibleElements.featureEnabledToggle){var {messages:{featureToFeature:J},
viewModel:{snappingOptions:{enabled:A,featureEnabled:P,enabledToggled:e}}}=this;return y.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},J,y.tsx("calcite-switch",{checked:P,disabled:e||!A,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}};E.renderLayerList=function(){if(this.visibleElements.layerList){var {messages:J,messagesCommon:A}=this,P=({target:{value:e}})=>this._layerListFilter=""===e?null:new RegExp(e,"i");P=9<this.viewModel.layerListViewModel.operationalItems.length?
y.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:J?.searchLayers,onCalciteInputInput:P}):null;return y.tsx("calcite-block",{key:"list-block","intl-collapse":A?.collapse,"intl-expand":A?.expand,heading:J.snappingLayers,class:"esri-snapping-controls__layer-list-block",open:!0,collapsible:!0},P,y.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,O.unwrap(this._layerListFilter))))}};
E.renderLayerListItemCollection=function(J,A){return J.map(P=>{if(A?this._itemTitleMatchesFilter(P,A):1)return 0<P.children.length?this.renderLayerListItemGroup(P):this.renderLayerListItem(P);const e=P.children.filter(c=>this._itemTitleMatchesFilter(c,A));return 0<e.length?this.renderLayerListItemGroup(P,e):null}).toArray()};E.renderLayerListItem=function(J){var {messages:{untitledLayer:A}}=this;A=J.title||A;const P=y.tsx("calcite-checkbox",{value:J.layer.id,checked:J.enabled,bind:this,onCalciteCheckboxChange:e=>
this._handleLayerListItemChange(e.target)});return y.tsx("calcite-list-item",{key:`${this.id}-list-item-${J.uid}`,onclick:()=>{this._handleLayerListItemChange({checked:!P.properties.checked,value:P.properties.value})}},y.tsx("calcite-label",{class:"esri-snapping-controls__layer-list__item",slot:"content-start",tabIndex:-1,layout:"inline","disable-spacing":"true"},y.tsx("div",{class:"esri-snapping-controls__layer-list__item__checkbox"},P),y.tsx("div",{class:"esri-snapping-controls__layer-list__item__label"},
A)))};E.renderLayerListItemGroup=function(J,A){const P=J.title||this.messages.untitledLayer,e=J.title&&""!==J.title?J.title:l.generateUID();return y.tsx("calcite-list-item",{key:e},y.tsx("calcite-accordion",{"icon-position":"start",appearance:"transparent",afterCreate:c=>{c.append(...Array.from(c.children).map(b=>{b.remove();return b}))}},y.tsx("calcite-accordion-item",{active:!!A,"item-title":P,key:J.uid},y.tsx("calcite-list",null,[...this.renderLayerListItemCollection(A??J.children)]))))};E._enableSnappingSwitchChange=
function(J){this.snappingOptions.enabled=J.target.checked};E._featureEnabledSwitchChange=function(J){this.snappingOptions.featureEnabled=J.target.checked};E._itemTitleMatchesFilter=function(J,A){return A.test(J.title)};E._selfEnabledSwitchChange=function(J){this.snappingOptions.selfEnabled=J.target.checked};E._handleLayerListItemChange=function(){var J=u._asyncToGenerator(function*(A){A.checked?this.viewModel.enableSnappingForLayer(A.value):this.viewModel.disableSnappingForLayer(A.value)});return function(A){return J.apply(this,
arguments)}}();u._createClass(D,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(J){this._overrideIfSome("label",J)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(J){this.viewModel.snappingOptions=J}},{key:"view",get:function(){return this.viewModel.view},set:function(J){this.viewModel.view=J}},{key:"viewModel",set:function(J){if(J!==this._get("viewModel")){if(O.isNone(this._defaultViewModel)||this._defaultViewModel!==J)this._defaultViewModel=
O.destroyMaybe(this._defaultViewModel);this._set("viewModel",J)}}}]);return D}(h);f.__decorate([C.property()],F.prototype,"_layerListFilter",void 0);f.__decorate([C.property()],F.prototype,"label",null);f.__decorate([C.property(),Q.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],F.prototype,"messages",void 0);f.__decorate([C.property(),Q.messageBundle("esri/t9n/common")],F.prototype,"messagesCommon",void 0);f.__decorate([C.property()],F.prototype,"snappingOptions",null);
f.__decorate([C.property()],F.prototype,"view",null);f.__decorate([C.property()],F.prototype,"viewModel",null);f.__decorate([C.property()],F.prototype,"visibleElements",void 0);f.__decorate([w.cast("visibleElements")],F.prototype,"castVisibleElements",null);return F=f.__decorate([M.subclass("esri.widgets.support.SnappingControls")],F)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y){f=function(I){function S(D){D=I.call(this,D)||this;D.layerListViewModel=new y.SnappingLayerListViewModel;D.snappingOptions=null;D.view=null;return D}g._inheritsLoose(S,I);var R=S.prototype;R.initialize=function(){this.handles.add([C.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:D,view:E})=>{D.view=E},C.initial),C.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:D,sources:E})=>{D.featureSnappingSources=
E},C.initial)])};R.enableSnappingForLayer=function(D){(this._findSnappingSourceForLayer(D)??this._makeSnappingSourceForLayer(D)).enabled=!0};R.disableSnappingForLayer=function(D){if(D=this._findSnappingSourceForLayer(D))D.enabled=!1};R.updateEnabledFeatureSources=function(D){for(const E of this.snappingOptions.featureSources)Q.canDisplayLayer(E.layer)&&(E.enabled=D.includes(E.layer.id))};R._findSnappingSourceForLayer=function(D){return this.snappingOptions.featureSources.find(E=>E.layer.id===D)};
R._makeSnappingSourceForLayer=function(D){var {layer:E}=this.layerListViewModel.operationalItemsFlat.find(J=>J.layer.id===D);if(!E)throw new O("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${D} because no such layer was found in the view`);E=new L({layer:E});this.snappingOptions.featureSources.add(E);return E};g._createClass(S,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return S}(l.HandleOwnerMixin(f));u.__decorate([F.property({constructOnly:!0})],
f.prototype,"layerListViewModel",void 0);u.__decorate([F.property({constructOnly:!0})],f.prototype,"snappingOptions",void 0);u.__decorate([F.property()],f.prototype,"state",null);u.__decorate([F.property({constructOnly:!0})],f.prototype,"view",void 0);return f=u.__decorate([h.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],f)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(g){function u(M){if(M)return null!=M.listMode?M.listMode:
void 0}function f(M){if(M)return null!=M.minScale?M.minScale:void 0}function O(M){if(M)return null!=M.maxScale?M.maxScale:void 0}function l(M){if(M){if(!("type"in M))return"sublayers";if(M.listMode!==w.hideChildren&&"wmts"!==M.type)switch(M.type){case "group":return"layers";default:return"sublayers"}}}function C(M,h){M&&M.sort((L,Q)=>{L=h.indexOf(L.uid);Q=h.indexOf(Q.uid);return L>Q?-1:L<Q?1:0})}function F(M){return!!M?.layer}const w={hide:"hide",hideChildren:"hide-children"};g.canDisplayLayer=function(M){return u(M)!==
w.hide};g.canSortSublayers=function(M){M=M&&(M.get("layer.layer")||M.layer);if(!M)return!1;M=M.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof M?M:!0};g.findLayerListMode=u;g.findLayerMaxScale=O;g.findLayerMinScale=f;g.findLayerVisibilityMode=function(M){if(!M)return"inherited";var h=M.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof h)return h?"independent":"inherited";h=M.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===
typeof h?h?"independent":"inherited":null!=M.visibilityMode?M.visibilityMode:"independent"};g.findSelectedItem=function(M,h){const L=M.layer?.uid;return L&&h.find(Q=>Q.layer?.uid===L)};g.getItemLayers=function(M){return(M=M?.layer)&&"group"===M.type?M.layers:null};g.getLegendLayerInfo=function(M){var h=F(M)?M:null;const L=M?.parent;return(h="map-image"===L?.type&&h.source)&&L?{layer:L,title:"",sublayerIds:[h.mapLayerId]}:{layer:M,title:""}};g.getNormalizedChildLayerProperty=l;g.isLayerOutsideScaleRange=
function(M,h){if(!M||isNaN(h))return!1;var L=f(M);M=O(M);L=!isNaN(L)&&0<L&&h>L;h=!isNaN(M)&&0<M&&h<M;return L||h};g.isSublayer=F;g.sortChildLayersToIds=function(M,h){if(M=M?.layer){var L=l(M);L&&(M=M.get(L),C(M,h))}};g.sortLayersToIds=C;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L){g.SnappingLayerListViewModel=function(Q){function y(){var S=Q.apply(this,arguments)||this;S.featureSnappingSources=new O;return S}u._inheritsLoose(y,Q);var I=y.prototype;I._compileList=function(){var S=this.get("view.map.layers");S&&(S=S.filter(h.isValidSnappingLayer),this._watchLayersListMode(S),(S=this._getViewableLayers(S))&&S.length?(this._createNewItems(S),this._removeItems(S),this._sortItems(S)):this._removeAllItems())};I._createListItem=function(S){return new L.SnappingListItem({layer:S,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};u._createClass(y,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(S=>S.children)}}]);return y}(M);f.__decorate([l.property()],g.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);f.__decorate([l.property()],g.SnappingLayerListViewModel.prototype,"operationalItems",void 0);g.SnappingLayerListViewModel=f.__decorate([w.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
g.SnappingLayerListViewModel);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q){const y=f.ofType(L);f=function(I){function S(D){D=I.call(this,D)||this;D._handles=new l;D.checkPublishStatusEnabled=!1;D.listItemCreatedFunction=null;D.operationalItems=new y;D.view=null;return D}g._inheritsLoose(S,I);var R=S.prototype;R.initialize=function(){this._handles.add([C.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),C.initial),C.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};R.destroy=
function(){this._handles.destroy();this.view=this._handles=null;this.operationalItems.removeAll()};R.triggerAction=function(D,E){D&&!D.disabled&&this.emit("trigger-action",{action:D,item:E})};R.moveListItem=function(D,E,J,A){const P=D?.layer;if(P){var e=this.view?.map?.layers,c=E?Q.getItemLayers(E):e;e=J?Q.getItemLayers(J):e;if(c&&e){var {operationalItems:b}=this;E=E?.children||b;b=J?.children||b;A=e.length-A;D.parent=J||null;E.includes(D)&&E.remove(D);c.includes(P)&&c.remove(P);b.includes(D)||b.add(D,
A);e.includes(P)||e.add(P,A)}}};R._createLayerViewHandles=function(D){const {_handles:E}=this;E.remove("layer-views");this._compileList();D&&E.add(D.on("change",()=>this._compileList()),"layer-views")};R._createMapLayerHandles=function(D){const {_handles:E}=this;E.remove("map-layers");this._compileList();D&&E.add(D.on("change",()=>this._compileList()),"map-layers")};R._createListItem=function(D){const {view:E,listItemCreatedFunction:J,checkPublishStatusEnabled:A}=this;return new L({checkPublishStatusEnabled:A,
layer:D,listItemCreatedFunction:J,view:E})};R._removeAllItems=function(){const {_handles:D,operationalItems:E}=this;E.forEach(J=>{D.remove(`${"children"}-${J.uid}`)});E.removeAll()};R._getViewableLayers=function(D){if(D)return D.filter(E=>"hide"!==Q.findLayerListMode(E))};R._watchLayersListMode=function(D){const {_handles:E}=this;E.remove("layer-list-mode");D&&D.forEach(J=>{"listMode"in J&&E.add(C.watch(()=>J.listMode,()=>this._compileList()),"layer-list-mode")})};R._compileList=function(){var D=
this.get("view.map.layers");this._watchLayersListMode(D);(D=this._getViewableLayers(D))&&D.length?(this._createNewItems(D),this._removeItems(D),this._sortItems(D)):this._removeAllItems()};R._createNewItems=function(D){const {operationalItems:E}=this;D.forEach(J=>{E.find(A=>A.layer===J)||E.add(this._createListItem(J))})};R._removeItems=function(D){const {_handles:E,operationalItems:J}=this,A=[];J.forEach(P=>{P&&D&&D.includes(P.layer)||(E.remove(`${"children"}-${P.uid}`),A.push(P))});J.removeMany(A)};
R._sortItems=function(D){const {operationalItems:E}=this;E.sort((J,A)=>{J=D.indexOf(J.layer);A=D.indexOf(A.layer);return J>A?-1:J<A?1:0})};R._recompileList=function(){this._removeAllItems();this._compileList()};R._viewHandles=function(){const {_handles:D,view:E}=this;D.remove(["map-layers","layer-views","view-layers"]);this._compileList();E&&E.ready&&D.add([C.watch(()=>this.view?.map?.allLayers,J=>this._createMapLayerHandles(J),C.initial),C.watch(()=>this.view?.allLayerViews,J=>this._createLayerViewHandles(J),
C.initial)],"view-layers")};g._createClass(S,[{key:"state",get:function(){const D=this.get("view");return this.get("view.ready")?"ready":D?"loading":"disabled"}}]);return S}(O.EventedAccessor);u.__decorate([F.property()],f.prototype,"checkPublishStatusEnabled",void 0);u.__decorate([F.property()],f.prototype,"listItemCreatedFunction",void 0);u.__decorate([F.property({type:y})],f.prototype,"operationalItems",void 0);u.__decorate([F.property({readOnly:!0})],f.prototype,"state",null);u.__decorate([F.property()],
f.prototype,"view",void 0);return f=u.__decorate([h.subclass("esri.widgets.LayerList.LayerListViewModel")],f)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D){var E;M=O.ofType({key:"type",defaultKeyValue:"button",base:Q,typeMap:{button:y,toggle:S,slider:I}});const J=O.ofType(M);f=E=function(A){function P(c){c=A.call(this,c)||this;c.actionsSections=new J;c.actionsOpen=!1;c.checkPublishStatusEnabled=!1;c.children=new (O.ofType(E));c.childrenSortable=!0;c.hidden=!1;c.layer=null;c.layerView=null;c.listItemCreatedFunction=null;c.open=!1;c.panel=null;c.parent=null;c.sortable=!0;c.view=null;return c}g._inheritsLoose(P,
A);var e=P.prototype;e.initialize=function(){this.handles.add([F.watch(()=>this.layer,c=>this._watchLayerProperties(c),F.initial),F.watch(()=>this.checkPublishStatusEnabled,c=>this._updateChildrenPublishing(c),F.initial),F.watch(()=>this.view,c=>this._updateChildrenView(c),F.initial),F.watch(()=>this.panel,c=>this._setListItemOnPanel(c),F.initial),F.watch(()=>[this.layer,this.view],()=>this._getLayerView(),F.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};e.destroy=function(){this.view=null};e.castPanel=function(c){this.get("panel.open")&&!c.hasOwnProperty("open")&&(c.open=!0);return c?new R(c):null};e.clone=function(){return new E({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
e._setListItemOnPanel=function(c){c&&(c.listItem=this)};e._updateChildrenPublishing=function(c){const b=this.children;b&&b.forEach(r=>r.checkPublishStatusEnabled=c)};e._updateChildrenView=function(c){const b=this.children;b&&b.forEach(r=>r.view=c)};e._addChildren=function(c){this.handles.remove("child-list-mode");this.children.removeAll();if(c){c.forEach(r=>{this.handles.add(F.watch(()=>r.listMode,()=>this._addChildren(c)),"child-list-mode")});var b=c.filter(r=>"hide"!==D.findLayerListMode(r));this.children.addMany(this._makeChildren(b))}};
e._watchSublayerChanges=function(c){c&&this.handles.add(c.on("change",()=>{this._addChildren(c)}),"layer")};e._initializeChildLayers=function(c){this._addChildren(c);this._watchSublayerChanges(c)};e._makeChildren=function(c){return c.map(b=>D.canDisplayLayer(b)?new E({layer:b,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).reverse()};e._watchLayerProperties=function(c){if(this.handles&&(this.handles.remove("layer"),
this.handles.remove("child-list-mode"),c))if(this.handles.add(F.watch(()=>c.listMode,()=>this._watchLayerProperties(c)),"layer"),"hide-children"===D.findLayerListMode(c))this.children.removeAll();else{var b=D.getNormalizedChildLayerProperty(c);b&&this.handles.add(F.watch(()=>c[b],()=>{c.hasOwnProperty(b)&&this._initializeChildLayers(c[b])},F.initial),"layer")}};e._getLayerView=function(){var c=g._asyncToGenerator(function*(){const {layer:b,view:r}=this;if(b&&r)try{const H=yield r.whenLayerView(b);
H.layer===this.layer&&this._set("layerView",H)}catch{}});return function(){return c.apply(this,arguments)}}();g._createClass(P,[{key:"connectionStatus",get:function(){const {layerView:c,publishing:b}=this;if(!b&&c&&"connectionStatus"in c)return c.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:c}=this;return c&&"spatialReferenceSupported"in c?!c.spatialReferenceSupported:!1}},{key:"title",get:function(){const c=this.get("layer.layer");
return(!c||c&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(c){this._override("title",c)}},{key:"publishing",get:function(){const {layer:c,checkPublishStatusEnabled:b}=this;return b&&c&&"publishingInfo"in c&&"publishing"===c.publishingInfo.status}},{key:"updating",get:function(){const {layerView:c,connectionStatus:b,layer:r,publishing:H}=this;return H||b?!1:c?c.updating:"loading"===r?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},
set:function(c){const b=this.layer;b&&(b.visible=c)}},{key:"visibleAtCurrentScale",get:function(){return!D.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return D.findLayerVisibilityMode(this.layer)}}]);return P}(C.IdentifiableMixin(l.HandleOwnerMixin(f)));u.__decorate([w.property({type:J})],f.prototype,"actionsSections",void 0);u.__decorate([w.property()],f.prototype,"actionsOpen",void 0);u.__decorate([w.property()],f.prototype,"checkPublishStatusEnabled",
void 0);u.__decorate([w.property({type:O})],f.prototype,"children",void 0);u.__decorate([w.property()],f.prototype,"childrenSortable",void 0);u.__decorate([w.property({readOnly:!0})],f.prototype,"connectionStatus",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"error",null);u.__decorate([w.property()],f.prototype,"hidden",void 0);u.__decorate([w.property({readOnly:!0})],f.prototype,"incompatible",null);u.__decorate([w.property()],f.prototype,"layer",void 0);u.__decorate([w.property({readOnly:!0})],
f.prototype,"layerView",void 0);u.__decorate([w.property()],f.prototype,"listItemCreatedFunction",void 0);u.__decorate([w.property()],f.prototype,"open",void 0);u.__decorate([w.property({type:R})],f.prototype,"panel",void 0);u.__decorate([h.cast("panel")],f.prototype,"castPanel",null);u.__decorate([w.property()],f.prototype,"parent",void 0);u.__decorate([w.property()],f.prototype,"sortable",void 0);u.__decorate([w.property()],f.prototype,"title",null);u.__decorate([w.property({readOnly:!0})],f.prototype,
"publishing",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"updating",null);u.__decorate([w.property()],f.prototype,"view",void 0);u.__decorate([w.property()],f.prototype,"visible",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"visibleAtCurrentScale",null);u.__decorate([w.property({readOnly:!0})],f.prototype,"visibilityMode",null);return f=E=u.__decorate([L.subclass("esri.widgets.LayerList.ListItem")],f)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(g,u,f,O,l,C,F){var w;O=w=function(M){function h(L){L=M.call(this,L)||this;L.displayValueEnabled=!1;L.max=1;L.min=0;L.step=.1;L.type="slider";L.value=null;return L}g._inheritsLoose(h,M);h.prototype.clone=function(){return new w({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return h}(F);u.__decorate([f.property()],
O.prototype,"displayValueEnabled",void 0);u.__decorate([f.property()],O.prototype,"max",void 0);u.__decorate([f.property()],O.prototype,"min",void 0);u.__decorate([f.property()],O.prototype,"step",void 0);u.__decorate([f.property()],O.prototype,"value",void 0);return O=w=u.__decorate([C.subclass("esri.support.Action.ActionSlider")],O)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q,y,I){l=function(S){function R(E,J){E=S.call(this,E,J)||this;E._legend=null;E._handles=new O;E.content=null;E.image=null;E.listItem=null;E.open=!1;E.visible=!0;return E}u._inheritsLoose(R,S);var D=R.prototype;D.initialize=function(){this.addHandles(C.watch(()=>this.content,E=>this._createLegend(E),C.initial))};D.destroy=function(){const {_legend:E}=this;E&&E.destroy();this._legend=null};D.render=function(){return I.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};
D._renderContent=function(E){const {_legend:J,disabled:A}=this;return!E||A?null:"legend"===E&&J?I.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:J},J.render()):"string"===typeof E?I.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:E,innerHTML:E}):y.isWidget(E)?I.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:E},E.render()):
E instanceof HTMLElement?I.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:E,bind:E,afterCreate:this._attachToNode}):null};D._renderContents=function(){const {content:E}=this;return Array.isArray(E)?E.map(J=>this._renderContent(J)):this._renderContent(E)};D._getLegendOptions=function(){const {listItem:E}=this;if(!E)return{};const {layer:J,view:A}=E;return J&&A?{view:A,layerInfos:[Q.getLegendLayerInfo(J)]}:{}};D._createLegend=function(E){this._hasLegend(E)&&
!this._legend&&(new Promise((J,A)=>g(["../Legend"],P=>J(Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}))),A))).then(({default:J})=>{const {_handles:A,listItem:P}=this,e=new J(this._getLegendOptions());this._legend=e;this.notifyChange("className");this.notifyChange("title");J=C.watch(()=>[P?.view,P?.layer,P?.layer?.source,P?.layer?.parent],()=>this._updateLegend(e),C.initial);A.add(J,"legends");this.scheduleRender()})};D._hasLegend=function(E){return"legend"===
E?!0:Array.isArray(E)?E.includes("legend"):!1};D._attachToNode=function(E){E.appendChild(this)};D._updateLegend=function(E){E.set(this._getLegendOptions());this.scheduleRender()};D._getWidget=function(E){return"legend"===E?this._legend:y.isWidget(E)?E:null};D._getFirstWidget=function(){const {content:E}=this;if(Array.isArray(E)){let J=null;E.some(A=>{(A=this._getWidget(A))&&(J=A);return!!A});return J}return this._getWidget(E)};u._createClass(R,[{key:"className",get:function(){const {image:E}=this,
J=this._getFirstWidget();return this._get("className")||!E&&J?J.iconClass:""},set:function(E){this._override("className",E)}},{key:"disabled",get:function(){const {listItem:E,_legend:J,content:A}=this;return E?Array.isArray(A)&&1<A.length?!1:J?!J.activeLayerInfos?.length||!E.visibleAtCurrentScale:!1:!0},set:function(E){this._overrideIfSome("disabled",E)}},{key:"title",get:function(){const E=this._getFirstWidget();return this._get("title")||E?E.label:""},set:function(E){this._override("title",E)}}]);
return R}(l.IdentifiableMixin(L));f.__decorate([F.property()],l.prototype,"_legend",void 0);f.__decorate([F.property()],l.prototype,"className",null);f.__decorate([F.property()],l.prototype,"content",void 0);f.__decorate([F.property()],l.prototype,"disabled",null);f.__decorate([F.property()],l.prototype,"image",void 0);f.__decorate([F.property()],l.prototype,"listItem",void 0);f.__decorate([F.property()],l.prototype,"title",null);f.__decorate([F.property()],l.prototype,"open",void 0);f.__decorate([F.property()],
l.prototype,"visible",void 0);return l=f.__decorate([h.subclass("esri.widgets.LayerList.ListItemPanel")],l)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(g,u,f){const O=F=>l(F)||C(F),l=F=>{if(!("type"in F))return!1;switch(F.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},C=F=>{const w=f.getNormalizedChildLayerProperty(F);if(F.hasOwnProperty(w)&&u.isSome(F[w]))for(const M of F[w])if(O(M))return!0;return!1};g.isValidSnappingLayer=O;g.isValidSnappingLayerGroup=C;g.isValidSnappingLayerSource=l;Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(g,u,f,O,l,C,F,w,M,h,L,Q){var y;g.SnappingListItem=y=function(I){function S(D){D=I.call(this,D)||this;D.children=new O;return D}u._inheritsLoose(S,I);var R=S.prototype;R._initializeChildLayers=function(D){D&&(D=D.filter(Q.isValidSnappingLayer),I.prototype._initializeChildLayers.call(this,D))};R._makeChildren=function(D){return D.map(E=>L.canDisplayLayer(E)?new y({layer:E,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).reverse()};u._createClass(S,
[{key:"enabled",get:function(){return l.isSome(this.featureSource)?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:D,getFeatureSnappingSources:E}=this;return E().find(J=>J.layer===D)}}]);return S}(h);f.__decorate([C.property()],g.SnappingListItem.prototype,"children",void 0);f.__decorate([C.property()],g.SnappingListItem.prototype,"enabled",null);f.__decorate([C.property({constructOnly:!0})],g.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);f.__decorate([C.property()],
g.SnappingListItem.prototype,"featureSource",null);f.__decorate([C.property()],g.SnappingListItem.prototype,"parent",void 0);g.SnappingListItem=y=f.__decorate([M.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],g.SnappingListItem);Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/HandleOwner ../core/Logger ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/deprecationUtils ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/Heading ./support/SnappingControls ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ../intl/substitute".split(" "),function(g,
u,f,O,l,C,F,w,M,h,L,Q,y,I,S,R,D,E,J,A,P,e,c,b,r,H,d,p,z){function m(q){q.focus()}const k={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}},B=C.getLogger("esri.widgets.Editor");O=function(q){function T(x,G){var K=q.call(this,x,G)||this;K._candidateCommitted=!1;K._featureForm=new S;K._stateStack=[];K._attachments=new I({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,
errorMessage:!1,progressBar:!1,updateButton:!1}});K._featureTemplates=new R({enableListScroll:!1});K._filterText="";K._prompt=null;K._spinner=new D;K._snappingButton=null;K._snappingPopover=null;K.useDeprecatedCreateWorkflow=!1;K.headingLevel=4;K.iconClass="esri-icon-edit";K.messages=null;K.messagesCommon=null;K.messagesTemplates=null;K.supportingWidgetDefaults=null;K.viewModel=new A;K.visibleElements={...k};K._setCandidateFeature=(U,Y=!1)=>{if(!K._candidateCommitted){var ba=K._assertActiveUpdateWorkflow();
ba.data.edits.feature=U;Y&&(ba.next(),K._candidateCommitted=!0)}};K._handleSave=K._handleSave.bind(u._assertThisInitialized(K));K._handleBack=K._handleBack.bind(u._assertThisInitialized(K));K._handleDone=K._handleDone.bind(u._assertThisInitialized(K));K._handleDelete=K._handleDelete.bind(u._assertThisInitialized(K));K._handleAdd=K._handleAdd.bind(u._assertThisInitialized(K));K._handleEdit=K._handleEdit.bind(u._assertThisInitialized(K));K._handleAttachmentAdd=K._handleAttachmentAdd.bind(u._assertThisInitialized(K));
K._handleAttachmentUpdate=K._handleAttachmentUpdate.bind(u._assertThisInitialized(K));K._handleAttachmentDelete=K._handleAttachmentDelete.bind(u._assertThisInitialized(K));K.EditorPanel=K.EditorPanel.bind(u._assertThisInitialized(K));return K}u._inheritsLoose(T,q);var n=T.prototype;n.initialize=function(){const {view:x,snappingOptions:G}=this;this._snappingControls=new c({snappingOptions:G,view:x,visibleElements:this.visibleElements.snappingControlsElements});this.addHandles([w.watch(()=>this.headingLevel,
K=>{this._featureForm.headingLevel=e.incrementHeadingLevel(K);this._featureTemplates.headingLevel=e.incrementHeadingLevel(K)},w.initial),this.viewModel.featureTemplatesViewModel.on("select",({item:K})=>this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(K):this.startCreateFeaturesWorkflowAtFeatureCreation(K)),w.watch(()=>this.viewModel.state,(K,U)=>{K=this._stateStack.indexOf(K);-1===K?this._stateStack.push(U):this._stateStack.splice(K)}),w.watch(()=>this.viewModel,K=>{this._featureForm.viewModel=
K?K.featureFormViewModel:null;this._attachments.viewModel=K?K.attachmentsViewModel:null;this._featureTemplates.viewModel=K?K.featureTemplatesViewModel:null;this._spinner.viewModel=K?K.spinnerViewModel:null},w.initial),w.watch(()=>this.view,(K,U)=>{const Y=`editor-${this.id}-spinner`;U&&U.ui.remove(this._spinner,Y);K&&K.ui.add(this._spinner,{key:Y,position:"manual"})},w.initial),w.on(()=>this.viewModel?.sketchViewModel,"create",()=>{this.scheduleRender()}),w.on(()=>this.viewModel?.activeWorkflow,"cancel-request",
({controller:K})=>{const {messages:U,messagesCommon:Y}=this;this._prompt={title:U.cancelRequestTitle,message:U.cancelRequestWarningMessage,context:"danger",actions:{primary:{label:Y.form.yes,action:()=>{K.allow();this._prompt=null}},secondary:{label:Y.form.no,action:()=>{K.deny();return this._prompt=null}}}};this.scheduleRender()}),w.watch(()=>this.supportingWidgetDefaults,K=>{K&&(this._featureForm.set(K.featureForm),this._attachments.set(K.attachments),this._featureTemplates.set(K.featureTemplates),
this.viewModel.sketchViewModel.set(K.sketch))},w.initial),w.watch(()=>this._attachments?.error,K=>{if(K){var {messages:U,messagesCommon:Y}=this;this._prompt={title:U.errorWarningTitle,message:K.message,context:"warning",actions:{primary:{label:Y.form.ok,action:()=>{this._prompt=null}}}}}}),w.watch(()=>this.viewModel?.failures,K=>{if(K){var {messages:U}=this,[{error:Y,retry:ba,cancel:la}]=K;this._prompt={title:U.errorWarningTitle,message:z.substitute(U.errorWarningMessageTemplate,{errorMessage:Y.message}),
context:"warning",actions:{primary:{label:U.retry,action:()=>{ba();this._prompt=null}},secondary:{label:U.ignore,action:()=>{la();return this._prompt=null}}}}}}),w.watch(()=>this.viewModel?.state,K=>{"awaiting-feature-to-update"===K&&(this._filterText="");"awaiting-update-feature-candidate"===K&&(this._candidateCommitted=!1);"editing-existing-feature"===K&&({activeWorkflow:K}=this.viewModel,this._featureForm.disabled="update"===K?.type&&!1===K?.data.editableItem.attributeUpdatesEnabled)}),w.watch(()=>
[this._attachments?.selectedFile,this._attachments?.submitting],()=>this.scheduleRender()),w.watch(()=>this.viewModel?.activeWorkflow,()=>this._featureForm.disabled=!1),w.when(()=>!this.viewModel?.activeWorkflow,()=>this._featureTemplates.filterText=""),w.on(()=>this.view,"key-down",K=>{"Escape"===K.key&&this.viewModel?.activeWorkflow&&this._handleBack()})])};n.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy();this._snappingControls.destroy()};
n.loadDependencies=function(){return Promise.all([new Promise((x,G)=>g(["../chunks/calcite-action"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-button"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-flow"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-icon"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-flow-item"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-popover"],x,G)),new Promise((x,G)=>g(["../chunks/calcite-scrim"],x,G))])};n.castVisibleElements=function(x){x={...k,...x,snappingControlsElements:{...k.snappingControlsElements,
...x?.snappingControlsElements}};F.isSome(this._snappingControls)&&(this._snappingControls.visibleElements=x.snappingControlsElements);return x};n.startCreateWorkflowAtFeatureTypeSelection=function(){J.workflowDeprecation(B,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};n.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()};
n.startCreateWorkflowAtFeatureCreation=function(x){J.workflowDeprecation(B,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");return this.viewModel.startCreateWorkflowAtFeatureCreation(x)};n.startCreateFeaturesWorkflowAtFeatureCreation=function(x){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(x)};n.startCreateWorkflowAtFeatureEdit=function(x){J.workflowDeprecation(B,"startCreateWorkflowAtFeatureEdit");return this.viewModel.startCreateWorkflowAtFeatureEdit(x)};
n.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};n.startUpdateWorkflowAtMultipleFeatureSelection=function(x){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(x)};n.startUpdateWorkflowAtFeatureEdit=function(x){return this.viewModel.startUpdateWorkflowAtFeatureEdit(x)};n.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};n.cancelWorkflow=function(x){return this.viewModel.cancelWorkflow(x)};
n.render=function(){const {_attachments:x,_prompt:G,viewModel:K}=this;if(!K)return d.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"});const {state:U}=K,Y=F.isSome(G)?d.tsx("calcite-scrim",null,this.renderPrompt(G)):null;return d.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"},K.syncing||x.submitting?this.renderProgressBar():null,d.tsx("calcite-flow",null,this._stateStack.map(ba=>this.renderState(ba)),this.renderState(U)),Y)};n.renderState=function(x){switch(x){case "ready":return this.renderLanding(x);
case "awaiting-feature-creation-info":return this.renderTemplates(x);case "creating-features":case "editing-new-feature":case "editing-existing-feature":return this.renderAttributeEditing(x);case "awaiting-feature-to-update":return this.renderFeatureUpdating(x);case "awaiting-update-feature-candidate":return this.renderFeatureList(x);case "awaiting-feature-to-create":return this.renderFeatureCreation(x);case "adding-attachment":return this.renderAttachmentAdding(x);case "editing-attachment":return this.renderAttachmentEditing(x)}return d.tsx("div",
null)};n.isPanelActive=function(x){return this.viewModel.state===x};n.renderTemplates=function(x){const {EditorPanel:G,headingLevel:K,messages:U,messagesCommon:Y,_handleBack:ba,_snappingControls:la,viewModel:{sketchViewModel:pa}}=this;return d.tsx(G,{active:this.isPanelActive(x),key:"templates-panel",handleBack:ba,heading:U.selectTemplate,headingLevel:K,messages:U,messagesCommon:Y,sketchViewModel:pa,snappingControls:la},d.tsx("div",{class:"esri-editor__panel-content"},this._featureTemplates.render()))};
n.renderAttributeEditing=function(x){const {activeWorkflow:G,EditorPanel:K,messages:U,messagesCommon:Y,headingLevel:ba,_handleBack:la,_snappingControls:pa,viewModel:va}=this,{sketchViewModel:xa}=va;var Aa=va.featureFormViewModel;if("create-features"===G.type&&1>G.pendingFeatures.length)return this.renderFeatureCreation(x);var Ga="update"===G.type&&!G.data.edits.modified||va.syncing||Aa.updating;const Da="update"===G.type?U.editFeature:U.createFeatures,da="update"===G.type?Y.update:Y.create,ja="create-features"===
G.type&&"create-new"===G.createFeatureState,ha="update"===G.type&&G.data.editableItem.supports.includes("delete"),Z=this._shouldShowAttachmentsForWorkflow(G);Ga=[{label:"create-features"===G.type&&1<G.numPendingFeatures?z.substitute(U.createFeaturesTemplate,{numFeatures:G.numPendingFeatures}):da,type:"primary",disabled:Ga,clickHandler:this._handleSave,width:ha?"half":"full"}];ha&&Ga.push({label:Y.delete,type:"tertiary",clickHandler:this._handleDelete,disabled:va.syncing,appearance:"outline",width:"half"});
Aa=Aa.inputFields.every(ca=>!ca.visible)&&!Z?this.renderMessage(z.substitute(U.clickToFinishTemplate,{button:da})):d.tsx("div",{class:"esri-editor__panel-content__section"},d.tsx("div",{class:"esri-editor__panel-content__section__group"},this._featureForm.render(),Z?d.tsx("div",{key:"attachments"},d.tsx(e.Heading,{level:e.incrementHeadingLevel(ba)},U.attachments),this._attachments.render()):null));return d.tsx(K,{active:this.isPanelActive(x),key:"attribute-editing-panel",heading:Da,headingLevel:ba,
handleBack:la,messages:U,messagesCommon:Y,sketchViewModel:xa,snappingControls:pa},d.tsx("div",{class:"esri-editor__panel-content"},Aa,ja?d.tsx("calcite-scrim",null):null),this.renderFooterActions(Ga))};n.renderAttachmentAdding=function(x){const {_attachments:G,EditorPanel:K,_handleBack:U,headingLevel:Y,messages:ba,messagesCommon:la,_snappingControls:pa,viewModel:{sketchViewModel:va}}=this,xa=[{label:G.submitting?la.cancel:la.add,disabled:G.submitting||!G.selectedFile,type:"primary",clickHandler:this._handleAttachmentAdd,
width:"full"}];return d.tsx(K,{active:this.isPanelActive(x),key:"attachment-adding-panel",heading:ba.addAttachment,headingLevel:Y,handleBack:U,messages:ba,messagesCommon:la,sketchViewModel:va,snappingControls:pa},d.tsx("div",{class:"esri-editor__panel-content"},G.render()),this.renderFooterActions(xa))};n.renderAttachmentEditing=function(x){const {_attachments:G,EditorPanel:K,_handleBack:U,headingLevel:Y,messages:ba,messagesCommon:la,_snappingControls:pa,viewModel:{sketchViewModel:va}}=this,xa=[{label:la.update,
disabled:G.submitting||!G.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate,width:"half"},{label:la.delete,disabled:G.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete,width:"half",appearance:"outline"}];return d.tsx(K,{active:this.isPanelActive(x),key:"attachment-editing-panel",heading:ba.editAttachment,headingLevel:Y,handleBack:U,messages:ba,messagesCommon:la,sketchViewModel:va,snappingControls:pa},d.tsx("div",{class:"esri-editor__panel-content"},G.render()),
this.renderFooterActions(xa))};n.renderFeatureUpdating=function(x){const {EditorPanel:G,_handleBack:K,headingLevel:U,messages:Y,messagesCommon:ba,_snappingControls:la,viewModel:{sketchViewModel:pa}}=this;return d.tsx(G,{active:this.isPanelActive(x),key:"feature-updating-panel",heading:Y.selectFeature,headingLevel:U,handleBack:K,messages:Y,messagesCommon:ba,sketchViewModel:pa,snappingControls:la},d.tsx("div",{class:"esri-editor__panel-content"},this.renderMessage(Y.selectFeatureToEdit)))};n.renderMessage=
function(x){return d.tsx("div",{class:"esri-editor__panel-content__message"},x)};n.renderFeatureCreation=function(x){const {EditorPanel:G,_handleBack:K,headingLevel:U,messages:Y,messagesCommon:ba,_snappingControls:la,viewModel:pa}=this,{sketchViewModel:va}=pa;var xa=pa.sketchViewModel,Aa=this._assertActiveCreateWorkflow().data.creationInfo.layer;xa=xa.canUndo()&&xa.createGraphic?xa.createGraphic:null;Aa=this._getSketchingTip(Aa.geometryType,xa);return d.tsx(G,{active:this.isPanelActive(x),key:"feature-creation-panel",
heading:Y.placeFeature,headingLevel:U,handleBack:K,messages:Y,messagesCommon:ba,sketchViewModel:va,snappingControls:la},d.tsx("div",{class:"esri-editor__panel-content"},this.renderMessage(Aa)))};n.renderFooterActions=function(x){return x.map(({type:G,disabled:K,class:U,...Y},ba)=>this.renderButton({class:this.classes("esri-editor__control-button","secondary"===G?"esri-button--secondary":"tertiary"===G?"esri-button--tertiary":null,K?"esri-button--disabled":null,U),disabled:K??!1,key:ba,slot:"footer-actions",
...Y}))};n.renderPrompt=function({title:x,message:G,context:K,actions:U}){const Y=!!U.secondary,ba=d.tsx("calcite-button",{appearance:"solid",color:"danger"===K?"red":"blue",width:Y?"half":"full",onclick:U.primary.action,key:"prompt-primary-button",afterCreate:m},U.primary.label);U=Y?d.tsx("calcite-button",{appearance:"clear",color:"danger"===K?"red":"blue",width:"half",onclick:U.secondary.action,key:"prompt-secondary-button"},U.secondary.label):null;return d.tsx("div",{class:`${"esri-editor__prompt"}--${K}`},
d.tsx("div",{class:"esri-editor__prompt__header"},d.tsx("calcite-icon",{icon:"exclamation-mark-triangle"}),d.tsx(e.Heading,{class:"esri-editor__prompt__header__heading",level:this.headingLevel},x)),d.tsx("div",{class:"esri-editor__prompt__message"},G),d.tsx("div",{class:"esri-editor__prompt__divider"}),d.tsx("div",{class:"esri-editor__prompt__actions"},U,ba))};n.renderProgressBar=function(){return d.tsx("div",{class:this.classes("esri-editor__progress-bar"),key:"progress-bar"})};n.renderButton=function(x){const {disabled:G,
class:K,key:U,clickHandler:Y,label:ba,...la}=x;return d.tsx("calcite-button",{class:K,disabled:G,key:U,onclick:Y,type:"button",...la},ba)};n.renderLanding=function(x){const {EditorPanel:G,headingLevel:K,messages:U,messagesCommon:Y,_snappingControls:ba,_featureTemplates:{viewModel:{numberOfFeatureTemplates:la}},viewModel:{canUpdate:pa,sketchViewModel:va}}=this,xa=!pa&&0===la;return d.tsx(G,{active:this.isPanelActive(x),key:"landing-panel",heading:U.widgetLabel,headingLevel:K,showBackButton:!1,messages:U,
messagesCommon:Y,sketchViewModel:va,snappingControls:ba},d.tsx("div",{class:"esri-editor__panel-content"},pa?d.tsx("div",{key:"edit-actions",class:"esri-editor__panel-content__section"},this.renderUpdateActions()):void 0,0<la?d.tsx("div",{key:"create-actions",class:"esri-editor__panel-content__section"},this.renderCreateActions()):void 0,xa?d.tsx("div",{key:"no-content",class:"esri-editor__panel-content__section"},U.noEditableLayers):void 0))};n.renderUpdateActions=function(){const {messages:x,messagesCommon:G}=
this;return d.tsx("div",null,d.tsx(e.Heading,{level:e.incrementHeadingLevel(this.headingLevel)},x.editFeatures),d.tsx("div",{class:"esri-editor__update-features-action-buttons"},d.tsx("calcite-action",{text:G.select,textEnabled:!0,icon:"cursor",alignment:"start",class:"esri-editor__update-features-action-buttons--button",onclick:this._handleEdit})))};n.renderCreateActions=function(){const {_featureTemplates:x,headingLevel:G,messages:K}=this;return d.tsx("div",null,d.tsx(e.Heading,{level:e.incrementHeadingLevel(G)},
K.createFeatures),d.tsx("div",{key:"templates",class:"esri-editor__feature-templates-container"},x.render()))};n.renderFeatureList=function(x){const {EditorPanel:G,_handleBack:K,headingLevel:U,messages:Y,messagesCommon:ba,messagesTemplates:la,_snappingControls:pa,viewModel:{editableItems:va,sketchViewModel:xa}}=this;var Aa=this._assertActiveUpdateWorkflow().data.candidates;const Ga=z.substitute(Y.multipleFeaturesTemplate,{total:Aa.length}),Da=new Map;let da=0;Aa.map(ha=>({label:this._getLabel(ha),
id:ha.attributes[ha.layer.objectIdField],data:ha})).filter(ha=>{const {label:Z,data:ca}=ha;ha=this._filterText.toLowerCase();const {title:fa}=ca.layer;return this.viewModel.editableItems.find(ea=>ea.layer===ca.layer).supports.includes("update")&&(!ha||Z.toLowerCase().includes(ha)||fa.toLowerCase().includes(ha))}).forEach(ha=>{da++;const Z=ha.data.layer;Da.has(Z)?Da.get(Z).items.push(ha):Da.set(Z,{id:`${Z.id}`,label:Z.title,items:[ha]})});Aa=va.filter(({layer:ha})=>Da.has(ha)).map(({layer:ha})=>Da.get(ha)).toArray();
const ja=10<da||0<this._filterText.length;return d.tsx(G,{active:this.isPanelActive(x),key:"feature-list",heading:Ga,headingLevel:U,handleBack:K,messages:Y,messagesCommon:ba,sketchViewModel:xa,snappingControls:pa},d.tsx("div",{class:"esri-editor__panel-content"},d.tsx("div",{class:"esri-editor__panel-content__section"},P.ItemList({id:this.id,enableListScroll:!1,filterEnabled:ja,filterText:this._filterText,items:Aa,messages:{filterPlaceholder:la.filterPlaceholder,noItems:la.noItems,noMatches:la.noMatches},
onItemMouseEnter:({data:ha})=>this._setCandidateFeature(ha),onItemMouseLeave:()=>this._setCandidateFeature(null),onItemSelect:({data:ha})=>this._setCandidateFeature(ha,!0),onFilterChange:ha=>this._filterText=ha}))))};n.EditorPanel=function(x,...G){const {active:K,handleBack:U,heading:Y,headingLevel:ba,key:la,messages:pa,messagesCommon:va,showBackButton:xa,sketchViewModel:Aa,snappingControls:Ga}=x,{snappingControls:Da,undoRedoButtons:da}=this.visibleElements;return d.tsx("calcite-flow-item",{bind:this,
key:la,heading:Y,headingLevel:ba,showBackButton:xa??!0,"intl-back":va.back,closable:!1,onCalciteFlowItemScroll:this._closeSnappingPopover,onCalciteFlowItemBackClick:U??null},d.tsx("div",{class:"esri-editor__panel-toolbar"},Da?[d.tsx("calcite-popover",{autoClose:K,afterCreate:this._setSnappingPopover,afterUpdate:this._setSnappingPopover,bind:this,label:pa.snappingSettings,heading:pa.snappingSettings,referenceElement:this._snappingButton||null,"overlay-positioning":"fixed",placement:"bottom"},d.tsx("div",
{class:"esri-editor__snapping-controls-popover"},Ga.render())),d.tsx("calcite-button",{id:`${la}__snappingButton`,afterCreate:this._setSnappingButton,afterUpdate:this._setSnappingButton,bind:this,text:pa.snapping,appearance:"transparent",color:"neutral",alignment:"icon-end-space-between","icon-start":"vertex-gps","icon-end":"caret-down",width:"full",class:"esri-editor__panel-toolbar__snapping-button",onkeydown:ja=>{"Escape"===ja.key&&this._closeSnappingPopover()}},pa.snapping)]:null,da?[d.tsx("calcite-button",
{key:"undo-button",text:va.undo,appearance:"transparent",color:"neutral",alignment:"center","icon-start":"undo",scale:"l",disabled:!Aa.canUndo(),onclick:Aa.undo.bind(Aa)}),d.tsx("calcite-button",{key:"redo-button",text:va.redo,appearance:"transparent",color:"neutral",alignment:"center","icon-start":"redo",scale:"l",disabled:!Aa.canRedo(),onclick:Aa.redo.bind(Aa)})]:null),G)};n._closeSnappingPopover=function(){this._snappingPopover?.open&&this._snappingPopover.toggle()};n._setSnappingPopover=function(x){this._snappingPopover=
x};n._setSnappingButton=function(x){this._snappingButton=x;this.scheduleRender()};n._getSketchingTip=function(x,G){const {messages:K}=this;if("point"===x)return K.tips.clickToAddPoint;if("polygon"===x||"polyline"===x){if(!G)return K.tips.clickToStart;[G]=G.geometry["polygon"===x?"rings":"paths"];return"polygon"===x&&4>G?K.tips.clickToContinue:K.tips.clickToContinueThenDoubleClickToEnd}return K.tips.clickToAddFeature};n._getLabel=function(x){var G=x.layer;if(!G)return null;const {objectIdField:K}=
G;({attributes:x}=x);return(G=y.getDisplayFieldName(G))&&x[G]&&`${x[G]}`||z.substitute(this.messages.untitledFeatureTemplate,{id:x[K]})};n._handleDelete=function(){const {messages:x,messagesCommon:G}=this;this._prompt={title:x.deleteWarningTitle,message:x.deleteWarningMessage,context:"danger",actions:{primary:{label:G.delete,action:()=>{this.viewModel.deleteFeatureFromWorkflow();this._prompt=null}},secondary:{label:x.keepFeature,action:()=>this._prompt=null}}}};n._handleSave=function(){const {featureFormViewModel:x}=
this.viewModel;x.submit();!x.submittable||0<x.validateContingencyConstraints(x.getValues(),{includeIncompleteViolations:!0}).length||this.viewModel.activeWorkflow.commit()};n._handleAttachmentAdd=function(){const {_attachments:x}=this,{activeWorkflow:G}=this.viewModel;"create-features"===G.type?(x.addFile(),G.previous()):x.addAttachment().then(()=>G.previous())};n._handleAttachmentUpdate=function(){const {_attachments:x}=this,{activeWorkflow:G}=this.viewModel;"create-features"===G.type?(x.updateFile(),
G.previous()):x.updateAttachment().then(()=>G.previous())};n._handleAttachmentDelete=function(){const {messages:x,messagesCommon:G}=this;this._prompt={title:x.deleteAttachmentWarningTitle,message:x.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:G.delete,action:()=>{const {_attachments:K}=this,{activeWorkflow:U}=this.viewModel;"create-features"===U.type?(K.deleteFile(),U.previous(),this._prompt=null):K.deleteAttachment(K.viewModel.activeAttachmentInfo).then(()=>{U.previous();
this._prompt=null})}},secondary:{label:x.keepAttachment,action:()=>this._prompt=null}}}};n._handleAdd=function(){};n._handleEdit=function(){this.viewModel.canUpdate&&this.viewModel.startUpdateWorkflowAtFeatureSelection()};n._handleDone=function(){this.viewModel.cancelWorkflow({force:!0})};n._handleBack=function(){var x=u._asyncToGenerator(function*(G){if(this.activeWorkflow){var K=this.activeWorkflow;G?.stopPropagation();if(!this.viewModel.syncing){var U=()=>{K.hasPreviousStep?K.previous({cancelCurrentStep:!0}):
this.viewModel.cancelWorkflow({force:!0})};if("create"===K.type||"create-features"===K.type&&0<K.numPendingFeatures||"editing-existing-feature"===K.stepId&&K.data.edits.modified){({messages:G}=this);const {type:Y}=K;this._prompt={title:"create"===Y?G.cancelAddTitle:G.cancelEditTitle,message:"create"===Y?G.cancelAddWarningMessage:G.cancelEditWarningMessage,context:"danger",actions:{primary:{label:"create"===Y?G.discardFeature:G.discardEdits,action:()=>{this._prompt=null;U()}},secondary:{label:"create"===
Y?G.continueAdding:G.continueEditing,action:()=>this._prompt=null}}};this.scheduleRender()}else U()}}});return function(G){return x.apply(this,arguments)}}();n._assertActiveCreateWorkflow=function(){const {type:x}=this.viewModel.activeWorkflow;if("create"===x||"create-features"===x)return this.viewModel.activeWorkflow;throw Error("Expected activeWorkflow to be instance of CreateWorkflow or CreateFeaturesWorkflow");};n._assertActiveUpdateWorkflow=function(){if("update"===this.viewModel.activeWorkflow.type)return this.viewModel.activeWorkflow;
throw Error("Expected activeWorkflow to be an UpdateWorkflow");};n._shouldShowAttachmentsForWorkflow=function(x){var G="create-features"===x.type&&x.data.creationInfo,K=!1;if(G){({layerInfos:K}=this);const {layer:U}=G;({data:G}=U.capabilities);K=K&&K.find(Y=>Y.layer===U);K="supportsAttachment"in G&&G.supportsAttachment&&(!K||!1!==K.allowAttachments)}return K||"update"===x.type&&x.data.editableItem.hasAttachments};u._createClass(T,[{key:"activeWorkflow",get:function(){return this.viewModel.activeWorkflow}},
{key:"allowedWorkflows",get:function(){return this.viewModel.allowedWorkflows},set:function(x){this.viewModel.allowedWorkflows=x}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(x){this._overrideIfSome("label",x)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(x){this.viewModel.labelOptions=x}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(x){this.viewModel.layerInfos=x}},{key:"snappingOptions",
get:function(){return this.viewModel.snappingOptions},set:function(x){this.viewModel.snappingOptions=x}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(x){this.viewModel.tooltipOptions=x}},{key:"view",get:function(){return this.viewModel.view},set:function(x){this.viewModel.view=x}}]);return T}(l.HandleOwnerMixin(E));f.__decorate([M.property()],O.prototype,"_attachments",void 0);f.__decorate([M.property({readOnly:!0})],O.prototype,"activeWorkflow",null);f.__decorate([M.property()],
O.prototype,"allowedWorkflows",null);f.__decorate([M.property()],O.prototype,"useDeprecatedCreateWorkflow",void 0);f.__decorate([M.property()],O.prototype,"headingLevel",void 0);f.__decorate([M.property()],O.prototype,"iconClass",void 0);f.__decorate([M.property()],O.prototype,"label",null);f.__decorate([M.property()],O.prototype,"labelOptions",null);f.__decorate([M.property()],O.prototype,"layerInfos",null);f.__decorate([M.property(),r.messageBundle("esri/widgets/Editor/t9n/Editor")],O.prototype,
"messages",void 0);f.__decorate([M.property(),r.messageBundle("esri/t9n/common")],O.prototype,"messagesCommon",void 0);f.__decorate([M.property(),r.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],O.prototype,"messagesTemplates",void 0);f.__decorate([M.property()],O.prototype,"snappingOptions",null);f.__decorate([M.property()],O.prototype,"tooltipOptions",null);f.__decorate([M.property()],O.prototype,"supportingWidgetDefaults",void 0);f.__decorate([M.property()],O.prototype,"view",
null);f.__decorate([M.property(),H.vmEvent(["workflow-cancel","workflow-commit"])],O.prototype,"viewModel",void 0);f.__decorate([M.property()],O.prototype,"visibleElements",void 0);f.__decorate([L.cast("visibleElements")],O.prototype,"castVisibleElements",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleDelete",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleAttachmentAdd",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleAttachmentUpdate",null);f.__decorate([b.accessibleHandler()],
O.prototype,"_handleAttachmentDelete",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleAdd",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleEdit",null);f.__decorate([b.accessibleHandler()],O.prototype,"_handleDone",null);return O=f.__decorate([Q.subclass("esri.widgets.Editor")],O)});