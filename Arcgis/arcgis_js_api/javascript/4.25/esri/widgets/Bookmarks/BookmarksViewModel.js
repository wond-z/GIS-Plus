// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Viewpoint ../../core/Collection ../../core/Error ../../core/Evented ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../webdoc/support/SlideThumbnail ../../webmap/Bookmark ../support/GoTo".split(" "),function(l,f,C,e,m,D,x,g,K,E,F,G,y,H){const z=e.ofType(y),I={width:128,height:128,format:"png"},
n={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},A={time:!0};e=function(B){function p(a){a=B.call(this,a)||this;a.abilities={...A};a.activeBookmark=null;a.view=null;return a}l._inheritsLoose(p,B);var h=p.prototype;h.destroy=function(){this.view=null;this._set("activeBookmark",null)};h.castAbilities=function(a){return{...A,...a}};h.createBookmark=function(){var a=l._asyncToGenerator(function*(b){const {view:d,defaultCreateOptions:c,abilities:k}=this;
if(!d)throw new m("create-bookmark:invalid-view","Cannot create a bookmark without a view.");const {takeScreenshot:r,screenshotSettings:t,captureViewpoint:u,captureRotation:v,captureScale:w,captureTimeExtent:q}={...c,...b};b=r?yield this._createThumbnail(t):void 0;const J=k.time&&q&&x.isSome(d.timeExtent)?d.timeExtent.clone():void 0;return new y({...(b&&{thumbnail:b}),...(q&&{timeExtent:J}),...(u&&{viewpoint:this._createViewpoint({view:d,captureScale:w,captureRotation:v})})})});return function(b){return a.apply(this,
arguments)}}();h.editBookmark=function(){var a=l._asyncToGenerator(function*(b,d){const {view:c,defaultEditOptions:k}=this;if(!c)throw new m("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const {takeScreenshot:r,screenshotSettings:t,captureViewpoint:u,captureRotation:v,captureScale:w,captureTimeExtent:q}={...k,...d};if(d=r?yield this._createThumbnail(t):void 0)b.thumbnail=d;u&&(b.viewpoint=this._createViewpoint({view:c,captureScale:w,captureRotation:v}));q&&x.isSome(c.timeExtent)&&
(b.timeExtent=c.timeExtent.clone());this.emit("bookmark-edit",{bookmark:b});return b});return function(b,d){return a.apply(this,arguments)}}();h.goTo=function(a){const {abilities:b,view:d}=this;if(!d)throw new m("go-to:invalid-view","Cannot go to a bookmark without a view");var c=a?.viewpoint;if(!c)throw new m("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:a});this._set("activeBookmark",a);c=this.callGoTo({target:c});const k=a?.timeExtent;b.time&&
k&&(d.timeExtent=k);this.emit("bookmark-select",{bookmark:a});c.catch(()=>{}).then(()=>this._set("activeBookmark",null));return c};h._createThumbnail=function(){var a=l._asyncToGenerator(function*(b){b=yield this.view.takeScreenshot({...I,...b});return new G.SlideThumbnail({url:b.dataUrl})});return function(b){return a.apply(this,arguments)}}();h._createViewpoint=function({view:a,captureRotation:b,captureScale:d}){const c=a.viewpoint?.clone();return new C({targetGeometry:a.extent?.clone(),rotation:b&&
c?.rotation||0,scale:d&&c?.scale||0})};l._createClass(p,[{key:"bookmarks",get:function(){return this.view?.map?.bookmarks??new z},set:function(a){this._overrideIfSome("bookmarks",a)}},{key:"defaultCreateOptions",get:function(){return n},set:function(a){this._set("defaultCreateOptions",{...n,...a})}},{key:"defaultEditOptions",get:function(){return n},set:function(a){this._set("defaultEditOptions",{...n,...a})}},{key:"state",get:function(){const a=this.get("view");return a&&!a.ready?"loading":"ready"}}]);
return p}(H.GoToMixin(D.EventedAccessor));f.__decorate([g.property()],e.prototype,"abilities",void 0);f.__decorate([E.cast("abilities")],e.prototype,"castAbilities",null);f.__decorate([g.property({readOnly:!0})],e.prototype,"activeBookmark",void 0);f.__decorate([g.property({type:z})],e.prototype,"bookmarks",null);f.__decorate([g.property()],e.prototype,"defaultCreateOptions",null);f.__decorate([g.property()],e.prototype,"defaultEditOptions",null);f.__decorate([g.property({readOnly:!0})],e.prototype,
"state",null);f.__decorate([g.property()],e.prototype,"view",void 0);return e=f.__decorate([F.subclass("esri.widgets.Bookmarks.BookmarksViewModel")],e)});