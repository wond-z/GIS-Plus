// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/has ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/projection ../../geometry/projectionEllipsoid ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K,z,t,n,w,G,e,c,f,m,E,v,r,I,F,J,L,B,R,S,U,T,O,M){function X(ya){return"polygon"===ya||"rectangle"===ya||"circle"===ya?!0:!1}function ba(ya,Ea){qa("undo",ya.history.undo,ya.history.redo,Ea)}function ka(ya,Ea){qa("redo",ya.history.redo,ya.history.undo,Ea)}function qa(ya,Ea,pa,V){const Y=Ea.pop().updates,Z=[];V.forEach((aa,ha)=>{ha=Y[ha];null!=ha&&("geometry"in ha&&H.isSome(ha.geometry)&&(Z.push({geometry:aa.geometry}),aa.geometry=ha.geometry),"symbol"in ha&&H.isSome(ha.symbol)&&
(Z.push({symbol:aa.symbol}),aa.symbol=ha.symbol),"undo"in ha&&(Z.push(ha),ha[ya](aa)))});pa.push({updates:Z})}function xa(ya){return{updates:ya.map(Ea=>({geometry:Ea.geometry}))}}function wa(ya){return"requireError"in ya&&"aborted"===ya.requireError}const Fa=ya=>Object.freeze(Object.defineProperty({__proto__:null,default:ya},Symbol.toStringTag,{value:"Module"})),Ya={defaultZ:0},Ka={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,
enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};q=function(ya){function Ea(V){V=ya.call(this,V)||this;V._numUpdating=0;V._handles=new C;V._internalGraphicsLayer=new e({listMode:"hide",internal:!0,title:"SVM Internal"});V._operationHandle=null;V._viewHandles=new C;V.activeFillSymbol=null;V.activeLineSymbol=null;V.activeVertexSymbol=null;V.allowDeleteKey=!0;V.labelOptions=new F;V.layer=null;V.pointSymbol=new T({style:"circle",size:6,
color:[255,255,255],outline:{color:[50,50,50],width:1}});V.polygonSymbol=new O({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});V.polylineSymbol=new M({color:[130,130,130,1],width:2});V._snappingManager=null;V.tooltipOptions=new J;V.updateGraphics=new h;V.updateOnGraphicClick=!0;V.updatePointSymbol=new T({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});V.updatePolygonSymbol=new O({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});V.updatePolylineSymbol=
new M({color:[12,207,255],width:2});V.vertexSymbol=new T({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});V._moduleLoaderAbortController=null;V._viewReadyAbortController=null;V._originalAutoOpenEnabled=null;V.defaultCreateOptions=Ya;V.defaultUpdateOptions=Ka;V.snappingOptions=new B;return V}D._inheritsLoose(Ea,ya);var pa=Ea.prototype;pa.initialize=function(){this._handles.add([x.on(()=>this.view?.map?.layers,"change",V=>{V.removed.includes(this.layer)&&this.cancel()}),
x.on(()=>this.layer?.graphics,"change",V=>{if(H.isSome(this._operationHandle))for(const Y of V.removed)this.updateGraphics.includes(Y)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(Y):this._operationHandle.cancel())}),x.watch(()=>this.layer?.elevationInfo??null,V=>{V!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=V)},x.syncAndInitial),x.watch(()=>this.view,V=>{H.destroyMaybe(this._snappingManager);V&&(this._snappingManager=
new L.SnappingManager({view:V,options:this.snappingOptions}),"2d"===V.type?new Promise((Y,Z)=>d(["../../views/2d/interactive/editingTools"],Y,Z)):"3d"===V.type&&(new Promise((Y,Z)=>d(["../../views/3d/interactive/editingTools"],Y,Z)),new Promise((Y,Z)=>d(["../../views/3d/layers/GraphicsLayerView3D"],aa=>Y(Fa(aa)),Z))))},x.syncAndInitial),x.watch(()=>this.view?.spatialReference,(V,Y)=>{V&&Y&&!V.equals(Y)&&this.cancel()})])};pa.destroy=function(){this.cancel();this._handles=H.destroyMaybe(this._handles);
this._viewHandles=H.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=H.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};pa.cancel=function(){this._moduleLoaderAbortController=H.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=H.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};pa.complete=function(){this._operationHandle&&this._operationHandle.complete()};pa.delete=
function(){const {state:V,updateGraphics:Y}=this;if("active"===V&&Y.length){const {activeTool:Z,layer:aa}=this,ha=Y.toArray();aa.removeMany(ha);this.cancel();this._emitDeleteEvent({graphics:ha,tool:Z})}};pa.create=function(){var V=D._asyncToGenerator(function*(Y,Z){this.cancel();yield this._waitViewReady();if("disabled"===this.state)throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),
W.createAbortError();H.isSome(this.view.activeTool)&&(this.view.activeTool=null);if(Y){v.addUniqueLayer(this.view,this._internalGraphicsLayer);var aa=yield this._setupCreateOperation(Y,Z);H.isNone(aa)||this.destroyed?this.view.map.remove(this._internalGraphicsLayer):(aa.on("complete",()=>{if(aa===this._operationHandle){const ha=this.createGraphic,ia=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&
this.view.map.remove(this._internalGraphicsLayer);aa.cancelled||null==ha||this.layer.add(ha);this.emit("create",{graphic:ha,state:ia?"cancel":"complete",tool:Y,toolEventInfo:null,type:"create"})}}),this._operationHandle=aa,this.view.ready&&this.view.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")});return function(Y,Z){return V.apply(this,arguments)}}();pa.update=function(){var V=D._asyncToGenerator(function*(Y,Z){this.cancel();yield this._waitViewReady();const {layer:aa,
view:ha,state:ia}=this;if("disabled"===ia)throw ha||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),aa||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),W.createAbortError();H.isSome(this.view.activeTool)&&(this.view.activeTool=null);const ca=Array.isArray(Y)?Y:[Y];null!=Y&&ca&&ca.length?ca.some(ma=>ma.layer!==aa?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):H.isNone(ma.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(Y=yield this._setupUpdateOperation(ca,Z),this.destroyed||H.isNone(Y)||wa(Y)||(v.addUniqueLayer(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(Y,Z),this.emit("update",{graphics:ca,state:"start",aborted:!1,tool:Y.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")});
return function(Y,Z){return V.apply(this,arguments)}}();pa._updateSpatialReference=function(){var V=D._asyncToGenerator(function*(Y){this._beginAsyncOperation();Y=Array.isArray(Y)?Y:[Y];for(const Z of Y)H.isSome(Z.geometry)&&"mesh"!==Z.geometry.type&&!G.equals(Z.geometry.spatialReference,this.view.spatialReference)&&(t.canProjectWithoutEngine(Z.geometry.spatialReference,this.view.spatialReference)||t.isLoaded()||(yield t.load()),Z.geometry=t.project(Z.geometry,this.view.spatialReference));this._endAsyncOperation()});
return function(Y){return V.apply(this,arguments)}}();pa.undo=function(){this.canUndo()&&this._operationHandle.undo()};pa.redo=function(){this.canRedo()&&this._operationHandle.redo()};pa.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};pa.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};pa.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};pa._getFirstHit=
function(){var V=D._asyncToGenerator(function*(Y){var Z=this.view;if("2d"===Z.type){const ha=[];this.view.map.allLayers.forEach(ia=>{"vector-tile"!==ia.type&&"imagery"!==ia.type||ha.push(ia)});Z=yield this.view.hitTest(Y,{exclude:ha});return R.findFirstGraphicHit(Z.results)}const aa=[this.view.map.ground];Z.map.allLayers.forEach(ha=>{"integrated-mesh"===ha.type&&aa.push(ha)});Y=yield Z.hitTest(Y,{exclude:aa});if(0<Y.results.length){const ha=Y.results[0];if(H.isSome(ha)&&"graphic"===ha.type&&ha.graphic&&
(!Y.ground.mapPoint||1>Z.map.ground.opacity||Y.ground.distance-H.unwrapOr(ha.distance,0)>-Math.min(3*Y.ground.distance,"global"===Z.viewingMode?n.getReferenceEllipsoid(Z.renderCoordsHelper.spatialReference).radius/Z.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return ha}return null});return function(Y){return V.apply(this,arguments)}}();pa._generateViewHandles=function(V){var Y=this;return[V.on("immediate-click",function(){var Z=D._asyncToGenerator(function*(aa){var ha="active"===Y.state&&
"create"===Y._operationHandle.type;if("disabled"!==Y.state&&!ha&&Y.updateOnGraphicClick){Y._beginAsyncOperation();var ia=yield aa.async(()=>Y._getFirstHit(S.createScreenPointFromEvent(aa)));ha=null;H.isSome(ia)?(ia=ia.graphic,Y.updateGraphics.includes(ia)||ia.layer===Y.layer?(aa.stopPropagation(),ha=ia):"2d"!==V.type||Y._isComponentGraphic(ia)||"active"!==Y.state||Y.cancel()):"active"===Y.state&&Y.cancel();H.isSome(ha)&&!Y.updateGraphics.includes(ha)&&(yield Y.update([ha],{...Y.defaultUpdateOptions,
reshapeOptions:{...Y.defaultUpdateOptions.reshapeOptions}}));Y._endAsyncOperation()}});return function(aa){return Z.apply(this,arguments)}}(),r.ViewEventPriorities.WIDGET)]};pa._setupCreateOperation=function(){var V=D._asyncToGenerator(function*(Y,Z){Y=yield this._setupDrawGraphicTool(Y,this.view,{hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...Z});if(H.isNone(Y))return null;this.view.tools.add(Y);this.view.activeTool=Y;return this._setupCreateOperationHandle(Y)});return function(Y,Z){return V.apply(this,
arguments)}}();pa._setupDrawGraphicTool=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){if("multipoint"===Y&&"3d"===Z.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;const ha="rectangle"!==Y,ia="rectangle"!==Y;this.snappingOptions.enabledToggled=!1;Y={view:Z,mode:"rectangle"===Y||"circle"===Y?"hybrid":"click",...aa,snapToScene:!1,geometryType:Y,graphicSymbol:this._getGraphicSymbolFromTool(Y),snappingManager:this._snappingManager,forceUniformSize:ia,
centered:ha};return"2d"===this.view.type?this._makeDrawGraphicTool2D(Y):this._makeDrawGraphicTool3D(Y)});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._makeDrawGraphicTool2D=function(){var V=D._asyncToGenerator(function*(Y){const Z=yield this._requireModule(new Promise((aa,ha)=>d(["../../views/2d/interactive/editingTools"],aa,ha)));return wa(Z)||this.destroyed?null:new Z.module.DrawGraphicTool2D({...Y,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,
activeLineSymbol:this.activeLineSymbol,activeFillSymbol:X(Y.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})});return function(Y){return V.apply(this,arguments)}}();pa._makeDrawGraphicTool3D=function(){var V=D._asyncToGenerator(function*(Y){const Z=yield this._requireModule(new Promise((ha,ia)=>d(["../../views/3d/interactive/editingTools"],ha,ia)));if(wa(Z)||this.destroyed)return null;const {elevationInfo:aa}=this.layer;return new Z.module.DrawGraphicTool3D({...Y,elevationInfo:aa,
snapToScene:H.isSome(aa)?"absolute-height"===aa.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})});return function(Y){return V.apply(this,arguments)}}();pa._setupCreateOperationHandle=function(V){let Y=null;const Z=V.forceUniformSize,aa=V.centered,ha=[this.view.on("key-down",ca=>{if(ca.key===I.SKETCH_KEYS.pan)ca.stopPropagation(),ca.repeat||(V.enabled=!1);else if(ca.key===I.SKETCH_KEYS.complete)ca.stopPropagation(),V.completeCreateOperation();else if(ca.key!==I.SKETCH_KEYS.vertexAdd||
ca.repeat)ca.key===I.SKETCH_KEYS.undo?(ca.stopPropagation(),ia.undo()):ca.key===I.SKETCH_KEYS.redo?(ca.stopPropagation(),ia.redo()):ca.key!==I.SKETCH_KEYS.snappingToggle||"rectangle"===V.geometryType||"circle"===V.geometryType||ca.repeat?ca.key!==I.SKETCH_KEYS.constraint||"rectangle"!==V.geometryType&&"circle"!==V.geometryType||ca.repeat?ca.key!==I.SKETCH_KEYS.center||ca.repeat||(V.centered=!aa,ca.stopPropagation()):(V.forceUniformSize=!Z,ca.stopPropagation()):(this.snappingOptions.enabledToggled=
!0,ca.stopPropagation());else{const ma=V.drawOperation.geometryType;if("polyline"===ma||"polygon"===ma||"multipoint"===ma)ca.stopPropagation(),V.drawOperation.commitStagedVertex()}},r.ViewEventPriorities.WIDGET),this.view.on("key-up",ca=>{ca.key===I.SKETCH_KEYS.pan?V.enabled=!0:ca.key===I.SKETCH_KEYS.snappingToggle&&"rectangle"!==V.geometryType&&"circle"!==V.geometryType?(this.snappingOptions.enabledToggled=!1,ca.stopPropagation()):ca.key!==I.SKETCH_KEYS.constraint||"rectangle"!==V.geometryType&&
"circle"!==V.geometryType?ca.key===I.SKETCH_KEYS.center&&(V.centered=aa,ca.stopPropagation()):(V.forceUniformSize=Z,ca.stopPropagation())},r.ViewEventPriorities.WIDGET),V.on("vertex-add",ca=>{Y=H.isNone(Y)?"start":"active";switch(ca.operation){case "apply":this.emit("create",{graphic:H.unwrap(V.graphic),state:Y,tool:this.activeTool,toolEventInfo:ca,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[H.unwrap(V.graphic)],tool:V.geometryType});break;case "redo":this._emitRedoEvent({graphics:[H.unwrap(V.graphic)],
tool:V.geometryType})}}),V.on("cursor-update",ca=>{0<V.drawOperation.numCommittedVertices&&this.emit("create",{graphic:H.unwrap(V.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ca.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),V.on("vertex-remove",ca=>{switch(ca.operation){case "apply":this.emit("create",{graphic:H.unwrap(V.graphic),state:"active",tool:this.activeTool,toolEventInfo:ca,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[H.unwrap(V.graphic)],
tool:V.geometryType});break;case "redo":this._emitRedoEvent({graphics:[H.unwrap(V.graphic)],tool:V.geometryType})}}),V.on("complete",ca=>{this._set("createGraphic",H.unwrap(ca.graphic));Y="complete";ca.aborted?ia&&ia.cancel():ia&&ia.complete()}),x.watch(()=>this._getGraphicSymbolFromTool(V.geometryType),ca=>{V.graphicSymbol=ca})],ia=new U.CreateOperationHandle({activeComponent:V,tool:V.geometryType,type:"create",onEnd:()=>{ha.forEach(ca=>ca.remove());ha.length=0;this.view.tools?.remove(V)},undo:()=>
{V.canUndo&&V.undo()},redo:()=>{V.canRedo&&V.redo()},canUndo:()=>V.canUndo,canRedo:()=>V.canRedo});return ia};pa._getGraphicSymbolFromTool=function(V){switch(V){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;default:return null}};pa._setupUpdateOperation=function(){var V=D._asyncToGenerator(function*(Y,Z){const {layer:aa,view:ha}=this;Z={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,
...Z,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...Z?.reshapeOptions}};var ia=Z.tool;for(var ca of Y)aa.remove(ca),aa.add(ca);if("3d"===ha.type){if(0===Y.length)return null;switch(ia){case "move":return this._setupMove3DOperation(Y,Z,ha,ia);case "reshape":if(1<Y.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ia=m.isSupportedGraphic(Y[0]);if(ia===c.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(Y[0],
Z,ha);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ia)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(Y,Z,ha)}}switch(ia){case "move":return this._setupMove2DOperation(Y,Z,ha);case "reshape":if(1<Y.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ca=m.isSupportedGraphic(Y[0]);if(ca===c.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(Y,
ia,Z,ha);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ca)}).`);return null;case "transform":return 1===Y.length&&(ca=H.get(Y[0].geometry,"type"),"point"===ca||"multipoint"===ca)&&(ia="reshape"),this._setupTransformOrReshape2DOperation(Y,ia,Z,ha)}});return function(Y,Z){return V.apply(this,arguments)}}();pa._setupMove3DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa,ha,ia=!1){var ca=this;for(var ma of Y){const ja=
f.isSupportedGraphic(ma);if(ja!==c.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ja)}).`),null}ma=yield this._requireModule(new Promise((ja,ra)=>d(["../../views/3d/interactive/editingTools"],ja,ra)));if(wa(ma))return ma;const sa=new ma.module.GraphicMoveTool({view:aa,enableZ:Z.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(sa);sa.graphics.addMany(Y);
ia||this.updateGraphics.addMany(Y);const oa=[],la=new U.UpdateOperationHandle({activeComponent:sa,tool:ha,type:"update",onEnd:()=>{oa.forEach(ja=>ja.remove());oa.length=0;this.view.tools?.remove(sa);sa.destroyed||sa.destroy()},undo:()=>{ba(la,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ha})},redo:()=>{ka(la,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ha})},addToSelection:ja=>{this.updateGraphics.push(ja);
sa.graphics.push(ja);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ja],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ja=>{const ra=this.updateGraphics.indexOf(ja);la.history.undo.forEach(va=>va.updates.splice(ra,1));la.history.redo.forEach(va=>va.updates.splice(ra,1));this.updateGraphics.remove(ja);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[ja],type:"selection-change"},type:"update"});0===this.updateGraphics.length?la.complete():sa.graphics.remove(ja)},toggleTool:function(){var ja=D._asyncToGenerator(function*(){if(1===ca.updateGraphics.length&&!1!==Z.toggleToolOnClick&&"transform"===ha){var ra=ca.updateGraphics.getItemAt(0);m.isSupportedGraphic(ra)===c.SupportedGraphicResult.SUPPORTED&&(ra=yield ca._setupReshape3DOperation(ra,Z,aa,!0),wa(ra)||(la.onEnd(),la.destroy(),ca._setUpdateOperationHandle(ra,
Z)))}});return function(){return ja.apply(this,arguments)}}()});oa.push(...this._getHandlesForComponent(la,Z),this.view.on("immediate-click",ja=>this._getCommonUpdateOperationClickHandlers(la,ja,Z),r.ViewEventPriorities.WIDGET),aa.on("key-down",ja=>{this._getCommonUpdateOperationKeyDownHandlers(la,ja);ja.key===I.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,ja.stopPropagation())},r.ViewEventPriorities.WIDGET),aa.on("key-up",ja=>{ja.key===I.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=
!1,ja.stopPropagation())},r.ViewEventPriorities.WIDGET));return la});return function(Y,Z,aa,ha){return V.apply(this,arguments)}}();pa._setupGraphicTransform3DOperation=function(V,Y,Z,aa=!1){if(1===V.length&&E.isSupportedGraphic(V[0])===c.SupportedGraphicResult.SUPPORTED){const ha=V[0],ia=ha.geometry;if(H.isSome(ia)&&("point"===ia.type||"mesh"===ia.type))return this._setupPointTransform3DOperation(ha,Y,Z);if(H.isSome(ia)&&("polygon"===ia.type||"polyline"===ia.type))return this._setupPolyTransform3DOperation(ha,
Y,Z,aa)}return this._setupMove3DOperation(V,Y,Z,"transform",aa)};pa._setupPointTransform3DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){var ha=this;const {enableRotation:ia,enableScaling:ca,enableZ:ma}=Z,sa=yield this._requireModule(new Promise((ra,va)=>d(["../../views/3d/interactive/editingTools"],ra,va)));if(wa(sa))return sa;const oa=new sa.module.GraphicTransformTool({graphic:Y,view:aa,enableRotation:ia,enableScaling:ca,enableZ:ma,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});
this.view.tools.add(oa);this.updateGraphics.add(Y);const la=[],ja=new U.UpdateOperationHandle({activeComponent:oa,tool:"transform",type:"update",onEnd:()=>{la.forEach(ra=>ra.remove());la.length=0;this.view.tools?.remove(oa);oa.destroyed||oa.destroy()},undo:()=>{ba(ja,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{ka(ja,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},
addToSelection:function(){var ra=D._asyncToGenerator(function*(va){ha.updateGraphics.add(va);ha.emit("update",{graphics:ha.updateGraphics.toArray(),state:"active",aborted:!1,tool:ha.activeTool,toolEventInfo:{added:[va],removed:[],type:"selection-change"},type:"update"});va=yield ha._setupMove3DOperation(ha.updateGraphics.toArray(),Z,aa,"transform",!0);wa(va)||(ja.onEnd(),ja.destroy(),ha._setUpdateOperationHandle(va,Z))});return function(va){return ra.apply(this,arguments)}}(),removeFromSelection:ra=>
{this.updateGraphics.remove(ra);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ra],type:"selection-change"},type:"update"});ja.complete()},toggleTool:()=>{}});la.push(...this._getHandlesForComponent(ja,Z),this.view.on("immediate-click",ra=>this._getCommonUpdateOperationClickHandlers(ja,ra,Z),r.ViewEventPriorities.WIDGET),aa.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(ja,ra);ra.key===I.SKETCH_KEYS.snappingToggle&&
(this.snappingOptions.enabledToggled=!0,ra.stopPropagation())},r.ViewEventPriorities.WIDGET),aa.on("key-up",ra=>{ra.key===I.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,ra.stopPropagation())},r.ViewEventPriorities.WIDGET));return ja});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._setupPolyTransform3DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa,ha=!1){var ia=this;const {enableRotation:ca,enableScaling:ma,enableZ:sa,preserveAspectRatio:oa}=
Z,la=yield this._requireModule(new Promise((Ba,Ga)=>d(["../../views/3d/interactive/editingTools"],Ba,Ga)));if(wa(la))return la;const ja=new la.module.ExtentTransformTool({graphic:Y,view:aa,enableRotation:ca,enableScaling:ma,enableZ:sa,preserveAspectRatio:oa,tooltipOptions:this.tooltipOptions});this.view.tools.add(ja);ha||this.updateGraphics.add(Y);const ra=[],va=new U.UpdateOperationHandle({activeComponent:ja,tool:"transform",type:"update",onEnd:()=>{ra.forEach(Ba=>Ba.remove());ra.length=0;this.view.tools?.remove(ja);
ja.destroyed||ja.destroy()},canUndo:()=>ja.canUndo,undo:()=>{ja.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>ja.canRedo,redo:()=>{ja.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:function(){var Ba=D._asyncToGenerator(function*(Ga){ia.updateGraphics.add(Ga);ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[Ga],removed:[],
type:"selection-change"},type:"update"});Ga=yield ia._setupMove3DOperation(ia.updateGraphics.toArray(),Z,aa,"transform",!0);wa(Ga)||(va.onEnd(),va.destroy(),ia._setUpdateOperationHandle(Ga,Z))});return function(Ga){return Ba.apply(this,arguments)}}(),removeFromSelection:Ba=>{this.updateGraphics.remove(Ba);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Ba],type:"selection-change"},type:"update"});va.complete()},
toggleTool:function(){var Ba=D._asyncToGenerator(function*(){if(1===ia.updateGraphics.length&&!1!==Z.toggleToolOnClick){var Ga=ia.updateGraphics.getItemAt(0);m.isSupportedGraphic(Ga)===c.SupportedGraphicResult.SUPPORTED&&(Ga=yield ia._setupReshape3DOperation(Ga,Z,aa,!0),wa(Ga)||(va.onEnd(),va.destroy(),ia._setUpdateOperationHandle(Ga,Z)))}});return function(){return Ba.apply(this,arguments)}}()});ra.push(...this._getHandlesForComponent(va,Z),this.view.on("immediate-click",Ba=>this._getCommonUpdateOperationClickHandlers(va,
Ba,Z),r.ViewEventPriorities.WIDGET),this.view.on("key-down",Ba=>this._getCommonUpdateOperationKeyDownHandlers(va,Ba),r.ViewEventPriorities.WIDGET),this.view.on("key-down",Ba=>{Ba.key!==I.SKETCH_KEYS.constraint||Ba.repeat||(ja.preserveAspectRatio=!ja.preserveAspectRatio,Ba.stopPropagation())},r.ViewEventPriorities.WIDGET),this.view.on("key-up",Ba=>{Ba.key===I.SKETCH_KEYS.constraint&&(ja.preserveAspectRatio=!ja.preserveAspectRatio,Ba.stopPropagation())},r.ViewEventPriorities.WIDGET));return va});return function(Y,
Z,aa){return V.apply(this,arguments)}}();pa._setupMove2DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){var ha=this;this.updateGraphics.addMany(Y);yield this._updateSpatialReference(Y);const ia=yield this._getGraphicMover(Y,Z,aa);if(wa(ia))return ia;const ca=new U.UpdateOperationHandle({activeComponent:ia,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();oa.forEach(la=>la.remove());sa.forEach(la=>la.remove());oa=[];sa=[];ia.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},
undo:()=>{const la=this.updateGraphics.toArray();ba(ca,la);ca.refreshComponent();this._emitUndoEvent({graphics:la,tool:"move"})},redo:()=>{const la=this.updateGraphics.toArray();ka(ca,la);ca.refreshComponent();this._emitRedoEvent({graphics:la,tool:"move"})},addToSelection:function(){var la=D._asyncToGenerator(function*(ja){yield ha._updateSpatialReference(ja);ha.updateGraphics.push(ja);ia.graphics=ha.updateGraphics.toArray();ha.emit("update",{graphics:ha.updateGraphics.toArray(),state:"active",aborted:!1,
tool:ha.activeTool,toolEventInfo:{added:[ja],removed:[],type:"selection-change"},type:"update"})});return function(ja){return la.apply(this,arguments)}}(),removeFromSelection:la=>{const ja=this.updateGraphics.indexOf(la);ca.history.undo.forEach(va=>va.updates.splice(ja,1));ca.history.redo.forEach(va=>va.updates.splice(ja,1));this.updateGraphics.remove(la);const ra=this.updateGraphics.toArray();this.emit("update",{graphics:ra,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[la],
type:"selection-change"},type:"update"});0===this.updateGraphics.length?ca.complete():ia.graphics=ra}});let ma=!1,sa=[aa.on("immediate-click",la=>this._getCommonUpdateOperationClickHandlers(ca,la,Z),r.ViewEventPriorities.WIDGET),aa.on("key-down",la=>{this._getCommonUpdateOperationKeyDownHandlers(ca,la);la.key!==I.SKETCH_KEYS.constraint||la.repeat||(ma=!0,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},r.ViewEventPriorities.WIDGET),aa.on("key-up",la=>{la.key===I.SKETCH_KEYS.constraint&&ma&&(ma=
!1,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},r.ViewEventPriorities.WIDGET)],oa=this._getHandlesForComponent(ca,Z);return ca});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._setupReshape3DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa,ha=!1){var ia=this;const ca=yield this._requireModule(new Promise((la,ja)=>d(["../../views/3d/interactive/editingTools"],la,ja)));if(wa(ca))return ca;this.snappingOptions.enabledToggled=!1;const ma=new ca.module.GraphicReshapeTool({view:aa,
graphic:Y,enableZVertex:Z.enableZ&&"move"===Z.reshapeOptions.vertexOperation,enableZShape:Z.enableZ&&"move"===Z.reshapeOptions.shapeOperation,enableMoveGraphic:"move"===Z.reshapeOptions.shapeOperation||"move-xy"===Z.reshapeOptions.shapeOperation,enableMidpoints:"split"===Z.reshapeOptions.edgeOperation,enableEdgeOffset:"offset"===Z.reshapeOptions.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});aa.tools.add(ma);ha||this.updateGraphics.add(Y);
const sa=[],oa=new U.UpdateOperationHandle({activeComponent:ma,tool:"reshape",type:"update",onEnd:()=>{sa.forEach(la=>la.remove());sa.length=0;this.view.tools?.remove(ma);ma.destroyed||ma.destroy()},canUndo:()=>ma.canUndo,undo:()=>{ma.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>ma.canRedo,redo:()=>{ma.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:function(){var la=D._asyncToGenerator(function*(ja){ia.updateGraphics.add(ja);
ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[ja],removed:[],type:"selection-change"},type:"update"});ja=yield ia._setupMove3DOperation(ia.updateGraphics.toArray(),Z,aa,"transform",!0);wa(ja)||(oa.onEnd(),oa.destroy(),ia._setUpdateOperationHandle(ja,Z))});return function(ja){return la.apply(this,arguments)}}(),removeFromSelection:la=>{this.updateGraphics.remove(la);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[la],type:"selection-change"},type:"update"});oa.complete()},toggleTool:function(){var la=D._asyncToGenerator(function*(){if(!1!==Z.toggleToolOnClick){var ja=yield ia._setupGraphicTransform3DOperation(ia.updateGraphics.toArray(),Z,aa,!0);wa(ja)||(oa.onEnd(),oa.destroy(),ia._setUpdateOperationHandle(ja,Z))}});return function(){return la.apply(this,arguments)}}()});sa.push(...this._getHandlesForComponent(oa,Z),aa.on("immediate-click",
la=>this._getCommonUpdateOperationClickHandlers(oa,la,Z),r.ViewEventPriorities.WIDGET),aa.on("key-down",la=>{this._getCommonUpdateOperationKeyDownHandlers(oa,la);la.key===I.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!0,la.stopPropagation())},r.ViewEventPriorities.WIDGET),aa.on("key-up",la=>{la.key===I.SKETCH_KEYS.snappingToggle&&(this.snappingOptions.enabledToggled=!1,la.stopPropagation())},r.ViewEventPriorities.WIDGET));return oa});return function(Y,Z,aa){return V.apply(this,
arguments)}}();pa._setupTransformOrReshape2DOperation=function(){var V=D._asyncToGenerator(function*(Y,Z,aa,ha){var ia=this;this.updateGraphics.addMany(Y);yield this._updateSpatialReference(Y);Y="transform"===Z?yield this._getBox(Y,aa,ha):yield this._getReshape(Y,aa,ha);if(wa(Y))return Y;const ca=new U.UpdateOperationHandle({activeComponent:Y,type:"update",onEnd:()=>{sa.forEach(oa=>oa.remove());ma.forEach(oa=>oa.remove());sa=[];ma=[];ca.activeComponent&&!ca.activeComponent.destroyed&&ca.activeComponent.destroy();
this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ba(ca,this.updateGraphics.toArray());ca.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ca.tool})},redo:()=>{ka(ca,this.updateGraphics.toArray());ca.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ca.tool})},addToSelection:function(){var oa=D._asyncToGenerator(function*(la){var ja=ca.activeComponent;if("reshape"===ja.type){ja=[...ia.updateGraphics,
la];ia.updateGraphics.removeAll();ja=yield ia._setupMove2DOperation(ja,aa,ha);if(wa(ja))return;ca.onEnd();ca.destroy();ia._setUpdateOperationHandle(ja,aa)}else ia.updateGraphics.add(la),ja.graphics=ia.updateGraphics.toArray(),ja.refresh(),ca.resetHistory();ia.emit("update",{graphics:ia.updateGraphics.toArray(),state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[la],removed:[],type:"selection-change"},type:"update"})});return function(la){return oa.apply(this,arguments)}}(),removeFromSelection:function(){var oa=
D._asyncToGenerator(function*(la){const ja=ia.updateGraphics.indexOf(la);ca.history.undo.forEach(va=>va.updates.splice(ja,1));ca.history.redo.forEach(va=>va.updates.splice(ja,1));ia.updateGraphics.remove(la);const ra=ia.updateGraphics.toArray();if(0===ra.length)ca.complete();else{const va=ra[0].geometry;1!==ra.length||!H.isSome(va)||"point"!==va.type&&"multipoint"!==va.type?ca.activeComponent.graphics=ra:ca.toggleTool()}ia.emit("update",{graphics:ra,state:"active",aborted:!1,tool:ia.activeTool,toolEventInfo:{added:[],
removed:[la],type:"selection-change"},type:"update"})});return function(la){return oa.apply(this,arguments)}}(),toggleTool:function(){var oa=D._asyncToGenerator(function*(){if(!(1<ia.updateGraphics.length)){var la=ia.updateGraphics.getItemAt(0),ja=la.geometry;H.isSome(ja)&&("reshape"===ca.tool&&("point"===ja.type||"multipoint"===ja.type)||"transform"===ca.tool&&"extent"===ja.type)||(ja=null,"transform"===ca.tool?ja=yield ia._getReshape([la],aa,ha):"reshape"===ca.tool&&(ja=yield ia._getBox([la],aa,
ha)),wa(ja)||(ca.activeComponent.destroy(),ca.activeComponent=ja,ca.activeComponent&&(sa.forEach(ra=>ra.remove()),sa=ia._getHandlesForComponent(ca,aa))))}});return function(){return oa.apply(this,arguments)}}()});let ma=[ha.on("immediate-click",oa=>this._getCommonUpdateOperationClickHandlers(ca,oa,aa),r.ViewEventPriorities.WIDGET),ha.on("key-down",oa=>{this._getCommonUpdateOperationKeyDownHandlers(ca,oa);oa.key!==I.SKETCH_KEYS.snappingToggle||oa.repeat||(this.snappingOptions.enabledToggled=!0,oa.stopPropagation());
oa.key===I.SKETCH_KEYS.constraint&&!oa.repeat&&ca&&(oa=ca.activeComponent)&&"box"===oa.type&&(oa.preserveAspectRatio=!oa.preserveAspectRatio)},r.ViewEventPriorities.WIDGET),ha.on("key-up",oa=>{oa.key===I.SKETCH_KEYS.snappingToggle&&"reshape"===ca?.activeComponent?.type&&(this.snappingOptions.enabledToggled=!1,oa.stopPropagation());oa.key===I.SKETCH_KEYS.constraint&&ca&&(oa=ca.activeComponent)&&"box"===oa.type&&(oa.preserveAspectRatio=!oa.preserveAspectRatio)},r.ViewEventPriorities.WIDGET)],sa=this._getHandlesForComponent(ca,
aa);return ca});return function(Y,Z,aa,ha){return V.apply(this,arguments)}}();pa._getGraphicMover=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){({enableMoveAllGraphics:Z}=Z);const ha=yield this._requireModule(new Promise((ia,ca)=>d(["../../views/draw/support/GraphicMover"],ma=>ia(Fa(ma)),ca)));return wa(ha)?ha:new ha.module.default({enableMoveAllGraphics:Z,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:Y,view:aa,callbacks:{onGraphicMoveStart:({dx:ia,dy:ca,graphic:ma})=>{this._displayGrabbingCursor();
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,dy:ca,mover:ma,type:"move-start"},type:"update"})},onGraphicMove:({dx:ia,dy:ca,graphic:ma})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,dy:ca,mover:ma,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ia,dy:ca,graphic:ma})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia,dy:ca,mover:ma,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._getBox=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){const {enableRotation:ha,enableScaling:ia,preserveAspectRatio:ca}=Z;Z=yield this._requireModule(new Promise((ma,sa)=>d(["../../views/draw/support/Box"],
oa=>ma(Fa(oa)),sa)));return wa(Z)?Z:new Z.module.default({graphics:Y,enableRotation:ha,enableScaling:ia,preserveAspectRatio:ca,layer:this._internalGraphicsLayer,view:aa,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onMove:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},
type:"update"}),onMoveStop:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScaleStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScale:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onScaleStop:ma=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotateStart:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotate:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"}),onRotateStop:ma=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ma},type:"update"})}})});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._getReshape=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){const ha="split"===Z.reshapeOptions?.edgeOperation;Z="move"===Z.reshapeOptions?.shapeOperation;const ia=yield this._requireModule(new Promise((ca,ma)=>d(["../../views/draw/support/Reshape"],sa=>ca(Fa(sa)),ma)));return wa(ia)?ia:new ia.module.default({enableMidpoints:ha,enableMovement:Z,
graphic:Y[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:aa,callbacks:{onReshapeStart:ca=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ca},type:"update"}),onReshape:ca=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ca},type:"update"}),onReshapeStop:({mover:ca,type:ma})=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ca,type:ma},type:"update"}),onMoveStart:({dx:ca,dy:ma,mover:sa,type:oa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,dy:ma,mover:sa,type:oa},type:"update"}),onMove:({dx:ca,dy:ma,mover:sa,type:oa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,
dy:ma,mover:sa,type:oa},type:"update"}),onMoveStop:({dx:ca,dy:ma,mover:sa,type:oa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ca,dy:ma,mover:sa,type:oa},type:"update"}),onVertexAdd:({added:ca,type:ma,vertices:sa})=>{ca=ca.map(oa=>w.geometryToCoordinates(oa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ca,vertices:sa,type:ma},
type:"update"})},onVertexRemove:({removed:ca,type:ma,vertices:sa})=>{ca=ca.map(oa=>w.geometryToCoordinates(oa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ca,vertices:sa,type:ma},type:"update"})}}})});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._getHandlesForComponent=function(V,Y){const Z=V.activeComponent;switch(Z.type){case "graphic-mover":return[Z.on("graphic-click",({graphic:aa,viewEvent:ha})=>
{ha.native?.shiftKey&&(ha.stopPropagation(),V.removeFromSelection(aa))}),Z.on("graphic-move-start",aa=>V.addToHistory(xa(aa.allGraphics)))];case "box":return[Z.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(V,Y,aa)),Z.on("move-start",aa=>V.addToHistory(xa(aa.graphics))),Z.on("rotate-start",aa=>V.addToHistory(xa(aa.graphics))),Z.on("scale-start",aa=>V.addToHistory(xa(aa.graphics)))];case "reshape":return[Z.on("graphic-click",aa=>this._onTransformOrReshape2DGraphicClick(V,Y,aa)),Z.on("move-start",
aa=>V.addToHistory(xa([aa.mover]))),Z.on("reshape-start",aa=>V.addToHistory(xa([aa.graphic]))),Z.on("vertex-add",aa=>V.addToHistory(xa([aa.oldGraphic]))),Z.on("vertex-remove",aa=>V.addToHistory(xa([aa.oldGraphic])))];case "move-3d":return[Z.on("graphic-move-start",aa=>{V.addToHistory(xa(aa.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,type:"move-start"},
type:"update"})}),Z.on("graphic-move",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:aa.dx,dy:aa.dy,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,type:"move"},type:"update"})}),Z.on("graphic-move-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<aa.allGraphics.length?aa.allGraphics[0]:null,type:"move-stop"},type:"update"})}),
Z.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],V,Y):V.toggleTool()})];case "transform-3d":return[Z.on("record-undo",({record:aa})=>{V.addToHistory({updates:[aa]})}),Z.on("graphic-translate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-start"},type:"update"})}),Z.on("graphic-translate-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move-stop"},type:"update"})}),Z.on("graphic-rotate-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-start"},type:"update"})}),Z.on("graphic-rotate-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate-stop"},type:"update"})}),Z.on("graphic-scale-start",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale-start"},type:"update"})}),Z.on("graphic-scale-stop",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,
yScale:aa.yScale,type:"scale-stop"},type:"update"})}),Z.on("graphic-translate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,dx:aa.dxScreen,dy:aa.dyScreen,type:"move"},type:"update"})}),Z.on("graphic-rotate",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,angle:aa.angle,type:"rotate"},type:"update"})}),Z.on("graphic-scale",
aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:aa.graphic,xScale:aa.xScale,yScale:aa.yScale,type:"scale"},type:"update"})}),Z.on("immediate-click",aa=>{aa.shiftKey?this._toggleSelection([aa.graphic],V,Y):V.toggleTool()})];case "reshape-3d":return[Z.on("reshape",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("move",
aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("vertex-add",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("vertex-remove",aa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:aa,type:"update"})}),Z.on("immediate-click",aa=>
{aa.shiftKey?this._toggleSelection([aa.graphic],V,Y):V.toggleTool()})]}};pa._onTransformOrReshape2DGraphicClick=function(V,Y,Z){const {graphic:aa,viewEvent:ha}=Z;if(ha.native?.shiftKey&&aa.layer===this.layer)return ha.stopPropagation(),V.removeFromSelection(aa);if(Y.toggleToolOnClick)return ha.stopPropagation(),V.toggleTool()};pa._setUpdateOperationHandle=function(V,Y){this._operationHandle=V;const Z=this.view.map;this._disablePopup(Y);V.on("complete",()=>{if(V===this._operationHandle){const aa=this.updateGraphics.toArray(),
ha=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();Z&&Z.remove(this._internalGraphicsLayer);this._restorePopup(Y);this.emit("update",{graphics:aa,state:"complete",aborted:V.cancelled,tool:ha,toolEventInfo:null,type:"update"})}})};pa._getCommonUpdateOperationClickHandlers=function(){var V=D._asyncToGenerator(function*(Y,Z,aa){const ha=S.createScreenPointFromEvent(Z),
ia=yield Z.async(()=>this._getFirstHit(ha));H.isNone(ia)?Y.complete():Z.native.shiftKey&&this._toggleSelection([ia.graphic],Y,aa)?Z.stopPropagation():this.updateGraphics.includes(ia.graphic)?Z.stopPropagation():Y.complete()});return function(Y,Z,aa){return V.apply(this,arguments)}}();pa._toggleSelection=function(V,Y,Z){const aa=!!Z.multipleSelectionEnabled;return V.some(ha=>null==ha?!1:aa&&ha.layer===this.layer?(this.updateGraphics.includes(ha)?Y.removeFromSelection(ha):Y.addToSelection(ha),!0):!1)};
pa._getCommonUpdateOperationKeyDownHandlers=function(V,Y){if(V){var Z=Y.key;Z===I.SKETCH_KEYS.undo&&V.canUndo()?(Y.stopPropagation(),V.undo()):Z===I.SKETCH_KEYS.redo&&V.canRedo()?(Y.stopPropagation(),V.redo()):Z===I.SKETCH_KEYS.cancel?(Y.stopPropagation(),V.cancel()):this.allowDeleteKey&&I.SKETCH_KEYS.delete.includes(Z)&&this._onDeleteKey(Y)}};pa._onDeleteKey=function(V){if(this._operationHandle&&"update"===this._operationHandle.type){var Y=this.activeComponent,Z=this.updateGraphics.toArray();H.isNone(Y)||
"reshape-3d"===Y.type||"reshape"===Y.type&&(1!==Z.length||"point"!==H.get(Z[0].geometry,"type"))||(V.stopPropagation(),this.delete())}};pa._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=H.destroyMaybe(this._internalGraphicsLayer))};pa._isComponentGraphic=function(V){const {activeComponent:Y}=this;return!V||H.isNone(Y)?!1:V.attributes&&V.attributes.esriSketchTool||"draw-2d"===Y.type&&
Y.graphic===V||("box"===Y.type||"reshape"===Y.type)&&Y.isUIGraphic(V)};pa._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};pa._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};pa._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};pa._logError=function(V,Y,Z){p.getLogger(this.declaredClass).error(new u(V,
Y,Z))};pa._requireModule=function(){var V=D._asyncToGenerator(function*(Y){const Z=new AbortController;this._moduleLoaderAbortController=Z;Y=yield Y;return this._moduleLoaderAbortController!==Z||Z.signal.aborted?{requireError:"aborted"}:{module:Y}});return function(Y){return V.apply(this,arguments)}}();pa._emitUndoEvent=function(V){this.emit("undo",{...V,type:"undo"})};pa._emitRedoEvent=function(V){this.emit("redo",{...V,type:"redo"})};pa._emitDeleteEvent=function(V){this.emit("delete",{...V,type:"delete"})};
pa.wait=function(){return x.whenOnce(()=>!this.updating)};pa._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};pa._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};pa._disablePopupEnabled=function(V){return"3d"!==this.view?.type||this.updateOnGraphicClick||H.isSome(V)&&V.toggleToolOnClick};pa._disablePopup=function(V){this._disablePopupEnabled(V)&&(V=this.view.popup)&&H.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=
V.autoOpenEnabled,V.autoOpenEnabled=!1)};pa._restorePopup=function(V){this._disablePopupEnabled(V)&&(V=this.view.popup)&&H.isSome(this._originalAutoOpenEnabled)&&(V.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};pa._waitViewReady=function(){var V=D._asyncToGenerator(function*(){const Y=this.view;Y&&(H.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,yield W.whenOrAbort(x.whenOnce(()=>Y?.ready),this._viewReadyAbortController.signal))});
return function(){return V.apply(this,arguments)}}();D._createClass(Ea,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return!H.isSome(this.activeComponent)||
"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):H.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",get:function(){return this._get("defaultCreateOptions")},set:function(V){this._set("defaultCreateOptions",{...Ya,...V})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(V){this._set("defaultUpdateOptions",{...Ka,...V,reshapeOptions:{...Ka.reshapeOptions,...V?.reshapeOptions}})}},
{key:"snappingOptions",set:function(V){H.isSome(this._snappingManager)&&(this._snappingManager.options=V);this._set("snappingOptions",V)}},{key:"state",get:function(){const V=!(!this.view?.ready||!this.layer),Y=this._operationHandle;return V&&Y?"active":V?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(V){const Y=this._get("view");if(Y){const {container:Z,map:aa}=Y;Z&&(Y.cursor=null);aa&&aa.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");
V&&this._handles.add(x.when(()=>V.ready,Z=>{this._viewHandles.removeAll();Z&&this._viewHandles.add(this._generateViewHandles(V))},x.syncAndInitial),"view-ready");this._set("view",V)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:Ka}}}]);return Ea}(l.EventedAccessor);g.__decorate([A.property()],q.prototype,"updating",null);g.__decorate([A.property()],q.prototype,"_operationHandle",void 0);g.__decorate([A.property({readOnly:!0})],q.prototype,"activeTool",
null);g.__decorate([A.property()],q.prototype,"activeFillSymbol",void 0);g.__decorate([A.property()],q.prototype,"activeLineSymbol",void 0);g.__decorate([A.property()],q.prototype,"activeVertexSymbol",void 0);g.__decorate([A.property()],q.prototype,"allowDeleteKey",void 0);g.__decorate([A.property({readOnly:!0})],q.prototype,"createGraphic",null);g.__decorate([A.property()],q.prototype,"defaultCreateOptions",null);g.__decorate([A.property()],q.prototype,"defaultUpdateOptions",null);g.__decorate([A.property({type:F,
nonNullable:!0})],q.prototype,"labelOptions",void 0);g.__decorate([A.property()],q.prototype,"layer",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"pointSymbol",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"polygonSymbol",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"polylineSymbol",void 0);g.__decorate([A.property({type:B,nonNullable:!0})],q.prototype,"snappingOptions",null);g.__decorate([A.property()],q.prototype,"_snappingManager",
void 0);g.__decorate([A.property({readOnly:!0})],q.prototype,"state",null);g.__decorate([A.property({type:J,nonNullable:!0})],q.prototype,"tooltipOptions",void 0);g.__decorate([A.property({readOnly:!0})],q.prototype,"updateGraphics",void 0);g.__decorate([A.property()],q.prototype,"updateOnGraphicClick",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"updatePointSymbol",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"updatePolygonSymbol",void 0);g.__decorate([A.property({types:Q.symbolTypes})],
q.prototype,"updatePolylineSymbol",void 0);g.__decorate([A.property({types:Q.symbolTypes})],q.prototype,"vertexSymbol",void 0);g.__decorate([A.property({value:null})],q.prototype,"view",null);return q=g.__decorate([z.subclass("esri.widgets.Sketch.SketchViewModel")],q)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W){Q=function(x){function A(K){K=x.call(this,K)||this;K.elevationInfo=null;K.graphics=new H.GraphicsCollection;K.screenSizePerspectiveEnabled=!0;K.type="graphics";K.internal=!1;return K}d._inheritsLoose(A,x);var P=A.prototype;P.destroy=function(){this.removeAll();this.graphics.destroy()};P.add=function(K){this.graphics.add(K);return this};P.addMany=function(K){this.graphics.addMany(K);return this};P.removeAll=function(){this.graphics.removeAll();return this};P.remove=
function(K){this.graphics.remove(K)};P.removeMany=function(K){this.graphics.removeMany(K)};P.on=function(K,z){return x.prototype.on.call(this,K,z)};P.graphicChanged=function(K){this.emit("graphic-update",K)};return A}(C.BlendLayer(p.ScaleRangeLayer(l)));D.__decorate([g.property({type:W})],Q.prototype,"elevationInfo",void 0);D.__decorate([g.property(u.owningCollectionProperty(H.GraphicsCollection,"graphics"))],Q.prototype,"graphics",void 0);D.__decorate([g.property({type:["show","hide"]})],Q.prototype,
"listMode",void 0);D.__decorate([g.property()],Q.prototype,"screenSizePerspectiveEnabled",void 0);D.__decorate([g.property({readOnly:!0})],Q.prototype,"type",void 0);D.__decorate([g.property({constructOnly:!0})],Q.prototype,"internal",void 0);return Q=D.__decorate([q.subclass("esri.layers.GraphicsLayer")],Q)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(d,D){d.SupportedGraphicResult=void 0;(function(g){g[g.SUPPORTED=
0]="SUPPORTED";g[g.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";g[g.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";g[g.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";g[g.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";g[g.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(d.SupportedGraphicResult||(d.SupportedGraphicResult={}));d.isSupportedGraphicResultMessage=function(g){switch(g){case d.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case d.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";
case d.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case d.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case d.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has",
"../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,D,g,Q,h){d.isSupportedGraphic=function(q){if("graphics"!==q.layer?.type)return h.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(g.isNone(q.geometry))return h.SupportedGraphicResult.GEOMETRY_MISSING;switch(q.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return h.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return h.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==
Q.getGraphicEffectiveElevationMode(q)&&Q.hasGraphicFeatureExpressionInfo(q)?h.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:h.SupportedGraphicResult.SUPPORTED};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(d,D,g){function Q(x,A){return D.isNone(A)||!A.mode?(x?H:W).mode:A.mode}function h(x,A){return D.isSome(A)?A:x?H:W}function q(x,
A){return Q(D.isSome(x)?x.hasZ:!1,A)}function u(x){const A=l(x);return q(x.geometry,A)}function l(x){return x.layer&&"elevationInfo"in x.layer?x.layer.elevationInfo:null}function C(x,A,P,K,z,t,n=null){if(!D.isNone(t)){var w=D.isSome(n)?n.mode:"absolute-height";if("on-the-ground"===w)return 0;({absoluteZ:t}=p(A,P,K,z,x,t));a:{n=D.isSome(n)&&D.isSome(n.offset)?n.offset:0;switch(w){case "absolute-height":x=t-n;break a;case "relative-to-ground":x=t-(D.unwrapOr(x.elevationProvider.getElevation(A,P,K,z,
"ground"),0)+n);break a;case "relative-to-scene":x=t-(D.unwrapOr(x.elevationProvider.getElevation(A,P,K,z,"scene"),0)+n);break a}x=void 0}return x}}function p(x,A,P,K,z,t){const n=D.isSome(t.offset)?t.offset:0;switch(t.mode){case "absolute-height":return{absoluteZ:P+n,elevation:0};case "on-the-ground":return P=D.unwrapOr(z.elevationProvider.getElevation(x,A,0,K,"ground"),0),{absoluteZ:P,elevation:P};case "relative-to-ground":return x=D.unwrapOr(z.elevationProvider.getElevation(x,A,P,K,"ground"),0),
{absoluteZ:P+x+n,elevation:x};case "relative-to-scene":return x=D.unwrapOr(z.elevationProvider.getElevation(x,A,P,K,"scene"),0),{absoluteZ:P+x+n,elevation:x}}}const H={mode:"absolute-height",offset:0},W={mode:"on-the-ground",offset:null};d.absoluteHeightElevationInfo=H;d.elevationContextAffectsAlignment=function(x,A){if(D.isNone(A))return!1;({mode:A}=A);return D.isSome(A)&&("scene"===x&&"relative-to-scene"===A||"ground"===x&&"absolute-height"!==A)};d.elevationInfoLikeEquals=function(x,A){return x===
A||D.isSome(x)&&D.isSome(A)&&x.mode===A.mode&&x.offset===A.offset};d.getConvertedElevation=function(x,A,P,K=null){return C(x,A.x,A.y,A.hasZ?A.z:0,A.spatialReference,P,K)};d.getConvertedElevationFromVector=function(x,A,P,K,z=null){return C(x,A[0],A[1],2<A.length?A[2]:0,P,K,z)};d.getEffectiveElevationInfo=h;d.getEffectiveElevationMode=Q;d.getGeometryEffectiveElevationInfo=function(x,A){return h(D.isSome(x)?x.hasZ:!1,A)};d.getGeometryEffectiveElevationMode=q;d.getGraphicEffectiveElevationInfo=function(x){var A=
l(x);x=q(x.geometry,A);A=D.isSome(A)&&"on-the-ground"!==x?D.unwrapOr(A.offset,0)*g.getMetersPerUnit(D.unwrapOr(A.unit,"meters")):0;return{mode:x,offset:A}};d.getGraphicEffectiveElevationMode=u;d.getZForElevationMode=function(x,A,P){if(!D.isNone(P)&&P.mode){var K=x.hasZ?x.z:0,z=D.isSome(P.offset)?P.offset:0;switch(P.mode){case "absolute-height":return K-z;case "on-the-ground":return 0;case "relative-to-ground":return x=D.unwrapOr(A.elevationProvider.getElevation(x.x,x.y,x.z,x.spatialReference,"ground"),
0)+z,K-x;case "relative-to-scene":return x=D.unwrapOr(A.elevationProvider.getElevation(x.x,x.y,x.z,x.spatialReference,"scene"),0)+z,K-x}}};d.hasGraphicFeatureExpressionInfo=function(x){if("on-the-ground"===u(x))return!1;x=l(x);x=D.isSome(x)&&x.featureExpressionInfo?x.featureExpressionInfo.expression:null;return!(!x||"0"===x)};d.onTheGroundElevationInfo=W;d.zValueInAbsoluteHeightMode=p;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,D,g,Q,h){function q(u){return"graphics"!==u.layer?.type?{result:h.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null}:D.isNone(u.geometry)?{result:h.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==Q.getGraphicEffectiveElevationMode(u)&&Q.hasGraphicFeatureExpressionInfo(u)?{result:h.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,
geometry:null}:"point"!==u.geometry.type&&"polyline"!==u.geometry.type&&("polygon"!==u.geometry.type||u.geometry instanceof g)?{result:h.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:h.SupportedGraphicResult.SUPPORTED,geometry:u.geometry}}d.geometryOfSupportedGraphic=function(u){return q(u).geometry};d.isSupportedGraphic=function(u){return q(u).result};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Point ./Polygon ./projectionEllipsoid ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x){var A;h=A=function(P){function K(...t){t=P.call(this,...t)||this;t.center=null;t.geodesic=!1;t.numberOfPoints=60;t.radius=1E3;t.radiusUnit="meters";return t}d._inheritsLoose(K,P);var z=K.prototype;z.normalizeCtorArgs=function(t,n){if(!t||!t.center){if(t&&t.rings)return P.prototype.normalizeCtorArgs.call(this,t,n);t={center:t}}return{...P.prototype.normalizeCtorArgs.call(this),...t,...n}};z.initialize=function(){var t=this.center;const n=this.numberOfPoints;this.hasZ=
t?.hasZ??!1;if(0===this.rings.length&&t){var w=g.convertUnit(this.radius,this.radiusUnit,"meters"),G=t.spatialReference,e="geographic";if(G.isWebMercator)e="webMercator";else if(null!=(G.wkid&&x[G.wkid])||G.wkt&&0===G.wkt.indexOf("PROJCS"))e="projected";if(this.geodesic){let c;switch(e){case "webMercator":c=W.webMercatorToGeographic(t);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":c=
t}t=this._createGeodesicCircle(c,w,n);"webMercator"===e&&(t=W.geographicToWebMercator(t))}else{let c;"webMercator"===e||"projected"===e?c=w/this._convert2Meters(1,t.spatialReference):"geographic"===e&&(c=g.lengthToDegrees(w,"meters",p.getReferenceEllipsoid(t.spatialReference).radius));t=this._createPlanarCircle(t,c,n)}this.spatialReference=t.spatialReference;this.addRing(t.rings[0])}};z.clone=function(){const {center:t,numberOfPoints:n,radius:w,radiusUnit:G,geodesic:e}=this;return new A({center:t?.clone(),
numberOfPoints:n,radius:w,radiusUnit:G,geodesic:e})};z._createGeodesicCircle=function(t,n,w){let G=0;const e=[];for(;360>G;){const c=[0,0];H.directGeodeticSolver(c,[t.x,t.y],G,n);this.hasZ&&c.push(t.z);e.push(c);G+=360/w}e.push(e[0]);return new C(e)};z._createPlanarCircle=function(t,n,w){const G=[],e=2*Math.PI/w;for(let f=0;f<w;++f){var c=e*f;c=[t.x+Math.cos(-c)*n,t.y+Math.sin(-c)*n];this.hasZ&&c.push(t.z);G.push(c)}G.push(G[0]);return new C({spatialReference:t.spatialReference,rings:[G]})};z._convert2Meters=
function(t,n){if(n.wkid&&null!=x[n.wkid])n=x.values[x[n.wkid]];else{n=n.wkt;const w=n.lastIndexOf(",")+1,G=n.lastIndexOf("]]");n=parseFloat(n.substring(w,G))}return t*n};return K}(C);D.__decorate([Q.property({type:l})],h.prototype,"center",void 0);D.__decorate([Q.property()],h.prototype,"geodesic",void 0);D.__decorate([Q.property()],h.prototype,"numberOfPoints",void 0);D.__decorate([Q.property()],h.prototype,"radius",void 0);D.__decorate([Q.property()],h.prototype,"radiusUnit",void 0);return h=A=
D.__decorate([u.subclass("esri.geometry.Circle")],h)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(d,D,g,Q,h,q,u,l,C,p){function H(w){if(!w)return null;if(q.isGeographic(w)&&w.wkid){var G=h.spheroids[w.wkid];if(G)return G}return w.wkt&&((w=h.WKT_SPHEROID_REGEX.exec(w.wkt))&&2===w.length?(G=w[1].split(","),!G||
3>G.length?w=null:(w=parseFloat(G[1]),G=parseFloat(G[2]),w=isNaN(w)||isNaN(G)?null:{a:w,f:0===G?0:1/G})):w=null,w)?w:null}function W(w){w=H(w??p.WGS84);if(null!=w&&"b"in w&&"eSq"in w&&"radius"in w)return w;const G=w.a*(1-w.f);return Object.assign(w,{b:G,eSq:1-(G/w.a)**2,radius:(2*w.a+G)/3,densificationRatio:1E4/((2*w.a+G)/3)})}function x(w){return null!=w&&0>w?w+360:w}function A(w,G,e){const {a:c,eSq:f}=W(e);e=Math.sqrt(f);const m=Math.sin(G[1]*h.toRadians);G=c*G[0]*h.toRadians;e=0<f?c*(1-f)*(m/(1-
f*m*m)-1/(2*e)*Math.log((1-e*m)/(1+e*m)))*.5:c*m;w[0]=G;w[1]=e;return w}function P(w){return null!==H(w)}function K(w,G){if("polyline"!==w.type&&"polygon"!==w.type)throw new g("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:e}=w;if(!P(e))throw new g("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var c="polyline"===w.type?w.paths:w.rings;const f=[],m=[0,0],E=new n;for(const I of c){c=
[];f.push(c);c.push([I[0][0],I[0][1]]);var v=I[0][0],r=I[0][1];let F,J;for(let L=0;L<I.length-1;L++){F=I[L+1][0];J=I[L+1][1];if(v===F&&r===J)continue;const B=[v,r];t(E,[v,r],[F,J],e);const {azimuth:R,distance:S}=E;v=S/G;if(1<v){for(r=1;r<=v-1;r++)z(m,B,R,r*G,e),c.push(m.slice(0));z(m,B,R,(S+Math.floor(v-1)*G)/2,e);c.push(m.slice(0))}z(m,B,R,S,e);c.push(m.slice(0));v=m[0];r=m[1]}}return"polyline"===w.type?new u({paths:f,spatialReference:e}):new l({rings:f,spatialReference:e})}function z(w,G,e,c,f){const m=
G[0]*h.toRadians;G=G[1]*h.toRadians;e=(e??0)*h.toRadians;const {a:E,b:v,f:r}=W(f);f=Math.sin(e);e=Math.cos(e);var I=(1-r)*Math.tan(G);G=1/Math.sqrt(1+I*I);const F=I*G,J=Math.atan2(I,e);I=G*f;const L=I*I;var B=1-L,R=B*(E*E-v*v)/(v*v);const S=1+R/16384*(4096+R*(-768+R*(320-175*R))),U=R/1024*(256+R*(-128+R*(74-47*R)));R=c/(v*S);let T=2*Math.PI,O,M,X,ba;for(;1E-12<Math.abs(R-T);)X=Math.cos(2*J+R),O=Math.sin(R),M=Math.cos(R),ba=U*O*(X+U/4*(M*(-1+2*X*X)-U/6*X*(-3+4*O*O)*(-3+4*X*X))),T=R,R=c/(v*S)+ba;c=
F*O-G*M*e;B=r/16*B*(4+r*(4-3*B));c=Math.atan2(F*M+G*O*e,(1-r)*Math.sqrt(L+c*c))/h.toRadians;w[0]=(m+(Math.atan2(O*f,G*M-F*O*e)-(1-B)*r*I*(R+B*O*(X+B*M*(-1+2*X*X)))))/h.toRadians;w[1]=c;return w}function t(w,G,e,c){var f=G[0]*h.toRadians;G=G[1]*h.toRadians;var m=e[0]*h.toRadians;e=e[1]*h.toRadians;const {a:E,b:v,f:r,radius:I}=W(c),F=m-f;var J=Math.atan((1-r)*Math.tan(G)),L=Math.atan((1-r)*Math.tan(e));c=Math.sin(J);J=Math.cos(J);const B=Math.sin(L);L=Math.cos(L);let R=1E3,S=F,U,T,O;let M,X,ba;do{var ka=
Math.sin(S);var qa=Math.cos(S);O=Math.sqrt(L*ka*L*ka+(J*B-c*L*qa)*(J*B-c*L*qa));if(0===O)return w.distance=0,w.azimuth=void 0,w.reverseAzimuth=void 0,w;qa=c*B+J*L*qa;M=Math.atan2(O,qa);X=J*L*ka/O;T=1-X*X;ka=qa-2*c*B/T;isNaN(ka)&&(ka=0);ba=r/16*T*(4+r*(4-3*T));U=S;S=F+(1-ba)*r*X*(M+ba*O*(ka+ba*qa*(-1+2*ka*ka)))}while(1E-12<Math.abs(S-U)&&0<--R);if(0===R)return c=Math.acos(Math.sin(G)*Math.sin(e)+Math.cos(G)*Math.cos(e)*Math.cos(m-f))*I,f=m-f,w.azimuth=Math.atan2(Math.sin(f)*Math.cos(e),Math.cos(G)*
Math.sin(e)-Math.sin(G)*Math.cos(e)*Math.cos(f))/h.toRadians,w.distance=c,w.reverseAzimuth=void 0,w;f=T*(E*E-v*v)/(v*v);G=f/1024*(256+f*(-128+f*(74-47*f)));m=Math.atan2(J*Math.sin(S),J*B*Math.cos(S)-c*L);w.azimuth=Math.atan2(L*Math.sin(S),J*B-c*L*Math.cos(S))/h.toRadians;w.distance=v*(1+f/16384*(4096+f*(-768+f*(320-175*f))))*(M-G*O*(ka+G/4*(qa*(-1+2*ka*ka)-G/6*ka*(-3+4*O*O)*(-3+4*ka*ka))));w.reverseAzimuth=m/h.toRadians;return w}let n=function(w=0,G,e){this.distance=w;this.azimuth=G;this.reverseAzimuth=
e};d.InverseGeodeticSolverResult=n;d.directGeodeticSolver=z;d.geodesicAreas=function(w,G="square-meters"){if(w.some(m=>!P(m.spatialReference)))throw new g("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const e=[];for(var c=0;c<w.length;c++){var f=w[c];const {radius:m,densificationRatio:E}=W(f.spatialReference);e.push(K(f,m*E))}w=[];c=[0,0];f=[0,0];for(let m=0;m<e.length;m++){const {rings:E,spatialReference:v}=e[m];let r=0;for(let I=0;I<E.length;I++){const F=
E[I];A(c,F[0],v);A(f,F[F.length-1],v);let J=f[0]*c[1]-c[0]*f[1];for(let L=0;L<F.length-1;L++)A(c,F[L+1],v),A(f,F[L],v),J+=f[0]*c[1]-c[0]*f[1];r+=J}r=Q.convertUnit(r,"square-meters",G);w.push(r/-2)}return w};d.geodesicDensify=K;d.geodesicDistance=function(w,G,e="meters"){if(!w||!G)throw new g("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!w.spatialReference||!G.spatialReference)throw new g("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");
if(!q.equals(w.spatialReference,G.spatialReference))throw new g("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:c}=w;if(!P(c))throw new g("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(w.x===G.x&&w.y===G.y)return new n(0,0,0);const f=new n;t(f,[w.x,w.y],[G.x,G.y],c);f.distance=Q.convertUnit(f.distance,"meters",e);f.azimuth=x(f.azimuth);f.reverseAzimuth=x(f.reverseAzimuth);return f};d.geodesicLengths=
function(w,G="meters"){if(!w)throw new g("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(w.some(f=>!P(f.spatialReference)))throw new g("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const e=[];for(let f=0;f<w.length;f++){var c=w[f];const {spatialReference:m}=c;c="polyline"===c.type?c.paths:c.rings;let E=0;for(let v=0;v<c.length;v++){const r=c[v];let I=0;for(let F=1;F<r.length;F++){const J=r[F-1][0],L=r[F][0],
B=r[F-1][1],R=r[F][1];if(B!==R||J!==L){const S=new n;t(S,[J,B],[L,R],m);I+=S.distance}}E+=I}E=Q.convertUnit(E,"meters",G);e.push(E)}return e};d.inverseGeodeticSolver=t;d.isSupported=P;d.pointFromDistance=function(w,G,e){if(!w||null==G||null==e)throw new g("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>e||360<e)throw new g("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");
if(!w.spatialReference)throw new g("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:c}=w;if(!P(c))throw new g("geodesic-distance:not-supported","input geometry spatial reference is not supported");const f=[0,0];z(f,[w.x,w.y],e,G,c);return new C({x:f[0],y:f[1],spatialReference:c})};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,D,g,Q,h){d.isSupportedGraphic=function(q){if("graphics"!==q.layer?.type)return h.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(g.isNone(q.geometry))return h.SupportedGraphicResult.GEOMETRY_MISSING;switch(q.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return h.SupportedGraphicResult.SUPPORTED;default:return h.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const u=
g.isSome(q.symbol)&&"point-3d"===q.symbol.type&&q.symbol.symbolLayers;return u&&0<u.length&&u.some(l=>"object"===l.type)?"on-the-ground"!==Q.getGraphicEffectiveElevationMode(q)&&Q.hasGraphicFeatureExpressionInfo(q)?h.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:h.SupportedGraphicResult.SUPPORTED:h.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/draw/support/layerUtils":function(){define(["exports",
"../../../core/maybe"],function(d,D){d.addUniqueLayer=function(g,Q,h){if(Q&&g&&g.map){({map:g}=g);var q=g.layers.find(u=>u===Q);q||g.add(Q,h);void 0!==h&&null!==h&&g.layers.reorder(q,h)}};d.findLayerView=function(g,Q){return g.allLayerViews.find(h=>{h=h.layer;return h===Q||"sublayers"in h&&D.isSome(h.sublayers)&&h.sublayers.includes(Q)})};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(d){d.SKETCH_KEYS=
{redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,D,g,Q,h,q,u){g=function(l){function C(p){p=l.call(this,p)||this;p.enabled=!1;return p}d._inheritsLoose(C,l);return C}(g);D.__decorate([Q.property({type:Boolean,nonNullable:!0})],g.prototype,"enabled",void 0);return g=D.__decorate([u.subclass("esri.views.interactive.sketch.SketchLabelOptions")],g)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(d,D,g,Q,h,q,u,l,C){g=function(p){function H(W){W=p.call(this,W)||this;W.enabled=!1;W.elevation=new l.SketchTooltipElevationOptions;W.visibleElements=new C.SketchTooltipVisibleElements;W.visualVariables=null;return W}d._inheritsLoose(H,p);H.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return H}(g);D.__decorate([Q.property({type:Boolean,nonNullable:!0})],g.prototype,"enabled",void 0);D.__decorate([Q.property({type:l.SketchTooltipElevationOptions,
nonNullable:!0})],g.prototype,"elevation",void 0);D.__decorate([Q.property({type:C.SketchTooltipVisibleElements,nonNullable:!0})],g.prototype,"visibleElements",void 0);D.__decorate([Q.property()],g.prototype,"visualVariables",void 0);return g=D.__decorate([u.subclass("esri.widgets.Sketch.SketchTooltipOptions")],g)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,D,g,Q,h,q,u,l){d.SketchTooltipElevationOptions=function(C){function p(H){H=C.call(this,H)||this;H.mode="absolute-height";return H}D._inheritsLoose(p,C);p.prototype.toJSON=function(){return{mode:this.mode}};return p}(Q);g.__decorate([h.property({type:String,nonNullable:!0})],d.SketchTooltipElevationOptions.prototype,"mode",void 0);d.SketchTooltipElevationOptions=g.__decorate([l.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],d.SketchTooltipElevationOptions);Object.defineProperties(d,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),function(d,D,g,Q,h,q,u,l){d.SketchTooltipVisibleElements=function(C){function p(){var H=
C.apply(this,arguments)||this;H.distance=!0;H.elevation=!0;H.size=!0;H.scale=!0;H.rotation=!0;H.orientation=!0;H.totalLength=!0;H.area=!0;H.radius=!0;return H}D._inheritsLoose(p,C);p.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return p}(Q);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,
"distance",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"elevation",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"size",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"scale",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"rotation",void 0);g.__decorate([h.property({type:Boolean,
nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"orientation",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"totalLength",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"area",void 0);g.__decorate([h.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"radius",void 0);d.SketchTooltipVisibleElements=g.__decorate([l.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],
d.SketchTooltipVisibleElements);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./SnappingDomain ./snappingFactory ./SnappingOptions ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K,z,t,n,w){function G({coordinateHelper:c,elevationInfo:f}){return c.hasZ()?A.absoluteHeightElevationInfo:f}d.SnappingManager=function(c){function f(E){E=c.call(this,E)||this;E.options=new z;E.snappingEnginesFactory=K.defaultSnappingEnginesFactory;E._engines=[];E._currentMainCandidate=null;E._currentOtherActiveCandidates=[];E._currentSnappedType=e.MAIN;return E}D._inheritsLoose(f,c);var m=f.prototype;m.initialize=function(){this.handles.add([C.watch(()=>{const {effectiveFeatureEnabled:E,
effectiveSelfEnabled:v,touchSensitivityMultiplier:r,distance:I}=this.options;return{effectiveFeatureEnabled:E,effectiveSelfEnabled:v,touchSensitivityMultiplier:r,distance:I}},()=>{this.doneSnapping();this.emit("changed")},C.sync),C.watch(()=>this.options,E=>{for(const v of this._engines)v.options=E},C.sync),C.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:E,snappingEnginesFactory:v})=>this._recreateEngines(E,
v),C.syncAndInitial)])};m.destroy=function(){this._destroyEngines()};m._recreateEngines=function(E,v){this._destroyEngines();if(E){var {view:r,options:I}=this;this._engines=v(r,I)}};m._destroyEngines=function(){for(const E of this._engines)E.destroy();this._engines=[]};m.snap=function(){var E=D._asyncToGenerator(function*(v){return u.isSome(v.scenePoint)?this._snapMultiPoint(v):this._snapSinglePoint(v)});return function(v){return E.apply(this,arguments)}}();m.update=function(E){const {point:v,context:r}=
E;this._removeVisualization();var I=this._currentMainCandidate;if(u.isNone(I))return v;E=this._selectUpdateInput(E);if(u.isNone(E))return v;var {coordinateHelper:{spatialReference:F}}=r,J=x.project(this._convertPointElevation(E,r),F);if(u.isNone(J))return v;({view:E}=this);const {coordinateHelper:L,elevationInfo:B,visualizer:R}=r;F=[];J=L.pointToVector(J);const S=I.constraint.closestTo(J);if(!this._arePointsWithinScreenThreshold(J,S,r))return this._resetSnappingState(),v;I.targetPoint=S;F.push(...I.hints);
for(const U of this._currentOtherActiveCandidates)U.targetPoint=S,F.push(...U.hints);u.isSome(R)&&this.handles.add(R.draw(F,{coordinateHelper:L,elevationInfo:G(r),view:E,selfSnappingZ:r.selfSnappingZ}),"visualization-handle");I=L.vectorToDehydratedPoint(S);return this._convertPointElevation(I,r,A.absoluteHeightElevationInfo,B)};m.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};m._selectUpdateInput=function({point:E,scenePoint:v}){switch(this._currentSnappedType){case e.MAIN:return E;
case e.SCENE:return v}};m._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=e.MAIN};m._removeVisualization=function(){this.handles.remove("visualization-handle")};m._snapSinglePoint=function(){var E=D._asyncToGenerator(function*({point:v,context:r,signal:I}){var {coordinateHelper:F}=r;const {view:J}=this;v=this._convertPointElevation(v,r);F=F.pointToVector(v);v=yield this._fetchCandidates(F,P.SnappingDomain.ALL,r,I);return this._createSnapResult(F,
e.MAIN,v,J,r,I)});return function(v){return E.apply(this,arguments)}}();m._snapMultiPoint=function(){var E=D._asyncToGenerator(function*({point:v,scenePoint:r,context:I,signal:F}){const {view:J}=this;var {coordinateHelper:L}=I,{spatialReference:B}=L;yield x.initializeProjection(r.spatialReference,B);r=x.project(this._convertPointElevation(r,I),B);r=L.pointToVector(r);B=yield this._fetchCandidates(r,P.SnappingDomain.FEATURE,I,F);if(0<B.length)return L=yield this._fetchCandidates(r,P.SnappingDomain.SELF,
I,F),this._createSnapResult(r,e.SCENE,[...B,...L],J,I,F);v=this._convertPointElevation(v,I);L=L.pointToVector(v);v=yield this._fetchCandidates(L,P.SnappingDomain.SELF,I,F);return this._createSnapResult(L,e.MAIN,v,J,I,F)});return function(v){return E.apply(this,arguments)}}();m._fetchCandidates=function(){var E=D._asyncToGenerator(function*(v,r,I,F){return(yield Promise.all(this._engines.map(J=>J.fetchCandidates(v,r,I,F)))).flat()});return function(v,r,I,F){return E.apply(this,arguments)}}();m._createSnapResult=
function(E,v,r,I,F,J){return{get valid(){return!l.isAborted(J)},apply:()=>{const {elevationInfo:L,coordinateHelper:B}=F,{snappedPoint:R,hints:S}=this._processCandidates(E,v,r,F);this._removeVisualization();u.isSome(F.visualizer)&&this.handles.add(F.visualizer.draw(S,{coordinateHelper:B,elevationInfo:G(F),view:I,selfSnappingZ:F.selfSnappingZ}),"visualization-handle");return this._convertPointElevation(R,F,A.absoluteHeightElevationInfo,L)}}};m._processCandidates=function(E,v,r,I){var {coordinateHelper:F}=
I;if(1>r.length)return this.doneSnapping(),{snappedPoint:F.vectorToDehydratedPoint(E),hints:[]};this._currentSnappedType!==v&&this._resetSnappingState();t.sortCandidatesInPlace(E,r,F);F=this._currentMainCandidate;if(u.isSome(F)){const J=this._findOldConstraintInNewCandidates(F,r);if(0<=J)if(r[J]instanceof n.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(E,F.targetPoint,I))return this._updateSnappingCandidate(F,v,r,I)}else return this._intersectWithOtherCandidates(J,r,E,v,I)}return this._intersectWithOtherCandidates(0,
r,E,v,I)};m._findOldConstraintInNewCandidates=function(E,v){return E instanceof n.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(v,E.first)&&0<=this._findOldCandidateIndex(v,E.second)?0:-1:this._findOldCandidateIndex(v,E)};m._intersectWithOtherCandidates=function(E,v,r,I,F){const {coordinateHelper:J}=F,L=v[E],B=[];for(let R=0;R<v.length;++R){if(R===E)continue;const S=v[R];for(const U of L.constraint.intersect(S.constraint)){const T=J.fromXYZ(U.closestTo(L.targetPoint),L.targetPoint[2]);
B.push([new n.IntersectionSnappingCandidate(J,T,L,S,S.elevationInfo),this._squaredScreenDistance(r,T,J)])}}return 0<B.length&&(B.sort((R,S)=>R[1]-S[1]),B[0][1]<this._squaredPointProximityThreshold(F.pointer))?this._updateSnappingCandidate(B[0][0],I,v,F):this._updateSnappingCandidate(L,I,v,F)};m._updateSnappingCandidate=function(E,v,r,I){this.doneSnapping();this._currentMainCandidate=E;this._currentSnappedType=v;v=this._currentMainCandidate.targetPoint;const F=[];F.push(...E.hints);for(const J of r){if(E instanceof
n.IntersectionSnappingCandidate){if(J.constraint.equals(E.first.constraint)||J.constraint.equals(E.second.constraint))continue}else if(J.constraint.equals(E.constraint))continue;J.constraint.check(v)&&(J.targetPoint=v,this._currentOtherActiveCandidates.push(J),F.push(...J.hints))}return{snappedPoint:I.coordinateHelper.vectorToDehydratedPoint(v),hints:F}};m._squaredPointProximityThreshold=function(E){return"touch"===E?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};m._arePointsWithinScreenThreshold=
function(E,v,r){return this._squaredScreenDistance(E,v,r.coordinateHelper)<this._squaredPointProximityThreshold(r.pointer)};m._squaredScreenDistance=function(E,v,r){return t.squaredScreenDistance(this._toScreen(E,r),this._toScreen(v,r))};m._toScreen=function(E,v){return w.anyMapPointToScreenPoint(E,v,A.absoluteHeightElevationInfo,this.view)};m._findOldCandidateIndex=function(E,v){let r=-1;for(let I=0;I<E.length;++I)if(v.constraint.equals(E[I].constraint)){r=I;break}return r};m._convertPointElevation=
function(E,v,r=v.elevationInfo,I=A.absoluteHeightElevationInfo){const {view:F}=this;if(!(u.isSome(E)&&v.coordinateHelper.hasZ()&&u.isSome(F)&&"3d"===F.type))return E;E=q.clone(E);E.z=A.getConvertedElevation(F,E,r,I);return E};D._createClass(f,[{key:"updating",get:function(){return this._engines.some(E=>E.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:E,touchSensitivityMultiplier:v}=
this.options,r=E*v;return r*r}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return f}(Q.EventedMixin(h.HandleOwner));g.__decorate([p.property({constructOnly:!0})],d.SnappingManager.prototype,"view",void 0);g.__decorate([p.property()],d.SnappingManager.prototype,"options",void 0);g.__decorate([p.property({readOnly:!0})],d.SnappingManager.prototype,"updating",null);g.__decorate([p.property()],d.SnappingManager.prototype,
"snappingEnginesFactory",void 0);g.__decorate([p.property()],d.SnappingManager.prototype,"_engines",void 0);g.__decorate([p.property()],d.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);g.__decorate([p.property()],d.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);d.SnappingManager=g.__decorate([W.subclass("esri.views.interactive.snapping.SnappingManager")],d.SnappingManager);var e;(function(c){c[c.MAIN=0]="MAIN";c[c.SCENE=1]="SCENE"})(e||(e={}));Object.defineProperties(d,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(d){d.SnappingDomain=void 0;var D=d.SnappingDomain||(d.SnappingDomain={});D[D.FEATURE=1]="FEATURE";D[D.SELF=2]="SELF";D[D.ALL=3]="ALL";Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],
function(d,D,g){d.defaultSnappingEnginesFactory=function(Q,h){return[new g.SelfSnappingEngine({view:Q,options:h}),new D.FeatureSnappingEngine({view:Q,options:h,spatialReference:Q.spatialReference})]};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/data/QueryEngineResult ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./snappingUtils ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K,z,t,n,w,G,e,c,f,m,E){function v(L,B,R,S,U,T,{coordinateHelper:O}){B=K.copy(J,B);B[0]+=R;B[1]+=S;B[2]+=U;R=E.vectorToScreenPoint(B,O.spatialReference,n.absoluteHeightElevationInfo,T);return e.screenDistance(R,L)}D.FeatureSnappingEngine=function(L){function B(S){S=L.call(this,S)||this;S.options=null;S._domain=G.SnappingDomain.FEATURE;S._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},
notes:{module:null,loader:null},scene:{module:null,loader:null}};return S}g._inheritsLoose(B,L);var R=B.prototype;R.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),p.sync);l.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",S=>this._updateLayerView(S.layer,S.layerView)),this.view.on("layerview-destroy",S=>this._updateLayerView(S.layer,null))])};R._updateLayerView=function(S,U){for(const [,T]of this.snappingSources)T.snappingSource.layerSource.layer===
S&&(T.layerView=U)};R.destroy=function(){this._set("options",null);for(const [,S]of this.snappingSources)S.destroy()};R.fetchCandidates=function(){var S=g._asyncToGenerator(function*(U,T,O,M){if(!(T&this._domain)||l.isNone(this.options)||!this.options.effectiveFeatureEnabled)return[];var X=[];T=this._computeScreeenSizeDistanceParameters(U,O);const ba={distance:T,point:U,coordinateHelper:O.coordinateHelper,types:this._types};for(const [,{snappingSource:ka,layerView:qa}]of this.snappingSources)!ka.layerSource.enabled||
l.isSome(qa)&&qa.suspended||X.push(ka.fetchCandidates(ba,M).then(xa=>xa.filter(wa=>!this._candidateIsExcluded(ka,wa,O.excludeFeature))));X=(yield C.eachAlwaysValues(X)).flat();this._addRightAngleCandidates(X,U,T,O);C.throwIfAborted(M);e.sortCandidatesInPlace(U,X,O.coordinateHelper);return X});return function(U,T,O,M){return S.apply(this,arguments)}}();R._addRightAngleCandidates=function(S,U,T,O){var M=l.isSome(O.vertexHandle)?O.vertexHandle.rightEdge?.rightVertex?.pos:l.isSome(O.editGeometryOperations)&&
"polygon"===O.editGeometryOperations.data.type?l.unwrap(O.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,X=l.isSome(O.vertexHandle)?O.vertexHandle.leftEdge?.leftVertex?.pos:l.isSome(O.editGeometryOperations)?l.unwrap(O.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,{view:ba}=this;M=e.convertPointElevation(M,ba,O);X=e.convertPointElevation(X,ba,O);ba=S.length;for(let ka=0;ka<ba;ka++)this._addRightAngleCandidate(S[ka],X,U,T,O,S),this._addRightAngleCandidate(S[ka],
M,U,T,O,S)};R._addRightAngleCandidate=function(S,U,T,O,M,X){var ba=S instanceof c.EdgeSnappingCandidate,ka=ba&&P.equals(S.constraint.start,S.constraint.end);l.isNone(U)||!ba||ka||(ba=S.constraint.closestTo(U),ka=(ba[0]-T[0])/O.x,T=(ba[1]-T[1])/O.y,1>=ka*ka+T*T&&(M=M.coordinateHelper,S=new m.RightAngleSnappingCandidate({coordinateHelper:M,targetPoint:ba,otherVertex:U,otherVertexType:m.OtherVertexType.NEXT,previousVertex:S.constraint.start,constraint:new w.VerticalHalfPlaneConstraint(M,U,ba),objectId:S.objectId,
elevationInfo:S.elevationInfo}),X.push(S)))};R._computeScreeenSizeDistanceParameters=function(S,U){let T=l.isSome(this.options)?this.options.distance*("touch"===U.pointer?this.options.touchSensitivityMultiplier:1):0;return l.isNone(this.view)?{x:T,y:T,z:T,distance:T}:"2d"===this.view.type?(T*=this.view.resolution,{x:T,y:T,z:T,distance:T}):this._computeScreenSizeDistanceParameters3D(S,T,this.view,U)};R._computeScreenSizeDistanceParameters3D=function(S,U,T,O){const {coordinateHelper:M,elevationInfo:X}=
O;var {spatialReference:ba}=M,ka=M.hasZ()?n.absoluteHeightElevationInfo:X;S=M.toXYZ(S,I);S[2]=n.getConvertedElevationFromVector(T,S,ba,ka,n.absoluteHeightElevationInfo);T.renderCoordsHelper.toRenderCoords(S,ba,F);ka=T.state.camera.computeScreenPixelSizeAt(F);const qa=ka*T.renderCoordsHelper.unitInMeters/T.mapCoordsHelper.unitInMeters,xa=U*qa,wa=E.vectorToScreenPoint(S,ba,n.absoluteHeightElevationInfo,T);ba=v(wa,S,qa,0,0,T,O);const Fa=v(wa,S,0,qa,0,T,O);T=v(wa,S,0,0,qa,T,O);return{x:0===ba?0:xa/ba,
y:0===Fa?0:xa/Fa,z:0===T?0:xa/T,distance:ka*U}};R._candidateIsExcluded=function(S,U,T){if(l.isNone(T))return!1;U=this._getCandidateObjectId(U);if(l.isNone(U))return!1;S=S.layerSource.layer;return"graphics"===S.type?T.uid===U:T.sourceLayer===S&&T.attributes&&"objectIdField"in S?T.attributes[S.objectIdField]===U:!1};R._getCandidateObjectId=function(S){return S instanceof f.FeatureSnappingCandidate?S.objectId:null};R._createSourceInfo=function(S){const U=this._createFeatureSnappingSourceType(S);if(l.isNone(U))return null;
if("loading"in U)return this.updatingHandles.addPromise(U.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const T=l.isSome(this.view)?this.view.allLayerViews.find(O=>O.layer===S.layer):null;return new r(U.source,T)};R._createFeatureSnappingSourceType=function(S){switch(S.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(S);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(S);
case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(S);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(S)}return null};R._createFeatureSnappingSourceSceneLayer=function(S){const {view:U}=this;if(l.isNone(U)||"3d"!==U.type)return null;const T=this._getSourceModule("scene");return l.isSome(T.module)?{source:new T.module.SceneLayerSnappingSource({layerSource:S,view:U})}:{loading:T.loader}};R._createFeatureSnappingSourceFeatureLayer=function(S){switch(S.layer.source.type){case "feature-layer":case "oriented-imagery":var U=
this._getSourceModule("featureService");return l.isSome(U.module)?{source:new U.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:S})}:{loading:U.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==S.layer.geometryType)return U=this._getSourceModule("featureCollection"),l.isSome(U.module)?{source:new U.module.FeatureCollectionSnappingSource({layerSource:S,view:this.view})}:{loading:U.loader}}return null};R._createFeatureSnappingSourceGraphicsLayer=
function(S){const U=this._getSourceModule("graphics");return l.isSome(U.module)?{source:new U.module.GraphicsSnappingSource({getGraphicsLayers:()=>[S.layer],spatialReference:this.spatialReference,view:this.view,layerSource:S})}:{loading:U.loader}};R._createFeatureSnappingSourceMapNotesLayer=function(S){const U=this._getSourceModule("notes");return l.isSome(U.module)?{source:new U.module.GraphicsSnappingSource({getGraphicsLayers:()=>l.isSome(S.layer.sublayers)?S.layer.sublayers.toArray():[],spatialReference:this.spatialReference,
view:this.view,layerSource:S})}:{loading:U.loader}};R._getSourceModule=function(S){const U=this._sourceModules[S];return l.isNone(U.loader)?(S=this._loadSourceModule(S).then(T=>{U.module=T}),U.loader=S,{module:U.module,loader:S}):{module:U.module,loader:U.loader}};R._loadSourceModule=function(S){const U=this.updatingHandles;switch(S){case "featureService":return U.addPromise(new Promise((T,O)=>d(["./featureSources/FeatureServiceSnappingSource"],T,O)));case "featureCollection":return U.addPromise(new Promise((T,
O)=>d(["./featureSources/FeatureCollectionSnappingSource"],T,O)));case "graphics":return U.addPromise(new Promise((T,O)=>d(["./featureSources/GraphicsSnappingSource"],T,O)));case "notes":return U.addPromise(new Promise((T,O)=>d(["./featureSources/GraphicsSnappingSource"],T,O)));case "scene":return U.addPromise(new Promise((T,O)=>d(["./featureSources/SceneLayerSnappingSource"],T,O)))}return null};g._createClass(B,[{key:"updating",get:function(){return u.someMap(this.snappingSources,({snappingSource:S})=>
S.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const S=this._get("snappingSources")||new Map,U=new Map;if(l.isSome(this.options)&&l.isSome(this.options.featureSources))for(const O of this.options.featureSources.items){const M=O.layer.uid;var T=S.get(M);T?(S.delete(M),U.set(M,T)):O.layer.loaded?(T=this._createSourceInfo(O),l.isSome(T)&&U.set(M,T)):this.updatingHandles.addPromise(O.layer.load())}for(const [,O]of S)O.destroy();return U}},{key:"_types",get:function(){return t.SnappingTypes.EDGE|
t.SnappingTypes.VERTEX}}]);return B}(h.HandleOwner);Q.__decorate([H.property({constructOnly:!0})],D.FeatureSnappingEngine.prototype,"spatialReference",void 0);Q.__decorate([H.property({constructOnly:!0})],D.FeatureSnappingEngine.prototype,"view",void 0);Q.__decorate([H.property()],D.FeatureSnappingEngine.prototype,"options",void 0);Q.__decorate([H.property({readOnly:!0})],D.FeatureSnappingEngine.prototype,"updating",null);Q.__decorate([H.property({readOnly:!0})],D.FeatureSnappingEngine.prototype,
"snappingSources",null);D.FeatureSnappingEngine=Q.__decorate([A.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],D.FeatureSnappingEngine);let r=function(){function L(B,R){this.snappingSource=B;this.layerView=R;this.handles=new q;R=this.snappingSource.layerSource.layer;"refresh"in R&&this.handles.add(R.on("refresh",()=>B.refresh()));this.handles.add([p.watch(()=>B.updating,S=>B.layerSource.updating=S,p.syncAndInitial),p.watch(()=>B.availability,S=>B.layerSource.availability=S,p.syncAndInitial)])}
L.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return L}();const I=z.create(),F=z.create(),J=z.create();Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/vec2":function(){define(["exports","./common"],function(d,D){function g(O,M){O[0]=M[0];O[1]=M[1];return O}function Q(O,M,X){O[0]=M;O[1]=X;return O}function h(O,M,X){O[0]=M[0]+X[0];O[1]=M[1]+X[1];return O}function q(O,M,X){O[0]=M[0]-X[0];O[1]=M[1]-X[1];return O}
function u(O,M,X){O[0]=M[0]*X[0];O[1]=M[1]*X[1];return O}function l(O,M,X){O[0]=M[0]/X[0];O[1]=M[1]/X[1];return O}function C(O,M){O[0]=Math.ceil(M[0]);O[1]=Math.ceil(M[1]);return O}function p(O,M){O[0]=Math.floor(M[0]);O[1]=Math.floor(M[1]);return O}function H(O,M,X){O[0]=Math.min(M[0],X[0]);O[1]=Math.min(M[1],X[1]);return O}function W(O,M,X){O[0]=Math.max(M[0],X[0]);O[1]=Math.max(M[1],X[1]);return O}function x(O,M){O[0]=Math.round(M[0]);O[1]=Math.round(M[1]);return O}function A(O,M,X){O[0]=M[0]*
X;O[1]=M[1]*X;return O}function P(O,M,X,ba){O[0]=M[0]+X[0]*ba;O[1]=M[1]+X[1]*ba;return O}function K(O,M){const X=M[0]-O[0];O=M[1]-O[1];return Math.sqrt(X*X+O*O)}function z(O,M){const X=M[0]-O[0];O=M[1]-O[1];return X*X+O*O}function t(O){const M=O[0];O=O[1];return Math.sqrt(M*M+O*O)}function n(O){const M=O[0];O=O[1];return M*M+O*O}function w(O,M){O[0]=-M[0];O[1]=-M[1];return O}function G(O,M){O[0]=1/M[0];O[1]=1/M[1];return O}function e(O,M){var X=M[0];const ba=M[1];X=X*X+ba*ba;0<X&&(X=1/Math.sqrt(X),
O[0]=M[0]*X,O[1]=M[1]*X);return O}function c(O,M){return O[0]*M[0]+O[1]*M[1]}function f(O,M,X){M=M[0]*X[1]-M[1]*X[0];O[0]=O[1]=0;O[2]=M;return O}function m(O,M,X,ba){const ka=M[0];M=M[1];O[0]=ka+ba*(X[0]-ka);O[1]=M+ba*(X[1]-M);return O}function E(O,M){M=M||1;const X=2*D.RANDOM()*Math.PI;O[0]=Math.cos(X)*M;O[1]=Math.sin(X)*M;return O}function v(O,M,X){const ba=M[0];M=M[1];O[0]=X[0]*ba+X[2]*M;O[1]=X[1]*ba+X[3]*M;return O}function r(O,M,X){const ba=M[0];M=M[1];O[0]=X[0]*ba+X[2]*M+X[4];O[1]=X[1]*ba+X[3]*
M+X[5];return O}function I(O,M,X){const ba=M[0];M=M[1];O[0]=X[0]*ba+X[3]*M+X[6];O[1]=X[1]*ba+X[4]*M+X[7];return O}function F(O,M,X){const ba=M[0];M=M[1];O[0]=X[0]*ba+X[4]*M+X[12];O[1]=X[1]*ba+X[5]*M+X[13];return O}function J(O,M,X,ba){const ka=M[0]-X[0];M=M[1]-X[1];const qa=Math.sin(ba);ba=Math.cos(ba);O[0]=ka*ba-M*qa+X[0];O[1]=ka*qa+M*ba+X[1];return O}function L(O,M){var X=O[0];O=O[1];const ba=M[0];M=M[1];let ka=X*X+O*O;0<ka&&(ka=1/Math.sqrt(ka));let qa=ba*ba+M*M;0<qa&&(qa=1/Math.sqrt(qa));X=(X*
ba+O*M)*ka*qa;return 1<X?0:-1>X?Math.PI:Math.acos(X)}function B(O){return"vec2("+O[0]+", "+O[1]+")"}function R(O,M){return O[0]===M[0]&&O[1]===M[1]}function S(O,M){const X=O[0];O=O[1];const ba=M[0];M=M[1];const ka=D.getEpsilon();return Math.abs(X-ba)<=ka*Math.max(1,Math.abs(X),Math.abs(ba))&&Math.abs(O-M)<=ka*Math.max(1,Math.abs(O),Math.abs(M))}function U(O,M,X,ba,ka){let qa=M[0]-X[0];X=M[1]-X[1];ka=(ba[0]*qa+ba[1]*X)*(ka-1);qa=ba[0]*ka;X=ba[1]*ka;O[0]=M[0]+qa;O[1]=M[1]+X;return O}const T=Object.freeze(Object.defineProperty({__proto__:null,
copy:g,set:Q,add:h,subtract:q,multiply:u,divide:l,ceil:C,floor:p,min:H,max:W,round:x,scale:A,scaleAndAdd:P,distance:K,squaredDistance:z,length:t,squaredLength:n,negate:w,inverse:G,normalize:e,dot:c,cross:f,lerp:m,random:E,transformMat2:v,transformMat2d:r,transformMat3:I,transformMat4:F,rotate:J,angle:L,str:B,exactEquals:R,equals:S,projectAndScale:U,len:t,sub:q,mul:u,div:l,dist:K,sqrDist:z,sqrLen:n},Symbol.toStringTag,{value:"Module"}));d.add=h;d.angle=L;d.ceil=C;d.copy=g;d.cross=f;d.dist=K;d.distance=
K;d.div=l;d.divide=l;d.dot=c;d.equals=S;d.exactEquals=R;d.floor=p;d.inverse=G;d.len=t;d.length=t;d.lerp=m;d.max=W;d.min=H;d.mul=u;d.multiply=u;d.negate=w;d.normalize=e;d.projectAndScale=U;d.random=E;d.rotate=J;d.round=x;d.scale=A;d.scaleAndAdd=P;d.set=Q;d.sqrDist=z;d.sqrLen=n;d.squaredDistance=z;d.squaredLength=n;d.str=B;d.sub=q;d.subtract=q;d.transformMat2=v;d.transformMat2d=r;d.transformMat3=I;d.transformMat4=F;d.vec2=T})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P){function K(w,G,e,c){const f=c.x-e.x;c=c.y-e.y;G=Math.min(1,Math.max(0,((G.x-e.x)*f+(G.y-e.y)*c)/(f*f+c*c)));w.x=e.x+f*G;w.y=e.y+c*G}function z(w,G){return w?G?4:3:G?3:2}let t=function(){function w(e,c,f){this.items=e;this.query=c;this.geometryType=f.geometryType;this.hasM=f.hasM;this.hasZ=f.hasZ;this.fieldsIndex=f.fieldsIndex;this.objectIdField=f.objectIdField;this.spatialReference=f.spatialReference;this.featureAdapter=f.featureAdapter}var G=w.prototype;G.createQueryResponseForCount=
function(){const e=new C(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const {groupByFieldsForStatistics:c,having:f,outStatistics:m}=this.query;if(!c?.length)return 1;const E=new Map,v=new Map,r=new Set;for(const J of m){var {statisticType:I}=J;I="exceedslimit"!==I?J.onStatisticField:void 0;if(!v.has(I)){var F=[];for(const L of c){const B=this._getAttributeValues(e,L,E);F.push(B)}v.set(I,this._calculateUniqueValues(F,e.returnDistinctValues))}I=
v.get(I);for(const L in I){const {data:B,items:R}=I[L];F=B.join(",");f&&!e.validateItems(R,f)||r.add(F)}}return r.size};G.createQueryResponse=function(){var e=g._asyncToGenerator(function*(){let c;c=this.query.outStatistics?this.query.outStatistics.some(f=>"exceedslimit"===f.statisticType)?this._createExceedsLimitQueryResponse(this.query):yield this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);this.query.returnQueryGeometry&&(l.isValid(this.query.outSR)&&
!l.equals(this.query.geometry.spatialReference,this.query.outSR)?c.queryGeometry=W.cleanFromGeometryEngine({spatialReference:this.query.outSR,...p.project(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):c.queryGeometry=W.cleanFromGeometryEngine({spatialReference:this.query.outSR,...this.query.geometry}));return c});return function(){return e.apply(this,arguments)}}();G.createSnappingResponse=function(e,c){const f=this.featureAdapter,m=z(this.hasZ,this.hasM),{point:E}=
e,v="number"===typeof e.distance?e.distance:e.distance.x,r="number"===typeof e.distance?e.distance:e.distance.y,I={candidates:[]},F="esriGeometryPolygon"===this.geometryType;c=this._getPointCreator(E,null!=E.z,null!=E.m,this.spatialReference,c);const J=new n(null,0),L=new n(null,0),B={x:0,y:0,z:0};for(const X of this.items){var R=f.getGeometry(X);if(Q.isNone(R))continue;const {coords:ba,lengths:ka}=R;J.coords=ba;L.coords=ba;if(e.types&D.SnappingTypes.EDGE){R=0;for(var S=0;S<ka.length;S++){var U=ka[S];
for(var T=0;T<U;T++,R+=m){var O=J;O.coordsIndex=R;if(T!==U-1){const qa=L;qa.coordsIndex=R+m;const xa=B;K(B,E,O,qa);var M=(E.x-xa.x)/v;const wa=(E.y-xa.y)/r;M=M*M+wa*wa;1>=M&&I.candidates.push(H.makeEdgeCandidate(f.getObjectId(X),c(xa),Math.sqrt(M),c(O),c(qa)))}}}}if(e.types&D.SnappingTypes.VERTEX)for(R=F?ba.length-m:ba.length,S=0;S<R;S+=m)U=J,U.coordsIndex=S,T=(E.x-U.x)/v,O=(E.y-U.y)/r,T=T*T+O*O,1>=T&&I.candidates.push(H.makeVertexCandidate(f.getObjectId(X),c(U),Math.sqrt(T)))}I.candidates.sort((X,
ba)=>X.distance-ba.distance);return I};G._getPointCreator=function(e,c,f,m,E){const v=Q.isSome(E)&&!l.equals(m,E)?F=>p.project(F,m,E):F=>F,{hasZ:r}=this,I=e.m;return c&&f?r?({x:F,y:J,z:L})=>v({x:F,y:J,z:L,m:I}):({x:F,y:J})=>v({x:F,y:J,z:0,m:I}):c?r?({x:F,y:J,z:L})=>v({x:F,y:J,z:L}):({x:F,y:J})=>v({x:F,y:J,z:0}):f?({x:F,y:J})=>v({x:F,y:J,m:I}):({x:F,y:J})=>v({x:F,y:J})};G.createSummaryStatisticsResponse=function(){var e=g._asyncToGenerator(function*(c){const {field:f,valueExpression:m,normalizationField:E,
normalizationType:v,normalizationTotal:r,minValue:I,maxValue:F,scale:J}=c;c=this.fieldsIndex.isDateField(f);var L=yield this._getDataValues({field:f,valueExpression:m,normalizationField:E,normalizationType:v,normalizationTotal:r,scale:J});const B=A.isNullCountSupported({normalizationType:v,normalizationField:E,minValue:I,maxValue:F}),R=this.fieldsIndex.get(f),S={value:.5,fieldType:R?.type};L=x.isStringField(R)?A.calculateStringStatistics({values:L,supportsNullCount:B,percentileParams:S}):A.calculateStatistics({values:L,
minValue:I,maxValue:F,useSampleStdDev:!v,supportsNullCount:B,percentileParams:S});return A.processSummaryStatisticsResult(L,c)});return function(c){return e.apply(this,arguments)}}();G.createUniqueValuesResponse=function(){var e=g._asyncToGenerator(function*(c){const {field:f,valueExpression:m,domains:E,returnAllCodedValues:v,scale:r}=c;var I=yield this._getDataValues({field:f,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,valueExpression:m,scale:r});I=A.calculateUniqueValuesCount(I);
return A.createUVResult(I,E,v,c.fieldDelimiter)});return function(c){return e.apply(this,arguments)}}();G.createClassBreaksResponse=function(){var e=g._asyncToGenerator(function*(c){const {field:f,valueExpression:m,normalizationField:E,normalizationType:v,normalizationTotal:r,classificationMethod:I,standardDeviationInterval:F,minValue:J,maxValue:L,numClasses:B,scale:R}=c;c=yield this._getDataValues({field:f,valueExpression:m,normalizationField:E,normalizationType:v,normalizationTotal:r,scale:R});
c=A.calculateClassBreaks(c,{field:f,normalizationField:E,normalizationType:v,normalizationTotal:r,classificationMethod:I,standardDeviationInterval:F,minValue:J,maxValue:L,numClasses:B});return A.resolveCBResult(c,I)});return function(c){return e.apply(this,arguments)}}();G.createHistogramResponse=function(){var e=g._asyncToGenerator(function*(c){const {field:f,valueExpression:m,normalizationField:E,normalizationType:v,normalizationTotal:r,classificationMethod:I,standardDeviationInterval:F,minValue:J,
maxValue:L,numBins:B,scale:R}=c;c=yield this._getDataValues({field:f,valueExpression:m,normalizationField:E,normalizationType:v,normalizationTotal:r,scale:R});return A.calculateHistogram(c,{field:f,normalizationField:E,normalizationType:v,normalizationTotal:r,classificationMethod:I,standardDeviationInterval:F,minValue:J,maxValue:L,numBins:B})});return function(c){return e.apply(this,arguments)}}();G._sortFeatures=function(e,c,f){if(1<e.length&&c&&c.length)for(const m of c.reverse()){c=m.split(" ");
const E=c[0],v=this.fieldsIndex.get(E);c=c[1]&&"desc"===c[1].toLowerCase();const r=A.getAttributeComparator(v?.type,c);e.sort((I,F)=>{I=f(I,E,v);F=f(F,E,v);return r(I,F)})}};G._createFeatureQueryResponse=function(e){const c=this.items,{geometryType:f,hasM:m,hasZ:E,objectIdField:v,spatialReference:r}=this,{outFields:I,outSR:F,quantizationParameters:J,resultRecordCount:L,resultOffset:B,returnZ:R,returnM:S}=e,U=null!=L?c.length>(B||0)+L:!1,T=I&&(I.includes("*")?[...this.fieldsIndex.fields]:I.map(O=>
this.fieldsIndex.get(O)));return{exceededTransferLimit:U,features:this._createFeatures(e,c),fields:T,geometryType:f,hasM:m&&S,hasZ:E&&R,objectIdFieldName:v,spatialReference:W.cleanFromGeometryEngine(F?F:r),transform:J&&u.toQuantizationTransform(J)||null}};G._createFeatures=function(e,c){const f=new C(e,this.featureAdapter,this.fieldsIndex),{hasM:m,hasZ:E}=this,{orderByFields:v,quantizationParameters:r,returnGeometry:I,returnCentroid:F,maxAllowableOffset:J,resultOffset:L,resultRecordCount:B,returnZ:R=
!1,returnM:S=!1}=e,U=E&&R,T=m&&S;e=[];var O=0;c=[...c];this._sortFeatures(c,v,(ba,ka,qa)=>f.getFieldValue(ba,ka,qa));if(I||F){var M=u.toQuantizationTransform(r);if(I&&!F)for(var X of c)e[O++]={attributes:f.getAttributes(X),geometry:W.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(X),J,M,U,T)};else if(!I&&F)for(const ba of c)e[O++]={attributes:f.getAttributes(ba),centroid:W.transformCentroid(this,this.featureAdapter.getCentroid(ba,this),M)};else for(const ba of c)e[O++]=
{attributes:f.getAttributes(ba),centroid:W.transformCentroid(this,this.featureAdapter.getCentroid(ba,this),M),geometry:W.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ba),J,M,U,T)}}else for(M of c)(X=f.getAttributes(M))&&(e[O++]={attributes:X});O=L||0;null!=B&&(e=e.slice(O,Math.min(e.length,O+B)));return e};G._createExceedsLimitQueryResponse=function(e){var c=!1;let f=Number.POSITIVE_INFINITY,m=Number.POSITIVE_INFINITY;c=Number.POSITIVE_INFINITY;for(const E of e.outStatistics)if("exceedslimit"===
E.statisticType){f=null!=E.maxPointCount?E.maxPointCount:Number.POSITIVE_INFINITY;m=null!=E.maxRecordCount?E.maxRecordCount:Number.POSITIVE_INFINITY;c=null!=E.maxVertexCount?E.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)c=this.items.length>f;else if(this.items.length>m)c=!0;else{e=z(this.hasZ,this.hasM);const E=this.featureAdapter;c=this.items.reduce((v,r)=>{r=E.getGeometry(r);return v+(Q.isSome(r)&&r.coords.length||0)},0)/e>c}return{fields:[{name:"exceedslimit",
type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(c)}}]}};G._createStatisticsQueryResponse=function(){var e=g._asyncToGenerator(function*(c){var f={attributes:{}};const m=[],E=new Map,v=new Map,r=new Map,I=new Map,F=new C(c,this.featureAdapter,this.fieldsIndex);var J=c.outStatistics;const {groupByFieldsForStatistics:L,having:B,orderByFields:R}=c;c=L&&L.length;const S=!!c,U=S&&L[0],T=S&&!this.fieldsIndex.get(U);
for(const ka of J){const {outStatisticFieldName:qa,statisticType:xa}=ka;J=ka;var O="exceedslimit"!==xa?ka.onStatisticField:void 0;const wa="percentile_disc"===xa||"percentile_cont"===xa,Fa="EnvelopeAggregate"===xa||"CentroidAggregate"===xa||"ConvexHullAggregate"===xa,Ya=S&&1===c&&(O===U||T)&&"count"===xa;if(S){if(!r.has(O)){var M=[];for(const Ka of L){var X=this._getAttributeValues(F,Ka,E);M.push(X)}r.set(O,this._calculateUniqueValues(M,Fa?!1:F.returnDistinctValues))}M=r.get(O);for(const Ka in M){const {count:ya,
data:Ea,items:pa,itemPositions:V}=M[Ka];X=Ea.join(",");if(!B||F.validateItems(pa,B)){const Y=I.get(X)||{attributes:{}};if(Fa){Y.aggregateGeometries||(Y.aggregateGeometries={});const {aggregateGeometries:aa,outStatisticFieldName:ha}=yield this._getAggregateGeometry(J,pa);Y.aggregateGeometries[ha]=aa}else{var ba=null;if(Ya)ba=ya;else{const aa=this._getAttributeValues(F,O,E);ba=V.map(ha=>aa[ha]);ba=wa&&"statisticParameters"in J?this._getPercentileValue(J,ba):this._getStatisticValue(J,ba,null,F.returnDistinctValues)}Y.attributes[qa]=
ba}let Z=0;L.forEach((aa,ha)=>Y.attributes[this.fieldsIndex.get(aa)?aa:`EXPR_${++Z}`]=Ea[ha]);I.set(X,Y)}}}else if(Fa){f.aggregateGeometries||(f.aggregateGeometries={});const {aggregateGeometries:Ka,outStatisticFieldName:ya}=yield this._getAggregateGeometry(J,this.items);f.aggregateGeometries[ya]=Ka}else O=this._getAttributeValues(F,O,E),f.attributes[qa]=wa&&"statisticParameters"in J?this._getPercentileValue(J,O):this._getStatisticValue(J,O,v,F.returnDistinctValues);m.push({name:qa,alias:qa,type:"esriFieldTypeDouble"})}f=
S?Array.from(I.values()):[f];this._sortFeatures(f,R,(ka,qa)=>ka.attributes[qa]);return{fields:m,features:f}});return function(c){return e.apply(this,arguments)}}();G._getAggregateGeometry=function(){var e=g._asyncToGenerator(function*(c,f){var m=yield new Promise((R,S)=>d(["../../../geometry/geometryEngineJSON"],R,S));const {statisticType:E,outStatisticFieldName:v}=c,{featureAdapter:r,spatialReference:I,geometryType:F,hasZ:J,hasM:L}=this;f=f.map(R=>W.getGeometry(F,J,L,r.getGeometry(R)));const B=m.convexHull(I,
f,!0)[0];c={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===E?(m=B?q.getPolygonExtent(B):q.getGeometryExtent(m.union(I,f)),c.aggregateGeometries={...m,spatialReference:I},c.outStatisticFieldName=v||"extent"):"CentroidAggregate"===E?(m=B?h.polygonCentroid(B):h.extentCentroid(q.getGeometryExtent(m.union(I,f))),c.aggregateGeometries={x:m[0],y:m[1],spatialReference:I},c.outStatisticFieldName=v||"centroid"):"ConvexHullAggregate"===E&&(c.aggregateGeometries=B,c.outStatisticFieldName=
v||"convexHull");return c});return function(c,f){return e.apply(this,arguments)}}();G._getStatisticValue=function(e,c,f,m){const {onStatisticField:E,statisticType:v}=e;e=null;e=f?.has(E)?f.get(E):x.isStringField(this.fieldsIndex.get(E))?A.calculateStringStatistics({values:c,returnDistinct:m}):A.calculateStatistics({values:c,minValue:null,maxValue:null,useSampleStdDev:!0});f&&f.set(E,e);return e["var"===v?"variance":v]};G._getPercentileValue=function(e,c){const {onStatisticField:f,statisticParameters:m,
statisticType:E}=e,{value:v,orderBy:r}=m;e=this.fieldsIndex.get(f);return A.calculatePercentile(c,{value:v,orderBy:r,fieldType:e?.type,isDiscrete:"percentile_disc"===E})};G._getAttributeValues=function(e,c,f){if(f.has(c))return f.get(c);const m=this.fieldsIndex.get(c),E=this.items.map(v=>e.getFieldValue(v,c,m));f.set(c,E);return E};G._getAttributeDataValues=function(e,c){return this.items.map(f=>e.getDataValue(f,{field:c.field,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:c.normalizationField,
normalizationType:c.normalizationType,normalizationTotal:c.normalizationTotal}))};G._getAttributeExpressionValues=function(){var e=g._asyncToGenerator(function*(c,f,m){const {arcadeUtils:E}=yield P.loadArcade();f=E.createFunction(f);m=m&&E.getViewInfo(m);return c.getExpressionValues(this.items,f,m,E)});return function(c,f,m){return e.apply(this,arguments)}}();G._calculateUniqueValues=function(e,c){const f={},m=this.items,E=m.length;for(let v=0;v<E;v++){const r=m[v],I=[];for(const J of e)I.push(J[v]);
const F=I.join(",");c?null==f[F]&&(f[F]={count:1,data:I,items:[r],itemPositions:[v]}):null==f[F]?f[F]={count:1,data:I,items:[r],itemPositions:[v]}:(f[F].count++,f[F].items.push(r),f[F].itemPositions.push(v))}return f};G._getDataValues=function(){var e=g._asyncToGenerator(function*(c){const f=new C(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:m,field:E,normalizationField:v,normalizationType:r,normalizationTotal:I,scale:F}=c,J=m?{viewingMode:"map",scale:F,spatialReference:this.query.outSR||
this.spatialReference}:null;return m?this._getAttributeExpressionValues(f,m,J):this._getAttributeDataValues(f,{field:E,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:v,normalizationType:r,normalizationTotal:I})});return function(c){return e.apply(this,arguments)}}();g._createClass(w,[{key:"size",get:function(){return this.items.length}}]);return w}();D.SnappingTypes=void 0;(function(w){w[w.NONE=0]="NONE";w[w.EDGE=1]="EDGE";w[w.VERTEX=2]="VERTEX"})(D.SnappingTypes||
(D.SnappingTypes={}));let n=function(){function w(G,e){this.coords=G;this.coordsIndex=e}g._createClass(w,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return w}();D.QueryEngineResult=t;Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe",
"./jsonUtils"],function(d,D,g){function Q({scale:v,translate:r},I){return Math.round((I-r[0])/v[0])}function h({scale:v,translate:r},I){return Math.round((r[1]-I)/v[1])}function q(v,r,I){const F=[];let J,L,B,R;for(let S=0;S<I.length;S++){const U=I[S];if(0<S){if(B=Q(v,U[0]),R=h(v,U[1]),B!==J||R!==L)F.push(r(U,B-J,R-L)),J=B,L=R}else J=Q(v,U[0]),L=h(v,U[1]),F.push(r(U,J,L))}return 0<F.length?F:null}function u(v,r,I,F){return q(v,I?F?E:m:F?m:f,r)}function l(v,r,I,F){const J=[];I=I?F?E:m:F?m:f;for(F=0;F<
r.length;F++){const L=q(v,I,r[F]);L&&3<=L.length&&J.push(L)}return J.length?J:null}function C(v,r,I,F){const J=[];I=I?F?E:m:F?m:f;for(F=0;F<r.length;F++){const L=q(v,I,r[F]);L&&2<=L.length&&J.push(L)}return J.length?J:null}function p({scale:v,translate:r},I){return I*v[0]+r[0]}function H({scale:v,translate:r},I){return r[1]-I*v[1]}function W(v,r,I){const F=Array(I.length);if(!I.length)return F;const [J,L]=v.scale;let B=p(v,I[0][0]);v=H(v,I[0][1]);F[0]=r(I[0],B,v);for(let R=1;R<I.length;R++){const S=
I[R];B+=S[0]*J;v-=S[1]*L;F[R]=r(S,B,v)}return F}function x(v,r,I){const F=Array(I.length);for(let J=0;J<I.length;J++)F[J]=W(v,r,I[J]);return F}function A(v,r,I,F){return W(v,I?F?E:m:F?m:f,r)}function P(v,r,I,F){return x(v,I?F?E:m:F?m:f,r)}function K(v,r,I,F){return x(v,I?F?E:m:F?m:f,r)}function z(v,r,I){let [F,J]=I[0],L=Math.min(F,r[0]),B=Math.min(J,r[1]),R=Math.max(F,r[2]);r=Math.max(J,r[3]);for(let S=1;S<I.length;S++){const [U,T]=I[S];F+=U;J+=T;0>U&&(L=Math.min(L,F));0<U&&(R=Math.max(R,F));0>T?
B=Math.min(B,J):0<T&&(r=Math.max(r,J))}v[0]=L;v[1]=B;v[2]=R;v[3]=r;return v}function t(v,r){if(!r.length)return null;v[0]=v[1]=Number.POSITIVE_INFINITY;v[2]=v[3]=Number.NEGATIVE_INFINITY;for(let I=0;I<r.length;I++)z(v,v,r[I]);return v}function n(v,r,I,F,J){r.xmin=Q(v,I.xmin);r.ymin=h(v,I.ymin);r.xmax=Q(v,I.xmax);r.ymax=h(v,I.ymax);r!==I&&(F&&(r.zmin=I.zmin,r.zmax=I.zmax),J&&(r.mmin=I.mmin,r.mmax=I.mmax));return r}function w(v,r,I,F,J){r.points=u(v,I.points,F,J)??[];return r}function G(v,r,I,F,J){r.x=
Q(v,I.x);r.y=h(v,I.y);r!==I&&(F&&(r.z=I.z),J&&(r.m=I.m));return r}function e(v,r,I,F,J){v=l(v,I.rings,F,J);if(!v)return null;r.rings=v;return r}function c(v,r,I,F,J){v=C(v,I.paths,F,J);if(!v)return null;r.paths=v;return r}const f=(v,r,I)=>[r,I],m=(v,r,I)=>[r,I,v[2]],E=(v,r,I)=>[r,I,v[2],v[3]];d.equals=function(v,r){if(v===r||null==v&&null==r)return!0;if(null==v||null==r)return!1;let I,F,J,L;v&&"upperLeft"===v.originPosition?(I=v.translate[0],F=v.translate[1],v=v.scale[0]):(I=D.isSome(v.extent)?v.extent.xmin:
0,F=D.isSome(v.extent)?v.extent.ymax:0,v=v.tolerance);r&&"upperLeft"===r.originPosition?(J=r.translate[0],L=r.translate[1],r=r.scale[0]):(J=D.isSome(r.extent)?r.extent.xmin:0,L=D.isSome(r.extent)?r.extent.ymax:0,r=r.tolerance);return I===J&&F===L&&v===r};d.getQuantizedBoundsCoordsArray=z;d.getQuantizedBoundsCoordsArrayArray=t;d.getQuantizedBoundsPaths=function(v){return t([0,0,0,0],v)};d.getQuantizedBoundsPoints=function(v){const r=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,
Number.NEGATIVE_INFINITY];return z(r,r,v)};d.getQuantizedBoundsRings=function(v){return t([0,0,0,0],v)};d.quantizeBounds=function(v,r,I){r[0]=Q(v,I[0]);r[3]=h(v,I[1]);r[2]=Q(v,I[2]);r[1]=h(v,I[3]);return r};d.quantizeExtent=n;d.quantizeGeometry=function(v,r){return v&&r?g.isPoint(r)?G(v,{},r,!1,!1):g.isPolyline(r)?c(v,{},r,!1,!1):g.isPolygon(r)?e(v,{},r,!1,!1):g.isMultipoint(r)?w(v,{},r,!1,!1):g.isExtent(r)?n(v,{},r,!1,!1):null:null};d.quantizeMultipoint=w;d.quantizePaths=C;d.quantizePoint=G;d.quantizePoints=
u;d.quantizePolygon=e;d.quantizePolyline=c;d.quantizeRings=l;d.quantizeX=Q;d.quantizeY=h;d.toQuantizationTransform=function(v){return v?{originPosition:"upper-left"===v.originPosition?"upperLeft":"lower-left"===v.originPosition?"lowerLeft":v.originPosition,scale:v.tolerance?[v.tolerance,v.tolerance]:[1,1],translate:D.isSome(v.extent)?[v.extent.xmin,v.extent.ymax]:[0,0]}:null};d.unquantizeBounds=function(v,r,I){return I?(r[0]=p(v,I[0]),r[1]=H(v,I[3]),r[2]=p(v,I[2]),r[3]=H(v,I[1]),r):[p(v,r[0]),H(v,
r[3]),p(v,r[2]),H(v,r[1])]};d.unquantizeCoordsArray=W;d.unquantizeCoordsArrayArray=x;d.unquantizeExtent=function(v,r,I,F,J){r.xmin=p(v,I.xmin);r.ymin=H(v,I.ymin);r.xmax=p(v,I.xmax);r.ymax=H(v,I.ymax);r!==I&&(F&&(r.zmin=I.zmin,r.zmax=I.zmax),J&&(r.mmin=I.mmin,r.mmax=I.mmax));return r};d.unquantizeMultipoint=function(v,r,I,F,J){D.isSome(I)&&(r.points=A(v,I.points,F,J));return r};d.unquantizePaths=P;d.unquantizePoint=function(v,r,I,F,J){if(D.isNone(I))return r;r.x=p(v,I.x);r.y=H(v,I.y);r!==I&&(F&&(r.z=
I.z),J&&(r.m=I.m));return r};d.unquantizePoints=A;d.unquantizePolygon=function(v,r,I,F,J){D.isSome(I)&&(r.rings=K(v,I.rings,F,J));return r};d.unquantizePolyline=function(v,r,I,F,J){D.isSome(I)&&(r.paths=P(v,I.paths,F,J));return r};d.unquantizeRings=K;d.unquantizeX=p;d.unquantizeY=H;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../core/maybe","./attributeSupport","../../../statistics/utils"],
function(d,D,g){return function(){function Q(q,u,l){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=q.returnDistinctValues??!1;this.fieldsIndex=l;this.featureAdapter=u;if((u=q.outFields)&&!u.includes("*")){this.outFields=u;q=0;for(const p of u){var C=D.getExpressionFromFieldName(p);C=(u=this.fieldsIndex.get(C))?null:D.getWhereClause(C,l);u=u?u.name:D.getAliasFromFieldName(p)||`FIELD_EXP_${q++}`;this._fieldDataCache.set(p,{alias:u,clause:C})}}}var h=Q.prototype;
h.countDistinctValues=function(q){if(!this.returnDistinctValues)return q.length;q.forEach(u=>this.getAttributes(u));return this._returnDistinctMap.size};h.getAttributes=function(q){q=this._processAttributesForOutFields(q);return this._processAttributesForDistinctValues(q)};h.getFieldValue=function(q,u,l){const C=l?l.name:u;let p=null;this._fieldDataCache.has(C)?p=this._fieldDataCache.get(C).clause:l||(p=D.getWhereClause(u,this.fieldsIndex),this._fieldDataCache.set(C,{alias:C,clause:p}));return l?
this.featureAdapter.getAttribute(q,C):p.calculateValue(q,this.featureAdapter)};h.getDataValue=function(q,u){const l=u.normalizationType,C=u.normalizationTotal;let p=this.getFieldValue(q,u.field,this.fieldsIndex.get(u.field));u.field2&&(p=`${g.processNullValue(p)}${u.fieldDelimiter}${g.processNullValue(this.getFieldValue(q,u.field2,this.fieldsIndex.get(u.field2)))}`,u.field3&&(p=`${p}${u.fieldDelimiter}${g.processNullValue(this.getFieldValue(q,u.field3,this.fieldsIndex.get(u.field3)))}`));l&&Number.isFinite(p)&&
(q="field"===l&&u.normalizationField?this.getFieldValue(q,u.normalizationField,this.fieldsIndex.get(u.normalizationField)):null,p=g.getNormalizedValue(p,l,q,C));return p};h.getExpressionValue=function(q,u,l,C){q={attributes:this.featureAdapter.getAttributes(q),layer:{fields:this.fieldsIndex.fields}};l=C.createExecContext(q,l);return C.executeFunction(u,l)};h.getExpressionValues=function(q,u,l,C){const p={fields:this.fieldsIndex.fields};return q.map(H=>{H={attributes:this.featureAdapter.getAttributes(H),
layer:p};H=C.createExecContext(H,l);return C.executeFunction(u,H)})};h.validateItem=function(q,u){this._fieldDataCache.has(u)||this._fieldDataCache.set(u,{alias:u,clause:D.getWhereClause(u,this.fieldsIndex)});return this._fieldDataCache.get(u).clause.testFeature(q,this.featureAdapter)};h.validateItems=function(q,u){this._fieldDataCache.has(u)||this._fieldDataCache.set(u,{alias:u,clause:D.getWhereClause(u,this.fieldsIndex)});return this._fieldDataCache.get(u).clause.testSet(q,this.featureAdapter)};
h._processAttributesForOutFields=function(q){const u=this.outFields;if(!u||!u.length)return this.featureAdapter.getAttributes(q);const l={};for(const C of u){const {alias:p,clause:H}=this._fieldDataCache.get(C);l[p]=H?H.calculateValue(q,this.featureAdapter):this.featureAdapter.getAttribute(q,p)}return l};h._processAttributesForDistinctValues=function(q){if(d.isNone(q)||!this.returnDistinctValues)return q;var u=this.outFields,l=[];if(u)for(const p of u){var {alias:C}=this._fieldDataCache.get(p);l.push(q[C])}else for(C in q)l.push(q[C]);
u=`${(u||["*"]).join(",")}=${l.join(",")}`;l=this._returnDistinctMap.get(u)||0;this._returnDistinctMap.set(u,++l);return 1<l?null:q};return Q}()})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(d,D,g){function Q(C,p){return C?u.get(C,p):null}function h(C,p,H,W=!0){const x=[];for(const A of p)if("*"!==A&&!C.has(A))if(W){p=q(A);try{const P=Q(p,C);if(!P)throw new D("feature-store:unsupported-query","invalid SQL expression",
{where:p});if(!P.isStandardized)throw new D("feature-store:unsupported-query","expression is not standard",{clause:P});h(C,P.fieldNames,"expression contains missing fields")}catch(P){if((p=P&&P.details)&&(p.clause||p.where))throw P;p&&p.missingFields?x.push(...p.missingFields):x.push(A)}}else x.push(A);if(x.length)throw new D("feature-store:unsupported-query",H,{missingFields:x});}function q(C){return C.split(" as ")[0]}const u=new g.WhereClauseCache(50,500),l=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));
d.getAliasFromFieldName=function(C){return C.split(" as ")[1]};d.getExpressionFromFieldName=q;d.getWhereClause=Q;d.hasInvalidFieldType=function(C,p){return(C=p.get(C))?!l.has(C.type):!1};d.validateFields=h;d.validateHaving=function(C,p,H){if(!p)return!0;const W=u.get(p,C);if(!W)throw new D("feature-store:unsupported-query","invalid SQL expression",{having:p});if(!W.isAggregate)throw new D("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:p});h(C,W.fieldNames,
"having contains missing fields");if(!W.getExpressions().every(x=>{const {aggregateType:A,field:P}=x,K=C.has(P)&&C.get(P).name;return H.some(z=>{const {onStatisticField:t,statisticType:n}=z;return(C.has(t)&&C.get(t).name)===K&&n.toLowerCase().trim()===A})}))throw new D("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:p});return!0};d.validateWhere=function(C,p){if(!p)return!0;const H=u.get(p,C);if(!H)throw new D("feature-store:unsupported-query",
"invalid SQL expression",{where:p});if(!H.isStandardized)throw new D("feature-store:unsupported-query","where clause is not standard",{where:p});h(C,H.fieldNames,"where clause contains missing fields");return!0};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../ItemCache","./WhereClause"],function(d,D,g){let Q=function(){function h(q,u){this._cache=new D(q);this._invalidCache=new D(u)}h.prototype.get=
function(q,u){const l=`${u.uid}:${q}`,C=this._cache.get(l);if(C)return C;if(void 0!==this._invalidCache.get(l))return null;try{const p=g.WhereClause.create(q,u);this._cache.put(l,p);return p}catch{return this._invalidCache.put(l,null),null}};return h}();d.WhereClauseCache=Q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(d){return function(){function D(Q,h){this._storage=new d.MemCacheStorage;
this._storage.maxSize=Q;h&&this._storage.registerRemoveFunc("",h)}var g=D.prototype;g.put=function(Q,h){this._storage.put(Q,h,1,1)};g.pop=function(Q){return this._storage.pop(Q)};g.get=function(Q){return this._storage.get(Q)};g.clear=function(){this._storage.clearAll()};g.destroy=function(){this._storage.destroy()};return D}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(d,D,g,Q,h,q){function u(J,L){J+="";return J.length>=L?J:Array(L-J.length+1).join("0")+J}function l(J,L,B="0",R="0",S="0",U="0",T="",O="0",M="0"){return"+"===T||"-"===T?(J=`${u(parseInt(J,10),4)}-${u(parseInt(L,10),2)}-${u(parseInt(B,10),2)}`,L="",10>parseFloat(U)&&(L="0"),R=`${u(parseInt(R,10),2)}:${u(parseInt(S,10),2)}:${L+parseFloat(U).toString()}`,T=`${T}${u(parseInt(O,10),2)}:${u(parseInt(M,10),2)}`,new Date(J+"T"+R+T)):new Date(parseInt(J,10),parseInt(L,10)-1,parseInt(B,10),parseInt(R,
10),parseInt(S,10),parseFloat(U))}function C(J){let L=e.exec(J);if(null!==L){const [,B,R,S,U,T,O]=L;return l(B,R,S,U,T,O)}L=c.exec(J);if(null!==L){const [,B,R,S,U,T,O,M,X,ba]=L;return l(B,R,S,U,T,O,M,X,ba)}L=f.exec(J);if(null!==L){const [,B,R,S,U,T,O,M,X]=L;return l(B,R,S,U,T,"0",O,M,X)}L=m.exec(J);if(null!==L){const [,B,R,S,U,T]=L;return l(B,R,S,U,T)}L=G.exec(J);if(null!==L){const [,B,R,S]=L;return l(B,R,S)}throw Error("SQL Invalid Timestamp");}function p(J){const L=G.exec(J);if(null===L)try{return C(J)}catch{throw Error("SQL Invalid Date");
}const [,B,R,S]=L;return new Date(parseInt(B,10),parseInt(R,10)-1,parseInt(S,10))}function H(J){return Array.isArray(J)?J:[J]}function W(J){return null!==J?!0!==J:null}function x(J,L){return null!=J&&null!=L?!0===J&&!0===L:!1===J||!1===L?!1:null}function A(J,L){return null!=J&&null!=L?!0===J||!0===L:!0===J||!0===L?!0:null}function P(J,L){if(null==J)return null;let B=!1;for(const R of L)if(null==R)B=null;else if(J===R){B=!0;break}return B}function K(J,L,B){if(null==J)return null;let R="",S=I.Normal;
for(let U=0;U<L.length;U++){const T=L.charAt(U);switch(S){case I.Normal:T===B?S=I.Escaped:R="-[]/{}()*+?.\\^$|".includes(T)?R+("\\"+T):"%"===T?R+".*":"_"===T?R+".":R+T;break;case I.Escaped:R="-[]/{}()*+?.\\^$|".includes(T)?R+("\\"+T):R+T,S=I.Normal}}return(new RegExp("^"+R+"$","m")).test(J)}function z(J){return J instanceof Date?J.valueOf():J}function t(J,L,B){if(null==L||null==B)return null;L=z(L);B=z(B);switch(J){case "\x3c\x3e":return L!==B;case "\x3d":return L===B;case "\x3e":return L>B;case "\x3c":return L<
B;case "\x3e\x3d":return L>=B;case "\x3c\x3d":return L<=B}}function n(J,L,B){if(L instanceof h.SqlInterval)if(B instanceof Date)switch(J){case "+":return new Date(L.valueInMilliseconds()+B.getTime());case "-":return L.valueInMilliseconds()-B.getTime();case "*":return L.valueInMilliseconds()*B.getTime();case "/":return L.valueInMilliseconds()/B.getTime()}else if(B instanceof h.SqlInterval)switch(J){case "+":return h.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()+B.valueInMilliseconds());
case "-":return h.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()-B.valueInMilliseconds());case "*":return L.valueInMilliseconds()*B.valueInMilliseconds();case "/":return L.valueInMilliseconds()/B.valueInMilliseconds()}else L=L.valueInMilliseconds();else if(B instanceof h.SqlInterval)if(L instanceof Date)switch(J){case "+":return new Date(B.valueInMilliseconds()+L.getTime());case "-":return new Date(L.getTime()-B.valueInMilliseconds());case "*":return L.getTime()*B.valueInMilliseconds();
case "/":return L.getTime()/B.valueInMilliseconds()}else B=B.valueInMilliseconds();else if(L instanceof Date&&"number"===typeof B)switch(B*=864E5,L=L.getTime(),J){case "+":return new Date(L+B);case "-":return new Date(L-B);case "*":return new Date(L*B);case "/":return new Date(L/B)}else if(B instanceof Date&&"number"===typeof L)switch(L*=864E5,B=B.getTime(),J){case "+":return new Date(L+B);case "-":return new Date(L-B);case "*":return new Date(L*B);case "/":return new Date(L/B)}switch(J){case "+":return L+
B;case "-":return L-B;case "*":return L*B;case "/":return L/B}}function w(J,L,B,R){J=R.getAttribute(J,L);return null!=J&&1===B[L]?new Date(J):J}const G=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,e=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,f=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,E=new Set(["current_timestamp",
"current_date","current_time"]);let v=function(){function J(){}J.makeBool=function(L){return!0===L};J.featureValue=function(L,B,R,S){return w(L,B,R,S)};J.equalsNull=function(L){return null===L};J.applyLike=function(L,B,R){return K(L,B,R)};J.ensureArray=function(L){return H(L)};J.applyIn=function(L,B){return P(L,B)};J.currentDate=function(){const L=new Date;L.setHours(0,0,0,0);return L};J.makeSqlInterval=function(L,B,R){return h.SqlInterval.createFromValueAndQualifer(L,B,R)};J.convertInterval=function(L){return L instanceof
h.SqlInterval?L.valueInMilliseconds():L};J.currentTimestamp=function(){return new Date};J.compare=function(L,B,R){return t(L,B,R)};J.calculate=function(L,B,R){return n(L,B,R)};J.makeComparable=function(L){return z(L)};J.evaluateFunction=function(L,B){return h.evaluateFunction(L,B)};J.lookup=function(L,B){L=B[L];return void 0===L?null:L};J.between=function(L,B){return null==L||null==B[0]||null==B[1]?null:L>=B[0]&&L<=B[1]};J.notbetween=function(L,B){return null==L||null==B[0]||null==B[1]?null:L<B[0]||
L>B[1]};J.ternaryNot=function(L){return W(L)};J.ternaryAnd=function(L,B){return x(L,B)};J.ternaryOr=function(L,B){return A(L,B)};return J}(),r=function(){function J(B,R){this.fieldsIndex=R;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=q.WhereGrammar.parse(B);const {isStandardized:S,isAggregate:U,referencedFieldNames:T}=this._extractExpressionInfo(R);this._referencedFieldNames=T;this.isStandardized=S;this.isAggregate=U}J.create=function(B,R){return new J(B,R)};
var L=J.prototype;L.testSet=function(B,R=F){const S={};for(const U of this.fieldNames)S[U]=B.map(T=>R.getAttribute(T,U));return!!this._evaluateNode(this.parseTree,{attributes:S},F)};L.calculateValue=function(B,R=F){B=this._evaluateNode(this.parseTree,B,R);return B instanceof h.SqlInterval?B.valueInMilliseconds()/864E5:B};L.calculateValueCompiled=function(B,R=F){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(B,this.parameters,R,this._datefields);if(g("esri-csp-restrictions"))return this.calculateValue(B,
R);this._compileMe();return this.parseTree._compiledVersion(B,this.parameters,R,this._datefields)};L.testFeature=function(B,R=F){return!!this._evaluateNode(this.parseTree,B,R)};L.testFeatureCompiled=function(B,R=F){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(B,this.parameters,R,this._datefields);if(g("esri-csp-restrictions"))return this.testFeature(B,R);this._compileMe();return!!this.parseTree._compiledVersion(B,this.parameters,R,this._datefields)};L.getFunctions=
function(){const B=new Set;this._visitAll(this.parseTree,R=>{"function"===R.type&&B.add(R.name.toLowerCase())});return Array.from(B)};L.getExpressions=function(){const B=new Map;this._visitAll(this.parseTree,R=>{if("function"===R.type){const S=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===R.type){R=R.column;const U=`${S}-${R}`;B.has(U)||B.set(U,{aggregateType:S,field:R})}}});return[...B.values()]};L.getVariables=function(){const B=new Set;this._visitAll(this.parseTree,R=>{"parameter"===
R.type&&B.add(R.value.toLowerCase())});return Array.from(B)};L._compileMe=function(){const B="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",B)).bind(v)};L._extractExpressionInfo=function(B){const R=[],S=new Set;let U=!0,T=!0;this._visitAll(this.parseTree,O=>{switch(O.type){case "column-reference":const M=B?.get(O.column);let X,ba;M?X=ba=M.name??"":(ba=O.column,X=ba.toLowerCase());
M&&M.name&&("date"===M.type||"esriFieldTypeDate"===M.type)&&(this._datefields[M.name]=1);S.has(X)||(S.add(X),R.push(ba));O.column=ba;break;case "function":const {name:ka,args:qa}=O;O=qa.value.length;U&&(U=h.isStandardized(ka,O));T&&(T=Q.isAggregate(ka,O))}});return{referencedFieldNames:Array.from(R),isStandardized:U,isAggregate:T}};L._visitAll=function(B,R){if(null!=B)switch(R(B),B.type){case "when-clause":this._visitAll(B.operand,R);this._visitAll(B.value,R);break;case "case-expression":for(const S of B.clauses)this._visitAll(S,
R);"simple"===B.format&&this._visitAll(B.operand,R);null!==B.else&&this._visitAll(B.else,R);break;case "expression-list":for(const S of B.value)this._visitAll(S,R);break;case "unary-expression":this._visitAll(B.expr,R);break;case "binary-expression":this._visitAll(B.left,R);this._visitAll(B.right,R);break;case "function":this._visitAll(B.args,R)}};L.evaluateNodeToJavaScript=function(B){switch(B.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(B.value)+", "+JSON.stringify(B.qualifier)+
","+JSON.stringify(B.op)+")";case "case-expression":var R="";if("simple"===B.format){var S="this.makeComparable("+this.evaluateNodeToJavaScript(B.operand)+")";R="( ";for(let U=0;U<B.clauses.length;U++)R+=" ("+S+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(B.clauses[U].operand)+")) ? ("+this.evaluateNodeToJavaScript(B.clauses[U].value)+") : "}else for(R="( ",S=0;S<B.clauses.length;S++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(B.clauses[S].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(B.clauses[S].value)+") : ";R=null!==B.else?R+this.evaluateNodeToJavaScript(B.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(B.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(S of B.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(S);return R+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(B.expr)+")";case "binary-expression":switch(B.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+" )";case "IS":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(B.left)+")";case "ISNOT":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(B.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(B.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(B.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(B.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(B.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+","+JSON.stringify(B.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+","+JSON.stringify(B.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(B.operator)+","+this.evaluateNodeToJavaScript(B.left)+","+
this.evaluateNodeToJavaScript(B.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(B.operator)+","+this.evaluateNodeToJavaScript(B.left)+","+this.evaluateNodeToJavaScript(B.right)+")"}throw Error("Not Supported Operator "+B.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(B.value);case "date":return"(new Date("+p(B.value).getTime().toString()+"))";case "timestamp":return"(new Date("+C(B.value).getTime().toString()+"))";case "current-time":return"date"===
B.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(B.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(B.name)+","+this.evaluateNodeToJavaScript(B.args)+")"}throw Error("Unsupported sql syntax "+B.type);};L._evaluateNode=function(B,R,S){switch(B.type){case "interval":return R=this._evaluateNode(B.value,R,S),h.SqlInterval.createFromValueAndQualifer(R,B.qualifier,B.op);case "case-expression":if("simple"===
B.format){var U=z(this._evaluateNode(B.operand,R,S));for(var T=0;T<B.clauses.length;T++)if(U===z(this._evaluateNode(B.clauses[T].operand,R,S)))return this._evaluateNode(B.clauses[T].value,R,S)}else for(U=0;U<B.clauses.length;U++)if(!0===this._evaluateNode(B.clauses[U].operand,R,S))return this._evaluateNode(B.clauses[U].value,R,S);return null!==B.else?this._evaluateNode(B.else,R,S):null;case "parameter":return this.parameters[B.value.toLowerCase()];case "expression-list":U=[];for(T of B.value)U.push(this._evaluateNode(T,
R,S));return U;case "unary-expression":return W(this._evaluateNode(B.expr,R,S));case "binary-expression":switch(B.operator){case "AND":return x(this._evaluateNode(B.left,R,S),this._evaluateNode(B.right,R,S));case "OR":return A(this._evaluateNode(B.left,R,S),this._evaluateNode(B.right,R,S));case "IS":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return null===this._evaluateNode(B.left,R,S);case "ISNOT":if("null"!==B.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(B.left,
R,S);case "IN":return U=H(this._evaluateNode(B.right,R,S)),P(this._evaluateNode(B.left,R,S),U);case "NOT IN":return U=H(this._evaluateNode(B.right,R,S)),W(P(this._evaluateNode(B.left,R,S),U));case "BETWEEN":return U=this._evaluateNode(B.left,R,S),B=this._evaluateNode(B.right,R,S),null==U||null==B[0]||null==B[1]?null:U>=z(B[0])&&U<=z(B[1]);case "NOTBETWEEN":return U=this._evaluateNode(B.left,R,S),B=this._evaluateNode(B.right,R,S),null==U||null==B[0]||null==B[1]?null:U<z(B[0])||U>z(B[1]);case "LIKE":return K(this._evaluateNode(B.left,
R,S),this._evaluateNode(B.right,R,S),B.escape);case "NOT LIKE":return W(K(this._evaluateNode(B.left,R,S),this._evaluateNode(B.right,R,S),B.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return t(B.operator,this._evaluateNode(B.left,R,S),this._evaluateNode(B.right,R,S));case "-":case "+":case "*":case "/":return n(B.operator,this._evaluateNode(B.left,R,S),this._evaluateNode(B.right,R,S))}case "null":case "boolean":case "string":case "number":return B.value;
case "date":return p(B.value);case "timestamp":return C(B.value);case "current-time":return R=new Date,"date"===B.mode&&R.setHours(0,0,0,0),R;case "column-reference":return w(R,B.column,this._datefields,S);case "function":return R=this._evaluateNode(B.args,R,S),this.isAggregate?Q.aggregateFunction(B.name,R):h.evaluateFunction(B.name,R)}throw Error("Unsupported sql syntax "+B.type);};D._createClass(J,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,B=>{"current-time"===B.type?this._hasDateFunctions=!0:"function"===B.type&&(this._hasDateFunctions=this._hasDateFunctions||E.has(B.name.toLowerCase()))});return this._hasDateFunctions}}]);return J}();var I;(function(J){J[J.Normal=0]="Normal";J[J.Escaped=1]="Escaped"})(I||(I={}));const F={getAttribute(J,L){return(J&&"object"===typeof J.attributes?J.attributes:J)[L]}};d.WhereClause=r;d.defaultAttributeAdapter=
F;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(d){function D(h){let q=0;for(let u=0;u<h.length;u++)q+=h[u];return q/h.length}function g(h){const q=D(h),u=h.length;let l=0;for(const C of h)l+=(C-q)**2;return 1<u?l/(u-1):0}const Q={min:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.min.apply(Math,h[0])},max:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.max.apply(Math,
h[0])},avg:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:D(h[0])},sum:{minParams:1,maxParams:1,evaluate:h=>{if(null==h[0])h=null;else{h=h[0];let q=0;for(let u=0;u<h.length;u++)q+=h[u];h=q}return h}},stddev:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.sqrt(g(h[0]))},count:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:h[0].length},var:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:g(h[0])}};d.aggregateFunction=function(h,q){const u=Q[h.toLowerCase()];if(null==u)throw Error("Function Not Recognised");
if(q.length<u.minParams||q.length>u.maxParams)throw Error(`Invalid Parameter count for call to ${h.toUpperCase()}`);return u.evaluate(q)};d.isAggregate=function(h,q){h=Q[h.toLowerCase()];return null!=h&&q>=h.minParams&&q<=h.maxParams};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../string"],function(d,D){let g=function(){function h(){this.op="+";this.minute=this.year=this.month=this.hour=
this.second=this.day=0}h._fixDefaults=function(q){if(null!==q.precision||null!==q.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};h.createFromMilliseconds=function(q){const u=new h;u.second=q/1E3;return u};h.createFromValueAndQualifer=function(q,u,l){let C=null;const p=new h;p.op="-"===l?"-":"+";if("interval-period"===u.type){h._fixDefaults(u);l=RegExp("^[0-9]{1,}$");if("year"===u.period||"month"===u.period)throw Error("Year-Month Intervals not supported");if(l.test(q))p[u.period]=
parseFloat(q);else throw Error("Illegal Interval");}else{h._fixDefaults(u.start);h._fixDefaults(u.end);if("year"===u.start.period||"month"===u.start.period)throw Error("Year-Month Intervals not supported");if("year"===u.end.period||"month"===u.end.period)throw Error("Year-Month Intervals not supported");switch(u.start.period){case "day":switch(u.end.period){case "hour":C=RegExp("^[0-9]{1,} [0-9]{1,}$");if(C.test(q))p[u.start.period]=parseFloat(q.split(" ")[0]),p[u.end.period]=parseFloat(q.split(" ")[1]);
else throw Error("Illegal Interval");break;case "minute":C=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(C.test(q))p[u.start.period]=parseFloat(q.split(" ")[0]),q=q.split(" ")[1].split(":"),p.hour=parseFloat(q[0]),p.minute=parseFloat(q[1]);else throw Error("Illegal Interval");break;case "second":C=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(C.test(q))p[u.start.period]=parseFloat(q.split(" ")[0]),q=q.split(" ")[1].split(":"),p.hour=parseFloat(q[0]),p.minute=parseFloat(q[1]),
p.second=parseFloat(q[2]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(u.end.period){case "minute":C=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(C.test(q))p.hour=parseFloat(q.split(":")[0]),p.minute=parseFloat(q.split(":")[1]);else throw Error("Illegal Interval");break;case "second":C=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(C.test(q))q=q.split(":"),p.hour=parseFloat(q[0]),p.minute=parseFloat(q[1]),p.second=parseFloat(q[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "minute":switch(u.end.period){case "second":C=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(C.test(q))q=q.split(":"),p.minute=parseFloat(q[0]),p.second=parseFloat(q[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return p};h.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+
6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return h}();const Q={extract:{minParams:2,maxParams:2,evaluate:([h,q])=>{if(null==q)return null;if(q instanceof Date)switch(h.toUpperCase()){case "SECOND":return q.getSeconds();case "MINUTE":return q.getMinutes();case "HOUR":return q.getHours();case "DAY":return q.getDate();case "MONTH":return q.getMonth()+1;case "YEAR":return q.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:h=>{if(2===h.length){const [q,u]=h;return null==q||null==u?null:q.toString().substring(u-1)}if(3===h.length){const [q,u,l]=h;return null==q||null==u||null==l?null:0>=l?"":q.toString().substring(u-1,u+l-1)}}},position:{minParams:2,maxParams:2,evaluate:([h,q])=>null==h||null==q?null:q.indexOf(h)+1},trim:{minParams:2,maxParams:3,evaluate:h=>{var q=3===h.length,u=q?h[1]:" ";q=q?h[2]:h[1];if(null==u||null==q)return null;u=`(${D.escapeRegExpString(u)})`;switch(h[0]){case "BOTH":return q.replace(new RegExp(`^${u}*|${u}*$`,
"g"),"");case "LEADING":return q.replace(new RegExp(`^${u}*`,"g"),"");case "TRAILING":return q.replace(new RegExp(`${u}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.abs(h[0])},ceiling:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.ceil(h[0])},floor:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.floor(h[0])},log:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.log(h[0])},log10:{minParams:1,
maxParams:1,evaluate:h=>null==h[0]?null:Math.log(h[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.sin(h[0])},cos:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.cos(h[0])},tan:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.tan(h[0])},asin:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.asin(h[0])},acos:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.acos(h[0])},atan:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:Math.atan(h[0])},
sign:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:0<h[0]?1:0>h[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:h=>null==h[0]||null==h[1]?null:h[0]**h[1]},mod:{minParams:2,maxParams:2,evaluate:h=>null==h[0]||null==h[1]?null:h[0]%h[1]},round:{minParams:1,maxParams:2,evaluate:h=>{const q=h[0];h=2===h.length?10**h[1]:1;return null==q?null:Math.round(q*h)/h}},truncate:{minParams:1,maxParams:2,evaluate:h=>null==h[0]?null:1===h.length?parseInt(h[0].toFixed(0),10):parseFloat(h[0].toFixed(h[1]))},
char_length:{minParams:1,maxParams:1,evaluate:h=>"string"===typeof h[0]||h[0]instanceof String?h[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:h=>{let q="";for(let u=0;u<h.length;u++){if(null==h[u])return null;q+=h[u].toString()}return q}},lower:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:h[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:h=>null==h[0]?null:h[0].toString().toUpperCase()}};d.SqlInterval=g;d.evaluateFunction=function(h,q){const u=Q[h.toLowerCase()];
if(null==u)throw Error("Function Not Recognised");if(q.length<u.minParams||q.length>u.maxParams)throw Error(`Invalid Parameter count for call to ${h.toUpperCase()}`);return u.evaluate(q)};d.isStandardized=function(h,q){h=Q[h.toLowerCase()];return null!=h&&q>=h.minParams&&q<=h.maxParams};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_commonjsHelpers"],function(d,D){var g={exports:{}};
(function(h){(function(q,u){h.exports&&(h.exports=u())})(D.commonjsGlobal,function(){function q(l,C,p,H){l=Error.call(this,l);Object.setPrototypeOf&&Object.setPrototypeOf(l,q.prototype);l.expected=C;l.found=p;l.location=H;l.name="SyntaxError";return l}function u(l,C,p){p=p||" ";if(l.length>C)return l;C-=l.length;p+=p.repeat(C);return l+p.slice(0,C)}(function(l,C){function p(){this.constructor=l}p.prototype=C.prototype;l.prototype=new p})(q,Error);q.prototype.format=function(l){var C="Error: "+this.message;
if(this.location){var p=null,H;for(H=0;H<l.length;H++)if(l[H].source===this.location.source){p=l[H].text.split(/\r\n|\n|\r/g);break}l=this.location.start;H=this.location.source+":"+l.line+":"+l.column;if(p){var W=this.location.end,x=u("",l.line.toString().length," ");p=p[l.line-1];W=(l.line===W.line?W.column:p.length+1)-l.column||1;C+="\n --\x3e "+H+"\n"+x+" |\n"+l.line+" | "+p+"\n"+x+" | "+u("",l.column-1," ")+u("",W,"^")}else C+="\n at "+H}return C};q.buildMessage=function(l,C){function p(P){return P.charCodeAt(0).toString(16).toUpperCase()}
function H(P){return P.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(K){return"\\x0"+p(K)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(K){return"\\x"+p(K)})}function W(P){return P.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(K){return"\\x0"+
p(K)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(K){return"\\x"+p(K)})}function x(P){return A[P.type](P)}var A={literal:function(P){return'"'+H(P.text)+'"'},class:function(P){var K=P.parts.map(function(z){return Array.isArray(z)?W(z[0])+"-"+W(z[1]):W(z)});return"["+(P.inverted?"^":"")+K.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(P){return P.description}};return"Expected "+function(P){P=P.map(x);var K,z;P.sort();if(0<P.length){for(z=K=1;K<
P.length;K++)P[K-1]!==P[K]&&(P[z]=P[K],z++);P.length=z}switch(P.length){case 1:return P[0];case 2:return P[0]+" or "+P[1];default:return P.slice(0,-1).join(", ")+", or "+P[P.length-1]}}(l)+" but "+(C?'"'+H(C)+'"':"end of input")+" found."};return{SyntaxError:q,parse:function(l,C){function p(k,y){return{type:"literal",text:k,ignoreCase:y}}function H(k,y,N){return{type:"class",parts:k,inverted:y,ignoreCase:N}}function W(k){var y=vb[k],N;if(!y){for(N=k-1;!vb[N];)N--;y=vb[N];for(y={line:y.line,column:y.column};N<
k;)10===l.charCodeAt(N)?(y.line++,y.column=1):y.column++,N++;vb[k]=y}return y}function x(k,y){var N=W(k),da=W(y);return{source:Tc,start:{offset:k,line:N.line,column:N.column},end:{offset:y,line:da.line,column:da.column}}}function A(k){b<Qa||(b>Qa&&(Qa=b,Qb=[]),Qb.push(k))}function P(){var k=b;fa();var y=z();y!==a?(fa(),k=y):(b=k,k=a);return k}function K(){var k=b;var y=z();if(y!==a){k=[];var N=b;var da=fa();var na=wb();if(na!==a){var ta=fa();var ua=z();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,
N=a;for(;N!==a;)k.push(N),N=b,da=fa(),na=wb(),na!==a?(ta=fa(),ua=z(),ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)):(b=N,N=a);N={type:"expression-list"};y=[y];for(da=0;da<k.length;da++)y.push(k[da][3]);N.value=y;k=N}else b=k,k=a;return k}function z(){var k=b;var y=t();if(y!==a){k=[];var N=b;var da=fa();var na=Y();if(na!==a){var ta=fa();var ua=t();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)k.push(N),N=b,da=fa(),na=Y(),na!==a?(ta=fa(),ua=t(),ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)):(b=N,N=a);k=
kb(y,k)}else b=k,k=a;return k}function t(){var k=b;var y=n();if(y!==a){k=[];var N=b;var da=fa();var na=V();if(na!==a){var ta=fa();var ua=n();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)k.push(N),N=b,da=fa(),na=V(),na!==a?(ta=fa(),ua=n(),ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)):(b=N,N=a);k=kb(y,k)}else b=k,k=a;return k}function n(){var k=b;var y=pa();if(y===a){y=b;if(33===l.charCodeAt(b)){var N=Uc;b++}else N=a,0===ea&&A(Vc);if(N!==a){var da=b;ea++;if(61===l.charCodeAt(b)){var na=hc;b++}else na=
a,0===ea&&A(ic);ea--;na===a?da=void 0:(b=da,da=a);da!==a?y=N=[N,da]:(b=y,y=a)}else b=y,y=a}y!==a?(N=fa(),da=n(),da!==a?k={type:"unary-expression",operator:"NOT",expr:da}:(b=k,k=a)):(b=k,k=a);if(k===a){y=b;k=c();if(k!==a){fa();y=[];N=b;da=fa();na=w();if(na!==a){var ta=fa();var ua=c();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,N=a;if(N!==a)for(;N!==a;)y.push(N),N=b,da=fa(),na=w(),na!==a?(ta=fa(),ua=c(),ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)):(b=N,N=a);else y=a;y!==a&&(y={type:"arithmetic",tail:y});y===
a&&(y=b,N=e(),N!==a?(fa(),da=Ha(),da!==a?(fa(),da=K(),da!==a?(fa(),na=Ia(),na!==a?y={op:N,right:da}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a)):(b=y,y=a),y===a&&(y=b,N=e(),N!==a?(fa(),da=Ha(),da!==a?(fa(),da=Ia(),da!==a?y={op:N,right:{type:"expression-list",value:[]}}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a),y===a&&(y=b,N=e(),N!==a?(fa(),da=L(),da!==a?y={op:N,right:da}:(b=y,y=a)):(b=y,y=a))),y===a&&(y=b,na=pa(),na!==a?(fa(),N=Z(),N!==a?(fa(),da=c(),da!==a?(fa(),ta=V(),ta!==a?(fa(),na=c(),na!==a?y={op:"NOT"+N,right:{type:"expression-list",
value:[da,na]}}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a)):(b=y,y=a)):(b=y,y=a),y===a&&(y=b,na=Z(),na!==a?(fa(),N=c(),N!==a?(fa(),da=V(),da!==a?(fa(),ta=c(),ta!==a?y={op:na,right:{type:"expression-list",value:[N,ta]}}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a)):(b=y,y=a)),y===a&&(y=b,N=ya(),N!==a?(fa(),da=pa(),da!==a?(fa(),da=c(),da!==a?y={op:N+"NOT",right:da}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a),y===a&&(y=b,N=ya(),N!==a?(fa(),da=c(),da!==a?y={op:N,right:da}:(b=y,y=a)):(b=y,y=a)),y===a&&(y=b,N=G(),N!==a?(fa(),da=O(),da!==
a?(fa(),na=b,l.substr(b,6).toLowerCase()===Wc?(ta=l.substr(b,6),b+=6):(ta=a,0===ea&&A(Xc)),ta!==a?(ta=b,ea++,ua=F(),ea--,ua===a?ta=void 0:(b=ta,ta=a),ta!==a?na="ESCAPE":(b=na,na=a)):(b=na,na=a),na!==a?(fa(),na=M(),na!==a?y={op:N,right:da,escape:na.value}:(b=y,y=a)):(b=y,y=a)):(b=y,y=a)):(b=y,y=a),y===a&&(y=b,N=G(),N!==a?(fa(),da=O(),da!==a?y={op:N,right:da,escape:""}:(b=y,y=a)):(b=y,y=a))))));y===a&&(y=null);""==y||void 0==y||null==y?y=k:(N=null,y=N="arithmetic"==y.type?kb(k,y.tail):jc(y.op,k,y.right,
y.escape))}else b=y,y=a;k=y}return k}function w(){if(l.substr(b,2)===kc){var k=kc;b+=2}else k=a,0===ea&&A(Yc);k===a&&(62===l.charCodeAt(b)?(k=Zc,b++):(k=a,0===ea&&A($c)),k===a&&(l.substr(b,2)===lc?(k=lc,b+=2):(k=a,0===ea&&A(ad)),k===a&&(l.substr(b,2)===mc?(k=mc,b+=2):(k=a,0===ea&&A(bd)),k===a&&(60===l.charCodeAt(b)?(k=cd,b++):(k=a,0===ea&&A(dd)),k===a&&(61===l.charCodeAt(b)?(k=hc,b++):(k=a,0===ea&&A(ic)),k===a&&(l.substr(b,2)===nc?(k=nc,b+=2):(k=a,0===ea&&A(ed))))))));return k}function G(){var k=
k=b;var y=pa();if(y!==a){var N=fa();var da=Ea();da!==a?k=y=[y,N,da]:(b=k,k=a)}else b=k,k=a;k!==a&&(k=k[0]+" "+k[2]);k===a&&(k=Ea());return k}function e(){var k=k=b;var y=pa();if(y!==a){var N=fa();var da=Ka();da!==a?k=y=[y,N,da]:(b=k,k=a)}else b=k,k=a;k!==a&&(k=k[0]+" "+k[2]);k===a&&(k=Ka());return k}function c(){var k=b;var y=m();if(y!==a){k=[];var N=b;var da=fa();var na=f();if(na!==a){var ta=fa();var ua=m();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)k.push(N),N=b,da=fa(),na=f(),
na!==a?(ta=fa(),ua=m(),ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)):(b=N,N=a);k=kb(y,k)}else b=k,k=a;return k}function f(){if(43===l.charCodeAt(b)){var k=Rb;b++}else k=a,0===ea&&A(Sb);k===a&&(45===l.charCodeAt(b)?(k=Tb,b++):(k=a,0===ea&&A(Ub)));return k}function m(){var k=b;var y=v();if(y!==a){k=[];var N=b;var da=fa();var na=E();if(na!==a){var ta=fa();var ua=v();ua!==a?N=da=[da,na,ta,ua]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)k.push(N),N=b,da=fa(),na=E(),na!==a?(ta=fa(),ua=v(),ua!==a?N=da=[da,na,ta,ua]:(b=N,
N=a)):(b=N,N=a);k=kb(y,k)}else b=k,k=a;return k}function E(){if(42===l.charCodeAt(b)){var k=fd;b++}else k=a,0===ea&&A(gd);k===a&&(47===l.charCodeAt(b)?(k=hd,b++):(k=a,0===ea&&A(id)));return k}function v(){var k=M();if(k===a){var y=b;var N=b;var da=qa();if(da!==a){var na=xa();if(na!==a){var ta=wa();ta!==a?N=parseFloat(da+na+ta):(b=N,N=a)}else b=N,N=a}else b=N,N=a;N===a&&(N=b,da=qa(),da!==a?(na=xa(),na!==a?N=parseFloat(da+na):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,da=qa(),da!==a?(na=wa(),na!==a?N=parseFloat(da+
na):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,da=qa(),da!==a&&(da=parseFloat(da)),N=da)));var ua=N;if(ua!==a){var xb=b;ea++;var jd=I();ea--;jd===a?xb=void 0:(b=xb,xb=a);xb!==a?y={type:"number",value:ua}:(b=y,y=a)}else b=y,y=a;k=y;if(k===a){var lb=b;var $a=b;if(l.substr(b,4).toLowerCase()===kd){var yb=l.substr(b,4);b+=4}else yb=a,0===ea&&A(ld);if(yb!==a){var mb=b;ea++;var md=F();ea--;md===a?mb=void 0:(b=mb,mb=a);mb!==a?$a=yb=[yb,mb]:(b=$a,$a=a)}else b=$a,$a=a;var Za=$a;Za!==a&&(Za={type:"boolean",value:!0});
lb=Za;if(lb===a){lb=b;var ab=b;if(l.substr(b,5).toLowerCase()===nd){var zb=l.substr(b,5);b+=5}else zb=a,0===ea&&A(od);if(zb!==a){var nb=b;ea++;var pd=F();ea--;pd===a?nb=void 0:(b=nb,nb=a);nb!==a?ab=zb=[zb,nb]:(b=ab,ab=a)}else b=ab,ab=a;Za=ab;Za!==a&&(Za={type:"boolean",value:!1});lb=Za}k=lb;if(k===a){var bb=b;if(l.substr(b,4).toLowerCase()===qd){var Ab=l.substr(b,4);b+=4}else Ab=a,0===ea&&A(rd);if(Ab!==a){var ob=b;ea++;var sd=F();ea--;sd===a?ob=void 0:(b=ob,ob=a);ob!==a?bb=Ab=[Ab,ob]:(b=bb,bb=a)}else b=
bb,bb=a;var Vb=bb;Vb!==a&&(Vb={type:"null",value:null});k=Vb;if(k===a){var cb=b;var db=b;if(l.substr(b,4).toLowerCase()===td){var oc=l.substr(b,4);b+=4}else oc=a,0===ea&&A(ud);if(oc!==a){var Bb=b;ea++;var vd=F();ea--;vd===a?Bb=void 0:(b=Bb,Bb=a);Bb!==a?db="DATE":(b=db,db=a)}else b=db,db=a;if(db!==a){fa();var pc=O();pc!==a?cb={type:"date",value:pc.value}:(b=cb,cb=a)}else b=cb,cb=a;k=cb;if(k===a){var eb=b;var fb=b;if(l.substr(b,9).toLowerCase()===wd){var qc=l.substr(b,9);b+=9}else qc=a,0===ea&&A(xd);
if(qc!==a){var Cb=b;ea++;var yd=F();ea--;yd===a?Cb=void 0:(b=Cb,Cb=a);Cb!==a?fb="TIMESTAMP":(b=fb,fb=a)}else b=fb,fb=a;if(fb!==a){fa();var rc=O();rc!==a?eb={type:"timestamp",value:rc.value}:(b=eb,eb=a)}else b=eb,eb=a;k=eb;if(k===a){var Ca=b;var Wb=ia();if(Wb!==a){fa();if(45===l.charCodeAt(b)){var Ta=Tb;b++}else Ta=a,0===ea&&A(Ub);Ta===a&&(43===l.charCodeAt(b)?(Ta=Rb,b++):(Ta=a,0===ea&&A(Sb)));if(Ta!==a){fa();var pb=O();if(pb!==a){fa();var sc=R();sc!==a?Ca={type:"interval",value:pb,qualifier:sc,op:Ta}:
(b=Ca,Ca=a)}else b=Ca,Ca=a}else b=Ca,Ca=a}else b=Ca,Ca=a;Ca===a&&(Ca=b,Wb=ia(),Wb!==a?(fa(),Ta=O(),Ta!==a?(fa(),pb=R(),pb!==a?Ca={type:"interval",value:Ta,qualifier:pb,op:""}:(b=Ca,Ca=a)):(b=Ca,Ca=a)):(b=Ca,Ca=a));k=Ca}}}}}}var za=k;if(za===a){var La=b;var gb=b;if(l.substr(b,7).toLowerCase()===zd){var tc=l.substr(b,7);b+=7}else tc=a,0===ea&&A(Ad);if(tc!==a){var Db=b;ea++;var Bd=F();ea--;Bd===a?Db=void 0:(b=Db,Db=a);Db!==a?gb="EXTRACT":(b=gb,gb=a)}else b=gb,gb=a;if(gb!==a){fa();var Cd=Ha();if(Cd!==
a){fa();var Oa=ca();Oa===a&&(Oa=ma(),Oa===a&&(Oa=sa(),Oa===a&&(Oa=oa(),Oa===a&&(Oa=la(),Oa===a&&(Oa=ja())))));var uc=Oa;if(uc!==a){fa();var Dd=aa();if(Dd!==a){fa();var vc=z();if(vc!==a){fa();var Ed=Ia();Ed!==a?La={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:uc},vc]}}:(b=La,La=a)}else b=La,La=a}else b=La,La=a}else b=La,La=a}else b=La,La=a}else b=La,La=a;za=La;if(za===a){var Ma=b;var hb=b;if(l.substr(b,9).toLowerCase()===Fd){var wc=l.substr(b,9);b+=9}else wc=
a,0===ea&&A(Gd);if(wc!==a){var Eb=b;ea++;var Hd=F();ea--;Hd===a?Eb=void 0:(b=Eb,Eb=a);Eb!==a?hb="SUBSTRING":(b=hb,hb=a)}else b=hb,hb=a;if(hb!==a){fa();var Id=Ha();if(Id!==a){fa();var Xb=z();if(Xb!==a){fa();var Jd=aa();if(Jd!==a){fa();var Yb=z();if(Yb!==a){fa();var Ua=b;var ib=b;if(l.substr(b,3).toLowerCase()===Kd){var xc=l.substr(b,3);b+=3}else xc=a,0===ea&&A(Ld);if(xc!==a){var Fb=b;ea++;var Md=F();ea--;Md===a?Fb=void 0:(b=Fb,Fb=a);Fb!==a?ib="FOR":(b=ib,ib=a)}else b=ib,ib=a;var qb=ib;if(qb!==a){var Nd=
fa();var yc=z();if(yc!==a){var Od=fa();Ua=qb=[qb,Nd,yc,Od]}else b=Ua,Ua=a}else b=Ua,Ua=a;Ua===a&&(Ua=null);qb=Ia();qb!==a?Ma={type:"function",name:"substring",args:{type:"expression-list",value:Ua?[Xb,Yb,Ua[2]]:[Xb,Yb]}}:(b=Ma,Ma=a)}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a;za=Ma;if(za===a){var Aa=b;var Zb=ha();if(Zb!==a){fa();var $b=Ha();if($b!==a){fa();var Va=B();Va===a&&(Va=null);fa();var rb=z();if(rb!==a){fa();var ac=aa();if(ac!==a){fa();var zc=z();if(zc!==a){fa();
var Pd=Ia();Pd!==a?Aa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Va?"BOTH":Va},rb,zc]}}:(b=Aa,Aa=a)}else b=Aa,Aa=a}else b=Aa,Aa=a}else b=Aa,Aa=a}else b=Aa,Aa=a}else b=Aa,Aa=a;Aa===a&&(Aa=b,Zb=ha(),Zb!==a?(fa(),$b=Ha(),$b!==a?(fa(),Va=B(),Va===a&&(Va=null),fa(),rb=z(),rb!==a?(fa(),ac=Ia(),ac!==a?Aa={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Va?"BOTH":Va},rb]}}:(b=Aa,Aa=a)):(b=Aa,Aa=a)):(b=Aa,Aa=a)):(b=
Aa,Aa=a));za=Aa;if(za===a){var Na=b;var jb=b;if(l.substr(b,8).toLowerCase()===Qd){var Ac=l.substr(b,8);b+=8}else Ac=a,0===ea&&A(Rd);if(Ac!==a){var Gb=b;ea++;var Sd=F();ea--;Sd===a?Gb=void 0:(b=Gb,Gb=a);Gb!==a?jb="POSITION":(b=jb,jb=a)}else b=jb,jb=a;if(jb!==a){fa();var Td=Ha();if(Td!==a){fa();var Bc=z();if(Bc!==a){fa();var Ud=Ka();if(Ud!==a){fa();var Cc=z();if(Cc!==a){fa();var Vd=Ia();Vd!==a?Na={type:"function",name:"position",args:{type:"expression-list",value:[Bc,Cc]}}:(b=Na,Na=a)}else b=Na,Na=
a}else b=Na,Na=a}else b=Na,Na=a}else b=Na,Na=a}else b=Na,Na=a;za=Na;if(za===a){var Xa=b;var Hb;var Pa=b;Pa=Hb=r();if(Pa===a)if(Pa=b,96===l.charCodeAt(b)?(Hb=Dc,b++):(Hb=a,0===ea&&A(Ec)),Hb!==a){var Ib=[];if(Fc.test(l.charAt(b))){var Wa=l.charAt(b);b++}else Wa=a,0===ea&&A(Gc);if(Wa!==a)for(;Wa!==a;)Ib.push(Wa),Fc.test(l.charAt(b))?(Wa=l.charAt(b),b++):(Wa=a,0===ea&&A(Gc));else Ib=a;Ib!==a?(96===l.charCodeAt(b)?(Wa=Dc,b++):(Wa=a,0===ea&&A(Ec)),Wa!==a?Pa=Ib.join(""):(b=Pa,Pa=a)):(b=Pa,Pa=a)}else b=Pa,
Pa=a;var Hc=Pa;if(Hc!==a){fa();var Wd=Ha();if(Wd!==a){fa();var Jb=K();Jb===a&&(Jb=null);fa();var Xd=Ia();Xd!==a?Xa={type:"function",name:Hc,args:Jb?Jb:{type:"expression-list",value:[]}}:(b=Xa,Xa=a)}else b=Xa,Xa=a}else b=Xa,Xa=a;za=Xa;if(za===a){var Ra;var Da=b;var bc=ra();if(bc!==a){fa();var sb=z();if(sb!==a){fa();var tb=[];for(Ra=ba();Ra!==a;)tb.push(Ra),Ra=ba();Ra=fa();var Kb=va();Kb!==a?Da={type:"case-expression",format:"simple",operand:sb,clauses:tb,else:null}:(b=Da,Da=a)}else b=Da,Da=a}else b=
Da,Da=a;if(Da===a)if(Da=b,bc=ra(),bc!==a)if(fa(),sb=z(),sb!==a){fa();tb=[];for(Ra=ba();Ra!==a;)tb.push(Ra),Ra=ba();Ra=fa();Kb=ka();if(Kb!==a){fa();var Yd=va();Yd!==a?Da={type:"case-expression",format:"simple",operand:sb,clauses:tb,else:Kb.value}:(b=Da,Da=a)}else b=Da,Da=a}else b=Da,Da=a;else b=Da,Da=a;var cc=Da;if(cc===a){var Sa;var Ja=b;var dc=ra();if(dc!==a){fa();var ub=[];for(Sa=X();Sa!==a;)ub.push(Sa),Sa=X();Sa=fa();var Lb=va();Lb!==a?Ja={type:"case-expression",format:"searched",clauses:ub,else:null}:
(b=Ja,Ja=a)}else b=Ja,Ja=a;if(Ja===a)if(Ja=b,dc=ra(),dc!==a){fa();ub=[];for(Sa=X();Sa!==a;)ub.push(Sa),Sa=X();Sa=fa();Lb=ka();if(Lb!==a){fa();var Zd=va();Zd!==a?Ja={type:"case-expression",format:"searched",clauses:ub,else:Lb.value}:(b=Ja,Ja=a)}else b=Ja,Ja=a}else b=Ja,Ja=a;cc=Ja}za=cc;if(za===a){var Mb;var Nb=b;var Ic=I();if(Ic!==a){var Jc=[];for(Mb=J();Mb!==a;)Jc.push(Mb),Mb=J();Nb=Ic+Jc.join("")}else b=Nb,Nb=a;var Ob=Nb;if(Ob!==a){var ec=Ob;Ob=/^CURRENT_DATE$/i.test(ec)?{type:"current-time",mode:"date"}:
/^CURRENT_TIMESTAMP$/i.test(ec)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:ec}}za=Ob;if(za===a&&(za=L(),za===a)){za=b;var $d=Ha();if($d!==a){fa();var fc=z();if(fc!==a){fa();var ae=Ia();ae!==a?(fc.paren=!0,za=fc):(b=za,za=a)}else b=za,za=a}else b=za,za=a}}}}}}}}return za}function r(){var k;var y=b;var N=I();if(N!==a){y=[];for(k=F();k!==a;)y.push(k),k=F();y=N+y.join("")}else b=y,y=a;return y}function I(){if(be.test(l.charAt(b))){var k=l.charAt(b);b++}else k=a,0===
ea&&A(ce);return k}function F(){if(de.test(l.charAt(b))){var k=l.charAt(b);b++}else k=a,0===ea&&A(ee);return k}function J(){if(fe.test(l.charAt(b))){var k=l.charAt(b);b++}else k=a,0===ea&&A(ge);return k}function L(){var k=b;if(64===l.charCodeAt(b)){var y=he;b++}else y=a,0===ea&&A(ie);if(y!==a){var N=r();N!==a?k=y=[y,N]:(b=k,k=a)}else b=k,k=a;k!==a&&(k={type:"parameter",value:k[1]});return k}function B(){var k=b;if(l.substr(b,7).toLowerCase()===je){var y=l.substr(b,7);b+=7}else y=a,0===ea&&A(ke);if(y!==
a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="LEADING":(b=k,k=a)}else b=k,k=a;k===a&&(k=b,l.substr(b,8).toLowerCase()===le?(y=l.substr(b,8),b+=8):(y=a,0===ea&&A(me)),y!==a?(y=b,ea++,N=F(),ea--,N===a?y=void 0:(b=y,y=a),y!==a?k="TRAILING":(b=k,k=a)):(b=k,k=a),k===a&&(k=b,l.substr(b,4).toLowerCase()===ne?(y=l.substr(b,4),b+=4):(y=a,0===ea&&A(oe)),y!==a?(y=b,ea++,N=F(),ea--,N===a?y=void 0:(b=y,y=a),y!==a?k="BOTH":(b=k,k=a)):(b=k,k=a)));return k}function R(){var k=b;var y=b;var N=S();if(N!==
a){fa();var da=Ha();if(da!==a)if(fa(),da=T(),da!==a){fa();var na=Ia();na!==a?y={type:"interval-period",period:N.value,precision:da,secondary:null}:(b=y,y=a)}else b=y,y=a;else b=y,y=a}else b=y,y=a;y===a&&(y=b,N=S(),N!==a&&(N={type:"interval-period",period:N.value,precision:null,secondary:null}),y=N);if(y!==a)if(fa(),N=b,l.substr(b,2).toLowerCase()===pe?(da=l.substr(b,2),b+=2):(da=a,0===ea&&A(qe)),da!==a?(da=b,ea++,na=F(),ea--,na===a?da=void 0:(b=da,da=a),da!==a?N="TO":(b=N,N=a)):(b=N,N=a),N!==a){fa();
N=b;da=S();da!==a&&(da={type:"interval-period",period:da.value,precision:null,secondary:null});N=da;if(N===a){N=b;da=ja();if(da!==a)if(fa(),da=Ha(),da!==a)if(fa(),da=T(),da!==a)if(fa(),na=wb(),na!==a)if(fa(),na=U(),na!==a){fa();var ta=Ia();ta!==a?N={type:"interval-period",period:"second",precision:da,secondary:na}:(b=N,N=a)}else b=N,N=a;else b=N,N=a;else b=N,N=a;else b=N,N=a;else b=N,N=a;N===a&&(N=b,da=ja(),da!==a?(fa(),da=Ha(),da!==a?(fa(),da=T(),da!==a?(fa(),na=Ia(),na!==a?N={type:"interval-period",
period:"second",precision:da,secondary:null}:(b=N,N=a)):(b=N,N=a)):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,da=ja(),da!==a&&(da={type:"interval-period",period:"second",precision:null,secondary:null}),N=da))}N!==a?k={type:"interval-qualifier",start:y,end:N}:(b=k,k=a)}else b=k,k=a;else b=k,k=a;k===a&&(k=b,N=S(),N!==a?(fa(),y=Ha(),y!==a?(fa(),y=U(),y!==a?(fa(),da=Ia(),da!==a?k={type:"interval-period",period:N.value,precision:y,secondary:null}:(b=k,k=a)):(b=k,k=a)):(b=k,k=a)):(b=k,k=a),k===a&&(k=b,N=S(),N!==
a&&(N={type:"interval-period",period:N.value,precision:null,secondary:null}),k=N,k===a&&(k=b,N=ja(),N!==a?(fa(),y=Ha(),y!==a?(fa(),y=T(),y!==a?(fa(),da=wb(),da!==a?(fa(),N=U(),N!==a?(fa(),da=Ia(),da!==a?k={type:"interval-period",period:"second",precision:y,secondary:N}:(b=k,k=a)):(b=k,k=a)):(b=k,k=a)):(b=k,k=a)):(b=k,k=a)):(b=k,k=a),k===a&&(k=b,N=ja(),N!==a?(fa(),y=Ha(),y!==a?(fa(),y=U(),y!==a?(fa(),da=Ia(),da!==a?k={type:"interval-period",period:"second",precision:y,secondary:null}:(b=k,k=a)):(b=
k,k=a)):(b=k,k=a)):(b=k,k=a),k===a&&(k=b,N=ja(),N!==a&&(N={type:"interval-period",period:"second",precision:null,secondary:null}),k=N)))));return k}function S(){var k=b;k=sa();k!==a&&(k={type:"string",value:"day"});k===a&&(k=b,k=oa(),k!==a&&(k={type:"string",value:"hour"}),k===a&&(k=b,k=la(),k!==a&&(k={type:"string",value:"minute"}),k===a&&(k=b,k=ma(),k!==a&&(k={type:"string",value:"month"}),k===a&&(k=b,k=ca(),k!==a&&(k={type:"string",value:"year"})))));return k}function U(){var k=Fa();k!==a&&(k=
parseFloat(k));return k}function T(){var k=Fa();k!==a&&(k=parseFloat(k));return k}function O(){var k=M();k===a&&(k=L());return k}function M(){var k=b;if(39===l.charCodeAt(b)){var y=Kc;b++}else y=a,0===ea&&A(Lc);y===a&&(l.substr(b,2)===Mc?(y=Mc,b+=2):(y=a,0===ea&&A(re)));if(y!==a){y=[];var N=b;l.substr(b,2)===Pb?(N=Pb,b+=2):(N=a,0===ea&&A(Nc));N!==a&&(N="'");N===a&&(Oc.test(l.charAt(b))?(N=l.charAt(b),b++):(N=a,0===ea&&A(Pc)));for(;N!==a;)y.push(N),N=b,l.substr(b,2)===Pb?(N=Pb,b+=2):(N=a,0===ea&&A(Nc)),
N!==a&&(N="'"),N===a&&(Oc.test(l.charAt(b))?(N=l.charAt(b),b++):(N=a,0===ea&&A(Pc)));39===l.charCodeAt(b)?(N=Kc,b++):(N=a,0===ea&&A(Lc));N!==a?k={type:"string",value:y.join("")}:(b=k,k=a)}else b=k,k=a;return k}function X(){var k=b;if(Ba()!==a){fa();var y=z();if(y!==a){fa();var N=Ga();N!==a?(fa(),N=z(),N!==a?k={type:"when-clause",operand:y,value:N}:(b=k,k=a)):(b=k,k=a)}else b=k,k=a}else b=k,k=a;return k}function ba(){var k=b;if(Ba()!==a){fa();var y=z();if(y!==a){fa();var N=Ga();N!==a?(fa(),N=z(),N!==
a?k={type:"when-clause",operand:y,value:N}:(b=k,k=a)):(b=k,k=a)}else b=k,k=a}else b=k,k=a;return k}function ka(){var k=b;var y=b;if(l.substr(b,4).toLowerCase()===se){var N=l.substr(b,4);b+=4}else N=a,0===ea&&A(te);if(N!==a){N=b;ea++;var da=F();ea--;da===a?N=void 0:(b=N,N=a);N!==a?y="ELSE":(b=y,y=a)}else b=y,y=a;y!==a?(fa(),y=z(),y!==a?k={type:"else-clause",value:y}:(b=k,k=a)):(b=k,k=a);return k}function qa(){var k=Fa();if(k===a){k=b;if(45===l.charCodeAt(b)){var y=Tb;b++}else y=a,0===ea&&A(Ub);y===
a&&(43===l.charCodeAt(b)?(y=Rb,b++):(y=a,0===ea&&A(Sb)));if(y!==a){var N=Fa();N!==a?k=y[0]+N:(b=k,k=a)}else b=k,k=a}return k}function xa(){var k=b;if(46===l.charCodeAt(b)){var y=ue;b++}else y=a,0===ea&&A(ve);y!==a?(k=Fa(),k===a&&(k=null),k="."+(null!=k?k:"")):(b=k,k=a);return k}function wa(){var k;var y=k=b;if(we.test(l.charAt(b))){var N=l.charAt(b);b++}else N=a,0===ea&&A(xe);N!==a?(ye.test(l.charAt(b))?(y=l.charAt(b),b++):(y=a,0===ea&&A(ze)),y===a&&(y=null),y="e"+(null===y?"":y)):(b=y,y=a);y!==a?
(N=Fa(),N!==a?k=y+N:(b=k,k=a)):(b=k,k=a);return k}function Fa(){var k=[];var y=Ya();if(y!==a)for(;y!==a;)k.push(y),y=Ya();else k=a;k!==a&&(k=k.join(""));return k}function Ya(){if(Ae.test(l.charAt(b))){var k=l.charAt(b);b++}else k=a,0===ea&&A(Be);return k}function Ka(){var k=b;if(l.substr(b,2).toLowerCase()===Ce){var y=l.substr(b,2);b+=2}else y=a,0===ea&&A(De);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="IN":(b=k,k=a)}else b=k,k=a;return k}function ya(){var k=b;if(l.substr(b,
2).toLowerCase()===Ee){var y=l.substr(b,2);b+=2}else y=a,0===ea&&A(Fe);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="IS":(b=k,k=a)}else b=k,k=a;return k}function Ea(){var k=b;if(l.substr(b,4).toLowerCase()===Ge){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(He);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="LIKE":(b=k,k=a)}else b=k,k=a;return k}function pa(){var k=b;if(l.substr(b,3).toLowerCase()===Ie){var y=l.substr(b,3);b+=3}else y=a,0===ea&&A(Je);if(y!==
a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="NOT":(b=k,k=a)}else b=k,k=a;return k}function V(){var k=b;if(l.substr(b,3).toLowerCase()===Ke){var y=l.substr(b,3);b+=3}else y=a,0===ea&&A(Le);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="AND":(b=k,k=a)}else b=k,k=a;return k}function Y(){var k=b;if(l.substr(b,2).toLowerCase()===Me){var y=l.substr(b,2);b+=2}else y=a,0===ea&&A(Ne);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="OR":(b=k,k=a)}else b=
k,k=a;return k}function Z(){var k=b;if(l.substr(b,7).toLowerCase()===Oe){var y=l.substr(b,7);b+=7}else y=a,0===ea&&A(Pe);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="BETWEEN":(b=k,k=a)}else b=k,k=a;return k}function aa(){var k=b;if(l.substr(b,4).toLowerCase()===Qe){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(Re);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="FROM":(b=k,k=a)}else b=k,k=a;return k}function ha(){var k=b;if(l.substr(b,4).toLowerCase()===Se){var y=
l.substr(b,4);b+=4}else y=a,0===ea&&A(Te);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="TRIM":(b=k,k=a)}else b=k,k=a;return k}function ia(){var k=b;if(l.substr(b,8).toLowerCase()===Ue){var y=l.substr(b,8);b+=8}else y=a,0===ea&&A(Ve);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="INTERVAL":(b=k,k=a)}else b=k,k=a;return k}function ca(){var k=b;if(l.substr(b,4).toLowerCase()===We){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(Xe);if(y!==a){y=b;ea++;var N=F();
ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="YEAR":(b=k,k=a)}else b=k,k=a;return k}function ma(){var k=b;if(l.substr(b,5).toLowerCase()===Ye){var y=l.substr(b,5);b+=5}else y=a,0===ea&&A(Ze);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="MONTH":(b=k,k=a)}else b=k,k=a;return k}function sa(){var k=b;if(l.substr(b,3).toLowerCase()===$e){var y=l.substr(b,3);b+=3}else y=a,0===ea&&A(af);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="DAY":(b=k,k=a)}else b=k,k=a;return k}
function oa(){var k=b;if(l.substr(b,4).toLowerCase()===bf){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(cf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="HOUR":(b=k,k=a)}else b=k,k=a;return k}function la(){var k=b;if(l.substr(b,6).toLowerCase()===df){var y=l.substr(b,6);b+=6}else y=a,0===ea&&A(ef);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="MINUTE":(b=k,k=a)}else b=k,k=a;return k}function ja(){var k=b;if(l.substr(b,6).toLowerCase()===ff){var y=l.substr(b,
6);b+=6}else y=a,0===ea&&A(gf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="SECOND":(b=k,k=a)}else b=k,k=a;return k}function ra(){var k=b;if(l.substr(b,4).toLowerCase()===hf){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(jf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="CASE":(b=k,k=a)}else b=k,k=a;return k}function va(){var k=b;if(l.substr(b,3).toLowerCase()===kf){var y=l.substr(b,3);b+=3}else y=a,0===ea&&A(lf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=
void 0:(b=y,y=a);y!==a?k="END":(b=k,k=a)}else b=k,k=a;return k}function Ba(){var k=b;if(l.substr(b,4).toLowerCase()===mf){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(nf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="WHEN":(b=k,k=a)}else b=k,k=a;return k}function Ga(){var k=b;if(l.substr(b,4).toLowerCase()===of){var y=l.substr(b,4);b+=4}else y=a,0===ea&&A(pf);if(y!==a){y=b;ea++;var N=F();ea--;N===a?y=void 0:(b=y,y=a);y!==a?k="THEN":(b=k,k=a)}else b=k,k=a;return k}function wb(){if(44===
l.charCodeAt(b)){var k=qf;b++}else k=a,0===ea&&A(rf);return k}function Ha(){if(40===l.charCodeAt(b)){var k=sf;b++}else k=a,0===ea&&A(tf);return k}function Ia(){if(41===l.charCodeAt(b)){var k=uf;b++}else k=a,0===ea&&A(vf);return k}function fa(){var k;var y=[];for(k=Qc();k!==a;)y.push(k),k=Qc();return y}function Qc(){if(wf.test(l.charAt(b))){var k=l.charAt(b);b++}else k=a,0===ea&&A(xf);return k}function jc(k,y,N,da){k={type:"binary-expression",operator:k,left:y,right:N};void 0!==da&&(k.escape=da);return k}
function kb(k,y){for(var N=0;N<y.length;N++)k=jc(y[N][1],k,y[N][3]);return k}C=void 0!==C?C:{};var a={},Tc=C.grammarSource,Rc={start:P},Sc=P,Uc="!",hc="\x3d",kc="\x3e\x3d",Zc="\x3e",lc="\x3c\x3d",mc="\x3c\x3e",cd="\x3c",nc="!\x3d",Rb="+",Tb="-",fd="*",hd="/",he="@",Kc="'",Mc="N'",Pb="''",ue=".",qd="null",kd="true",nd="false",Ce="in",Ee="is",Ge="like",Wc="escape",Ie="not",Ke="and",Me="or",Oe="between",Qe="from",Kd="for",Fd="substring",zd="extract",Se="trim",Qd="position",wd="timestamp",td="date",je=
"leading",le="trailing",ne="both",pe="to",Ue="interval",We="year",Ye="month",$e="day",bf="hour",df="minute",ff="second",hf="case",kf="end",mf="when",of="then",se="else",qf=",",sf="(",uf=")",Dc="`",be=/^[A-Za-z_\x80-\uFFFF]/,de=/^[A-Za-z0-9_]/,fe=/^[A-Za-z0-9_.\x80-\uFFFF]/,Oc=/^[^']/,Ae=/^[0-9]/,we=/^[eE]/,ye=/^[+\-]/,wf=/^[ \t\n\r]/,Fc=/^[^`]/,Vc=p("!",!1),ic=p("\x3d",!1),Yc=p("\x3e\x3d",!1),$c=p("\x3e",!1),ad=p("\x3c\x3d",!1),bd=p("\x3c\x3e",!1),dd=p("\x3c",!1),ed=p("!\x3d",!1),Sb=p("+",!1),Ub=
p("-",!1),gd=p("*",!1),id=p("/",!1),ce=H([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),ee=H([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ge=H([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),ie=p("@",!1),Lc=p("'",!1),re=p("N'",!1),Nc=p("''",!1),Pc=H(["'"],!0,!1),ve=p(".",!1),Be=H([["0","9"]],!1,!1),xe=H(["e","E"],!1,!1),ze=H(["+","-"],!1,!1),rd=p("NULL",!0),ld=p("TRUE",!0),od=p("FALSE",!0),De=p("IN",!0),Fe=p("IS",!0),He=p("LIKE",!0),Xc=p("ESCAPE",!0),Je=p("NOT",!0),Le=p("AND",
!0),Ne=p("OR",!0),Pe=p("BETWEEN",!0),Re=p("FROM",!0),Ld=p("FOR",!0),Gd=p("SUBSTRING",!0),Ad=p("EXTRACT",!0),Te=p("TRIM",!0),Rd=p("POSITION",!0),xd=p("TIMESTAMP",!0),ud=p("DATE",!0),ke=p("LEADING",!0),me=p("TRAILING",!0),oe=p("BOTH",!0),qe=p("TO",!0),Ve=p("INTERVAL",!0),Xe=p("YEAR",!0),Ze=p("MONTH",!0),af=p("DAY",!0),cf=p("HOUR",!0),ef=p("MINUTE",!0),gf=p("SECOND",!0),jf=p("CASE",!0),lf=p("END",!0),nf=p("WHEN",!0),pf=p("THEN",!0),te=p("ELSE",!0),rf=p(",",!1),tf=p("(",!1),vf=p(")",!1),xf=H([" ","\t",
"\n","\r"],!1,!1),Ec=p("`",!1),Gc=H(["`"],!0,!1),b=0,vb=[{line:1,column:1}],Qa=0,Qb=[],ea=0;if("startRule"in C){if(!(C.startRule in Rc))throw Error("Can't start parsing from rule \""+C.startRule+'".');Sc=Rc[C.startRule]}var gc=Sc();if(gc!==a&&b===l.length)return gc;gc!==a&&b<l.length&&A({type:"end"});throw function(k,y,N){return new q(q.buildMessage(k,y),k,y,N)}(Qb,Qa<l.length?l.charAt(Qa):null,Qa<l.length?x(Qa,Qa+1):x(Qa,Qa));}}})})(g);let Q=function(){function h(){}h.parse=function(q){return g.exports.parse(q)};
return h}();d.WhereGrammar=Q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(d,D,g){function Q(e){return null==e||"string"===typeof e&&!e?"\x3cNull\x3e":e}function h(e){const c=null!=e.minValue||null!=e.maxValue,f=!!e.sqlExpression&&e.supportsSQLExpression;return!(null!=e.normalizationField||null!=e.normalizationType)&&
!c&&!f}function q(e){const {values:c,useSampleStdDev:f,supportsNullCount:m}=e;var E=Number.POSITIVE_INFINITY;let v=Number.NEGATIVE_INFINITY,r=null,I=null;var F=null;let J=null,L=0;const B=null==e.minValue?-Infinity:e.minValue,R=null==e.maxValue?Infinity:e.maxValue;for(const S of c)Number.isFinite(S)?S>=B&&S<=R&&(r+=S,E=Math.min(E,S),v=Math.max(v,S),L++):"string"===typeof S&&L++;if(L&&null!=r){I=r/L;F=0;for(const S of c)Number.isFinite(S)&&S>=B&&S<=R&&(F+=(S-I)**2);J=f?1<L?F/(L-1):0:0<L?F/L:0;F=Math.sqrt(J)}else v=
E=null;E={avg:I,count:L,max:v,min:E,stddev:F,sum:r,variance:J};m&&(E.nullcount=c.length-L);e.percentileParams&&(E.median=u(c,e.percentileParams));return E}function u(e,c){const {fieldType:f,value:m,orderBy:E,isDiscrete:v}=c,r=l(f,"desc"===E);e=[...e].filter(L=>null!=L).sort((L,B)=>r(L,B));if(0===e.length)return null;if(0>=m)return e[0];if(1<=m)return e[e.length-1];var I=(e.length-1)*m,F=Math.floor(I);c=F+1;I%=1;F=e[F];const J=e[c];return c>=e.length||v||"string"===typeof F||"string"===typeof J?F:
F*(1-I)+J*I}function l(e,c){const f=c?1:-1,m=p(c),E=C(c);if(!e||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...w].includes(e))return(v,r)=>"number"===typeof v&&"number"===typeof r?m(v,r):"string"===typeof v&&"string"===typeof r?E(v,r):f;if("esriFieldTypeDate"===e)return(v,r)=>{v=(new Date(v)).getTime();r=(new Date(r)).getTime();return isNaN(v)||isNaN(r)?f:m(v,r)};if(w.has(e))return(v,r)=>m(v,r);if("esriFieldTypeString"===e)return(v,r)=>E(v,r);if("esriFieldTypeGUID"===
e||"esriFieldTypeGlobalID"===e){const v=C(c);return(r,I)=>v(H(r),H(I))}return c?(v,r)=>1:(v,r)=>-1}function C(e){return e?(c,f)=>{c=c?.toUpperCase();f=f?.toUpperCase();return c>f?-1:c<f?1:0}:(c,f)=>{c=c?.toUpperCase();f=f?.toUpperCase();return c<f?-1:c>f?1:0}}function p(e){return e?(c,f)=>f-c:(c,f)=>c-f}function H(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function W(e){return"coded-value"!==
e?.type?[]:e.codedValues.map(c=>c.code)}function x(e,c){const f=P({field:c.field,normalizationType:c.normalizationType,normalizationField:c.normalizationField,classificationMethod:c.classificationMethod,standardDeviationInterval:c.standardDeviationInterval,breakCount:c.numClasses||5});e=A(e,c.minValue,c.maxValue);return g.createGenerateRendererClassBreaks({definition:f,values:e,normalizationTotal:c.normalizationTotal})}function A(e,c,f){c=null==c?-Infinity:c;f=null==f?Infinity:f;return e.filter(m=>
Number.isFinite(m)&&m>=c&&m<=f)}function P(e){const c=e.field,f=e.classificationMethod||"equal-interval",m=e.normalizationType,E=e.normalizationField,v=new D;v.classificationField=c;v.breakCount=e.breakCount;v.classificationMethod=f;v.standardDeviationInterval="standard-deviation"===f?e.standardDeviationInterval||1:void 0;v.normalizationType=m;v.normalizationField="field"===m?E:void 0;return v}function K(e,c){const {field:f,classificationMethod:m,standardDeviationInterval:E,normalizationType:v,normalizationField:r,
normalizationTotal:I,minValue:F,maxValue:J}=c,L=c.numBins||10;let B=c=null,R=null;m&&"equal-interval"!==m||v?({classBreaks:e}=x(e,{field:f,normalizationType:v,normalizationField:r,normalizationTotal:I,classificationMethod:m,standardDeviationInterval:E,minValue:F,maxValue:J,numClasses:L}),c=e[0].minValue,B=e[e.length-1].maxValue,R=e.map(S=>[S.minValue,S.maxValue])):(null!=F&&null!=J?(c=F,B=J):(e=q({values:e,minValue:F,maxValue:J,useSampleStdDev:!v,supportsNullCount:h({normalizationType:v,normalizationField:r,
minValue:F,maxValue:J})}),c=e.min,B=e.max),R=t(c,B,L));return{min:c,max:B,intervals:R}}function z(e,c){let f=-1;for(let m=e.length-1;0<=m;m--)if(c>=e[m][0]){f=m;break}return f}function t(e,c,f){const m=(c-e)/f,E=[];let v;for(let r=1;r<=f;r++)v=e+m,v=Number(v.toFixed(16)),E.push([e,r===f?c:v]),e=v;return E}const n=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,w=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),G="min max avg stddev count sum variance nullcount median".split(" ");
d.calculateClassBreaks=x;d.calculateHistogram=function(e,c){const {min:f,max:m,intervals:E}=K(e,c),v=E.map((r,I)=>({minValue:E[I][0],maxValue:E[I][1],count:0}));for(const r of e)null!=r&&r>=f&&r<=m&&(e=z(E,r),-1<e&&v[e].count++);return{bins:v,minValue:f,maxValue:m,normalizationTotal:c.normalizationTotal}};d.calculatePercentile=u;d.calculateStatistics=q;d.calculateStringStatistics=function(e){const c=e.returnDistinct?[...(new Set(e.values))]:e.values,f=c.filter(E=>null!=E).length,m={count:f};e.supportsNullCount&&
(m.nullcount=c.length-f);e.percentileParams&&(m.median=u(c,e.percentileParams));return m};d.calculateUniqueValuesCount=function(e){const c={};for(let f of e){if(null==f||"string"===typeof f&&""===f.trim())f=null;null==c[f]?c[f]={count:1,data:f}:c[f].count++}return{count:c}};d.createClassBreaksDefinition=P;d.createUVResult=function(e,c,f,m){e=e.count;const E=[];if(f&&c){f=[];var v=W(c[0]);for(const r of v)if(c[1]){v=W(c[1]);for(const I of v)if(c[2]){v=W(c[2]);for(const F of v)f.push(`${Q(r)}${m}${Q(I)}${m}${Q(F)}`)}else f.push(`${Q(r)}${m}${Q(I)}`)}else f.push(r);
for(const r of f)e.hasOwnProperty(r)||(e[r]={data:r,count:0})}for(const r in e)c=e[r],E.push({value:c.data,count:c.count,label:c.label});return{uniqueValueInfos:E}};d.getAttributeComparator=l;d.getEqualIntervalBins=t;d.getNormalizedValue=function(e,c,f,m){let E=null;switch(c){case "log":0!==e&&(E=Math.log(e)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(m)&&0!==m&&(E=e/m*100);break;case "field":Number.isFinite(f)&&0!==f&&(E=e/f);break;case "natural-log":0<e&&(E=Math.log(e));break;case "square-root":0<
e&&(E=e**.5)}return E};d.isNullCountSupported=h;d.processNullValue=Q;d.processSummaryStatisticsResult=function(e,c){let f;for(f in e)G.includes(f)&&(Number.isFinite(e[f])||(e[f]=null));if(!c)return e;["avg","stddev","variance"].forEach(m=>{null!=e[m]&&(e[m]=Math.ceil(e[m]))});return e};d.resolveCBResult=function(e,c){let f=e.classBreaks;const m=f[0].minValue,E=f[f.length-1].maxValue,v="standard-deviation"===c;f=f.map(r=>{const I=r.label;r={minValue:r.minValue,maxValue:r.maxValue,label:I};if(v&&I){const F=
I.match(n).map(J=>+J.trim());2===F.length?(r.minStdDev=F[0],r.maxStdDev=F[1],0>F[0]&&0<F[1]&&(r.hasAvg=!0)):1===F.length&&(I.includes("\x3c")?(r.minStdDev=null,r.maxStdDev=F[0]):I.includes("\x3e")&&(r.minStdDev=F[0],r.maxStdDev=null))}return r});return{minValue:m,maxValue:E,classBreakInfos:f,normalizationTotal:e.normalizationTotal}};d.statisticTypes=G;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ClassificationDefinition".split(" "),
function(d,D,g,Q,h,q,u,l){h=new g.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});g=new g.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});l=function(C){function p(){var H=C.apply(this,arguments)||this;H.breakCount=null;H.classificationField=
null;H.classificationMethod=null;H.normalizationField=null;H.normalizationType=null;H.type="class-breaks-definition";return H}d._inheritsLoose(p,C);d._createClass(p,[{key:"standardDeviationInterval",set:function(H){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",H)}},{key:"definedInterval",set:function(H){"defined-interval"===this.classificationMethod&&this._set("definedInterval",H)}}]);return p}(l);D.__decorate([Q.property({json:{write:!0}})],l.prototype,"breakCount",
void 0);D.__decorate([Q.property({json:{write:!0}})],l.prototype,"classificationField",void 0);D.__decorate([Q.property({type:String,json:{read:h.read,write:h.write}})],l.prototype,"classificationMethod",void 0);D.__decorate([Q.property({json:{write:!0}})],l.prototype,"normalizationField",void 0);D.__decorate([Q.property({json:{read:g.read,write:g.write}})],l.prototype,"normalizationType",void 0);D.__decorate([Q.property({value:null,json:{write:!0}})],l.prototype,"standardDeviationInterval",null);
D.__decorate([Q.property({value:null,json:{write:!0}})],l.prototype,"definedInterval",null);D.__decorate([Q.property()],l.prototype,"type",void 0);return l=D.__decorate([u.subclass("esri.rest.support.ClassBreaksDefinition")],l)})},"esri/rest/support/ClassificationDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./colorRamps ../../symbols/Symbol".split(" "),
function(d,D,g,Q,h,q,u,l,C,p){g=new g.JSONMap({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"});Q=function(H){function W(){var x=H.apply(this,arguments)||this;x.baseSymbol=null;x.colorRamp=null;x.type=null;return x}d._inheritsLoose(W,H);return W}(Q.JSONSupport);D.__decorate([h.property({type:p,json:{write:!0}})],Q.prototype,"baseSymbol",void 0);D.__decorate([h.property({types:C.types,json:{read:{reader:C.fromJSON},write:!0}})],Q.prototype,"colorRamp",void 0);D.__decorate([h.property({json:{read:g.read,
write:g.write}})],Q.prototype,"type",void 0);return Q=D.__decorate([l.subclass("esri.rest.support.ClassificationDefinition")],Q)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(d,D){function g(x){const {classificationMethod:A,breakCount:P,normalizationType:K,definedInterval:z}=x.definition,t=[];var n=x.values;if(0===n.length)return[];n=n.sort((m,E)=>m-E);var w=n[0],G=n[n.length-1];if("equal-interval"===A)if(n.length>=P){n=(G-w)/P;x=w;for(var e=
1;e<P;e++){var c=Number((w+e*n).toFixed(6));t.push({minValue:x,maxValue:c,label:Q(x,c,K)});x=c}t.push({minValue:x,maxValue:G,label:Q(x,G,K)})}else n.forEach(m=>{t.push({minValue:m,maxValue:m,label:Q(m,m,K)})});else if("natural-breaks"===A){n=h(n);x=q(n.uniqueValues,x.valueFrequency||n.valueFrequency,P);for(e=1;e<P;e++)n.uniqueValues.length>e&&(c=Number(n.uniqueValues[x[e]].toFixed(6)),t.push({minValue:w,maxValue:c,label:Q(w,c,K)}),w=c);t.push({minValue:w,maxValue:G,label:Q(w,G,K)})}else if("quantile"===
A)if(n.length>=P&&w!==G){x=Math.ceil(n.length/P);e=0;for(c=1;c<P;c++){var f=x+e-1;f>n.length&&(f=n.length-1);0>f&&(f=0);t.push({minValue:w,maxValue:n[f],label:Q(w,n[f],K)});w=n[f];e+=x;x=Math.ceil((n.length-e)/(P-c))}t.push({minValue:w,maxValue:G,label:Q(w,G,K)})}else for(G=-1,w=0;w<n.length;w++)x=n[w],x!==G&&(G=x,t.push({minValue:G,maxValue:x,label:Q(G,x,K)}),G=x);else if("standard-deviation"===A)if(x=C(n),e=p(n,x),0===e)t.push({minValue:n[0],maxValue:n[0],label:Q(n[0],n[0],K)});else{n=l(w,G,P,x,
e)*e;e=0;for(c=P;1<=c;c--)f=Number((x-(c-.5)*n).toFixed(6)),t.push({minValue:w,maxValue:f,label:Q(w,f,K)}),w=f,e++;c=Number((x+.5*n).toFixed(6));t.push({minValue:w,maxValue:c,label:Q(w,c,K)});w=c;e++;for(f=1;f<=P;f++)c=e===2*P?G:Number((x+(f+.5)*n).toFixed(6)),t.push({minValue:w,maxValue:c,label:Q(w,c,K)}),w=c,e++}else if("defined-interval"===A){if(!z)return t;G=n[0];n=n[n.length-1];w=Math.ceil((n-G)/z);x=G;for(e=1;e<w;e++)c=Number((G+e*z).toFixed(6)),t.push({minValue:x,maxValue:c,label:Q(x,c,K)}),
x=c;t.push({minValue:x,maxValue:n,label:Q(x,n,K)})}return t}function Q(x,A,P){let K=null;return K=x===A?P&&"percent-of-total"===P?x+"%":x.toString():P&&"percent-of-total"===P?x+"% - "+A+"%":x+" - "+A}function h(x){const A=[],P=[];let K=Number.MIN_VALUE,z=1,t=-1;for(let n=0;n<x.length;n++){const w=x[n];w===K?(z++,P[t]=z):null!==w&&(A.push(w),K=w,z=1,P.push(z),t++)}return{uniqueValues:A,valueFrequency:P}}function q(x,A,P){var K=x.length;const z=[];P>K&&(P=K);for(var t=0;t<P;t++)z.push(Math.round(t*
K/P-1));z.push(K-1);t=u(z,x,A,P);K=t.mean;t=t.sdcm;var n=P,w=0,G=0;let e=0,c=0,f=!0;for(let E=0;2>E&&f;E++){0===E&&(f=!1);for(var m=0;m<n-1;m++)for(;z[m+1]+1!==z[m+2];)if(z[m+1]+=1,w=H(m,z,x,A),e=w.sbMean,w=w.sbSdcm,G=H(m+1,z,x,A),c=G.sbMean,G=G.sbSdcm,w+G<t[m]+t[m+1])t[m]=w,t[m+1]=G,K[m]=e,K[m+1]=c,f=!0;else{--z[m+1];break}for(m=n-1;0<m;m--)for(;z[m]!==z[m-1]+1;)if(--z[m],w=H(m-1,z,x,A),e=w.sbMean,w=w.sbSdcm,G=H(m,z,x,A),c=G.sbMean,G=G.sbSdcm,w+G<t[m-1]+t[m])t[m-1]=w,t[m]=G,K[m-1]=e,K[m]=c,f=!0;
else{z[m]+=1;break}}f&&(t=u(z,x,A,P));return z}function u(x,A,P,K){let z=[];var t=[],n=[];let w=0;const G=[],e=[];for(var c=0;c<K;c++){var f=H(c,x,A,P);G.push(f.sbMean);e.push(f.sbSdcm);w+=e[c]}f=w;for(c=!0;c||w<f;){c=!1;z=[];for(t=0;t<K;t++)z.push(x[t]);for(n=0;n<K;n++)for(f=x[n]+1;f<=x[n+1];f++)if(t=A[f],0<n&&f!==x[n+1]&&Math.abs(t-G[n])>Math.abs(t-G[n-1]))x[n]=f;else if(n<K-1&&x[n]!==f-1&&Math.abs(t-G[n])>Math.abs(t-G[n+1])){x[n+1]=f-1;break}f=w;w=0;t=[];n=[];for(let m=0;m<K;m++){t.push(G[m]);
n.push(e[m]);const E=H(m,x,A,P);G[m]=E.sbMean;e[m]=E.sbSdcm;w+=e[m]}}if(w>f){for(A=0;A<K;A++)x[A]=z[A],G[A]=t[A],e[A]=n[A];w=f}return{mean:G,sdcm:e}}function l(x,A,P,K,z){x=Math.max(K-x,A-K)/z/P;return 1<=x?1:.5<=x?.5:.25}function C(x){let A=0;for(let P=0;P<x.length;P++)A+=x[P];return A/=x.length}function p(x,A){let P=0;for(let K=0;K<x.length;K++){const z=x[K];P+=(z-A)*(z-A)}P/=x.length;return Math.sqrt(P)}function H(x,A,P,K){var z=0,t=0;for(var n=A[x]+1;n<=A[x+1];n++){const w=K[n];z+=P[n]*w;t+=w}0>=
t&&W.warn("Exception in Natural Breaks calculation");z/=t;t=0;for(n=A[x]+1;n<=A[x+1];n++)t+=K[n]*(P[n]-z)**2;return{sbMean:z,sbSdcm:t}}const W=D.getLogger("esri.rest.support.generateRendererUtils");d.createGenerateRendererClassBreaks=function(x){const {normalizationTotal:A}=x;return{classBreaks:g(x),normalizationTotal:A}};d.createGenerateRendererUniqueValues=function(x){x=h(x);const A=[],P=x.uniqueValues.length;for(let K=0;K<P;K++){const z=x.uniqueValues[K];A.push({value:z,count:x.valueFrequency[K],
label:z.toString()})}return{uniqueValues:A}};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(d,D,g,Q,h,q,u){function l(K,z){if(!z)return null;
if("x"in z){var t={x:0,y:0};[t.x,t.y]=K(z.x,z.y,W);null!=z.z&&(t.z=z.z);null!=z.m&&(t.m=z.m);return t}return"xmin"in z?(t={xmin:0,ymin:0,xmax:0,ymax:0},[t.xmin,t.ymin]=K(z.xmin,z.ymin,W),[t.xmax,t.ymax]=K(z.xmax,z.ymax,W),z.hasZ&&(t.zmin=z.zmin,t.zmax=z.zmax,t.hasZ=!0),z.hasM&&(t.mmin=z.mmin,t.mmax=z.mmax,t.hasM=!0),t):"rings"in z?{rings:C(z.rings,K),hasM:z.hasM,hasZ:z.hasZ}:"paths"in z?{paths:C(z.paths,K),hasM:z.hasM,hasZ:z.hasZ}:"points"in z?{points:p(z.points,K),hasM:z.hasM,hasZ:z.hasZ}:null}function C(K,
z){const t=[];for(const n of K)t.push(p(n,z));return t}function p(K,z){const t=[];for(const n of K)K=z(n[0],n[1],[0,0]),t.push(K),2<n.length&&K.push(n[2]),3<n.length&&K.push(n[3]);return t}function H(){H=D._asyncToGenerator(function*(K,z){K&&z&&(K=Array.isArray(K)?K.map(t=>g.isSome(t.geometry)?t.geometry.spatialReference:null).filter(g.isSome):[K],yield Q.initializeProjection(K.map(t=>({source:t,dest:z}))))});return H.apply(this,arguments)}const W=[0,0],x=l.bind(null,u.lngLatToXY),A=l.bind(null,u.xyToLngLat),
P=new (function(){function K(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var z=K.prototype;z.push=function(){var t=D._asyncToGenerator(function*(n,w,G){if(!(n&&n.length&&w&&G)||q.equals(w,G))return n;const e={geometries:n,inSpatialReference:w,outSpatialReference:G,resolve:null};this._jobs.push(e);return new Promise(c=>{e.resolve=c;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(n,w,G){return t.apply(this,arguments)}}();z._process=function(){this._timer=
null;const t=this._jobs.shift();if(t){var {geometries:n,inSpatialReference:w,outSpatialReference:G,resolve:e}=t;u.canProject(w,G)?q.isWebMercator(G)?e(n.map(x)):e(n.map(A)):e(Q.projectMany(h.jsonAdapter,n,w,G,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return K}());d.checkProjectionSupport=function(K,z){return H.apply(this,arguments)};d.project=function(K,z,t,n){if(!K)return K;t||(t=z,z=K.spatialReference);return q.isValid(z)&&q.isValid(t)&&!q.equals(z,t)?u.canProject(z,
t)?(K=q.isWebMercator(t)?x(K):A(K),K.spatialReference=t,K):Q.projectMany(h.jsonAdapter,[K],z,t,null,n)[0]:K};d.projectMany=function(K,z,t){return P.push(K,z,t)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(d){let D=function(u,l,C){this.x=u;this.y=l;this.spatialReference=C;this.m=this.z=void 0},g=function(u,l,C,p){this.rings=u;this.spatialReference=l;this.hasM=this.hasZ=void 0;
C&&(this.hasZ=C);p&&(this.hasM=p)},Q=function(u,l,C,p){this.paths=u;this.spatialReference=l;this.hasM=this.hasZ=void 0;C&&(this.hasZ=C);p&&(this.hasM=p)},h=function(u,l,C,p){this.points=u;this.spatialReference=l;this.hasM=this.hasZ=void 0;C&&(this.hasZ=C);p&&(this.hasM=p)},q=function(u,l,C,p,H){this.xmin=u;this.ymin=l;this.xmax=C;this.ymax=p;this.spatialReference=H;this.mmax=this.mmin=this.zmax=this.zmin=void 0};d.jsonAdapter={convertToGEGeometry:function(u,l){return null==l?null:u.convertJSONToGeometry(l)},
exportPoint:function(u,l,C){C=new D(u.getPointX(l),u.getPointY(l),C);const p=u.hasZ(l),H=u.hasM(l);p&&(C.z=u.getPointZ(l));H&&(C.m=u.getPointM(l));return C},exportPolygon:function(u,l,C){return new g(u.exportPaths(l),C,u.hasZ(l),u.hasM(l))},exportPolyline:function(u,l,C){return new Q(u.exportPaths(l),C,u.hasZ(l),u.hasM(l))},exportMultipoint:function(u,l,C){return new h(u.exportPoints(l),C,u.hasZ(l),u.hasM(l))},exportExtent:function(u,l,C){var p=u.hasZ(l);const H=u.hasM(l);C=new q(u.getXMin(l),u.getYMin(l),
u.getXMax(l),u.getYMax(l),C);p&&(p=u.getZExtent(l),C.zmin=p.vmin,C.zmax=p.vmax);H&&(u=u.getMExtent(l),C.mmin=u.vmin,C.mmax=u.vmax);return C}};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(d){d.makeEdgeCandidate=function(D,g,Q,h,q,u=!1){return{objectId:D,target:g,distance:Q,type:"edge",start:h,end:q,draped:u}};d.makeVertexCandidate=function(D,g,Q){return{objectId:D,target:g,
distance:Q,type:"vertex"}};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A){function P(){P=g._asyncToGenerator(function*(F,J,L){const {outFields:B,orderByFields:R,groupByFieldsForStatistics:S,outStatistics:U}=F;if(B)for(var T=0;T<B.length;T++)B[T]=B[T].trim();if(R)for(T=0;T<R.length;T++)R[T]=R[T].trim();if(S)for(T=0;T<S.length;T++)S[T]=S[T].trim();if(U)for(T=0;T<U.length;T++)U[T].onStatisticField&&(U[T].onStatisticField=U[T].onStatisticField.trim());F.geometry&&!F.outSR&&(F.outSR=F.geometry.spatialReference);return K(F,J,L)});return P.apply(this,
arguments)}function K(F,J,L){return z.apply(this,arguments)}function z(){z=g._asyncToGenerator(function*(F,J,L){if(!F)return null;var {where:B}=F;F.where=B=B&&B.trim();if(!B||/^1 *= *1$/.test(B)||J&&J===B)F.where=null;if(!F.geometry)return F;J=yield n(F);F.distance=0;F.units=null;"esriSpatialRelEnvelopeIntersects"===F.spatialRel&&({spatialReference:B}=F.geometry,J=l.getGeometryExtent(J),J.spatialReference=B);if(J){yield A.checkProjectionSupport(J.spatialReference,L);B=J.spatialReference;J=t(J,L)&&
C.isExtent(J)?{spatialReference:B,rings:[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]]}:J;B=(yield p.normalizeCentralMeridian(C.fromJSON(J)))[0];if(h.isNone(B))throw f;const R="quantizationParameters"in F&&F.quantizationParameters?.tolerance||"maxAllowableOffset"in F&&F.maxAllowableOffset||0;J=R&&t(J,L)?{densificationStep:8*R}:void 0;B=B.toJSON();J=yield A.project(B,B.spatialReference,L,J);if(!J)throw f;J.spatialReference=L;F.geometry=J}return F});return z.apply(this,
arguments)}function t(F,J){if(!F)return!1;const L=F.spatialReference;return(C.isExtent(F)||C.isPolygon(F)||C.isPolyline(F))&&!H.equals(L,J)&&!u.canProjectWithoutEngine(L,J)}function n(F){return w.apply(this,arguments)}function w(){w=g._asyncToGenerator(function*(F){const {distance:J,units:L}=F,B=F.geometry;if(null==J||"vertexAttributes"in B)return B;var R=B.spatialReference;F=L?c.fromJSON(L):q.getUnitString(R);R=R&&(H.isGeographic(R)||H.isWebMercator(R))?B:yield A.checkProjectionSupport(R,H.WGS84).then(()=>
A.project(B,H.WGS84));return(yield G())(R.spatialReference,R,J,F)});return w.apply(this,arguments)}function G(){return e.apply(this,arguments)}function e(){e=g._asyncToGenerator(function*(){return(yield new Promise((F,J)=>d(["../../../geometry/geometryEngineJSON"],F,J))).geodesicBuffer});return e.apply(this,arguments)}const c=new Q.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),
f=Object.freeze({}),m=new x,E=new x,v=new x,r={esriGeometryPoint:W.convertToPoint,esriGeometryPolyline:W.convertToPolyline,esriGeometryPolygon:W.convertToPolygon,esriGeometryMultipoint:W.convertToMultipoint},I=(F,J)=>"_geVersion"!==F?J:void 0;D.QUERY_ENGINE_EMPTY_RESULT=f;D.cleanFromGeometryEngine=function(F){return F&&"_geVersion"in F?JSON.parse(JSON.stringify(F,I)):F};D.getGeometry=function(F,J,L,B,R,S,U=J,T=L){const O=J&&U,M=L&&T;B=h.isSome(B)?"coords"in B?B:B.geometry:null;if(h.isNone(B))return null;
if(R)return J=W.generalizeOptimizedGeometry(E,B,J,L,F,R,U,T),S&&(J=W.quantizeOptimizedGeometry(v,J,O,M,F,S)),r[F]?.(J,O,M)??null;if(S)return S=W.quantizeOptimizedGeometry(v,B,J,L,F,S,U,T),r[F]?.(S,O,M)??null;W.removeZMValues(m,B,J,L,U,T);return r[F]?.(m,O,M)??null};D.normalizeQuery=function(F,J,L){return P.apply(this,arguments)};D.normalizeQueryLike=K;D.transformCentroid=function(F,J,L,B=F.hasZ,R=F.hasM){if(h.isNone(J))return null;const S=F.hasZ&&B,U=F.hasM&&R;return L?(F=W.quantizeOptimizedGeometry(v,
J,F.hasZ,F.hasM,"esriGeometryPoint",L,B,R),W.convertToPoint(F,S,U)):W.convertToPoint(J,S,U)};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./Settings ./snappingUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H){function W(U,T){const O=p.projectPointToVerticalPlane(T,U.planeLike);U=U.getZ(T[0],T[1],T[2]);g.isSome(U)&&(O[2]=U);return O}function x(U,T){let O=[];if(K(U)){var {pointXYZ:M}=U;z(T)?O=p.intersectLineAndPoint(T.lineLike,M):t(T)?O=p.intersectCircleAndPoint(T.centerXYZ,T.radius,M):n(T)?O=p.intersectVerticalPlaneAndPoint(T.planeLike,M):w(T)&&(O=A(T,U))}else if(z(U))({lineLike:M}=U),K(T)?O=p.intersectLineAndPoint(M,T.pointXYZ):z(T)?O=p.intersectLineLike(M,T.lineLike):t(T)?
O=p.intersectLineLikeAndCircle(M,T.centerXYZ,T.radius):n(T)?O=p.intersectVerticalPlaneAndLineLike(T.planeLike,M):w(T)&&(O=A(T,U));else if(t(U)){const {centerXYZ:X,radius:ba}=U;z(T)?O=p.intersectLineLikeAndCircle(T.lineLike,X,ba):K(T)?O=p.intersectCircleAndPoint(X,ba,T.pointXYZ):n(T)?O=p.intersectVerticalPlaneAndCircle(T.planeLike,X,ba):w(T)&&(O=A(T,U))}else if(n(U)){const {planeLike:X,coordinateHelper:ba}=U;if(n(T))return p.intersectVerticalPlane(X,T.planeLike).map(ka=>new E(ba,ba.fromXYZ(ka),U,T));
K(T)?O=p.intersectVerticalPlaneAndPoint(X,T.pointXYZ):z(T)?O=p.intersectVerticalPlaneAndLineLike(X,T.lineLike):t(T)?O=p.intersectVerticalPlaneAndCircle(X,T.centerXYZ,T.radius):w(T)&&(O=A(T,U))}else w(U)&&(O=A(U,T));return P(O,U,T)}function A(U,T){const {planeLike:O,getZ:M}=U,X=[];if(K(T))U.addIfOnTheGround(X,p.intersectVerticalPlaneAndPoint(O,T.pointXYZ));else if(z(T))U.addIfOnTheGround(X,p.intersectVerticalPlaneAndLineLike(O,T.lineLike));else if(t(T))U.addIfOnTheGround(X,p.intersectVerticalPlaneAndCircle(O,
T.centerXYZ,T.radius));else if(n(T)||w(T))for(const [ba,ka]of p.intersectVerticalPlane(O,T.planeLike))U=M(ba,ka,0),g.isSome(U)&&X.push(u.fromValues(ba,ka,U));return X}function P(U,T,O){const M=T.coordinateHelper;return U.map(X=>new m(M,M.fromXYZ(X),T,O))}function K(U){return U instanceof e}function z(U){return U instanceof c}function t(U){return U instanceof v}function n(U){return U instanceof r}function w(U){return U instanceof J}let G=function(){function U(T){this.coordinateHelper=T}U.prototype.intersect=
function(T){return x(this,T)};return U}(),e=function(U){function T(M,X){var ba=U.call(this,M)||this;ba.point=X;ba.pointXYZ=M.toXYZ(X);return ba}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return K(M)&&C.objectEqual(this.point,M.point)};O.check=function(M){M=this.coordinateHelper.toXYZ(M,L);return q.squaredDistance(M,this.pointXYZ)<l.defaults.pointThreshold};O.closestTo=function(){return this.coordinateHelper.clone(this.point)};return T}(G),c=function(U){function T(M,X,ba,ka){var qa=
U.call(this,M)||this;qa.start=X;qa.end=ba;qa.type=ka;qa.startXYZ=M.toXYZ(X);qa.endXYZ=M.toXYZ(ba);qa.lineLike={start:qa.startXYZ,end:qa.endXYZ,type:qa.type};return qa}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return z(M)&&this.type===M.type&&C.objectEqual(this.start,M.start)&&C.objectEqual(this.end,M.end)};O.check=function(M){M=this.coordinateHelper.toXYZ(M,L);return p.pointToLineLikeDistance(this.lineLike,M)<l.defaults.pointOnLineThreshold};O.closestTo=function(M){const X=this.coordinateHelper;
M=X.toXYZ(M,L);M=p.projectPointToLineLike(M,this.lineLike);return X.fromXYZ(M)};return T}(G),f=function(U){function T(O,M,X){return U.call(this,O,M,X,H.LineType.LINE)||this}D._inheritsLoose(T,U);return T}(c),m=function(U){function T(M,X,ba,ka){M=U.call(this,M)||this;M.intersection=X;M.first=ba;M.second=ka;return M}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return M instanceof T&&this.first.equals(M.first)&&this.second.equals(M.second)};O.check=function(){return!1};O.closestTo=function(){return this.coordinateHelper.clone(this.intersection)};
return T}(G),E=function(U){function T(M,X,ba,ka){M=U.call(this,M)||this;M.basePoint=X;M.first=ba;M.second=ka;return M}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return M instanceof T&&this.first.equals(M.first)&&this.second.equals(M.second)};O.check=function(){return!1};O.closestTo=function(M){var X=this.basePoint;const ba=this.coordinateHelper;M=ba.toXYZ(M,L);X=q.set(B,X[0],X[1],M[2]);return ba.fromXYZ(X)};return T}(G),v=function(U){function T(M,X,ba){var ka=U.call(this,M)||this;
ka.center=X;ka.radius=ba;ka.centerXYZ=M.toXYZ(X);return ka}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return t(M)&&this.center[0]===M.center[0]&&this.center[1]===M.center[1]&&this.radius===M.radius};O.check=function(){return!1};O.closestTo=function(M){const X=this.coordinateHelper;var ba=X.toXYZ(M,L);ba=p.projectPointToCircle(ba,this.centerXYZ,this.radius);ba[2]=X.getZ(M,this.centerXYZ[2]);return X.fromXYZ(ba)};return T}(G),r=function(U){function T(M,X,ba,ka){M=U.call(this,M)||this;
M.start=X;M.end=ba;M.type=ka;M.planeLike={start:X,end:ba,type:ka};return M}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return n(M)&&this.type===M.type&&C.objectEqual(this.start,M.start)&&C.objectEqual(this.end,M.end)};O.check=function(M){M=this.coordinateHelper.toXYZ(M,L);return p.pointToVerticalPlaneDistance(M,this.planeLike)<l.defaults.pointOnLineThreshold};O.closestTo=function(M){const X=this.coordinateHelper;M=X.toXYZ(M,L);M=p.projectPointToVerticalPlane(M,this.planeLike);return X.fromXYZ(M)};
O.closestEndTo=function(M){const {start:X,end:ba}=this;return 0<Math.sign(Q.dot(Q.subtract(R,ba,X),Q.subtract(S,M,X)))?ba:X};return T}(G),I=function(U){function T(O,M,X){return U.call(this,O,M,X,p.VerticalPlaneType.HALF_PLANE)||this}D._inheritsLoose(T,U);return T}(r),F=function(U){function T(O,M,X){return U.call(this,O,M,X,p.VerticalPlaneType.PLANE)||this}D._inheritsLoose(T,U);return T}(r),J=function(U){function T(M,X,ba,ka){M=U.call(this,M)||this;M.start=X;M.end=ba;M.getZ=ka;M.planeLike={start:X,
end:ba,type:p.VerticalPlaneType.HALF_PLANE};return M}D._inheritsLoose(T,U);var O=T.prototype;O.equals=function(M){return w(M)&&C.objectEqual(this.start,M.start)&&C.objectEqual(this.end,M.end)&&this.getZ===M.getZ};O.check=function(M){M=this.coordinateHelper.toXYZ(M,L);const X=W(this,M);return q.squaredDistance(M,X)<l.defaults.pointThreshold};O.closestTo=function(M){const X=this.coordinateHelper;M=W(this,X.toXYZ(M,L));return X.fromXYZ(M)};O.addIfOnTheGround=function(M,X){for(const ba of X)X=this.getZ(ba[0],
ba[1],ba[2]),g.isSome(X)&&Math.abs(ba[2]-X)<p.epsilon&&(ba[2]=X,M.push(ba))};return T}(G);const L=u.create(),B=u.create(),R=h.create(),S=h.create();d.DrapedLineConstraint=J;d.IntersectionConstraint=m;d.LineConstraint=f;d.LineLikeConstraint=c;d.PlanarCircleConstraint=v;d.PointConstraint=e;d.SnappingConstraint=G;d.VerticalHalfPlaneConstraint=I;d.VerticalLineIntersectionConstraint=E;d.VerticalPlaneConstraint=F;d.VerticalPlaneLikeConstraint=r;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/chunks/vec2f64":function(){define(["exports"],function(d){function D(){return[0,0]}function g(K){return[K[0],K[1]]}function Q(K,z){return[K,z]}function h(K){const z=[0,0],t=Math.min(2,K.length);for(let n=0;n<t;++n)z[n]=K[n];return z}function q(K,z){return new Float64Array(K,z,2)}function u(){return[0,0]}function l(){return[1,1]}function C(){return[1,0]}function p(){return[0,1]}const H=[0,0],W=[1,1],x=[1,0],A=[0,1],P=Object.freeze(Object.defineProperty({__proto__:null,create:D,clone:g,fromValues:Q,
fromArray:h,createView:q,zeros:u,ones:l,unitX:C,unitY:p,ZEROS:H,ONES:W,UNIT_X:x,UNIT_Y:A},Symbol.toStringTag,{value:"Module"}));d.ONES=W;d.UNIT_X=x;d.UNIT_Y=A;d.ZEROS=H;d.clone=g;d.create=D;d.createView=q;d.fromArray=h;d.fromValues=Q;d.ones=l;d.unitX=C;d.unitY=p;d.vec2f64=P;d.zeros=u})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,D,g,Q,h,q,u){let l=function(C){function p(){var H=C.apply(this,arguments)||this;H.enabled=!0;return H}D._inheritsLoose(p,C);return p}(h.JSONSupport);g.__decorate([q.property({type:Boolean})],l.prototype,"enabled",void 0);l=g.__decorate([u.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],l);h=function(C){function p(H){H=C.call(this,H)||this;H.lineSnapper=new l;H.parallelLineSnapper=new l;H.rightAngleSnapper=new l;H.rightAngleTriangleSnapper=new l;H.shortLineThreshold=
15;H.distance=5;H.pointThreshold=1E-6;H.intersectionParallelLineThreshold=1E-6;H.parallelLineThreshold=1E-6;H.touchSensitivityMultiplier=1.5;H.pointOnLineThreshold=1E-6;H.orange=new Q([255,127,0]);H.lineHintWidthReference=3;H.lineHintWidthTarget=3;H.lineHintFadedExtensions=.3;H.parallelLineHintWidth=2;H.parallelLineHintLength=24;H.parallelLineHintOffset=1.5;H.rightAngleHintSize=24;H.rightAngleHintOutlineSize=1.5;return H}D._inheritsLoose(p,C);return p}(h.JSONSupport);g.__decorate([q.property({type:l,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"lineSnapper",void 0);g.__decorate([q.property({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"parallelLineSnapper",void 0);g.__decorate([q.property({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"rightAngleSnapper",void 0);g.__decorate([q.property({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],h.prototype,"rightAngleTriangleSnapper",void 0);g.__decorate([q.property({type:Number,
nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],h.prototype,"shortLineThreshold",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],h.prototype,"distance",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],h.prototype,"pointThreshold",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],h.prototype,"intersectionParallelLineThreshold",
void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],h.prototype,"parallelLineThreshold",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"touchSensitivityMultiplier",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],h.prototype,"pointOnLineThreshold",void 0);g.__decorate([q.property({type:Q,nonNullable:!0})],h.prototype,"orange",void 0);
g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"lineHintWidthReference",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],h.prototype,"lineHintWidthTarget",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],h.prototype,"lineHintFadedExtensions",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
h.prototype,"parallelLineHintWidth",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],h.prototype,"parallelLineHintLength",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],h.prototype,"parallelLineHintOffset",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],h.prototype,"rightAngleHintSize",void 0);g.__decorate([q.property({type:Number,nonNullable:!0,
range:{min:0,max:6},json:{write:!0}})],h.prototype,"rightAngleHintOutlineSize",void 0);h=g.__decorate([u.subclass("esri.views.interactive.snapping.Settings.Defaults")],h);g=new h;d.defaults=g;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/snappingUtils":function(){define(["exports","../../../core/maybe","../../../chunks/vec3","../../../chunks/vec3f64","../../../support/elevationInfoUtils"],function(d,D,g,Q,h){function q(p,
H){const W=p.x-H.x;p=p.y-H.y;return W*W+p*p}function u(p,H,W,x){const {coordinateHelper:A,elevationInfo:P}=W;if(!A.hasZ()||D.isNone(H)||"3d"!==H.type||D.isNone(p)||h.elevationInfoLikeEquals(P,x))return p;H=h.getConvertedElevationFromVector(H,p,A.spatialReference,P,x);p=A.clone(p);p[2]=H;return p}const l=Q.create(),C=Q.create();d.LineSegmentHintType=void 0;(function(p){p[p.TARGET=0]="TARGET";p[p.REFERENCE=1]="REFERENCE";p[p.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(d.LineSegmentHintType||(d.LineSegmentHintType=
{}));d.convertPointElevation=u;d.editEdgeToSnappingEdge=function(p,H,W,x=h.absoluteHeightElevationInfo){return{left:u(p.leftVertex.pos,H,W,x),right:u(p.rightVertex.pos,H,W,x)}};d.makeFilter=function(p){return p.createQuery()};d.makeSnappingQuery=function(p,H){return{point:p.coordinateHelper.vectorToPoint(p.point).toJSON(),distance:p.distance,types:p.types,query:D.isSome(H)?H.toJSON():{where:"1\x3d1"}}};d.objectEqual=function(p,H){const W=p.length===H.length&&p[0]===H[0]&&p[1]===H[1];switch(p.length){case 2:return W;
case 3:return W&&p[2]===H[2];case 4:return W&&p[2]===H[2]&&p[3]===H[3]}return!1};d.screenDistance=function(p,H){return Math.sqrt(q(p,H))};d.sortCandidatesInPlace=function(p,H,W){const x=W.toXYZ(p,l);H.sort((A,P)=>{A=W.toXYZ(A.targetPoint,C);A=g.squaredDistance(A,x);P=W.toXYZ(P.targetPoint,C);P=g.squaredDistance(P,x);return A-P})};d.squaredScreenDistance=q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),
function(d,D,g,Q,h,q,u){function l(f,{start:m,end:E,type:v}){f=h.sub(P,f,m);E=h.sub(K,E,m);f=h.dot(f,E)/h.dot(E,E);return h.scaleAndAdd(q.create(),m,E,v===u.LineType.RAY?Math.max(f,0):f)}function C({start:f,end:m,type:E},v){const r=h.sub(P,v,f);m=h.sub(K,m,f);if(E===u.LineType.RAY&&-1E-6>h.dot(m,r))return h.distance(f,v);f=h.cross(z,m,r);return h.len(f)/h.len(m)}function p(f,m){const E=f.start,v=m.start;var r=m.end;const I=h.sub(P,f.end,E);r=h.sub(K,r,v);var F=h.sub(z,v,E),J=h.cross(t,I,r),L=h.dot(F,
J);if(!D.floatEqualAbsolute(L,0,1E-6))return[];L=h.sqrLen(J);if(D.floatEqualAbsolute(L,0,1E-6))return[];F=h.cross(n,F,r);J=h.dot(F,J)/L;J=h.scaleAndAdd(w,E,I,J);return f.type===u.LineType.RAY&&(f=h.sub(G,J,E),-1E-6>h.dot(I,f))||m.type===u.LineType.RAY&&(m=h.sub(G,J,v),-1E-6>h.dot(r,m))?[]:[q.clone(J)]}function H({start:f,end:m,type:E},v){const r=h.sub(P,v,f);f=h.sub(K,m,f);m=h.cross(z,f,r);if(1E-6>h.sqrLen(m)/h.sqrLen(f))switch(E){case u.LineType.LINE:return[q.clone(v)];case u.LineType.RAY:return-1E-6>
h.dot(f,r)?[]:[q.clone(v)]}return[]}function W(f,m,E){return D.floatEqualAbsolute(f[2],E[2],1E-6)&&D.floatEqualAbsolute(h.squaredDistance(E,f),m*m,1E-6)?[q.clone(E)]:[]}function x(f,m,{start:E,end:v,type:r}){h.set(f.start,E[0],E[1],m);h.set(f.end,v[0],v[1],m);f.type=A[r];return f}d.VerticalPlaneType=void 0;(function(f){f[f.PLANE=0]="PLANE";f[f.HALF_PLANE=1]="HALF_PLANE"})(d.VerticalPlaneType||(d.VerticalPlaneType={}));const A={[d.VerticalPlaneType.PLANE]:u.LineType.LINE,[d.VerticalPlaneType.HALF_PLANE]:u.LineType.RAY},
P=q.create(),K=q.create(),z=q.create(),t=q.create(),n=q.create(),w=q.create(),G=q.create(),e={start:q.create(),end:q.create(),type:u.LineType.LINE},c={start:q.create(),end:q.create(),type:u.LineType.LINE};Object.defineProperty(d,"LineType",{enumerable:!0,get:()=>u.LineType});d.epsilon=1E-6;d.intersectCircleAndPoint=W;d.intersectLineAndPoint=H;d.intersectLineLike=p;d.intersectLineLikeAndCircle=function({start:f,end:m,type:E},v,r){const I=[];if(D.floatEqualAbsolute(f[2],v[2],1E-6)&&D.floatEqualAbsolute(m[2],
v[2],1E-6)){var F=g.subtract(P,m,f),J=g.subtract(K,f,v);m=g.squaredLength(F);var L=2*g.dot(F,J);r=g.squaredLength(J)-r*r;r=L*L-4*m*r;0===r?(r=-L/(2*m),(E===u.LineType.LINE||0<=r)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,F,r))):0<r&&(r=Math.sqrt(r),J=(-L+r)/(2*m),(E===u.LineType.LINE||0<=J)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,F,J)),r=(-L-r)/(2*m),(E===u.LineType.LINE||0<=r)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,F,r)))}else{m=h.sub(P,m,f);if(D.floatEqualAbsolute(m[2],0,1E-6))return I;
L=h.scaleAndAdd(K,f,m,(v[2]-f[2])/m[2]);if(E===u.LineType.RAY&&(f=h.sub(z,L,f),-1E-6>h.dot(m,f)))return I;for(F of W(v,r,L))I.push(F)}return I};d.intersectVerticalPlane=function(f,m){f=x(e,0,f);m=x(c,0,m);m=p(f,m);f=[];for(const E of m)f.push(Q.clone(E));return f};d.intersectVerticalPlaneAndCircle=function({start:f,end:m,type:E},v,r){const I=[];m=g.subtract(P,m,f);var F=g.subtract(K,f,v),J=g.squaredLength(m);const L=2*g.dot(m,F);r=g.squaredLength(F)-r*r;r=L*L-4*J*r;0===r?(J=-L/(2*J),(E===d.VerticalPlaneType.PLANE||
0<=J)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,m,J))):0<r&&(r=Math.sqrt(r),F=(-L+r)/(2*J),(E===d.VerticalPlaneType.PLANE||0<=F)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,m,F)),J=(-L-r)/(2*J),(E===d.VerticalPlaneType.PLANE||0<=J)&&I.push(g.scaleAndAdd(q.fromValues(0,0,v[2]),f,m,J)));return I};d.intersectVerticalPlaneAndLineLike=function(f,m){const E=f.start,v=g.subtract(P,f.end,E);var r=h.set(K,-v[1],v[0],0);const I=m.start,F=h.sub(z,m.end,I);var J=h.dot(F,r),L=h.set(t,E[0],E[1],0);L=h.sub(n,
L,I);r=h.dot(L,r);if(1E-6>Math.abs(J))return[];J=h.scaleAndAdd(w,I,F,r/J);return m.type===u.LineType.RAY&&(m=h.sub(G,J,I),-1E-6>h.dot(m,F))||f.type===d.VerticalPlaneType.HALF_PLANE&&(f=g.sub(G,J,E),-1E-6>g.dot(f,v))?[]:[q.clone(J)]};d.intersectVerticalPlaneAndPoint=function(f,m){return H(x(e,m[2],f),m)};d.pointToLineLikeDistance=C;d.pointToVerticalPlaneDistance=function(f,m){return C(x(e,f[2],m),f)};d.projectPointToCircle=function(f,m,E){f=h.set(P,f[0],f[1],m[2]);f=h.subtract(K,f,m);E/=h.length(f);
return h.scaleAndAdd(q.create(),m,f,E)};d.projectPointToLineLike=l;d.projectPointToVerticalPlane=function(f,m){return l(f,x(e,f[2],m))};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(d,D,g,Q){function h(x,A){return x[0]*A[1]-x[1]*A[0]}function q(x,A,P){A=g.dot(P,A)/g.squaredLength(P);return g.scale(x,P,A)}function u(x,
A,P,K,z=P){g.subtract(C,K,P);g.subtract(H,A,z);q(W,H,C);return g.add(x,z,W)}function l(x,A,P,K){g.subtract(C,A,P);A=K/g.length(C);return g.scaleAndAdd(x,P,C,A)}d.LineType=void 0;(function(x){x[x.RAY=0]="RAY";x[x.LINE=1]="LINE"})(d.LineType||(d.LineType={}));const C=Q.create(),p=Q.create(),H=Q.create(),W=Q.create();d.cross=h;d.intersectCircleAndPoint=function(x,A,P){l(H,P,x,A);return D.floatEqualAbsolute(H[0],P[0])&&D.floatEqualAbsolute(H[1],P[1])?[Q.clone(P)]:[]};d.intersectLineAndPoint=function(x,
A){u(H,A,x.start,x.end);return D.floatEqualAbsolute(H[0],A[0])&&D.floatEqualAbsolute(H[1],A[1])?[Q.clone(A)]:[]};d.intersectLineAndRay=function(x,A){const P=x.start;var K=A.start,z=A.end;const t=g.subtract(C,x.end,P);var n=g.subtract(p,z,K);z=h(t,n);if(1E-6>=Math.abs(z))return[];K=g.subtract(H,P,K);n=h(n,K)/z;z=h(t,K)/z;if(0<=n){if(0<=z||A.type===d.LineType.LINE)return[g.scaleAndAdd(W,P,t,n)]}else if(x.type===d.LineType.LINE&&(0<=z||A.type===d.LineType.LINE))return[g.scaleAndAdd(W,P,t,n)];return[]};
d.intersectLineLikeAndCircle=function(x,A,P){const K=[],z=g.subtract(C,x.end,x.start);var t=g.subtract(p,x.start,A);A=g.squaredLength(z);const n=2*g.dot(z,t);P=g.squaredLength(t)-P*P;P=n*n-4*A*P;0===P?(A=-n/(2*A),(x.type===d.LineType.LINE||0<=A)&&K.push(g.scaleAndAdd(W,x.start,z,A))):0<P&&(P=Math.sqrt(P),t=(-n+P)/(2*A),(x.type===d.LineType.LINE||0<=t)&&K.push(g.scaleAndAdd(W,x.start,z,t)),A=(-n-P)/(2*A),(x.type===d.LineType.LINE||0<=A)&&K.push(g.scaleAndAdd(H,x.start,z,A)));return K};d.pointToLineDistance=
function(x,A,P){return Math.abs((A[0]-x[0])*(P[1]-x[1])-(A[1]-x[1])*(P[0]-x[0]))/g.distance(A,P)};d.projectPoint=q;d.projectPointToCircle=l;d.projectPointToLine=u;d.projectPointToRay=function(x,A,P,K){g.subtract(C,K,P);g.subtract(H,A,P);A=g.dot(C,H)/g.squaredLength(C);return 0<A?g.scaleAndAdd(x,P,C,A):g.copy(x,P)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(d,D,g,Q,h,q){h=function(u){function l(C){return u.call(this,{...C,constraint:new g.LineConstraint(C.coordinateHelper,C.edgeStart,C.edgeEnd)})||this}D._inheritsLoose(l,u);D._createClass(l,[{key:"hints",get:function(){return[new q.LineSnappingHint(Q.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo,this.domain)]}}]);return l}(h.FeatureSnappingCandidate);d.EdgeSnappingCandidate=h;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],function(d,D,g,Q){Q=function(h){function q({coordinateHelper:u,targetPoint:l,objectId:C,constraint:p,elevationInfo:H}){u=h.call(this,u,l,p,H,g.SnappingDomain.FEATURE)||this;u.objectId=C;return u}D._inheritsLoose(q,h);return q}(Q.SnappingCandidate);d.FeatureSnappingCandidate=Q;Object.defineProperties(d,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(d){d.SnappingCandidate=function(D,g,Q,h,q){this.coordinateHelper=D;this.targetPoint=g;this.constraint=Q;this.elevationInfo=h;this.domain=q};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),
function(d,D,g,Q,h,q,u){g=function(l){function C(p,H,W,x,A=h.SnappingDomain.ALL,P=!0,K=!0){x=l.call(this,x,A)||this;x.type=p;x.lineStart=H;x.lineEnd=W;x.fadeLeft=P;x.fadeRight=K;return x}D._inheritsLoose(C,l);C.prototype.equals=function(p){return p instanceof C?this.type===p.type&&q.objectEqual(this.lineStart,p.lineStart)&&q.objectEqual(this.lineEnd,p.lineEnd)&&this.fadeLeft===p.fadeLeft&&this.fadeRight===p.fadeRight:!1};return C}(u.SnappingHint);d.LineSnappingHint=g;Object.defineProperties(d,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(d){d.SnappingHint=function(D,g){this.elevationInfo=D;this.domain=g};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(d,D,g,Q,h,q,u){h=function(l){function C({coordinateHelper:p,targetPoint:H,constraint:W,previousVertex:x,otherVertex:A,otherVertexType:P,objectId:K,elevationInfo:z}){p=l.call(this,p,H,W,z,g.SnappingDomain.SELF)||this;p.previousVertex=x;p.otherVertex=A;p.otherVertexType=P;p.objectId=K;return p}D._inheritsLoose(C,l);D._createClass(C,[{key:"hints",get:function(){const p=this.previousVertex,H=this.otherVertexType===d.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,W=this.otherVertexType===
d.OtherVertexType.CENTER?this.targetPoint:this.otherVertex,x=this.elevationInfo;return[new q.LineSnappingHint(Q.LineSegmentHintType.TARGET,H,W,x,this.domain),new q.LineSnappingHint(Q.LineSegmentHintType.REFERENCE,p,H,x,this.domain),new u.RightAngleSnappingHint(this.previousVertex,H,W,x,this.domain)]}}]);return C}(h.SnappingCandidate);d.OtherVertexType=void 0;(function(l){l[l.NEXT=0]="NEXT";l[l.CENTER=1]="CENTER"})(d.OtherVertexType||(d.OtherVertexType={}));d.RightAngleSnappingCandidate=h;Object.defineProperties(d,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),function(d,D,g,Q,h,q,u){g=function(l){function C(p,H,W,x,A=h.SnappingDomain.ALL){x=l.call(this,x,A)||this;x.previousVertex=p;x.centerVertex=H;x.nextVertex=W;return x}D._inheritsLoose(C,l);C.prototype.equals=
function(p){return p instanceof C?q.objectEqual(this.previousVertex,p.previousVertex)&&q.objectEqual(this.centerVertex,p.centerVertex)&&q.objectEqual(this.nextVertex,p.nextVertex):!1};return C}(u.SnappingHint);d.RightAngleSnappingHint=g;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/Point ../../../support/elevationInfoUtils".split(" "),
function(d,D,g,Q,h,q,u){function l(K,z,t,n,w=h.create()){K=z.toXYZ(K);K[2]=u.getConvertedElevationFromVector(n,K,z.spatialReference,t)||0;n.renderCoordsHelper.toRenderCoords(K,z.spatialReference,w);return w}function C(K,z,t,n,w=h.create()){K=Q.copy(W,K);K[2]=u.getConvertedElevationFromVector(n,K,z,t)||0;n.renderCoordsHelper.toRenderCoords(K,z,w);return w}function p(K,z,t,n){if("2d"===n.type)return H.x=K[0],H.y=K[1],H.spatialReference=z,n.toScreen(H);C(K,z,t,n,W);n.state.camera.projectToScreen(W,P);
return D.createScreenPoint(P[0],P[1])}const H=new q,W=h.create(),x=D.createRenderScreenPointArray3(),A=D.createRenderScreenPointArray3(),P=D.createScreenPointArray();d.anyMapPointToRender=l;d.anyMapPointToScreenPoint=function(K,z,t,n){return p(z.toXYZ(K),z.spatialReference,t,n)};d.anyMapPointsToRenderWithEqualRelativeZ=function(K,z,t,n,w,G,e){if("absolute-height"===n.mode)l(K,t,n,w,G),l(z,t,n,w,e);else{K=t.toXYZ(K);z=t.toXYZ(z);var c=u.getConvertedElevationFromVector(w,K,t.spatialReference,n);n=u.getConvertedElevationFromVector(w,
z,t.spatialReference,n);n=(null==c?n:null==n?c:Math.min(c,n))||0;K[2]=n;z[2]=n;w.renderCoordsHelper.toRenderCoords(K,t.spatialReference,G);w.renderCoordsHelper.toRenderCoords(z,t.spatialReference,e)}};d.renderScreenSpaceTangent=function(K,z,t,n){t.projectToRenderScreen(K,x);t.projectToRenderScreen(z,A);g.subtract(n,A,x);g.normalize(n,n)};d.vectorToRender=C;d.vectorToScreenPoint=p;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P){d.SelfSnappingEngine=function(K){function z(n){n=K.call(this,n)||this;n.updating=!1;n._snappers=new h;n._domain=A.SnappingDomain.SELF;return n}D._inheritsLoose(z,K);var t=z.prototype;t.initialize=function(){this._snappers.push(new H.ParallelLineSnapper(this.view,this.options),new p.LineSnapper(this.view,this.options),new W.RightAngleSnapper(this.view,this.options),new x.RightAngleTriangleSnapper(this.view,this.options))};t.fetchCandidates=function(){var n=D._asyncToGenerator(function*(w,
G,e){if(!(G&this._domain&&this.options.effectiveSelfEnabled))return[];G=[];for(const c of this._snappers.items)for(const f of c.snap(w,e))G.push(f);P.sortCandidatesInPlace(w,G,e.coordinateHelper);return G});return function(w,G,e){return n.apply(this,arguments)}}();D._createClass(z,[{key:"options",set:function(n){this._set("options",n);for(const w of this._snappers)w.options=n}}]);return z}(Q);g.__decorate([q.property({readOnly:!0})],d.SelfSnappingEngine.prototype,"updating",void 0);g.__decorate([q.property({constructOnly:!0})],
d.SelfSnappingEngine.prototype,"view",void 0);g.__decorate([q.property()],d.SelfSnappingEngine.prototype,"options",null);d.SelfSnappingEngine=g.__decorate([C.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],d.SelfSnappingEngine);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H){q=function(K){function z(){return K.apply(this,arguments)||this}D._inheritsLoose(z,K);var t=z.prototype;t.snapNewVertex=function(n,w){var G=w.editGeometryOperations.data.components[0],e=G.edges.length;const c=[];if(1>e)return c;const f=C.anyMapPointToScreenPoint(n,w.coordinateHelper,h.absoluteHeightElevationInfo,this.view),{view:m}=this;e=G=G.edges[e-1];do{if(this.edgeExceedsShortLineThreshold(e,w)){const E=u.editEdgeToSnappingEdge(e,m,w);this._processCandidateProposal(E.left,
E.right,n,f,w,c)}e=e.leftVertex.leftEdge}while(e&&e!==G);return c};t.snapExistingVertex=function(n,w){const G=[],e=g.unwrap(w.vertexHandle);var c=e.component;if(2>c.edges.length)return G;const {view:f}=this;var {coordinateHelper:m}=w;m=C.anyMapPointToScreenPoint(n,m,h.absoluteHeightElevationInfo,f);var E=e.leftEdge,v=e.rightEdge;E&&v&&this.edgeExceedsShortLineThreshold(E,w)&&this.edgeExceedsShortLineThreshold(v,w)&&this._processCandidateProposal(u.convertPointElevation(E.leftVertex.pos,f,w),u.convertPointElevation(v.rightVertex.pos,
f,w),n,m,w,G);E=c=c.edges[0];do E!==e.leftEdge&&E!==e.rightEdge&&this.edgeExceedsShortLineThreshold(E,w)&&(v=u.editEdgeToSnappingEdge(E,f,w),this._processCandidateProposal(v.left,v.right,n,m,w,G)),E=E.rightVertex.rightEdge;while(E&&E!==c);return G};t._processCandidateProposal=function(n,w,G,e,c,f){const {coordinateHelper:m,pointer:E}=c;m.toXYZ(n,W);m.toXYZ(w,x);G=m.toXYZ(G,P);G=p.projectPointToLineLike(G,A);G=m.fromXYZ(G);u.squaredScreenDistance(e,C.anyMapPointToScreenPoint(G,m,h.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(E)&&f.push(new l.LineSnappingCandidate({coordinateHelper:m,lineStart:n,lineEnd:w,targetPoint:G,elevationInfo:m.hasZ()?h.absoluteHeightElevationInfo:null}))};return z}(q.SnappingAlgorithm);const W=Q.create(),x=Q.create(),A={start:W,end:x,type:H.LineType.LINE},P=Q.create();d.LineSnapper=q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ./Settings ./snappingUtils ../support/viewUtils".split(" "),
function(d,D,g,Q,h,q){let u=function(){function l(p,H){this.view=p;this.options=H;this.squaredShortLineThreshold=Q.defaults.shortLineThreshold*Q.defaults.shortLineThreshold}var C=l.prototype;C.snap=function(p,H){return g.isSome(H.vertexHandle)?"vertex"!==H.vertexHandle.type?[]:this.snapExistingVertex(p,H):this.snapNewVertex(p,H)};C.edgeExceedsShortLineThreshold=function(p,H){return this.exceedsShortLineThreshold(p.leftVertex.pos,p.rightVertex.pos,H)};C.exceedsShortLineThreshold=function(p,H,{elevationInfo:W,
editGeometryOperations:x}){x=x.data.coordinateHelper;return 0===this.squaredShortLineThreshold||h.squaredScreenDistance(q.anyMapPointToScreenPoint(H,x,W,this.view),q.anyMapPointToScreenPoint(p,x,W,this.view))>this.squaredShortLineThreshold};C.squaredProximityThreshold=function(p){return"touch"===p?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};D._createClass(l,[{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",
get:function(){const {distance:p,touchSensitivityMultiplier:H}=this.options,W=p*H;return W*W}}]);return l}();d.SnappingAlgorithm=u;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),function(d,D,g,Q,h,q,u){q=
function(l){function C({coordinateHelper:p,lineStart:H,lineEnd:W,targetPoint:x,elevationInfo:A}){p=l.call(this,p,x,new g.VerticalPlaneConstraint(p,H,W),A,Q.SnappingDomain.SELF)||this;p._referenceLineHint=new u.LineSnappingHint(h.LineSegmentHintType.REFERENCE_EXTENSION,H,W,A,p.domain);return p}D._inheritsLoose(C,l);C.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};D._createClass(C,[{key:"hints",get:function(){return[this._referenceLineHint,new u.LineSnappingHint(h.LineSegmentHintType.TARGET,
this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo,this.domain)]}}]);return C}(q.SnappingCandidate);d.LineSnappingCandidate=q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W){l=function(A){function P(){return A.apply(this,arguments)||this}D._inheritsLoose(P,A);var K=P.prototype;K.snapNewVertex=function(z,t){var n=t.editGeometryOperations.data.components[0],w=n.edges.length,G=n.vertices.length;const e=[];if(2>w)return e;const {view:c}=this,f=H.anyMapPointToScreenPoint(z,t.coordinateHelper,q.absoluteHeightElevationInfo,c);G=C.convertPointElevation(n.vertices[G-1].pos,c,t);const m=C.convertPointElevation(n.vertices[0].pos,c,t);w=n=n.edges[w-
1];do{if(this.edgeExceedsShortLineThreshold(w,t)){const E=C.editEdgeToSnappingEdge(w,c,t);this._checkEdgeForParalleLines(E,G,z,f,t,e);this._checkEdgeForParalleLines(E,m,z,f,t,e)}w=w.leftVertex.leftEdge}while(w&&w!==n);return e};K.snapExistingVertex=function(z,t){const n=[],w=g.unwrap(t.vertexHandle);var G=w.component;if(3>G.edges.length)return n;const {view:e}=this,c=H.anyMapPointToScreenPoint(z,t.coordinateHelper,q.absoluteHeightElevationInfo,e),f=w.leftEdge,m=w.rightEdge,E=G.vertices[0],v=C.convertPointElevation(E.pos,
e,t),r=G.vertices[G.vertices.length-1],I=C.convertPointElevation(r.pos,e,t);let F=G=G.edges[0];do{if(F!==f&&F!==m&&this.edgeExceedsShortLineThreshold(F,t)){const J=C.editEdgeToSnappingEdge(F,e,t);f&&this._checkEdgeForParalleLines(J,C.convertPointElevation(f.leftVertex.pos,e,t),z,c,t,n);m&&this._checkEdgeForParalleLines(J,C.convertPointElevation(m.rightVertex.pos,e,t),z,c,t,n);w===E?this._checkEdgeForParalleLines(J,I,z,c,t,n):w===r&&this._checkEdgeForParalleLines(J,v,z,c,t,n)}F=F.rightVertex.rightEdge}while(F&&
F!==G);return n};K._checkEdgeForParalleLines=function(z,t,n,w,G,e){const c=z.left,f=z.right;W.projectPointToLine(x,t,c,f);if(!(Q.squaredDistance(x,t)<u.defaults.parallelLineThreshold)){W.projectPointToLine(x,n,c,f,t);var {coordinateHelper:m,pointer:E}=G;n=m.fromXYZ(x,m.getZ(n,0));C.squaredScreenDistance(w,H.anyMapPointToScreenPoint(n,m,q.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(E)&&!this._parallelToPreviousCandidate(z,e)&&e.push(new p.ParallelLineSnappingCandidate({coordinateHelper:m,
referenceLine:z,lineStart:t,targetPoint:n,elevationInfo:m.hasZ()?q.absoluteHeightElevationInfo:null}))}};K._parallelToPreviousCandidate=function(z,t){const n=z.left,w=z.right;for(const G of t)if(W.projectPointToLine(x,w,G.constraint.start,G.constraint.end,n),Q.squaredDistance(x,w)<u.defaults.parallelLineThreshold)return G.addReferenceLine(z),!0;return!1};return P}(l.SnappingAlgorithm);const x=h.create();d.ParallelLineSnapper=l;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(d,D,g,Q,h,q,u,l,C,p){l=function(A){function P({coordinateHelper:K,referenceLine:z,lineStart:t,targetPoint:n,elevationInfo:w}){const G=K.toXYZ(t,H),e=
K.toXYZ(z.left,W),c=K.toXYZ(z.right,x);g.subtract(G,g.add(G,G,c),e);K=A.call(this,K,n,new h.VerticalPlaneConstraint(K,t,K.fromXYZ(G)),w,q.SnappingDomain.SELF)||this;K._referenceLines=[{edge:z,fadeLeft:!0,fadeRight:!0}];return K}D._inheritsLoose(P,A);P.prototype.addReferenceLine=function(K){const z={edge:K,fadeLeft:!0,fadeRight:!0},{coordinateHelper:t}=this;this._referenceLines.forEach(n=>{t.equals(K.right,n.edge.left)&&(n.fadeLeft=!1,z.fadeRight=!1);t.equals(K.right,n.edge.right)&&(n.fadeRight=!1,
z.fadeRight=!1);t.equals(K.left,n.edge.right)&&(n.fadeRight=!1,z.fadeLeft=!1);t.equals(K.left,n.edge.left)&&(n.fadeLeft=!1,z.fadeLeft=!1)});this._referenceLines.push(z)};D._createClass(P,[{key:"hints",get:function(){const K=this.elevationInfo;return[new C.LineSnappingHint(u.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,K,this.domain),new p.ParallelSnappingHint(this.constraint.start,this.targetPoint,K,this.domain),...this._referenceLines.map(z=>new C.LineSnappingHint(u.LineSegmentHintType.REFERENCE,
z.edge.left,z.edge.right,K,this.domain,z.fadeLeft,z.fadeRight))]}}]);return P}(l.SnappingCandidate);const H=Q.create(),W=Q.create(),x=Q.create();d.ParallelLineSnappingCandidate=l;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../SnappingDomain ../snappingUtils ./SnappingHint".split(" "),
function(d,D,g,Q,h,q,u){g=function(l){function C(p,H,W,x=h.SnappingDomain.ALL){W=l.call(this,W,x)||this;W.lineStart=p;W.lineEnd=H;return W}D._inheritsLoose(C,l);C.prototype.equals=function(p){return p instanceof C?q.objectEqual(this.lineStart,p.lineStart)&&q.objectEqual(this.lineEnd,p.lineEnd):!1};return C}(u.SnappingHint);d.ParallelSnappingHint=g;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x){C=function(t){function n(){return t.apply(this,arguments)||this}D._inheritsLoose(n,t);var w=n.prototype;w.snapNewVertex=function(G,e){var c=e.editGeometryOperations.data.components[0],f=c.vertices.length;const m=[];if(2>f)return m;var {view:E}=this;const v=x.anyMapPointToScreenPoint(G,e.coordinateHelper,l.absoluteHeightElevationInfo,E);var r=c.vertices[f-1];this.edgeExceedsShortLineThreshold(r.leftEdge,e)&&(f=H.convertPointElevation(r.pos,E,e),r=H.editEdgeToSnappingEdge(r.leftEdge,
E,e),this._checkForSnappingCandidate(m,r,f,G,r.left,f,e,G,v));f=c.vertices[0];this.edgeExceedsShortLineThreshold(f.rightEdge,e)&&(c=H.convertPointElevation(f.pos,E,e),E=H.editEdgeToSnappingEdge(f.rightEdge,E,e),this._checkForSnappingCandidate(m,E,c,G,E.right,c,e,G,v));return m};w.snapExistingVertex=function(G,e){const c=[];var f=g.unwrap(e.vertexHandle),m=f.component;const E=m.vertices.length;if(3>E)return c;var {view:v}=this;const r=x.anyMapPointToScreenPoint(G,e.coordinateHelper,l.absoluteHeightElevationInfo,
v);var I=f.leftEdge;f=f.rightEdge;var F=m.vertices[0];m=m.vertices[E-1];if(!I)return f=F.rightEdge.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(f,e)&&(f=H.editEdgeToSnappingEdge(f,v,e),v=H.convertPointElevation(F.rightEdge.rightVertex.pos,v,e),this._checkForSnappingCandidate(c,f,v,G,f.right,v,e,G,r)),c;if(!f)return f=m.leftEdge.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(f,e)&&(f=H.editEdgeToSnappingEdge(f,v,e),v=H.convertPointElevation(m.leftEdge.leftVertex.pos,v,e),this._checkForSnappingCandidate(c,
f,v,G,f.left,v,e,G,r)),c;I&&I.leftVertex.leftEdge&&(F=I.leftVertex.leftEdge,this.edgeExceedsShortLineThreshold(F,e)&&(F=H.editEdgeToSnappingEdge(F,v,e),I=H.convertPointElevation(I.leftVertex.pos,v,e),this._checkForSnappingCandidate(c,F,I,G,F.left,I,e,G,r)));f&&f.rightVertex.rightEdge&&(I=f.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(I,e)&&(I=H.editEdgeToSnappingEdge(I,v,e),v=H.convertPointElevation(f.rightVertex.pos,v,e),this._checkForSnappingCandidate(c,I,v,G,I.right,v,e,G,r)));return c};
w._checkForSnappingCandidate=function(G,e,c,f,m,E,v,r,I){const {coordinateHelper:F,pointer:J}=v;Q.subtract(A,e.right,e.left);e=q.set(z,A[1],-A[0],0);c=Q.dot(e,Q.subtract(A,f,c))/Q.squaredLength(e);r=F.fromXYZ(Q.scaleAndAdd(A,E,e,c),F.getZ(r,0));H.squaredScreenDistance(I,x.anyMapPointToScreenPoint(r,F,l.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(J)&&(I=F.toXYZ(E,P),I=q.scaleAndAdd(K,I,e,Math.sign(c)),I=F.fromXYZ(I),G.push(new W.RightAngleSnappingCandidate({coordinateHelper:F,
targetPoint:r,constraint:new p.VerticalHalfPlaneConstraint(F,E,I),previousVertex:m,otherVertex:E,otherVertexType:W.OtherVertexType.CENTER,elevationInfo:F.hasZ()?l.absoluteHeightElevationInfo:null})))};return n}(C.SnappingAlgorithm);const A=h.create(),P=u.create(),K=u.create(),z=u.create();d.RightAngleSnapper=C;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H){u=function(A){function P(){return A.apply(this,arguments)||this}D._inheritsLoose(P,A);var K=P.prototype;K.snapNewVertex=function(z,t){var n=t.editGeometryOperations.data.components[0];const w=[];var G=n.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||2>G)return w;var {view:e}=this;G=n.vertices[G-1];n=l.convertPointElevation(n.vertices[0].pos,e,t);e=l.convertPointElevation(G.pos,e,t);this._processCandidateProposal(n,e,z,t,w);return w};K.snapExistingVertex=
function(z,t){const n=[];var w=g.unwrap(t.vertexHandle),G=w.component;if(2>G.edges.length||"polyline"===t.editGeometryOperations.data.type&&(0===w.index||w.index===G.vertices.length-1))return n;const {view:e}=this;G=l.convertPointElevation(w.leftEdge.leftVertex.pos,e,t);w=l.convertPointElevation(w.rightEdge.rightVertex.pos,e,t);this._processCandidateProposal(G,w,z,t,n);return n};K._processCandidateProposal=function(z,t,n,w,G){if(this.exceedsShortLineThreshold(z,t,w)){var e=Q.lerp(W,z,t,.5),c=.5*Q.distance(z,
t);e=H.projectPointToCircle(x,n,e,c);var {coordinateHelper:f,pointer:m}=w;w=f.fromXYZ(e,f.getZ(n,0));n=p.anyMapPointToScreenPoint(n,f,q.absoluteHeightElevationInfo,this.view);l.squaredScreenDistance(n,p.anyMapPointToScreenPoint(w,f,q.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(m)&&G.push(new C.RightAngleTriangleSnappingCandidate({coordinateHelper:f,targetPoint:w,point1:z,point2:t,elevationInfo:f.hasZ()?q.absoluteHeightElevationInfo:null}))}};return P}(u.SnappingAlgorithm);
const W=h.create(),x=h.create();d.RightAngleTriangleSnapper=u;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(d,D,g,Q,h,q,u,l,C,p){l=function(W){function x({coordinateHelper:A,targetPoint:P,point1:K,point2:z,elevationInfo:t}){A=W.call(this,A,P,new h.PlanarCircleConstraint(A,A.arrayToVector(g.lerp(H,K,z,.5)),.5*g.distance(K,z)),t,q.SnappingDomain.SELF)||this;A._p1=K;A._p2=z;return A}D._inheritsLoose(x,W);D._createClass(x,[{key:"hints",get:function(){const A=this.elevationInfo;return[new C.LineSnappingHint(u.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,A,this.domain),new C.LineSnappingHint(u.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,A,this.domain),new p.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,A,this.domain)]}}]);return x}(l.SnappingCandidate);const H=Q.create();d.RightAngleTriangleSnappingCandidate=l;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(d,D,g,Q,h,q,u,l,C,p){g=function(H){function W(x){x=H.call(this,x)||this;x.enabled=!1;x.enabledToggled=!1;x.selfEnabled=!0;x.featureEnabled=!0;x.featureSources=new Q;x.distance=p.defaults.distance;x.touchSensitivityMultiplier=p.defaults.touchSensitivityMultiplier;return x}d._inheritsLoose(W,H);d._createClass(W,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&this.selfEnabled}},
{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return W}(g);D.__decorate([h.property()],g.prototype,"enabled",void 0);D.__decorate([h.property()],g.prototype,"enabledToggled",void 0);D.__decorate([h.property()],g.prototype,"selfEnabled",void 0);D.__decorate([h.property()],g.prototype,"featureEnabled",void 0);D.__decorate([h.property({type:Q.ofType(C)})],g.prototype,"featureSources",void 0);D.__decorate([h.property()],g.prototype,"distance",void 0);
D.__decorate([h.property()],g.prototype,"touchSensitivityMultiplier",void 0);D.__decorate([h.property({readOnly:!0})],g.prototype,"effectiveEnabled",null);D.__decorate([h.property({readOnly:!0})],g.prototype,"effectiveSelfEnabled",null);D.__decorate([h.property({readOnly:!0})],g.prototype,"effectiveFeatureEnabled",null);return g=D.__decorate([l.subclass("esri.views.interactive.snapping.SnappingOptions")],g)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,D,g,Q,h,q,u){g=function(l){function C(p){p=l.call(this,p)||this;p.layer=null;p.enabled=!0;p.updating=!1;p.availability=1;return p}d._inheritsLoose(C,l);return C}(g);D.__decorate([Q.property({constructOnly:!0})],g.prototype,"layer",void 0);D.__decorate([Q.property()],g.prototype,"enabled",void 0);D.__decorate([Q.property()],g.prototype,"updating",void 0);D.__decorate([Q.property()],g.prototype,"availability",void 0);return g=D.__decorate([u.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
g)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),function(d,D,g,Q,h,q){h=function(u){function l(C,p,H,W,x){C=u.call(this,C,p,new g.IntersectionConstraint(C,p,H.constraint,W.constraint),x,Q.SnappingDomain.ALL)||this;C.first=H;C.second=W;return C}D._inheritsLoose(l,u);D._createClass(l,[{key:"hints",
get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new q.IntersectionSnappingHint(this.targetPoint,this.elevationInfo,this.domain)]}}]);return l}(h.SnappingCandidate);d.IntersectionSnappingCandidate=h;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../SnappingDomain","../snappingUtils","./SnappingHint"],function(d,D,g,Q,h){h=function(q){function u(l,C,p=g.SnappingDomain.ALL){C=q.call(this,C,p)||this;C.intersectionPoint=l;return C}D._inheritsLoose(u,q);u.prototype.equals=function(l){return l instanceof u?Q.objectEqual(this.intersectionPoint,l.intersectionPoint):!1};return u}(h.SnappingHint);d.IntersectionSnappingHint=h;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(d,D,g){function Q(){Q=D._asyncToGenerator(function*(q,u){if("2d"===q.type)return q.hitTest(u);q=yield q.hitTest(u);if(0===q.results.length)return q;u=q.results[0];const l=g.isSome(u.distance)?1.05*u.distance:u.distance;u=q.results.findIndex(C=>C.distance>l);-1!==u&&(q.results=q.results.slice(0,u));return q});return Q.apply(this,arguments)}function h(q){return g.isSome(q)&&"graphic"===q.type}d.filterGraphicHits=function(q){return q.filter(h)};
d.findFirstGraphicHit=function(q){return q.find(h)??null};d.hitTestSelectSimilarDistance=function(q,u){return Q.apply(this,arguments)};Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,D,g,Q,h,q,u,l,C){d.OperationHandle=function(p){function H(x){x=p.call(this,x)||this;x.cancelled=!1;x.history={undo:[],redo:[]};x.type=null;return x}D._inheritsLoose(H,p);var W=H.prototype;W.addToHistory=function(x){this.history.redo=[];this.history.undo.push(x)};W.resetHistory=function(){this.history.redo=[];this.history.undo=[]};W.canUndo=function(){return 0<this.history.undo.length};W.canRedo=function(){return 0<this.history.redo.length};W.complete=function(){this._reset();this.onEnd();
this.emit("complete")};W.cancel=function(){this.cancelled=!0;this.complete()};W._reset=function(){this.activeComponent.reset()};W.refreshComponent=function(){const x=this.activeComponent;x&&("box"!==x.type&&"reshape"!==x.type&&"graphic-mover"!==x.type||x.refresh())};D._createClass(H,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:Q.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(x){this._set("undo",()=>{this.canUndo()&&x()})}},{key:"redo",set:function(x){this._set("redo",()=>{this.canRedo()&&x()})}}]);return H}(h.EventedAccessor);g.__decorate([q.property()],d.OperationHandle.prototype,"activeComponent",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"cancelled",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,
"history",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"tool",null);g.__decorate([q.property()],d.OperationHandle.prototype,"type",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"canUndo",null);g.__decorate([q.property()],d.OperationHandle.prototype,"canRedo",null);g.__decorate([q.property()],d.OperationHandle.prototype,"onEnd",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"undo",null);g.__decorate([q.property()],d.OperationHandle.prototype,"redo",
null);g.__decorate([q.property()],d.OperationHandle.prototype,"toggleTool",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"addToSelection",void 0);g.__decorate([q.property()],d.OperationHandle.prototype,"removeFromSelection",void 0);d.OperationHandle=g.__decorate([C.subclass("esri.widgets.Sketch.support.OperationHandle")],d.OperationHandle);d.CreateOperationHandle=function(p){function H(){return p.apply(this,arguments)||this}D._inheritsLoose(H,p);return H}(d.OperationHandle);g.__decorate([q.property()],
d.CreateOperationHandle.prototype,"activeComponent",void 0);d.CreateOperationHandle=g.__decorate([C.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],d.CreateOperationHandle);d.UpdateOperationHandle=function(p){function H(){return p.apply(this,arguments)||this}D._inheritsLoose(H,p);return H}(d.OperationHandle);g.__decorate([q.property()],d.UpdateOperationHandle.prototype,"activeComponent",void 0);d.UpdateOperationHandle=g.__decorate([C.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
d.UpdateOperationHandle);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A){const P={lassoTool:!0,rectangleTool:!0},K={createTool:"polygon",createOptions:{mode:"freehand"}},z={createTool:"rectangle"};u=function(t){function n(G,e){var c=t.call(this,G,e)||this;c._viewModelHandlesGroup=null;c.activeToolInfo=null;c.messages=null;c.toolConfigs=[];c.viewModel=new A;c.visibleElements={...P};c._viewModelHandlesGroup=Q.handlesGroup([c.viewModel.on("selection-change",f=>c.emit("selection-change",f)),c.viewModel.on("complete",f=>{c._set("activeToolInfo",
null);c.emit("complete",f)})]);return c}D._inheritsLoose(n,t);var w=n.prototype;w.destroy=function(){this._viewModelHandlesGroup=h.removeMaybe(this._viewModelHandlesGroup)};w.loadDependencies=function(){return Promise.all([new Promise((G,e)=>d(["../../chunks/calcite-action"],G,e)),new Promise((G,e)=>d(["../../chunks/calcite-icon"],G,e))])};w.castVisibleElements=function(G){return{...P,...G}};w.activate=function(G){this.cancel();switch(G){case "lasso":this._activateTool("lasso");case "rectangle":this._activateTool("rectangle");
default:this._activateTool(G)}};w.cancel=function(){this.viewModel.cancel();this._set("activeToolInfo",null)};w.render=function(){return x.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar","esri-widget")},x.tsx("div",{class:"esri-selection-toolbar__container"},this.renderDefaultTools(),this.renderCustomTools()))};w.renderDefaultTools=function(){if("2d"===this.view?.type)return[this.renderRectangleTool(),this.renderLassoTool()]};w.renderCustomTools=function(){if(this.toolConfigs&&
this.toolConfigs.length)return this.toolConfigs.map(G=>x.tsx("calcite-action",{active:this.activeToolInfo?.toolName===G.toolName,bind:this,class:"esri-selection-toolbar__tool-button",label:G.toolName,onclick:()=>this._onCustomToolClick(G.toolName),scale:"s",text:G.toolName,title:G.toolName},x.tsx("calcite-icon",{scale:"s",icon:G.icon||"selection"})))};w.renderLassoTool=function(){const {activeToolInfo:G,messages:e,visibleElements:c}=this;if(c.lassoTool)return x.tsx("calcite-action",{active:"lasso"===
G?.toolName,bind:this,label:e.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:e.selectByLasso,title:e.selectByLasso},x.tsx("calcite-icon",{scale:"s",icon:"lasso"}))};w.renderRectangleTool=function(){const {activeToolInfo:G,messages:e,visibleElements:c}=this;if(c.rectangleTool)return x.tsx("calcite-action",{active:"rectangle"===G?.toolName,bind:this,label:e.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:e.selectByRectangle,title:e.selectByRectangle},x.tsx("calcite-icon",
{scale:"s",icon:"cursor-marquee"}))};w._onCustomToolClick=function(G){this._toggleTool(G)};w._onLassoToolClick=function(){this._toggleTool("lasso")};w._onRectangleToolClick=function(){this._toggleTool("rectangle")};w._activateTool=function(G){var e=this._getToolOptions(G);e&&(e=this.viewModel.activate(e),this._set("activeToolInfo",{toolName:G,operation:e}))};w._toggleTool=function(G){if(this.activeToolInfo){const e=this.activeToolInfo.toolName;this.cancel();if(e===G)return}this._activateTool(G)};
w._getToolOptions=function(G){if("lasso"===G)return K;if("rectangle"===G)return z;const e=this.toolConfigs.find(E=>E.toolName===G);if(e){var {createTool:c,createOptions:f,selectionOptions:m}=e;return{createTool:c,createOptions:f,selectionOptions:m}}};D._createClass(n,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(G){this._overrideIfSome("label",G)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(G){this.viewModel.layers=G}},{key:"view",get:function(){return this.viewModel.view},
set:function(G){this.viewModel.view=G}}]);return n}(p);g.__decorate([q.property({readOnly:!0})],u.prototype,"activeToolInfo",void 0);g.__decorate([q.property()],u.prototype,"label",null);g.__decorate([q.property()],u.prototype,"layers",null);g.__decorate([q.property(),W.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],u.prototype,"messages",void 0);g.__decorate([q.property()],u.prototype,"toolConfigs",void 0);g.__decorate([q.property()],u.prototype,"view",null);g.__decorate([q.property()],
u.prototype,"viewModel",void 0);g.__decorate([q.property()],u.prototype,"visibleElements",void 0);g.__decorate([l.cast("visibleElements")],u.prototype,"castVisibleElements",null);return u=g.__decorate([C.subclass("esri.widgets.support.SelectionToolbar")],u)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/handleUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../Selector2D".split(" "),
function(d,D,g,Q,h,q,u,l,C,p){g=function(H){function W(A){A=H.call(this,A)||this;A._operationHandlesGroup=null;A.activeOperation=null;A.layers=null;A.selector=new p;return A}d._inheritsLoose(W,H);var x=W.prototype;x.destroy=function(){this._operationHandlesGroup=h.removeMaybe(this._operationHandlesGroup);this.selector.destroy()};x.cancel=function(){"active"===this.state&&(this.activeOperation.cancel(),this.activeOperation=null);this.selector.candidates=null};x.activate=function(A){const {state:P}=
this;if("disabled"!==P)return"active"===P&&this.cancel(),this.selector.candidates=this._getCandidates(),A=this.selector.draw(A),this._operationHandlesGroup=Q.handlesGroup([A.once("complete",K=>this._onOperationComplete(K)),A.on("selection-change",K=>this._onOperationSelectionChange(K))]),this.activeOperation=A};x._getCandidates=function(){let A=[];this.layers.forEach(P=>{A=A.concat(...P.graphics.toArray())});return A};x._onOperationSelectionChange=function(A){this.emit("selection-change",A)};x._onOperationComplete=
function(A){this._operationHandlesGroup=h.removeMaybe(this._operationHandlesGroup);this.activeOperation=null;this.emit("complete",A)};d._createClass(W,[{key:"state",get:function(){return this.activeOperation?"active":this.view?.ready&&this.layers?.length?"ready":"disabled"}},{key:"view",set:function(A){this.selector.view=A;this._set("view",A)}}]);return W}(g.EventedAccessor);D.__decorate([q.property()],g.prototype,"activeOperation",void 0);D.__decorate([q.property()],g.prototype,"layers",void 0);
D.__decorate([q.property({readOnly:!0})],g.prototype,"selector",void 0);D.__decorate([q.property({readOnly:!0})],g.prototype,"state",null);D.__decorate([q.property()],g.prototype,"view",null);return g=D.__decorate([C.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],g)})},"esri/widgets/support/Selector2D":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./Selector2D/SelectionOperation2D ./Selector2D/selectorUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H){g=function(W){function x(P){P=W.call(this,P)||this;P._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0};P.candidates=null;P.options=null;P.view=null;return P}d._inheritsLoose(x,W);var A=x.prototype;A.draw=function(P){const {_defaultSelectionOptions:K,candidates:z,options:t,view:n}=this;return new p({candidates:z,options:{...P,selectionOptions:{...K,...t,...P?.selectionOptions}},view:n})};A.selectionFrom=function(){var P=d._asyncToGenerator(function*(K,
z){const {_defaultSelectionOptions:t,candidates:n,options:w,view:G}=this,e=new Q;yield H.updateSelection({selector:K,candidates:n,currentSelection:e,options:{...t,...w,...z},view:G});return e.toArray()});return function(K,z){return P.apply(this,arguments)}}();return x}(h.HandleOwnerMixin(g));D.__decorate([q.property()],g.prototype,"candidates",void 0);D.__decorate([q.property()],g.prototype,"options",void 0);D.__decorate([q.property({value:null})],g.prototype,"view",void 0);return g=D.__decorate([C.subclass("esri.widgets.support.Selector2D")],
g)})},"esri/widgets/support/Selector2D/SelectionOperation2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/Handles ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K){g=function(z){function t({candidates:w,options:G,view:e}){var c=z.call(this)||this;c._activeOptions=null;c._dashedFillSymbol=new A({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});c._dashedLineSymbol=new P({style:"dash",color:[12,207,255],width:2});c._defaultOptions={createTool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};c._completed=!1;c._handles=new q;c._sketchViewModel=new W;c._sketchGraphicsLayer=
new H({listMode:"hide",internal:!0});c._transparentPointSymbol=new K({color:[0,0,0,0],outline:{style:"none",width:0}});c.candidates=null;c.geometry=null;c.options=null;c.selection=new Q;c.view=null;c.candidates=w;c.options=G;c.view=e;const {_dashedFillSymbol:f,_dashedLineSymbol:m,_sketchViewModel:E,_sketchGraphicsLayer:v,_transparentPointSymbol:r}=d._assertThisInitialized(c);E.set({layer:v,view:c.view,activePointSymbol:r,activeLineSymbol:m,activeVertexSymbol:r,activeFillSymbol:f,pointSymbol:r,polygonSymbol:f,
polylineSymbol:m,vertexSymbol:r});c._handles.add([E.on("create",I=>c._onSketchEvent(I)),E.on(["undo","redo"],I=>c._onSketchEvent(I))]);return c}d._inheritsLoose(t,z);var n=t.prototype;n.initialize=function(){this._load()};n.destroy=function(){this._handles.destroy();this._handles=null};n.cancel=function(){return this._sketchViewModel.cancel()};n._load=function(){var w=d._asyncToGenerator(function*(){yield this.view.whenReady();const {options:G}=this,{createTool:e,createOptions:c}=this._activeOptions=
{...this._defaultOptions,...G};this._sketchViewModel.create(e,c)});return function(){return w.apply(this,arguments)}}();n._onSketchEvent=function(w){this._processSelectionGeometry(("create"===w.type?w.graphic:w.graphics[0])?.geometry||null,"create"===w.type&&"complete"===w.state,"create"===w.type&&"cancel"===w.state)};n._processSelectionGeometry=function(w,G,e){this._set("geometry",w);if(G||e)this._completed=!0;if(e)this._onComplete([],!0);else{var {_activeOptions:c,candidates:f,selection:m,view:E}=
this;x.updateSelection({selector:w,candidates:f,currentSelection:m,options:c.selectionOptions,view:E}).then(({added:v,removed:r})=>{G?this._onComplete(this.selection.toArray(),!1):(v.length||r.length)&&this.emit("selection-change",{added:v,removed:r,type:"selection-change"})})}};n._onComplete=function(w,G){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:G,selection:w,type:"complete"})};d._createClass(t,[{key:"state",get:function(){const {_completed:w,_sketchViewModel:{state:G}}=
this;return w?"complete":"active"===G?"active":"disabled"}}]);return t}(h.EventedAccessor);D.__decorate([u.property()],g.prototype,"_completed",void 0);D.__decorate([u.property()],g.prototype,"candidates",void 0);D.__decorate([u.property({readOnly:!0})],g.prototype,"geometry",void 0);D.__decorate([u.property()],g.prototype,"options",void 0);D.__decorate([u.property({readOnly:!0})],g.prototype,"selection",void 0);D.__decorate([u.property({readOnly:!0})],g.prototype,"state",null);D.__decorate([u.property({value:null})],
g.prototype,"view",void 0);return g=D.__decorate([p.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],g)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers"],function(d,D,g){function Q(){return h.apply(this,arguments)}function h(){h=g._asyncToGenerator(function*(){return new Promise((C,p)=>d(["../../../geometry/geometryEngineJSON"],C,p))});return h.apply(this,arguments)}function q(){return u.apply(this,
arguments)}function u(){u=g._asyncToGenerator(function*(){return Q().then(({contains:C,intersects:p,overlaps:H,simplify:W})=>({contains:C,intersects:p,overlaps:H,simplify:W}))});return u.apply(this,arguments)}function l(){l=g._asyncToGenerator(function*(C){const {selector:p,candidates:H,currentSelection:W,options:x,view:A}=C;if(!(H&&H.length&&W&&A))return{added:[],removed:[]};const {overlaps:P,intersects:K,contains:z}=x,{spatialReference:t}=A;if(!p)return{added:[],removed:W.removeAll()};const n=yield q(),
w=[],G=[];H.forEach(e=>{var c=e.geometry;const f=P&&!!n.overlaps(t,p,c),m=K&&!!n.intersects(t,p,c);c=z&&!!n.contains(t,p,c);const E=W.includes(e);f||m||c?!E&&w.push(e):E&&G.push(e)});W.removeMany(G);W.addMany(w);return{added:w,removed:G}});return l.apply(this,arguments)}D.getGeometryEngineOperations=q;D.importGeometryEngine=Q;D.updateSelection=function(C){return l.apply(this,arguments)};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../Widget ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A){const P={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};u=function(K){function z(n,w){var G=K.call;const {view:e,viewModel:c,snappingOptions:f,...m}=n;w=G.call(K,this,m,w)||this;w._layerListFilter=null;w.messages=null;w.messagesCommon=null;w.visibleElements={...P};w._defaultViewModel=null;n?.viewModel?w.viewModel=n.viewModel:(w._defaultViewModel=new A({snappingOptions:n.snappingOptions,view:n.view}),w.viewModel=w._defaultViewModel);
return w}D._inheritsLoose(z,K);var t=z.prototype;t.destroy=function(){this._defaultViewModel=Q.destroyMaybe(this._defaultViewModel)};t.loadDependencies=function(){return Promise.all([new Promise((n,w)=>d(["../../chunks/calcite-accordion"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-accordion-item"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-block"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-checkbox"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-input"],n,w)),new Promise((n,
w)=>d(["../../chunks/calcite-label"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-list"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-list-item"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-panel"],n,w)),new Promise((n,w)=>d(["../../chunks/calcite-switch"],n,w))])};t.castVisibleElements=function(n){return{...P,...n}};t.render=function(){const {label:n,visibleElements:{header:w}}=this;return x.tsx("div",{"aria-label":n,class:this.classes("esri-snapping-controls","esri-widget")},x.tsx("div",
{class:"esri-snapping-controls__container"},w?this.renderHeaderView():this.renderContent()))};t.renderHeaderView=function(){return x.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};t.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};t.renderToggles=function(){const {visibleElements:{enabledToggle:n,selfEnabledToggle:w,featureEnabledToggle:G}}=this;if(n||w||G)return x.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",
key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),x.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))};t.renderEnabledToggle=function(){if(this.visibleElements.enabledToggle){var {messages:{enableSnapping:n},viewModel:{snappingOptions:{enabled:w,enabledToggled:G}}}=this;return x.tsx("calcite-label",{layout:"inline-space-between"},n,x.tsx("calcite-switch",{checked:w,disabled:G,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}};
t.renderSelfEnabledToggle=function(){if(this.visibleElements.selfEnabledToggle){var {messages:{geometryGuides:n},viewModel:{snappingOptions:{enabled:w,selfEnabled:G,enabledToggled:e}}}=this;return x.tsx("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},n,x.tsx("calcite-switch",{checked:G,disabled:e||!w,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}};t.renderFeatureEnabledToggle=function(){if(this.visibleElements.featureEnabledToggle){var {messages:{featureToFeature:n},
viewModel:{snappingOptions:{enabled:w,featureEnabled:G,enabledToggled:e}}}=this;return x.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},n,x.tsx("calcite-switch",{checked:G,disabled:e||!w,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}};t.renderLayerList=function(){if(this.visibleElements.layerList){var {messages:n,messagesCommon:w}=this,G=({target:{value:e}})=>this._layerListFilter=""===e?null:new RegExp(e,"i");G=9<this.viewModel.layerListViewModel.operationalItems.length?
x.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:n?.searchLayers,onCalciteInputInput:G}):null;return x.tsx("calcite-block",{key:"list-block","intl-collapse":w?.collapse,"intl-expand":w?.expand,heading:n.snappingLayers,class:"esri-snapping-controls__layer-list-block",open:!0,collapsible:!0},G,x.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,Q.unwrap(this._layerListFilter))))}};
t.renderLayerListItemCollection=function(n,w){return n.map(G=>{if(w?this._itemTitleMatchesFilter(G,w):1)return 0<G.children.length?this.renderLayerListItemGroup(G):this.renderLayerListItem(G);const e=G.children.filter(c=>this._itemTitleMatchesFilter(c,w));return 0<e.length?this.renderLayerListItemGroup(G,e):null}).toArray()};t.renderLayerListItem=function(n){var {messages:{untitledLayer:w}}=this;w=n.title||w;const G=x.tsx("calcite-checkbox",{value:n.layer.id,checked:n.enabled,bind:this,onCalciteCheckboxChange:e=>
this._handleLayerListItemChange(e.target)});return x.tsx("calcite-list-item",{key:`${this.id}-list-item-${n.uid}`,onclick:()=>{this._handleLayerListItemChange({checked:!G.properties.checked,value:G.properties.value})}},x.tsx("calcite-label",{class:"esri-snapping-controls__layer-list__item",slot:"content-start",tabIndex:-1,layout:"inline","disable-spacing":"true"},x.tsx("div",{class:"esri-snapping-controls__layer-list__item__checkbox"},G),x.tsx("div",{class:"esri-snapping-controls__layer-list__item__label"},
w)))};t.renderLayerListItemGroup=function(n,w){const G=n.title||this.messages.untitledLayer,e=n.title&&""!==n.title?n.title:h.generateUID();return x.tsx("calcite-list-item",{key:e},x.tsx("calcite-accordion",{"icon-position":"start",appearance:"transparent",afterCreate:c=>{c.append(...Array.from(c.children).map(f=>{f.remove();return f}))}},x.tsx("calcite-accordion-item",{active:!!w,"item-title":G,key:n.uid},x.tsx("calcite-list",null,[...this.renderLayerListItemCollection(w??n.children)]))))};t._enableSnappingSwitchChange=
function(n){this.snappingOptions.enabled=n.target.checked};t._featureEnabledSwitchChange=function(n){this.snappingOptions.featureEnabled=n.target.checked};t._itemTitleMatchesFilter=function(n,w){return w.test(n.title)};t._selfEnabledSwitchChange=function(n){this.snappingOptions.selfEnabled=n.target.checked};t._handleLayerListItemChange=function(){var n=D._asyncToGenerator(function*(w){w.checked?this.viewModel.enableSnappingForLayer(w.value):this.viewModel.disableSnappingForLayer(w.value)});return function(w){return n.apply(this,
arguments)}}();D._createClass(z,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(n){this._overrideIfSome("label",n)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(n){this.viewModel.snappingOptions=n}},{key:"view",get:function(){return this.viewModel.view},set:function(n){this.viewModel.view=n}},{key:"viewModel",set:function(n){if(n!==this._get("viewModel")){if(Q.isNone(this._defaultViewModel)||this._defaultViewModel!==n)this._defaultViewModel=
Q.destroyMaybe(this._defaultViewModel);this._set("viewModel",n)}}}]);return z}(p);g.__decorate([q.property()],u.prototype,"_layerListFilter",void 0);g.__decorate([q.property()],u.prototype,"label",null);g.__decorate([q.property(),W.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],u.prototype,"messages",void 0);g.__decorate([q.property(),W.messageBundle("esri/t9n/common")],u.prototype,"messagesCommon",void 0);g.__decorate([q.property()],u.prototype,"snappingOptions",null);
g.__decorate([q.property()],u.prototype,"view",null);g.__decorate([q.property()],u.prototype,"viewModel",null);g.__decorate([q.property()],u.prototype,"visibleElements",void 0);g.__decorate([l.cast("visibleElements")],u.prototype,"castVisibleElements",null);return u=g.__decorate([C.subclass("esri.widgets.support.SnappingControls")],u)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x){g=function(A){function P(z){z=A.call(this,z)||this;z.layerListViewModel=new x.SnappingLayerListViewModel;z.snappingOptions=null;z.view=null;return z}d._inheritsLoose(P,A);var K=P.prototype;K.initialize=function(){this.handles.add([q.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:z,view:t})=>{z.view=t},q.initial),q.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:z,sources:t})=>{z.featureSnappingSources=
t},q.initial)])};K.enableSnappingForLayer=function(z){(this._findSnappingSourceForLayer(z)??this._makeSnappingSourceForLayer(z)).enabled=!0};K.disableSnappingForLayer=function(z){if(z=this._findSnappingSourceForLayer(z))z.enabled=!1};K.updateEnabledFeatureSources=function(z){for(const t of this.snappingOptions.featureSources)W.canDisplayLayer(t.layer)&&(t.enabled=z.includes(t.layer.id))};K._findSnappingSourceForLayer=function(z){return this.snappingOptions.featureSources.find(t=>t.layer.id===z)};
K._makeSnappingSourceForLayer=function(z){var {layer:t}=this.layerListViewModel.operationalItemsFlat.find(n=>n.layer.id===z);if(!t)throw new Q("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${z} because no such layer was found in the view`);t=new H({layer:t});this.snappingOptions.featureSources.add(t);return t};d._createClass(P,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return P}(h.HandleOwnerMixin(g));D.__decorate([u.property({constructOnly:!0})],
g.prototype,"layerListViewModel",void 0);D.__decorate([u.property({constructOnly:!0})],g.prototype,"snappingOptions",void 0);D.__decorate([u.property()],g.prototype,"state",null);D.__decorate([u.property({constructOnly:!0})],g.prototype,"view",void 0);return g=D.__decorate([p.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],g)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(d){function D(C){if(C)return null!=C.listMode?C.listMode:
void 0}function g(C){if(C)return null!=C.minScale?C.minScale:void 0}function Q(C){if(C)return null!=C.maxScale?C.maxScale:void 0}function h(C){if(C){if(!("type"in C))return"sublayers";if(C.listMode!==l.hideChildren&&"wmts"!==C.type)switch(C.type){case "group":return"layers";default:return"sublayers"}}}function q(C,p){C&&C.sort((H,W)=>{H=p.indexOf(H.uid);W=p.indexOf(W.uid);return H>W?-1:H<W?1:0})}function u(C){return!!C?.layer}const l={hide:"hide",hideChildren:"hide-children"};d.canDisplayLayer=function(C){return D(C)!==
l.hide};d.canSortSublayers=function(C){C=C&&(C.get("layer.layer")||C.layer);if(!C)return!1;C=C.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof C?C:!0};d.findLayerListMode=D;d.findLayerMaxScale=Q;d.findLayerMinScale=g;d.findLayerVisibilityMode=function(C){if(!C)return"inherited";var p=C.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof p)return p?"independent":"inherited";p=C.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===
typeof p?p?"independent":"inherited":null!=C.visibilityMode?C.visibilityMode:"independent"};d.findSelectedItem=function(C,p){const H=C.layer?.uid;return H&&p.find(W=>W.layer?.uid===H)};d.getItemLayers=function(C){return(C=C?.layer)&&"group"===C.type?C.layers:null};d.getLegendLayerInfo=function(C){var p=u(C)?C:null;const H=C?.parent;return(p="map-image"===H?.type&&p.source)&&H?{layer:H,title:"",sublayerIds:[p.mapLayerId]}:{layer:C,title:""}};d.getNormalizedChildLayerProperty=h;d.isLayerOutsideScaleRange=
function(C,p){if(!C||isNaN(p))return!1;var H=g(C);C=Q(C);H=!isNaN(H)&&0<H&&p>H;p=!isNaN(C)&&0<C&&p<C;return H||p};d.isSublayer=u;d.sortChildLayersToIds=function(C,p){if(C=C?.layer){var H=h(C);H&&(C=C.get(H),q(C,p))}};d.sortLayersToIds=q;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H){d.SnappingLayerListViewModel=function(W){function x(){var P=W.apply(this,arguments)||this;P.featureSnappingSources=new Q;return P}D._inheritsLoose(x,W);var A=x.prototype;A._compileList=function(){var P=this.get("view.map.layers");P&&(P=P.filter(p.isValidSnappingLayer),this._watchLayersListMode(P),(P=this._getViewableLayers(P))&&P.length?(this._createNewItems(P),this._removeItems(P),this._sortItems(P)):this._removeAllItems())};A._createListItem=function(P){return new H.SnappingListItem({layer:P,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};D._createClass(x,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(P=>P.children)}}]);return x}(C);g.__decorate([h.property()],d.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);g.__decorate([h.property()],d.SnappingLayerListViewModel.prototype,"operationalItems",void 0);d.SnappingLayerListViewModel=g.__decorate([l.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
d.SnappingLayerListViewModel);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W){const x=g.ofType(H);g=function(A){function P(z){z=A.call(this,z)||this;z._handles=new h;z.checkPublishStatusEnabled=!1;z.listItemCreatedFunction=null;z.operationalItems=new x;z.view=null;return z}d._inheritsLoose(P,A);var K=P.prototype;K.initialize=function(){this._handles.add([q.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),q.initial),q.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};K.destroy=
function(){this._handles.destroy();this.view=this._handles=null;this.operationalItems.removeAll()};K.triggerAction=function(z,t){z&&!z.disabled&&this.emit("trigger-action",{action:z,item:t})};K.moveListItem=function(z,t,n,w){const G=z?.layer;if(G){var e=this.view?.map?.layers,c=t?W.getItemLayers(t):e;e=n?W.getItemLayers(n):e;if(c&&e){var {operationalItems:f}=this;t=t?.children||f;f=n?.children||f;w=e.length-w;z.parent=n||null;t.includes(z)&&t.remove(z);c.includes(G)&&c.remove(G);f.includes(z)||f.add(z,
w);e.includes(G)||e.add(G,w)}}};K._createLayerViewHandles=function(z){const {_handles:t}=this;t.remove("layer-views");this._compileList();z&&t.add(z.on("change",()=>this._compileList()),"layer-views")};K._createMapLayerHandles=function(z){const {_handles:t}=this;t.remove("map-layers");this._compileList();z&&t.add(z.on("change",()=>this._compileList()),"map-layers")};K._createListItem=function(z){const {view:t,listItemCreatedFunction:n,checkPublishStatusEnabled:w}=this;return new H({checkPublishStatusEnabled:w,
layer:z,listItemCreatedFunction:n,view:t})};K._removeAllItems=function(){const {_handles:z,operationalItems:t}=this;t.forEach(n=>{z.remove(`${"children"}-${n.uid}`)});t.removeAll()};K._getViewableLayers=function(z){if(z)return z.filter(t=>"hide"!==W.findLayerListMode(t))};K._watchLayersListMode=function(z){const {_handles:t}=this;t.remove("layer-list-mode");z&&z.forEach(n=>{"listMode"in n&&t.add(q.watch(()=>n.listMode,()=>this._compileList()),"layer-list-mode")})};K._compileList=function(){var z=
this.get("view.map.layers");this._watchLayersListMode(z);(z=this._getViewableLayers(z))&&z.length?(this._createNewItems(z),this._removeItems(z),this._sortItems(z)):this._removeAllItems()};K._createNewItems=function(z){const {operationalItems:t}=this;z.forEach(n=>{t.find(w=>w.layer===n)||t.add(this._createListItem(n))})};K._removeItems=function(z){const {_handles:t,operationalItems:n}=this,w=[];n.forEach(G=>{G&&z&&z.includes(G.layer)||(t.remove(`${"children"}-${G.uid}`),w.push(G))});n.removeMany(w)};
K._sortItems=function(z){const {operationalItems:t}=this;t.sort((n,w)=>{n=z.indexOf(n.layer);w=z.indexOf(w.layer);return n>w?-1:n<w?1:0})};K._recompileList=function(){this._removeAllItems();this._compileList()};K._viewHandles=function(){const {_handles:z,view:t}=this;z.remove(["map-layers","layer-views","view-layers"]);this._compileList();t&&t.ready&&z.add([q.watch(()=>this.view?.map?.allLayers,n=>this._createMapLayerHandles(n),q.initial),q.watch(()=>this.view?.allLayerViews,n=>this._createLayerViewHandles(n),
q.initial)],"view-layers")};d._createClass(P,[{key:"state",get:function(){const z=this.get("view");return this.get("view.ready")?"ready":z?"loading":"disabled"}}]);return P}(Q.EventedAccessor);D.__decorate([u.property()],g.prototype,"checkPublishStatusEnabled",void 0);D.__decorate([u.property()],g.prototype,"listItemCreatedFunction",void 0);D.__decorate([u.property({type:x})],g.prototype,"operationalItems",void 0);D.__decorate([u.property({readOnly:!0})],g.prototype,"state",null);D.__decorate([u.property()],
g.prototype,"view",void 0);return g=D.__decorate([p.subclass("esri.widgets.LayerList.LayerListViewModel")],g)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K,z){var t;C=Q.ofType({key:"type",defaultKeyValue:"button",base:W,typeMap:{button:x,toggle:P,slider:A}});const n=Q.ofType(C);g=t=function(w){function G(c){c=w.call(this,c)||this;c.actionsSections=new n;c.actionsOpen=!1;c.checkPublishStatusEnabled=!1;c.children=new (Q.ofType(t));c.childrenSortable=!0;c.hidden=!1;c.layer=null;c.layerView=null;c.listItemCreatedFunction=null;c.open=!1;c.panel=null;c.parent=null;c.sortable=!0;c.view=null;return c}d._inheritsLoose(G,
w);var e=G.prototype;e.initialize=function(){this.handles.add([u.watch(()=>this.layer,c=>this._watchLayerProperties(c),u.initial),u.watch(()=>this.checkPublishStatusEnabled,c=>this._updateChildrenPublishing(c),u.initial),u.watch(()=>this.view,c=>this._updateChildrenView(c),u.initial),u.watch(()=>this.panel,c=>this._setListItemOnPanel(c),u.initial),u.watch(()=>[this.layer,this.view],()=>this._getLayerView(),u.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};e.destroy=function(){this.view=null};e.castPanel=function(c){this.get("panel.open")&&!c.hasOwnProperty("open")&&(c.open=!0);return c?new K(c):null};e.clone=function(){return new t({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
e._setListItemOnPanel=function(c){c&&(c.listItem=this)};e._updateChildrenPublishing=function(c){const f=this.children;f&&f.forEach(m=>m.checkPublishStatusEnabled=c)};e._updateChildrenView=function(c){const f=this.children;f&&f.forEach(m=>m.view=c)};e._addChildren=function(c){this.handles.remove("child-list-mode");this.children.removeAll();if(c){c.forEach(m=>{this.handles.add(u.watch(()=>m.listMode,()=>this._addChildren(c)),"child-list-mode")});var f=c.filter(m=>"hide"!==z.findLayerListMode(m));this.children.addMany(this._makeChildren(f))}};
e._watchSublayerChanges=function(c){c&&this.handles.add(c.on("change",()=>{this._addChildren(c)}),"layer")};e._initializeChildLayers=function(c){this._addChildren(c);this._watchSublayerChanges(c)};e._makeChildren=function(c){return c.map(f=>z.canDisplayLayer(f)?new t({layer:f,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).reverse()};e._watchLayerProperties=function(c){if(this.handles&&(this.handles.remove("layer"),
this.handles.remove("child-list-mode"),c))if(this.handles.add(u.watch(()=>c.listMode,()=>this._watchLayerProperties(c)),"layer"),"hide-children"===z.findLayerListMode(c))this.children.removeAll();else{var f=z.getNormalizedChildLayerProperty(c);f&&this.handles.add(u.watch(()=>c[f],()=>{c.hasOwnProperty(f)&&this._initializeChildLayers(c[f])},u.initial),"layer")}};e._getLayerView=function(){var c=d._asyncToGenerator(function*(){const {layer:f,view:m}=this;if(f&&m)try{const E=yield m.whenLayerView(f);
E.layer===this.layer&&this._set("layerView",E)}catch{}});return function(){return c.apply(this,arguments)}}();d._createClass(G,[{key:"connectionStatus",get:function(){const {layerView:c,publishing:f}=this;if(!f&&c&&"connectionStatus"in c)return c.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:c}=this;return c&&"spatialReferenceSupported"in c?!c.spatialReferenceSupported:!1}},{key:"title",get:function(){const c=this.get("layer.layer");
return(!c||c&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(c){this._override("title",c)}},{key:"publishing",get:function(){const {layer:c,checkPublishStatusEnabled:f}=this;return f&&c&&"publishingInfo"in c&&"publishing"===c.publishingInfo.status}},{key:"updating",get:function(){const {layerView:c,connectionStatus:f,layer:m,publishing:E}=this;return E||f?!1:c?c.updating:"loading"===m?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},
set:function(c){const f=this.layer;f&&(f.visible=c)}},{key:"visibleAtCurrentScale",get:function(){return!z.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return z.findLayerVisibilityMode(this.layer)}}]);return G}(q.IdentifiableMixin(h.HandleOwnerMixin(g)));D.__decorate([l.property({type:n})],g.prototype,"actionsSections",void 0);D.__decorate([l.property()],g.prototype,"actionsOpen",void 0);D.__decorate([l.property()],g.prototype,"checkPublishStatusEnabled",
void 0);D.__decorate([l.property({type:Q})],g.prototype,"children",void 0);D.__decorate([l.property()],g.prototype,"childrenSortable",void 0);D.__decorate([l.property({readOnly:!0})],g.prototype,"connectionStatus",null);D.__decorate([l.property({readOnly:!0})],g.prototype,"error",null);D.__decorate([l.property()],g.prototype,"hidden",void 0);D.__decorate([l.property({readOnly:!0})],g.prototype,"incompatible",null);D.__decorate([l.property()],g.prototype,"layer",void 0);D.__decorate([l.property({readOnly:!0})],
g.prototype,"layerView",void 0);D.__decorate([l.property()],g.prototype,"listItemCreatedFunction",void 0);D.__decorate([l.property()],g.prototype,"open",void 0);D.__decorate([l.property({type:K})],g.prototype,"panel",void 0);D.__decorate([p.cast("panel")],g.prototype,"castPanel",null);D.__decorate([l.property()],g.prototype,"parent",void 0);D.__decorate([l.property()],g.prototype,"sortable",void 0);D.__decorate([l.property()],g.prototype,"title",null);D.__decorate([l.property({readOnly:!0})],g.prototype,
"publishing",null);D.__decorate([l.property({readOnly:!0})],g.prototype,"updating",null);D.__decorate([l.property()],g.prototype,"view",void 0);D.__decorate([l.property()],g.prototype,"visible",null);D.__decorate([l.property({readOnly:!0})],g.prototype,"visibleAtCurrentScale",null);D.__decorate([l.property({readOnly:!0})],g.prototype,"visibilityMode",null);return g=t=D.__decorate([H.subclass("esri.widgets.LayerList.ListItem")],g)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(d,D,g,Q,h,q,u){var l;Q=l=function(C){function p(H){H=C.call(this,H)||this;H.displayValueEnabled=!1;H.max=1;H.min=0;H.step=.1;H.type="slider";H.value=null;return H}d._inheritsLoose(p,C);p.prototype.clone=function(){return new l({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return p}(u);D.__decorate([g.property()],
Q.prototype,"displayValueEnabled",void 0);D.__decorate([g.property()],Q.prototype,"max",void 0);D.__decorate([g.property()],Q.prototype,"min",void 0);D.__decorate([g.property()],Q.prototype,"step",void 0);D.__decorate([g.property()],Q.prototype,"value",void 0);return Q=l=D.__decorate([q.subclass("esri.support.Action.ActionSlider")],Q)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W,x,A){h=function(P){function K(t,n){t=P.call(this,t,n)||this;t._legend=null;t._handles=new Q;t.content=null;t.image=null;t.listItem=null;t.open=!1;t.visible=!0;return t}D._inheritsLoose(K,P);var z=K.prototype;z.initialize=function(){this.addHandles(q.watch(()=>this.content,t=>this._createLegend(t),q.initial))};z.destroy=function(){const {_legend:t}=this;t&&t.destroy();this._legend=null};z.render=function(){return A.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};
z._renderContent=function(t){const {_legend:n,disabled:w}=this;return!t||w?null:"legend"===t&&n?A.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:n},n.render()):"string"===typeof t?A.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:t,innerHTML:t}):x.isWidget(t)?A.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:t},t.render()):
t instanceof HTMLElement?A.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:t,bind:t,afterCreate:this._attachToNode}):null};z._renderContents=function(){const {content:t}=this;return Array.isArray(t)?t.map(n=>this._renderContent(n)):this._renderContent(t)};z._getLegendOptions=function(){const {listItem:t}=this;if(!t)return{};const {layer:n,view:w}=t;return n&&w?{view:w,layerInfos:[W.getLegendLayerInfo(n)]}:{}};z._createLegend=function(t){this._hasLegend(t)&&
!this._legend&&(new Promise((n,w)=>d(["../Legend"],G=>n(Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}))),w))).then(({default:n})=>{const {_handles:w,listItem:G}=this,e=new n(this._getLegendOptions());this._legend=e;this.notifyChange("className");this.notifyChange("title");n=q.watch(()=>[G?.view,G?.layer,G?.layer?.source,G?.layer?.parent],()=>this._updateLegend(e),q.initial);w.add(n,"legends");this.scheduleRender()})};z._hasLegend=function(t){return"legend"===
t?!0:Array.isArray(t)?t.includes("legend"):!1};z._attachToNode=function(t){t.appendChild(this)};z._updateLegend=function(t){t.set(this._getLegendOptions());this.scheduleRender()};z._getWidget=function(t){return"legend"===t?this._legend:x.isWidget(t)?t:null};z._getFirstWidget=function(){const {content:t}=this;if(Array.isArray(t)){let n=null;t.some(w=>{(w=this._getWidget(w))&&(n=w);return!!w});return n}return this._getWidget(t)};D._createClass(K,[{key:"className",get:function(){const {image:t}=this,
n=this._getFirstWidget();return this._get("className")||!t&&n?n.iconClass:""},set:function(t){this._override("className",t)}},{key:"disabled",get:function(){const {listItem:t,_legend:n,content:w}=this;return t?Array.isArray(w)&&1<w.length?!1:n?!n.activeLayerInfos?.length||!t.visibleAtCurrentScale:!1:!0},set:function(t){this._overrideIfSome("disabled",t)}},{key:"title",get:function(){const t=this._getFirstWidget();return this._get("title")||t?t.label:""},set:function(t){this._override("title",t)}}]);
return K}(h.IdentifiableMixin(H));g.__decorate([u.property()],h.prototype,"_legend",void 0);g.__decorate([u.property()],h.prototype,"className",null);g.__decorate([u.property()],h.prototype,"content",void 0);g.__decorate([u.property()],h.prototype,"disabled",null);g.__decorate([u.property()],h.prototype,"image",void 0);g.__decorate([u.property()],h.prototype,"listItem",void 0);g.__decorate([u.property()],h.prototype,"title",null);g.__decorate([u.property()],h.prototype,"open",void 0);g.__decorate([u.property()],
h.prototype,"visible",void 0);return h=g.__decorate([p.subclass("esri.widgets.LayerList.ListItemPanel")],h)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(d,D,g){const Q=u=>h(u)||q(u),h=u=>{if(!("type"in u))return!1;switch(u.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},q=u=>{const l=g.getNormalizedChildLayerProperty(u);if(u.hasOwnProperty(l)&&D.isSome(u[l]))for(const C of u[l])if(Q(C))return!0;return!1};d.isValidSnappingLayer=Q;d.isValidSnappingLayerGroup=q;d.isValidSnappingLayerSource=h;Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(d,D,g,Q,h,q,u,l,C,p,H,W){var x;d.SnappingListItem=x=function(A){function P(z){z=A.call(this,z)||this;z.children=new Q;return z}D._inheritsLoose(P,A);var K=P.prototype;K._initializeChildLayers=function(z){z&&(z=z.filter(W.isValidSnappingLayer),A.prototype._initializeChildLayers.call(this,z))};K._makeChildren=function(z){return z.map(t=>H.canDisplayLayer(t)?new x({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).reverse()};D._createClass(P,
[{key:"enabled",get:function(){return h.isSome(this.featureSource)?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:z,getFeatureSnappingSources:t}=this;return t().find(n=>n.layer===z)}}]);return P}(p);g.__decorate([q.property()],d.SnappingListItem.prototype,"children",void 0);g.__decorate([q.property()],d.SnappingListItem.prototype,"enabled",null);g.__decorate([q.property({constructOnly:!0})],d.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);g.__decorate([q.property()],
d.SnappingListItem.prototype,"featureSource",null);g.__decorate([q.property()],d.SnappingListItem.prototype,"parent",void 0);d.SnappingListItem=x=g.__decorate([C.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],d.SnappingListItem);Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/handleUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./Sketch/SketchViewModel ./support/SelectionToolbar ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(d,
D,g,Q,h,q,u,l,C,p,H,W,x,A,P,K,z,t,n,w){const G={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}};Q=function(e){function c(m,E){E=e.call(this,m,E)||this;E._activeCreateOptions=null;E._menuOpen=!1;E._selectionToolbar=null;E._snappingControls=null;E._viewModelHandlesGroup=
null;E.availableCreateTools=["point","polyline","polygon","rectangle","circle"];E.creationMode="continuous";E.iconClass="esri-icon-edit";E.layout="horizontal";E.messages=null;E.visibleElements={...G};E._activateCreateTool=E._activateCreateTool.bind(D._assertThisInitialized(E));E.viewModel=m?.viewModel||new x;return E}D._inheritsLoose(c,e);var f=c.prototype;f.initialize=function(){const {layer:m,view:E}=this,v=new A({view:"2d"===E?.type?E:null,layers:m?[m]:null});this.addHandles([u.watch(()=>this.viewModel,
r=>{this._viewModelHandlesGroup=q.removeMaybe(this._viewModelHandlesGroup);r&&(this._viewModelHandlesGroup=h.handlesGroup([r.on("create",I=>{this.scheduleRender();this._onCreateOperation(I)}),r.on("update",()=>this.scheduleRender()),r.on("delete",I=>this.emit("delete",I)),r.on("undo",()=>this.scheduleRender()),r.on("redo",()=>this.scheduleRender()),u.watch(()=>r.layer,I=>{this._selectionToolbar.layers=I?[I]:null}),u.watch(()=>r.view,I=>{this._selectionToolbar.view="2d"===I?.type?I:null;this._setUpSnappingControls()}),
u.watch(()=>r.state,()=>this.notifyChange("state"))]))},u.syncAndInitial),u.when(()=>v.activeToolInfo,()=>this.viewModel.cancel()),v.on("complete",r=>this._onSelectionOperationComplete(r))]);this._selectionToolbar=v;this._setUpSnappingControls()};f.loadDependencies=function(){return Promise.all([new Promise((m,E)=>d(["../chunks/calcite-action"],m,E)),new Promise((m,E)=>d(["../chunks/calcite-icon"],m,E))])};f.destroy=function(){this._selectionToolbar.destroy();this._viewModelHandlesGroup=q.removeMaybe(this._viewModelHandlesGroup);
this._snappingControls=q.destroyMaybe(this._snappingControls)};f.castVisibleElements=function(m){m={...G,...m,createTools:{...G.createTools,...m?.createTools},selectionTools:{...G.selectionTools,...m?.selectionTools},snappingControlsElements:{...G.snappingControlsElements,...m?.snappingControlsElements}};q.isSome(this._snappingControls)&&(this._snappingControls.visibleElements=m.snappingControlsElements);return m};f.create=function(m,E){this._activeCreateOptions=E||null;this.viewModel.create(m,E)};
f.update=function(m,E){return this.viewModel.update(m,E)};f.complete=function(){this.viewModel.complete()};f.cancel=function(){this._selectionToolbar.cancel();this.viewModel.cancel()};f.undo=function(){this.viewModel.undo();this.view?.focus()};f.redo=function(){this.viewModel.redo();this.view?.focus()};f.delete=function(){this.viewModel.delete()};f.render=function(){const {label:m,layout:E,viewModel:{state:v}}=this;return n.tsx("div",{"aria-label":m,class:this.classes("esri-sketch","esri-widget",
{["esri-disabled"]:"disabled"===v,["esri-sketch--vertical"]:"vertical"===E})},n.tsx("div",{role:"toolbar",class:"esri-sketch__panel"},this.renderTopPanelContents()),n.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this.renderInfoPanelContents()))};f.renderTopPanelContents=function(){const m=this.classes("esri-sketch__section","esri-sketch__tool-section"),{availableCreateTools:E,visibleElements:v}=this;return[n.tsx("div",{role:"menu",key:"selection-button-container",
class:m},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),E&&E.length?n.tsx("div",{role:"menu",class:m},this.renderDrawButtons()):null,v.undoRedoMenu?n.tsx("div",{role:"menu",key:"undo-redo-menu-button-container",class:m},this.renderUndoRedoMenuButtons()):null,v.settingsMenu?n.tsx("div",{key:"settings-menu-button-container",class:"esri-sketch__section"},this.renderSettingsMenuButton()):null]};f.renderInfoPanelContents=function(){if(this._menuOpen)return this.renderSettingsMenu();
if(this.updateGraphics.length)return[n.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this.renderFeatureCount()),n.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section"),key:"delete-button-container"},this.renderDeleteButton())]};f.renderSettingsMenu=function(){const {settings:m}=this.messages;return[n.tsx("div",{role:"menu",class:"esri-sketch__menu-container",key:"settings-menu-container"},
n.tsx("header",{class:"esri-sketch__menu-header",key:"settings-menu-header"},n.tsx("span",{class:"esri-sketch__menu-title"},m)),this.renderSnappingControls())]};f.renderSnappingControls=function(){const {snappingControls:m}=this.visibleElements;if(q.isSome(this._snappingControls)&&m)return this._snappingControls.render()};f.renderFeatureCount=function(){const {layout:m,messages:E,updateGraphics:{length:v}}=this,r=w.substitute(1===v?E.featureCount:E.featuresCount,{count:v});return n.tsx("div",{class:"esri-sketch__feature-count-badge",
"aria-label":r},n.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===m?v:r))};f.renderDeleteButton=function(){const m=this.messages.deleteFeature;return n.tsx("calcite-action",{bind:this,label:m,onclick:this.delete,scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"trash"}))};f.renderDefaultSelectionButton=function(){if(this.viewModel.updateOnGraphicClick){var m=this.messages.selectFeature;return n.tsx("calcite-action",{active:"ready"===this.state,bind:this,label:m,onclick:this._activateDefaultSelectTool,
scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"cursor"}))}};f.renderSelectionToolbar=function(){if("2d"===this.view?.type){var m=this.visibleElements.selectionTools;this._selectionToolbar.visibleElements={lassoTool:!!m["lasso-selection"],rectangleTool:!!m["rectangle-selection"]};return this._selectionToolbar.render()}};f.renderDrawButtons=function(){const m=this.visibleElements.createTools;return this.availableCreateTools.map(E=>{if("point"===E&&m.point)return this.renderPointButton();
if("polyline"===E&&m.polyline)return this.renderPolylineButton();if("polygon"===E&&m.polygon)return this.renderPolygonButton();if("rectangle"===E&&m.rectangle)return this.renderRectangleButton();if("circle"===E&&m.circle)return this.renderCircleButton()})};f.renderPointButton=function(){const m=this.messages.drawPoint;return n.tsx("calcite-action",{active:"point"===this.activeTool,bind:this,label:m,onclick:()=>this._activateCreateTool("point"),scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",
icon:"pin"}))};f.renderPolygonButton=function(){const m=this.messages.drawPolygon;return n.tsx("calcite-action",{active:"polygon"===this.activeTool,bind:this,label:m,onclick:()=>this._activateCreateTool("polygon"),scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"polygon"}))};f.renderPolylineButton=function(){const m=this.messages.drawPolyline;return n.tsx("calcite-action",{active:"polyline"===this.activeTool,bind:this,label:m,onclick:()=>this._activateCreateTool("polyline"),scale:"s",
text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"line"}))};f.renderCircleButton=function(){const m=this.messages.drawCircle;return n.tsx("calcite-action",{active:"circle"===this.activeTool,bind:this,label:m,onclick:()=>this._activateCreateTool("circle"),scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"circle"}))};f.renderRectangleButton=function(){const m=this.messages.drawRectangle;return n.tsx("calcite-action",{active:"rectangle"===this.activeTool,bind:this,label:m,onclick:()=>
this._activateCreateTool("rectangle"),scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"rectangle"}))};f.renderUndoRedoMenuButtons=function(){return[this.renderUndoButton(),this.renderRedoButton()]};f.renderUndoButton=function(){const m=this.messages.undo;return n.tsx("calcite-action",{disabled:!this.viewModel.canUndo(),bind:this,label:m,onclick:this.undo,scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:K.isRTL(this.container)?"redo":"undo"}))};f.renderRedoButton=function(){const m=
this.messages.redo;return n.tsx("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,label:m,onclick:this.redo,scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:K.isRTL(this.container)?"undo":"redo"}))};f.renderSettingsMenuButton=function(){const m=this.messages.settings;return n.tsx("calcite-action",{active:this._menuOpen,bind:this,label:m,onclick:this._toggleMenu,scale:"s",text:m,title:m},n.tsx("calcite-icon",{scale:"s",icon:"gear"}))};f._activateCreateTool=function(m){this.activeTool===
m?this.cancel():(this._selectionToolbar.cancel(),this.create(m))};f._onCreateOperation=function(m){if("complete"===m.state){var {creationMode:E}=this,{type:v}=m;if("create"===v){const {tool:r,graphic:I}=m;m=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===E?this.create(r,m):"update"===E&&this.update([I])}}};f._toggleMenu=function(){this._menuOpen=!this._menuOpen;this.scheduleRender()};f._onSelectionOperationComplete=function(m){const {viewModel:{defaultUpdateOptions:E}}=this,
{selection:v}=m;!m.aborted&&v.length&&(m=E.tool,this.update(v,{...E,tool:1<v.length&&"reshape"===m?"transform":m}));this.notifyChange("state")};f._activateDefaultSelectTool=function(){this.cancel();this.view?.focus()};f._setUpSnappingControls=function(){const {snappingOptions:m,view:E}=this;this._snappingControls=q.destroyMaybe(this._snappingControls);m&&E&&(this._snappingControls=new P({snappingOptions:m,view:E,visibleElements:this.visibleElements.snappingControlsElements}))};D._createClass(c,[{key:"activeTool",
get:function(){const m=this._selectionToolbar.activeToolInfo;if(m)switch(m.toolName){case "lasso":return"lasso-selection";case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}},{key:"createGraphic",get:function(){return this.viewModel.createGraphic}},{key:"defaultCreateOptions",get:function(){return this.viewModel.defaultCreateOptions},set:function(m){this.viewModel.defaultCreateOptions=m}},{key:"defaultUpdateOptions",get:function(){return this.viewModel.defaultUpdateOptions},
set:function(m){this.viewModel.defaultUpdateOptions=m}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(m){this._overrideIfSome("label",m)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(m){this.viewModel.labelOptions=m}},{key:"layer",get:function(){return this.viewModel.layer},set:function(m){this.viewModel.layer=m}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(m){this.viewModel.snappingOptions=
m}},{key:"state",get:function(){return this._selectionToolbar.activeToolInfo?"active":this.viewModel.state}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(m){this.viewModel.tooltipOptions=m}},{key:"updateGraphics",get:function(){return this.viewModel.updateGraphics}},{key:"view",get:function(){return this.viewModel.view},set:function(m){this.viewModel.view=m}},{key:"viewModel",set:function(m){const E=this._get("viewModel");m!==E&&(E&&q.destroyMaybe(E),this._set("viewModel",
m))}}]);return c}(W);g.__decorate([l.property()],Q.prototype,"activeTool",null);g.__decorate([l.property({cast:e=>{if(!e||!e.length)return null;const c=new Set(["point","polyline","polygon","rectangle","circle"]);return e.filter(f=>c.has(f))}})],Q.prototype,"availableCreateTools",void 0);g.__decorate([l.property({readOnly:!0})],Q.prototype,"createGraphic",null);g.__decorate([l.property()],Q.prototype,"creationMode",void 0);g.__decorate([l.property()],Q.prototype,"defaultCreateOptions",null);g.__decorate([l.property()],
Q.prototype,"defaultUpdateOptions",null);g.__decorate([l.property()],Q.prototype,"iconClass",void 0);g.__decorate([l.property()],Q.prototype,"label",null);g.__decorate([l.property()],Q.prototype,"labelOptions",null);g.__decorate([l.property()],Q.prototype,"layer",null);g.__decorate([l.property({type:["horizontal","vertical"]})],Q.prototype,"layout",void 0);g.__decorate([l.property(),z.messageBundle("esri/widgets/Sketch/t9n/Sketch")],Q.prototype,"messages",void 0);g.__decorate([l.property()],Q.prototype,
"snappingOptions",null);g.__decorate([l.property()],Q.prototype,"state",null);g.__decorate([l.property()],Q.prototype,"tooltipOptions",null);g.__decorate([l.property({readOnly:!0})],Q.prototype,"updateGraphics",null);g.__decorate([l.property()],Q.prototype,"view",null);g.__decorate([l.property(),t.vmEvent(["create","update","undo","redo"])],Q.prototype,"viewModel",null);g.__decorate([l.property()],Q.prototype,"visibleElements",void 0);g.__decorate([p.cast("visibleElements")],Q.prototype,"castVisibleElements",
null);return Q=g.__decorate([H.subclass("esri.widgets.Sketch")],Q)});