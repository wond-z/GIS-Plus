// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/events ../core/Logger ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./CoordinateConversion/CoordinateConversionViewModel ./CoordinateConversion/support/Conversion ./support/Heading ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/jsxFactory ./support/widgetUtils".split(" "),function(v,
l,E,w,n,k,F,G,H,x,y,z,r,A,c,B){const C={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0};k=function(D){function t(a,b){a=D.call(this,a,b)||this;a._popupMessage=null;a._popupTimeoutId=null;a._clipboardPopupTimeoutId=null;a._coordinateInput=null;a._badInput=!1;a._goToEnabled=!1;a._conversionFormat=null;a._settingsFormat=null;a._previewConversion=null;a._expanded=!1;a._clipboardPopupVisible=!1;a._popupVisible=!1;a._settingsVisible=!1;a._inputVisible=!1;a.headingLevel=4;a.messages=null;
a.messagesCommon=null;a.orientation="auto";a.viewModel=new x;a.visibleElements={...C};return a}v._inheritsLoose(t,D);var e=t.prototype;e.castVisibleElements=function(a){return{...C,...a}};e.reverseConvert=function(a,b){return this.viewModel.reverseConvert(a,b)};e.render=function(){const a=this.get("viewModel.state"),b="disabled"===a?c.tsx("div",{key:"esri-coordinate__no-basemap"},this.messages.noBasemap):null,d=!b&&this._inputVisible?this._renderInputForm():null,f=!b&&this._settingsVisible?this._renderSettings():
null,h=b||d||f?null:this._renderConversionsView(),g=this._popupVisible?this._renderPopup():null;return c.tsx("div",{class:this.classes("esri-coordinate-conversion esri-widget",{["esri-coordinate-conversion--capture-mode"]:"capture"===this.mode,["esri-disabled"]:"loading"===a,["esri-coordinate-conversion--no-basemap"]:"disabled"===a})},g,b,h,f,d)};e._addConversion=function(a){a=a.target;const b=a["data-index"],d=new y({format:a.options[a.options.selectedIndex]["data-format"]});a.options.selectedIndex=
0;0<=b&&this.conversions.removeAt(b);this.conversions.add(d,b)};e._findSettingsFormat=function(){return this._settingsFormat||this.conversions.reduceRight((a,b)=>{b=b.format;return b.get("hasDisplayProperties")?b:a},null)||this.formats.find(a=>a.hasDisplayProperties)};e._hidePopup=function(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=null);this._popupVisible=!1;this._popupMessage=null;this.scheduleRender()};e._hideClipboardPopup=function(){this._clipboardPopupTimeoutId&&
(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=null);this._clipboardPopupVisible=!1;this.scheduleRender()};e._onConvertComplete=function(){this._inputVisible=!1;this._coordinateInput.value=""};e._onCopy=function(a){a.clipboardData.setData("text/plain",a.currentTarget["data-conversion"].displayCoordinate);this._showClipboardPopup();a.preventDefault()};e._processUserInput=function(a){a=E.eventKey(a);const b=this.viewModel;"Enter"!==a&&a?this._badInput&&(this._badInput=!1):
this._reverseConvert(this._coordinateInput.value,this._coordinateInput["data-format"]).then(d=>{"capture"===this.mode?b.resume():this.mode="capture";this.currentLocation=d;b.setLocation(d);this._onConvertComplete()}).catch(d=>{w.getLogger(this.declaredClass).error(d);this._showPopup(this.messages.invalidCoordinate);this._badInput=!0})};e._reverseConvert=function(a,b){const d=this.viewModel;return b.reverseConvert(a).then(f=>{this._goToEnabled&&d.goToLocation(f).catch(h=>{w.getLogger(this.declaredClass).warn(h);
this._showPopup(this.messages.locationOffBasemap)});return f})};e._setInputFormat=function(a){a=a.target;this._conversionFormat=a[a.options.selectedIndex]["data-format"]};e._setPreviewConversion=function(){const a=this._findSettingsFormat(),b=this.viewModel;if(a){const d=this.conversions.find(f=>f.format===a);this._previewConversion=new y({format:a,position:{location:this.currentLocation,coordinate:d&&d.position.coordinate}});this._previewConversion.position.coordinate||b.previewConversion(this._previewConversion)}};
e._setSettingsFormat=function(a){a=a.target;this._settingsFormat=a[a.options.selectedIndex]["data-format"];this._setPreviewConversion()};e._showClipboardPopup=function(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0;this.scheduleRender();this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=null;this._hideClipboardPopup()},750)};e._showPopup=function(a,b=2500){this._popupMessage=a;this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=
!0;this.scheduleRender();this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=null;this._hidePopup()},b)};e._toggleGoTo=function(){this._goToEnabled=!this._goToEnabled};e._updateCurrentPattern=function(a){a.stopPropagation();a=a.target;const b=this._findSettingsFormat();b&&(b.currentPattern=a.value)};e._renderConversion=function(a,b){const {messages:d}=this,f=`${this.id}__list-item-${b}`,h=`${a.format.label} ${d.conversionOutputSuffix}`;var g=0===b;const m=g||this._expanded,p=g?this._renderFirstConversion(a):
this._renderTools(b,a,f);g=g&&!a.displayCoordinate?d.noLocation:a.displayCoordinate;g=c.tsx("div",{"aria-label":g,class:"esri-coordinate-conversion__display","data-conversion":a,role:"listitem",tabindex:"0",title:g},g);const q=this._renderOptions(this.formats.filter(u=>u!==a.format));return m?c.tsx("li",{"aria-label":h,class:"esri-coordinate-conversion__row",id:f,key:a,role:"group",title:h,tabindex:"0"},c.tsx("select",{"aria-controls":f,"aria-label":d.selectFormat,class:this.classes("esri-select",
"esri-coordinate-conversion__select-row"),bind:this,"data-index":b,onchange:this._addConversion,title:d.selectFormat},c.tsx("option",{"aria-label":a.format.label,selected:!0,title:a.format.label},a.format.label.toUpperCase()),q),g,p):null};e._renderCopyButton=function(a){const b=this._clipboardPopupVisible&&this._renderClipboardPopup();return c.tsx("li",{"aria-label":this.messagesCommon.copy,bind:this,class:this.classes("esri-widget--button","esri-coordinate-conversion__row-button"),"data-conversion":a,
onclick:this._copyCoordinateOutput,onkeydown:this._copyCoordinateOutput,oncopy:this._onCopy,role:"button",tabindex:"0",title:this.messagesCommon.copy},b,c.tsx("span",{"aria-hidden":"true",class:"esri-icon-duplicate"}))};e._renderFirstConversion=function(a){var b=this.id;const d={["esri-icon-down"]:!this._expanded,["esri-icon-up"]:this._expanded},{messages:f,messagesCommon:h,multipleConversions:g,visibleElements:m}=this;var p="live"===this.mode?f.captureMode:f.liveMode;const q=this._expanded?h.collapse:
h.expand;a=a.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(a):null;b=g&&m.expandButton&&c.tsx("li",{"aria-controls":`${b}__${"esri-coordinate-conversion__conversion-list"}`,"aria-label":q,bind:this,class:"esri-widget--button",key:"esri-coordinate-conversion__expand-button",onclick:this._toggleExpand,onkeydown:this._toggleExpand,role:"button",tabindex:"0",title:q},c.tsx("span",{"aria-hidden":"true",class:this.classes(d)}));p=!g&&m.captureButton&&c.tsx("li",{"aria-label":p,bind:this,
class:this.classes("esri-widget--button","esri-coordinate-conversion__mode-toggle"),key:"esri-coordinate-conversion__mode-toggle",onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabindex:"0",title:p},c.tsx("span",{"aria-hidden":"true",class:"esri-icon-map-pin"}));return c.tsx("ul",{class:"esri-coordinate-conversion__tools"},a,b,p)};e._renderInputForm=function(){const a=this._conversionFormat||this.conversions.getItemAt(0).format;var b=this.formats.findIndex(q=>q.name===a.name),d=
this.id;const f=`${d}__${"esri-coordinate-conversion__input-coordinate"}`;d=`${d}__${"esri-coordinate-conversion__input-coordinate"}__header`;b=this._renderOptions(this.formats,!0,b);const h={["esri-coordinate-conversion__input-coordinate--rejected"]:this._badInput},{messages:g,messagesCommon:m,headingLevel:p}=this;return c.tsx("div",{"aria-labelledby":d,class:"esri-coordinate-conversion__input-form",key:"esri-coordinate-conversion__input-form",role:"search"},c.tsx("div",{class:"esri-coordinate-conversion__heading"},
c.tsx("div",{"aria-label":m.back,bind:this,class:this.classes("esri-widget--button","esri-coordinate-conversion__back-button"),onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabindex:"0",title:m.back},this._renderBackIcon()),c.tsx(z.Heading,{level:p,class:"esri-widget__heading",id:d},g.inputCoordTitle)),c.tsx("div",{class:"esri-coordinate-conversion__input-group"},c.tsx("select",{"aria-controls":f,"aria-label":g.selectFormat,bind:this,class:this.classes("esri-select",
"esri-coordinate-conversion__select-row"),onchange:this._setInputFormat,title:g.selectFormat},b),c.tsx("input",{afterCreate:B.storeNode,"aria-labelledby":d,"aria-required":"true",bind:this,class:this.classes("esri-coordinate-conversion__input-coordinate","esri-input",h),"data-format":a,"data-node-ref":"_coordinateInput",id:f,onkeydown:this._processUserInput,placeholder:g.inputCoordTitle,role:"textbox",spellcheck:!1,title:g.inputCoordTitle,type:"text"})),c.tsx("div",{class:"esri-coordinate-conversion__input-group"},
c.tsx("label",{"aria-label":g.goTo},c.tsx("input",{bind:this,checked:this._goToEnabled,onclick:this._toggleGoTo,title:g.goTo,type:"checkbox"}),g.goTo),c.tsx("button",{"aria-label":g.convert,bind:this,class:this.classes("esri-coordinate-conversion__button","esri-button"),onclick:this._processUserInput,title:g.convert,type:"button"},c.tsx("span",{class:"esri-coordinate-conversion__convert-button-span"},g.convert))))};e._renderConversionsView=function(){const a=`${this.id}__${"esri-coordinate-conversion__conversion-list"}`;
var b=this._renderPrimaryTools();const d=this._renderOptions(this.formats),f=this.conversions.map((g,m)=>this._renderConversion(g,m)).toArray(),{messages:h}=this;b=this._expanded?c.tsx("div",{class:"esri-coordinate-conversion__row"},c.tsx("select",{"aria-controls":a,"aria-label":h.addConversion,bind:this,class:this.classes("esri-select","esri-coordinate-conversion__select-primary"),onchange:this._addConversion,title:h.addConversion},c.tsx("option",{disabled:!0,selected:!0,value:""},h.addConversion),
d),b):null;return c.tsx("div",{class:this.classes("esri-coordinate-conversion__conversions-view",{["esri-coordinate-conversion__conversions-view--expanded"]:this._expanded,["esri-coordinate-conversion__conversions-view--expand-up"]:"expand-up"===this.orientation,["esri-coordinate-conversion__conversions-view--expand-down"]:"expand-down"===this.orientation}),key:"esri-coordinate-conversion__main-view"},c.tsx("ul",{"aria-expanded":this._expanded?"true":"false",class:"esri-coordinate-conversion__conversion-list",
id:a},f),b)};e._renderOptions=function(a,b,d){const f=this.conversions.getItemAt(0);return a.map((h,g)=>{const m=b||!f?!1:f.format.name===h.name||this.conversions.map(p=>p.format.name).includes(h.name);return c.tsx("option",{"aria-label":h.label,"data-format":h,disabled:m,key:h.name,selected:g===d,value:h.label},h.label.toUpperCase())}).toArray()};e._renderPopup=function(){return c.tsx("div",{class:"esri-coordinate-conversion__popup",role:"alert"},this._popupMessage)};e._renderClipboardPopup=function(){return c.tsx("div",
{class:this.classes("esri-coordinate-conversion__popup","esri-coordinate-conversion__clipboard-popup"),role:"alert"},this.messages.copySuccessMessage)};e._renderPrimaryTools=function(){const {messages:a,visibleElements:b}=this;var d="live"===this.mode?a.captureMode:a.liveMode;const f=b.inputButton&&c.tsx("li",{bind:this,class:"esri-widget--button",onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabindex:"0",title:a.inputCoordTitle},c.tsx("span",{"aria-hidden":"true",
class:"esri-icon-edit"}));d=b.captureButton&&c.tsx("li",{bind:this,class:this.classes("esri-widget--button","esri-coordinate-conversion__mode-toggle"),onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabindex:"0",title:d},c.tsx("span",{"aria-hidden":"true",class:"esri-icon-map-pin"}));const h=b.settingsButton&&c.tsx("li",{bind:this,class:"esri-widget--button",onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabindex:"0",title:a.settingsTitle},
c.tsx("span",{"aria-hidden":"true",class:"esri-icon-settings2"}));return c.tsx("ul",{class:"esri-coordinate-conversion__tools"},f,d,h)};e._renderSettings=function(){var a=this.id;const b=`${a}__${"esri-coordinate-conversion__pattern-input"}`,d=`${a}__${"esri-coordinate-conversion__pattern-input"}__header`;a=`${a}__${"esri-coordinate-conversion__preview-coordinate"}`;var f=this.formats.filter(u=>u.hasDisplayProperties),h=this._findSettingsFormat();const g=f.indexOf(h);f=this._renderOptions(f,!0,g);
h=h.get("currentPattern");const {messages:m,messagesCommon:p,headingLevel:q}=this;return c.tsx("div",{"aria-labelledby":d,class:"esri-coordinate__settings",key:"esri-coordinate-conversion__settings"},c.tsx("div",{class:"esri-coordinate-conversion__heading"},c.tsx("div",{bind:this,class:this.classes("esri-widget--button","esri-coordinate-conversion__back-button"),onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabindex:"0",title:p.back},this._renderBackIcon()),
c.tsx(z.Heading,{level:q,class:"esri-widget__heading",id:d},m.settingsTitle)),c.tsx("div",{class:"esri-coordinate-conversion__settings-group"},c.tsx("label",{for:b},m.changeCoordinateDisplay),c.tsx("select",{"aria-label":m.selectFormat,class:"esri-select",bind:this,onchange:this._setSettingsFormat,title:m.selectFormat},f),c.tsx("div",{class:"esri-coordinate-conversion__settings-group-horizontal"},c.tsx("input",{"aria-controls":a,bind:this,class:this.classes("esri-coordinate-conversion__pattern-input",
"esri-input"),id:b,oninput:this._updateCurrentPattern,spellcheck:!1,title:m.changeCoordinateDisplay,type:"text",value:h}),c.tsx("div",{"aria-controls":b,bind:this,class:"esri-widget--button",onclick:this._setDefaultPattern,onkeydown:this._setDefaultPattern,role:"button",tabindex:"0",title:m.defaultPattern},c.tsx("span",{"aria-hidden":"true",class:"esri-icon-refresh"})))),c.tsx("div",{class:"esri-coordinate-conversion__settings-group"},c.tsx("label",null,p.preview,c.tsx("div",{class:"esri-coordinate-conversion__preview-coordinate",
id:a,tabindex:"0"},this._previewConversion.displayCoordinate))))};e._renderBackIcon=function(){return c.tsx("span",{"aria-hidden":"true",class:B.isRTL(this.container)?"esri-icon-right-arrow":"esri-icon-left-arrow"})};e._renderTools=function(a,b,d){b=b.displayCoordinate&&"capture"===this.mode?this._renderCopyButton(b):null;const {messages:f}=this;return c.tsx("ul",{class:"esri-coordinate-conversion__tools",role:"listitem"},b,c.tsx("li",{"aria-controls":d,"aria-label":f.removeConversion,bind:this,class:this.classes("esri-widget--button",
"esri-coordinate-conversion__row-button"),"data-index":a,key:`${d}__${"esri-widget--button"}`,onclick:this._removeConversion,onkeydown:this._removeConversion,tabindex:"0",role:"button",title:f.removeConversion},c.tsx("span",{"aria-hidden":"true",class:"esri-icon-close"})))};e._copyCoordinateOutput=function(a){a=a.target;if(!("createTextRange"in document.body)){const b=window.getSelection(),d=document.createRange();d.selectNodeContents(a);b.removeAllRanges();b.addRange(d)}document.execCommand("copy")};
e._removeConversion=function(a){this.conversions.removeAt(a.currentTarget["data-index"])};e._setDefaultPattern=function(a){a.stopPropagation();if(a=this._findSettingsFormat())a.currentPattern=a.get("defaultPattern")};e._toggleExpand=function(){this._expanded=!this._expanded};e._toggleInputVisibility=function(){this._inputVisible=!this._inputVisible;this._popupVisible&&this._hidePopup();this._inputVisible?this.viewModel.pause():this.viewModel.resume()};e._toggleMode=function(){this.mode="live"===this.mode?
"capture":"live"};e._toggleSettingsVisibility=function(){this._settingsVisible=!this._settingsVisible;this._popupVisible&&this._hidePopup();this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()};v._createClass(t,[{key:"conversions",get:function(){return this.viewModel.conversions},set:function(a){this.viewModel.conversions=a}},{key:"currentLocation",get:function(){return this.viewModel.currentLocation},set:function(a){this.viewModel.currentLocation=a}},
{key:"formats",get:function(){return this.viewModel.formats},set:function(a){this.viewModel.formats=a}},{key:"goToOverride",get:function(){return this.viewModel.goToOverride},set:function(a){this.viewModel.goToOverride=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"mode",get:function(){return this.viewModel.mode},set:function(a){this.viewModel.mode=a}},{key:"multipleConversions",get:function(){const a=this._get("multipleConversions");
return"boolean"===typeof a?a:!0},set:function(a){!1===a&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1));this._set("multipleConversions",a)}},{key:"locationSymbol",get:function(){return this.viewModel.locationSymbol},set:function(a){this.viewModel.locationSymbol=a}},{key:"storageEnabled",get:function(){return this.viewModel.storageEnabled},set:function(a){this.viewModel.storageEnabled=a}},{key:"storageType",get:function(){return this.viewModel.storageType},set:function(a){this.viewModel.storageType=
a}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}}]);return t}(H);l.__decorate([n.property()],k.prototype,"conversions",null);l.__decorate([n.property()],k.prototype,"currentLocation",null);l.__decorate([n.property()],k.prototype,"formats",null);l.__decorate([n.property()],k.prototype,"goToOverride",null);l.__decorate([n.property()],k.prototype,"headingLevel",void 0);l.__decorate([n.property()],k.prototype,"label",null);l.__decorate([n.property(),A.messageBundle("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],
k.prototype,"messages",void 0);l.__decorate([n.property(),A.messageBundle("esri/t9n/common")],k.prototype,"messagesCommon",void 0);l.__decorate([n.property()],k.prototype,"mode",null);l.__decorate([n.property()],k.prototype,"orientation",void 0);l.__decorate([n.property()],k.prototype,"multipleConversions",null);l.__decorate([n.property()],k.prototype,"locationSymbol",null);l.__decorate([n.property()],k.prototype,"storageEnabled",null);l.__decorate([n.property()],k.prototype,"storageType",null);l.__decorate([n.property()],
k.prototype,"view",null);l.__decorate([n.property({type:x})],k.prototype,"viewModel",void 0);l.__decorate([n.property()],k.prototype,"visibleElements",void 0);l.__decorate([F.cast("visibleElements")],k.prototype,"castVisibleElements",null);l.__decorate([r.accessibleHandler()],k.prototype,"_copyCoordinateOutput",null);l.__decorate([r.accessibleHandler()],k.prototype,"_removeConversion",null);l.__decorate([r.accessibleHandler()],k.prototype,"_setDefaultPattern",null);l.__decorate([r.accessibleHandler()],
k.prototype,"_toggleExpand",null);l.__decorate([r.accessibleHandler()],k.prototype,"_toggleInputVisibility",null);l.__decorate([r.accessibleHandler()],k.prototype,"_toggleMode",null);l.__decorate([r.accessibleHandler()],k.prototype,"_toggleSettingsVisibility",null);return k=l.__decorate([G.subclass("esri.widgets.CoordinateConversion")],k)});