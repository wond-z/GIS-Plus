// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(w,n,c,b,A,x,e,K,B,C,D,y,E,F,L,G,H,t){function I(p){const {label:l}=p;return"items"in p?l:`${l}\u2013${p.layer.id}`}const z={filter:!0};b=function(p){function l(a,d){a=p.call(this,a,d)||this;a._iconIntersectionObserver=new IntersectionObserver((g,m)=>{g.forEach(function(){var q=n._asyncToGenerator(function*(h){if(h.isIntersecting){const k=h.target;if(k["data-has-icon"])m.unobserve(k);else{var {layer:v,template:u}=k["data-item"];k["data-has-icon"]=!0;h=yield F.fetchThumbnail(v,u).catch(()=>
{k["data-has-icon"]=!1;return null});A.isNone(h)||k.appendChild(h)}}});return function(h){return q.apply(this,arguments)}}())});a.enableListScroll=!0;a.filterText="";a.headingLevel=4;a.messages=null;a.viewModel=new y;a.visibleElements={...z};a.renderItemIcon=a.renderItemIcon.bind(n._assertThisInitialized(a));a._afterItemCreateOrUpdate=a._afterItemCreateOrUpdate.bind(n._assertThisInitialized(a));a._afterItemRemoved=a._afterItemRemoved.bind(n._assertThisInitialized(a));return a}n._inheritsLoose(l,p);
var f=l.prototype;f.initialize=function(){const a=({label:d})=>!this.filterText||d.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(x.watch(()=>this.viewModel,(d,g)=>{d&&!d.filterFunction&&(this.filterFunction=a);g&&g!==d&&g.filterFunction===a&&(g.filterFunction=null)},x.initial))};f.destroy=function(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)};f.loadDependencies=function(){return Promise.all([new Promise((a,
d)=>w(["../chunks/calcite-input"],a,d)),new Promise((a,d)=>w(["../chunks/calcite-list-item"],a,d))])};f.castVisibleElements=function(a){return{...z,...a}};f.select=function(a){return this.viewModel.select(a)};f.render=function(){const {enableListScroll:a,filterText:d,headingLevel:g,messages:m,viewModel:{items:q,numberOfFeatureTemplates:h,selectedItem:v,state:u}}=this,k=this.visibleElements.filter&&1<h;if(0<q.length&&"items"in q[0]){const r=q.find(J=>J.label===y.nullGroupBy.label);r&&(r.label=m.other)}return t.tsx("div",
{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":m.widgetLabel},"loading"===u?this.renderLoader():"ready"===u?t.tsx(E.ItemList,{id:this.id,identify:I,filterText:d,items:q,headingLevel:g,messages:{filterPlaceholder:m.filterPlaceholder,noItems:m.noItems,noMatches:m.noMatches},filterEnabled:k,onItemSelect:r=>{this.viewModel.select(r)},onFilterChange:r=>{this.filterText=r;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:v,enableListScroll:a}):null)};f.renderItemIcon=
function({item:a}){return t.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":a,"data-has-icon":!1})};f.renderLoader=function(){return t.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};f._afterItemCreateOrUpdate=function(a){this._iconIntersectionObserver?.observe(a)};f._afterItemRemoved=function(a){this._iconIntersectionObserver?.unobserve(a)};n._createClass(l,[{key:"filterFunction",
get:function(){return this.viewModel.filterFunction},set:function(a){this.viewModel.filterFunction=a}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(a){this.viewModel.groupBy=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(a){this.viewModel.layers=a}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return l}(b.HandleOwnerMixin(D));
c.__decorate([e.property()],b.prototype,"enableListScroll",void 0);c.__decorate([e.property()],b.prototype,"filterFunction",null);c.__decorate([e.property()],b.prototype,"filterText",void 0);c.__decorate([e.property()],b.prototype,"groupBy",null);c.__decorate([e.property()],b.prototype,"headingLevel",void 0);c.__decorate([e.property()],b.prototype,"label",null);c.__decorate([e.property()],b.prototype,"layers",null);c.__decorate([e.property(),G.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],
b.prototype,"messages",void 0);c.__decorate([e.property({readOnly:!0})],b.prototype,"selectedItem",null);c.__decorate([e.property(),H.vmEvent("select")],b.prototype,"viewModel",void 0);c.__decorate([e.property()],b.prototype,"visibleElements",void 0);c.__decorate([B.cast("visibleElements")],b.prototype,"castVisibleElements",null);return b=c.__decorate([C.subclass("esri.widgets.FeatureTemplates")],b)});