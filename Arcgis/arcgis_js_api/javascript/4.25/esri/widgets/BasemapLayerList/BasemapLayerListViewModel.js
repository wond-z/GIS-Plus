// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/HandleOwner ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../LayerList/ListItem".split(" "),function(m,k,f,x,y,g,l,C,D,z,u){const n=f.ofType(u);f=function(v){function p(a){a=v.call(this,a)||this;a.baseItems=new n;a.baseListItemCreatedFunction=null;
a.checkPublishStatusEnabled=!1;a.referenceListItemCreatedFunction=null;a.referenceItems=new n;a.view=null;a._compileBaseList=a._compileBaseList.bind(m._assertThisInitialized(a));a._compileReferenceList=a._compileReferenceList.bind(m._assertThisInitialized(a));return a}m._inheritsLoose(p,v);var e=p.prototype;e.initialize=function(){this.handles.add([g.watch(()=>[this.view?.map?.basemap,this.view,this.view?.ready,this.view?.basemapView],()=>this._watchBasemapLayers(),g.initial),g.watch(()=>[this.baseListItemCreatedFunction,
this.checkPublishStatusEnabled],()=>this._baseListItemCreatedFunctionChanged()),g.watch(()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._referenceListItemCreatedFunctionChanged())],"view")};e.destroy=function(){this.view=null;this.baseItems.removeAll();this.referenceItems.removeAll()};e.triggerAction=function(a,b){a&&!a.disabled&&this.emit("trigger-action",{action:a,item:b})};e.transferListItem=function({listItem:a,from:b,to:c,newIndex:d}){const {referenceItems:h,
baseItems:q}=this,{layer:w}=a,r=this.get("view.map.basemap.baseLayers"),t=this.get("view.map.basemap.referenceLayers");if(r&&t&&b!==c){var A="reference"===c?h:q,B="reference"===b?t:r;c="reference"===c?t:r;("reference"===b?h:q).remove(a);B.remove(w);A.add(a,d);c.add(w,d)}};e._createItemChangeHandles=function({items:a,key:b,callback:c}){const {handles:d}=this;d.remove(b);c();a&&d.add(a.on("change",()=>c()),b)};e._createListItem=function({layer:a,type:b}){const {view:c,baseListItemCreatedFunction:d,
referenceListItemCreatedFunction:h,checkPublishStatusEnabled:q}=this;return new u({layer:a,checkPublishStatusEnabled:q,listItemCreatedFunction:"base"===b?d:h,view:c})};e._watchLayersListMode=function({layers:a,key:b,callback:c}){const {handles:d}=this;d.remove(b);a&&a.forEach(h=>{d.add(g.watch(()=>h.listMode,()=>c()),b)})};e._compileListItems=function({layers:a,items:b,key:c,type:d,callback:h}){this._watchLayersListMode({layers:a,key:c,callback:h});this._createNewItems({type:d,items:b,layers:a});
this._removeItems({items:b,layers:a});this._sortItems(b,a)};e._compileReferenceList=function(){const {referenceItems:a}=this,b=this.get("view.map.basemap.referenceLayers");this._compileListItems({type:"reference",layers:b,items:a,key:"base-layers-list-mode",callback:this._compileReferenceList})};e._compileBaseList=function(){const {baseItems:a}=this,b=this.get("view.map.basemap.baseLayers");this._compileListItems({type:"base",layers:b,items:a,key:"reference-layers-list-mode",callback:this._compileBaseList})};
e._compileLists=function(){this._compileReferenceList();this._compileBaseList()};e._createNewItems=function({items:a,layers:b,type:c}){b&&b.forEach(d=>{a.find(h=>h.layer===d)||a.add(this._createListItem({type:c,layer:d}))})};e._removeItems=function({items:a,layers:b}){const {handles:c}=this;a&&a.forEach(d=>{!d||b&&b.find(h=>d.layer===h)||(c.remove(`${"children"}-${d.uid}`),a.remove(d))})};e._sortItems=function(a,b){a&&a.sort((c,d)=>{c=b.indexOf(c.layer);d=b.indexOf(d.layer);return c>d?-1:c<d?1:0})};
e._removeAllBaseItems=function(){const {handles:a,baseItems:b}=this;b.forEach(c=>{a.remove(`${"children"}-${c.uid}`)});b.removeAll()};e._removeAllReferenceItems=function(){const {handles:a,referenceItems:b}=this;b.forEach(c=>{a.remove(`${"children"}-${c.uid}`)});b.removeAll()};e._baseListItemCreatedFunctionChanged=function(){this._removeAllBaseItems();this._compileLists()};e._referenceListItemCreatedFunctionChanged=function(){this._removeAllReferenceItems();this._compileLists()};e._watchBasemapLayers=
function(){const {handles:a,view:b}=this;a.remove(["base-layers","reference-layers","basemap","base-layer-views","reference-layer-views"]);this._compileLists();b&&b.ready&&a.add([g.watch(()=>this.view?.map?.basemap?.baseLayers,c=>this._createItemChangeHandles({items:c,key:"base-layers",callback:this._compileBaseList}),g.initial),g.watch(()=>this.view?.map?.basemap?.referenceLayers,c=>this._createItemChangeHandles({items:c,key:"reference-layers",callback:this._compileReferenceList}),g.initial),g.watch(()=>
this.view?.basemapView?.baseLayerViews,c=>this._createItemChangeHandles({items:c,key:"base-layer-views",callback:this._compileBaseList}),g.initial),g.watch(()=>this.view?.basemapView?.referenceLayerViews,c=>this._createItemChangeHandles({items:c,key:"reference-layer-views",callback:this._compileReferenceList}),g.initial)],"basemap")};m._createClass(p,[{key:"basemapTitle",get:function(){return this.view?.map?.basemap?.title??null},set:function(a){this._override("basemapTitle",a)}},{key:"state",get:function(){return this.get("view.ready")?
"ready":this.get("view")?"loading":"disabled"}}]);return p}(y.HandleOwnerMixin(x.EventedAccessor));k.__decorate([l.property({type:n,readOnly:!0})],f.prototype,"baseItems",void 0);k.__decorate([l.property()],f.prototype,"basemapTitle",null);k.__decorate([l.property()],f.prototype,"baseListItemCreatedFunction",void 0);k.__decorate([l.property()],f.prototype,"checkPublishStatusEnabled",void 0);k.__decorate([l.property()],f.prototype,"referenceListItemCreatedFunction",void 0);k.__decorate([l.property({type:n,
readOnly:!0})],f.prototype,"referenceItems",void 0);k.__decorate([l.property({readOnly:!0})],f.prototype,"state",null);k.__decorate([l.property()],f.prototype,"view",void 0);k.__decorate([l.property()],f.prototype,"transferListItem",null);return f=k.__decorate([z.subclass("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],f)});