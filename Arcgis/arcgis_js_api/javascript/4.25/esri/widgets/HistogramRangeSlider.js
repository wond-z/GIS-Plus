// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ./Histogram ./Slider ./Widget ./HistogramRangeSlider/HistogramRangeSliderViewModel ./smartMapping/support/utils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(u,e,p,q,f,d,v,x,y,z,A,B,C,E,D,t){d=function(w){function r(a,
h){a=w.call(this,a,h)||this;a._barElements=[];a._histogram=null;a._slider=null;a.barCreatedFunction=null;a.dataLines=null;a.dataLineCreatedFunction=null;a.excludedBarColor=new p("#d7e5f0");a.includedBarColor=new p("#599dd4");a.messages=null;a.standardDeviationCount=1;a.viewModel=new B;return a}u._inheritsLoose(r,w);var k=r.prototype;k.initialize=function(){const {average:a,bins:h,hasTimeData:n,max:b,min:l,viewModel:g}=this;this._updateBarFill=this._updateBarFill.bind(this);this._histogram=new y({average:a,
bins:h,barCreatedFunction:(c,m)=>{0===c&&(this._barElements=[]);this._barElements.push(m);this._updateBarFill(c,m);this.barCreatedFunction&&this.barCreatedFunction(c,m)},dataLines:this._getDataLines(),dataLineCreatedFunction:(c,m)=>{this.dataLineCreatedFunction&&this.dataLineCreatedFunction(c,m)},labelFormatFunction:this.labelFormatFunction,layout:"horizontal",max:b,min:l});this._slider=new z({labelFormatFunction:this.labelFormatFunction,layout:"horizontal",visibleElements:{labels:!0,rangeLabels:!0},
rangeLabelInputsEnabled:!n,viewModel:g});this.addHandles([this._slider.on(["max-change","min-change"],c=>this.emit(c.type,c)),this._slider.on(["segment-drag","thumb-change","thumb-drag"],c=>{this._updateBarFills();this.emit(c.type,c)}),q.watch(()=>this.bins,c=>{if(c&&this._histogram.bins){const m=this._histogram.bins.length-c.length;this._barElements.splice(-m,m)}else this._barElements=[];this._histogram.set({bins:c});this._updateBarFills();this.scheduleRender()}),q.watch(()=>[this.max,this.min,this.rangeType,
this.values],([c,m])=>{this._histogram.set({max:c,min:m});this._updateBarFills();this.scheduleRender()}),q.watch(()=>[this.average,this.dataLines,this.standardDeviation,this.standardDeviationCount],([c])=>{this._histogram.set({average:c,dataLines:this._getDataLines()})}),q.watch(()=>this.labelFormatFunction,c=>{this._histogram.set({labelFormatFunction:c})}),q.watch(()=>this.hasTimeData,c=>{this._slider.set({rangeLabelInputsEnabled:!c})})])};k.generateWhereClause=function(a){return this.viewModel.generateWhereClause(a)};
k.render=function(){const {rangeType:a,viewModel:h,label:n}=this,b=this.classes("esri-histogram-range-slider","esri-widget",`${"esri-histogram-range-slider__range-type--"}${a}`,"disabled"===h.state?"esri-disabled":null);return t.tsx("div",{"aria-label":n,class:b},"disabled"===h.state?null:this.renderContent())};k.renderContent=function(){return[this.renderHistogram(),this.renderSlider()]};k.renderSlider=function(){return t.tsx("div",{key:`${this.id}-slider-container`,class:"esri-histogram-range-slider__slider-container"},
this._slider.render())};k.renderHistogram=function(){return t.tsx("div",{class:"esri-histogram-range-slider__histogram-container"},this._histogram.render())};k._getDataLines=function(){return[...this._getStandardDeviationDataLines(),...(this.dataLines||[])]};k._getStandardDeviationDataLines=function(){const {average:a,standardDeviation:h,standardDeviationCount:n}=this;return C.getDeviationValues(h,a,n).map(b=>({value:b}))};k._updateBarFills=function(){this._barElements.forEach((a,h)=>this._updateBarFill(h,
a))};k._updateBarFill=function(a,h){h.setAttribute("fill",this._getFillForBar(a).toHex())};k._getFillForBar=function(a){const {bins:h,rangeType:n,values:b}=this;if(!(h&&h.length&&n&&b.length))return null;a=h[a];if(!a)return null;const {maxValue:l,minValue:g}=a;a=l-g;const c=b[0]>g&&b[0]<l;switch(n){case "equal":case "not-equal":return this.includedBarColor;case "less-than":case "at-most":return c?this._getBlendedColor((b[0]-g)/a):l<=b[0]?this.includedBarColor:this.excludedBarColor;case "greater-than":case "at-least":return c?
this._getBlendedColor(1-(b[0]-g)/a):g>=b[0]?this.includedBarColor:this.excludedBarColor;case "between":if(2===b.length)return b[0]>g&&b[0]<l?this._getBlendedColor(1-(b[0]-g)/a):b[1]>g&&b[1]<l?this._getBlendedColor((b[1]-g)/a):g>=b[0]&&l<=b[1]?this.includedBarColor:this.excludedBarColor;case "not-between":if(2===b.length)return b[0]>g&&b[0]<l?this._getBlendedColor((b[0]-g)/a):b[1]>g&&b[1]<l?this._getBlendedColor(1-(b[1]-g)/a):g>b[0]&&l<b[1]?this.excludedBarColor:this.includedBarColor;default:return this.includedBarColor}};
k._getBlendedColor=function(a){return p.blendColors(this.excludedBarColor,this.includedBarColor,a)};u._createClass(r,[{key:"average",get:function(){return this.viewModel.average},set:function(a){this.viewModel.average=a}},{key:"bins",get:function(){return this.viewModel.bins},set:function(a){this.viewModel.bins=a}},{key:"hasTimeData",get:function(){return this.viewModel.hasTimeData},set:function(a){this.viewModel.hasTimeData=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",
a)}},{key:"labelFormatFunction",get:function(){return this.viewModel.labelFormatFunction},set:function(a){this.viewModel.labelFormatFunction=a}},{key:"max",get:function(){return this.viewModel.max},set:function(a){this.viewModel.max=a}},{key:"min",get:function(){return this.viewModel.min},set:function(a){this.viewModel.min=a}},{key:"precision",get:function(){return this.viewModel.precision},set:function(a){this.viewModel.precision=a}},{key:"rangeType",get:function(){return this.viewModel.rangeType},
set:function(a){this.viewModel.rangeType=a}},{key:"standardDeviation",get:function(){return this.viewModel.standardDeviation},set:function(a){this.viewModel.standardDeviation=a}},{key:"values",get:function(){return this.viewModel.values},set:function(a){this.viewModel.values=a}}]);return r}(A);e.__decorate([f.property()],d.prototype,"average",null);e.__decorate([f.property()],d.prototype,"barCreatedFunction",void 0);e.__decorate([f.property()],d.prototype,"bins",null);e.__decorate([f.property()],
d.prototype,"dataLines",void 0);e.__decorate([f.property()],d.prototype,"dataLineCreatedFunction",void 0);e.__decorate([f.property({type:p,json:{type:[v.Integer],write:!0}})],d.prototype,"excludedBarColor",void 0);e.__decorate([f.property()],d.prototype,"hasTimeData",null);e.__decorate([f.property({type:p,json:{type:[v.Integer],write:!0}})],d.prototype,"includedBarColor",void 0);e.__decorate([f.property()],d.prototype,"label",null);e.__decorate([f.property()],d.prototype,"labelFormatFunction",null);
e.__decorate([f.property()],d.prototype,"max",null);e.__decorate([f.property(),D.messageBundle("esri/widgets/HistogramRangeSlider/t9n/HistogramRangeSlider")],d.prototype,"messages",void 0);e.__decorate([f.property()],d.prototype,"min",null);e.__decorate([f.property()],d.prototype,"precision",null);e.__decorate([f.property()],d.prototype,"rangeType",null);e.__decorate([f.property()],d.prototype,"standardDeviation",null);e.__decorate([f.property()],d.prototype,"standardDeviationCount",void 0);e.__decorate([f.property()],
d.prototype,"values",null);e.__decorate([f.property()],d.prototype,"viewModel",void 0);return d=e.__decorate([x.subclass("esri.widgets.HistogramRangeSlider")],d)});