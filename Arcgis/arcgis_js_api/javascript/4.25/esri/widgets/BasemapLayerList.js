// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Collection ../core/events ../core/HandleOwner ../core/has ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ./Widget ./BasemapLayerList/BasemapLayerListViewModel ./LayerList/ListItem ./LayerList/support/layerListUtils ./support/Heading ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ../chunks/sortable.esm".split(" "),
function(D,E,m,k,K,L,M,N,t,r,U,O,P,Q,F,R,B,y,v,G,S,g,V,H){function C(z){const {actionsOpen:w,children:e}=z;w&&(z.actionsOpen=!1);e.forEach(a=>C(a))}const T=k.ofType(R),A={exclusive:"exclusive",inherited:"inherited",independent:"independent"},I={baseLayers:!0,referenceLayers:!0,statusIndicators:!0,errors:!1};k=function(z){function w(a,b){a=z.call(this,a,b)||this;a._tooltipReferenceMap=new Map;a._editingTitle=!1;a._editTitleInput=null;a._editTitleButton=null;a._focusOnElement=null;a._sortableBaseLayers=
null;a._sortableReferenceLayers=null;a._sortableBaseLayersNode=null;a._sortableReferenceLayersNode=null;a._focusSortUid=null;a._newUI=M("esri-basemaplayerlist-new-ui");a.visibleItems=null;a.editingEnabled=!1;a.headingLevel=2;a.iconClass="esri-icon-layers";a.messages=null;a.messagesCommon=null;a.multipleSelectionEnabled=!1;a.selectedItems=new T;a.viewModel=new F;a.visibleElements={...I};return a}E._inheritsLoose(w,z);var e=w.prototype;e.initialize=function(){const {baseItems:a,referenceItems:b}=this;
this._setVisibleItems();this.addHandles([t.watch(()=>this.visibleElements,()=>{this._itemsChanged(a,"base-items");this._itemsChanged(b,"reference-items")}),t.on(()=>this.baseItems,"change",()=>{this._itemsChanged(a,"base-items")}),t.on(()=>this.referenceItems,"change",()=>this._itemsChanged(b,"reference-items")),t.watch(()=>this.editingEnabled,()=>this._toggleSorting(),t.initial)])};e.loadDependencies=function(){return Promise.all([new Promise((a,b)=>D(["../chunks/calcite-icon"],a,b)),new Promise((a,
b)=>D(["../chunks/calcite-tooltip"],a,b))])};e.destroy=function(){this._destroyBaseSortable();this._destroyReferenceSortable();this._tooltipReferenceMap.clear()};e.castVisibleElements=function(a){return{...I,...a}};e.triggerAction=function(a,b){return this.viewModel.triggerAction(a,b)};e.render=function(){var {state:a}=this.viewModel;a={["esri-basemap-layer-list--new-ui"]:this._newUI,["esri-hidden"]:"loading"===a,["esri-disabled"]:"disabled"===a};const b=this.renderItemTooltips();var c=this.renderReferenceSection();
const d=this.renderBaseSection(),f=c&&d?g.tsx("hr",{class:"esri-basemap-layer-list__hr"}):null;c=[this.renderTitleContainer(),c,f,d];return g.tsx("div",{class:this.classes("esri-basemap-layer-list esri-widget esri-widget--panel",a)},[b,c])};e.renderItemTooltip=function(a){const {_tooltipReferenceMap:b,messages:c}=this;return a?g.tsx("calcite-tooltip",{label:c.layerIncompatible,referenceElement:b.get(a.uid)},c.layerIncompatibleTooltip):null};e.renderItemTooltipNodes=function(a){const {incompatible:b,
children:c}=a;return[b?this.renderItemTooltip(a):null,...(b?[]:c?.toArray().map(d=>this.renderItemTooltipNodes(d)))]};e.renderItemTooltips=function(){return this.visibleItems.toArray().map(a=>this.renderItemTooltipNodes(a))};e.renderEditingInput=function(){const {messages:a}=this,{basemapTitle:b}=this.viewModel;return g.tsx("label",{class:"esri-basemap-layer-list__editing-input"},a.basemapTitle,g.tsx("input",{bind:this,class:"esri-input",title:a.basemapTitle,"aria-label":a.basemapTitle,placeholder:a.basemapTitle,
type:"text",role:"textbox",required:!0,pattern:".*\\S+.*",value:b,afterCreate:this._storeEditTitleInput,afterUpdate:this._focusEditElement}))};e.renderCancelButton=function(){const {messagesCommon:a}=this;return g.tsx("button",{title:a.cancel,"aria-label":a.cancel,type:"button",bind:this,class:this.classes("esri-button","esri-button--tertiary"),onclick:this._toggleEditingTitle},a.cancel)};e.renderSubmitButton=function(){const {messagesCommon:a}=this;return g.tsx("button",{title:a.form.submit,"aria-label":a.form.submit,
type:"submit",bind:this,class:"esri-button"},a.form.ok)};e.renderEditingForm=function(){return g.tsx("div",{class:"esri-basemap-layer-list__editing-card"},g.tsx("form",{bind:this,onsubmit:this._formSubmit},this.renderEditingInput(),g.tsx("div",{class:"esri-basemap-layer-list__editing-actions"},this.renderCancelButton(),this.renderSubmitButton())))};e.renderBasemapTitle=function(){const {basemapTitle:a}=this.viewModel;return g.tsx(y.Heading,{level:this.headingLevel,class:this.classes("esri-widget__heading",
"esri-basemap-layer-list__main-heading")},a)};e.renderEditTitleButton=function(){const {_editingTitle:a,editingEnabled:b,messagesCommon:c}=this;return b&&!a?g.tsx("button",{bind:this,class:"esri-basemap-layer-list__edit-button",title:c.edit,"aria-label":c.edit,onclick:this._toggleEditingTitle,afterCreate:this._storeEditTitleButton,afterUpdate:this._focusEditElement,"data-node-ref":"_editButtonNode",type:"button"},g.tsx("span",{"aria-hidden":"true",class:this.classes("esri-icon-edit","esri-basemap-layer-list__edit-button-icon")})):
null};e.renderTitleContainer=function(){return g.tsx("div",{class:"esri-basemap-layer-list__title-container"},this._editingTitle?this.renderEditingForm():this.renderBasemapTitle(),this.renderEditTitleButton())};e.renderNoLayersInfo=function(a,b){return g.tsx("div",{key:b,class:"esri-basemap-layer-list__no-items"},a)};e.renderList=function(a,b){const {messages:c}=this;return g.tsx("ul",{key:b,"aria-label":c.widgetLabel,role:this.editingEnabled&&a.length?"listbox":void 0,afterCreate:this._sortNodeCreated,
afterRemoved:"reference"===b?this._destroyReferenceSortable:this._destroyBaseSortable,"data-node-ref":b,bind:this,class:this.classes("esri-basemap-layer-list__list","esri-basemap-layer-list__list--root","esri-basemap-layer-list__list--independent")},a.map(d=>this.renderItem({item:d,parent:null,itemType:b,isOnlyChild:1===a.length})))};e.renderBaseHeader=function(){return g.tsx(y.Heading,{key:"base-heading",level:y.incrementHeadingLevel(this.headingLevel),class:this.classes("esri-widget__heading","esri-basemap-layer-list__list-heading")},
this.messages.baseHeading)};e.renderBaseSection=function(){const {baseItems:a,messages:b,visibleElements:c}=this;if(!c.baseLayers)return null;const d=this._getItems(a);return[this.renderBaseHeader(),[0===d.length?this.renderNoLayersInfo(b.noBaseLayers,"base"):null,this.renderList(d,"base")]]};e.renderReferenceHeader=function(){return g.tsx(y.Heading,{key:"reference-heading",level:y.incrementHeadingLevel(this.headingLevel),class:this.classes("esri-widget__heading","esri-basemap-layer-list__list-heading")},
this.messages.referenceHeading)};e.renderReferenceSection=function(){const {referenceItems:a,messages:b,visibleElements:c}=this;if(!c.referenceLayers)return null;const d=this._getItems(a);return[this.renderReferenceHeader(),[0===d.length?this.renderNoLayersInfo(b.noReferenceLayers,"reference"):null,this.renderList(d,"reference")]]};e.renderChildrenToggle=function(a,b){var {messagesCommon:c}=this;const {children:d}=a,f=!!a.error,h={["esri-basemap-layer-list__child-toggle--open"]:a.open};c=a.open?c.collapse:
c.expand;return d.length&&!f?g.tsx("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":a,key:"toggle-children",class:this.classes("esri-basemap-layer-list__child-toggle",h),tabindex:"0",role:"button","aria-controls":b,"aria-label":c,title:c},g.tsx("span",{"aria-hidden":"true",class:this.classes("esri-basemap-layer-list__child-toggle-icon--closed","esri-icon-right-triangle-arrow")}),g.tsx("span",{"aria-hidden":"true",class:this.classes("esri-basemap-layer-list__child-toggle-icon--opened",
"esri-icon-down-arrow")}),g.tsx("span",{"aria-hidden":"true",class:this.classes("esri-basemap-layer-list__child-toggle-icon--closed-rtl","esri-icon-left-triangle-arrow")})):null};e.renderItemMessage=function(a){return a.error?g.tsx("div",{key:"esri-basemap-layer-list__error",class:"esri-basemap-layer-list__item-message",role:"alert"},g.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),this.messages.layerError):a.incompatible?g.tsx("div",{key:"esri-basemap-layer-list__incompatible",
class:"esri-basemap-layer-list__item-message",role:"alert"},g.tsx("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:"esri-icon-notice-triangle",afterCreate:b=>this._setTooltipReference(b,a)}),this.messages.layerIncompatible):null};e.renderActionsMenuIcon=function(a,b){const {messagesCommon:c}=this;return g.tsx("div",{key:"actions-menu-toggle","data-item":a,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes("esri-basemap-layer-list__item-actions-menu-item",
{["esri-basemap-layer-list__item-actions-menu-item--active"]:a.actionsOpen}),tabindex:"0",role:"button","aria-controls":b,"aria-label":c.options,title:c.options},g.tsx("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"}))};e.renderActionsMenu=function(a,b,c,d){var {panel:f}=a;f=f&&f.visible?this.renderPanelButton(f):null;const h=(b=1===c&&this._getSingleActionButton(b))?this.renderAction({item:a,action:b,singleAction:!0}):null;return(a=!b&&c?this.renderActionsMenuIcon(a,d):null)||f||
b?g.tsx("div",{key:"actions-menu",class:"esri-basemap-layer-list__item-actions-menu"},f,h,a):null};e.renderChildList=function(a,b){const {editingEnabled:c}=this,{visibilityMode:d,children:f}=a,h=this._hasChildren(a),l=!h&&c&&"group"===a.layer?.type,{exclusive:n,inherited:p}=A,q={["esri-basemap-layer-list__list--exclusive"]:d===n,["esri-basemap-layer-list__list--inherited"]:d===p,["esri-basemap-layer-list__list--independent"]:d!==p&&d!==n};return h||l?g.tsx("ul",{bind:this,key:"list-items",id:b,"data-group":a.uid,
"data-item":a,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,class:this.classes("esri-basemap-layer-list__list",q),"aria-expanded":a.open?"true":"false",role:c?"listbox":d===n?"radiogroup":"group",hidden:a.open?null:!0},f?.map(u=>this.renderItem({item:u,parent:a})).toArray()):null};e.renderItemContent=function(a,b,c){var {id:d}=this,f=`${d}_${a.uid}`;d=`${f}_actions`;f=`${f}__list`;const {panel:h}=a,l=this._filterActions(a.actionsSections),n=this._countActions(l);return[g.tsx("div",
{key:"list-item-container",class:"esri-basemap-layer-list__item-container"},this.renderChildrenToggle(a,f),this.renderLabel(a,b,c),this.renderActionsMenu(a,l,n,d)),this.renderItemMessage(a),n?this.renderActionsSections(a,l,d):null,h&&h.open&&!h.disabled?h.render():null,this.renderChildList(a,f)]};e.renderItem=function({item:a,parent:b,itemType:c,isOnlyChild:d}){const {_newUI:f,id:h,editingEnabled:l,selectedItems:n}=this,p=`${`${h}_${a.uid}`}__title`;var q=this._hasMessage(a);q={["esri-basemap-layer-list__item--has-children"]:this._hasChildren(a),
["esri-basemap-layer-list__item--has-message"]:!!q,["esri-basemap-layer-list__item--invisible"]:f&&!a.visible,["esri-basemap-layer-list__item--invisible-at-scale"]:!a.visibleAtCurrentScale,["esri-basemap-layer-list__item--selectable"]:l};if(l){const u={["data-layer-uid"]:a.layer?.uid};return g.tsx("li",{key:`item-with-selection-${a.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-basemap-layer-list__item",q,{["esri-basemap-layer-list__item--only-child"]:d}),
"aria-labelledby":p,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item-type":c,"data-item":a,tabIndex:0,"aria-selected":B.findSelectedItem(a,n)?"true":"false",role:"option",...u},this.renderItemContent(a,b,p))}return g.tsx("li",{key:`item-no-selection-${a.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-basemap-layer-list__item",q),"aria-labelledby":p},this.renderItemContent(a,b,p))};e.renderConnectionIcon=function(a){({connectionStatus:a}=
a);return N.isSome(a)?g.tsx("calcite-icon",{icon:"connected"===a?"check-circle":"offline",scale:"s"}):null};e.renderItemStatus=function(a,b){var {visibleElements:c}=this;if(!c.statusIndicators)return null;const {connectionStatus:d,publishing:f,updating:h}=a;c=!!d;return g.tsx("span",{class:this.classes({["esri-basemap-layer-list__status-indicator"]:!0,["esri-basemap-layer-list__publishing"]:f,["esri-basemap-layer-list__updating"]:h&&!b,["esri-basemap-layer-list__connection-status"]:c,["esri-basemap-layer-list__connection-status--connected"]:c&&
"connected"===d}),key:"layer-item-status"},this.renderConnectionIcon(a))};e.renderItemTitle=function(a,b){const {messages:c}=this,d=a.title||c.untitledLayer;a=a.visibleAtCurrentScale?d:`${d} (${c.layerInvisibleAtScale})`;return g.tsx("span",{key:"layer-title-container",id:b,title:a,"aria-label":a,class:"esri-basemap-layer-list__item-title"},d)};e.renderItemToggleIcon=function(a,b){const {_newUI:c}=this,{exclusive:d}=A;b=b&&b.visibilityMode;return g.tsx("span",{key:"item-toggle-icon",class:this.classes({["esri-basemap-layer-list__item-toggle-icon"]:c,
["esri-basemap-layer-list__item-toggle-icon"]:c&&b!==d,["esri-basemap-layer-list__item-radio-icon"]:c&&b===d,["esri-icon-radio-checked"]:b===d&&a.visible,["esri-icon-radio-unchecked"]:b===d&&!a.visible,["esri-icon-visible"]:b!==d&&a.visible,["esri-icon-non-visible"]:b!==d&&!a.visible}),"aria-hidden":"true"})};e.renderItemToggle=function(a,b,c){const {editingEnabled:d,messages:f}=this,{exclusive:h}=A,l=b&&b.visibilityMode;return d?g.tsx("span",{key:"item-toggle-selection-enabled",class:"esri-basemap-layer-list__item-toggle",
bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":a,"data-parent-visibility":l,tabIndex:0,"aria-checked":a.visible?"true":"false",title:a.visible?f.hideLayer:f.showLayer,role:l===h?"radio":"switch","aria-labelledby":c},this.renderItemToggleIcon(a,b)):g.tsx("span",{key:"item-toggle",class:"esri-basemap-layer-list__item-toggle"},this.renderItemToggleIcon(a,b))};e.renderLabel=function(a,b,c){const {editingEnabled:d,_newUI:f,messages:h}=this,{inherited:l,exclusive:n}=
A,p=b?.visibilityMode;var q=p===n?"radio":"switch";const u=f?[this.renderItemTitle(a,c),this.renderItemStatus(a,b),this.renderItemToggle(a,b,c)]:[this.renderItemToggle(a,b,c),this.renderItemTitle(a,c),this.renderItemStatus(a,b)];q=d?g.tsx("div",{key:`item-label-no-selection-${a.uid}`,class:"esri-basemap-layer-list__item-label"},u):g.tsx("div",{key:`item-label-with-selection-${a.uid}`,class:"esri-basemap-layer-list__item-label",bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,
"data-item":a,"data-parent-visibility":p,tabIndex:0,title:a.visible?h.hideLayer:h.showLayer,"aria-checked":a.visible?"true":"false",role:q,"aria-labelledby":c},u);return p===l||a.error?g.tsx("div",{key:`item-label-container-${a.uid}`,class:"esri-basemap-layer-list__item-label"},this.renderItemTitle(a,c),this.renderItemStatus(a,b)):q};e.renderPanelButton=function(a){const {className:b,open:c,title:d,image:f}=a,h=f||b?b:"esri-icon-default-action",l=this._getIconImageStyles(a),n={["esri-basemap-layer-list__item-actions-menu-item--active"]:c},
p={["esri-basemap-layer-list__item-action-image"]:!!l["background-image"],["esri-disabled-element"]:a.disabled};h&&(p[h]=!!h);return g.tsx("div",{"aria-disabled":a.disabled.toString(),key:`panel-${a.uid}`,bind:this,"data-panel":a,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes("esri-basemap-layer-list__item-actions-menu-item",n),role:"button",tabindex:a.disabled?null:0,title:d,"aria-label":d},g.tsx("span",{class:this.classes(p),styles:l}))};e.renderActionsSections=function(a,
b,c){b=b.toArray().map((d,f)=>g.tsx("ul",{key:`${a}-action-section-${f}`,class:"esri-basemap-layer-list__item-actions-list"},this.renderActionSection(a,d)));return g.tsx("div",{role:"group","aria-expanded":a.actionsOpen?"true":"false",key:"actions-section",id:c,class:"esri-basemap-layer-list__item-actions",hidden:a.actionsOpen?null:!0},b)};e.renderActionSection=function(a,b){return(b&&b.toArray()).map(c=>this.renderAction({item:a,action:c}))};e.renderActionIcon=function(a){const {active:b,className:c}=
a,d=this._getIconImageStyles(a);a="button"!==a.type||a.image||c?c:"esri-icon-default-action";const f={["esri-basemap-layer-list__item-action-image"]:!b&&!!d["background-image"],["esri-icon-loading-indicator"]:b,["esri-rotating"]:b};a&&!b&&(f[a]=!0);return g.tsx("span",{key:"action-icon","aria-hidden":"true",class:this.classes("esri-basemap-layer-list__item-action-icon",f),styles:d})};e.renderActionTitle=function(a,b){return b?null:g.tsx("span",{key:"action-title",class:"esri-basemap-layer-list__item-action-title"},
a)};e.renderAction=function(a){const {item:b,action:c,singleAction:d}=a,{active:f,disabled:h,title:l}=c;a={["esri-basemap-layer-list__item-actions-menu-item"]:d&&"button"===c.type,["esri-basemap-layer-list__item-action"]:f||!d&&"toggle"!==c.type,["esri-basemap-layer-list__action-toggle"]:!f&&"toggle"===c.type,["esri-basemap-layer-list__action-toggle--on"]:!f&&"toggle"===c.type&&c.value,["esri-disabled-element"]:h};const n=[this.renderActionIcon(c),this.renderActionTitle(l,d)];return d?g.tsx("div",
{bind:this,"data-item":b,"data-action":c,role:"button",key:`single-action-${c.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:a,tabindex:"0",title:l,"aria-label":l},n):g.tsx("li",{bind:this,"data-item":b,"data-action":c,key:`action-${c.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:a,tabindex:"0",role:"button",title:l,"aria-label":l},n)};e._setVisibleItems=function(){const {referenceItems:a,baseItems:b,visibleElements:c}=this;this.visibleItems=a.concat(b)?.filter(d=>
!d.hidden&&(c.errors||!d.error))};e._setTooltipReference=function(a,b){this._tooltipReferenceMap.set(b.uid,a);this.scheduleRender()};e._hasMessage=function(a){return!!a.error||a.incompatible};e._hasChildren=function(a){return!!a.children.length&&!this._hasMessage(a)};e._filterActions=function(a){return a.map(b=>b.filter(c=>c.visible))};e._destroyReferenceSortable=function(){const {_sortableReferenceLayers:a}=this;a?.el&&a.destroy();this._sortableReferenceLayersNode=null};e._destroyBaseSortable=function(){const {_sortableBaseLayers:a}=
this;a?.el&&a.destroy();this._sortableBaseLayersNode=null};e._toggleEditingTitle=function(){var {_editingTitle:a}=this;this._focusOnElement=(this._editingTitle=a=!a)?"edit-input":"edit-button";this.scheduleRender()};e._storeEditTitleInput=function(a){this._editTitleInput=a;this._focusEditElement()};e._focusEditElement=function(){this._editTitleInput&&"edit-input"===this._focusOnElement&&(this._focusOnElement=null,this._editTitleInput.focus());this._editTitleButton&&"edit-button"===this._focusOnElement&&
(this._focusOnElement=null,this._editTitleButton.focus())};e._storeEditTitleButton=function(a){this._editTitleButton=a;this._focusEditElement()};e._formSubmit=function(a){a.preventDefault();a=this._editTitleInput?.value;a?.trim()&&(this.basemapTitle=a);this._toggleEditingTitle()};e._itemMovedList=function(a){const b=a.item["data-item"],c=a.to.dataset.nodeRef,d=a.from.dataset.nodeRef;({newIndex:a}=a);this.viewModel.transferListItem({listItem:b,from:d,to:c,newIndex:a})};e._toggleSortingBaseLayers=function(){const {_sortableBaseLayers:a,
_sortableBaseLayersNode:b,editingEnabled:c}=this;if(b){var d=!c;if(a)a.option("disabled",d);else{const f=H.Sortable.create(b,{dataIdAttr:"data-layer-uid",group:"root-layers",filter:".esri-basemap-layer-list__item--only-child",fallbackTolerance:4,disabled:d,onSort:()=>this._sortLayersToItems({type:"base",itemIds:f.toArray()}),onAdd:h=>this._itemMovedList(h),chosenClass:"esri-basemap-layer-list--chosen"});this._sortableBaseLayers=f}}};e._toggleSortingReferenceLayers=function(){const {_sortableReferenceLayers:a,
_sortableReferenceLayersNode:b,editingEnabled:c}=this;if(b){var d=!c;if(a)a.option("disabled",d);else{const f=H.Sortable.create(b,{dataIdAttr:"data-layer-uid",group:"root-layers",disabled:d,fallbackTolerance:4,onSort:()=>this._sortLayersToItems({type:"reference",itemIds:f.toArray()}),onAdd:h=>this._itemMovedList(h),chosenClass:"esri-basemap-layer-list--chosen"});this._sortableReferenceLayers=f}}};e._toggleSorting=function(){this._toggleSortingBaseLayers();this._toggleSortingReferenceLayers()};e._sortNodeCreated=
function(a){const b=a.getAttribute("data-node-ref");"base"===b&&(this._sortableBaseLayersNode=a);"reference"===b&&(this._sortableReferenceLayersNode=a);this._toggleSorting()};e._getItems=function(a){return a.toArray().filter(b=>!b.hidden&&(this.visibleElements.errors||!b.error))};e._getSingleActionButton=function(a){return a.reduce(b=>b).filter(b=>b&&"button"===b.type).getItemAt(0)};e._sortLayersToItems=function({type:a,itemIds:b}){(a="base"===a?this.get("view.map.basemap.baseLayers"):"reference"===
a?this.get("view.map.basemap.referenceLayers"):null)&&a.sort((c,d)=>{c=b.indexOf(c.uid);d=b.indexOf(d.uid);return c>d?-1:c<d?1:0})};e._focusListItem=function(a){const {_focusSortUid:b}=this;a&&b&&a["data-item"].layer?.uid===b&&(a.focus(),this._focusSortUid=null)};e._selectionKeydown=function(a){var b=K.eventKey(a);if(["ArrowDown","ArrowUp"].includes(b)){a.stopPropagation();var c=a.currentTarget,d=c["data-item"];c=c.dataset.itemType;var {_sortableBaseLayers:f,_sortableReferenceLayers:h,selectedItems:l}=
this,n="base"===c?f:"reference"===c?h:null;if(n){var p=B.findSelectedItem(d,l),q=n.toArray();a=q.indexOf(a.target.dataset.layerUid);var {baseItems:u,referenceItems:J}=this.viewModel;if(-1!==a)if("ArrowDown"===b){b=a+1;var x=b>=q.length;x&&"reference"===c&&p?(this.viewModel.transferListItem({listItem:d,from:"reference",to:"base",newIndex:u.length}),this._focusSortUid=d.layer?.uid,this.scheduleRender()):x&&"reference"===c?(this._focusSortUid=u.getItemAt(0)?.layer?.uid,this.scheduleRender()):x||(p&&
(q.splice(b,0,q.splice(a,1)[0]),n.sort(q),this._sortLayersToItems({type:c,itemIds:n.toArray()})),this._focusSortUid=d.layer?.uid,this.scheduleRender())}else"ArrowUp"===b&&(b=a-1,(x=0>b)&&"base"===c&&p?1!==u.length&&(this.viewModel.transferListItem({listItem:d,from:"base",to:"reference",newIndex:0}),this._focusSortUid=d.layer?.uid,this.scheduleRender()):x&&"base"===c?(this._focusSortUid=J.getItemAt(J.length-1)?.layer?.uid,this.scheduleRender()):x||(p&&(q.splice(b,0,q.splice(a,1)[0]),n.sort(q),this._sortLayersToItems({type:c,
itemIds:n.toArray()})),this._focusSortUid=d.layer?.uid,this.scheduleRender()))}}else this._toggleSelection(a)};e._watchActionSectionChanges=function(a,b){this.handles.add(a.on("change",()=>this.scheduleRender()),b);a.forEach(c=>this._renderOnActionChanges(c,b))};e._renderOnActionChanges=function(a,b){"toggle"===a.type?this.handles.add([t.watch(()=>[a.className,a.image,a.id,a.title,a.visible,a.value],()=>this.scheduleRender(),t.initial)],b):"slider"===a.type?this.handles.add([t.watch(()=>[a.className,
a.id,a.title,a.visible,a.value,a.displayValueEnabled,a.max,a.min,a.step],()=>this.scheduleRender(),t.initial)],b):this.handles.add([t.watch(()=>[a.className,a.image,a.id,a.title,a.visible],()=>this.scheduleRender(),t.initial)],b)};e._renderOnItemChanges=function(a,b){this.handles.add([t.watch(()=>[a.actionsOpen,a.visible,a.open,a.updating,a.connectionStatus,a.publishing,a.title,a.visibleAtCurrentScale,a.error,a.visibilityMode,a.panel,a.panel?.title,a.panel?.content,a.panel?.className],()=>this.scheduleRender(),
t.initial),t.watch(()=>[a.hidden,a.error],()=>this._setVisibleItems()),a.actionsSections.on("change",()=>this.scheduleRender()),a.children.on("change",()=>this.scheduleRender())],b);a.children.forEach(c=>this._renderOnItemChanges(c,b));a.actionsSections.forEach(c=>this._watchActionSectionChanges(c,b))};e._itemsChanged=function(a,b){this.handles.remove(b);this._tooltipReferenceMap.clear();this._setVisibleItems();a.forEach(c=>this._renderOnItemChanges(c,b));this.scheduleRender()};e._countActions=function(a){return a.reduce((b,
c)=>b+c.length,0)};e._getIconImageStyles=function(a){a="esri.widgets.LayerList.ListItemPanel"===a.declaredClass||"esri.support.Action.ActionButton"===a.declaredClass||"esri.support.Action.ActionToggle"===a.declaredClass?a.image:null;return{"background-image":a?`url("${a}")`:null}};e._toggleActionsOpen=function(a){a.stopPropagation();a=a.currentTarget["data-item"];var {actionsOpen:b}=a;b=!b;const {baseItems:c,referenceItems:d}=this;b&&(c.forEach(f=>C(f)),d.forEach(f=>C(f)));a.actionsOpen=b};e._triggerPanel=
function(a){a.stopPropagation();(a=a.currentTarget["data-panel"])&&!a.disabled&&(a.open=!a.open)};e._triggerAction=function(a){a.stopPropagation();var b=a.currentTarget;a=b["data-action"];b=b["data-item"];"toggle"===a.type&&(a.value=!a.value);this.triggerAction(a,b)};e._toggleVisibility=function(a){a.stopPropagation();var b=a.currentTarget;a=b.getAttribute("data-parent-visibility");b=b["data-item"];a===A.exclusive&&b.visible||(b.visible=!b.visible)};e._toggleChildrenClick=function(a){a.stopPropagation();
a=a.currentTarget["data-item"];a.open=!a.open};e._toggleSelection=function(a){a.stopPropagation();const {multipleSelectionEnabled:b,selectedItems:c}=this,d=b&&(a.metaKey||a.ctrlKey);a=a.currentTarget["data-item"];const f=B.findSelectedItem(a,c),{length:h}=c,l=f&&1===h;d?f?c.remove(f):c.add(a):h&&!l?(c.removeAll(),c.add(a)):f?c.remove(f):c.add(a)};E._createClass(w,[{key:"basemapTitle",get:function(){return this.viewModel.basemapTitle},set:function(a){this.viewModel.basemapTitle=a}},{key:"baseListItemCreatedFunction",
get:function(){return this.viewModel.baseListItemCreatedFunction},set:function(a){this.viewModel.baseListItemCreatedFunction=a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"referenceListItemCreatedFunction",get:function(){return this.viewModel.referenceListItemCreatedFunction},set:function(a){this.viewModel.referenceListItemCreatedFunction=a}},{key:"baseItems",get:function(){return this.viewModel.baseItems}},{key:"referenceItems",
get:function(){return this.viewModel.referenceItems}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}}]);return w}(L.HandleOwnerMixin(Q));m.__decorate([r.property()],k.prototype,"visibleItems",void 0);m.__decorate([r.property()],k.prototype,"basemapTitle",null);m.__decorate([r.property()],k.prototype,"baseListItemCreatedFunction",null);m.__decorate([r.property()],k.prototype,"editingEnabled",void 0);m.__decorate([r.property()],k.prototype,"headingLevel",
void 0);m.__decorate([r.property()],k.prototype,"iconClass",void 0);m.__decorate([r.property()],k.prototype,"label",null);m.__decorate([r.property(),G.messageBundle("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],k.prototype,"messages",void 0);m.__decorate([r.property(),G.messageBundle("esri/t9n/common")],k.prototype,"messagesCommon",void 0);m.__decorate([r.property()],k.prototype,"multipleSelectionEnabled",void 0);m.__decorate([r.property()],k.prototype,"referenceListItemCreatedFunction",
null);m.__decorate([r.property({readOnly:!0})],k.prototype,"baseItems",null);m.__decorate([r.property({readOnly:!0})],k.prototype,"referenceItems",null);m.__decorate([r.property()],k.prototype,"selectedItems",void 0);m.__decorate([r.property()],k.prototype,"view",null);m.__decorate([S.vmEvent("trigger-action"),r.property({type:F})],k.prototype,"viewModel",void 0);m.__decorate([r.property()],k.prototype,"visibleElements",void 0);m.__decorate([O.cast("visibleElements")],k.prototype,"castVisibleElements",
null);m.__decorate([v.accessibleHandler()],k.prototype,"_toggleActionsOpen",null);m.__decorate([v.accessibleHandler()],k.prototype,"_triggerPanel",null);m.__decorate([v.accessibleHandler()],k.prototype,"_triggerAction",null);m.__decorate([v.accessibleHandler()],k.prototype,"_toggleVisibility",null);m.__decorate([v.accessibleHandler()],k.prototype,"_toggleChildrenClick",null);m.__decorate([v.accessibleHandler()],k.prototype,"_toggleSelection",null);return k=m.__decorate([P.subclass("esri.widgets.BasemapLayerList")],
k)});