// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(g,d,v,c,w,k,x,f,I,J,y,K,L,M,N,z,A,O,B,C,D,E,F,n){c=function(p){function l(h){var a=p.call(this,h)||this;a._abortController=null;a.expressionInfo=null;a.graphic=null;a.contentElement=null;a.contentElementViewModel=null;a.interceptor=null;a.view=null;a._cancelQuery=()=>{const {_abortController:b}=g._assertThisInitialized(a);b&&b.abort();a._abortController=null};a._createVM=()=>{var b=a.contentElement?.type;a.contentElementViewModel?.destroy();b="fields"===b?new E:"media"===b?new F:"text"===
b?new D:null;a._set("contentElementViewModel",b)};a._compile=g._asyncToGenerator(function*(){a._cancelQuery();const b=new AbortController;a._abortController=b;yield a._compileExpression();a._abortController===b&&(a._abortController=null)});a._compileThrottled=x.throttle(a._compile,1,g._assertThisInitialized(a));a._compileExpression=g._asyncToGenerator(function*(){const {expressionInfo:b,graphic:q,interceptor:G,spatialReference:r,map:t,view:H,_abortController:u}=g._assertThisInitialized(a);if(b&&q&&
r&&t){var e=yield n.loadArcadeUtils();if(u===a._abortController)if((e=yield n.createCompiledExpression({arcadeUtils:e,expressionInfo:b,graphic:q,interceptor:G,map:t,spatialReference:r,view:H}))&&"esri.arcade.Dictionary"===e.declaredClass){e=yield e.castAsJsonAsync(u.signal);var m=e?.type;e="media"===m?A.fromJSON(e):"text"===m?B.fromJSON(e):"fields"===m?z.fromJSON(e):null;a._set("contentElement",e)}else a._set("contentElement",null)}else a._set("contentElement",null)});a.handles.add([k.watch(()=>[a.expressionInfo,
a.graphic,a.map,a.spatialReference,a.view],()=>a._compileThrottled(),k.initial),k.watch(()=>[a.contentElement],()=>a._createVM(),k.initial)]);return a}g._inheritsLoose(l,p);l.prototype.destroy=function(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)};g._createClass(l,[{key:"spatialReference",get:function(){return this.view?.spatialReference??null},set:function(h){this._override("spatialReference",h)}},{key:"state",
get:function(){const {_abortController:h,contentElement:a,contentElementViewModel:b}=this;return h?"loading":a||b?"ready":"disabled"}},{key:"map",get:function(){return this.view?.map??null},set:function(h){this._override("map",h)}}]);return l}(w.HandleOwnerMixin(c));d.__decorate([f.property()],c.prototype,"_abortController",void 0);d.__decorate([f.property({type:C})],c.prototype,"expressionInfo",void 0);d.__decorate([f.property({type:v})],c.prototype,"graphic",void 0);d.__decorate([f.property({readOnly:!0})],
c.prototype,"contentElement",void 0);d.__decorate([f.property({readOnly:!0})],c.prototype,"contentElementViewModel",void 0);d.__decorate([f.property()],c.prototype,"interceptor",void 0);d.__decorate([f.property()],c.prototype,"spatialReference",null);d.__decorate([f.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([f.property()],c.prototype,"map",null);d.__decorate([f.property()],c.prototype,"view",void 0);return c=d.__decorate([y.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],
c)});