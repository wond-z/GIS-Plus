// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.25/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/asyncUtils ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/uuid ../../portal/support/resourceUtils".split(" "),function(n,g,p,v,w,q,x,y){function h(){h=g._asyncToGenerator(function*(a,b,d){if(b&&b.resources){var k=b.portalItem===a.portalItem?new Set(a.paths):new Set;a.paths.length=0;a.portalItem=b.portalItem;var f=new Set(b.resources.toKeep.map(c=>c.resource.path)),r=new Set,e=[];f.forEach(c=>{k.delete(c);a.paths.push(c)});
for(const c of b.resources.toUpdate)if(k.delete(c.resource.path),f.has(c.resource.path)||r.has(c.resource.path)){const {resource:z,content:A,finish:B,error:C}=c,t=y.getSiblingOfSameTypeI(z,x.generateUUID());a.paths.push(t.path);e.push(u({resource:t,content:A,compress:c.compress,finish:B,error:C},d))}else a.paths.push(c.resource.path),e.push(D(c,d)),r.add(c.resource.path);for(const c of b.resources.toAdd)e.push(u(c,d)),a.paths.push(c.resource.path);k.forEach(c=>{c=b.portalItem.resourceFromPath(c);
e.push(c.portalItem.removeResource(c).catch(()=>{}))});if(0!==e.length&&(f=yield q.eachAlways(e),q.throwIfAborted(d),d=f.filter(c=>"error"in c).map(c=>c.error),0<d.length))throw new v("save:resources","Failed to save one or more resources",{errors:d});}});return h.apply(this,arguments)}function u(a,b){return l.apply(this,arguments)}function l(){l=g._asyncToGenerator(function*(a,b){b={...(w.isSome(b)?b:{}),compress:a.compress};b=yield p.result(a.resource.portalItem.addResource(a.resource,a.content,
b));if(!0===b.ok)a.finish&&a.finish(a.resource);else throw a.error&&a.error(b.error),b.error;});return l.apply(this,arguments)}function D(a,b){return m.apply(this,arguments)}function m(){m=g._asyncToGenerator(function*(a,b){b=yield p.result(a.resource.update(a.content,b));if(!0===b.ok)a.finish(a.resource);else throw a.error(b.error),b.error;});return m.apply(this,arguments)}n.saveResources=function(a,b,d){return h.apply(this,arguments)};Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});